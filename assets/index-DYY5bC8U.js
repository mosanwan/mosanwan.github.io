function VN(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in t)){const l=Object.getOwnPropertyDescriptor(s,a);l&&Object.defineProperty(t,a,l.get?l:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();function Fl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Kx(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function s(){var a=!1;try{a=this instanceof s}catch{}return a?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var a=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,a.get?a:{enumerable:!0,get:function(){return t[s]}})}),n}var $m={exports:{}},Yo={};var ib;function GN(){if(ib)return Yo;ib=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(s,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var d in a)d!=="key"&&(l[d]=a[d])}else l=a;return a=l.ref,{$$typeof:t,type:s,key:c,ref:a!==void 0?a:null,props:l}}return Yo.Fragment=e,Yo.jsx=n,Yo.jsxs=n,Yo}var ab;function YN(){return ab||(ab=1,$m.exports=GN()),$m.exports}var b=YN(),zm={exports:{}},$e={};var ob;function XN(){if(ob)return $e;ob=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.for("react.activity"),y=Symbol.iterator;function _(I){return I===null||typeof I!="object"?null:(I=y&&I[y]||I["@@iterator"],typeof I=="function"?I:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,A={};function S(I,P,Y){this.props=I,this.context=P,this.refs=A,this.updater=Y||x}S.prototype.isReactComponent={},S.prototype.setState=function(I,P){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,P,"setState")},S.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function T(){}T.prototype=S.prototype;function E(I,P,Y){this.props=I,this.context=P,this.refs=A,this.updater=Y||x}var C=E.prototype=new T;C.constructor=E,w(C,S.prototype),C.isPureReactComponent=!0;var j=Array.isArray;function O(){}var M={H:null,A:null,T:null,S:null},D=Object.prototype.hasOwnProperty;function q(I,P,Y){var J=Y.ref;return{$$typeof:t,type:I,key:P,ref:J!==void 0?J:null,props:Y}}function G(I,P){return q(I.type,P,I.props)}function V(I){return typeof I=="object"&&I!==null&&I.$$typeof===t}function F(I){var P={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(Y){return P[Y]})}var K=/\/+/g;function $(I,P){return typeof I=="object"&&I!==null&&I.key!=null?F(""+I.key):P.toString(36)}function Q(I){switch(I.status){case"fulfilled":return I.value;case"rejected":throw I.reason;default:switch(typeof I.status=="string"?I.then(O,O):(I.status="pending",I.then(function(P){I.status==="pending"&&(I.status="fulfilled",I.value=P)},function(P){I.status==="pending"&&(I.status="rejected",I.reason=P)})),I.status){case"fulfilled":return I.value;case"rejected":throw I.reason}}throw I}function R(I,P,Y,J,Z){var ae=typeof I;(ae==="undefined"||ae==="boolean")&&(I=null);var ce=!1;if(I===null)ce=!0;else switch(ae){case"bigint":case"string":case"number":ce=!0;break;case"object":switch(I.$$typeof){case t:case e:ce=!0;break;case p:return ce=I._init,R(ce(I._payload),P,Y,J,Z)}}if(ce)return Z=Z(I),ce=J===""?"."+$(I,0):J,j(Z)?(Y="",ce!=null&&(Y=ce.replace(K,"$&/")+"/"),R(Z,P,Y,"",function(pe){return pe})):Z!=null&&(V(Z)&&(Z=G(Z,Y+(Z.key==null||I&&I.key===Z.key?"":(""+Z.key).replace(K,"$&/")+"/")+ce)),P.push(Z)),1;ce=0;var he=J===""?".":J+":";if(j(I))for(var ye=0;ye<I.length;ye++)J=I[ye],ae=he+$(J,ye),ce+=R(J,P,Y,ae,Z);else if(ye=_(I),typeof ye=="function")for(I=ye.call(I),ye=0;!(J=I.next()).done;)J=J.value,ae=he+$(J,ye++),ce+=R(J,P,Y,ae,Z);else if(ae==="object"){if(typeof I.then=="function")return R(Q(I),P,Y,J,Z);throw P=String(I),Error("Objects are not valid as a React child (found: "+(P==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":P)+"). If you meant to render a collection of children, use an array instead.")}return ce}function U(I,P,Y){if(I==null)return I;var J=[],Z=0;return R(I,J,"","",function(ae){return P.call(Y,ae,Z++)}),J}function B(I){if(I._status===-1){var P=I._result;P=P(),P.then(function(Y){(I._status===0||I._status===-1)&&(I._status=1,I._result=Y)},function(Y){(I._status===0||I._status===-1)&&(I._status=2,I._result=Y)}),I._status===-1&&(I._status=0,I._result=P)}if(I._status===1)return I._result.default;throw I._result}var L=typeof reportError=="function"?reportError:function(I){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var P=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof I=="object"&&I!==null&&typeof I.message=="string"?String(I.message):String(I),error:I});if(!window.dispatchEvent(P))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",I);return}console.error(I)},H={map:U,forEach:function(I,P,Y){U(I,function(){P.apply(this,arguments)},Y)},count:function(I){var P=0;return U(I,function(){P++}),P},toArray:function(I){return U(I,function(P){return P})||[]},only:function(I){if(!V(I))throw Error("React.Children.only expected to receive a single React element child.");return I}};return $e.Activity=m,$e.Children=H,$e.Component=S,$e.Fragment=n,$e.Profiler=a,$e.PureComponent=E,$e.StrictMode=s,$e.Suspense=h,$e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=M,$e.__COMPILER_RUNTIME={__proto__:null,c:function(I){return M.H.useMemoCache(I)}},$e.cache=function(I){return function(){return I.apply(null,arguments)}},$e.cacheSignal=function(){return null},$e.cloneElement=function(I,P,Y){if(I==null)throw Error("The argument must be a React element, but you passed "+I+".");var J=w({},I.props),Z=I.key;if(P!=null)for(ae in P.key!==void 0&&(Z=""+P.key),P)!D.call(P,ae)||ae==="key"||ae==="__self"||ae==="__source"||ae==="ref"&&P.ref===void 0||(J[ae]=P[ae]);var ae=arguments.length-2;if(ae===1)J.children=Y;else if(1<ae){for(var ce=Array(ae),he=0;he<ae;he++)ce[he]=arguments[he+2];J.children=ce}return q(I.type,Z,J)},$e.createContext=function(I){return I={$$typeof:c,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null},I.Provider=I,I.Consumer={$$typeof:l,_context:I},I},$e.createElement=function(I,P,Y){var J,Z={},ae=null;if(P!=null)for(J in P.key!==void 0&&(ae=""+P.key),P)D.call(P,J)&&J!=="key"&&J!=="__self"&&J!=="__source"&&(Z[J]=P[J]);var ce=arguments.length-2;if(ce===1)Z.children=Y;else if(1<ce){for(var he=Array(ce),ye=0;ye<ce;ye++)he[ye]=arguments[ye+2];Z.children=he}if(I&&I.defaultProps)for(J in ce=I.defaultProps,ce)Z[J]===void 0&&(Z[J]=ce[J]);return q(I,ae,Z)},$e.createRef=function(){return{current:null}},$e.forwardRef=function(I){return{$$typeof:d,render:I}},$e.isValidElement=V,$e.lazy=function(I){return{$$typeof:p,_payload:{_status:-1,_result:I},_init:B}},$e.memo=function(I,P){return{$$typeof:f,type:I,compare:P===void 0?null:P}},$e.startTransition=function(I){var P=M.T,Y={};M.T=Y;try{var J=I(),Z=M.S;Z!==null&&Z(Y,J),typeof J=="object"&&J!==null&&typeof J.then=="function"&&J.then(O,L)}catch(ae){L(ae)}finally{P!==null&&Y.types!==null&&(P.types=Y.types),M.T=P}},$e.unstable_useCacheRefresh=function(){return M.H.useCacheRefresh()},$e.use=function(I){return M.H.use(I)},$e.useActionState=function(I,P,Y){return M.H.useActionState(I,P,Y)},$e.useCallback=function(I,P){return M.H.useCallback(I,P)},$e.useContext=function(I){return M.H.useContext(I)},$e.useDebugValue=function(){},$e.useDeferredValue=function(I,P){return M.H.useDeferredValue(I,P)},$e.useEffect=function(I,P){return M.H.useEffect(I,P)},$e.useEffectEvent=function(I){return M.H.useEffectEvent(I)},$e.useId=function(){return M.H.useId()},$e.useImperativeHandle=function(I,P,Y){return M.H.useImperativeHandle(I,P,Y)},$e.useInsertionEffect=function(I,P){return M.H.useInsertionEffect(I,P)},$e.useLayoutEffect=function(I,P){return M.H.useLayoutEffect(I,P)},$e.useMemo=function(I,P){return M.H.useMemo(I,P)},$e.useOptimistic=function(I,P){return M.H.useOptimistic(I,P)},$e.useReducer=function(I,P,Y){return M.H.useReducer(I,P,Y)},$e.useRef=function(I){return M.H.useRef(I)},$e.useState=function(I){return M.H.useState(I)},$e.useSyncExternalStore=function(I,P,Y){return M.H.useSyncExternalStore(I,P,Y)},$e.useTransition=function(){return M.H.useTransition()},$e.version="19.2.0",$e}var lb;function Vl(){return lb||(lb=1,zm.exports=XN()),zm.exports}var k=Vl();const KN=Fl(k);var Pm={exports:{}},Xo={},Hm={exports:{}},qm={};var cb;function WN(){return cb||(cb=1,(function(t){function e(R,U){var B=R.length;R.push(U);e:for(;0<B;){var L=B-1>>>1,H=R[L];if(0<a(H,U))R[L]=U,R[B]=H,B=L;else break e}}function n(R){return R.length===0?null:R[0]}function s(R){if(R.length===0)return null;var U=R[0],B=R.pop();if(B!==U){R[0]=B;e:for(var L=0,H=R.length,I=H>>>1;L<I;){var P=2*(L+1)-1,Y=R[P],J=P+1,Z=R[J];if(0>a(Y,B))J<H&&0>a(Z,Y)?(R[L]=Z,R[J]=B,L=J):(R[L]=Y,R[P]=B,L=P);else if(J<H&&0>a(Z,B))R[L]=Z,R[J]=B,L=J;else break e}}return U}function a(R,U){var B=R.sortIndex-U.sortIndex;return B!==0?B:R.id-U.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();t.unstable_now=function(){return c.now()-d}}var h=[],f=[],p=1,m=null,y=3,_=!1,x=!1,w=!1,A=!1,S=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function C(R){for(var U=n(f);U!==null;){if(U.callback===null)s(f);else if(U.startTime<=R)s(f),U.sortIndex=U.expirationTime,e(h,U);else break;U=n(f)}}function j(R){if(w=!1,C(R),!x)if(n(h)!==null)x=!0,O||(O=!0,F());else{var U=n(f);U!==null&&Q(j,U.startTime-R)}}var O=!1,M=-1,D=5,q=-1;function G(){return A?!0:!(t.unstable_now()-q<D)}function V(){if(A=!1,O){var R=t.unstable_now();q=R;var U=!0;try{e:{x=!1,w&&(w=!1,T(M),M=-1),_=!0;var B=y;try{t:{for(C(R),m=n(h);m!==null&&!(m.expirationTime>R&&G());){var L=m.callback;if(typeof L=="function"){m.callback=null,y=m.priorityLevel;var H=L(m.expirationTime<=R);if(R=t.unstable_now(),typeof H=="function"){m.callback=H,C(R),U=!0;break t}m===n(h)&&s(h),C(R)}else s(h);m=n(h)}if(m!==null)U=!0;else{var I=n(f);I!==null&&Q(j,I.startTime-R),U=!1}}break e}finally{m=null,y=B,_=!1}U=void 0}}finally{U?F():O=!1}}}var F;if(typeof E=="function")F=function(){E(V)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,$=K.port2;K.port1.onmessage=V,F=function(){$.postMessage(null)}}else F=function(){S(V,0)};function Q(R,U){M=S(function(){R(t.unstable_now())},U)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(R){R.callback=null},t.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<R?Math.floor(1e3/R):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_next=function(R){switch(y){case 1:case 2:case 3:var U=3;break;default:U=y}var B=y;y=U;try{return R()}finally{y=B}},t.unstable_requestPaint=function(){A=!0},t.unstable_runWithPriority=function(R,U){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var B=y;y=R;try{return U()}finally{y=B}},t.unstable_scheduleCallback=function(R,U,B){var L=t.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?L+B:L):B=L,R){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=B+H,R={id:p++,callback:U,priorityLevel:R,startTime:B,expirationTime:H,sortIndex:-1},B>L?(R.sortIndex=B,e(f,R),n(h)===null&&R===n(f)&&(w?(T(M),M=-1):w=!0,Q(j,B-L))):(R.sortIndex=H,e(h,R),x||_||(x=!0,O||(O=!0,F()))),R},t.unstable_shouldYield=G,t.unstable_wrapCallback=function(R){var U=y;return function(){var B=y;y=U;try{return R.apply(this,arguments)}finally{y=B}}}})(qm)),qm}var ub;function JN(){return ub||(ub=1,Hm.exports=WN()),Hm.exports}var Qm={exports:{}},Kt={};var db;function ZN(){if(db)return Kt;db=1;var t=Vl();function e(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var s={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(h,f,p){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:m==null?null:""+m,children:h,containerInfo:f,implementation:p}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Kt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Kt.createPortal=function(h,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return l(h,f,null,p)},Kt.flushSync=function(h){var f=c.T,p=s.p;try{if(c.T=null,s.p=2,h)return h()}finally{c.T=f,s.p=p,s.d.f()}},Kt.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,s.d.C(h,f))},Kt.prefetchDNS=function(h){typeof h=="string"&&s.d.D(h)},Kt.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var p=f.as,m=d(p,f.crossOrigin),y=typeof f.integrity=="string"?f.integrity:void 0,_=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?s.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:m,integrity:y,fetchPriority:_}):p==="script"&&s.d.X(h,{crossOrigin:m,integrity:y,fetchPriority:_,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Kt.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=d(f.as,f.crossOrigin);s.d.M(h,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&s.d.M(h)},Kt.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,m=d(p,f.crossOrigin);s.d.L(h,p,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Kt.preloadModule=function(h,f){if(typeof h=="string")if(f){var p=d(f.as,f.crossOrigin);s.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else s.d.m(h)},Kt.requestFormReset=function(h){s.d.r(h)},Kt.unstable_batchedUpdates=function(h,f){return h(f)},Kt.useFormState=function(h,f,p){return c.H.useFormState(h,f,p)},Kt.useFormStatus=function(){return c.H.useHostTransitionStatus()},Kt.version="19.2.0",Kt}var fb;function Wx(){if(fb)return Qm.exports;fb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Qm.exports=ZN(),Qm.exports}var hb;function eR(){if(hb)return Xo;hb=1;var t=JN(),e=Vl(),n=Wx();function s(r){var i="https://react.dev/errors/"+r;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function l(r){var i=r,o=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(o=i.return),r=i.return;while(r)}return i.tag===3?o:null}function c(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function d(r){if(r.tag===31){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function h(r){if(l(r)!==r)throw Error(s(188))}function f(r){var i=r.alternate;if(!i){if(i=l(r),i===null)throw Error(s(188));return i!==r?null:r}for(var o=r,u=i;;){var g=o.return;if(g===null)break;var v=g.alternate;if(v===null){if(u=g.return,u!==null){o=u;continue}break}if(g.child===v.child){for(v=g.child;v;){if(v===o)return h(g),r;if(v===u)return h(g),i;v=v.sibling}throw Error(s(188))}if(o.return!==u.return)o=g,u=v;else{for(var N=!1,z=g.child;z;){if(z===o){N=!0,o=g,u=v;break}if(z===u){N=!0,u=g,o=v;break}z=z.sibling}if(!N){for(z=v.child;z;){if(z===o){N=!0,o=v,u=g;break}if(z===u){N=!0,u=v,o=g;break}z=z.sibling}if(!N)throw Error(s(189))}}if(o.alternate!==u)throw Error(s(190))}if(o.tag!==3)throw Error(s(188));return o.stateNode.current===o?r:i}function p(r){var i=r.tag;if(i===5||i===26||i===27||i===6)return r;for(r=r.child;r!==null;){if(i=p(r),i!==null)return i;r=r.sibling}return null}var m=Object.assign,y=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),T=Symbol.for("react.consumer"),E=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),q=Symbol.for("react.activity"),G=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function F(r){return r===null||typeof r!="object"?null:(r=V&&r[V]||r["@@iterator"],typeof r=="function"?r:null)}var K=Symbol.for("react.client.reference");function $(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===K?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case w:return"Fragment";case S:return"Profiler";case A:return"StrictMode";case j:return"Suspense";case O:return"SuspenseList";case q:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case x:return"Portal";case E:return r.displayName||"Context";case T:return(r._context.displayName||"Context")+".Consumer";case C:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case M:return i=r.displayName||null,i!==null?i:$(r.type)||"Memo";case D:i=r._payload,r=r._init;try{return $(r(i))}catch{}}return null}var Q=Array.isArray,R=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,B={pending:!1,data:null,method:null,action:null},L=[],H=-1;function I(r){return{current:r}}function P(r){0>H||(r.current=L[H],L[H]=null,H--)}function Y(r,i){H++,L[H]=r.current,r.current=i}var J=I(null),Z=I(null),ae=I(null),ce=I(null);function he(r,i){switch(Y(ae,i),Y(Z,r),Y(J,null),i.nodeType){case 9:case 11:r=(r=i.documentElement)&&(r=r.namespaceURI)?N_(r):0;break;default:if(r=i.tagName,i=i.namespaceURI)i=N_(i),r=R_(i,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}P(J),Y(J,r)}function ye(){P(J),P(Z),P(ae)}function pe(r){r.memoizedState!==null&&Y(ce,r);var i=J.current,o=R_(i,r.type);i!==o&&(Y(Z,r),Y(J,o))}function _e(r){Z.current===r&&(P(J),P(Z)),ce.current===r&&(P(ce),Qo._currentValue=B)}var be,we;function ue(r){if(be===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);be=i&&i[1]||"",we=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+be+r+we}var te=!1;function fe(r,i){if(!r||te)return"";te=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(i){var me=function(){throw Error()};if(Object.defineProperty(me.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(me,[])}catch(oe){var ie=oe}Reflect.construct(r,[],me)}else{try{me.call()}catch(oe){ie=oe}r.call(me.prototype)}}else{try{throw Error()}catch(oe){ie=oe}(me=r())&&typeof me.catch=="function"&&me.catch(function(){})}}catch(oe){if(oe&&ie&&typeof oe.stack=="string")return[oe.stack,ie.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=u.DetermineComponentFrameRoot(),N=v[0],z=v[1];if(N&&z){var X=N.split(`
`),re=z.split(`
`);for(g=u=0;u<X.length&&!X[u].includes("DetermineComponentFrameRoot");)u++;for(;g<re.length&&!re[g].includes("DetermineComponentFrameRoot");)g++;if(u===X.length||g===re.length)for(u=X.length-1,g=re.length-1;1<=u&&0<=g&&X[u]!==re[g];)g--;for(;1<=u&&0<=g;u--,g--)if(X[u]!==re[g]){if(u!==1||g!==1)do if(u--,g--,0>g||X[u]!==re[g]){var le=`
`+X[u].replace(" at new "," at ");return r.displayName&&le.includes("<anonymous>")&&(le=le.replace("<anonymous>",r.displayName)),le}while(1<=u&&0<=g);break}}}finally{te=!1,Error.prepareStackTrace=o}return(o=r?r.displayName||r.name:"")?ue(o):""}function Te(r,i){switch(r.tag){case 26:case 27:case 5:return ue(r.type);case 16:return ue("Lazy");case 13:return r.child!==i&&i!==null?ue("Suspense Fallback"):ue("Suspense");case 19:return ue("SuspenseList");case 0:case 15:return fe(r.type,!1);case 11:return fe(r.type.render,!1);case 1:return fe(r.type,!0);case 31:return ue("Activity");default:return""}}function De(r){try{var i="",o=null;do i+=Te(r,o),o=r,r=r.return;while(r);return i}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var Xe=Object.prototype.hasOwnProperty,ct=t.unstable_scheduleCallback,et=t.unstable_cancelCallback,pn=t.unstable_shouldYield,Gt=t.unstable_requestPaint,ft=t.unstable_now,gn=t.unstable_getCurrentPriorityLevel,kn=t.unstable_ImmediatePriority,nn=t.unstable_UserBlockingPriority,rn=t.unstable_NormalPriority,br=t.unstable_LowPriority,ge=t.unstable_IdlePriority,Le=t.log,Me=t.unstable_setDisableYieldValue,Ke=null,tt=null;function pt(r){if(typeof Le=="function"&&Me(r),tt&&typeof tt.setStrictMode=="function")try{tt.setStrictMode(Ke,r)}catch{}}var Zt=Math.clz32?Math.clz32:Tf,Sf=Math.log,Cf=Math.LN2;function Tf(r){return r>>>=0,r===0?32:31-(Sf(r)/Cf|0)|0}var ji=256,Oi=262144,Ii=4194304;function wr(r){var i=r&42;if(i!==0)return i;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function ki(r,i,o){var u=r.pendingLanes;if(u===0)return 0;var g=0,v=r.suspendedLanes,N=r.pingedLanes;r=r.warmLanes;var z=u&134217727;return z!==0?(u=z&~v,u!==0?g=wr(u):(N&=z,N!==0?g=wr(N):o||(o=z&~r,o!==0&&(g=wr(o))))):(z=u&~v,z!==0?g=wr(z):N!==0?g=wr(N):o||(o=u&~r,o!==0&&(g=wr(o)))),g===0?0:i!==0&&i!==g&&(i&v)===0&&(v=g&-g,o=i&-i,v>=o||v===32&&(o&4194048)!==0)?i:g}function Ps(r,i){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&i)===0}function Nf(r,i){switch(r){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oc(){var r=Ii;return Ii<<=1,(Ii&62914560)===0&&(Ii=4194304),r}function eo(r){for(var i=[],o=0;31>o;o++)i.push(r);return i}function Hs(r,i){r.pendingLanes|=i,i!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Rf(r,i,o,u,g,v){var N=r.pendingLanes;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=o,r.entangledLanes&=o,r.errorRecoveryDisabledLanes&=o,r.shellSuspendCounter=0;var z=r.entanglements,X=r.expirationTimes,re=r.hiddenUpdates;for(o=N&~o;0<o;){var le=31-Zt(o),me=1<<le;z[le]=0,X[le]=-1;var ie=re[le];if(ie!==null)for(re[le]=null,le=0;le<ie.length;le++){var oe=ie[le];oe!==null&&(oe.lane&=-536870913)}o&=~me}u!==0&&lc(r,u,0),v!==0&&g===0&&r.tag!==0&&(r.suspendedLanes|=v&~(N&~i))}function lc(r,i,o){r.pendingLanes|=i,r.suspendedLanes&=~i;var u=31-Zt(i);r.entangledLanes|=i,r.entanglements[u]=r.entanglements[u]|1073741824|o&261930}function cc(r,i){var o=r.entangledLanes|=i;for(r=r.entanglements;o;){var u=31-Zt(o),g=1<<u;g&i|r[u]&i&&(r[u]|=i),o&=~g}}function uc(r,i){var o=i&-i;return o=(o&42)!==0?1:to(o),(o&(r.suspendedLanes|i))!==0?0:o}function to(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function no(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function dc(){var r=U.p;return r!==0?r:(r=window.event,r===void 0?32:J_(r.type))}function fc(r,i){var o=U.p;try{return U.p=r,i()}finally{U.p=o}}var or=Math.random().toString(36).slice(2),It="__reactFiber$"+or,Yt="__reactProps$"+or,xr="__reactContainer$"+or,Mi="__reactEvents$"+or,hc="__reactListeners$"+or,jf="__reactHandles$"+or,mc="__reactResources$"+or,qs="__reactMarker$"+or;function ro(r){delete r[It],delete r[Yt],delete r[Mi],delete r[hc],delete r[jf]}function es(r){var i=r[It];if(i)return i;for(var o=r.parentNode;o;){if(i=o[xr]||o[It]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(r=B_(r);r!==null;){if(o=r[It])return o;r=B_(r)}return i}r=o,o=r.parentNode}return null}function ts(r){if(r=r[It]||r[xr]){var i=r.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return r}return null}function ns(r){var i=r.tag;if(i===5||i===26||i===27||i===6)return r.stateNode;throw Error(s(33))}function rs(r){var i=r[mc];return i||(i=r[mc]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function At(r){r[qs]=!0}var pc=new Set,gc={};function Ar(r,i){ss(r,i),ss(r+"Capture",i)}function ss(r,i){for(gc[r]=i,r=0;r<i.length;r++)pc.add(i[r])}var Of=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),so={},yc={};function If(r){return Xe.call(yc,r)?!0:Xe.call(so,r)?!1:Of.test(r)?yc[r]=!0:(so[r]=!0,!1)}function Di(r,i,o){if(If(i))if(o===null)r.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":r.removeAttribute(i);return;case"boolean":var u=i.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){r.removeAttribute(i);return}}r.setAttribute(i,""+o)}}function Bi(r,i,o){if(o===null)r.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(i);return}r.setAttribute(i,""+o)}}function Fn(r,i,o,u){if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttributeNS(i,o,""+u)}}function sn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function vc(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function kf(r,i,o){var u=Object.getOwnPropertyDescriptor(r.constructor.prototype,i);if(!r.hasOwnProperty(i)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var g=u.get,v=u.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return g.call(this)},set:function(N){o=""+N,v.call(this,N)}}),Object.defineProperty(r,i,{enumerable:u.enumerable}),{getValue:function(){return o},setValue:function(N){o=""+N},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function Ui(r){if(!r._valueTracker){var i=vc(r)?"checked":"value";r._valueTracker=kf(r,i,""+r[i])}}function _c(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var o=i.getValue(),u="";return r&&(u=vc(r)?r.checked?"true":"false":r.value),r=u,r!==o?(i.setValue(r),!0):!1}function Li(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Mf=/[\n"\\]/g;function Xt(r){return r.replace(Mf,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function io(r,i,o,u,g,v,N,z){r.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?r.type=N:r.removeAttribute("type"),i!=null?N==="number"?(i===0&&r.value===""||r.value!=i)&&(r.value=""+sn(i)):r.value!==""+sn(i)&&(r.value=""+sn(i)):N!=="submit"&&N!=="reset"||r.removeAttribute("value"),i!=null?$i(r,N,sn(i)):o!=null?$i(r,N,sn(o)):u!=null&&r.removeAttribute("value"),g==null&&v!=null&&(r.defaultChecked=!!v),g!=null&&(r.checked=g&&typeof g!="function"&&typeof g!="symbol"),z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"?r.name=""+sn(z):r.removeAttribute("name")}function bc(r,i,o,u,g,v,N,z){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(r.type=v),i!=null||o!=null){if(!(v!=="submit"&&v!=="reset"||i!=null)){Ui(r);return}o=o!=null?""+sn(o):"",i=i!=null?""+sn(i):o,z||i===r.value||(r.value=i),r.defaultValue=i}u=u??g,u=typeof u!="function"&&typeof u!="symbol"&&!!u,r.checked=z?r.checked:!!u,r.defaultChecked=!!u,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(r.name=N),Ui(r)}function $i(r,i,o){i==="number"&&Li(r.ownerDocument)===r||r.defaultValue===""+o||(r.defaultValue=""+o)}function zi(r,i,o,u){if(r=r.options,i){i={};for(var g=0;g<o.length;g++)i["$"+o[g]]=!0;for(o=0;o<r.length;o++)g=i.hasOwnProperty("$"+r[o].value),r[o].selected!==g&&(r[o].selected=g),g&&u&&(r[o].defaultSelected=!0)}else{for(o=""+sn(o),i=null,g=0;g<r.length;g++){if(r[g].value===o){r[g].selected=!0,u&&(r[g].defaultSelected=!0);return}i!==null||r[g].disabled||(i=r[g])}i!==null&&(i.selected=!0)}}function Ay(r,i,o){if(i!=null&&(i=""+sn(i),i!==r.value&&(r.value=i),o==null)){r.defaultValue!==i&&(r.defaultValue=i);return}r.defaultValue=o!=null?""+sn(o):""}function Ey(r,i,o,u){if(i==null){if(u!=null){if(o!=null)throw Error(s(92));if(Q(u)){if(1<u.length)throw Error(s(93));u=u[0]}o=u}o==null&&(o=""),i=o}o=sn(i),r.defaultValue=o,u=r.textContent,u===o&&u!==""&&u!==null&&(r.value=u),Ui(r)}function Pi(r,i){if(i){var o=r.firstChild;if(o&&o===r.lastChild&&o.nodeType===3){o.nodeValue=i;return}}r.textContent=i}var PC=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Sy(r,i,o){var u=i.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?r.setProperty(i,""):i==="float"?r.cssFloat="":r[i]="":u?r.setProperty(i,o):typeof o!="number"||o===0||PC.has(i)?i==="float"?r.cssFloat=o:r[i]=(""+o).trim():r[i]=o+"px"}function Cy(r,i,o){if(i!=null&&typeof i!="object")throw Error(s(62));if(r=r.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||i!=null&&i.hasOwnProperty(u)||(u.indexOf("--")===0?r.setProperty(u,""):u==="float"?r.cssFloat="":r[u]="");for(var g in i)u=i[g],i.hasOwnProperty(g)&&o[g]!==u&&Sy(r,g,u)}else for(var v in i)i.hasOwnProperty(v)&&Sy(r,v,i[v])}function Df(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var HC=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),qC=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function wc(r){return qC.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Er(){}var Bf=null;function Uf(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Hi=null,qi=null;function Ty(r){var i=ts(r);if(i&&(r=i.stateNode)){var o=r[Yt]||null;e:switch(r=i.stateNode,i.type){case"input":if(io(r,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),i=o.name,o.type==="radio"&&i!=null){for(o=r;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Xt(""+i)+'"][type="radio"]'),i=0;i<o.length;i++){var u=o[i];if(u!==r&&u.form===r.form){var g=u[Yt]||null;if(!g)throw Error(s(90));io(u,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(i=0;i<o.length;i++)u=o[i],u.form===r.form&&_c(u)}break e;case"textarea":Ay(r,o.value,o.defaultValue);break e;case"select":i=o.value,i!=null&&zi(r,!!o.multiple,i,!1)}}}var Lf=!1;function Ny(r,i,o){if(Lf)return r(i,o);Lf=!0;try{var u=r(i);return u}finally{if(Lf=!1,(Hi!==null||qi!==null)&&(lu(),Hi&&(i=Hi,r=qi,qi=Hi=null,Ty(i),r)))for(i=0;i<r.length;i++)Ty(r[i])}}function ao(r,i){var o=r.stateNode;if(o===null)return null;var u=o[Yt]||null;if(u===null)return null;o=u[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(r=r.type,u=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!u;break e;default:r=!1}if(r)return null;if(o&&typeof o!="function")throw Error(s(231,i,typeof o));return o}var Sr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),$f=!1;if(Sr)try{var oo={};Object.defineProperty(oo,"passive",{get:function(){$f=!0}}),window.addEventListener("test",oo,oo),window.removeEventListener("test",oo,oo)}catch{$f=!1}var is=null,zf=null,xc=null;function Ry(){if(xc)return xc;var r,i=zf,o=i.length,u,g="value"in is?is.value:is.textContent,v=g.length;for(r=0;r<o&&i[r]===g[r];r++);var N=o-r;for(u=1;u<=N&&i[o-u]===g[v-u];u++);return xc=g.slice(r,1<u?1-u:void 0)}function Ac(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function Ec(){return!0}function jy(){return!1}function an(r){function i(o,u,g,v,N){this._reactName=o,this._targetInst=g,this.type=u,this.nativeEvent=v,this.target=N,this.currentTarget=null;for(var z in r)r.hasOwnProperty(z)&&(o=r[z],this[z]=o?o(v):v[z]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Ec:jy,this.isPropagationStopped=jy,this}return m(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Ec)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Ec)},persist:function(){},isPersistent:Ec}),i}var Qs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sc=an(Qs),lo=m({},Qs,{view:0,detail:0}),QC=an(lo),Pf,Hf,co,Cc=m({},lo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qf,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==co&&(co&&r.type==="mousemove"?(Pf=r.screenX-co.screenX,Hf=r.screenY-co.screenY):Hf=Pf=0,co=r),Pf)},movementY:function(r){return"movementY"in r?r.movementY:Hf}}),Oy=an(Cc),FC=m({},Cc,{dataTransfer:0}),VC=an(FC),GC=m({},lo,{relatedTarget:0}),qf=an(GC),YC=m({},Qs,{animationName:0,elapsedTime:0,pseudoElement:0}),XC=an(YC),KC=m({},Qs,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),WC=an(KC),JC=m({},Qs,{data:0}),Iy=an(JC),ZC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nT(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=tT[r])?!!i[r]:!1}function Qf(){return nT}var rT=m({},lo,{key:function(r){if(r.key){var i=ZC[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=Ac(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?eT[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qf,charCode:function(r){return r.type==="keypress"?Ac(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Ac(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),sT=an(rT),iT=m({},Cc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ky=an(iT),aT=m({},lo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qf}),oT=an(aT),lT=m({},Qs,{propertyName:0,elapsedTime:0,pseudoElement:0}),cT=an(lT),uT=m({},Cc,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),dT=an(uT),fT=m({},Qs,{newState:0,oldState:0}),hT=an(fT),mT=[9,13,27,32],Ff=Sr&&"CompositionEvent"in window,uo=null;Sr&&"documentMode"in document&&(uo=document.documentMode);var pT=Sr&&"TextEvent"in window&&!uo,My=Sr&&(!Ff||uo&&8<uo&&11>=uo),Dy=" ",By=!1;function Uy(r,i){switch(r){case"keyup":return mT.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ly(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Qi=!1;function gT(r,i){switch(r){case"compositionend":return Ly(i);case"keypress":return i.which!==32?null:(By=!0,Dy);case"textInput":return r=i.data,r===Dy&&By?null:r;default:return null}}function yT(r,i){if(Qi)return r==="compositionend"||!Ff&&Uy(r,i)?(r=Ry(),xc=zf=is=null,Qi=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return My&&i.locale!=="ko"?null:i.data;default:return null}}var vT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $y(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!vT[r.type]:i==="textarea"}function zy(r,i,o,u){Hi?qi?qi.push(u):qi=[u]:Hi=u,i=pu(i,"onChange"),0<i.length&&(o=new Sc("onChange","change",null,o,u),r.push({event:o,listeners:i}))}var fo=null,ho=null;function _T(r){x_(r,0)}function Tc(r){var i=ns(r);if(_c(i))return r}function Py(r,i){if(r==="change")return i}var Hy=!1;if(Sr){var Vf;if(Sr){var Gf="oninput"in document;if(!Gf){var qy=document.createElement("div");qy.setAttribute("oninput","return;"),Gf=typeof qy.oninput=="function"}Vf=Gf}else Vf=!1;Hy=Vf&&(!document.documentMode||9<document.documentMode)}function Qy(){fo&&(fo.detachEvent("onpropertychange",Fy),ho=fo=null)}function Fy(r){if(r.propertyName==="value"&&Tc(ho)){var i=[];zy(i,ho,r,Uf(r)),Ny(_T,i)}}function bT(r,i,o){r==="focusin"?(Qy(),fo=i,ho=o,fo.attachEvent("onpropertychange",Fy)):r==="focusout"&&Qy()}function wT(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Tc(ho)}function xT(r,i){if(r==="click")return Tc(i)}function AT(r,i){if(r==="input"||r==="change")return Tc(i)}function ET(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var yn=typeof Object.is=="function"?Object.is:ET;function mo(r,i){if(yn(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var o=Object.keys(r),u=Object.keys(i);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var g=o[u];if(!Xe.call(i,g)||!yn(r[g],i[g]))return!1}return!0}function Vy(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Gy(r,i){var o=Vy(r);r=0;for(var u;o;){if(o.nodeType===3){if(u=r+o.textContent.length,r<=i&&u>=i)return{node:o,offset:i-r};r=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Vy(o)}}function Yy(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?Yy(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function Xy(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var i=Li(r.document);i instanceof r.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)r=i.contentWindow;else break;i=Li(r.document)}return i}function Yf(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}var ST=Sr&&"documentMode"in document&&11>=document.documentMode,Fi=null,Xf=null,po=null,Kf=!1;function Ky(r,i,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Kf||Fi==null||Fi!==Li(u)||(u=Fi,"selectionStart"in u&&Yf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),po&&mo(po,u)||(po=u,u=pu(Xf,"onSelect"),0<u.length&&(i=new Sc("onSelect","select",null,i,o),r.push({event:i,listeners:u}),i.target=Fi)))}function Fs(r,i){var o={};return o[r.toLowerCase()]=i.toLowerCase(),o["Webkit"+r]="webkit"+i,o["Moz"+r]="moz"+i,o}var Vi={animationend:Fs("Animation","AnimationEnd"),animationiteration:Fs("Animation","AnimationIteration"),animationstart:Fs("Animation","AnimationStart"),transitionrun:Fs("Transition","TransitionRun"),transitionstart:Fs("Transition","TransitionStart"),transitioncancel:Fs("Transition","TransitionCancel"),transitionend:Fs("Transition","TransitionEnd")},Wf={},Wy={};Sr&&(Wy=document.createElement("div").style,"AnimationEvent"in window||(delete Vi.animationend.animation,delete Vi.animationiteration.animation,delete Vi.animationstart.animation),"TransitionEvent"in window||delete Vi.transitionend.transition);function Vs(r){if(Wf[r])return Wf[r];if(!Vi[r])return r;var i=Vi[r],o;for(o in i)if(i.hasOwnProperty(o)&&o in Wy)return Wf[r]=i[o];return r}var Jy=Vs("animationend"),Zy=Vs("animationiteration"),e0=Vs("animationstart"),CT=Vs("transitionrun"),TT=Vs("transitionstart"),NT=Vs("transitioncancel"),t0=Vs("transitionend"),n0=new Map,Jf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Jf.push("scrollEnd");function Vn(r,i){n0.set(r,i),Ar(i,[r])}var Nc=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},Mn=[],Gi=0,Zf=0;function Rc(){for(var r=Gi,i=Zf=Gi=0;i<r;){var o=Mn[i];Mn[i++]=null;var u=Mn[i];Mn[i++]=null;var g=Mn[i];Mn[i++]=null;var v=Mn[i];if(Mn[i++]=null,u!==null&&g!==null){var N=u.pending;N===null?g.next=g:(g.next=N.next,N.next=g),u.pending=g}v!==0&&r0(o,g,v)}}function jc(r,i,o,u){Mn[Gi++]=r,Mn[Gi++]=i,Mn[Gi++]=o,Mn[Gi++]=u,Zf|=u,r.lanes|=u,r=r.alternate,r!==null&&(r.lanes|=u)}function eh(r,i,o,u){return jc(r,i,o,u),Oc(r)}function Gs(r,i){return jc(r,null,null,i),Oc(r)}function r0(r,i,o){r.lanes|=o;var u=r.alternate;u!==null&&(u.lanes|=o);for(var g=!1,v=r.return;v!==null;)v.childLanes|=o,u=v.alternate,u!==null&&(u.childLanes|=o),v.tag===22&&(r=v.stateNode,r===null||r._visibility&1||(g=!0)),r=v,v=v.return;return r.tag===3?(v=r.stateNode,g&&i!==null&&(g=31-Zt(o),r=v.hiddenUpdates,u=r[g],u===null?r[g]=[i]:u.push(i),i.lane=o|536870912),v):null}function Oc(r){if(50<Uo)throw Uo=0,cm=null,Error(s(185));for(var i=r.return;i!==null;)r=i,i=r.return;return r.tag===3?r.stateNode:null}var Yi={};function RT(r,i,o,u){this.tag=r,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vn(r,i,o,u){return new RT(r,i,o,u)}function th(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Cr(r,i){var o=r.alternate;return o===null?(o=vn(r.tag,i,r.key,r.mode),o.elementType=r.elementType,o.type=r.type,o.stateNode=r.stateNode,o.alternate=r,r.alternate=o):(o.pendingProps=i,o.type=r.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=r.flags&65011712,o.childLanes=r.childLanes,o.lanes=r.lanes,o.child=r.child,o.memoizedProps=r.memoizedProps,o.memoizedState=r.memoizedState,o.updateQueue=r.updateQueue,i=r.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=r.sibling,o.index=r.index,o.ref=r.ref,o.refCleanup=r.refCleanup,o}function s0(r,i){r.flags&=65011714;var o=r.alternate;return o===null?(r.childLanes=0,r.lanes=i,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,i=o.dependencies,r.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),r}function Ic(r,i,o,u,g,v){var N=0;if(u=r,typeof r=="function")th(r)&&(N=1);else if(typeof r=="string")N=MN(r,o,J.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case q:return r=vn(31,o,i,g),r.elementType=q,r.lanes=v,r;case w:return Ys(o.children,g,v,i);case A:N=8,g|=24;break;case S:return r=vn(12,o,i,g|2),r.elementType=S,r.lanes=v,r;case j:return r=vn(13,o,i,g),r.elementType=j,r.lanes=v,r;case O:return r=vn(19,o,i,g),r.elementType=O,r.lanes=v,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case E:N=10;break e;case T:N=9;break e;case C:N=11;break e;case M:N=14;break e;case D:N=16,u=null;break e}N=29,o=Error(s(130,r===null?"null":typeof r,"")),u=null}return i=vn(N,o,i,g),i.elementType=r,i.type=u,i.lanes=v,i}function Ys(r,i,o,u){return r=vn(7,r,u,i),r.lanes=o,r}function nh(r,i,o){return r=vn(6,r,null,i),r.lanes=o,r}function i0(r){var i=vn(18,null,null,0);return i.stateNode=r,i}function rh(r,i,o){return i=vn(4,r.children!==null?r.children:[],r.key,i),i.lanes=o,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}var a0=new WeakMap;function Dn(r,i){if(typeof r=="object"&&r!==null){var o=a0.get(r);return o!==void 0?o:(i={value:r,source:i,stack:De(i)},a0.set(r,i),i)}return{value:r,source:i,stack:De(i)}}var Xi=[],Ki=0,kc=null,go=0,Bn=[],Un=0,as=null,lr=1,cr="";function Tr(r,i){Xi[Ki++]=go,Xi[Ki++]=kc,kc=r,go=i}function o0(r,i,o){Bn[Un++]=lr,Bn[Un++]=cr,Bn[Un++]=as,as=r;var u=lr;r=cr;var g=32-Zt(u)-1;u&=~(1<<g),o+=1;var v=32-Zt(i)+g;if(30<v){var N=g-g%5;v=(u&(1<<N)-1).toString(32),u>>=N,g-=N,lr=1<<32-Zt(i)+g|o<<g|u,cr=v+r}else lr=1<<v|o<<g|u,cr=r}function sh(r){r.return!==null&&(Tr(r,1),o0(r,1,0))}function ih(r){for(;r===kc;)kc=Xi[--Ki],Xi[Ki]=null,go=Xi[--Ki],Xi[Ki]=null;for(;r===as;)as=Bn[--Un],Bn[Un]=null,cr=Bn[--Un],Bn[Un]=null,lr=Bn[--Un],Bn[Un]=null}function l0(r,i){Bn[Un++]=lr,Bn[Un++]=cr,Bn[Un++]=as,lr=i.id,cr=i.overflow,as=r}var zt=null,ut=null,Ye=!1,os=null,Ln=!1,ah=Error(s(519));function ls(r){var i=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw yo(Dn(i,r)),ah}function c0(r){var i=r.stateNode,o=r.type,u=r.memoizedProps;switch(i[It]=r,i[Yt]=u,o){case"dialog":Qe("cancel",i),Qe("close",i);break;case"iframe":case"object":case"embed":Qe("load",i);break;case"video":case"audio":for(o=0;o<$o.length;o++)Qe($o[o],i);break;case"source":Qe("error",i);break;case"img":case"image":case"link":Qe("error",i),Qe("load",i);break;case"details":Qe("toggle",i);break;case"input":Qe("invalid",i),bc(i,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Qe("invalid",i);break;case"textarea":Qe("invalid",i),Ey(i,u.value,u.defaultValue,u.children)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||i.textContent===""+o||u.suppressHydrationWarning===!0||C_(i.textContent,o)?(u.popover!=null&&(Qe("beforetoggle",i),Qe("toggle",i)),u.onScroll!=null&&Qe("scroll",i),u.onScrollEnd!=null&&Qe("scrollend",i),u.onClick!=null&&(i.onclick=Er),i=!0):i=!1,i||ls(r,!0)}function u0(r){for(zt=r.return;zt;)switch(zt.tag){case 5:case 31:case 13:Ln=!1;return;case 27:case 3:Ln=!0;return;default:zt=zt.return}}function Wi(r){if(r!==zt)return!1;if(!Ye)return u0(r),Ye=!0,!1;var i=r.tag,o;if((o=i!==3&&i!==27)&&((o=i===5)&&(o=r.type,o=!(o!=="form"&&o!=="button")||Em(r.type,r.memoizedProps)),o=!o),o&&ut&&ls(r),u0(r),i===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(317));ut=D_(r)}else if(i===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(317));ut=D_(r)}else i===27?(i=ut,xs(r.type)?(r=Rm,Rm=null,ut=r):ut=i):ut=zt?zn(r.stateNode.nextSibling):null;return!0}function Xs(){ut=zt=null,Ye=!1}function oh(){var r=os;return r!==null&&(un===null?un=r:un.push.apply(un,r),os=null),r}function yo(r){os===null?os=[r]:os.push(r)}var lh=I(null),Ks=null,Nr=null;function cs(r,i,o){Y(lh,i._currentValue),i._currentValue=o}function Rr(r){r._currentValue=lh.current,P(lh)}function ch(r,i,o){for(;r!==null;){var u=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,u!==null&&(u.childLanes|=i)):u!==null&&(u.childLanes&i)!==i&&(u.childLanes|=i),r===o)break;r=r.return}}function uh(r,i,o,u){var g=r.child;for(g!==null&&(g.return=r);g!==null;){var v=g.dependencies;if(v!==null){var N=g.child;v=v.firstContext;e:for(;v!==null;){var z=v;v=g;for(var X=0;X<i.length;X++)if(z.context===i[X]){v.lanes|=o,z=v.alternate,z!==null&&(z.lanes|=o),ch(v.return,o,r),u||(N=null);break e}v=z.next}}else if(g.tag===18){if(N=g.return,N===null)throw Error(s(341));N.lanes|=o,v=N.alternate,v!==null&&(v.lanes|=o),ch(N,o,r),N=null}else N=g.child;if(N!==null)N.return=g;else for(N=g;N!==null;){if(N===r){N=null;break}if(g=N.sibling,g!==null){g.return=N.return,N=g;break}N=N.return}g=N}}function Ji(r,i,o,u){r=null;for(var g=i,v=!1;g!==null;){if(!v){if((g.flags&524288)!==0)v=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var N=g.alternate;if(N===null)throw Error(s(387));if(N=N.memoizedProps,N!==null){var z=g.type;yn(g.pendingProps.value,N.value)||(r!==null?r.push(z):r=[z])}}else if(g===ce.current){if(N=g.alternate,N===null)throw Error(s(387));N.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(r!==null?r.push(Qo):r=[Qo])}g=g.return}r!==null&&uh(i,r,o,u),i.flags|=262144}function Mc(r){for(r=r.firstContext;r!==null;){if(!yn(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Ws(r){Ks=r,Nr=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Pt(r){return d0(Ks,r)}function Dc(r,i){return Ks===null&&Ws(r),d0(r,i)}function d0(r,i){var o=i._currentValue;if(i={context:i,memoizedValue:o,next:null},Nr===null){if(r===null)throw Error(s(308));Nr=i,r.dependencies={lanes:0,firstContext:i},r.flags|=524288}else Nr=Nr.next=i;return o}var jT=typeof AbortController<"u"?AbortController:function(){var r=[],i=this.signal={aborted:!1,addEventListener:function(o,u){r.push(u)}};this.abort=function(){i.aborted=!0,r.forEach(function(o){return o()})}},OT=t.unstable_scheduleCallback,IT=t.unstable_NormalPriority,Et={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function dh(){return{controller:new jT,data:new Map,refCount:0}}function vo(r){r.refCount--,r.refCount===0&&OT(IT,function(){r.controller.abort()})}var _o=null,fh=0,Zi=0,ea=null;function kT(r,i){if(_o===null){var o=_o=[];fh=0,Zi=pm(),ea={status:"pending",value:void 0,then:function(u){o.push(u)}}}return fh++,i.then(f0,f0),i}function f0(){if(--fh===0&&_o!==null){ea!==null&&(ea.status="fulfilled");var r=_o;_o=null,Zi=0,ea=null;for(var i=0;i<r.length;i++)(0,r[i])()}}function MT(r,i){var o=[],u={status:"pending",value:null,reason:null,then:function(g){o.push(g)}};return r.then(function(){u.status="fulfilled",u.value=i;for(var g=0;g<o.length;g++)(0,o[g])(i)},function(g){for(u.status="rejected",u.reason=g,g=0;g<o.length;g++)(0,o[g])(void 0)}),u}var h0=R.S;R.S=function(r,i){Kv=ft(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&kT(r,i),h0!==null&&h0(r,i)};var Js=I(null);function hh(){var r=Js.current;return r!==null?r:ot.pooledCache}function Bc(r,i){i===null?Y(Js,Js.current):Y(Js,i.pool)}function m0(){var r=hh();return r===null?null:{parent:Et._currentValue,pool:r}}var ta=Error(s(460)),mh=Error(s(474)),Uc=Error(s(542)),Lc={then:function(){}};function p0(r){return r=r.status,r==="fulfilled"||r==="rejected"}function g0(r,i,o){switch(o=r[o],o===void 0?r.push(i):o!==i&&(i.then(Er,Er),i=o),i.status){case"fulfilled":return i.value;case"rejected":throw r=i.reason,v0(r),r;default:if(typeof i.status=="string")i.then(Er,Er);else{if(r=ot,r!==null&&100<r.shellSuspendCounter)throw Error(s(482));r=i,r.status="pending",r.then(function(u){if(i.status==="pending"){var g=i;g.status="fulfilled",g.value=u}},function(u){if(i.status==="pending"){var g=i;g.status="rejected",g.reason=u}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw r=i.reason,v0(r),r}throw ei=i,ta}}function Zs(r){try{var i=r._init;return i(r._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(ei=o,ta):o}}var ei=null;function y0(){if(ei===null)throw Error(s(459));var r=ei;return ei=null,r}function v0(r){if(r===ta||r===Uc)throw Error(s(483))}var na=null,bo=0;function $c(r){var i=bo;return bo+=1,na===null&&(na=[]),g0(na,r,i)}function wo(r,i){i=i.props.ref,r.ref=i!==void 0?i:null}function zc(r,i){throw i.$$typeof===y?Error(s(525)):(r=Object.prototype.toString.call(i),Error(s(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r)))}function _0(r){function i(ee,W){if(r){var ne=ee.deletions;ne===null?(ee.deletions=[W],ee.flags|=16):ne.push(W)}}function o(ee,W){if(!r)return null;for(;W!==null;)i(ee,W),W=W.sibling;return null}function u(ee){for(var W=new Map;ee!==null;)ee.key!==null?W.set(ee.key,ee):W.set(ee.index,ee),ee=ee.sibling;return W}function g(ee,W){return ee=Cr(ee,W),ee.index=0,ee.sibling=null,ee}function v(ee,W,ne){return ee.index=ne,r?(ne=ee.alternate,ne!==null?(ne=ne.index,ne<W?(ee.flags|=67108866,W):ne):(ee.flags|=67108866,W)):(ee.flags|=1048576,W)}function N(ee){return r&&ee.alternate===null&&(ee.flags|=67108866),ee}function z(ee,W,ne,de){return W===null||W.tag!==6?(W=nh(ne,ee.mode,de),W.return=ee,W):(W=g(W,ne),W.return=ee,W)}function X(ee,W,ne,de){var Oe=ne.type;return Oe===w?le(ee,W,ne.props.children,de,ne.key):W!==null&&(W.elementType===Oe||typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===D&&Zs(Oe)===W.type)?(W=g(W,ne.props),wo(W,ne),W.return=ee,W):(W=Ic(ne.type,ne.key,ne.props,null,ee.mode,de),wo(W,ne),W.return=ee,W)}function re(ee,W,ne,de){return W===null||W.tag!==4||W.stateNode.containerInfo!==ne.containerInfo||W.stateNode.implementation!==ne.implementation?(W=rh(ne,ee.mode,de),W.return=ee,W):(W=g(W,ne.children||[]),W.return=ee,W)}function le(ee,W,ne,de,Oe){return W===null||W.tag!==7?(W=Ys(ne,ee.mode,de,Oe),W.return=ee,W):(W=g(W,ne),W.return=ee,W)}function me(ee,W,ne){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=nh(""+W,ee.mode,ne),W.return=ee,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case _:return ne=Ic(W.type,W.key,W.props,null,ee.mode,ne),wo(ne,W),ne.return=ee,ne;case x:return W=rh(W,ee.mode,ne),W.return=ee,W;case D:return W=Zs(W),me(ee,W,ne)}if(Q(W)||F(W))return W=Ys(W,ee.mode,ne,null),W.return=ee,W;if(typeof W.then=="function")return me(ee,$c(W),ne);if(W.$$typeof===E)return me(ee,Dc(ee,W),ne);zc(ee,W)}return null}function ie(ee,W,ne,de){var Oe=W!==null?W.key:null;if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return Oe!==null?null:z(ee,W,""+ne,de);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case _:return ne.key===Oe?X(ee,W,ne,de):null;case x:return ne.key===Oe?re(ee,W,ne,de):null;case D:return ne=Zs(ne),ie(ee,W,ne,de)}if(Q(ne)||F(ne))return Oe!==null?null:le(ee,W,ne,de,null);if(typeof ne.then=="function")return ie(ee,W,$c(ne),de);if(ne.$$typeof===E)return ie(ee,W,Dc(ee,ne),de);zc(ee,ne)}return null}function oe(ee,W,ne,de,Oe){if(typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint")return ee=ee.get(ne)||null,z(W,ee,""+de,Oe);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case _:return ee=ee.get(de.key===null?ne:de.key)||null,X(W,ee,de,Oe);case x:return ee=ee.get(de.key===null?ne:de.key)||null,re(W,ee,de,Oe);case D:return de=Zs(de),oe(ee,W,ne,de,Oe)}if(Q(de)||F(de))return ee=ee.get(ne)||null,le(W,ee,de,Oe,null);if(typeof de.then=="function")return oe(ee,W,ne,$c(de),Oe);if(de.$$typeof===E)return oe(ee,W,ne,Dc(W,de),Oe);zc(W,de)}return null}function Ae(ee,W,ne,de){for(var Oe=null,We=null,Se=W,Pe=W=0,Ve=null;Se!==null&&Pe<ne.length;Pe++){Se.index>Pe?(Ve=Se,Se=null):Ve=Se.sibling;var Je=ie(ee,Se,ne[Pe],de);if(Je===null){Se===null&&(Se=Ve);break}r&&Se&&Je.alternate===null&&i(ee,Se),W=v(Je,W,Pe),We===null?Oe=Je:We.sibling=Je,We=Je,Se=Ve}if(Pe===ne.length)return o(ee,Se),Ye&&Tr(ee,Pe),Oe;if(Se===null){for(;Pe<ne.length;Pe++)Se=me(ee,ne[Pe],de),Se!==null&&(W=v(Se,W,Pe),We===null?Oe=Se:We.sibling=Se,We=Se);return Ye&&Tr(ee,Pe),Oe}for(Se=u(Se);Pe<ne.length;Pe++)Ve=oe(Se,ee,Pe,ne[Pe],de),Ve!==null&&(r&&Ve.alternate!==null&&Se.delete(Ve.key===null?Pe:Ve.key),W=v(Ve,W,Pe),We===null?Oe=Ve:We.sibling=Ve,We=Ve);return r&&Se.forEach(function(Ts){return i(ee,Ts)}),Ye&&Tr(ee,Pe),Oe}function ke(ee,W,ne,de){if(ne==null)throw Error(s(151));for(var Oe=null,We=null,Se=W,Pe=W=0,Ve=null,Je=ne.next();Se!==null&&!Je.done;Pe++,Je=ne.next()){Se.index>Pe?(Ve=Se,Se=null):Ve=Se.sibling;var Ts=ie(ee,Se,Je.value,de);if(Ts===null){Se===null&&(Se=Ve);break}r&&Se&&Ts.alternate===null&&i(ee,Se),W=v(Ts,W,Pe),We===null?Oe=Ts:We.sibling=Ts,We=Ts,Se=Ve}if(Je.done)return o(ee,Se),Ye&&Tr(ee,Pe),Oe;if(Se===null){for(;!Je.done;Pe++,Je=ne.next())Je=me(ee,Je.value,de),Je!==null&&(W=v(Je,W,Pe),We===null?Oe=Je:We.sibling=Je,We=Je);return Ye&&Tr(ee,Pe),Oe}for(Se=u(Se);!Je.done;Pe++,Je=ne.next())Je=oe(Se,ee,Pe,Je.value,de),Je!==null&&(r&&Je.alternate!==null&&Se.delete(Je.key===null?Pe:Je.key),W=v(Je,W,Pe),We===null?Oe=Je:We.sibling=Je,We=Je);return r&&Se.forEach(function(FN){return i(ee,FN)}),Ye&&Tr(ee,Pe),Oe}function at(ee,W,ne,de){if(typeof ne=="object"&&ne!==null&&ne.type===w&&ne.key===null&&(ne=ne.props.children),typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case _:e:{for(var Oe=ne.key;W!==null;){if(W.key===Oe){if(Oe=ne.type,Oe===w){if(W.tag===7){o(ee,W.sibling),de=g(W,ne.props.children),de.return=ee,ee=de;break e}}else if(W.elementType===Oe||typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===D&&Zs(Oe)===W.type){o(ee,W.sibling),de=g(W,ne.props),wo(de,ne),de.return=ee,ee=de;break e}o(ee,W);break}else i(ee,W);W=W.sibling}ne.type===w?(de=Ys(ne.props.children,ee.mode,de,ne.key),de.return=ee,ee=de):(de=Ic(ne.type,ne.key,ne.props,null,ee.mode,de),wo(de,ne),de.return=ee,ee=de)}return N(ee);case x:e:{for(Oe=ne.key;W!==null;){if(W.key===Oe)if(W.tag===4&&W.stateNode.containerInfo===ne.containerInfo&&W.stateNode.implementation===ne.implementation){o(ee,W.sibling),de=g(W,ne.children||[]),de.return=ee,ee=de;break e}else{o(ee,W);break}else i(ee,W);W=W.sibling}de=rh(ne,ee.mode,de),de.return=ee,ee=de}return N(ee);case D:return ne=Zs(ne),at(ee,W,ne,de)}if(Q(ne))return Ae(ee,W,ne,de);if(F(ne)){if(Oe=F(ne),typeof Oe!="function")throw Error(s(150));return ne=Oe.call(ne),ke(ee,W,ne,de)}if(typeof ne.then=="function")return at(ee,W,$c(ne),de);if(ne.$$typeof===E)return at(ee,W,Dc(ee,ne),de);zc(ee,ne)}return typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint"?(ne=""+ne,W!==null&&W.tag===6?(o(ee,W.sibling),de=g(W,ne),de.return=ee,ee=de):(o(ee,W),de=nh(ne,ee.mode,de),de.return=ee,ee=de),N(ee)):o(ee,W)}return function(ee,W,ne,de){try{bo=0;var Oe=at(ee,W,ne,de);return na=null,Oe}catch(Se){if(Se===ta||Se===Uc)throw Se;var We=vn(29,Se,null,ee.mode);return We.lanes=de,We.return=ee,We}finally{}}}var ti=_0(!0),b0=_0(!1),us=!1;function ph(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function gh(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function ds(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function fs(r,i,o){var u=r.updateQueue;if(u===null)return null;if(u=u.shared,(Ze&2)!==0){var g=u.pending;return g===null?i.next=i:(i.next=g.next,g.next=i),u.pending=i,i=Oc(r),r0(r,null,o),i}return jc(r,u,i,o),Oc(r)}function xo(r,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194048)!==0)){var u=i.lanes;u&=r.pendingLanes,o|=u,i.lanes=o,cc(r,o)}}function yh(r,i){var o=r.updateQueue,u=r.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var g=null,v=null;if(o=o.firstBaseUpdate,o!==null){do{var N={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};v===null?g=v=N:v=v.next=N,o=o.next}while(o!==null);v===null?g=v=i:v=v.next=i}else g=v=i;o={baseState:u.baseState,firstBaseUpdate:g,lastBaseUpdate:v,shared:u.shared,callbacks:u.callbacks},r.updateQueue=o;return}r=o.lastBaseUpdate,r===null?o.firstBaseUpdate=i:r.next=i,o.lastBaseUpdate=i}var vh=!1;function Ao(){if(vh){var r=ea;if(r!==null)throw r}}function Eo(r,i,o,u){vh=!1;var g=r.updateQueue;us=!1;var v=g.firstBaseUpdate,N=g.lastBaseUpdate,z=g.shared.pending;if(z!==null){g.shared.pending=null;var X=z,re=X.next;X.next=null,N===null?v=re:N.next=re,N=X;var le=r.alternate;le!==null&&(le=le.updateQueue,z=le.lastBaseUpdate,z!==N&&(z===null?le.firstBaseUpdate=re:z.next=re,le.lastBaseUpdate=X))}if(v!==null){var me=g.baseState;N=0,le=re=X=null,z=v;do{var ie=z.lane&-536870913,oe=ie!==z.lane;if(oe?(Fe&ie)===ie:(u&ie)===ie){ie!==0&&ie===Zi&&(vh=!0),le!==null&&(le=le.next={lane:0,tag:z.tag,payload:z.payload,callback:null,next:null});e:{var Ae=r,ke=z;ie=i;var at=o;switch(ke.tag){case 1:if(Ae=ke.payload,typeof Ae=="function"){me=Ae.call(at,me,ie);break e}me=Ae;break e;case 3:Ae.flags=Ae.flags&-65537|128;case 0:if(Ae=ke.payload,ie=typeof Ae=="function"?Ae.call(at,me,ie):Ae,ie==null)break e;me=m({},me,ie);break e;case 2:us=!0}}ie=z.callback,ie!==null&&(r.flags|=64,oe&&(r.flags|=8192),oe=g.callbacks,oe===null?g.callbacks=[ie]:oe.push(ie))}else oe={lane:ie,tag:z.tag,payload:z.payload,callback:z.callback,next:null},le===null?(re=le=oe,X=me):le=le.next=oe,N|=ie;if(z=z.next,z===null){if(z=g.shared.pending,z===null)break;oe=z,z=oe.next,oe.next=null,g.lastBaseUpdate=oe,g.shared.pending=null}}while(!0);le===null&&(X=me),g.baseState=X,g.firstBaseUpdate=re,g.lastBaseUpdate=le,v===null&&(g.shared.lanes=0),ys|=N,r.lanes=N,r.memoizedState=me}}function w0(r,i){if(typeof r!="function")throw Error(s(191,r));r.call(i)}function x0(r,i){var o=r.callbacks;if(o!==null)for(r.callbacks=null,r=0;r<o.length;r++)w0(o[r],i)}var ra=I(null),Pc=I(0);function A0(r,i){r=Lr,Y(Pc,r),Y(ra,i),Lr=r|i.baseLanes}function _h(){Y(Pc,Lr),Y(ra,ra.current)}function bh(){Lr=Pc.current,P(ra),P(Pc)}var _n=I(null),$n=null;function hs(r){var i=r.alternate;Y(wt,wt.current&1),Y(_n,r),$n===null&&(i===null||ra.current!==null||i.memoizedState!==null)&&($n=r)}function wh(r){Y(wt,wt.current),Y(_n,r),$n===null&&($n=r)}function E0(r){r.tag===22?(Y(wt,wt.current),Y(_n,r),$n===null&&($n=r)):ms()}function ms(){Y(wt,wt.current),Y(_n,_n.current)}function bn(r){P(_n),$n===r&&($n=null),P(wt)}var wt=I(0);function Hc(r){for(var i=r;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||Tm(o)||Nm(o)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var jr=0,ze=null,st=null,St=null,qc=!1,sa=!1,ni=!1,Qc=0,So=0,ia=null,DT=0;function _t(){throw Error(s(321))}function xh(r,i){if(i===null)return!1;for(var o=0;o<i.length&&o<r.length;o++)if(!yn(r[o],i[o]))return!1;return!0}function Ah(r,i,o,u,g,v){return jr=v,ze=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,R.H=r===null||r.memoizedState===null?ov:Lh,ni=!1,v=o(u,g),ni=!1,sa&&(v=C0(i,o,u,g)),S0(r),v}function S0(r){R.H=No;var i=st!==null&&st.next!==null;if(jr=0,St=st=ze=null,qc=!1,So=0,ia=null,i)throw Error(s(300));r===null||Ct||(r=r.dependencies,r!==null&&Mc(r)&&(Ct=!0))}function C0(r,i,o,u){ze=r;var g=0;do{if(sa&&(ia=null),So=0,sa=!1,25<=g)throw Error(s(301));if(g+=1,St=st=null,r.updateQueue!=null){var v=r.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}R.H=lv,v=i(o,u)}while(sa);return v}function BT(){var r=R.H,i=r.useState()[0];return i=typeof i.then=="function"?Co(i):i,r=r.useState()[0],(st!==null?st.memoizedState:null)!==r&&(ze.flags|=1024),i}function Eh(){var r=Qc!==0;return Qc=0,r}function Sh(r,i,o){i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~o}function Ch(r){if(qc){for(r=r.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}qc=!1}jr=0,St=st=ze=null,sa=!1,So=Qc=0,ia=null}function en(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return St===null?ze.memoizedState=St=r:St=St.next=r,St}function xt(){if(st===null){var r=ze.alternate;r=r!==null?r.memoizedState:null}else r=st.next;var i=St===null?ze.memoizedState:St.next;if(i!==null)St=i,st=r;else{if(r===null)throw ze.alternate===null?Error(s(467)):Error(s(310));st=r,r={memoizedState:st.memoizedState,baseState:st.baseState,baseQueue:st.baseQueue,queue:st.queue,next:null},St===null?ze.memoizedState=St=r:St=St.next=r}return St}function Fc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Co(r){var i=So;return So+=1,ia===null&&(ia=[]),r=g0(ia,r,i),i=ze,(St===null?i.memoizedState:St.next)===null&&(i=i.alternate,R.H=i===null||i.memoizedState===null?ov:Lh),r}function Vc(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Co(r);if(r.$$typeof===E)return Pt(r)}throw Error(s(438,String(r)))}function Th(r){var i=null,o=ze.updateQueue;if(o!==null&&(i=o.memoCache),i==null){var u=ze.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(i={data:u.data.map(function(g){return g.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),o===null&&(o=Fc(),ze.updateQueue=o),o.memoCache=i,o=i.data[i.index],o===void 0)for(o=i.data[i.index]=Array(r),u=0;u<r;u++)o[u]=G;return i.index++,o}function Or(r,i){return typeof i=="function"?i(r):i}function Gc(r){var i=xt();return Nh(i,st,r)}function Nh(r,i,o){var u=r.queue;if(u===null)throw Error(s(311));u.lastRenderedReducer=o;var g=r.baseQueue,v=u.pending;if(v!==null){if(g!==null){var N=g.next;g.next=v.next,v.next=N}i.baseQueue=g=v,u.pending=null}if(v=r.baseState,g===null)r.memoizedState=v;else{i=g.next;var z=N=null,X=null,re=i,le=!1;do{var me=re.lane&-536870913;if(me!==re.lane?(Fe&me)===me:(jr&me)===me){var ie=re.revertLane;if(ie===0)X!==null&&(X=X.next={lane:0,revertLane:0,gesture:null,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null}),me===Zi&&(le=!0);else if((jr&ie)===ie){re=re.next,ie===Zi&&(le=!0);continue}else me={lane:0,revertLane:re.revertLane,gesture:null,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null},X===null?(z=X=me,N=v):X=X.next=me,ze.lanes|=ie,ys|=ie;me=re.action,ni&&o(v,me),v=re.hasEagerState?re.eagerState:o(v,me)}else ie={lane:me,revertLane:re.revertLane,gesture:re.gesture,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null},X===null?(z=X=ie,N=v):X=X.next=ie,ze.lanes|=me,ys|=me;re=re.next}while(re!==null&&re!==i);if(X===null?N=v:X.next=z,!yn(v,r.memoizedState)&&(Ct=!0,le&&(o=ea,o!==null)))throw o;r.memoizedState=v,r.baseState=N,r.baseQueue=X,u.lastRenderedState=v}return g===null&&(u.lanes=0),[r.memoizedState,u.dispatch]}function Rh(r){var i=xt(),o=i.queue;if(o===null)throw Error(s(311));o.lastRenderedReducer=r;var u=o.dispatch,g=o.pending,v=i.memoizedState;if(g!==null){o.pending=null;var N=g=g.next;do v=r(v,N.action),N=N.next;while(N!==g);yn(v,i.memoizedState)||(Ct=!0),i.memoizedState=v,i.baseQueue===null&&(i.baseState=v),o.lastRenderedState=v}return[v,u]}function T0(r,i,o){var u=ze,g=xt(),v=Ye;if(v){if(o===void 0)throw Error(s(407));o=o()}else o=i();var N=!yn((st||g).memoizedState,o);if(N&&(g.memoizedState=o,Ct=!0),g=g.queue,Ih(j0.bind(null,u,g,r),[r]),g.getSnapshot!==i||N||St!==null&&St.memoizedState.tag&1){if(u.flags|=2048,aa(9,{destroy:void 0},R0.bind(null,u,g,o,i),null),ot===null)throw Error(s(349));v||(jr&127)!==0||N0(u,i,o)}return o}function N0(r,i,o){r.flags|=16384,r={getSnapshot:i,value:o},i=ze.updateQueue,i===null?(i=Fc(),ze.updateQueue=i,i.stores=[r]):(o=i.stores,o===null?i.stores=[r]:o.push(r))}function R0(r,i,o,u){i.value=o,i.getSnapshot=u,O0(i)&&I0(r)}function j0(r,i,o){return o(function(){O0(i)&&I0(r)})}function O0(r){var i=r.getSnapshot;r=r.value;try{var o=i();return!yn(r,o)}catch{return!0}}function I0(r){var i=Gs(r,2);i!==null&&dn(i,r,2)}function jh(r){var i=en();if(typeof r=="function"){var o=r;if(r=o(),ni){pt(!0);try{o()}finally{pt(!1)}}}return i.memoizedState=i.baseState=r,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Or,lastRenderedState:r},i}function k0(r,i,o,u){return r.baseState=o,Nh(r,st,typeof u=="function"?u:Or)}function UT(r,i,o,u,g){if(Kc(r))throw Error(s(485));if(r=i.action,r!==null){var v={payload:g,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){v.listeners.push(N)}};R.T!==null?o(!0):v.isTransition=!1,u(v),o=i.pending,o===null?(v.next=i.pending=v,M0(i,v)):(v.next=o.next,i.pending=o.next=v)}}function M0(r,i){var o=i.action,u=i.payload,g=r.state;if(i.isTransition){var v=R.T,N={};R.T=N;try{var z=o(g,u),X=R.S;X!==null&&X(N,z),D0(r,i,z)}catch(re){Oh(r,i,re)}finally{v!==null&&N.types!==null&&(v.types=N.types),R.T=v}}else try{v=o(g,u),D0(r,i,v)}catch(re){Oh(r,i,re)}}function D0(r,i,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){B0(r,i,u)},function(u){return Oh(r,i,u)}):B0(r,i,o)}function B0(r,i,o){i.status="fulfilled",i.value=o,U0(i),r.state=o,i=r.pending,i!==null&&(o=i.next,o===i?r.pending=null:(o=o.next,i.next=o,M0(r,o)))}function Oh(r,i,o){var u=r.pending;if(r.pending=null,u!==null){u=u.next;do i.status="rejected",i.reason=o,U0(i),i=i.next;while(i!==u)}r.action=null}function U0(r){r=r.listeners;for(var i=0;i<r.length;i++)(0,r[i])()}function L0(r,i){return i}function $0(r,i){if(Ye){var o=ot.formState;if(o!==null){e:{var u=ze;if(Ye){if(ut){t:{for(var g=ut,v=Ln;g.nodeType!==8;){if(!v){g=null;break t}if(g=zn(g.nextSibling),g===null){g=null;break t}}v=g.data,g=v==="F!"||v==="F"?g:null}if(g){ut=zn(g.nextSibling),u=g.data==="F!";break e}}ls(u)}u=!1}u&&(i=o[0])}}return o=en(),o.memoizedState=o.baseState=i,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:L0,lastRenderedState:i},o.queue=u,o=sv.bind(null,ze,u),u.dispatch=o,u=jh(!1),v=Uh.bind(null,ze,!1,u.queue),u=en(),g={state:i,dispatch:null,action:r,pending:null},u.queue=g,o=UT.bind(null,ze,g,v,o),g.dispatch=o,u.memoizedState=r,[i,o,!1]}function z0(r){var i=xt();return P0(i,st,r)}function P0(r,i,o){if(i=Nh(r,i,L0)[0],r=Gc(Or)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var u=Co(i)}catch(N){throw N===ta?Uc:N}else u=i;i=xt();var g=i.queue,v=g.dispatch;return o!==i.memoizedState&&(ze.flags|=2048,aa(9,{destroy:void 0},LT.bind(null,g,o),null)),[u,v,r]}function LT(r,i){r.action=i}function H0(r){var i=xt(),o=st;if(o!==null)return P0(i,o,r);xt(),i=i.memoizedState,o=xt();var u=o.queue.dispatch;return o.memoizedState=r,[i,u,!1]}function aa(r,i,o,u){return r={tag:r,create:o,deps:u,inst:i,next:null},i=ze.updateQueue,i===null&&(i=Fc(),ze.updateQueue=i),o=i.lastEffect,o===null?i.lastEffect=r.next=r:(u=o.next,o.next=r,r.next=u,i.lastEffect=r),r}function q0(){return xt().memoizedState}function Yc(r,i,o,u){var g=en();ze.flags|=r,g.memoizedState=aa(1|i,{destroy:void 0},o,u===void 0?null:u)}function Xc(r,i,o,u){var g=xt();u=u===void 0?null:u;var v=g.memoizedState.inst;st!==null&&u!==null&&xh(u,st.memoizedState.deps)?g.memoizedState=aa(i,v,o,u):(ze.flags|=r,g.memoizedState=aa(1|i,v,o,u))}function Q0(r,i){Yc(8390656,8,r,i)}function Ih(r,i){Xc(2048,8,r,i)}function $T(r){ze.flags|=4;var i=ze.updateQueue;if(i===null)i=Fc(),ze.updateQueue=i,i.events=[r];else{var o=i.events;o===null?i.events=[r]:o.push(r)}}function F0(r){var i=xt().memoizedState;return $T({ref:i,nextImpl:r}),function(){if((Ze&2)!==0)throw Error(s(440));return i.impl.apply(void 0,arguments)}}function V0(r,i){return Xc(4,2,r,i)}function G0(r,i){return Xc(4,4,r,i)}function Y0(r,i){if(typeof i=="function"){r=r();var o=i(r);return function(){typeof o=="function"?o():i(null)}}if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function X0(r,i,o){o=o!=null?o.concat([r]):null,Xc(4,4,Y0.bind(null,i,r),o)}function kh(){}function K0(r,i){var o=xt();i=i===void 0?null:i;var u=o.memoizedState;return i!==null&&xh(i,u[1])?u[0]:(o.memoizedState=[r,i],r)}function W0(r,i){var o=xt();i=i===void 0?null:i;var u=o.memoizedState;if(i!==null&&xh(i,u[1]))return u[0];if(u=r(),ni){pt(!0);try{r()}finally{pt(!1)}}return o.memoizedState=[u,i],u}function Mh(r,i,o){return o===void 0||(jr&1073741824)!==0&&(Fe&261930)===0?r.memoizedState=i:(r.memoizedState=o,r=Jv(),ze.lanes|=r,ys|=r,o)}function J0(r,i,o,u){return yn(o,i)?o:ra.current!==null?(r=Mh(r,o,u),yn(r,i)||(Ct=!0),r):(jr&42)===0||(jr&1073741824)!==0&&(Fe&261930)===0?(Ct=!0,r.memoizedState=o):(r=Jv(),ze.lanes|=r,ys|=r,i)}function Z0(r,i,o,u,g){var v=U.p;U.p=v!==0&&8>v?v:8;var N=R.T,z={};R.T=z,Uh(r,!1,i,o);try{var X=g(),re=R.S;if(re!==null&&re(z,X),X!==null&&typeof X=="object"&&typeof X.then=="function"){var le=MT(X,u);To(r,i,le,An(r))}else To(r,i,u,An(r))}catch(me){To(r,i,{then:function(){},status:"rejected",reason:me},An())}finally{U.p=v,N!==null&&z.types!==null&&(N.types=z.types),R.T=N}}function zT(){}function Dh(r,i,o,u){if(r.tag!==5)throw Error(s(476));var g=ev(r).queue;Z0(r,g,i,B,o===null?zT:function(){return tv(r),o(u)})}function ev(r){var i=r.memoizedState;if(i!==null)return i;i={memoizedState:B,baseState:B,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Or,lastRenderedState:B},next:null};var o={};return i.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Or,lastRenderedState:o},next:null},r.memoizedState=i,r=r.alternate,r!==null&&(r.memoizedState=i),i}function tv(r){var i=ev(r);i.next===null&&(i=r.alternate.memoizedState),To(r,i.next.queue,{},An())}function Bh(){return Pt(Qo)}function nv(){return xt().memoizedState}function rv(){return xt().memoizedState}function PT(r){for(var i=r.return;i!==null;){switch(i.tag){case 24:case 3:var o=An();r=ds(o);var u=fs(i,r,o);u!==null&&(dn(u,i,o),xo(u,i,o)),i={cache:dh()},r.payload=i;return}i=i.return}}function HT(r,i,o){var u=An();o={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Kc(r)?iv(i,o):(o=eh(r,i,o,u),o!==null&&(dn(o,r,u),av(o,i,u)))}function sv(r,i,o){var u=An();To(r,i,o,u)}function To(r,i,o,u){var g={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Kc(r))iv(i,g);else{var v=r.alternate;if(r.lanes===0&&(v===null||v.lanes===0)&&(v=i.lastRenderedReducer,v!==null))try{var N=i.lastRenderedState,z=v(N,o);if(g.hasEagerState=!0,g.eagerState=z,yn(z,N))return jc(r,i,g,0),ot===null&&Rc(),!1}catch{}finally{}if(o=eh(r,i,g,u),o!==null)return dn(o,r,u),av(o,i,u),!0}return!1}function Uh(r,i,o,u){if(u={lane:2,revertLane:pm(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Kc(r)){if(i)throw Error(s(479))}else i=eh(r,o,u,2),i!==null&&dn(i,r,2)}function Kc(r){var i=r.alternate;return r===ze||i!==null&&i===ze}function iv(r,i){sa=qc=!0;var o=r.pending;o===null?i.next=i:(i.next=o.next,o.next=i),r.pending=i}function av(r,i,o){if((o&4194048)!==0){var u=i.lanes;u&=r.pendingLanes,o|=u,i.lanes=o,cc(r,o)}}var No={readContext:Pt,use:Vc,useCallback:_t,useContext:_t,useEffect:_t,useImperativeHandle:_t,useLayoutEffect:_t,useInsertionEffect:_t,useMemo:_t,useReducer:_t,useRef:_t,useState:_t,useDebugValue:_t,useDeferredValue:_t,useTransition:_t,useSyncExternalStore:_t,useId:_t,useHostTransitionStatus:_t,useFormState:_t,useActionState:_t,useOptimistic:_t,useMemoCache:_t,useCacheRefresh:_t};No.useEffectEvent=_t;var ov={readContext:Pt,use:Vc,useCallback:function(r,i){return en().memoizedState=[r,i===void 0?null:i],r},useContext:Pt,useEffect:Q0,useImperativeHandle:function(r,i,o){o=o!=null?o.concat([r]):null,Yc(4194308,4,Y0.bind(null,i,r),o)},useLayoutEffect:function(r,i){return Yc(4194308,4,r,i)},useInsertionEffect:function(r,i){Yc(4,2,r,i)},useMemo:function(r,i){var o=en();i=i===void 0?null:i;var u=r();if(ni){pt(!0);try{r()}finally{pt(!1)}}return o.memoizedState=[u,i],u},useReducer:function(r,i,o){var u=en();if(o!==void 0){var g=o(i);if(ni){pt(!0);try{o(i)}finally{pt(!1)}}}else g=i;return u.memoizedState=u.baseState=g,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:g},u.queue=r,r=r.dispatch=HT.bind(null,ze,r),[u.memoizedState,r]},useRef:function(r){var i=en();return r={current:r},i.memoizedState=r},useState:function(r){r=jh(r);var i=r.queue,o=sv.bind(null,ze,i);return i.dispatch=o,[r.memoizedState,o]},useDebugValue:kh,useDeferredValue:function(r,i){var o=en();return Mh(o,r,i)},useTransition:function(){var r=jh(!1);return r=Z0.bind(null,ze,r.queue,!0,!1),en().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,i,o){var u=ze,g=en();if(Ye){if(o===void 0)throw Error(s(407));o=o()}else{if(o=i(),ot===null)throw Error(s(349));(Fe&127)!==0||N0(u,i,o)}g.memoizedState=o;var v={value:o,getSnapshot:i};return g.queue=v,Q0(j0.bind(null,u,v,r),[r]),u.flags|=2048,aa(9,{destroy:void 0},R0.bind(null,u,v,o,i),null),o},useId:function(){var r=en(),i=ot.identifierPrefix;if(Ye){var o=cr,u=lr;o=(u&~(1<<32-Zt(u)-1)).toString(32)+o,i="_"+i+"R_"+o,o=Qc++,0<o&&(i+="H"+o.toString(32)),i+="_"}else o=DT++,i="_"+i+"r_"+o.toString(32)+"_";return r.memoizedState=i},useHostTransitionStatus:Bh,useFormState:$0,useActionState:$0,useOptimistic:function(r){var i=en();i.memoizedState=i.baseState=r;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=o,i=Uh.bind(null,ze,!0,o),o.dispatch=i,[r,i]},useMemoCache:Th,useCacheRefresh:function(){return en().memoizedState=PT.bind(null,ze)},useEffectEvent:function(r){var i=en(),o={impl:r};return i.memoizedState=o,function(){if((Ze&2)!==0)throw Error(s(440));return o.impl.apply(void 0,arguments)}}},Lh={readContext:Pt,use:Vc,useCallback:K0,useContext:Pt,useEffect:Ih,useImperativeHandle:X0,useInsertionEffect:V0,useLayoutEffect:G0,useMemo:W0,useReducer:Gc,useRef:q0,useState:function(){return Gc(Or)},useDebugValue:kh,useDeferredValue:function(r,i){var o=xt();return J0(o,st.memoizedState,r,i)},useTransition:function(){var r=Gc(Or)[0],i=xt().memoizedState;return[typeof r=="boolean"?r:Co(r),i]},useSyncExternalStore:T0,useId:nv,useHostTransitionStatus:Bh,useFormState:z0,useActionState:z0,useOptimistic:function(r,i){var o=xt();return k0(o,st,r,i)},useMemoCache:Th,useCacheRefresh:rv};Lh.useEffectEvent=F0;var lv={readContext:Pt,use:Vc,useCallback:K0,useContext:Pt,useEffect:Ih,useImperativeHandle:X0,useInsertionEffect:V0,useLayoutEffect:G0,useMemo:W0,useReducer:Rh,useRef:q0,useState:function(){return Rh(Or)},useDebugValue:kh,useDeferredValue:function(r,i){var o=xt();return st===null?Mh(o,r,i):J0(o,st.memoizedState,r,i)},useTransition:function(){var r=Rh(Or)[0],i=xt().memoizedState;return[typeof r=="boolean"?r:Co(r),i]},useSyncExternalStore:T0,useId:nv,useHostTransitionStatus:Bh,useFormState:H0,useActionState:H0,useOptimistic:function(r,i){var o=xt();return st!==null?k0(o,st,r,i):(o.baseState=r,[r,o.queue.dispatch])},useMemoCache:Th,useCacheRefresh:rv};lv.useEffectEvent=F0;function $h(r,i,o,u){i=r.memoizedState,o=o(u,i),o=o==null?i:m({},i,o),r.memoizedState=o,r.lanes===0&&(r.updateQueue.baseState=o)}var zh={enqueueSetState:function(r,i,o){r=r._reactInternals;var u=An(),g=ds(u);g.payload=i,o!=null&&(g.callback=o),i=fs(r,g,u),i!==null&&(dn(i,r,u),xo(i,r,u))},enqueueReplaceState:function(r,i,o){r=r._reactInternals;var u=An(),g=ds(u);g.tag=1,g.payload=i,o!=null&&(g.callback=o),i=fs(r,g,u),i!==null&&(dn(i,r,u),xo(i,r,u))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var o=An(),u=ds(o);u.tag=2,i!=null&&(u.callback=i),i=fs(r,u,o),i!==null&&(dn(i,r,o),xo(i,r,o))}};function cv(r,i,o,u,g,v,N){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(u,v,N):i.prototype&&i.prototype.isPureReactComponent?!mo(o,u)||!mo(g,v):!0}function uv(r,i,o,u){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,u),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,u),i.state!==r&&zh.enqueueReplaceState(i,i.state,null)}function ri(r,i){var o=i;if("ref"in i){o={};for(var u in i)u!=="ref"&&(o[u]=i[u])}if(r=r.defaultProps){o===i&&(o=m({},o));for(var g in r)o[g]===void 0&&(o[g]=r[g])}return o}function dv(r){Nc(r)}function fv(r){console.error(r)}function hv(r){Nc(r)}function Wc(r,i){try{var o=r.onUncaughtError;o(i.value,{componentStack:i.stack})}catch(u){setTimeout(function(){throw u})}}function mv(r,i,o){try{var u=r.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Ph(r,i,o){return o=ds(o),o.tag=3,o.payload={element:null},o.callback=function(){Wc(r,i)},o}function pv(r){return r=ds(r),r.tag=3,r}function gv(r,i,o,u){var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var v=u.value;r.payload=function(){return g(v)},r.callback=function(){mv(i,o,u)}}var N=o.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(r.callback=function(){mv(i,o,u),typeof g!="function"&&(vs===null?vs=new Set([this]):vs.add(this));var z=u.stack;this.componentDidCatch(u.value,{componentStack:z!==null?z:""})})}function qT(r,i,o,u,g){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(i=o.alternate,i!==null&&Ji(i,o,g,!0),o=_n.current,o!==null){switch(o.tag){case 31:case 13:return $n===null?cu():o.alternate===null&&bt===0&&(bt=3),o.flags&=-257,o.flags|=65536,o.lanes=g,u===Lc?o.flags|=16384:(i=o.updateQueue,i===null?o.updateQueue=new Set([u]):i.add(u),fm(r,u,g)),!1;case 22:return o.flags|=65536,u===Lc?o.flags|=16384:(i=o.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=i):(o=i.retryQueue,o===null?i.retryQueue=new Set([u]):o.add(u)),fm(r,u,g)),!1}throw Error(s(435,o.tag))}return fm(r,u,g),cu(),!1}if(Ye)return i=_n.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=g,u!==ah&&(r=Error(s(422),{cause:u}),yo(Dn(r,o)))):(u!==ah&&(i=Error(s(423),{cause:u}),yo(Dn(i,o))),r=r.current.alternate,r.flags|=65536,g&=-g,r.lanes|=g,u=Dn(u,o),g=Ph(r.stateNode,u,g),yh(r,g),bt!==4&&(bt=2)),!1;var v=Error(s(520),{cause:u});if(v=Dn(v,o),Bo===null?Bo=[v]:Bo.push(v),bt!==4&&(bt=2),i===null)return!0;u=Dn(u,o),o=i;do{switch(o.tag){case 3:return o.flags|=65536,r=g&-g,o.lanes|=r,r=Ph(o.stateNode,u,r),yh(o,r),!1;case 1:if(i=o.type,v=o.stateNode,(o.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(vs===null||!vs.has(v))))return o.flags|=65536,g&=-g,o.lanes|=g,g=pv(g),gv(g,r,o,u),yh(o,g),!1}o=o.return}while(o!==null);return!1}var Hh=Error(s(461)),Ct=!1;function Ht(r,i,o,u){i.child=r===null?b0(i,null,o,u):ti(i,r.child,o,u)}function yv(r,i,o,u,g){o=o.render;var v=i.ref;if("ref"in u){var N={};for(var z in u)z!=="ref"&&(N[z]=u[z])}else N=u;return Ws(i),u=Ah(r,i,o,N,v,g),z=Eh(),r!==null&&!Ct?(Sh(r,i,g),Ir(r,i,g)):(Ye&&z&&sh(i),i.flags|=1,Ht(r,i,u,g),i.child)}function vv(r,i,o,u,g){if(r===null){var v=o.type;return typeof v=="function"&&!th(v)&&v.defaultProps===void 0&&o.compare===null?(i.tag=15,i.type=v,_v(r,i,v,u,g)):(r=Ic(o.type,null,u,i,i.mode,g),r.ref=i.ref,r.return=i,i.child=r)}if(v=r.child,!Kh(r,g)){var N=v.memoizedProps;if(o=o.compare,o=o!==null?o:mo,o(N,u)&&r.ref===i.ref)return Ir(r,i,g)}return i.flags|=1,r=Cr(v,u),r.ref=i.ref,r.return=i,i.child=r}function _v(r,i,o,u,g){if(r!==null){var v=r.memoizedProps;if(mo(v,u)&&r.ref===i.ref)if(Ct=!1,i.pendingProps=u=v,Kh(r,g))(r.flags&131072)!==0&&(Ct=!0);else return i.lanes=r.lanes,Ir(r,i,g)}return qh(r,i,o,u,g)}function bv(r,i,o,u){var g=u.children,v=r!==null?r.memoizedState:null;if(r===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((i.flags&128)!==0){if(v=v!==null?v.baseLanes|o:o,r!==null){for(u=i.child=r.child,g=0;u!==null;)g=g|u.lanes|u.childLanes,u=u.sibling;u=g&~v}else u=0,i.child=null;return wv(r,i,v,o,u)}if((o&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},r!==null&&Bc(i,v!==null?v.cachePool:null),v!==null?A0(i,v):_h(),E0(i);else return u=i.lanes=536870912,wv(r,i,v!==null?v.baseLanes|o:o,o,u)}else v!==null?(Bc(i,v.cachePool),A0(i,v),ms(),i.memoizedState=null):(r!==null&&Bc(i,null),_h(),ms());return Ht(r,i,g,o),i.child}function Ro(r,i){return r!==null&&r.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function wv(r,i,o,u,g){var v=hh();return v=v===null?null:{parent:Et._currentValue,pool:v},i.memoizedState={baseLanes:o,cachePool:v},r!==null&&Bc(i,null),_h(),E0(i),r!==null&&Ji(r,i,u,!0),i.childLanes=g,null}function Jc(r,i){return i=eu({mode:i.mode,children:i.children},r.mode),i.ref=r.ref,r.child=i,i.return=r,i}function xv(r,i,o){return ti(i,r.child,null,o),r=Jc(i,i.pendingProps),r.flags|=2,bn(i),i.memoizedState=null,r}function QT(r,i,o){var u=i.pendingProps,g=(i.flags&128)!==0;if(i.flags&=-129,r===null){if(Ye){if(u.mode==="hidden")return r=Jc(i,u),i.lanes=536870912,Ro(null,r);if(wh(i),(r=ut)?(r=M_(r,Ln),r=r!==null&&r.data==="&"?r:null,r!==null&&(i.memoizedState={dehydrated:r,treeContext:as!==null?{id:lr,overflow:cr}:null,retryLane:536870912,hydrationErrors:null},o=i0(r),o.return=i,i.child=o,zt=i,ut=null)):r=null,r===null)throw ls(i);return i.lanes=536870912,null}return Jc(i,u)}var v=r.memoizedState;if(v!==null){var N=v.dehydrated;if(wh(i),g)if(i.flags&256)i.flags&=-257,i=xv(r,i,o);else if(i.memoizedState!==null)i.child=r.child,i.flags|=128,i=null;else throw Error(s(558));else if(Ct||Ji(r,i,o,!1),g=(o&r.childLanes)!==0,Ct||g){if(u=ot,u!==null&&(N=uc(u,o),N!==0&&N!==v.retryLane))throw v.retryLane=N,Gs(r,N),dn(u,r,N),Hh;cu(),i=xv(r,i,o)}else r=v.treeContext,ut=zn(N.nextSibling),zt=i,Ye=!0,os=null,Ln=!1,r!==null&&l0(i,r),i=Jc(i,u),i.flags|=4096;return i}return r=Cr(r.child,{mode:u.mode,children:u.children}),r.ref=i.ref,i.child=r,r.return=i,r}function Zc(r,i){var o=i.ref;if(o===null)r!==null&&r.ref!==null&&(i.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(s(284));(r===null||r.ref!==o)&&(i.flags|=4194816)}}function qh(r,i,o,u,g){return Ws(i),o=Ah(r,i,o,u,void 0,g),u=Eh(),r!==null&&!Ct?(Sh(r,i,g),Ir(r,i,g)):(Ye&&u&&sh(i),i.flags|=1,Ht(r,i,o,g),i.child)}function Av(r,i,o,u,g,v){return Ws(i),i.updateQueue=null,o=C0(i,u,o,g),S0(r),u=Eh(),r!==null&&!Ct?(Sh(r,i,v),Ir(r,i,v)):(Ye&&u&&sh(i),i.flags|=1,Ht(r,i,o,v),i.child)}function Ev(r,i,o,u,g){if(Ws(i),i.stateNode===null){var v=Yi,N=o.contextType;typeof N=="object"&&N!==null&&(v=Pt(N)),v=new o(u,v),i.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=zh,i.stateNode=v,v._reactInternals=i,v=i.stateNode,v.props=u,v.state=i.memoizedState,v.refs={},ph(i),N=o.contextType,v.context=typeof N=="object"&&N!==null?Pt(N):Yi,v.state=i.memoizedState,N=o.getDerivedStateFromProps,typeof N=="function"&&($h(i,o,N,u),v.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(N=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),N!==v.state&&zh.enqueueReplaceState(v,v.state,null),Eo(i,u,v,g),Ao(),v.state=i.memoizedState),typeof v.componentDidMount=="function"&&(i.flags|=4194308),u=!0}else if(r===null){v=i.stateNode;var z=i.memoizedProps,X=ri(o,z);v.props=X;var re=v.context,le=o.contextType;N=Yi,typeof le=="object"&&le!==null&&(N=Pt(le));var me=o.getDerivedStateFromProps;le=typeof me=="function"||typeof v.getSnapshotBeforeUpdate=="function",z=i.pendingProps!==z,le||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(z||re!==N)&&uv(i,v,u,N),us=!1;var ie=i.memoizedState;v.state=ie,Eo(i,u,v,g),Ao(),re=i.memoizedState,z||ie!==re||us?(typeof me=="function"&&($h(i,o,me,u),re=i.memoizedState),(X=us||cv(i,o,X,u,ie,re,N))?(le||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(i.flags|=4194308)):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=u,i.memoizedState=re),v.props=u,v.state=re,v.context=N,u=X):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),u=!1)}else{v=i.stateNode,gh(r,i),N=i.memoizedProps,le=ri(o,N),v.props=le,me=i.pendingProps,ie=v.context,re=o.contextType,X=Yi,typeof re=="object"&&re!==null&&(X=Pt(re)),z=o.getDerivedStateFromProps,(re=typeof z=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(N!==me||ie!==X)&&uv(i,v,u,X),us=!1,ie=i.memoizedState,v.state=ie,Eo(i,u,v,g),Ao();var oe=i.memoizedState;N!==me||ie!==oe||us||r!==null&&r.dependencies!==null&&Mc(r.dependencies)?(typeof z=="function"&&($h(i,o,z,u),oe=i.memoizedState),(le=us||cv(i,o,le,u,ie,oe,X)||r!==null&&r.dependencies!==null&&Mc(r.dependencies))?(re||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(u,oe,X),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(u,oe,X)),typeof v.componentDidUpdate=="function"&&(i.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof v.componentDidUpdate!="function"||N===r.memoizedProps&&ie===r.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||N===r.memoizedProps&&ie===r.memoizedState||(i.flags|=1024),i.memoizedProps=u,i.memoizedState=oe),v.props=u,v.state=oe,v.context=X,u=le):(typeof v.componentDidUpdate!="function"||N===r.memoizedProps&&ie===r.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||N===r.memoizedProps&&ie===r.memoizedState||(i.flags|=1024),u=!1)}return v=u,Zc(r,i),u=(i.flags&128)!==0,v||u?(v=i.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:v.render(),i.flags|=1,r!==null&&u?(i.child=ti(i,r.child,null,g),i.child=ti(i,null,o,g)):Ht(r,i,o,g),i.memoizedState=v.state,r=i.child):r=Ir(r,i,g),r}function Sv(r,i,o,u){return Xs(),i.flags|=256,Ht(r,i,o,u),i.child}var Qh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Fh(r){return{baseLanes:r,cachePool:m0()}}function Vh(r,i,o){return r=r!==null?r.childLanes&~o:0,i&&(r|=xn),r}function Cv(r,i,o){var u=i.pendingProps,g=!1,v=(i.flags&128)!==0,N;if((N=v)||(N=r!==null&&r.memoizedState===null?!1:(wt.current&2)!==0),N&&(g=!0,i.flags&=-129),N=(i.flags&32)!==0,i.flags&=-33,r===null){if(Ye){if(g?hs(i):ms(),(r=ut)?(r=M_(r,Ln),r=r!==null&&r.data!=="&"?r:null,r!==null&&(i.memoizedState={dehydrated:r,treeContext:as!==null?{id:lr,overflow:cr}:null,retryLane:536870912,hydrationErrors:null},o=i0(r),o.return=i,i.child=o,zt=i,ut=null)):r=null,r===null)throw ls(i);return Nm(r)?i.lanes=32:i.lanes=536870912,null}var z=u.children;return u=u.fallback,g?(ms(),g=i.mode,z=eu({mode:"hidden",children:z},g),u=Ys(u,g,o,null),z.return=i,u.return=i,z.sibling=u,i.child=z,u=i.child,u.memoizedState=Fh(o),u.childLanes=Vh(r,N,o),i.memoizedState=Qh,Ro(null,u)):(hs(i),Gh(i,z))}var X=r.memoizedState;if(X!==null&&(z=X.dehydrated,z!==null)){if(v)i.flags&256?(hs(i),i.flags&=-257,i=Yh(r,i,o)):i.memoizedState!==null?(ms(),i.child=r.child,i.flags|=128,i=null):(ms(),z=u.fallback,g=i.mode,u=eu({mode:"visible",children:u.children},g),z=Ys(z,g,o,null),z.flags|=2,u.return=i,z.return=i,u.sibling=z,i.child=u,ti(i,r.child,null,o),u=i.child,u.memoizedState=Fh(o),u.childLanes=Vh(r,N,o),i.memoizedState=Qh,i=Ro(null,u));else if(hs(i),Nm(z)){if(N=z.nextSibling&&z.nextSibling.dataset,N)var re=N.dgst;N=re,u=Error(s(419)),u.stack="",u.digest=N,yo({value:u,source:null,stack:null}),i=Yh(r,i,o)}else if(Ct||Ji(r,i,o,!1),N=(o&r.childLanes)!==0,Ct||N){if(N=ot,N!==null&&(u=uc(N,o),u!==0&&u!==X.retryLane))throw X.retryLane=u,Gs(r,u),dn(N,r,u),Hh;Tm(z)||cu(),i=Yh(r,i,o)}else Tm(z)?(i.flags|=192,i.child=r.child,i=null):(r=X.treeContext,ut=zn(z.nextSibling),zt=i,Ye=!0,os=null,Ln=!1,r!==null&&l0(i,r),i=Gh(i,u.children),i.flags|=4096);return i}return g?(ms(),z=u.fallback,g=i.mode,X=r.child,re=X.sibling,u=Cr(X,{mode:"hidden",children:u.children}),u.subtreeFlags=X.subtreeFlags&65011712,re!==null?z=Cr(re,z):(z=Ys(z,g,o,null),z.flags|=2),z.return=i,u.return=i,u.sibling=z,i.child=u,Ro(null,u),u=i.child,z=r.child.memoizedState,z===null?z=Fh(o):(g=z.cachePool,g!==null?(X=Et._currentValue,g=g.parent!==X?{parent:X,pool:X}:g):g=m0(),z={baseLanes:z.baseLanes|o,cachePool:g}),u.memoizedState=z,u.childLanes=Vh(r,N,o),i.memoizedState=Qh,Ro(r.child,u)):(hs(i),o=r.child,r=o.sibling,o=Cr(o,{mode:"visible",children:u.children}),o.return=i,o.sibling=null,r!==null&&(N=i.deletions,N===null?(i.deletions=[r],i.flags|=16):N.push(r)),i.child=o,i.memoizedState=null,o)}function Gh(r,i){return i=eu({mode:"visible",children:i},r.mode),i.return=r,r.child=i}function eu(r,i){return r=vn(22,r,null,i),r.lanes=0,r}function Yh(r,i,o){return ti(i,r.child,null,o),r=Gh(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function Tv(r,i,o){r.lanes|=i;var u=r.alternate;u!==null&&(u.lanes|=i),ch(r.return,i,o)}function Xh(r,i,o,u,g,v){var N=r.memoizedState;N===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:g,treeForkCount:v}:(N.isBackwards=i,N.rendering=null,N.renderingStartTime=0,N.last=u,N.tail=o,N.tailMode=g,N.treeForkCount=v)}function Nv(r,i,o){var u=i.pendingProps,g=u.revealOrder,v=u.tail;u=u.children;var N=wt.current,z=(N&2)!==0;if(z?(N=N&1|2,i.flags|=128):N&=1,Y(wt,N),Ht(r,i,u,o),u=Ye?go:0,!z&&r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Tv(r,o,i);else if(r.tag===19)Tv(r,o,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(g){case"forwards":for(o=i.child,g=null;o!==null;)r=o.alternate,r!==null&&Hc(r)===null&&(g=o),o=o.sibling;o=g,o===null?(g=i.child,i.child=null):(g=o.sibling,o.sibling=null),Xh(i,!1,g,o,v,u);break;case"backwards":case"unstable_legacy-backwards":for(o=null,g=i.child,i.child=null;g!==null;){if(r=g.alternate,r!==null&&Hc(r)===null){i.child=g;break}r=g.sibling,g.sibling=o,o=g,g=r}Xh(i,!0,o,null,v,u);break;case"together":Xh(i,!1,null,null,void 0,u);break;default:i.memoizedState=null}return i.child}function Ir(r,i,o){if(r!==null&&(i.dependencies=r.dependencies),ys|=i.lanes,(o&i.childLanes)===0)if(r!==null){if(Ji(r,i,o,!1),(o&i.childLanes)===0)return null}else return null;if(r!==null&&i.child!==r.child)throw Error(s(153));if(i.child!==null){for(r=i.child,o=Cr(r,r.pendingProps),i.child=o,o.return=i;r.sibling!==null;)r=r.sibling,o=o.sibling=Cr(r,r.pendingProps),o.return=i;o.sibling=null}return i.child}function Kh(r,i){return(r.lanes&i)!==0?!0:(r=r.dependencies,!!(r!==null&&Mc(r)))}function FT(r,i,o){switch(i.tag){case 3:he(i,i.stateNode.containerInfo),cs(i,Et,r.memoizedState.cache),Xs();break;case 27:case 5:pe(i);break;case 4:he(i,i.stateNode.containerInfo);break;case 10:cs(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,wh(i),null;break;case 13:var u=i.memoizedState;if(u!==null)return u.dehydrated!==null?(hs(i),i.flags|=128,null):(o&i.child.childLanes)!==0?Cv(r,i,o):(hs(i),r=Ir(r,i,o),r!==null?r.sibling:null);hs(i);break;case 19:var g=(r.flags&128)!==0;if(u=(o&i.childLanes)!==0,u||(Ji(r,i,o,!1),u=(o&i.childLanes)!==0),g){if(u)return Nv(r,i,o);i.flags|=128}if(g=i.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),Y(wt,wt.current),u)break;return null;case 22:return i.lanes=0,bv(r,i,o,i.pendingProps);case 24:cs(i,Et,r.memoizedState.cache)}return Ir(r,i,o)}function Rv(r,i,o){if(r!==null)if(r.memoizedProps!==i.pendingProps)Ct=!0;else{if(!Kh(r,o)&&(i.flags&128)===0)return Ct=!1,FT(r,i,o);Ct=(r.flags&131072)!==0}else Ct=!1,Ye&&(i.flags&1048576)!==0&&o0(i,go,i.index);switch(i.lanes=0,i.tag){case 16:e:{var u=i.pendingProps;if(r=Zs(i.elementType),i.type=r,typeof r=="function")th(r)?(u=ri(r,u),i.tag=1,i=Ev(null,i,r,u,o)):(i.tag=0,i=qh(null,i,r,u,o));else{if(r!=null){var g=r.$$typeof;if(g===C){i.tag=11,i=yv(null,i,r,u,o);break e}else if(g===M){i.tag=14,i=vv(null,i,r,u,o);break e}}throw i=$(r)||r,Error(s(306,i,""))}}return i;case 0:return qh(r,i,i.type,i.pendingProps,o);case 1:return u=i.type,g=ri(u,i.pendingProps),Ev(r,i,u,g,o);case 3:e:{if(he(i,i.stateNode.containerInfo),r===null)throw Error(s(387));u=i.pendingProps;var v=i.memoizedState;g=v.element,gh(r,i),Eo(i,u,null,o);var N=i.memoizedState;if(u=N.cache,cs(i,Et,u),u!==v.cache&&uh(i,[Et],o,!0),Ao(),u=N.element,v.isDehydrated)if(v={element:u,isDehydrated:!1,cache:N.cache},i.updateQueue.baseState=v,i.memoizedState=v,i.flags&256){i=Sv(r,i,u,o);break e}else if(u!==g){g=Dn(Error(s(424)),i),yo(g),i=Sv(r,i,u,o);break e}else{switch(r=i.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(ut=zn(r.firstChild),zt=i,Ye=!0,os=null,Ln=!0,o=b0(i,null,u,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(Xs(),u===g){i=Ir(r,i,o);break e}Ht(r,i,u,o)}i=i.child}return i;case 26:return Zc(r,i),r===null?(o=z_(i.type,null,i.pendingProps,null))?i.memoizedState=o:Ye||(o=i.type,r=i.pendingProps,u=gu(ae.current).createElement(o),u[It]=i,u[Yt]=r,qt(u,o,r),At(u),i.stateNode=u):i.memoizedState=z_(i.type,r.memoizedProps,i.pendingProps,r.memoizedState),null;case 27:return pe(i),r===null&&Ye&&(u=i.stateNode=U_(i.type,i.pendingProps,ae.current),zt=i,Ln=!0,g=ut,xs(i.type)?(Rm=g,ut=zn(u.firstChild)):ut=g),Ht(r,i,i.pendingProps.children,o),Zc(r,i),r===null&&(i.flags|=4194304),i.child;case 5:return r===null&&Ye&&((g=u=ut)&&(u=wN(u,i.type,i.pendingProps,Ln),u!==null?(i.stateNode=u,zt=i,ut=zn(u.firstChild),Ln=!1,g=!0):g=!1),g||ls(i)),pe(i),g=i.type,v=i.pendingProps,N=r!==null?r.memoizedProps:null,u=v.children,Em(g,v)?u=null:N!==null&&Em(g,N)&&(i.flags|=32),i.memoizedState!==null&&(g=Ah(r,i,BT,null,null,o),Qo._currentValue=g),Zc(r,i),Ht(r,i,u,o),i.child;case 6:return r===null&&Ye&&((r=o=ut)&&(o=xN(o,i.pendingProps,Ln),o!==null?(i.stateNode=o,zt=i,ut=null,r=!0):r=!1),r||ls(i)),null;case 13:return Cv(r,i,o);case 4:return he(i,i.stateNode.containerInfo),u=i.pendingProps,r===null?i.child=ti(i,null,u,o):Ht(r,i,u,o),i.child;case 11:return yv(r,i,i.type,i.pendingProps,o);case 7:return Ht(r,i,i.pendingProps,o),i.child;case 8:return Ht(r,i,i.pendingProps.children,o),i.child;case 12:return Ht(r,i,i.pendingProps.children,o),i.child;case 10:return u=i.pendingProps,cs(i,i.type,u.value),Ht(r,i,u.children,o),i.child;case 9:return g=i.type._context,u=i.pendingProps.children,Ws(i),g=Pt(g),u=u(g),i.flags|=1,Ht(r,i,u,o),i.child;case 14:return vv(r,i,i.type,i.pendingProps,o);case 15:return _v(r,i,i.type,i.pendingProps,o);case 19:return Nv(r,i,o);case 31:return QT(r,i,o);case 22:return bv(r,i,o,i.pendingProps);case 24:return Ws(i),u=Pt(Et),r===null?(g=hh(),g===null&&(g=ot,v=dh(),g.pooledCache=v,v.refCount++,v!==null&&(g.pooledCacheLanes|=o),g=v),i.memoizedState={parent:u,cache:g},ph(i),cs(i,Et,g)):((r.lanes&o)!==0&&(gh(r,i),Eo(i,null,null,o),Ao()),g=r.memoizedState,v=i.memoizedState,g.parent!==u?(g={parent:u,cache:u},i.memoizedState=g,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=g),cs(i,Et,u)):(u=v.cache,cs(i,Et,u),u!==g.cache&&uh(i,[Et],o,!0))),Ht(r,i,i.pendingProps.children,o),i.child;case 29:throw i.pendingProps}throw Error(s(156,i.tag))}function kr(r){r.flags|=4}function Wh(r,i,o,u,g){if((i=(r.mode&32)!==0)&&(i=!1),i){if(r.flags|=16777216,(g&335544128)===g)if(r.stateNode.complete)r.flags|=8192;else if(n_())r.flags|=8192;else throw ei=Lc,mh}else r.flags&=-16777217}function jv(r,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!F_(i))if(n_())r.flags|=8192;else throw ei=Lc,mh}function tu(r,i){i!==null&&(r.flags|=4),r.flags&16384&&(i=r.tag!==22?oc():536870912,r.lanes|=i,ua|=i)}function jo(r,i){if(!Ye)switch(r.tailMode){case"hidden":i=r.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?r.tail=null:o.sibling=null;break;case"collapsed":o=r.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:u.sibling=null}}function dt(r){var i=r.alternate!==null&&r.alternate.child===r.child,o=0,u=0;if(i)for(var g=r.child;g!==null;)o|=g.lanes|g.childLanes,u|=g.subtreeFlags&65011712,u|=g.flags&65011712,g.return=r,g=g.sibling;else for(g=r.child;g!==null;)o|=g.lanes|g.childLanes,u|=g.subtreeFlags,u|=g.flags,g.return=r,g=g.sibling;return r.subtreeFlags|=u,r.childLanes=o,i}function VT(r,i,o){var u=i.pendingProps;switch(ih(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dt(i),null;case 1:return dt(i),null;case 3:return o=i.stateNode,u=null,r!==null&&(u=r.memoizedState.cache),i.memoizedState.cache!==u&&(i.flags|=2048),Rr(Et),ye(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(r===null||r.child===null)&&(Wi(i)?kr(i):r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,oh())),dt(i),null;case 26:var g=i.type,v=i.memoizedState;return r===null?(kr(i),v!==null?(dt(i),jv(i,v)):(dt(i),Wh(i,g,null,u,o))):v?v!==r.memoizedState?(kr(i),dt(i),jv(i,v)):(dt(i),i.flags&=-16777217):(r=r.memoizedProps,r!==u&&kr(i),dt(i),Wh(i,g,r,u,o)),null;case 27:if(_e(i),o=ae.current,g=i.type,r!==null&&i.stateNode!=null)r.memoizedProps!==u&&kr(i);else{if(!u){if(i.stateNode===null)throw Error(s(166));return dt(i),null}r=J.current,Wi(i)?c0(i):(r=U_(g,u,o),i.stateNode=r,kr(i))}return dt(i),null;case 5:if(_e(i),g=i.type,r!==null&&i.stateNode!=null)r.memoizedProps!==u&&kr(i);else{if(!u){if(i.stateNode===null)throw Error(s(166));return dt(i),null}if(v=J.current,Wi(i))c0(i);else{var N=gu(ae.current);switch(v){case 1:v=N.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:v=N.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":v=N.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":v=N.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":v=N.createElement("div"),v.innerHTML="<script><\/script>",v=v.removeChild(v.firstChild);break;case"select":v=typeof u.is=="string"?N.createElement("select",{is:u.is}):N.createElement("select"),u.multiple?v.multiple=!0:u.size&&(v.size=u.size);break;default:v=typeof u.is=="string"?N.createElement(g,{is:u.is}):N.createElement(g)}}v[It]=i,v[Yt]=u;e:for(N=i.child;N!==null;){if(N.tag===5||N.tag===6)v.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===i)break e;for(;N.sibling===null;){if(N.return===null||N.return===i)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}i.stateNode=v;e:switch(qt(v,g,u),g){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&kr(i)}}return dt(i),Wh(i,i.type,r===null?null:r.memoizedProps,i.pendingProps,o),null;case 6:if(r&&i.stateNode!=null)r.memoizedProps!==u&&kr(i);else{if(typeof u!="string"&&i.stateNode===null)throw Error(s(166));if(r=ae.current,Wi(i)){if(r=i.stateNode,o=i.memoizedProps,u=null,g=zt,g!==null)switch(g.tag){case 27:case 5:u=g.memoizedProps}r[It]=i,r=!!(r.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||C_(r.nodeValue,o)),r||ls(i,!0)}else r=gu(r).createTextNode(u),r[It]=i,i.stateNode=r}return dt(i),null;case 31:if(o=i.memoizedState,r===null||r.memoizedState!==null){if(u=Wi(i),o!==null){if(r===null){if(!u)throw Error(s(318));if(r=i.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(557));r[It]=i}else Xs(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;dt(i),r=!1}else o=oh(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=o),r=!0;if(!r)return i.flags&256?(bn(i),i):(bn(i),null);if((i.flags&128)!==0)throw Error(s(558))}return dt(i),null;case 13:if(u=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(g=Wi(i),u!==null&&u.dehydrated!==null){if(r===null){if(!g)throw Error(s(318));if(g=i.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(s(317));g[It]=i}else Xs(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;dt(i),g=!1}else g=oh(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=g),g=!0;if(!g)return i.flags&256?(bn(i),i):(bn(i),null)}return bn(i),(i.flags&128)!==0?(i.lanes=o,i):(o=u!==null,r=r!==null&&r.memoizedState!==null,o&&(u=i.child,g=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(g=u.alternate.memoizedState.cachePool.pool),v=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(v=u.memoizedState.cachePool.pool),v!==g&&(u.flags|=2048)),o!==r&&o&&(i.child.flags|=8192),tu(i,i.updateQueue),dt(i),null);case 4:return ye(),r===null&&_m(i.stateNode.containerInfo),dt(i),null;case 10:return Rr(i.type),dt(i),null;case 19:if(P(wt),u=i.memoizedState,u===null)return dt(i),null;if(g=(i.flags&128)!==0,v=u.rendering,v===null)if(g)jo(u,!1);else{if(bt!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(v=Hc(r),v!==null){for(i.flags|=128,jo(u,!1),r=v.updateQueue,i.updateQueue=r,tu(i,r),i.subtreeFlags=0,r=o,o=i.child;o!==null;)s0(o,r),o=o.sibling;return Y(wt,wt.current&1|2),Ye&&Tr(i,u.treeForkCount),i.child}r=r.sibling}u.tail!==null&&ft()>au&&(i.flags|=128,g=!0,jo(u,!1),i.lanes=4194304)}else{if(!g)if(r=Hc(v),r!==null){if(i.flags|=128,g=!0,r=r.updateQueue,i.updateQueue=r,tu(i,r),jo(u,!0),u.tail===null&&u.tailMode==="hidden"&&!v.alternate&&!Ye)return dt(i),null}else 2*ft()-u.renderingStartTime>au&&o!==536870912&&(i.flags|=128,g=!0,jo(u,!1),i.lanes=4194304);u.isBackwards?(v.sibling=i.child,i.child=v):(r=u.last,r!==null?r.sibling=v:i.child=v,u.last=v)}return u.tail!==null?(r=u.tail,u.rendering=r,u.tail=r.sibling,u.renderingStartTime=ft(),r.sibling=null,o=wt.current,Y(wt,g?o&1|2:o&1),Ye&&Tr(i,u.treeForkCount),r):(dt(i),null);case 22:case 23:return bn(i),bh(),u=i.memoizedState!==null,r!==null?r.memoizedState!==null!==u&&(i.flags|=8192):u&&(i.flags|=8192),u?(o&536870912)!==0&&(i.flags&128)===0&&(dt(i),i.subtreeFlags&6&&(i.flags|=8192)):dt(i),o=i.updateQueue,o!==null&&tu(i,o.retryQueue),o=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),u=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),u!==o&&(i.flags|=2048),r!==null&&P(Js),null;case 24:return o=null,r!==null&&(o=r.memoizedState.cache),i.memoizedState.cache!==o&&(i.flags|=2048),Rr(Et),dt(i),null;case 25:return null;case 30:return null}throw Error(s(156,i.tag))}function GT(r,i){switch(ih(i),i.tag){case 1:return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return Rr(Et),ye(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 26:case 27:case 5:return _e(i),null;case 31:if(i.memoizedState!==null){if(bn(i),i.alternate===null)throw Error(s(340));Xs()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 13:if(bn(i),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(s(340));Xs()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return P(wt),null;case 4:return ye(),null;case 10:return Rr(i.type),null;case 22:case 23:return bn(i),bh(),r!==null&&P(Js),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 24:return Rr(Et),null;case 25:return null;default:return null}}function Ov(r,i){switch(ih(i),i.tag){case 3:Rr(Et),ye();break;case 26:case 27:case 5:_e(i);break;case 4:ye();break;case 31:i.memoizedState!==null&&bn(i);break;case 13:bn(i);break;case 19:P(wt);break;case 10:Rr(i.type);break;case 22:case 23:bn(i),bh(),r!==null&&P(Js);break;case 24:Rr(Et)}}function Oo(r,i){try{var o=i.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var g=u.next;o=g;do{if((o.tag&r)===r){u=void 0;var v=o.create,N=o.inst;u=v(),N.destroy=u}o=o.next}while(o!==g)}}catch(z){rt(i,i.return,z)}}function ps(r,i,o){try{var u=i.updateQueue,g=u!==null?u.lastEffect:null;if(g!==null){var v=g.next;u=v;do{if((u.tag&r)===r){var N=u.inst,z=N.destroy;if(z!==void 0){N.destroy=void 0,g=i;var X=o,re=z;try{re()}catch(le){rt(g,X,le)}}}u=u.next}while(u!==v)}}catch(le){rt(i,i.return,le)}}function Iv(r){var i=r.updateQueue;if(i!==null){var o=r.stateNode;try{x0(i,o)}catch(u){rt(r,r.return,u)}}}function kv(r,i,o){o.props=ri(r.type,r.memoizedProps),o.state=r.memoizedState;try{o.componentWillUnmount()}catch(u){rt(r,i,u)}}function Io(r,i){try{var o=r.ref;if(o!==null){switch(r.tag){case 26:case 27:case 5:var u=r.stateNode;break;case 30:u=r.stateNode;break;default:u=r.stateNode}typeof o=="function"?r.refCleanup=o(u):o.current=u}}catch(g){rt(r,i,g)}}function ur(r,i){var o=r.ref,u=r.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(g){rt(r,i,g)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(g){rt(r,i,g)}else o.current=null}function Mv(r){var i=r.type,o=r.memoizedProps,u=r.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(g){rt(r,r.return,g)}}function Jh(r,i,o){try{var u=r.stateNode;pN(u,r.type,o,i),u[Yt]=i}catch(g){rt(r,r.return,g)}}function Dv(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&xs(r.type)||r.tag===4}function Zh(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Dv(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&xs(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function em(r,i,o){var u=r.tag;if(u===5||u===6)r=r.stateNode,i?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(r,i):(i=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,i.appendChild(r),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=Er));else if(u!==4&&(u===27&&xs(r.type)&&(o=r.stateNode,i=null),r=r.child,r!==null))for(em(r,i,o),r=r.sibling;r!==null;)em(r,i,o),r=r.sibling}function nu(r,i,o){var u=r.tag;if(u===5||u===6)r=r.stateNode,i?o.insertBefore(r,i):o.appendChild(r);else if(u!==4&&(u===27&&xs(r.type)&&(o=r.stateNode),r=r.child,r!==null))for(nu(r,i,o),r=r.sibling;r!==null;)nu(r,i,o),r=r.sibling}function Bv(r){var i=r.stateNode,o=r.memoizedProps;try{for(var u=r.type,g=i.attributes;g.length;)i.removeAttributeNode(g[0]);qt(i,u,o),i[It]=r,i[Yt]=o}catch(v){rt(r,r.return,v)}}var Mr=!1,Tt=!1,tm=!1,Uv=typeof WeakSet=="function"?WeakSet:Set,Ut=null;function YT(r,i){if(r=r.containerInfo,xm=Au,r=Xy(r),Yf(r)){if("selectionStart"in r)var o={start:r.selectionStart,end:r.selectionEnd};else e:{o=(o=r.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var g=u.anchorOffset,v=u.focusNode;u=u.focusOffset;try{o.nodeType,v.nodeType}catch{o=null;break e}var N=0,z=-1,X=-1,re=0,le=0,me=r,ie=null;t:for(;;){for(var oe;me!==o||g!==0&&me.nodeType!==3||(z=N+g),me!==v||u!==0&&me.nodeType!==3||(X=N+u),me.nodeType===3&&(N+=me.nodeValue.length),(oe=me.firstChild)!==null;)ie=me,me=oe;for(;;){if(me===r)break t;if(ie===o&&++re===g&&(z=N),ie===v&&++le===u&&(X=N),(oe=me.nextSibling)!==null)break;me=ie,ie=me.parentNode}me=oe}o=z===-1||X===-1?null:{start:z,end:X}}else o=null}o=o||{start:0,end:0}}else o=null;for(Am={focusedElem:r,selectionRange:o},Au=!1,Ut=i;Ut!==null;)if(i=Ut,r=i.child,(i.subtreeFlags&1028)!==0&&r!==null)r.return=i,Ut=r;else for(;Ut!==null;){switch(i=Ut,v=i.alternate,r=i.flags,i.tag){case 0:if((r&4)!==0&&(r=i.updateQueue,r=r!==null?r.events:null,r!==null))for(o=0;o<r.length;o++)g=r[o],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&v!==null){r=void 0,o=i,g=v.memoizedProps,v=v.memoizedState,u=o.stateNode;try{var Ae=ri(o.type,g);r=u.getSnapshotBeforeUpdate(Ae,v),u.__reactInternalSnapshotBeforeUpdate=r}catch(ke){rt(o,o.return,ke)}}break;case 3:if((r&1024)!==0){if(r=i.stateNode.containerInfo,o=r.nodeType,o===9)Cm(r);else if(o===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Cm(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(s(163))}if(r=i.sibling,r!==null){r.return=i.return,Ut=r;break}Ut=i.return}}function Lv(r,i,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:Br(r,o),u&4&&Oo(5,o);break;case 1:if(Br(r,o),u&4)if(r=o.stateNode,i===null)try{r.componentDidMount()}catch(N){rt(o,o.return,N)}else{var g=ri(o.type,i.memoizedProps);i=i.memoizedState;try{r.componentDidUpdate(g,i,r.__reactInternalSnapshotBeforeUpdate)}catch(N){rt(o,o.return,N)}}u&64&&Iv(o),u&512&&Io(o,o.return);break;case 3:if(Br(r,o),u&64&&(r=o.updateQueue,r!==null)){if(i=null,o.child!==null)switch(o.child.tag){case 27:case 5:i=o.child.stateNode;break;case 1:i=o.child.stateNode}try{x0(r,i)}catch(N){rt(o,o.return,N)}}break;case 27:i===null&&u&4&&Bv(o);case 26:case 5:Br(r,o),i===null&&u&4&&Mv(o),u&512&&Io(o,o.return);break;case 12:Br(r,o);break;case 31:Br(r,o),u&4&&Pv(r,o);break;case 13:Br(r,o),u&4&&Hv(r,o),u&64&&(r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(o=rN.bind(null,o),AN(r,o))));break;case 22:if(u=o.memoizedState!==null||Mr,!u){i=i!==null&&i.memoizedState!==null||Tt,g=Mr;var v=Tt;Mr=u,(Tt=i)&&!v?Ur(r,o,(o.subtreeFlags&8772)!==0):Br(r,o),Mr=g,Tt=v}break;case 30:break;default:Br(r,o)}}function $v(r){var i=r.alternate;i!==null&&(r.alternate=null,$v(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&ro(i)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var ht=null,on=!1;function Dr(r,i,o){for(o=o.child;o!==null;)zv(r,i,o),o=o.sibling}function zv(r,i,o){if(tt&&typeof tt.onCommitFiberUnmount=="function")try{tt.onCommitFiberUnmount(Ke,o)}catch{}switch(o.tag){case 26:Tt||ur(o,i),Dr(r,i,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Tt||ur(o,i);var u=ht,g=on;xs(o.type)&&(ht=o.stateNode,on=!1),Dr(r,i,o),Po(o.stateNode),ht=u,on=g;break;case 5:Tt||ur(o,i);case 6:if(u=ht,g=on,ht=null,Dr(r,i,o),ht=u,on=g,ht!==null)if(on)try{(ht.nodeType===9?ht.body:ht.nodeName==="HTML"?ht.ownerDocument.body:ht).removeChild(o.stateNode)}catch(v){rt(o,i,v)}else try{ht.removeChild(o.stateNode)}catch(v){rt(o,i,v)}break;case 18:ht!==null&&(on?(r=ht,I_(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,o.stateNode),va(r)):I_(ht,o.stateNode));break;case 4:u=ht,g=on,ht=o.stateNode.containerInfo,on=!0,Dr(r,i,o),ht=u,on=g;break;case 0:case 11:case 14:case 15:ps(2,o,i),Tt||ps(4,o,i),Dr(r,i,o);break;case 1:Tt||(ur(o,i),u=o.stateNode,typeof u.componentWillUnmount=="function"&&kv(o,i,u)),Dr(r,i,o);break;case 21:Dr(r,i,o);break;case 22:Tt=(u=Tt)||o.memoizedState!==null,Dr(r,i,o),Tt=u;break;default:Dr(r,i,o)}}function Pv(r,i){if(i.memoizedState===null&&(r=i.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{va(r)}catch(o){rt(i,i.return,o)}}}function Hv(r,i){if(i.memoizedState===null&&(r=i.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{va(r)}catch(o){rt(i,i.return,o)}}function XT(r){switch(r.tag){case 31:case 13:case 19:var i=r.stateNode;return i===null&&(i=r.stateNode=new Uv),i;case 22:return r=r.stateNode,i=r._retryCache,i===null&&(i=r._retryCache=new Uv),i;default:throw Error(s(435,r.tag))}}function ru(r,i){var o=XT(r);i.forEach(function(u){if(!o.has(u)){o.add(u);var g=sN.bind(null,r,u);u.then(g,g)}})}function ln(r,i){var o=i.deletions;if(o!==null)for(var u=0;u<o.length;u++){var g=o[u],v=r,N=i,z=N;e:for(;z!==null;){switch(z.tag){case 27:if(xs(z.type)){ht=z.stateNode,on=!1;break e}break;case 5:ht=z.stateNode,on=!1;break e;case 3:case 4:ht=z.stateNode.containerInfo,on=!0;break e}z=z.return}if(ht===null)throw Error(s(160));zv(v,N,g),ht=null,on=!1,v=g.alternate,v!==null&&(v.return=null),g.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)qv(i,r),i=i.sibling}var Gn=null;function qv(r,i){var o=r.alternate,u=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:ln(i,r),cn(r),u&4&&(ps(3,r,r.return),Oo(3,r),ps(5,r,r.return));break;case 1:ln(i,r),cn(r),u&512&&(Tt||o===null||ur(o,o.return)),u&64&&Mr&&(r=r.updateQueue,r!==null&&(u=r.callbacks,u!==null&&(o=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var g=Gn;if(ln(i,r),cn(r),u&512&&(Tt||o===null||ur(o,o.return)),u&4){var v=o!==null?o.memoizedState:null;if(u=r.memoizedState,o===null)if(u===null)if(r.stateNode===null){e:{u=r.type,o=r.memoizedProps,g=g.ownerDocument||g;t:switch(u){case"title":v=g.getElementsByTagName("title")[0],(!v||v[qs]||v[It]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=g.createElement(u),g.head.insertBefore(v,g.querySelector("head > title"))),qt(v,u,o),v[It]=r,At(v),u=v;break e;case"link":var N=q_("link","href",g).get(u+(o.href||""));if(N){for(var z=0;z<N.length;z++)if(v=N[z],v.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&v.getAttribute("rel")===(o.rel==null?null:o.rel)&&v.getAttribute("title")===(o.title==null?null:o.title)&&v.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){N.splice(z,1);break t}}v=g.createElement(u),qt(v,u,o),g.head.appendChild(v);break;case"meta":if(N=q_("meta","content",g).get(u+(o.content||""))){for(z=0;z<N.length;z++)if(v=N[z],v.getAttribute("content")===(o.content==null?null:""+o.content)&&v.getAttribute("name")===(o.name==null?null:o.name)&&v.getAttribute("property")===(o.property==null?null:o.property)&&v.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&v.getAttribute("charset")===(o.charSet==null?null:o.charSet)){N.splice(z,1);break t}}v=g.createElement(u),qt(v,u,o),g.head.appendChild(v);break;default:throw Error(s(468,u))}v[It]=r,At(v),u=v}r.stateNode=u}else Q_(g,r.type,r.stateNode);else r.stateNode=H_(g,u,r.memoizedProps);else v!==u?(v===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):v.count--,u===null?Q_(g,r.type,r.stateNode):H_(g,u,r.memoizedProps)):u===null&&r.stateNode!==null&&Jh(r,r.memoizedProps,o.memoizedProps)}break;case 27:ln(i,r),cn(r),u&512&&(Tt||o===null||ur(o,o.return)),o!==null&&u&4&&Jh(r,r.memoizedProps,o.memoizedProps);break;case 5:if(ln(i,r),cn(r),u&512&&(Tt||o===null||ur(o,o.return)),r.flags&32){g=r.stateNode;try{Pi(g,"")}catch(Ae){rt(r,r.return,Ae)}}u&4&&r.stateNode!=null&&(g=r.memoizedProps,Jh(r,g,o!==null?o.memoizedProps:g)),u&1024&&(tm=!0);break;case 6:if(ln(i,r),cn(r),u&4){if(r.stateNode===null)throw Error(s(162));u=r.memoizedProps,o=r.stateNode;try{o.nodeValue=u}catch(Ae){rt(r,r.return,Ae)}}break;case 3:if(_u=null,g=Gn,Gn=yu(i.containerInfo),ln(i,r),Gn=g,cn(r),u&4&&o!==null&&o.memoizedState.isDehydrated)try{va(i.containerInfo)}catch(Ae){rt(r,r.return,Ae)}tm&&(tm=!1,Qv(r));break;case 4:u=Gn,Gn=yu(r.stateNode.containerInfo),ln(i,r),cn(r),Gn=u;break;case 12:ln(i,r),cn(r);break;case 31:ln(i,r),cn(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,ru(r,u)));break;case 13:ln(i,r),cn(r),r.child.flags&8192&&r.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(iu=ft()),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,ru(r,u)));break;case 22:g=r.memoizedState!==null;var X=o!==null&&o.memoizedState!==null,re=Mr,le=Tt;if(Mr=re||g,Tt=le||X,ln(i,r),Tt=le,Mr=re,cn(r),u&8192)e:for(i=r.stateNode,i._visibility=g?i._visibility&-2:i._visibility|1,g&&(o===null||X||Mr||Tt||si(r)),o=null,i=r;;){if(i.tag===5||i.tag===26){if(o===null){X=o=i;try{if(v=X.stateNode,g)N=v.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{z=X.stateNode;var me=X.memoizedProps.style,ie=me!=null&&me.hasOwnProperty("display")?me.display:null;z.style.display=ie==null||typeof ie=="boolean"?"":(""+ie).trim()}}catch(Ae){rt(X,X.return,Ae)}}}else if(i.tag===6){if(o===null){X=i;try{X.stateNode.nodeValue=g?"":X.memoizedProps}catch(Ae){rt(X,X.return,Ae)}}}else if(i.tag===18){if(o===null){X=i;try{var oe=X.stateNode;g?k_(oe,!0):k_(X.stateNode,!1)}catch(Ae){rt(X,X.return,Ae)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===r)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break e;for(;i.sibling===null;){if(i.return===null||i.return===r)break e;o===i&&(o=null),i=i.return}o===i&&(o=null),i.sibling.return=i.return,i=i.sibling}u&4&&(u=r.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,ru(r,o))));break;case 19:ln(i,r),cn(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,ru(r,u)));break;case 30:break;case 21:break;default:ln(i,r),cn(r)}}function cn(r){var i=r.flags;if(i&2){try{for(var o,u=r.return;u!==null;){if(Dv(u)){o=u;break}u=u.return}if(o==null)throw Error(s(160));switch(o.tag){case 27:var g=o.stateNode,v=Zh(r);nu(r,v,g);break;case 5:var N=o.stateNode;o.flags&32&&(Pi(N,""),o.flags&=-33);var z=Zh(r);nu(r,z,N);break;case 3:case 4:var X=o.stateNode.containerInfo,re=Zh(r);em(r,re,X);break;default:throw Error(s(161))}}catch(le){rt(r,r.return,le)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function Qv(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var i=r;Qv(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),r=r.sibling}}function Br(r,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)Lv(r,i.alternate,i),i=i.sibling}function si(r){for(r=r.child;r!==null;){var i=r;switch(i.tag){case 0:case 11:case 14:case 15:ps(4,i,i.return),si(i);break;case 1:ur(i,i.return);var o=i.stateNode;typeof o.componentWillUnmount=="function"&&kv(i,i.return,o),si(i);break;case 27:Po(i.stateNode);case 26:case 5:ur(i,i.return),si(i);break;case 22:i.memoizedState===null&&si(i);break;case 30:si(i);break;default:si(i)}r=r.sibling}}function Ur(r,i,o){for(o=o&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var u=i.alternate,g=r,v=i,N=v.flags;switch(v.tag){case 0:case 11:case 15:Ur(g,v,o),Oo(4,v);break;case 1:if(Ur(g,v,o),u=v,g=u.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(re){rt(u,u.return,re)}if(u=v,g=u.updateQueue,g!==null){var z=u.stateNode;try{var X=g.shared.hiddenCallbacks;if(X!==null)for(g.shared.hiddenCallbacks=null,g=0;g<X.length;g++)w0(X[g],z)}catch(re){rt(u,u.return,re)}}o&&N&64&&Iv(v),Io(v,v.return);break;case 27:Bv(v);case 26:case 5:Ur(g,v,o),o&&u===null&&N&4&&Mv(v),Io(v,v.return);break;case 12:Ur(g,v,o);break;case 31:Ur(g,v,o),o&&N&4&&Pv(g,v);break;case 13:Ur(g,v,o),o&&N&4&&Hv(g,v);break;case 22:v.memoizedState===null&&Ur(g,v,o),Io(v,v.return);break;case 30:break;default:Ur(g,v,o)}i=i.sibling}}function nm(r,i){var o=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),r=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(r=i.memoizedState.cachePool.pool),r!==o&&(r!=null&&r.refCount++,o!=null&&vo(o))}function rm(r,i){r=null,i.alternate!==null&&(r=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==r&&(i.refCount++,r!=null&&vo(r))}function Yn(r,i,o,u){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Fv(r,i,o,u),i=i.sibling}function Fv(r,i,o,u){var g=i.flags;switch(i.tag){case 0:case 11:case 15:Yn(r,i,o,u),g&2048&&Oo(9,i);break;case 1:Yn(r,i,o,u);break;case 3:Yn(r,i,o,u),g&2048&&(r=null,i.alternate!==null&&(r=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==r&&(i.refCount++,r!=null&&vo(r)));break;case 12:if(g&2048){Yn(r,i,o,u),r=i.stateNode;try{var v=i.memoizedProps,N=v.id,z=v.onPostCommit;typeof z=="function"&&z(N,i.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(X){rt(i,i.return,X)}}else Yn(r,i,o,u);break;case 31:Yn(r,i,o,u);break;case 13:Yn(r,i,o,u);break;case 23:break;case 22:v=i.stateNode,N=i.alternate,i.memoizedState!==null?v._visibility&2?Yn(r,i,o,u):ko(r,i):v._visibility&2?Yn(r,i,o,u):(v._visibility|=2,oa(r,i,o,u,(i.subtreeFlags&10256)!==0||!1)),g&2048&&nm(N,i);break;case 24:Yn(r,i,o,u),g&2048&&rm(i.alternate,i);break;default:Yn(r,i,o,u)}}function oa(r,i,o,u,g){for(g=g&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var v=r,N=i,z=o,X=u,re=N.flags;switch(N.tag){case 0:case 11:case 15:oa(v,N,z,X,g),Oo(8,N);break;case 23:break;case 22:var le=N.stateNode;N.memoizedState!==null?le._visibility&2?oa(v,N,z,X,g):ko(v,N):(le._visibility|=2,oa(v,N,z,X,g)),g&&re&2048&&nm(N.alternate,N);break;case 24:oa(v,N,z,X,g),g&&re&2048&&rm(N.alternate,N);break;default:oa(v,N,z,X,g)}i=i.sibling}}function ko(r,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var o=r,u=i,g=u.flags;switch(u.tag){case 22:ko(o,u),g&2048&&nm(u.alternate,u);break;case 24:ko(o,u),g&2048&&rm(u.alternate,u);break;default:ko(o,u)}i=i.sibling}}var Mo=8192;function la(r,i,o){if(r.subtreeFlags&Mo)for(r=r.child;r!==null;)Vv(r,i,o),r=r.sibling}function Vv(r,i,o){switch(r.tag){case 26:la(r,i,o),r.flags&Mo&&r.memoizedState!==null&&DN(o,Gn,r.memoizedState,r.memoizedProps);break;case 5:la(r,i,o);break;case 3:case 4:var u=Gn;Gn=yu(r.stateNode.containerInfo),la(r,i,o),Gn=u;break;case 22:r.memoizedState===null&&(u=r.alternate,u!==null&&u.memoizedState!==null?(u=Mo,Mo=16777216,la(r,i,o),Mo=u):la(r,i,o));break;default:la(r,i,o)}}function Gv(r){var i=r.alternate;if(i!==null&&(r=i.child,r!==null)){i.child=null;do i=r.sibling,r.sibling=null,r=i;while(r!==null)}}function Do(r){var i=r.deletions;if((r.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var u=i[o];Ut=u,Xv(u,r)}Gv(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Yv(r),r=r.sibling}function Yv(r){switch(r.tag){case 0:case 11:case 15:Do(r),r.flags&2048&&ps(9,r,r.return);break;case 3:Do(r);break;case 12:Do(r);break;case 22:var i=r.stateNode;r.memoizedState!==null&&i._visibility&2&&(r.return===null||r.return.tag!==13)?(i._visibility&=-3,su(r)):Do(r);break;default:Do(r)}}function su(r){var i=r.deletions;if((r.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var u=i[o];Ut=u,Xv(u,r)}Gv(r)}for(r=r.child;r!==null;){switch(i=r,i.tag){case 0:case 11:case 15:ps(8,i,i.return),su(i);break;case 22:o=i.stateNode,o._visibility&2&&(o._visibility&=-3,su(i));break;default:su(i)}r=r.sibling}}function Xv(r,i){for(;Ut!==null;){var o=Ut;switch(o.tag){case 0:case 11:case 15:ps(8,o,i);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:vo(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,Ut=u;else e:for(o=r;Ut!==null;){u=Ut;var g=u.sibling,v=u.return;if($v(u),u===o){Ut=null;break e}if(g!==null){g.return=v,Ut=g;break e}Ut=v}}}var KT={getCacheForType:function(r){var i=Pt(Et),o=i.data.get(r);return o===void 0&&(o=r(),i.data.set(r,o)),o},cacheSignal:function(){return Pt(Et).controller.signal}},WT=typeof WeakMap=="function"?WeakMap:Map,Ze=0,ot=null,qe=null,Fe=0,nt=0,wn=null,gs=!1,ca=!1,sm=!1,Lr=0,bt=0,ys=0,ii=0,im=0,xn=0,ua=0,Bo=null,un=null,am=!1,iu=0,Kv=0,au=1/0,ou=null,vs=null,kt=0,_s=null,da=null,$r=0,om=0,lm=null,Wv=null,Uo=0,cm=null;function An(){return(Ze&2)!==0&&Fe!==0?Fe&-Fe:R.T!==null?pm():dc()}function Jv(){if(xn===0)if((Fe&536870912)===0||Ye){var r=Oi;Oi<<=1,(Oi&3932160)===0&&(Oi=262144),xn=r}else xn=536870912;return r=_n.current,r!==null&&(r.flags|=32),xn}function dn(r,i,o){(r===ot&&(nt===2||nt===9)||r.cancelPendingCommit!==null)&&(fa(r,0),bs(r,Fe,xn,!1)),Hs(r,o),((Ze&2)===0||r!==ot)&&(r===ot&&((Ze&2)===0&&(ii|=o),bt===4&&bs(r,Fe,xn,!1)),dr(r))}function Zv(r,i,o){if((Ze&6)!==0)throw Error(s(327));var u=!o&&(i&127)===0&&(i&r.expiredLanes)===0||Ps(r,i),g=u?eN(r,i):dm(r,i,!0),v=u;do{if(g===0){ca&&!u&&bs(r,i,0,!1);break}else{if(o=r.current.alternate,v&&!JT(o)){g=dm(r,i,!1),v=!1;continue}if(g===2){if(v=i,r.errorRecoveryDisabledLanes&v)var N=0;else N=r.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){i=N;e:{var z=r;g=Bo;var X=z.current.memoizedState.isDehydrated;if(X&&(fa(z,N).flags|=256),N=dm(z,N,!1),N!==2){if(sm&&!X){z.errorRecoveryDisabledLanes|=v,ii|=v,g=4;break e}v=un,un=g,v!==null&&(un===null?un=v:un.push.apply(un,v))}g=N}if(v=!1,g!==2)continue}}if(g===1){fa(r,0),bs(r,i,0,!0);break}e:{switch(u=r,v=g,v){case 0:case 1:throw Error(s(345));case 4:if((i&4194048)!==i)break;case 6:bs(u,i,xn,!gs);break e;case 2:un=null;break;case 3:case 5:break;default:throw Error(s(329))}if((i&62914560)===i&&(g=iu+300-ft(),10<g)){if(bs(u,i,xn,!gs),ki(u,0,!0)!==0)break e;$r=i,u.timeoutHandle=j_(e_.bind(null,u,o,un,ou,am,i,xn,ii,ua,gs,v,"Throttled",-0,0),g);break e}e_(u,o,un,ou,am,i,xn,ii,ua,gs,v,null,-0,0)}}break}while(!0);dr(r)}function e_(r,i,o,u,g,v,N,z,X,re,le,me,ie,oe){if(r.timeoutHandle=-1,me=i.subtreeFlags,me&8192||(me&16785408)===16785408){me={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Er},Vv(i,v,me);var Ae=(v&62914560)===v?iu-ft():(v&4194048)===v?Kv-ft():0;if(Ae=BN(me,Ae),Ae!==null){$r=v,r.cancelPendingCommit=Ae(l_.bind(null,r,i,v,o,u,g,N,z,X,le,me,null,ie,oe)),bs(r,v,N,!re);return}}l_(r,i,v,o,u,g,N,z,X)}function JT(r){for(var i=r;;){var o=i.tag;if((o===0||o===11||o===15)&&i.flags&16384&&(o=i.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var g=o[u],v=g.getSnapshot;g=g.value;try{if(!yn(v(),g))return!1}catch{return!1}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function bs(r,i,o,u){i&=~im,i&=~ii,r.suspendedLanes|=i,r.pingedLanes&=~i,u&&(r.warmLanes|=i),u=r.expirationTimes;for(var g=i;0<g;){var v=31-Zt(g),N=1<<v;u[v]=-1,g&=~N}o!==0&&lc(r,o,i)}function lu(){return(Ze&6)===0?(Lo(0),!1):!0}function um(){if(qe!==null){if(nt===0)var r=qe.return;else r=qe,Nr=Ks=null,Ch(r),na=null,bo=0,r=qe;for(;r!==null;)Ov(r.alternate,r),r=r.return;qe=null}}function fa(r,i){var o=r.timeoutHandle;o!==-1&&(r.timeoutHandle=-1,vN(o)),o=r.cancelPendingCommit,o!==null&&(r.cancelPendingCommit=null,o()),$r=0,um(),ot=r,qe=o=Cr(r.current,null),Fe=i,nt=0,wn=null,gs=!1,ca=Ps(r,i),sm=!1,ua=xn=im=ii=ys=bt=0,un=Bo=null,am=!1,(i&8)!==0&&(i|=i&32);var u=r.entangledLanes;if(u!==0)for(r=r.entanglements,u&=i;0<u;){var g=31-Zt(u),v=1<<g;i|=r[g],u&=~v}return Lr=i,Rc(),o}function t_(r,i){ze=null,R.H=No,i===ta||i===Uc?(i=y0(),nt=3):i===mh?(i=y0(),nt=4):nt=i===Hh?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,wn=i,qe===null&&(bt=1,Wc(r,Dn(i,r.current)))}function n_(){var r=_n.current;return r===null?!0:(Fe&4194048)===Fe?$n===null:(Fe&62914560)===Fe||(Fe&536870912)!==0?r===$n:!1}function r_(){var r=R.H;return R.H=No,r===null?No:r}function s_(){var r=R.A;return R.A=KT,r}function cu(){bt=4,gs||(Fe&4194048)!==Fe&&_n.current!==null||(ca=!0),(ys&134217727)===0&&(ii&134217727)===0||ot===null||bs(ot,Fe,xn,!1)}function dm(r,i,o){var u=Ze;Ze|=2;var g=r_(),v=s_();(ot!==r||Fe!==i)&&(ou=null,fa(r,i)),i=!1;var N=bt;e:do try{if(nt!==0&&qe!==null){var z=qe,X=wn;switch(nt){case 8:um(),N=6;break e;case 3:case 2:case 9:case 6:_n.current===null&&(i=!0);var re=nt;if(nt=0,wn=null,ha(r,z,X,re),o&&ca){N=0;break e}break;default:re=nt,nt=0,wn=null,ha(r,z,X,re)}}ZT(),N=bt;break}catch(le){t_(r,le)}while(!0);return i&&r.shellSuspendCounter++,Nr=Ks=null,Ze=u,R.H=g,R.A=v,qe===null&&(ot=null,Fe=0,Rc()),N}function ZT(){for(;qe!==null;)i_(qe)}function eN(r,i){var o=Ze;Ze|=2;var u=r_(),g=s_();ot!==r||Fe!==i?(ou=null,au=ft()+500,fa(r,i)):ca=Ps(r,i);e:do try{if(nt!==0&&qe!==null){i=qe;var v=wn;t:switch(nt){case 1:nt=0,wn=null,ha(r,i,v,1);break;case 2:case 9:if(p0(v)){nt=0,wn=null,a_(i);break}i=function(){nt!==2&&nt!==9||ot!==r||(nt=7),dr(r)},v.then(i,i);break e;case 3:nt=7;break e;case 4:nt=5;break e;case 7:p0(v)?(nt=0,wn=null,a_(i)):(nt=0,wn=null,ha(r,i,v,7));break;case 5:var N=null;switch(qe.tag){case 26:N=qe.memoizedState;case 5:case 27:var z=qe;if(N?F_(N):z.stateNode.complete){nt=0,wn=null;var X=z.sibling;if(X!==null)qe=X;else{var re=z.return;re!==null?(qe=re,uu(re)):qe=null}break t}}nt=0,wn=null,ha(r,i,v,5);break;case 6:nt=0,wn=null,ha(r,i,v,6);break;case 8:um(),bt=6;break e;default:throw Error(s(462))}}tN();break}catch(le){t_(r,le)}while(!0);return Nr=Ks=null,R.H=u,R.A=g,Ze=o,qe!==null?0:(ot=null,Fe=0,Rc(),bt)}function tN(){for(;qe!==null&&!pn();)i_(qe)}function i_(r){var i=Rv(r.alternate,r,Lr);r.memoizedProps=r.pendingProps,i===null?uu(r):qe=i}function a_(r){var i=r,o=i.alternate;switch(i.tag){case 15:case 0:i=Av(o,i,i.pendingProps,i.type,void 0,Fe);break;case 11:i=Av(o,i,i.pendingProps,i.type.render,i.ref,Fe);break;case 5:Ch(i);default:Ov(o,i),i=qe=s0(i,Lr),i=Rv(o,i,Lr)}r.memoizedProps=r.pendingProps,i===null?uu(r):qe=i}function ha(r,i,o,u){Nr=Ks=null,Ch(i),na=null,bo=0;var g=i.return;try{if(qT(r,g,i,o,Fe)){bt=1,Wc(r,Dn(o,r.current)),qe=null;return}}catch(v){if(g!==null)throw qe=g,v;bt=1,Wc(r,Dn(o,r.current)),qe=null;return}i.flags&32768?(Ye||u===1?r=!0:ca||(Fe&536870912)!==0?r=!1:(gs=r=!0,(u===2||u===9||u===3||u===6)&&(u=_n.current,u!==null&&u.tag===13&&(u.flags|=16384))),o_(i,r)):uu(i)}function uu(r){var i=r;do{if((i.flags&32768)!==0){o_(i,gs);return}r=i.return;var o=VT(i.alternate,i,Lr);if(o!==null){qe=o;return}if(i=i.sibling,i!==null){qe=i;return}qe=i=r}while(i!==null);bt===0&&(bt=5)}function o_(r,i){do{var o=GT(r.alternate,r);if(o!==null){o.flags&=32767,qe=o;return}if(o=r.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!i&&(r=r.sibling,r!==null)){qe=r;return}qe=r=o}while(r!==null);bt=6,qe=null}function l_(r,i,o,u,g,v,N,z,X){r.cancelPendingCommit=null;do du();while(kt!==0);if((Ze&6)!==0)throw Error(s(327));if(i!==null){if(i===r.current)throw Error(s(177));if(v=i.lanes|i.childLanes,v|=Zf,Rf(r,o,v,N,z,X),r===ot&&(qe=ot=null,Fe=0),da=i,_s=r,$r=o,om=v,lm=g,Wv=u,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,iN(rn,function(){return h_(),null})):(r.callbackNode=null,r.callbackPriority=0),u=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||u){u=R.T,R.T=null,g=U.p,U.p=2,N=Ze,Ze|=4;try{YT(r,i,o)}finally{Ze=N,U.p=g,R.T=u}}kt=1,c_(),u_(),d_()}}function c_(){if(kt===1){kt=0;var r=_s,i=da,o=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||o){o=R.T,R.T=null;var u=U.p;U.p=2;var g=Ze;Ze|=4;try{qv(i,r);var v=Am,N=Xy(r.containerInfo),z=v.focusedElem,X=v.selectionRange;if(N!==z&&z&&z.ownerDocument&&Yy(z.ownerDocument.documentElement,z)){if(X!==null&&Yf(z)){var re=X.start,le=X.end;if(le===void 0&&(le=re),"selectionStart"in z)z.selectionStart=re,z.selectionEnd=Math.min(le,z.value.length);else{var me=z.ownerDocument||document,ie=me&&me.defaultView||window;if(ie.getSelection){var oe=ie.getSelection(),Ae=z.textContent.length,ke=Math.min(X.start,Ae),at=X.end===void 0?ke:Math.min(X.end,Ae);!oe.extend&&ke>at&&(N=at,at=ke,ke=N);var ee=Gy(z,ke),W=Gy(z,at);if(ee&&W&&(oe.rangeCount!==1||oe.anchorNode!==ee.node||oe.anchorOffset!==ee.offset||oe.focusNode!==W.node||oe.focusOffset!==W.offset)){var ne=me.createRange();ne.setStart(ee.node,ee.offset),oe.removeAllRanges(),ke>at?(oe.addRange(ne),oe.extend(W.node,W.offset)):(ne.setEnd(W.node,W.offset),oe.addRange(ne))}}}}for(me=[],oe=z;oe=oe.parentNode;)oe.nodeType===1&&me.push({element:oe,left:oe.scrollLeft,top:oe.scrollTop});for(typeof z.focus=="function"&&z.focus(),z=0;z<me.length;z++){var de=me[z];de.element.scrollLeft=de.left,de.element.scrollTop=de.top}}Au=!!xm,Am=xm=null}finally{Ze=g,U.p=u,R.T=o}}r.current=i,kt=2}}function u_(){if(kt===2){kt=0;var r=_s,i=da,o=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||o){o=R.T,R.T=null;var u=U.p;U.p=2;var g=Ze;Ze|=4;try{Lv(r,i.alternate,i)}finally{Ze=g,U.p=u,R.T=o}}kt=3}}function d_(){if(kt===4||kt===3){kt=0,Gt();var r=_s,i=da,o=$r,u=Wv;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?kt=5:(kt=0,da=_s=null,f_(r,r.pendingLanes));var g=r.pendingLanes;if(g===0&&(vs=null),no(o),i=i.stateNode,tt&&typeof tt.onCommitFiberRoot=="function")try{tt.onCommitFiberRoot(Ke,i,void 0,(i.current.flags&128)===128)}catch{}if(u!==null){i=R.T,g=U.p,U.p=2,R.T=null;try{for(var v=r.onRecoverableError,N=0;N<u.length;N++){var z=u[N];v(z.value,{componentStack:z.stack})}}finally{R.T=i,U.p=g}}($r&3)!==0&&du(),dr(r),g=r.pendingLanes,(o&261930)!==0&&(g&42)!==0?r===cm?Uo++:(Uo=0,cm=r):Uo=0,Lo(0)}}function f_(r,i){(r.pooledCacheLanes&=i)===0&&(i=r.pooledCache,i!=null&&(r.pooledCache=null,vo(i)))}function du(){return c_(),u_(),d_(),h_()}function h_(){if(kt!==5)return!1;var r=_s,i=om;om=0;var o=no($r),u=R.T,g=U.p;try{U.p=32>o?32:o,R.T=null,o=lm,lm=null;var v=_s,N=$r;if(kt=0,da=_s=null,$r=0,(Ze&6)!==0)throw Error(s(331));var z=Ze;if(Ze|=4,Yv(v.current),Fv(v,v.current,N,o),Ze=z,Lo(0,!1),tt&&typeof tt.onPostCommitFiberRoot=="function")try{tt.onPostCommitFiberRoot(Ke,v)}catch{}return!0}finally{U.p=g,R.T=u,f_(r,i)}}function m_(r,i,o){i=Dn(o,i),i=Ph(r.stateNode,i,2),r=fs(r,i,2),r!==null&&(Hs(r,2),dr(r))}function rt(r,i,o){if(r.tag===3)m_(r,r,o);else for(;i!==null;){if(i.tag===3){m_(i,r,o);break}else if(i.tag===1){var u=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(vs===null||!vs.has(u))){r=Dn(o,r),o=pv(2),u=fs(i,o,2),u!==null&&(gv(o,u,i,r),Hs(u,2),dr(u));break}}i=i.return}}function fm(r,i,o){var u=r.pingCache;if(u===null){u=r.pingCache=new WT;var g=new Set;u.set(i,g)}else g=u.get(i),g===void 0&&(g=new Set,u.set(i,g));g.has(o)||(sm=!0,g.add(o),r=nN.bind(null,r,i,o),i.then(r,r))}function nN(r,i,o){var u=r.pingCache;u!==null&&u.delete(i),r.pingedLanes|=r.suspendedLanes&o,r.warmLanes&=~o,ot===r&&(Fe&o)===o&&(bt===4||bt===3&&(Fe&62914560)===Fe&&300>ft()-iu?(Ze&2)===0&&fa(r,0):im|=o,ua===Fe&&(ua=0)),dr(r)}function p_(r,i){i===0&&(i=oc()),r=Gs(r,i),r!==null&&(Hs(r,i),dr(r))}function rN(r){var i=r.memoizedState,o=0;i!==null&&(o=i.retryLane),p_(r,o)}function sN(r,i){var o=0;switch(r.tag){case 31:case 13:var u=r.stateNode,g=r.memoizedState;g!==null&&(o=g.retryLane);break;case 19:u=r.stateNode;break;case 22:u=r.stateNode._retryCache;break;default:throw Error(s(314))}u!==null&&u.delete(i),p_(r,o)}function iN(r,i){return ct(r,i)}var fu=null,ma=null,hm=!1,hu=!1,mm=!1,ws=0;function dr(r){r!==ma&&r.next===null&&(ma===null?fu=ma=r:ma=ma.next=r),hu=!0,hm||(hm=!0,oN())}function Lo(r,i){if(!mm&&hu){mm=!0;do for(var o=!1,u=fu;u!==null;){if(r!==0){var g=u.pendingLanes;if(g===0)var v=0;else{var N=u.suspendedLanes,z=u.pingedLanes;v=(1<<31-Zt(42|r)+1)-1,v&=g&~(N&~z),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(o=!0,__(u,v))}else v=Fe,v=ki(u,u===ot?v:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(v&3)===0||Ps(u,v)||(o=!0,__(u,v));u=u.next}while(o);mm=!1}}function aN(){g_()}function g_(){hu=hm=!1;var r=0;ws!==0&&yN()&&(r=ws);for(var i=ft(),o=null,u=fu;u!==null;){var g=u.next,v=y_(u,i);v===0?(u.next=null,o===null?fu=g:o.next=g,g===null&&(ma=o)):(o=u,(r!==0||(v&3)!==0)&&(hu=!0)),u=g}kt!==0&&kt!==5||Lo(r),ws!==0&&(ws=0)}function y_(r,i){for(var o=r.suspendedLanes,u=r.pingedLanes,g=r.expirationTimes,v=r.pendingLanes&-62914561;0<v;){var N=31-Zt(v),z=1<<N,X=g[N];X===-1?((z&o)===0||(z&u)!==0)&&(g[N]=Nf(z,i)):X<=i&&(r.expiredLanes|=z),v&=~z}if(i=ot,o=Fe,o=ki(r,r===i?o:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u=r.callbackNode,o===0||r===i&&(nt===2||nt===9)||r.cancelPendingCommit!==null)return u!==null&&u!==null&&et(u),r.callbackNode=null,r.callbackPriority=0;if((o&3)===0||Ps(r,o)){if(i=o&-o,i===r.callbackPriority)return i;switch(u!==null&&et(u),no(o)){case 2:case 8:o=nn;break;case 32:o=rn;break;case 268435456:o=ge;break;default:o=rn}return u=v_.bind(null,r),o=ct(o,u),r.callbackPriority=i,r.callbackNode=o,i}return u!==null&&u!==null&&et(u),r.callbackPriority=2,r.callbackNode=null,2}function v_(r,i){if(kt!==0&&kt!==5)return r.callbackNode=null,r.callbackPriority=0,null;var o=r.callbackNode;if(du()&&r.callbackNode!==o)return null;var u=Fe;return u=ki(r,r===ot?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u===0?null:(Zv(r,u,i),y_(r,ft()),r.callbackNode!=null&&r.callbackNode===o?v_.bind(null,r):null)}function __(r,i){if(du())return null;Zv(r,i,!0)}function oN(){_N(function(){(Ze&6)!==0?ct(kn,aN):g_()})}function pm(){if(ws===0){var r=Zi;r===0&&(r=ji,ji<<=1,(ji&261888)===0&&(ji=256)),ws=r}return ws}function b_(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:wc(""+r)}function w_(r,i){var o=i.ownerDocument.createElement("input");return o.name=i.name,o.value=i.value,r.id&&o.setAttribute("form",r.id),i.parentNode.insertBefore(o,i),r=new FormData(r),o.parentNode.removeChild(o),r}function lN(r,i,o,u,g){if(i==="submit"&&o&&o.stateNode===g){var v=b_((g[Yt]||null).action),N=u.submitter;N&&(i=(i=N[Yt]||null)?b_(i.formAction):N.getAttribute("formAction"),i!==null&&(v=i,N=null));var z=new Sc("action","action",null,u,g);r.push({event:z,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(ws!==0){var X=N?w_(g,N):new FormData(g);Dh(o,{pending:!0,data:X,method:g.method,action:v},null,X)}}else typeof v=="function"&&(z.preventDefault(),X=N?w_(g,N):new FormData(g),Dh(o,{pending:!0,data:X,method:g.method,action:v},v,X))},currentTarget:g}]})}}for(var gm=0;gm<Jf.length;gm++){var ym=Jf[gm],cN=ym.toLowerCase(),uN=ym[0].toUpperCase()+ym.slice(1);Vn(cN,"on"+uN)}Vn(Jy,"onAnimationEnd"),Vn(Zy,"onAnimationIteration"),Vn(e0,"onAnimationStart"),Vn("dblclick","onDoubleClick"),Vn("focusin","onFocus"),Vn("focusout","onBlur"),Vn(CT,"onTransitionRun"),Vn(TT,"onTransitionStart"),Vn(NT,"onTransitionCancel"),Vn(t0,"onTransitionEnd"),ss("onMouseEnter",["mouseout","mouseover"]),ss("onMouseLeave",["mouseout","mouseover"]),ss("onPointerEnter",["pointerout","pointerover"]),ss("onPointerLeave",["pointerout","pointerover"]),Ar("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ar("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ar("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ar("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ar("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ar("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $o="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dN=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat($o));function x_(r,i){i=(i&4)!==0;for(var o=0;o<r.length;o++){var u=r[o],g=u.event;u=u.listeners;e:{var v=void 0;if(i)for(var N=u.length-1;0<=N;N--){var z=u[N],X=z.instance,re=z.currentTarget;if(z=z.listener,X!==v&&g.isPropagationStopped())break e;v=z,g.currentTarget=re;try{v(g)}catch(le){Nc(le)}g.currentTarget=null,v=X}else for(N=0;N<u.length;N++){if(z=u[N],X=z.instance,re=z.currentTarget,z=z.listener,X!==v&&g.isPropagationStopped())break e;v=z,g.currentTarget=re;try{v(g)}catch(le){Nc(le)}g.currentTarget=null,v=X}}}}function Qe(r,i){var o=i[Mi];o===void 0&&(o=i[Mi]=new Set);var u=r+"__bubble";o.has(u)||(A_(i,r,2,!1),o.add(u))}function vm(r,i,o){var u=0;i&&(u|=4),A_(o,r,u,i)}var mu="_reactListening"+Math.random().toString(36).slice(2);function _m(r){if(!r[mu]){r[mu]=!0,pc.forEach(function(o){o!=="selectionchange"&&(dN.has(o)||vm(o,!1,r),vm(o,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[mu]||(i[mu]=!0,vm("selectionchange",!1,i))}}function A_(r,i,o,u){switch(J_(i)){case 2:var g=$N;break;case 8:g=zN;break;default:g=Mm}o=g.bind(null,i,o,r),g=void 0,!$f||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(g=!0),u?g!==void 0?r.addEventListener(i,o,{capture:!0,passive:g}):r.addEventListener(i,o,!0):g!==void 0?r.addEventListener(i,o,{passive:g}):r.addEventListener(i,o,!1)}function bm(r,i,o,u,g){var v=u;if((i&1)===0&&(i&2)===0&&u!==null)e:for(;;){if(u===null)return;var N=u.tag;if(N===3||N===4){var z=u.stateNode.containerInfo;if(z===g)break;if(N===4)for(N=u.return;N!==null;){var X=N.tag;if((X===3||X===4)&&N.stateNode.containerInfo===g)return;N=N.return}for(;z!==null;){if(N=es(z),N===null)return;if(X=N.tag,X===5||X===6||X===26||X===27){u=v=N;continue e}z=z.parentNode}}u=u.return}Ny(function(){var re=v,le=Uf(o),me=[];e:{var ie=n0.get(r);if(ie!==void 0){var oe=Sc,Ae=r;switch(r){case"keypress":if(Ac(o)===0)break e;case"keydown":case"keyup":oe=sT;break;case"focusin":Ae="focus",oe=qf;break;case"focusout":Ae="blur",oe=qf;break;case"beforeblur":case"afterblur":oe=qf;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":oe=Oy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":oe=VC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":oe=oT;break;case Jy:case Zy:case e0:oe=XC;break;case t0:oe=cT;break;case"scroll":case"scrollend":oe=QC;break;case"wheel":oe=dT;break;case"copy":case"cut":case"paste":oe=WC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":oe=ky;break;case"toggle":case"beforetoggle":oe=hT}var ke=(i&4)!==0,at=!ke&&(r==="scroll"||r==="scrollend"),ee=ke?ie!==null?ie+"Capture":null:ie;ke=[];for(var W=re,ne;W!==null;){var de=W;if(ne=de.stateNode,de=de.tag,de!==5&&de!==26&&de!==27||ne===null||ee===null||(de=ao(W,ee),de!=null&&ke.push(zo(W,de,ne))),at)break;W=W.return}0<ke.length&&(ie=new oe(ie,Ae,null,o,le),me.push({event:ie,listeners:ke}))}}if((i&7)===0){e:{if(ie=r==="mouseover"||r==="pointerover",oe=r==="mouseout"||r==="pointerout",ie&&o!==Bf&&(Ae=o.relatedTarget||o.fromElement)&&(es(Ae)||Ae[xr]))break e;if((oe||ie)&&(ie=le.window===le?le:(ie=le.ownerDocument)?ie.defaultView||ie.parentWindow:window,oe?(Ae=o.relatedTarget||o.toElement,oe=re,Ae=Ae?es(Ae):null,Ae!==null&&(at=l(Ae),ke=Ae.tag,Ae!==at||ke!==5&&ke!==27&&ke!==6)&&(Ae=null)):(oe=null,Ae=re),oe!==Ae)){if(ke=Oy,de="onMouseLeave",ee="onMouseEnter",W="mouse",(r==="pointerout"||r==="pointerover")&&(ke=ky,de="onPointerLeave",ee="onPointerEnter",W="pointer"),at=oe==null?ie:ns(oe),ne=Ae==null?ie:ns(Ae),ie=new ke(de,W+"leave",oe,o,le),ie.target=at,ie.relatedTarget=ne,de=null,es(le)===re&&(ke=new ke(ee,W+"enter",Ae,o,le),ke.target=ne,ke.relatedTarget=at,de=ke),at=de,oe&&Ae)t:{for(ke=fN,ee=oe,W=Ae,ne=0,de=ee;de;de=ke(de))ne++;de=0;for(var Oe=W;Oe;Oe=ke(Oe))de++;for(;0<ne-de;)ee=ke(ee),ne--;for(;0<de-ne;)W=ke(W),de--;for(;ne--;){if(ee===W||W!==null&&ee===W.alternate){ke=ee;break t}ee=ke(ee),W=ke(W)}ke=null}else ke=null;oe!==null&&E_(me,ie,oe,ke,!1),Ae!==null&&at!==null&&E_(me,at,Ae,ke,!0)}}e:{if(ie=re?ns(re):window,oe=ie.nodeName&&ie.nodeName.toLowerCase(),oe==="select"||oe==="input"&&ie.type==="file")var We=Py;else if($y(ie))if(Hy)We=AT;else{We=wT;var Se=bT}else oe=ie.nodeName,!oe||oe.toLowerCase()!=="input"||ie.type!=="checkbox"&&ie.type!=="radio"?re&&Df(re.elementType)&&(We=Py):We=xT;if(We&&(We=We(r,re))){zy(me,We,o,le);break e}Se&&Se(r,ie,re),r==="focusout"&&re&&ie.type==="number"&&re.memoizedProps.value!=null&&$i(ie,"number",ie.value)}switch(Se=re?ns(re):window,r){case"focusin":($y(Se)||Se.contentEditable==="true")&&(Fi=Se,Xf=re,po=null);break;case"focusout":po=Xf=Fi=null;break;case"mousedown":Kf=!0;break;case"contextmenu":case"mouseup":case"dragend":Kf=!1,Ky(me,o,le);break;case"selectionchange":if(ST)break;case"keydown":case"keyup":Ky(me,o,le)}var Pe;if(Ff)e:{switch(r){case"compositionstart":var Ve="onCompositionStart";break e;case"compositionend":Ve="onCompositionEnd";break e;case"compositionupdate":Ve="onCompositionUpdate";break e}Ve=void 0}else Qi?Uy(r,o)&&(Ve="onCompositionEnd"):r==="keydown"&&o.keyCode===229&&(Ve="onCompositionStart");Ve&&(My&&o.locale!=="ko"&&(Qi||Ve!=="onCompositionStart"?Ve==="onCompositionEnd"&&Qi&&(Pe=Ry()):(is=le,zf="value"in is?is.value:is.textContent,Qi=!0)),Se=pu(re,Ve),0<Se.length&&(Ve=new Iy(Ve,r,null,o,le),me.push({event:Ve,listeners:Se}),Pe?Ve.data=Pe:(Pe=Ly(o),Pe!==null&&(Ve.data=Pe)))),(Pe=pT?gT(r,o):yT(r,o))&&(Ve=pu(re,"onBeforeInput"),0<Ve.length&&(Se=new Iy("onBeforeInput","beforeinput",null,o,le),me.push({event:Se,listeners:Ve}),Se.data=Pe)),lN(me,r,re,o,le)}x_(me,i)})}function zo(r,i,o){return{instance:r,listener:i,currentTarget:o}}function pu(r,i){for(var o=i+"Capture",u=[];r!==null;){var g=r,v=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||v===null||(g=ao(r,o),g!=null&&u.unshift(zo(r,g,v)),g=ao(r,i),g!=null&&u.push(zo(r,g,v))),r.tag===3)return u;r=r.return}return[]}function fN(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function E_(r,i,o,u,g){for(var v=i._reactName,N=[];o!==null&&o!==u;){var z=o,X=z.alternate,re=z.stateNode;if(z=z.tag,X!==null&&X===u)break;z!==5&&z!==26&&z!==27||re===null||(X=re,g?(re=ao(o,v),re!=null&&N.unshift(zo(o,re,X))):g||(re=ao(o,v),re!=null&&N.push(zo(o,re,X)))),o=o.return}N.length!==0&&r.push({event:i,listeners:N})}var hN=/\r\n?/g,mN=/\u0000|\uFFFD/g;function S_(r){return(typeof r=="string"?r:""+r).replace(hN,`
`).replace(mN,"")}function C_(r,i){return i=S_(i),S_(r)===i}function it(r,i,o,u,g,v){switch(o){case"children":typeof u=="string"?i==="body"||i==="textarea"&&u===""||Pi(r,u):(typeof u=="number"||typeof u=="bigint")&&i!=="body"&&Pi(r,""+u);break;case"className":Bi(r,"class",u);break;case"tabIndex":Bi(r,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Bi(r,o,u);break;case"style":Cy(r,u,v);break;case"data":if(i!=="object"){Bi(r,"data",u);break}case"src":case"href":if(u===""&&(i!=="a"||o!=="href")){r.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(o);break}u=wc(""+u),r.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){r.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(o==="formAction"?(i!=="input"&&it(r,i,"name",g.name,g,null),it(r,i,"formEncType",g.formEncType,g,null),it(r,i,"formMethod",g.formMethod,g,null),it(r,i,"formTarget",g.formTarget,g,null)):(it(r,i,"encType",g.encType,g,null),it(r,i,"method",g.method,g,null),it(r,i,"target",g.target,g,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(o);break}u=wc(""+u),r.setAttribute(o,u);break;case"onClick":u!=null&&(r.onclick=Er);break;case"onScroll":u!=null&&Qe("scroll",r);break;case"onScrollEnd":u!=null&&Qe("scrollend",r);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(o=u.__html,o!=null){if(g.children!=null)throw Error(s(60));r.innerHTML=o}}break;case"multiple":r.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":r.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){r.removeAttribute("xlink:href");break}o=wc(""+u),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,""+u):r.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,""):r.removeAttribute(o);break;case"capture":case"download":u===!0?r.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,u):r.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?r.setAttribute(o,u):r.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?r.removeAttribute(o):r.setAttribute(o,u);break;case"popover":Qe("beforetoggle",r),Qe("toggle",r),Di(r,"popover",u);break;case"xlinkActuate":Fn(r,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Fn(r,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Fn(r,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Fn(r,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Fn(r,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Fn(r,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Fn(r,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Fn(r,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Fn(r,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Di(r,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=HC.get(o)||o,Di(r,o,u))}}function wm(r,i,o,u,g,v){switch(o){case"style":Cy(r,u,v);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(o=u.__html,o!=null){if(g.children!=null)throw Error(s(60));r.innerHTML=o}}break;case"children":typeof u=="string"?Pi(r,u):(typeof u=="number"||typeof u=="bigint")&&Pi(r,""+u);break;case"onScroll":u!=null&&Qe("scroll",r);break;case"onScrollEnd":u!=null&&Qe("scrollend",r);break;case"onClick":u!=null&&(r.onclick=Er);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!gc.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(g=o.endsWith("Capture"),i=o.slice(2,g?o.length-7:void 0),v=r[Yt]||null,v=v!=null?v[o]:null,typeof v=="function"&&r.removeEventListener(i,v,g),typeof u=="function")){typeof v!="function"&&v!==null&&(o in r?r[o]=null:r.hasAttribute(o)&&r.removeAttribute(o)),r.addEventListener(i,u,g);break e}o in r?r[o]=u:u===!0?r.setAttribute(o,""):Di(r,o,u)}}}function qt(r,i,o){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Qe("error",r),Qe("load",r);var u=!1,g=!1,v;for(v in o)if(o.hasOwnProperty(v)){var N=o[v];if(N!=null)switch(v){case"src":u=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,i));default:it(r,i,v,N,o,null)}}g&&it(r,i,"srcSet",o.srcSet,o,null),u&&it(r,i,"src",o.src,o,null);return;case"input":Qe("invalid",r);var z=v=N=g=null,X=null,re=null;for(u in o)if(o.hasOwnProperty(u)){var le=o[u];if(le!=null)switch(u){case"name":g=le;break;case"type":N=le;break;case"checked":X=le;break;case"defaultChecked":re=le;break;case"value":v=le;break;case"defaultValue":z=le;break;case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(s(137,i));break;default:it(r,i,u,le,o,null)}}bc(r,v,z,X,re,N,g,!1);return;case"select":Qe("invalid",r),u=N=v=null;for(g in o)if(o.hasOwnProperty(g)&&(z=o[g],z!=null))switch(g){case"value":v=z;break;case"defaultValue":N=z;break;case"multiple":u=z;default:it(r,i,g,z,o,null)}i=v,o=N,r.multiple=!!u,i!=null?zi(r,!!u,i,!1):o!=null&&zi(r,!!u,o,!0);return;case"textarea":Qe("invalid",r),v=g=u=null;for(N in o)if(o.hasOwnProperty(N)&&(z=o[N],z!=null))switch(N){case"value":u=z;break;case"defaultValue":g=z;break;case"children":v=z;break;case"dangerouslySetInnerHTML":if(z!=null)throw Error(s(91));break;default:it(r,i,N,z,o,null)}Ey(r,u,g,v);return;case"option":for(X in o)if(o.hasOwnProperty(X)&&(u=o[X],u!=null))switch(X){case"selected":r.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:it(r,i,X,u,o,null)}return;case"dialog":Qe("beforetoggle",r),Qe("toggle",r),Qe("cancel",r),Qe("close",r);break;case"iframe":case"object":Qe("load",r);break;case"video":case"audio":for(u=0;u<$o.length;u++)Qe($o[u],r);break;case"image":Qe("error",r),Qe("load",r);break;case"details":Qe("toggle",r);break;case"embed":case"source":case"link":Qe("error",r),Qe("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(re in o)if(o.hasOwnProperty(re)&&(u=o[re],u!=null))switch(re){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,i));default:it(r,i,re,u,o,null)}return;default:if(Df(i)){for(le in o)o.hasOwnProperty(le)&&(u=o[le],u!==void 0&&wm(r,i,le,u,o,void 0));return}}for(z in o)o.hasOwnProperty(z)&&(u=o[z],u!=null&&it(r,i,z,u,o,null))}function pN(r,i,o,u){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,v=null,N=null,z=null,X=null,re=null,le=null;for(oe in o){var me=o[oe];if(o.hasOwnProperty(oe)&&me!=null)switch(oe){case"checked":break;case"value":break;case"defaultValue":X=me;default:u.hasOwnProperty(oe)||it(r,i,oe,null,u,me)}}for(var ie in u){var oe=u[ie];if(me=o[ie],u.hasOwnProperty(ie)&&(oe!=null||me!=null))switch(ie){case"type":v=oe;break;case"name":g=oe;break;case"checked":re=oe;break;case"defaultChecked":le=oe;break;case"value":N=oe;break;case"defaultValue":z=oe;break;case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(s(137,i));break;default:oe!==me&&it(r,i,ie,oe,u,me)}}io(r,N,z,X,re,le,v,g);return;case"select":oe=N=z=ie=null;for(v in o)if(X=o[v],o.hasOwnProperty(v)&&X!=null)switch(v){case"value":break;case"multiple":oe=X;default:u.hasOwnProperty(v)||it(r,i,v,null,u,X)}for(g in u)if(v=u[g],X=o[g],u.hasOwnProperty(g)&&(v!=null||X!=null))switch(g){case"value":ie=v;break;case"defaultValue":z=v;break;case"multiple":N=v;default:v!==X&&it(r,i,g,v,u,X)}i=z,o=N,u=oe,ie!=null?zi(r,!!o,ie,!1):!!u!=!!o&&(i!=null?zi(r,!!o,i,!0):zi(r,!!o,o?[]:"",!1));return;case"textarea":oe=ie=null;for(z in o)if(g=o[z],o.hasOwnProperty(z)&&g!=null&&!u.hasOwnProperty(z))switch(z){case"value":break;case"children":break;default:it(r,i,z,null,u,g)}for(N in u)if(g=u[N],v=o[N],u.hasOwnProperty(N)&&(g!=null||v!=null))switch(N){case"value":ie=g;break;case"defaultValue":oe=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(s(91));break;default:g!==v&&it(r,i,N,g,u,v)}Ay(r,ie,oe);return;case"option":for(var Ae in o)if(ie=o[Ae],o.hasOwnProperty(Ae)&&ie!=null&&!u.hasOwnProperty(Ae))switch(Ae){case"selected":r.selected=!1;break;default:it(r,i,Ae,null,u,ie)}for(X in u)if(ie=u[X],oe=o[X],u.hasOwnProperty(X)&&ie!==oe&&(ie!=null||oe!=null))switch(X){case"selected":r.selected=ie&&typeof ie!="function"&&typeof ie!="symbol";break;default:it(r,i,X,ie,u,oe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ke in o)ie=o[ke],o.hasOwnProperty(ke)&&ie!=null&&!u.hasOwnProperty(ke)&&it(r,i,ke,null,u,ie);for(re in u)if(ie=u[re],oe=o[re],u.hasOwnProperty(re)&&ie!==oe&&(ie!=null||oe!=null))switch(re){case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(s(137,i));break;default:it(r,i,re,ie,u,oe)}return;default:if(Df(i)){for(var at in o)ie=o[at],o.hasOwnProperty(at)&&ie!==void 0&&!u.hasOwnProperty(at)&&wm(r,i,at,void 0,u,ie);for(le in u)ie=u[le],oe=o[le],!u.hasOwnProperty(le)||ie===oe||ie===void 0&&oe===void 0||wm(r,i,le,ie,u,oe);return}}for(var ee in o)ie=o[ee],o.hasOwnProperty(ee)&&ie!=null&&!u.hasOwnProperty(ee)&&it(r,i,ee,null,u,ie);for(me in u)ie=u[me],oe=o[me],!u.hasOwnProperty(me)||ie===oe||ie==null&&oe==null||it(r,i,me,ie,u,oe)}function T_(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function gN(){if(typeof performance.getEntriesByType=="function"){for(var r=0,i=0,o=performance.getEntriesByType("resource"),u=0;u<o.length;u++){var g=o[u],v=g.transferSize,N=g.initiatorType,z=g.duration;if(v&&z&&T_(N)){for(N=0,z=g.responseEnd,u+=1;u<o.length;u++){var X=o[u],re=X.startTime;if(re>z)break;var le=X.transferSize,me=X.initiatorType;le&&T_(me)&&(X=X.responseEnd,N+=le*(X<z?1:(z-re)/(X-re)))}if(--u,i+=8*(v+N)/(g.duration/1e3),r++,10<r)break}}if(0<r)return i/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var xm=null,Am=null;function gu(r){return r.nodeType===9?r:r.ownerDocument}function N_(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function R_(r,i){if(r===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&i==="foreignObject"?0:r}function Em(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Sm=null;function yN(){var r=window.event;return r&&r.type==="popstate"?r===Sm?!1:(Sm=r,!0):(Sm=null,!1)}var j_=typeof setTimeout=="function"?setTimeout:void 0,vN=typeof clearTimeout=="function"?clearTimeout:void 0,O_=typeof Promise=="function"?Promise:void 0,_N=typeof queueMicrotask=="function"?queueMicrotask:typeof O_<"u"?function(r){return O_.resolve(null).then(r).catch(bN)}:j_;function bN(r){setTimeout(function(){throw r})}function xs(r){return r==="head"}function I_(r,i){var o=i,u=0;do{var g=o.nextSibling;if(r.removeChild(o),g&&g.nodeType===8)if(o=g.data,o==="/$"||o==="/&"){if(u===0){r.removeChild(g),va(i);return}u--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")u++;else if(o==="html")Po(r.ownerDocument.documentElement);else if(o==="head"){o=r.ownerDocument.head,Po(o);for(var v=o.firstChild;v;){var N=v.nextSibling,z=v.nodeName;v[qs]||z==="SCRIPT"||z==="STYLE"||z==="LINK"&&v.rel.toLowerCase()==="stylesheet"||o.removeChild(v),v=N}}else o==="body"&&Po(r.ownerDocument.body);o=g}while(o);va(i)}function k_(r,i){var o=r;r=0;do{var u=o.nextSibling;if(o.nodeType===1?i?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(i?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),u&&u.nodeType===8)if(o=u.data,o==="/$"){if(r===0)break;r--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||r++;o=u}while(o)}function Cm(r){var i=r.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var o=i;switch(i=i.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Cm(o),ro(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}r.removeChild(o)}}function wN(r,i,o,u){for(;r.nodeType===1;){var g=o;if(r.nodeName.toLowerCase()!==i.toLowerCase()){if(!u&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(u){if(!r[qs])switch(i){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(v=r.getAttribute("rel"),v==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(v!==g.rel||r.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||r.getAttribute("title")!==(g.title==null?null:g.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(v=r.getAttribute("src"),(v!==(g.src==null?null:g.src)||r.getAttribute("type")!==(g.type==null?null:g.type)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&v&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(i==="input"&&r.type==="hidden"){var v=g.name==null?null:""+g.name;if(g.type==="hidden"&&r.getAttribute("name")===v)return r}else return r;if(r=zn(r.nextSibling),r===null)break}return null}function xN(r,i,o){if(i==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=zn(r.nextSibling),r===null))return null;return r}function M_(r,i){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!i||(r=zn(r.nextSibling),r===null))return null;return r}function Tm(r){return r.data==="$?"||r.data==="$~"}function Nm(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function AN(r,i){var o=r.ownerDocument;if(r.data==="$~")r._reactRetry=i;else if(r.data!=="$?"||o.readyState!=="loading")i();else{var u=function(){i(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),r._reactRetry=u}}function zn(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return r}var Rm=null;function D_(r){r=r.nextSibling;for(var i=0;r;){if(r.nodeType===8){var o=r.data;if(o==="/$"||o==="/&"){if(i===0)return zn(r.nextSibling);i--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||i++}r=r.nextSibling}return null}function B_(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var o=r.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(i===0)return r;i--}else o!=="/$"&&o!=="/&"||i++}r=r.previousSibling}return null}function U_(r,i,o){switch(i=gu(o),r){case"html":if(r=i.documentElement,!r)throw Error(s(452));return r;case"head":if(r=i.head,!r)throw Error(s(453));return r;case"body":if(r=i.body,!r)throw Error(s(454));return r;default:throw Error(s(451))}}function Po(r){for(var i=r.attributes;i.length;)r.removeAttributeNode(i[0]);ro(r)}var Pn=new Map,L_=new Set;function yu(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var zr=U.d;U.d={f:EN,r:SN,D:CN,C:TN,L:NN,m:RN,X:ON,S:jN,M:IN};function EN(){var r=zr.f(),i=lu();return r||i}function SN(r){var i=ts(r);i!==null&&i.tag===5&&i.type==="form"?tv(i):zr.r(r)}var pa=typeof document>"u"?null:document;function $_(r,i,o){var u=pa;if(u&&typeof i=="string"&&i){var g=Xt(i);g='link[rel="'+r+'"][href="'+g+'"]',typeof o=="string"&&(g+='[crossorigin="'+o+'"]'),L_.has(g)||(L_.add(g),r={rel:r,crossOrigin:o,href:i},u.querySelector(g)===null&&(i=u.createElement("link"),qt(i,"link",r),At(i),u.head.appendChild(i)))}}function CN(r){zr.D(r),$_("dns-prefetch",r,null)}function TN(r,i){zr.C(r,i),$_("preconnect",r,i)}function NN(r,i,o){zr.L(r,i,o);var u=pa;if(u&&r&&i){var g='link[rel="preload"][as="'+Xt(i)+'"]';i==="image"&&o&&o.imageSrcSet?(g+='[imagesrcset="'+Xt(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(g+='[imagesizes="'+Xt(o.imageSizes)+'"]')):g+='[href="'+Xt(r)+'"]';var v=g;switch(i){case"style":v=ga(r);break;case"script":v=ya(r)}Pn.has(v)||(r=m({rel:"preload",href:i==="image"&&o&&o.imageSrcSet?void 0:r,as:i},o),Pn.set(v,r),u.querySelector(g)!==null||i==="style"&&u.querySelector(Ho(v))||i==="script"&&u.querySelector(qo(v))||(i=u.createElement("link"),qt(i,"link",r),At(i),u.head.appendChild(i)))}}function RN(r,i){zr.m(r,i);var o=pa;if(o&&r){var u=i&&typeof i.as=="string"?i.as:"script",g='link[rel="modulepreload"][as="'+Xt(u)+'"][href="'+Xt(r)+'"]',v=g;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=ya(r)}if(!Pn.has(v)&&(r=m({rel:"modulepreload",href:r},i),Pn.set(v,r),o.querySelector(g)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(qo(v)))return}u=o.createElement("link"),qt(u,"link",r),At(u),o.head.appendChild(u)}}}function jN(r,i,o){zr.S(r,i,o);var u=pa;if(u&&r){var g=rs(u).hoistableStyles,v=ga(r);i=i||"default";var N=g.get(v);if(!N){var z={loading:0,preload:null};if(N=u.querySelector(Ho(v)))z.loading=5;else{r=m({rel:"stylesheet",href:r,"data-precedence":i},o),(o=Pn.get(v))&&jm(r,o);var X=N=u.createElement("link");At(X),qt(X,"link",r),X._p=new Promise(function(re,le){X.onload=re,X.onerror=le}),X.addEventListener("load",function(){z.loading|=1}),X.addEventListener("error",function(){z.loading|=2}),z.loading|=4,vu(N,i,u)}N={type:"stylesheet",instance:N,count:1,state:z},g.set(v,N)}}}function ON(r,i){zr.X(r,i);var o=pa;if(o&&r){var u=rs(o).hoistableScripts,g=ya(r),v=u.get(g);v||(v=o.querySelector(qo(g)),v||(r=m({src:r,async:!0},i),(i=Pn.get(g))&&Om(r,i),v=o.createElement("script"),At(v),qt(v,"link",r),o.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},u.set(g,v))}}function IN(r,i){zr.M(r,i);var o=pa;if(o&&r){var u=rs(o).hoistableScripts,g=ya(r),v=u.get(g);v||(v=o.querySelector(qo(g)),v||(r=m({src:r,async:!0,type:"module"},i),(i=Pn.get(g))&&Om(r,i),v=o.createElement("script"),At(v),qt(v,"link",r),o.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},u.set(g,v))}}function z_(r,i,o,u){var g=(g=ae.current)?yu(g):null;if(!g)throw Error(s(446));switch(r){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(i=ga(o.href),o=rs(g).hoistableStyles,u=o.get(i),u||(u={type:"style",instance:null,count:0,state:null},o.set(i,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){r=ga(o.href);var v=rs(g).hoistableStyles,N=v.get(r);if(N||(g=g.ownerDocument||g,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(r,N),(v=g.querySelector(Ho(r)))&&!v._p&&(N.instance=v,N.state.loading=5),Pn.has(r)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Pn.set(r,o),v||kN(g,r,o,N.state))),i&&u===null)throw Error(s(528,""));return N}if(i&&u!==null)throw Error(s(529,""));return null;case"script":return i=o.async,o=o.src,typeof o=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=ya(o),o=rs(g).hoistableScripts,u=o.get(i),u||(u={type:"script",instance:null,count:0,state:null},o.set(i,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,r))}}function ga(r){return'href="'+Xt(r)+'"'}function Ho(r){return'link[rel="stylesheet"]['+r+"]"}function P_(r){return m({},r,{"data-precedence":r.precedence,precedence:null})}function kN(r,i,o,u){r.querySelector('link[rel="preload"][as="style"]['+i+"]")?u.loading=1:(i=r.createElement("link"),u.preload=i,i.addEventListener("load",function(){return u.loading|=1}),i.addEventListener("error",function(){return u.loading|=2}),qt(i,"link",o),At(i),r.head.appendChild(i))}function ya(r){return'[src="'+Xt(r)+'"]'}function qo(r){return"script[async]"+r}function H_(r,i,o){if(i.count++,i.instance===null)switch(i.type){case"style":var u=r.querySelector('style[data-href~="'+Xt(o.href)+'"]');if(u)return i.instance=u,At(u),u;var g=m({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(r.ownerDocument||r).createElement("style"),At(u),qt(u,"style",g),vu(u,o.precedence,r),i.instance=u;case"stylesheet":g=ga(o.href);var v=r.querySelector(Ho(g));if(v)return i.state.loading|=4,i.instance=v,At(v),v;u=P_(o),(g=Pn.get(g))&&jm(u,g),v=(r.ownerDocument||r).createElement("link"),At(v);var N=v;return N._p=new Promise(function(z,X){N.onload=z,N.onerror=X}),qt(v,"link",u),i.state.loading|=4,vu(v,o.precedence,r),i.instance=v;case"script":return v=ya(o.src),(g=r.querySelector(qo(v)))?(i.instance=g,At(g),g):(u=o,(g=Pn.get(v))&&(u=m({},o),Om(u,g)),r=r.ownerDocument||r,g=r.createElement("script"),At(g),qt(g,"link",u),r.head.appendChild(g),i.instance=g);case"void":return null;default:throw Error(s(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(u=i.instance,i.state.loading|=4,vu(u,o.precedence,r));return i.instance}function vu(r,i,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=u.length?u[u.length-1]:null,v=g,N=0;N<u.length;N++){var z=u[N];if(z.dataset.precedence===i)v=z;else if(v!==g)break}v?v.parentNode.insertBefore(r,v.nextSibling):(i=o.nodeType===9?o.head:o,i.insertBefore(r,i.firstChild))}function jm(r,i){r.crossOrigin==null&&(r.crossOrigin=i.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=i.referrerPolicy),r.title==null&&(r.title=i.title)}function Om(r,i){r.crossOrigin==null&&(r.crossOrigin=i.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=i.referrerPolicy),r.integrity==null&&(r.integrity=i.integrity)}var _u=null;function q_(r,i,o){if(_u===null){var u=new Map,g=_u=new Map;g.set(o,u)}else g=_u,u=g.get(o),u||(u=new Map,g.set(o,u));if(u.has(r))return u;for(u.set(r,null),o=o.getElementsByTagName(r),g=0;g<o.length;g++){var v=o[g];if(!(v[qs]||v[It]||r==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var N=v.getAttribute(i)||"";N=r+N;var z=u.get(N);z?z.push(v):u.set(N,[v])}}return u}function Q_(r,i,o){r=r.ownerDocument||r,r.head.insertBefore(o,i==="title"?r.querySelector("head > title"):null)}function MN(r,i,o){if(o===1||i.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return r=i.disabled,typeof i.precedence=="string"&&r==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function F_(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function DN(r,i,o,u){if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=ga(u.href),v=i.querySelector(Ho(g));if(v){i=v._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(r.count++,r=bu.bind(r),i.then(r,r)),o.state.loading|=4,o.instance=v,At(v);return}v=i.ownerDocument||i,u=P_(u),(g=Pn.get(g))&&jm(u,g),v=v.createElement("link"),At(v);var N=v;N._p=new Promise(function(z,X){N.onload=z,N.onerror=X}),qt(v,"link",u),o.instance=v}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(r.count++,o=bu.bind(r),i.addEventListener("load",o),i.addEventListener("error",o))}}var Im=0;function BN(r,i){return r.stylesheets&&r.count===0&&xu(r,r.stylesheets),0<r.count||0<r.imgCount?function(o){var u=setTimeout(function(){if(r.stylesheets&&xu(r,r.stylesheets),r.unsuspend){var v=r.unsuspend;r.unsuspend=null,v()}},6e4+i);0<r.imgBytes&&Im===0&&(Im=62500*gN());var g=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&xu(r,r.stylesheets),r.unsuspend)){var v=r.unsuspend;r.unsuspend=null,v()}},(r.imgBytes>Im?50:800)+i);return r.unsuspend=o,function(){r.unsuspend=null,clearTimeout(u),clearTimeout(g)}}:null}function bu(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)xu(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var wu=null;function xu(r,i){r.stylesheets=null,r.unsuspend!==null&&(r.count++,wu=new Map,i.forEach(UN,r),wu=null,bu.call(r))}function UN(r,i){if(!(i.state.loading&4)){var o=wu.get(r);if(o)var u=o.get(null);else{o=new Map,wu.set(r,o);for(var g=r.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<g.length;v++){var N=g[v];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(o.set(N.dataset.precedence,N),u=N)}u&&o.set(null,u)}g=i.instance,N=g.getAttribute("data-precedence"),v=o.get(N)||u,v===u&&o.set(null,g),o.set(N,g),this.count++,u=bu.bind(this),g.addEventListener("load",u),g.addEventListener("error",u),v?v.parentNode.insertBefore(g,v.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(g,r.firstChild)),i.state.loading|=4}}var Qo={$$typeof:E,Provider:null,Consumer:null,_currentValue:B,_currentValue2:B,_threadCount:0};function LN(r,i,o,u,g,v,N,z,X){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=eo(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=eo(0),this.hiddenUpdates=eo(null),this.identifierPrefix=u,this.onUncaughtError=g,this.onCaughtError=v,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=X,this.incompleteTransitions=new Map}function V_(r,i,o,u,g,v,N,z,X,re,le,me){return r=new LN(r,i,o,N,X,re,le,me,z),i=1,v===!0&&(i|=24),v=vn(3,null,null,i),r.current=v,v.stateNode=r,i=dh(),i.refCount++,r.pooledCache=i,i.refCount++,v.memoizedState={element:u,isDehydrated:o,cache:i},ph(v),r}function G_(r){return r?(r=Yi,r):Yi}function Y_(r,i,o,u,g,v){g=G_(g),u.context===null?u.context=g:u.pendingContext=g,u=ds(i),u.payload={element:o},v=v===void 0?null:v,v!==null&&(u.callback=v),o=fs(r,u,i),o!==null&&(dn(o,r,i),xo(o,r,i))}function X_(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var o=r.retryLane;r.retryLane=o!==0&&o<i?o:i}}function km(r,i){X_(r,i),(r=r.alternate)&&X_(r,i)}function K_(r){if(r.tag===13||r.tag===31){var i=Gs(r,67108864);i!==null&&dn(i,r,67108864),km(r,67108864)}}function W_(r){if(r.tag===13||r.tag===31){var i=An();i=to(i);var o=Gs(r,i);o!==null&&dn(o,r,i),km(r,i)}}var Au=!0;function $N(r,i,o,u){var g=R.T;R.T=null;var v=U.p;try{U.p=2,Mm(r,i,o,u)}finally{U.p=v,R.T=g}}function zN(r,i,o,u){var g=R.T;R.T=null;var v=U.p;try{U.p=8,Mm(r,i,o,u)}finally{U.p=v,R.T=g}}function Mm(r,i,o,u){if(Au){var g=Dm(u);if(g===null)bm(r,i,u,Eu,o),Z_(r,u);else if(HN(g,r,i,o,u))u.stopPropagation();else if(Z_(r,u),i&4&&-1<PN.indexOf(r)){for(;g!==null;){var v=ts(g);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var N=wr(v.pendingLanes);if(N!==0){var z=v;for(z.pendingLanes|=2,z.entangledLanes|=2;N;){var X=1<<31-Zt(N);z.entanglements[1]|=X,N&=~X}dr(v),(Ze&6)===0&&(au=ft()+500,Lo(0))}}break;case 31:case 13:z=Gs(v,2),z!==null&&dn(z,v,2),lu(),km(v,2)}if(v=Dm(u),v===null&&bm(r,i,u,Eu,o),v===g)break;g=v}g!==null&&u.stopPropagation()}else bm(r,i,u,null,o)}}function Dm(r){return r=Uf(r),Bm(r)}var Eu=null;function Bm(r){if(Eu=null,r=es(r),r!==null){var i=l(r);if(i===null)r=null;else{var o=i.tag;if(o===13){if(r=c(i),r!==null)return r;r=null}else if(o===31){if(r=d(i),r!==null)return r;r=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null)}}return Eu=r,null}function J_(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(gn()){case kn:return 2;case nn:return 8;case rn:case br:return 32;case ge:return 268435456;default:return 32}default:return 32}}var Um=!1,As=null,Es=null,Ss=null,Fo=new Map,Vo=new Map,Cs=[],PN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Z_(r,i){switch(r){case"focusin":case"focusout":As=null;break;case"dragenter":case"dragleave":Es=null;break;case"mouseover":case"mouseout":Ss=null;break;case"pointerover":case"pointerout":Fo.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vo.delete(i.pointerId)}}function Go(r,i,o,u,g,v){return r===null||r.nativeEvent!==v?(r={blockedOn:i,domEventName:o,eventSystemFlags:u,nativeEvent:v,targetContainers:[g]},i!==null&&(i=ts(i),i!==null&&K_(i)),r):(r.eventSystemFlags|=u,i=r.targetContainers,g!==null&&i.indexOf(g)===-1&&i.push(g),r)}function HN(r,i,o,u,g){switch(i){case"focusin":return As=Go(As,r,i,o,u,g),!0;case"dragenter":return Es=Go(Es,r,i,o,u,g),!0;case"mouseover":return Ss=Go(Ss,r,i,o,u,g),!0;case"pointerover":var v=g.pointerId;return Fo.set(v,Go(Fo.get(v)||null,r,i,o,u,g)),!0;case"gotpointercapture":return v=g.pointerId,Vo.set(v,Go(Vo.get(v)||null,r,i,o,u,g)),!0}return!1}function eb(r){var i=es(r.target);if(i!==null){var o=l(i);if(o!==null){if(i=o.tag,i===13){if(i=c(o),i!==null){r.blockedOn=i,fc(r.priority,function(){W_(o)});return}}else if(i===31){if(i=d(o),i!==null){r.blockedOn=i,fc(r.priority,function(){W_(o)});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){r.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Su(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var o=Dm(r.nativeEvent);if(o===null){o=r.nativeEvent;var u=new o.constructor(o.type,o);Bf=u,o.target.dispatchEvent(u),Bf=null}else return i=ts(o),i!==null&&K_(i),r.blockedOn=o,!1;i.shift()}return!0}function tb(r,i,o){Su(r)&&o.delete(i)}function qN(){Um=!1,As!==null&&Su(As)&&(As=null),Es!==null&&Su(Es)&&(Es=null),Ss!==null&&Su(Ss)&&(Ss=null),Fo.forEach(tb),Vo.forEach(tb)}function Cu(r,i){r.blockedOn===i&&(r.blockedOn=null,Um||(Um=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,qN)))}var Tu=null;function nb(r){Tu!==r&&(Tu=r,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Tu===r&&(Tu=null);for(var i=0;i<r.length;i+=3){var o=r[i],u=r[i+1],g=r[i+2];if(typeof u!="function"){if(Bm(u||o)===null)continue;break}var v=ts(o);v!==null&&(r.splice(i,3),i-=3,Dh(v,{pending:!0,data:g,method:o.method,action:u},u,g))}}))}function va(r){function i(X){return Cu(X,r)}As!==null&&Cu(As,r),Es!==null&&Cu(Es,r),Ss!==null&&Cu(Ss,r),Fo.forEach(i),Vo.forEach(i);for(var o=0;o<Cs.length;o++){var u=Cs[o];u.blockedOn===r&&(u.blockedOn=null)}for(;0<Cs.length&&(o=Cs[0],o.blockedOn===null);)eb(o),o.blockedOn===null&&Cs.shift();if(o=(r.ownerDocument||r).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var g=o[u],v=o[u+1],N=g[Yt]||null;if(typeof v=="function")N||nb(o);else if(N){var z=null;if(v&&v.hasAttribute("formAction")){if(g=v,N=v[Yt]||null)z=N.formAction;else if(Bm(g)!==null)continue}else z=N.action;typeof z=="function"?o[u+1]=z:(o.splice(u,3),u-=3),nb(o)}}}function rb(){function r(v){v.canIntercept&&v.info==="react-transition"&&v.intercept({handler:function(){return new Promise(function(N){return g=N})},focusReset:"manual",scroll:"manual"})}function i(){g!==null&&(g(),g=null),u||setTimeout(o,20)}function o(){if(!u&&!navigation.transition){var v=navigation.currentEntry;v&&v.url!=null&&navigation.navigate(v.url,{state:v.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,g=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(o,100),function(){u=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),g!==null&&(g(),g=null)}}}function Lm(r){this._internalRoot=r}Nu.prototype.render=Lm.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(s(409));var o=i.current,u=An();Y_(o,u,r,i,null,null)},Nu.prototype.unmount=Lm.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;Y_(r.current,2,null,r,null,null),lu(),i[xr]=null}};function Nu(r){this._internalRoot=r}Nu.prototype.unstable_scheduleHydration=function(r){if(r){var i=dc();r={blockedOn:null,target:r,priority:i};for(var o=0;o<Cs.length&&i!==0&&i<Cs[o].priority;o++);Cs.splice(o,0,r),o===0&&eb(r)}};var sb=e.version;if(sb!=="19.2.0")throw Error(s(527,sb,"19.2.0"));U.findDOMNode=function(r){var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(s(188)):(r=Object.keys(r).join(","),Error(s(268,r)));return r=f(i),r=r!==null?p(r):null,r=r===null?null:r.stateNode,r};var QN={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:R,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ru.isDisabled&&Ru.supportsFiber)try{Ke=Ru.inject(QN),tt=Ru}catch{}}return Xo.createRoot=function(r,i){if(!a(r))throw Error(s(299));var o=!1,u="",g=dv,v=fv,N=hv;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(u=i.identifierPrefix),i.onUncaughtError!==void 0&&(g=i.onUncaughtError),i.onCaughtError!==void 0&&(v=i.onCaughtError),i.onRecoverableError!==void 0&&(N=i.onRecoverableError)),i=V_(r,1,!1,null,null,o,u,null,g,v,N,rb),r[xr]=i.current,_m(r),new Lm(i)},Xo.hydrateRoot=function(r,i,o){if(!a(r))throw Error(s(299));var u=!1,g="",v=dv,N=fv,z=hv,X=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onUncaughtError!==void 0&&(v=o.onUncaughtError),o.onCaughtError!==void 0&&(N=o.onCaughtError),o.onRecoverableError!==void 0&&(z=o.onRecoverableError),o.formState!==void 0&&(X=o.formState)),i=V_(r,1,!0,i,o??null,u,g,X,v,N,z,rb),i.context=G_(null),o=i.current,u=An(),u=to(u),g=ds(u),g.callback=null,fs(o,g,u),o=u,i.current.lanes=o,Hs(i,o),dr(i),r[xr]=i.current,_m(r),new Nu(i)},Xo.version="19.2.0",Xo}var mb;function tR(){if(mb)return Pm.exports;mb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Pm.exports=eR(),Pm.exports}var nR=tR();var pb="popstate";function rR(t={}){function e(s,a){let{pathname:l,search:c,hash:d}=s.location;return Cp("",{pathname:l,search:c,hash:d},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(s,a){return typeof a=="string"?a:Rl(a)}return iR(e,n,null,t)}function yt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function yr(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function sR(){return Math.random().toString(36).substring(2,10)}function gb(t,e){return{usr:t.state,key:t.key,idx:e}}function Cp(t,e,n=null,s){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Ya(e):e,state:n,key:e&&e.key||s||sR()}}function Rl({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Ya(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substring(s),t=t.substring(0,s)),t&&(e.pathname=t)}return e}function iR(t,e,n,s={}){let{window:a=document.defaultView,v5Compat:l=!1}=s,c=a.history,d="POP",h=null,f=p();f==null&&(f=0,c.replaceState({...c.state,idx:f},""));function p(){return(c.state||{idx:null}).idx}function m(){d="POP";let A=p(),S=A==null?null:A-f;f=A,h&&h({action:d,location:w.location,delta:S})}function y(A,S){d="PUSH";let T=Cp(w.location,A,S);f=p()+1;let E=gb(T,f),C=w.createHref(T);try{c.pushState(E,"",C)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;a.location.assign(C)}l&&h&&h({action:d,location:w.location,delta:1})}function _(A,S){d="REPLACE";let T=Cp(w.location,A,S);f=p();let E=gb(T,f),C=w.createHref(T);c.replaceState(E,"",C),l&&h&&h({action:d,location:w.location,delta:0})}function x(A){return aR(A)}let w={get action(){return d},get location(){return t(a,c)},listen(A){if(h)throw new Error("A history only accepts one active listener");return a.addEventListener(pb,m),h=A,()=>{a.removeEventListener(pb,m),h=null}},createHref(A){return e(a,A)},createURL:x,encodeLocation(A){let S=x(A);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:y,replace:_,go(A){return c.go(A)}};return w}function aR(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),yt(n,"No window.location.(origin|href) available to create URL");let s=typeof t=="string"?t:Rl(t);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=n+s),new URL(s,n)}function Jx(t,e,n="/"){return oR(t,e,n,!1)}function oR(t,e,n,s){let a=typeof e=="string"?Ya(e):e,l=Xr(a.pathname||"/",n);if(l==null)return null;let c=Zx(t);lR(c);let d=null;for(let h=0;d==null&&h<c.length;++h){let f=_R(l);d=yR(c[h],f,s)}return d}function Zx(t,e=[],n=[],s="",a=!1){let l=(c,d,h=a,f)=>{let p={relativePath:f===void 0?c.path||"":f,caseSensitive:c.caseSensitive===!0,childrenIndex:d,route:c};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(s)&&h)return;yt(p.relativePath.startsWith(s),`Absolute route path "${p.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(s.length)}let m=Yr([s,p.relativePath]),y=n.concat(p);c.children&&c.children.length>0&&(yt(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),Zx(c.children,e,y,m,h)),!(c.path==null&&!c.index)&&e.push({path:m,score:pR(m,c.index),routesMeta:y})};return t.forEach((c,d)=>{if(c.path===""||!c.path?.includes("?"))l(c,d);else for(let h of eA(c.path))l(c,d,!0,h)}),e}function eA(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,a=n.endsWith("?"),l=n.replace(/\?$/,"");if(s.length===0)return a?[l,""]:[l];let c=eA(s.join("/")),d=[];return d.push(...c.map(h=>h===""?l:[l,h].join("/"))),a&&d.push(...c),d.map(h=>t.startsWith("/")&&h===""?"/":h)}function lR(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:gR(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}var cR=/^:[\w-]+$/,uR=3,dR=2,fR=1,hR=10,mR=-2,yb=t=>t==="*";function pR(t,e){let n=t.split("/"),s=n.length;return n.some(yb)&&(s+=mR),e&&(s+=dR),n.filter(a=>!yb(a)).reduce((a,l)=>a+(cR.test(l)?uR:l===""?fR:hR),s)}function gR(t,e){return t.length===e.length&&t.slice(0,-1).every((s,a)=>s===e[a])?t[t.length-1]-e[e.length-1]:0}function yR(t,e,n=!1){let{routesMeta:s}=t,a={},l="/",c=[];for(let d=0;d<s.length;++d){let h=s[d],f=d===s.length-1,p=l==="/"?e:e.slice(l.length)||"/",m=Ad({path:h.relativePath,caseSensitive:h.caseSensitive,end:f},p),y=h.route;if(!m&&f&&n&&!s[s.length-1].route.index&&(m=Ad({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},p)),!m)return null;Object.assign(a,m.params),c.push({params:a,pathname:Yr([l,m.pathname]),pathnameBase:AR(Yr([l,m.pathnameBase])),route:y}),m.pathnameBase!=="/"&&(l=Yr([l,m.pathnameBase]))}return c}function Ad(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=vR(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let l=a[0],c=l.replace(/(.)\/+$/,"$1"),d=a.slice(1);return{params:s.reduce((f,{paramName:p,isOptional:m},y)=>{if(p==="*"){let x=d[y]||"";c=l.slice(0,l.length-x.length).replace(/(.)\/+$/,"$1")}const _=d[y];return m&&!_?f[p]=void 0:f[p]=(_||"").replace(/%2F/g,"/"),f},{}),pathname:l,pathnameBase:c,pattern:t}}function vR(t,e=!1,n=!0){yr(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let s=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,d,h)=>(s.push({paramName:d,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(s.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),s]}function _R(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return yr(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Xr(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function bR(t,e="/"){let{pathname:n,search:s="",hash:a=""}=typeof t=="string"?Ya(t):t;return{pathname:n?n.startsWith("/")?n:wR(n,e):e,search:ER(s),hash:SR(a)}}function wR(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function Fm(t,e,n,s){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function xR(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function tA(t){let e=xR(t);return e.map((n,s)=>s===e.length-1?n.pathname:n.pathnameBase)}function nA(t,e,n,s=!1){let a;typeof t=="string"?a=Ya(t):(a={...t},yt(!a.pathname||!a.pathname.includes("?"),Fm("?","pathname","search",a)),yt(!a.pathname||!a.pathname.includes("#"),Fm("#","pathname","hash",a)),yt(!a.search||!a.search.includes("#"),Fm("#","search","hash",a)));let l=t===""||a.pathname==="",c=l?"/":a.pathname,d;if(c==null)d=n;else{let m=e.length-1;if(!s&&c.startsWith("..")){let y=c.split("/");for(;y[0]==="..";)y.shift(),m-=1;a.pathname=y.join("/")}d=m>=0?e[m]:"/"}let h=bR(a,d),f=c&&c!=="/"&&c.endsWith("/"),p=(l||c===".")&&n.endsWith("/");return!h.pathname.endsWith("/")&&(f||p)&&(h.pathname+="/"),h}var Yr=t=>t.join("/").replace(/\/\/+/g,"/"),AR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),ER=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,SR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function CR(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var rA=["POST","PUT","PATCH","DELETE"];new Set(rA);var TR=["GET",...rA];new Set(TR);var Xa=k.createContext(null);Xa.displayName="DataRouter";var Kd=k.createContext(null);Kd.displayName="DataRouterState";k.createContext(!1);var sA=k.createContext({isTransitioning:!1});sA.displayName="ViewTransition";var NR=k.createContext(new Map);NR.displayName="Fetchers";var RR=k.createContext(null);RR.displayName="Await";var vr=k.createContext(null);vr.displayName="Navigation";var Gl=k.createContext(null);Gl.displayName="Location";var Jr=k.createContext({outlet:null,matches:[],isDataRoute:!1});Jr.displayName="Route";var yg=k.createContext(null);yg.displayName="RouteError";function jR(t,{relative:e}={}){yt(Yl(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:s}=k.useContext(vr),{hash:a,pathname:l,search:c}=Xl(t,{relative:e}),d=l;return n!=="/"&&(d=l==="/"?n:Yr([n,l])),s.createHref({pathname:d,search:c,hash:a})}function Yl(){return k.useContext(Gl)!=null}function Ti(){return yt(Yl(),"useLocation() may be used only in the context of a <Router> component."),k.useContext(Gl).location}var iA="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function aA(t){k.useContext(vr).static||k.useLayoutEffect(t)}function Ls(){let{isDataRoute:t}=k.useContext(Jr);return t?qR():OR()}function OR(){yt(Yl(),"useNavigate() may be used only in the context of a <Router> component.");let t=k.useContext(Xa),{basename:e,navigator:n}=k.useContext(vr),{matches:s}=k.useContext(Jr),{pathname:a}=Ti(),l=JSON.stringify(tA(s)),c=k.useRef(!1);return aA(()=>{c.current=!0}),k.useCallback((h,f={})=>{if(yr(c.current,iA),!c.current)return;if(typeof h=="number"){n.go(h);return}let p=nA(h,JSON.parse(l),a,f.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Yr([e,p.pathname])),(f.replace?n.replace:n.push)(p,f.state,f)},[e,n,l,a,t])}k.createContext(null);function Xl(t,{relative:e}={}){let{matches:n}=k.useContext(Jr),{pathname:s}=Ti(),a=JSON.stringify(tA(n));return k.useMemo(()=>nA(t,JSON.parse(a),s,e==="path"),[t,a,s,e])}function IR(t,e){return oA(t,e)}function oA(t,e,n,s,a){yt(Yl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=k.useContext(vr),{matches:c}=k.useContext(Jr),d=c[c.length-1],h=d?d.params:{},f=d?d.pathname:"/",p=d?d.pathnameBase:"/",m=d&&d.route;{let T=m&&m.path||"";lA(f,!m||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let y=Ti(),_;if(e){let T=typeof e=="string"?Ya(e):e;yt(p==="/"||T.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${T.pathname}" was given in the \`location\` prop.`),_=T}else _=y;let x=_.pathname||"/",w=x;if(p!=="/"){let T=p.replace(/^\//,"").split("/");w="/"+x.replace(/^\//,"").split("/").slice(T.length).join("/")}let A=Jx(t,{pathname:w});yr(m||A!=null,`No routes matched location "${_.pathname}${_.search}${_.hash}" `),yr(A==null||A[A.length-1].route.element!==void 0||A[A.length-1].route.Component!==void 0||A[A.length-1].route.lazy!==void 0,`Matched leaf route at location "${_.pathname}${_.search}${_.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let S=UR(A&&A.map(T=>Object.assign({},T,{params:Object.assign({},h,T.params),pathname:Yr([p,l.encodeLocation?l.encodeLocation(T.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?p:Yr([p,l.encodeLocation?l.encodeLocation(T.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathnameBase])})),c,n,s,a);return e&&S?k.createElement(Gl.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",..._},navigationType:"POP"}},S):S}function kR(){let t=HR(),e=CR(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:s},l={padding:"2px 4px",backgroundColor:s},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=k.createElement(k.Fragment,null,k.createElement("p",null," Hey developer "),k.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",k.createElement("code",{style:l},"ErrorBoundary")," or"," ",k.createElement("code",{style:l},"errorElement")," prop on your route.")),k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},e),n?k.createElement("pre",{style:a},n):null,c)}var MR=k.createElement(kR,null),DR=class extends k.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.unstable_onError?this.props.unstable_onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?k.createElement(Jr.Provider,{value:this.props.routeContext},k.createElement(yg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function BR({routeContext:t,match:e,children:n}){let s=k.useContext(Xa);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),k.createElement(Jr.Provider,{value:t},n)}function UR(t,e=[],n=null,s=null,a=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,c=n?.errors;if(c!=null){let f=l.findIndex(p=>p.route.id&&c?.[p.route.id]!==void 0);yt(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,f+1))}let d=!1,h=-1;if(n)for(let f=0;f<l.length;f++){let p=l[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(h=f),p.route.id){let{loaderData:m,errors:y}=n,_=p.route.loader&&!m.hasOwnProperty(p.route.id)&&(!y||y[p.route.id]===void 0);if(p.route.lazy||_){d=!0,h>=0?l=l.slice(0,h+1):l=[l[0]];break}}}return l.reduceRight((f,p,m)=>{let y,_=!1,x=null,w=null;n&&(y=c&&p.route.id?c[p.route.id]:void 0,x=p.route.errorElement||MR,d&&(h<0&&m===0?(lA("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,w=null):h===m&&(_=!0,w=p.route.hydrateFallbackElement||null)));let A=e.concat(l.slice(0,m+1)),S=()=>{let T;return y?T=x:_?T=w:p.route.Component?T=k.createElement(p.route.Component,null):p.route.element?T=p.route.element:T=f,k.createElement(BR,{match:p,routeContext:{outlet:f,matches:A,isDataRoute:n!=null},children:T})};return n&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?k.createElement(DR,{location:n.location,revalidation:n.revalidation,component:x,error:y,children:S(),routeContext:{outlet:null,matches:A,isDataRoute:!0},unstable_onError:s}):S()},null)}function vg(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function LR(t){let e=k.useContext(Xa);return yt(e,vg(t)),e}function $R(t){let e=k.useContext(Kd);return yt(e,vg(t)),e}function zR(t){let e=k.useContext(Jr);return yt(e,vg(t)),e}function _g(t){let e=zR(t),n=e.matches[e.matches.length-1];return yt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function PR(){return _g("useRouteId")}function HR(){let t=k.useContext(yg),e=$R("useRouteError"),n=_g("useRouteError");return t!==void 0?t:e.errors?.[n]}function qR(){let{router:t}=LR("useNavigate"),e=_g("useNavigate"),n=k.useRef(!1);return aA(()=>{n.current=!0}),k.useCallback(async(a,l={})=>{yr(n.current,iA),n.current&&(typeof a=="number"?t.navigate(a):await t.navigate(a,{fromRouteId:e,...l}))},[t,e])}var vb={};function lA(t,e,n){!e&&!vb[t]&&(vb[t]=!0,yr(!1,n))}k.memo(QR);function QR({routes:t,future:e,state:n,unstable_onError:s}){return oA(t,void 0,n,s,e)}function Ms(t){yt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function FR({basename:t="/",children:e=null,location:n,navigationType:s="POP",navigator:a,static:l=!1}){yt(!Yl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),d=k.useMemo(()=>({basename:c,navigator:a,static:l,future:{}}),[c,a,l]);typeof n=="string"&&(n=Ya(n));let{pathname:h="/",search:f="",hash:p="",state:m=null,key:y="default"}=n,_=k.useMemo(()=>{let x=Xr(h,c);return x==null?null:{location:{pathname:x,search:f,hash:p,state:m,key:y},navigationType:s}},[c,h,f,p,m,y,s]);return yr(_!=null,`<Router basename="${c}"> is not able to match the URL "${h}${f}${p}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:k.createElement(vr.Provider,{value:d},k.createElement(Gl.Provider,{children:e,value:_}))}function VR({children:t,location:e}){return IR(Tp(t),e)}function Tp(t,e=[]){let n=[];return k.Children.forEach(t,(s,a)=>{if(!k.isValidElement(s))return;let l=[...e,a];if(s.type===k.Fragment){n.push.apply(n,Tp(s.props.children,l));return}yt(s.type===Ms,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),yt(!s.props.index||!s.props.children,"An index route cannot have child routes.");let c={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(c.children=Tp(s.props.children,l)),n.push(c)}),n}var ad="get",od="application/x-www-form-urlencoded";function Wd(t){return t!=null&&typeof t.tagName=="string"}function GR(t){return Wd(t)&&t.tagName.toLowerCase()==="button"}function YR(t){return Wd(t)&&t.tagName.toLowerCase()==="form"}function XR(t){return Wd(t)&&t.tagName.toLowerCase()==="input"}function KR(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function WR(t,e){return t.button===0&&(!e||e==="_self")&&!KR(t)}var ju=null;function JR(){if(ju===null)try{new FormData(document.createElement("form"),0),ju=!1}catch{ju=!0}return ju}var ZR=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Vm(t){return t!=null&&!ZR.has(t)?(yr(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${od}"`),null):t}function ej(t,e){let n,s,a,l,c;if(YR(t)){let d=t.getAttribute("action");s=d?Xr(d,e):null,n=t.getAttribute("method")||ad,a=Vm(t.getAttribute("enctype"))||od,l=new FormData(t)}else if(GR(t)||XR(t)&&(t.type==="submit"||t.type==="image")){let d=t.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=t.getAttribute("formaction")||d.getAttribute("action");if(s=h?Xr(h,e):null,n=t.getAttribute("formmethod")||d.getAttribute("method")||ad,a=Vm(t.getAttribute("formenctype"))||Vm(d.getAttribute("enctype"))||od,l=new FormData(d,t),!JR()){let{name:f,type:p,value:m}=t;if(p==="image"){let y=f?`${f}.`:"";l.append(`${y}x`,"0"),l.append(`${y}y`,"0")}else f&&l.append(f,m)}}else{if(Wd(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=ad,s=null,a=od,c=t}return l&&a==="text/plain"&&(c=l,l=void 0),{action:s,method:n.toLowerCase(),encType:a,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function bg(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function tj(t,e,n){let s=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return s.pathname==="/"?s.pathname=`_root.${n}`:e&&Xr(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${n}`,s}async function nj(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function rj(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function sj(t,e,n){let s=await Promise.all(t.map(async a=>{let l=e.routes[a.route.id];if(l){let c=await nj(l,n);return c.links?c.links():[]}return[]}));return lj(s.flat(1).filter(rj).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function _b(t,e,n,s,a,l){let c=(h,f)=>n[f]?h.route.id!==n[f].route.id:!0,d=(h,f)=>n[f].pathname!==h.pathname||n[f].route.path?.endsWith("*")&&n[f].params["*"]!==h.params["*"];return l==="assets"?e.filter((h,f)=>c(h,f)||d(h,f)):l==="data"?e.filter((h,f)=>{let p=s.routes[h.route.id];if(!p||!p.hasLoader)return!1;if(c(h,f)||d(h,f))return!0;if(h.route.shouldRevalidate){let m=h.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function ij(t,e,{includeHydrateFallback:n}={}){return aj(t.map(s=>{let a=e.routes[s.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function aj(t){return[...new Set(t)]}function oj(t){let e={},n=Object.keys(t).sort();for(let s of n)e[s]=t[s];return e}function lj(t,e){let n=new Set;return new Set(e),t.reduce((s,a)=>{let l=JSON.stringify(oj(a));return n.has(l)||(n.add(l),s.push({key:l,link:a})),s},[])}function cA(){let t=k.useContext(Xa);return bg(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function cj(){let t=k.useContext(Kd);return bg(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var wg=k.createContext(void 0);wg.displayName="FrameworkContext";function uA(){let t=k.useContext(wg);return bg(t,"You must render this element inside a <HydratedRouter> element"),t}function uj(t,e){let n=k.useContext(wg),[s,a]=k.useState(!1),[l,c]=k.useState(!1),{onFocus:d,onBlur:h,onMouseEnter:f,onMouseLeave:p,onTouchStart:m}=e,y=k.useRef(null);k.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let w=S=>{S.forEach(T=>{c(T.isIntersecting)})},A=new IntersectionObserver(w,{threshold:.5});return y.current&&A.observe(y.current),()=>{A.disconnect()}}},[t]),k.useEffect(()=>{if(s){let w=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(w)}}},[s]);let _=()=>{a(!0)},x=()=>{a(!1),c(!1)};return n?t!=="intent"?[l,y,{}]:[l,y,{onFocus:Ko(d,_),onBlur:Ko(h,x),onMouseEnter:Ko(f,_),onMouseLeave:Ko(p,x),onTouchStart:Ko(m,_)}]:[!1,y,{}]}function Ko(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function dj({page:t,...e}){let{router:n}=cA(),s=k.useMemo(()=>Jx(n.routes,t,n.basename),[n.routes,t,n.basename]);return s?k.createElement(hj,{page:t,matches:s,...e}):null}function fj(t){let{manifest:e,routeModules:n}=uA(),[s,a]=k.useState([]);return k.useEffect(()=>{let l=!1;return sj(t,e,n).then(c=>{l||a(c)}),()=>{l=!0}},[t,e,n]),s}function hj({page:t,matches:e,...n}){let s=Ti(),{manifest:a,routeModules:l}=uA(),{basename:c}=cA(),{loaderData:d,matches:h}=cj(),f=k.useMemo(()=>_b(t,e,h,a,s,"data"),[t,e,h,a,s]),p=k.useMemo(()=>_b(t,e,h,a,s,"assets"),[t,e,h,a,s]),m=k.useMemo(()=>{if(t===s.pathname+s.search+s.hash)return[];let x=new Set,w=!1;if(e.forEach(S=>{let T=a.routes[S.route.id];!T||!T.hasLoader||(!f.some(E=>E.route.id===S.route.id)&&S.route.id in d&&l[S.route.id]?.shouldRevalidate||T.hasClientLoader?w=!0:x.add(S.route.id))}),x.size===0)return[];let A=tj(t,c,"data");return w&&x.size>0&&A.searchParams.set("_routes",e.filter(S=>x.has(S.route.id)).map(S=>S.route.id).join(",")),[A.pathname+A.search]},[c,d,s,a,f,e,t,l]),y=k.useMemo(()=>ij(p,a),[p,a]),_=fj(p);return k.createElement(k.Fragment,null,m.map(x=>k.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...n})),y.map(x=>k.createElement("link",{key:x,rel:"modulepreload",href:x,...n})),_.map(({key:x,link:w})=>k.createElement("link",{key:x,nonce:n.nonce,...w})))}function mj(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var dA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{dA&&(window.__reactRouterVersion="7.9.5")}catch{}function pj({basename:t,children:e,window:n}){let s=k.useRef();s.current==null&&(s.current=rR({window:n,v5Compat:!0}));let a=s.current,[l,c]=k.useState({action:a.action,location:a.location}),d=k.useCallback(h=>{k.startTransition(()=>c(h))},[c]);return k.useLayoutEffect(()=>a.listen(d),[a,d]),k.createElement(FR,{basename:t,children:e,location:l.location,navigationType:l.action,navigator:a})}var fA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,bi=k.forwardRef(function({onClick:e,discover:n="render",prefetch:s="none",relative:a,reloadDocument:l,replace:c,state:d,target:h,to:f,preventScrollReset:p,viewTransition:m,...y},_){let{basename:x}=k.useContext(vr),w=typeof f=="string"&&fA.test(f),A,S=!1;if(typeof f=="string"&&w&&(A=f,dA))try{let q=new URL(window.location.href),G=f.startsWith("//")?new URL(q.protocol+f):new URL(f),V=Xr(G.pathname,x);G.origin===q.origin&&V!=null?f=V+G.search+G.hash:S=!0}catch{yr(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let T=jR(f,{relative:a}),[E,C,j]=uj(s,y),O=_j(f,{replace:c,state:d,target:h,preventScrollReset:p,relative:a,viewTransition:m});function M(q){e&&e(q),q.defaultPrevented||O(q)}let D=k.createElement("a",{...y,...j,href:A||T,onClick:S||l?e:M,ref:mj(_,C),target:h,"data-discover":!w&&n==="render"?"true":void 0});return E&&!w?k.createElement(k.Fragment,null,D,k.createElement(dj,{page:T})):D});bi.displayName="Link";var gj=k.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:s="",end:a=!1,style:l,to:c,viewTransition:d,children:h,...f},p){let m=Xl(c,{relative:f.relative}),y=Ti(),_=k.useContext(Kd),{navigator:x,basename:w}=k.useContext(vr),A=_!=null&&Ej(m)&&d===!0,S=x.encodeLocation?x.encodeLocation(m).pathname:m.pathname,T=y.pathname,E=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;n||(T=T.toLowerCase(),E=E?E.toLowerCase():null,S=S.toLowerCase()),E&&w&&(E=Xr(E,w)||E);const C=S!=="/"&&S.endsWith("/")?S.length-1:S.length;let j=T===S||!a&&T.startsWith(S)&&T.charAt(C)==="/",O=E!=null&&(E===S||!a&&E.startsWith(S)&&E.charAt(S.length)==="/"),M={isActive:j,isPending:O,isTransitioning:A},D=j?e:void 0,q;typeof s=="function"?q=s(M):q=[s,j?"active":null,O?"pending":null,A?"transitioning":null].filter(Boolean).join(" ");let G=typeof l=="function"?l(M):l;return k.createElement(bi,{...f,"aria-current":D,className:q,ref:p,style:G,to:c,viewTransition:d},typeof h=="function"?h(M):h)});gj.displayName="NavLink";var yj=k.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:s,replace:a,state:l,method:c=ad,action:d,onSubmit:h,relative:f,preventScrollReset:p,viewTransition:m,...y},_)=>{let x=xj(),w=Aj(d,{relative:f}),A=c.toLowerCase()==="get"?"get":"post",S=typeof d=="string"&&fA.test(d),T=E=>{if(h&&h(E),E.defaultPrevented)return;E.preventDefault();let C=E.nativeEvent.submitter,j=C?.getAttribute("formmethod")||c;x(C||E.currentTarget,{fetcherKey:e,method:j,navigate:n,replace:a,state:l,relative:f,preventScrollReset:p,viewTransition:m})};return k.createElement("form",{ref:_,method:A,action:w,onSubmit:s?h:T,...y,"data-discover":!S&&t==="render"?"true":void 0})});yj.displayName="Form";function vj(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function hA(t){let e=k.useContext(Xa);return yt(e,vj(t)),e}function _j(t,{target:e,replace:n,state:s,preventScrollReset:a,relative:l,viewTransition:c}={}){let d=Ls(),h=Ti(),f=Xl(t,{relative:l});return k.useCallback(p=>{if(WR(p,e)){p.preventDefault();let m=n!==void 0?n:Rl(h)===Rl(f);d(t,{replace:m,state:s,preventScrollReset:a,relative:l,viewTransition:c})}},[h,d,f,n,s,e,t,a,l,c])}var bj=0,wj=()=>`__${String(++bj)}__`;function xj(){let{router:t}=hA("useSubmit"),{basename:e}=k.useContext(vr),n=PR();return k.useCallback(async(s,a={})=>{let{action:l,method:c,encType:d,formData:h,body:f}=ej(s,e);if(a.navigate===!1){let p=a.fetcherKey||wj();await t.fetch(p,n,a.action||l,{preventScrollReset:a.preventScrollReset,formData:h,body:f,formMethod:a.method||c,formEncType:a.encType||d,flushSync:a.flushSync})}else await t.navigate(a.action||l,{preventScrollReset:a.preventScrollReset,formData:h,body:f,formMethod:a.method||c,formEncType:a.encType||d,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,e,n])}function Aj(t,{relative:e}={}){let{basename:n}=k.useContext(vr),s=k.useContext(Jr);yt(s,"useFormAction must be used inside a RouteContext");let[a]=s.matches.slice(-1),l={...Xl(t||".",{relative:e})},c=Ti();if(t==null){l.search=c.search;let d=new URLSearchParams(l.search),h=d.getAll("index");if(h.some(p=>p==="")){d.delete("index"),h.filter(m=>m).forEach(m=>d.append("index",m));let p=d.toString();l.search=p?`?${p}`:""}}return(!t||t===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(l.pathname=l.pathname==="/"?n:Yr([n,l.pathname])),Rl(l)}function Ej(t,{relative:e}={}){let n=k.useContext(sA);yt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=hA("useViewTransitionState"),a=Xl(t,{relative:e});if(!n.isTransitioning)return!1;let l=Xr(n.currentLocation.pathname,s)||n.currentLocation.pathname,c=Xr(n.nextLocation.pathname,s)||n.nextLocation.pathname;return Ad(a.pathname,c)!=null||Ad(a.pathname,l)!=null}Wx();var Np=function(t,e){return Np=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(n[a]=s[a])},Np(t,e)};function mA(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Np(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Ed=function(){return Ed=Object.assign||function(e){for(var n,s=1,a=arguments.length;s<a;s++){n=arguments[s];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},Ed.apply(this,arguments)};function Ka(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a])&&(n[s[a]]=t[s[a]]);return n}function pA(t,e,n,s){var a=arguments.length,l=a<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,n):s,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(t,e,n,s);else for(var d=t.length-1;d>=0;d--)(c=t[d])&&(l=(a<3?c(l):a>3?c(e,n,l):c(e,n))||l);return a>3&&l&&Object.defineProperty(e,n,l),l}function gA(t,e){return function(n,s){e(n,s,t)}}function yA(t,e,n,s,a,l){function c(S){if(S!==void 0&&typeof S!="function")throw new TypeError("Function expected");return S}for(var d=s.kind,h=d==="getter"?"get":d==="setter"?"set":"value",f=!e&&t?s.static?t:t.prototype:null,p=e||(f?Object.getOwnPropertyDescriptor(f,s.name):{}),m,y=!1,_=n.length-1;_>=0;_--){var x={};for(var w in s)x[w]=w==="access"?{}:s[w];for(var w in s.access)x.access[w]=s.access[w];x.addInitializer=function(S){if(y)throw new TypeError("Cannot add initializers after decoration has completed");l.push(c(S||null))};var A=(0,n[_])(d==="accessor"?{get:p.get,set:p.set}:p[h],x);if(d==="accessor"){if(A===void 0)continue;if(A===null||typeof A!="object")throw new TypeError("Object expected");(m=c(A.get))&&(p.get=m),(m=c(A.set))&&(p.set=m),(m=c(A.init))&&a.unshift(m)}else(m=c(A))&&(d==="field"?a.unshift(m):p[h]=m)}f&&Object.defineProperty(f,s.name,p),y=!0}function vA(t,e,n){for(var s=arguments.length>2,a=0;a<e.length;a++)n=s?e[a].call(t,n):e[a].call(t);return s?n:void 0}function _A(t){return typeof t=="symbol"?t:"".concat(t)}function bA(t,e,n){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:n?"".concat(n," ",e):e})}function wA(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Ce(t,e,n,s){function a(l){return l instanceof n?l:new n(function(c){c(l)})}return new(n||(n=Promise))(function(l,c){function d(p){try{f(s.next(p))}catch(m){c(m)}}function h(p){try{f(s.throw(p))}catch(m){c(m)}}function f(p){p.done?l(p.value):a(p.value).then(d,h)}f((s=s.apply(t,e||[])).next())})}function xA(t,e){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},s,a,l,c=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return c.next=d(0),c.throw=d(1),c.return=d(2),typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function d(f){return function(p){return h([f,p])}}function h(f){if(s)throw new TypeError("Generator is already executing.");for(;c&&(c=0,f[0]&&(n=0)),n;)try{if(s=1,a&&(l=f[0]&2?a.return:f[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,f[1])).done)return l;switch(a=0,l&&(f=[f[0]&2,l.value]),f[0]){case 0:case 1:l=f;break;case 4:return n.label++,{value:f[1],done:!1};case 5:n.label++,a=f[1],f=[0];continue;case 7:f=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(f[0]===6||f[0]===2)){n=0;continue}if(f[0]===3&&(!l||f[1]>l[0]&&f[1]<l[3])){n.label=f[1];break}if(f[0]===6&&n.label<l[1]){n.label=l[1],l=f;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(f);break}l[2]&&n.ops.pop(),n.trys.pop();continue}f=e.call(t,n)}catch(p){f=[6,p],a=0}finally{s=l=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}var Jd=Object.create?(function(t,e,n,s){s===void 0&&(s=n);var a=Object.getOwnPropertyDescriptor(e,n);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,s,a)}):(function(t,e,n,s){s===void 0&&(s=n),t[s]=e[n]});function AA(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&Jd(e,t,n)}function Sd(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],s=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&s>=t.length&&(t=void 0),{value:t&&t[s++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function xg(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var s=n.call(t),a,l=[],c;try{for(;(e===void 0||e-- >0)&&!(a=s.next()).done;)l.push(a.value)}catch(d){c={error:d}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(c)throw c.error}}return l}function EA(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(xg(arguments[e]));return t}function SA(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var s=Array(t),a=0,e=0;e<n;e++)for(var l=arguments[e],c=0,d=l.length;c<d;c++,a++)s[a]=l[c];return s}function CA(t,e,n){if(n||arguments.length===2)for(var s=0,a=e.length,l;s<a;s++)(l||!(s in e))&&(l||(l=Array.prototype.slice.call(e,0,s)),l[s]=e[s]);return t.concat(l||Array.prototype.slice.call(e))}function za(t){return this instanceof za?(this.v=t,this):new za(t)}function TA(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=n.apply(t,e||[]),a,l=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",c),a[Symbol.asyncIterator]=function(){return this},a;function c(_){return function(x){return Promise.resolve(x).then(_,m)}}function d(_,x){s[_]&&(a[_]=function(w){return new Promise(function(A,S){l.push([_,w,A,S])>1||h(_,w)})},x&&(a[_]=x(a[_])))}function h(_,x){try{f(s[_](x))}catch(w){y(l[0][3],w)}}function f(_){_.value instanceof za?Promise.resolve(_.value.v).then(p,m):y(l[0][2],_)}function p(_){h("next",_)}function m(_){h("throw",_)}function y(_,x){_(x),l.shift(),l.length&&h(l[0][0],l[0][1])}}function NA(t){var e,n;return e={},s("next"),s("throw",function(a){throw a}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(a,l){e[a]=t[a]?function(c){return(n=!n)?{value:za(t[a](c)),done:!1}:l?l(c):c}:l}}function RA(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Sd=="function"?Sd(t):t[Symbol.iterator](),n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n);function s(l){n[l]=t[l]&&function(c){return new Promise(function(d,h){c=t[l](c),a(d,h,c.done,c.value)})}}function a(l,c,d,h){Promise.resolve(h).then(function(f){l({value:f,done:d})},c)}}function jA(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var Sj=Object.create?(function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}):function(t,e){t.default=e},Rp=function(t){return Rp=Object.getOwnPropertyNames||function(e){var n=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(n[n.length]=s);return n},Rp(t)};function OA(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n=Rp(t),s=0;s<n.length;s++)n[s]!=="default"&&Jd(e,t,n[s]);return Sj(e,t),e}function IA(t){return t&&t.__esModule?t:{default:t}}function kA(t,e,n,s){if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?s:n==="a"?s.call(t):s?s.value:e.get(t)}function MA(t,e,n,s,a){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?a.call(t,n):a?a.value=n:e.set(t,n),n}function DA(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function BA(t,e,n){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var s,a;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=e[Symbol.asyncDispose]}if(s===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=e[Symbol.dispose],n&&(a=s)}if(typeof s!="function")throw new TypeError("Object not disposable.");a&&(s=function(){try{a.call(this)}catch(l){return Promise.reject(l)}}),t.stack.push({value:e,dispose:s,async:n})}else n&&t.stack.push({async:!0});return e}var Cj=typeof SuppressedError=="function"?SuppressedError:function(t,e,n){var s=new Error(n);return s.name="SuppressedError",s.error=t,s.suppressed=e,s};function UA(t){function e(l){t.error=t.hasError?new Cj(l,t.error,"An error was suppressed during disposal."):l,t.hasError=!0}var n,s=0;function a(){for(;n=t.stack.pop();)try{if(!n.async&&s===1)return s=0,t.stack.push(n),Promise.resolve().then(a);if(n.dispose){var l=n.dispose.call(n.value);if(n.async)return s|=2,Promise.resolve(l).then(a,function(c){return e(c),a()})}else s|=1}catch(c){e(c)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return a()}function LA(t,e){return typeof t=="string"&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(n,s,a,l,c){return s?e?".jsx":".js":a&&(!l||!c)?n:a+l+"."+c.toLowerCase()+"js"}):t}const Tj={__extends:mA,__assign:Ed,__rest:Ka,__decorate:pA,__param:gA,__esDecorate:yA,__runInitializers:vA,__propKey:_A,__setFunctionName:bA,__metadata:wA,__awaiter:Ce,__generator:xA,__createBinding:Jd,__exportStar:AA,__values:Sd,__read:xg,__spread:EA,__spreadArrays:SA,__spreadArray:CA,__await:za,__asyncGenerator:TA,__asyncDelegator:NA,__asyncValues:RA,__makeTemplateObject:jA,__importStar:OA,__importDefault:IA,__classPrivateFieldGet:kA,__classPrivateFieldSet:MA,__classPrivateFieldIn:DA,__addDisposableResource:BA,__disposeResources:UA,__rewriteRelativeImportExtension:LA},Nj=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:BA,get __assign(){return Ed},__asyncDelegator:NA,__asyncGenerator:TA,__asyncValues:RA,__await:za,__awaiter:Ce,__classPrivateFieldGet:kA,__classPrivateFieldIn:DA,__classPrivateFieldSet:MA,__createBinding:Jd,__decorate:pA,__disposeResources:UA,__esDecorate:yA,__exportStar:AA,__extends:mA,__generator:xA,__importDefault:IA,__importStar:OA,__makeTemplateObject:jA,__metadata:wA,__param:gA,__propKey:_A,__read:xg,__rest:Ka,__rewriteRelativeImportExtension:LA,__runInitializers:vA,__setFunctionName:bA,__spread:EA,__spreadArray:CA,__spreadArrays:SA,__values:Sd,default:Tj},Symbol.toStringTag,{value:"Module"})),Rj=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Ag extends Error{constructor(e,n="FunctionsError",s){super(e),this.name=n,this.context=s}}class bb extends Ag{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class wb extends Ag{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class xb extends Ag{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var jp;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(jp||(jp={}));class jj{constructor(e,{headers:n={},customFetch:s,region:a=jp.Any}={}){this.url=e,this.headers=n,this.region=a,this.fetch=Rj(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Ce(this,arguments,void 0,function*(n,s={}){var a;try{const{headers:l,method:c,body:d,signal:h}=s;let f={},{region:p}=s;p||(p=this.region);const m=new URL(`${this.url}/${n}`);p&&p!=="any"&&(f["x-region"]=p,m.searchParams.set("forceFunctionRegion",p));let y;d&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",y=d):typeof d=="string"?(f["Content-Type"]="text/plain",y=d):typeof FormData<"u"&&d instanceof FormData?y=d:(f["Content-Type"]="application/json",y=JSON.stringify(d)):y=d;const _=yield this.fetch(m.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),l),body:y,signal:h}).catch(S=>{throw S.name==="AbortError"?S:new bb(S)}),x=_.headers.get("x-relay-error");if(x&&x==="true")throw new wb(_);if(!_.ok)throw new xb(_);let w=((a=_.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),A;return w==="application/json"?A=yield _.json():w==="application/octet-stream"||w==="application/pdf"?A=yield _.blob():w==="text/event-stream"?A=_:w==="multipart/form-data"?A=yield _.formData():A=yield _.text(),{data:A,error:null,response:_}}catch(l){return l instanceof Error&&l.name==="AbortError"?{data:null,error:new bb(l)}:{data:null,error:l,response:l instanceof xb||l instanceof wb?l.context:void 0}}})}}var Wt={};const Wa=Kx(Nj);var Ou={},Iu={},ku={},Mu={},Du={},Bu={},Ab;function $A(){if(Ab)return Bu;Ab=1,Object.defineProperty(Bu,"__esModule",{value:!0});class t extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return Bu.default=t,Bu}var Eb;function zA(){if(Eb)return Du;Eb=1,Object.defineProperty(Du,"__esModule",{value:!0});const e=Wa.__importDefault($A());class n{constructor(a){var l,c;this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=new Headers(a.headers),this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=(l=a.shouldThrowOnError)!==null&&l!==void 0?l:!1,this.signal=a.signal,this.isMaybeSingle=(c=a.isMaybeSingle)!==null&&c!==void 0?c:!1,a.fetch?this.fetch=a.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,l){return this.headers=new Headers(this.headers),this.headers.set(a,l),this}then(a,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const c=this.fetch;let d=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async h=>{var f,p,m,y;let _=null,x=null,w=null,A=h.status,S=h.statusText;if(h.ok){if(this.method!=="HEAD"){const j=await h.text();j===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((f=this.headers.get("Accept"))===null||f===void 0)&&f.includes("application/vnd.pgrst.plan+text"))?x=j:x=JSON.parse(j))}const E=(p=this.headers.get("Prefer"))===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),C=(m=h.headers.get("content-range"))===null||m===void 0?void 0:m.split("/");E&&C&&C.length>1&&(w=parseInt(C[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(x)&&(x.length>1?(_={code:"PGRST116",details:`Results contain ${x.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},x=null,w=null,A=406,S="Not Acceptable"):x.length===1?x=x[0]:x=null)}else{const E=await h.text();try{_=JSON.parse(E),Array.isArray(_)&&h.status===404&&(x=[],_=null,A=200,S="OK")}catch{h.status===404&&E===""?(A=204,S="No Content"):_={message:E}}if(_&&this.isMaybeSingle&&(!((y=_?.details)===null||y===void 0)&&y.includes("0 rows"))&&(_=null,A=200,S="OK"),_&&this.shouldThrowOnError)throw new e.default(_)}return{error:_,data:x,count:w,status:A,statusText:S}});return this.shouldThrowOnError||(d=d.catch(h=>{var f,p,m;return{error:{message:`${(f=h?.name)!==null&&f!==void 0?f:"FetchError"}: ${h?.message}`,details:`${(p=h?.stack)!==null&&p!==void 0?p:""}`,hint:"",code:`${(m=h?.code)!==null&&m!==void 0?m:""}`},data:null,count:null,status:0,statusText:""}})),d.then(a,l)}returns(){return this}overrideTypes(){return this}}return Du.default=n,Du}var Sb;function PA(){if(Sb)return Mu;Sb=1,Object.defineProperty(Mu,"__esModule",{value:!0});const e=Wa.__importDefault(zA());class n extends e.default{select(a){let l=!1;const c=(a??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:l=!0,nullsFirst:c,foreignTable:d,referencedTable:h=d}={}){const f=h?`${h}.order`:"order",p=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${p?`${p},`:""}${a}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:l,referencedTable:c=l}={}){const d=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${a}`),this}range(a,l,{foreignTable:c,referencedTable:d=c}={}){const h=typeof d>"u"?"offset":`${d}.offset`,f=typeof d>"u"?"limit":`${d}.limit`;return this.url.searchParams.set(h,`${a}`),this.url.searchParams.set(f,`${l-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:l=!1,settings:c=!1,buffers:d=!1,wal:h=!1,format:f="text"}={}){var p;const m=[a?"analyze":null,l?"verbose":null,c?"settings":null,d?"buffers":null,h?"wal":null].filter(Boolean).join("|"),y=(p=this.headers.get("Accept"))!==null&&p!==void 0?p:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${f}; for="${y}"; options=${m};`),f==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}}return Mu.default=n,Mu}var Cb;function Eg(){if(Cb)return ku;Cb=1,Object.defineProperty(ku,"__esModule",{value:!0});const e=Wa.__importDefault(PA()),n=new RegExp("[,()]");class s extends e.default{eq(l,c){return this.url.searchParams.append(l,`eq.${c}`),this}neq(l,c){return this.url.searchParams.append(l,`neq.${c}`),this}gt(l,c){return this.url.searchParams.append(l,`gt.${c}`),this}gte(l,c){return this.url.searchParams.append(l,`gte.${c}`),this}lt(l,c){return this.url.searchParams.append(l,`lt.${c}`),this}lte(l,c){return this.url.searchParams.append(l,`lte.${c}`),this}like(l,c){return this.url.searchParams.append(l,`like.${c}`),this}likeAllOf(l,c){return this.url.searchParams.append(l,`like(all).{${c.join(",")}}`),this}likeAnyOf(l,c){return this.url.searchParams.append(l,`like(any).{${c.join(",")}}`),this}ilike(l,c){return this.url.searchParams.append(l,`ilike.${c}`),this}ilikeAllOf(l,c){return this.url.searchParams.append(l,`ilike(all).{${c.join(",")}}`),this}ilikeAnyOf(l,c){return this.url.searchParams.append(l,`ilike(any).{${c.join(",")}}`),this}is(l,c){return this.url.searchParams.append(l,`is.${c}`),this}in(l,c){const d=Array.from(new Set(c)).map(h=>typeof h=="string"&&n.test(h)?`"${h}"`:`${h}`).join(",");return this.url.searchParams.append(l,`in.(${d})`),this}contains(l,c){return typeof c=="string"?this.url.searchParams.append(l,`cs.${c}`):Array.isArray(c)?this.url.searchParams.append(l,`cs.{${c.join(",")}}`):this.url.searchParams.append(l,`cs.${JSON.stringify(c)}`),this}containedBy(l,c){return typeof c=="string"?this.url.searchParams.append(l,`cd.${c}`):Array.isArray(c)?this.url.searchParams.append(l,`cd.{${c.join(",")}}`):this.url.searchParams.append(l,`cd.${JSON.stringify(c)}`),this}rangeGt(l,c){return this.url.searchParams.append(l,`sr.${c}`),this}rangeGte(l,c){return this.url.searchParams.append(l,`nxl.${c}`),this}rangeLt(l,c){return this.url.searchParams.append(l,`sl.${c}`),this}rangeLte(l,c){return this.url.searchParams.append(l,`nxr.${c}`),this}rangeAdjacent(l,c){return this.url.searchParams.append(l,`adj.${c}`),this}overlaps(l,c){return typeof c=="string"?this.url.searchParams.append(l,`ov.${c}`):this.url.searchParams.append(l,`ov.{${c.join(",")}}`),this}textSearch(l,c,{config:d,type:h}={}){let f="";h==="plain"?f="pl":h==="phrase"?f="ph":h==="websearch"&&(f="w");const p=d===void 0?"":`(${d})`;return this.url.searchParams.append(l,`${f}fts${p}.${c}`),this}match(l){return Object.entries(l).forEach(([c,d])=>{this.url.searchParams.append(c,`eq.${d}`)}),this}not(l,c,d){return this.url.searchParams.append(l,`not.${c}.${d}`),this}or(l,{foreignTable:c,referencedTable:d=c}={}){const h=d?`${d}.or`:"or";return this.url.searchParams.append(h,`(${l})`),this}filter(l,c,d){return this.url.searchParams.append(l,`${c}.${d}`),this}}return ku.default=s,ku}var Tb;function HA(){if(Tb)return Iu;Tb=1,Object.defineProperty(Iu,"__esModule",{value:!0});const e=Wa.__importDefault(Eg());class n{constructor(a,{headers:l={},schema:c,fetch:d}){this.url=a,this.headers=new Headers(l),this.schema=c,this.fetch=d}select(a,l){const{head:c=!1,count:d}=l??{},h=c?"HEAD":"GET";let f=!1;const p=(a??"*").split("").map(m=>/\s/.test(m)&&!f?"":(m==='"'&&(f=!f),m)).join("");return this.url.searchParams.set("select",p),d&&this.headers.append("Prefer",`count=${d}`),new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:l,defaultToNull:c=!0}={}){var d;const h="POST";if(l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const f=a.reduce((p,m)=>p.concat(Object.keys(m)),[]);if(f.length>0){const p=[...new Set(f)].map(m=>`"${m}"`);this.url.searchParams.set("columns",p.join(","))}}return new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}upsert(a,{onConflict:l,ignoreDuplicates:c=!1,count:d,defaultToNull:h=!0}={}){var f;const p="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),d&&this.headers.append("Prefer",`count=${d}`),h||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const m=a.reduce((y,_)=>y.concat(Object.keys(_)),[]);if(m.length>0){const y=[...new Set(m)].map(_=>`"${_}"`);this.url.searchParams.set("columns",y.join(","))}}return new e.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}update(a,{count:l}={}){var c;const d="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:a}={}){var l;const c="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return Iu.default=n,Iu}var Nb;function Oj(){if(Nb)return Ou;Nb=1,Object.defineProperty(Ou,"__esModule",{value:!0});const t=Wa,e=t.__importDefault(HA()),n=t.__importDefault(Eg());class s{constructor(l,{headers:c={},schema:d,fetch:h}={}){this.url=l,this.headers=new Headers(c),this.schemaName=d,this.fetch=h}from(l){const c=new URL(`${this.url}/${l}`);return new e.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new s(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:d=!1,get:h=!1,count:f}={}){var p;let m;const y=new URL(`${this.url}/rpc/${l}`);let _;d||h?(m=d?"HEAD":"GET",Object.entries(c).filter(([w,A])=>A!==void 0).map(([w,A])=>[w,Array.isArray(A)?`{${A.join(",")}}`:`${A}`]).forEach(([w,A])=>{y.searchParams.append(w,A)})):(m="POST",_=c);const x=new Headers(this.headers);return f&&x.set("Prefer",`count=${f}`),new n.default({method:m,url:y,headers:x,schema:this.schemaName,body:_,fetch:(p=this.fetch)!==null&&p!==void 0?p:fetch})}}return Ou.default=s,Ou}var Rb;function Ij(){if(Rb)return Wt;Rb=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.PostgrestError=Wt.PostgrestBuilder=Wt.PostgrestTransformBuilder=Wt.PostgrestFilterBuilder=Wt.PostgrestQueryBuilder=Wt.PostgrestClient=void 0;const t=Wa,e=t.__importDefault(Oj());Wt.PostgrestClient=e.default;const n=t.__importDefault(HA());Wt.PostgrestQueryBuilder=n.default;const s=t.__importDefault(Eg());Wt.PostgrestFilterBuilder=s.default;const a=t.__importDefault(PA());Wt.PostgrestTransformBuilder=a.default;const l=t.__importDefault(zA());Wt.PostgrestBuilder=l.default;const c=t.__importDefault($A());return Wt.PostgrestError=c.default,Wt.default={PostgrestClient:e.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:l.default,PostgrestError:c.default},Wt}var qA=Ij();const QA=Fl(qA),kj=VN({__proto__:null,default:QA},[qA]),{PostgrestClient:Mj,PostgrestQueryBuilder:Sz,PostgrestFilterBuilder:Cz,PostgrestTransformBuilder:Tz,PostgrestBuilder:Nz,PostgrestError:Rz}=QA||kj;class Dj{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const s=n.node,a=parseInt(s.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const s=this.getWebSocketConstructor();return new s(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const Bj="2.79.0",Uj=`realtime-js/${Bj}`,Lj="1.0.0",Op=1e4,$j=1e3,zj=100;var bl;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(bl||(bl={}));var Dt;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Dt||(Dt={}));var er;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(er||(er={}));var Ip;(function(t){t.websocket="websocket"})(Ip||(Ip={}));var fi;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(fi||(fi={}));class Pj{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,n,s)}_decodeBroadcast(e,n,s){const a=n.getUint8(1),l=n.getUint8(2);let c=this.HEADER_LENGTH+2;const d=s.decode(e.slice(c,c+a));c=c+a;const h=s.decode(e.slice(c,c+l));c=c+l;const f=JSON.parse(s.decode(e.slice(c,e.byteLength)));return{ref:null,topic:d,event:h,payload:f}}}let FA=class{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var lt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(lt||(lt={}));const jb=(t,e,n={})=>{var s;const a=(s=n.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((l,c)=>(l[c]=Hj(c,t,e,a),l),{}):{}},Hj=(t,e,n,s)=>{const a=e.find(d=>d.name===t),l=a?.type,c=n[t];return l&&!s.includes(l)?VA(l,c):kp(c)},VA=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return Vj(e,n)}switch(t){case lt.bool:return qj(e);case lt.float4:case lt.float8:case lt.int2:case lt.int4:case lt.int8:case lt.numeric:case lt.oid:return Qj(e);case lt.json:case lt.jsonb:return Fj(e);case lt.timestamp:return Gj(e);case lt.abstime:case lt.date:case lt.daterange:case lt.int4range:case lt.int8range:case lt.money:case lt.reltime:case lt.text:case lt.time:case lt.timestamptz:case lt.timetz:case lt.tsrange:case lt.tstzrange:return kp(e);default:return kp(e)}},kp=t=>t,qj=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Qj=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Fj=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},Vj=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,s=t[n];if(t[0]==="{"&&s==="}"){let l;const c=t.slice(1,n);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(d=>VA(e,d))}return t},Gj=t=>typeof t=="string"?t.replace(" ","T"):t,GA=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Gm{constructor(e,n,s={},a=Op){this.channel=e,this.event=n,this.payload=s,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var s;return this._hasReceived(e)&&n((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ob;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Ob||(Ob={}));class wl{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=n?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},a=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=wl.syncState(this.state,a,l,c),this.pendingDiffs.forEach(h=>{this.state=wl.syncDiff(this.state,h,l,c)}),this.pendingDiffs=[],d()}),this.channel._on(s.diff,{},a=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=wl.syncDiff(this.state,a,l,c),d())}),this.onJoin((a,l,c)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:l,newPresences:c})}),this.onLeave((a,l,c)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,s,a){const l=this.cloneDeep(e),c=this.transformState(n),d={},h={};return this.map(l,(f,p)=>{c[f]||(h[f]=p)}),this.map(c,(f,p)=>{const m=l[f];if(m){const y=p.map(A=>A.presence_ref),_=m.map(A=>A.presence_ref),x=p.filter(A=>_.indexOf(A.presence_ref)<0),w=m.filter(A=>y.indexOf(A.presence_ref)<0);x.length>0&&(d[f]=x),w.length>0&&(h[f]=w)}else d[f]=p}),this.syncDiff(l,{joins:d,leaves:h},s,a)}static syncDiff(e,n,s,a){const{joins:l,leaves:c}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return s||(s=()=>{}),a||(a=()=>{}),this.map(l,(d,h)=>{var f;const p=(f=e[d])!==null&&f!==void 0?f:[];if(e[d]=this.cloneDeep(h),p.length>0){const m=e[d].map(_=>_.presence_ref),y=p.filter(_=>m.indexOf(_.presence_ref)<0);e[d].unshift(...y)}s(d,p,h)}),this.map(c,(d,h)=>{let f=e[d];if(!f)return;const p=h.map(m=>m.presence_ref);f=f.filter(m=>p.indexOf(m.presence_ref)<0),e[d]=f,a(d,f,h),f.length===0&&delete e[d]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(s=>n(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,s)=>{const a=e[s];return"metas"in a?n[s]=a.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):n[s]=a,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ib;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Ib||(Ib={}));var xl;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(xl||(xl={}));var Vr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Vr||(Vr={}));class Sg{constructor(e,n={config:{}},s){var a,l;if(this.topic=e,this.params=n,this.socket=s,this.bindings={},this.state=Dt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Gm(this,er.join,this.params,this.timeout),this.rejoinTimer=new FA(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Dt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Dt.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=Dt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Dt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=Dt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(er.reply,{},(c,d)=>{this._trigger(this._replyEventName(d),c)}),this.presence=new wl(this),this.broadcastEndpointURL=GA(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,n=this.timeout){var s,a,l;if(this.socket.isConnected()||this.socket.connect(),this.state==Dt.closed){const{config:{broadcast:c,presence:d,private:h}}=this.params,f=(a=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(_=>_.filter))!==null&&a!==void 0?a:[],p=!!this.bindings[xl.PRESENCE]&&this.bindings[xl.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,m={},y={broadcast:c,presence:Object.assign(Object.assign({},d),{enabled:p}),postgres_changes:f,private:h};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(_=>e?.(Vr.CHANNEL_ERROR,_)),this._onClose(()=>e?.(Vr.CLOSED)),this.updateJoinPayload(Object.assign({config:y},m)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:_})=>{var x;if(this.socket.setAuth(),_===void 0){e?.(Vr.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,A=(x=w?.length)!==null&&x!==void 0?x:0,S=[];for(let T=0;T<A;T++){const E=w[T],{filter:{event:C,schema:j,table:O,filter:M}}=E,D=_&&_[T];if(D&&D.event===C&&D.schema===j&&D.table===O&&D.filter===M)S.push(Object.assign(Object.assign({},E),{id:D.id}));else{this.unsubscribe(),this.state=Dt.errored,e?.(Vr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=S,e&&e(Vr.SUBSCRIBED);return}}).receive("error",_=>{this.state=Dt.errored,e?.(Vr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(_).join(", ")||"error")))}).receive("timeout",()=>{e?.(Vr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,s){return this.state===Dt.joined&&e===xl.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,n,s)}async httpSend(e,n,s={}){var a;const l=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(n==null)return Promise.reject("Payload is required for httpSend()");const c={method:"POST",headers:{Authorization:l,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:n,private:this.private}]})},d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(a=s.timeout)!==null&&a!==void 0?a:this.timeout);if(d.status===202)return{success:!0};let h=d.statusText;try{const f=await d.json();h=f.error||f.message||h}catch{}return Promise.reject(new Error(h))}async send(e,n={}){var s,a;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:c}=e,h={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);return await((a=f.body)===null||a===void 0?void 0:a.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,d,h;const f=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((h=(d=(c=this.params)===null||c===void 0?void 0:c.config)===null||d===void 0?void 0:d.broadcast)===null||h===void 0)&&h.ack)&&l("ok"),f.receive("ok",()=>l("ok")),f.receive("error",()=>l("error")),f.receive("timeout",()=>l("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Dt.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(er.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(a=>{s=new Gm(this,er.leave,{},e),s.receive("ok",()=>{n(),a("ok")}).receive("timeout",()=>{n(),a("timed out")}).receive("error",()=>{a("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Dt.closed,this.bindings={}}async _fetchWithTimeout(e,n,s){const a=new AbortController,l=setTimeout(()=>a.abort(),s),c=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:a.signal}));return clearTimeout(l),c}_push(e,n,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Gm(this,e,n,s);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>zj){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,s){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,s){var a,l;const c=e.toLocaleLowerCase(),{close:d,error:h,leave:f,join:p}=er;if(s&&[d,h,f,p].indexOf(c)>=0&&s!==this._joinRef())return;let y=this._onMessage(c,n,s);if(n&&!y)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(_=>{var x,w,A;return((x=_.filter)===null||x===void 0?void 0:x.event)==="*"||((A=(w=_.filter)===null||w===void 0?void 0:w.event)===null||A===void 0?void 0:A.toLocaleLowerCase())===c}).map(_=>_.callback(y,s)):(l=this.bindings[c])===null||l===void 0||l.filter(_=>{var x,w,A,S,T,E;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in _){const C=_.id,j=(x=_.filter)===null||x===void 0?void 0:x.event;return C&&((w=n.ids)===null||w===void 0?void 0:w.includes(C))&&(j==="*"||j?.toLocaleLowerCase()===((A=n.data)===null||A===void 0?void 0:A.type.toLocaleLowerCase()))}else{const C=(T=(S=_?.filter)===null||S===void 0?void 0:S.event)===null||T===void 0?void 0:T.toLocaleLowerCase();return C==="*"||C===((E=n?.event)===null||E===void 0?void 0:E.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===c}).map(_=>{if(typeof y=="object"&&"ids"in y){const x=y.data,{schema:w,table:A,commit_timestamp:S,type:T,errors:E}=x;y=Object.assign(Object.assign({},{schema:w,table:A,commit_timestamp:S,eventType:T,new:{},old:{},errors:E}),this._getPayloadRecords(x))}_.callback(y,s)})}_isClosed(){return this.state===Dt.closed}_isJoined(){return this.state===Dt.joined}_isJoining(){return this.state===Dt.joining}_isLeaving(){return this.state===Dt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,s){const a=e.toLocaleLowerCase(),l={type:a,filter:n,callback:s};return this.bindings[a]?this.bindings[a].push(l):this.bindings[a]=[l],this}_off(e,n){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(a=>{var l;return!(((l=a.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===s&&Sg.isEqual(a.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const s in e)if(e[s]!==n[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(er.close,{},e)}_onError(e){this._on(er.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Dt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=jb(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=jb(e.columns,e.old_record)),n}}const Ym=()=>{},Uu={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Yj=[1e3,2e3,5e3,1e4],Xj=1e4,Kj=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Wj{constructor(e,n){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Op,this.transport=null,this.heartbeatIntervalMs=Uu.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ym,this.ref=0,this.reconnectTimer=null,this.logger=Ym,this.conn=null,this.sendBuffer=[],this.serializer=new Pj,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>a?(...l)=>a(...l):(...l)=>fetch(...l),!(!((s=n?.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${Ip.websocket}`,this.httpEndpoint=GA(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Dj.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Lj}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},e?this.conn.close(e,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,s){this.logger(e,n,s)}connectionState(){switch(this.conn&&this.conn.readyState){case bl.connecting:return fi.Connecting;case bl.open:return fi.Open;case bl.closing:return fi.Closing;default:return fi.Closed}}isConnected(){return this.connectionState()===fi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const s=`realtime:${e}`,a=this.getChannels().find(l=>l.topic===s);if(a)return a;{const l=new Sg(`realtime:${e}`,n,this);return this.channels.push(l),l}}push(e){const{topic:n,event:s,payload:a,ref:l}=e,c=()=>{this.encode(e,d=>{var h;(h=this.conn)===null||h===void 0||h.send(d)})};this.log("push",`${n} ${s} (${l})`,a),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close($j,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Uu.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(f){this.log("error","error in heartbeat callback",f)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:a,payload:l,ref:c}=n,d=c?`(${c})`:"",h=l.status||"";this.log("receive",`${h} ${s} ${a} ${d}`.trim(),l),this.channels.filter(f=>f._isMember(s)).forEach(f=>f._trigger(a,l,c)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(er.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const s=e.match(/\?/)?"&":"?",a=new URLSearchParams(n);return`${e}${s}${a}`}_workerObjectUrl(e){let n;if(e)n=e;else{const s=new Blob([Kj],{type:"application/javascript"});n=URL.createObjectURL(s)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n;e?n=e:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(s=>{const a={access_token:n,version:Uj};n&&s.updateJoinPayload(a),s.joinedOnce&&s._isJoined()&&s._push(er.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(n)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new FA(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Uu.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,s,a,l,c,d,h,f,p;if(this.transport=(n=e?.transport)!==null&&n!==void 0?n:null,this.timeout=(s=e?.timeout)!==null&&s!==void 0?s:Op,this.heartbeatIntervalMs=(a=e?.heartbeatIntervalMs)!==null&&a!==void 0?a:Uu.HEARTBEAT_INTERVAL,this.worker=(l=e?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=e?.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(d=e?.heartbeatCallback)!==null&&d!==void 0?d:Ym,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=e?.reconnectAfterMs)!==null&&h!==void 0?h:(m=>Yj[m-1]||Xj),this.encode=(f=e?.encode)!==null&&f!==void 0?f:((m,y)=>y(JSON.stringify(m))),this.decode=(p=e?.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class Cg extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function gt(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Jj extends Cg{constructor(e,n,s){super(e),this.name="StorageApiError",this.status=n,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Mp extends Cg{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}const Tg=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Zj=()=>Response,Dp=t=>{if(Array.isArray(t))return t.map(n=>Dp(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,s])=>{const a=n.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));e[a]=Dp(s)}),e},eO=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Xm=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},tO=(t,e,n)=>Ce(void 0,void 0,void 0,function*(){const s=yield Zj();t instanceof s&&!n?.noResolveJson?t.json().then(a=>{const l=t.status||500,c=a?.statusCode||l+"";e(new Jj(Xm(a),l,c))}).catch(a=>{e(new Mp(Xm(a),a))}):e(new Mp(Xm(t),t))}),nO=(t,e,n,s)=>{const a={method:t,headers:e?.headers||{}};return t==="GET"||!s?a:(eO(s)?(a.headers=Object.assign({"Content-Type":"application/json"},e?.headers),a.body=JSON.stringify(s)):a.body=s,e?.duplex&&(a.duplex=e.duplex),Object.assign(Object.assign({},a),n))};function Kl(t,e,n,s,a,l){return Ce(this,void 0,void 0,function*(){return new Promise((c,d)=>{t(n,nO(e,s,a,l)).then(h=>{if(!h.ok)throw h;return s?.noResolveJson?h:h.json()}).then(h=>c(h)).catch(h=>tO(h,d,s))})})}function jl(t,e,n,s){return Ce(this,void 0,void 0,function*(){return Kl(t,"GET",e,n,s)})}function Jn(t,e,n,s,a){return Ce(this,void 0,void 0,function*(){return Kl(t,"POST",e,s,a,n)})}function Bp(t,e,n,s,a){return Ce(this,void 0,void 0,function*(){return Kl(t,"PUT",e,s,a,n)})}function rO(t,e,n,s){return Ce(this,void 0,void 0,function*(){return Kl(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),s)})}function Ng(t,e,n,s,a){return Ce(this,void 0,void 0,function*(){return Kl(t,"DELETE",e,s,a,n)})}class sO{constructor(e,n){this.downloadFn=e,this.shouldThrowOnError=n}then(e,n){return this.execute().then(e,n)}execute(){return Ce(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(gt(e))return{data:null,error:e};throw e}})}}var YA;class iO{constructor(e,n){this.downloadFn=e,this.shouldThrowOnError=n,this[YA]="BlobDownloadBuilder",this.promise=null}asStream(){return new sO(this.downloadFn,this.shouldThrowOnError)}then(e,n){return this.getPromise().then(e,n)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Ce(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(gt(e))return{data:null,error:e};throw e}})}}YA=Symbol.toStringTag;const aO={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},kb={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class oO{constructor(e,n={},s,a){this.shouldThrowOnError=!1,this.url=e,this.headers=n,this.bucketId=s,this.fetch=Tg(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,n,s,a){return Ce(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},kb),a);let d=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const h=c.metadata;typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),h&&l.append("metadata",this.encodeMetadata(h)),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.has("cacheControl")||l.append("cacheControl",c.cacheControl),h&&!l.has("metadata")&&l.append("metadata",this.encodeMetadata(h))):(l=s,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType,h&&(d["x-metadata"]=this.toBase64(this.encodeMetadata(h))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!c.duplex&&(c.duplex="half")),a?.headers&&(d=Object.assign(Object.assign({},d),a.headers));const f=this._removeEmptyFolders(n),p=this._getFinalPath(f),m=yield(e=="PUT"?Bp:Jn)(this.fetch,`${this.url}/object/${p}`,l,Object.assign({headers:d},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:f,id:m.Id,fullPath:m.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(gt(l))return{data:null,error:l};throw l}})}upload(e,n,s){return Ce(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,s)})}uploadToSignedUrl(e,n,s,a){return Ce(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(e),c=this._getFinalPath(l),d=new URL(this.url+`/object/upload/sign/${c}`);d.searchParams.set("token",n);try{let h;const f=Object.assign({upsert:kb.upsert},a),p=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&s instanceof Blob?(h=new FormData,h.append("cacheControl",f.cacheControl),h.append("",s)):typeof FormData<"u"&&s instanceof FormData?(h=s,h.append("cacheControl",f.cacheControl)):(h=s,p["cache-control"]=`max-age=${f.cacheControl}`,p["content-type"]=f.contentType);const m=yield Bp(this.fetch,d.toString(),h,{headers:p});return{data:{path:l,fullPath:m.Key},error:null}}catch(h){if(this.shouldThrowOnError)throw h;if(gt(h))return{data:null,error:h};throw h}})}createSignedUploadUrl(e,n){return Ce(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const a=Object.assign({},this.headers);n?.upsert&&(a["x-upsert"]="true");const l=yield Jn(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:a}),c=new URL(this.url+l.url),d=c.searchParams.get("token");if(!d)throw new Cg("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:d},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(gt(s))return{data:null,error:s};throw s}})}update(e,n,s){return Ce(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,s)})}move(e,n,s){return Ce(this,void 0,void 0,function*(){try{return{data:yield Jn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:s?.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(gt(a))return{data:null,error:a};throw a}})}copy(e,n,s){return Ce(this,void 0,void 0,function*(){try{return{data:{path:(yield Jn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:s?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(gt(a))return{data:null,error:a};throw a}})}createSignedUrl(e,n,s){return Ce(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),l=yield Jn(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:n},s?.transform?{transform:s.transform}:{}),{headers:this.headers});const c=s?.download?`&download=${s.download===!0?"":s.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(gt(a))return{data:null,error:a};throw a}})}createSignedUrls(e,n,s){return Ce(this,void 0,void 0,function*(){try{const a=yield Jn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),l=s?.download?`&download=${s.download===!0?"":s.download}`:"";return{data:a.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(gt(a))return{data:null,error:a};throw a}})}download(e,n){const a=typeof n?.transform<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString(n?.transform||{}),c=l?`?${l}`:"",d=this._getFinalPath(e),h=()=>jl(this.fetch,`${this.url}/${a}/${d}${c}`,{headers:this.headers,noResolveJson:!0});return new iO(h,this.shouldThrowOnError)}info(e){return Ce(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const s=yield jl(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Dp(s),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(gt(s))return{data:null,error:s};throw s}})}exists(e){return Ce(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield rO(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(gt(s)&&s instanceof Mp){const a=s.originalError;if([400,404].includes(a?.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,n){const s=this._getFinalPath(e),a=[],l=n?.download?`download=${n.download===!0?"":n.download}`:"";l!==""&&a.push(l);const d=typeof n?.transform<"u"?"render/image":"object",h=this.transformOptsToQueryString(n?.transform||{});h!==""&&a.push(h);let f=a.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${s}${f}`)}}}remove(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield Ng(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}})}list(e,n,s){return Ce(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},aO),n),{prefix:e||""});return{data:yield Jn(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},s),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(gt(a))return{data:null,error:a};throw a}})}listV2(e,n){return Ce(this,void 0,void 0,function*(){try{const s=Object.assign({},e);return{data:yield Jn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(gt(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const XA="2.79.0",KA={"X-Client-Info":`storage-js/${XA}`};class lO{constructor(e,n={},s,a){this.shouldThrowOnError=!1;const l=new URL(e);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},KA),n),this.fetch=Tg(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return Ce(this,void 0,void 0,function*(){try{const n=this.listBucketOptionsToQueryString(e);return{data:yield jl(this.fetch,`${this.url}/bucket${n}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}})}getBucket(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield jl(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}})}createBucket(e){return Ce(this,arguments,void 0,function*(n,s={public:!1}){try{return{data:yield Jn(this.fetch,`${this.url}/bucket`,{id:n,name:n,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(gt(a))return{data:null,error:a};throw a}})}updateBucket(e,n){return Ce(this,void 0,void 0,function*(){try{return{data:yield Bp(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(gt(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield Jn(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield Ng(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}})}listBucketOptionsToQueryString(e){const n={};return e&&("limit"in e&&(n.limit=String(e.limit)),"offset"in e&&(n.offset=String(e.offset)),e.search&&(n.search=e.search),e.sortColumn&&(n.sortColumn=e.sortColumn),e.sortOrder&&(n.sortOrder=e.sortOrder)),Object.keys(n).length>0?"?"+new URLSearchParams(n).toString():""}}class cO{constructor(e,n={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},KA),n),this.fetch=Tg(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield Jn(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}})}listBuckets(e){return Ce(this,void 0,void 0,function*(){try{const n=new URLSearchParams;e?.limit!==void 0&&n.set("limit",e.limit.toString()),e?.offset!==void 0&&n.set("offset",e.offset.toString()),e?.sortColumn&&n.set("sortColumn",e.sortColumn),e?.sortOrder&&n.set("sortOrder",e.sortOrder),e?.search&&n.set("search",e.search);const s=n.toString(),a=s?`${this.url}/bucket?${s}`:`${this.url}/bucket`;return{data:yield jl(this.fetch,a,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield Ng(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}})}}const Rg={"X-Client-Info":`storage-js/${XA}`,"Content-Type":"application/json"};class WA extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Nn(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}class Km extends WA{constructor(e,n,s){super(e),this.name="StorageVectorsApiError",this.status=n,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class uO extends WA{constructor(e,n){super(e),this.name="StorageVectorsUnknownError",this.originalError=n}}var Mb;(function(t){t.InternalError="InternalError",t.S3VectorConflictException="S3VectorConflictException",t.S3VectorNotFoundException="S3VectorNotFoundException",t.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",t.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",t.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Mb||(Mb={}));const jg=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),dO=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Db=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),fO=(t,e,n)=>Ce(void 0,void 0,void 0,function*(){if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!n?.noResolveJson){const a=t.status||500,l=t;if(typeof l.json=="function")l.json().then(c=>{const d=c?.statusCode||c?.code||a+"";e(new Km(Db(c),a,d))}).catch(()=>{const c=a+"",d=l.statusText||`HTTP ${a} error`;e(new Km(d,a,c))});else{const c=a+"",d=l.statusText||`HTTP ${a} error`;e(new Km(d,a,c))}}else e(new uO(Db(t),t))}),hO=(t,e,n,s)=>{const a={method:t,headers:e?.headers||{}};return s?(dO(s)?(a.headers=Object.assign({"Content-Type":"application/json"},e?.headers),a.body=JSON.stringify(s)):a.body=s,Object.assign(Object.assign({},a),n)):a};function mO(t,e,n,s,a,l){return Ce(this,void 0,void 0,function*(){return new Promise((c,d)=>{t(n,hO(e,s,a,l)).then(h=>{if(!h.ok)throw h;if(s?.noResolveJson)return h;const f=h.headers.get("content-type");return!f||!f.includes("application/json")?{}:h.json()}).then(h=>c(h)).catch(h=>fO(h,d,s))})})}function Rn(t,e,n,s,a){return Ce(this,void 0,void 0,function*(){return mO(t,"POST",e,s,a,n)})}class pO{constructor(e,n={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Rg),n),this.fetch=jg(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return Ce(this,void 0,void 0,function*(){try{return{data:(yield Rn(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}getIndex(e,n){return Ce(this,void 0,void 0,function*(){try{return{data:yield Rn(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:n},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Nn(s))return{data:null,error:s};throw s}})}listIndexes(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield Rn(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}deleteIndex(e,n){return Ce(this,void 0,void 0,function*(){try{return{data:(yield Rn(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:n},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Nn(s))return{data:null,error:s};throw s}})}}class gO{constructor(e,n={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Rg),n),this.fetch=jg(s)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return Ce(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Rn(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}getVectors(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield Rn(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}listVectors(e){return Ce(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield Rn(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}queryVectors(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield Rn(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}deleteVectors(e){return Ce(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Rn(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}}class yO{constructor(e,n={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Rg),n),this.fetch=jg(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return Ce(this,void 0,void 0,function*(){try{return{data:(yield Rn(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}getBucket(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield Rn(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}listBuckets(){return Ce(this,arguments,void 0,function*(e={}){try{return{data:yield Rn(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Ce(this,void 0,void 0,function*(){try{return{data:(yield Rn(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}}class vO extends yO{constructor(e,n={}){super(e,n.headers||{},n.fetch)}from(e){return new _O(this.url,this.headers,e,this.fetch)}}class _O extends pO{constructor(e,n,s,a){super(e,n,a),this.vectorBucketName=s}createIndex(e){const n=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Ce(this,void 0,void 0,function*(){return n.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Ce(this,arguments,void 0,function*(n={}){return e.listIndexes.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const n=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Ce(this,void 0,void 0,function*(){return n.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const n=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Ce(this,void 0,void 0,function*(){return n.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new bO(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class bO extends gO{constructor(e,n,s,a,l){super(e,n,l),this.vectorBucketName=s,this.indexName=a}putVectors(e){const n=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Ce(this,void 0,void 0,function*(){return n.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const n=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Ce(this,void 0,void 0,function*(){return n.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Ce(this,arguments,void 0,function*(n={}){return e.listVectors.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const n=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Ce(this,void 0,void 0,function*(){return n.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const n=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Ce(this,void 0,void 0,function*(){return n.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class wO extends lO{constructor(e,n={},s,a){super(e,n,s,a)}from(e){return new oO(this.url,this.headers,e,this.fetch)}get vectors(){return new vO(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new cO(this.url+"/iceberg",this.headers,this.fetch)}}const xO="2.79.0";let ol="";typeof Deno<"u"?ol="deno":typeof document<"u"?ol="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ol="react-native":ol="node";const AO={"X-Client-Info":`supabase-js-${ol}/${xO}`},EO={headers:AO},SO={schema:"public"},CO={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},TO={},NO=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),RO=()=>Headers,jO=(t,e,n)=>{const s=NO(n),a=RO();return async(l,c)=>{var d;const h=(d=await e())!==null&&d!==void 0?d:t;let f=new a(c?.headers);return f.has("apikey")||f.set("apikey",t),f.has("Authorization")||f.set("Authorization",`Bearer ${h}`),s(l,Object.assign(Object.assign({},c),{headers:f}))}};function OO(t){return t.endsWith("/")?t:t+"/"}function IO(t,e){var n,s;const{db:a,auth:l,realtime:c,global:d}=t,{db:h,auth:f,realtime:p,global:m}=e,y={db:Object.assign(Object.assign({},h),a),auth:Object.assign(Object.assign({},f),l),realtime:Object.assign(Object.assign({},p),c),storage:{},global:Object.assign(Object.assign(Object.assign({},m),d),{headers:Object.assign(Object.assign({},(n=m?.headers)!==null&&n!==void 0?n:{}),(s=d?.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return t.accessToken?y.accessToken=t.accessToken:delete y.accessToken,y}function kO(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(OO(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const JA="2.79.0",Ra=30*1e3,Up=3,Wm=Up*Ra,MO="http://localhost:9999",DO="supabase.auth.token",BO={"X-Client-Info":`gotrue-js/${JA}`},Lp="X-Supabase-Api-Version",ZA={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},UO=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,LO=600*1e3;class Ol extends Error{constructor(e,n,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=s}}function Re(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class $O extends Ol{constructor(e,n,s){super(e,n,s),this.name="AuthApiError",this.status=n,this.code=s}}function zO(t){return Re(t)&&t.name==="AuthApiError"}class hi extends Ol{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class $s extends Ol{constructor(e,n,s,a){super(e,s,a),this.name=n,this.status=s}}class Kn extends $s{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function PO(t){return Re(t)&&t.name==="AuthSessionMissingError"}class _a extends $s{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Lu extends $s{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class $u extends $s{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function HO(t){return Re(t)&&t.name==="AuthImplicitGrantRedirectError"}class Bb extends $s{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class $p extends $s{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Jm(t){return Re(t)&&t.name==="AuthRetryableFetchError"}class Ub extends $s{constructor(e,n,s){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=s}}class zp extends $s{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Cd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Lb=` 	
\r=`.split(""),qO=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Lb.length;e+=1)t[Lb[e].charCodeAt(0)]=-2;for(let e=0;e<Cd.length;e+=1)t[Cd[e].charCodeAt(0)]=e;return t})();function $b(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(Cd[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(Cd[s]),e.queuedBits-=6}}function eE(t,e,n){const s=qO[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function zb(t){const e=[],n=c=>{e.push(String.fromCodePoint(c))},s={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},l=c=>{VO(c,s,n)};for(let c=0;c<t.length;c+=1)eE(t.charCodeAt(c),a,l);return e.join("")}function QO(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function FO(t,e){for(let n=0;n<t.length;n+=1){let s=t.charCodeAt(n);if(s>55295&&s<=56319){const a=(s-55296)*1024&65535;s=(t.charCodeAt(n+1)-56320&65535|a)+65536,n+=1}QO(s,e)}}function VO(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let s=1;s<6;s+=1)if((t>>7-s&1)===0){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function Ua(t){const e=[],n={queue:0,queuedBits:0},s=a=>{e.push(a)};for(let a=0;a<t.length;a+=1)eE(t.charCodeAt(a),n,s);return new Uint8Array(e)}function GO(t){const e=[];return FO(t,n=>e.push(n)),new Uint8Array(e)}function pi(t){const e=[],n={queue:0,queuedBits:0},s=a=>{e.push(a)};return t.forEach(a=>$b(a,n,s)),$b(null,n,s),e.join("")}function YO(t){return Math.round(Date.now()/1e3)+t}function XO(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Jt=()=>typeof window<"u"&&typeof document<"u",ai={tested:!1,writable:!1},tE=()=>{if(!Jt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ai.tested)return ai.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),ai.tested=!0,ai.writable=!0}catch{ai.tested=!0,ai.writable=!1}return ai.writable};function KO(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((a,l)=>{e[l]=a})}catch{}return n.searchParams.forEach((s,a)=>{e[a]=s}),e}const nE=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),WO=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",ja=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},oi=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Ns=async(t,e)=>{await t.removeItem(e)};class Zd{constructor(){this.promise=new Zd.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Zd.promiseConstructor=Promise;function Zm(t){const e=t.split(".");if(e.length!==3)throw new zp("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!UO.test(e[s]))throw new zp("JWT not in base64url format");return{header:JSON.parse(zb(e[0])),payload:JSON.parse(zb(e[1])),signature:Ua(e[2]),raw:{header:e[0],payload:e[1]}}}async function JO(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function ZO(t,e){return new Promise((s,a)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await t(l);if(!e(l,null,c)){s(c);return}}catch(c){if(!e(l,c)){a(c);return}}})()})}function e2(t){return("0"+t.toString(16)).substr(-2)}function t2(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=n.length;let a="";for(let l=0;l<56;l++)a+=n.charAt(Math.floor(Math.random()*s));return a}return crypto.getRandomValues(e),Array.from(e,e2).join("")}async function n2(t){const n=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",n),a=new Uint8Array(s);return Array.from(a).map(l=>String.fromCharCode(l)).join("")}async function r2(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await n2(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ba(t,e,n=!1){const s=t2();let a=s;n&&(a+="/PASSWORD_RECOVERY"),await ja(t,`${e}-code-verifier`,a);const l=await r2(s);return[l,s===l?"plain":"s256"]}const s2=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function i2(t){const e=t.headers.get(Lp);if(!e||!e.match(s2))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function a2(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function o2(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const l2=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function wa(t){if(!l2.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function ep(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function c2(t,e){return new Proxy(t,{get:(n,s,a)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const l=s.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,s,a)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(n,s,a)}})}function Pb(t){return JSON.parse(JSON.stringify(t))}const ci=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),u2=[502,503,504];async function Hb(t){var e;if(!WO(t))throw new $p(ci(t),0);if(u2.includes(t.status))throw new $p(ci(t),t.status);let n;try{n=await t.json()}catch(l){throw new hi(ci(l),l)}let s;const a=i2(t);if(a&&a.getTime()>=ZA["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?s=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(s=n.error_code),s){if(s==="weak_password")throw new Ub(ci(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Kn}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new Ub(ci(n),t.status,n.weak_password.reasons);throw new $O(ci(n),t.status||500,s)}const d2=(t,e,n,s)=>{const a={method:t,headers:e?.headers||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),a.body=JSON.stringify(s),Object.assign(Object.assign({},a),n))};async function Be(t,e,n,s){var a;const l=Object.assign({},s?.headers);l[Lp]||(l[Lp]=ZA["2024-01-01"].name),s?.jwt&&(l.Authorization=`Bearer ${s.jwt}`);const c=(a=s?.query)!==null&&a!==void 0?a:{};s?.redirectTo&&(c.redirect_to=s.redirectTo);const d=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",h=await f2(t,e,n+d,{headers:l,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(h):{data:Object.assign({},h),error:null}}async function f2(t,e,n,s,a,l){const c=d2(e,s,a,l);let d;try{d=await t(n,Object.assign({},c))}catch(h){throw console.error(h),new $p(ci(h),0)}if(d.ok||await Hb(d),s?.noResolveJson)return d;try{return await d.json()}catch(h){await Hb(h)}}function Wn(t){var e;let n=null;p2(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=YO(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:s},error:null}}function qb(t){const e=Wn(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,s)=>n&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Ds(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function h2(t){return{data:t,error:null}}function m2(t){const{action_link:e,email_otp:n,hashed_token:s,redirect_to:a,verification_type:l}=t,c=Ka(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:e,email_otp:n,hashed_token:s,redirect_to:a,verification_type:l},h=Object.assign({},c);return{data:{properties:d,user:h},error:null}}function Qb(t){return t}function p2(t){return t.access_token&&t.refresh_token&&t.expires_in}const tp=["global","local","others"];class g2{constructor({url:e="",headers:n={},fetch:s}){this.url=e,this.headers=n,this.fetch=nE(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,n=tp[0]){if(tp.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${tp.join(", ")}`);try{return await Be(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Re(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,n={}){try{return await Be(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Ds})}catch(s){if(Re(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:n}=e,s=Ka(e,["options"]),a=Object.assign(Object.assign({},s),n);return"newEmail"in s&&(a.new_email=s?.newEmail,delete a.newEmail),await Be(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:m2,redirectTo:n?.redirectTo})}catch(n){if(Re(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await Be(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ds})}catch(n){if(Re(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,s,a,l,c,d,h;try{const f={nextPage:null,lastPage:0,total:0},p=await Be(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e?.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(l=(a=e?.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:Qb});if(p.error)throw p.error;const m=await p.json(),y=(c=p.headers.get("x-total-count"))!==null&&c!==void 0?c:0,_=(h=(d=p.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&h!==void 0?h:[];return _.length>0&&(_.forEach(x=>{const w=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),A=JSON.parse(x.split(";")[1].split("=")[1]);f[`${A}Page`]=w}),f.total=parseInt(y)),{data:Object.assign(Object.assign({},m),f),error:null}}catch(f){if(Re(f))return{data:{users:[]},error:f};throw f}}async getUserById(e){wa(e);try{return await Be(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ds})}catch(n){if(Re(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){wa(e);try{return await Be(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Ds})}catch(s){if(Re(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,n=!1){wa(e);try{return await Be(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Ds})}catch(s){if(Re(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){wa(e.userId);try{const{data:n,error:s}=await Be(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:n,error:s}}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _deleteFactor(e){wa(e.userId),wa(e.id);try{return{data:await Be(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _listOAuthClients(e){var n,s,a,l,c,d,h;try{const f={nextPage:null,lastPage:0,total:0},p=await Be(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e?.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(l=(a=e?.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:Qb});if(p.error)throw p.error;const m=await p.json(),y=(c=p.headers.get("x-total-count"))!==null&&c!==void 0?c:0,_=(h=(d=p.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&h!==void 0?h:[];return _.length>0&&(_.forEach(x=>{const w=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),A=JSON.parse(x.split(";")[1].split("=")[1]);f[`${A}Page`]=w}),f.total=parseInt(y)),{data:Object.assign(Object.assign({},m),f),error:null}}catch(f){if(Re(f))return{data:{clients:[]},error:f};throw f}}async _createOAuthClient(e){try{return await Be(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _getOAuthClient(e){try{return await Be(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _updateOAuthClient(e,n){try{return await Be(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:n,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Re(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await Be(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(e){try{return await Be(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Re(n))return{data:null,error:n};throw n}}}function Fb(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}const xa={debug:!!(globalThis&&tE()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class rE extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class y2 extends rE{}async function v2(t,e,n){xa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),xa.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async a=>{if(a){xa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await n()}finally{xa.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(e===0)throw xa.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new y2(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(xa.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function _2(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function sE(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function b2(t){return parseInt(t,16)}function w2(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function x2(t){var e;const{chainId:n,domain:s,expirationTime:a,issuedAt:l=new Date,nonce:c,notBefore:d,requestId:h,resources:f,scheme:p,uri:m,version:y}=t;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!m)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(y!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${y}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const _=sE(t.address),x=p?`${p}://${s}`:s,w=t.statement?`${t.statement}
`:"",A=`${x} wants you to sign in with your Ethereum account:
${_}

${w}`;let S=`URI: ${m}
Version: ${y}
Chain ID: ${n}${c?`
Nonce: ${c}`:""}
Issued At: ${l.toISOString()}`;if(a&&(S+=`
Expiration Time: ${a.toISOString()}`),d&&(S+=`
Not Before: ${d.toISOString()}`),h&&(S+=`
Request ID: ${h}`),f){let T=`
Resources:`;for(const E of f){if(!E||typeof E!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${E}`);T+=`
- ${E}`}S+=T}return`${A}
${S}`}class Nt extends Error{constructor({message:e,code:n,cause:s,name:a}){var l;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(l=a??(s instanceof Error?s.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=n}}class Td extends Nt{constructor(e,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:e}),this.name="WebAuthnUnknownError",this.originalError=n}}function A2({error:t,options:e}){var n,s,a;const{publicKey:l}=e;if(!l)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Nt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((n=l.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new Nt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((s=l.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Nt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((a=l.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Nt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Nt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Nt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return l.pubKeyCredParams.filter(d=>d.type==="public-key").length===0?new Nt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Nt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const c=window.location.hostname;if(iE(c)){if(l.rp.id!==c)return new Nt({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Nt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new Nt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Nt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Nt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function E2({error:t,options:e}){const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Nt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Nt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(iE(s)){if(n.rpId!==s)return new Nt({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Nt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Nt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Nt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class S2{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const C2=new S2;function T2(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:n,excludeCredentials:s}=t,a=Ka(t,["challenge","user","excludeCredentials"]),l=Ua(e).buffer,c=Object.assign(Object.assign({},n),{id:Ua(n.id).buffer}),d=Object.assign(Object.assign({},a),{challenge:l,user:c});if(s&&s.length>0){d.excludeCredentials=new Array(s.length);for(let h=0;h<s.length;h++){const f=s[h];d.excludeCredentials[h]=Object.assign(Object.assign({},f),{id:Ua(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return d}function N2(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:n}=t,s=Ka(t,["challenge","allowCredentials"]),a=Ua(e).buffer,l=Object.assign(Object.assign({},s),{challenge:a});if(n&&n.length>0){l.allowCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const d=n[c];l.allowCredentials[c]=Object.assign(Object.assign({},d),{id:Ua(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function R2(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t;return{id:t.id,rawId:t.id,response:{attestationObject:pi(new Uint8Array(t.response.attestationObject)),clientDataJSON:pi(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function j2(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t,s=t.getClientExtensionResults(),a=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:pi(new Uint8Array(a.authenticatorData)),clientDataJSON:pi(new Uint8Array(a.clientDataJSON)),signature:pi(new Uint8Array(a.signature)),userHandle:a.userHandle?pi(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function iE(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function Vb(){var t,e;return!!(Jt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function O2(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Td("Browser returned unexpected credential type",e)}:{data:null,error:new Td("Empty credential response",e)}}catch(e){return{data:null,error:A2({error:e,options:t})}}}async function I2(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Td("Browser returned unexpected credential type",e)}:{data:null,error:new Td("Empty credential response",e)}}catch(e){return{data:null,error:E2({error:e,options:t})}}}const k2={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},M2={userVerification:"preferred",hints:["security-key"]};function Nd(...t){const e=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),n=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),s={};for(const a of t)if(a)for(const l in a){const c=a[l];if(c!==void 0)if(Array.isArray(c))s[l]=c;else if(n(c))s[l]=c;else if(e(c)){const d=s[l];e(d)?s[l]=Nd(d,c):s[l]=Nd(c)}else s[l]=c}return s}function D2(t,e){return Nd(k2,t,e||{})}function B2(t,e){return Nd(M2,t,e||{})}class U2{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:n,friendlyName:s,signal:a},l){try{const{data:c,error:d}=await this.client.mfa.challenge({factorId:e,webauthn:n});if(!c)return{data:null,error:d};const h=a??C2.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:f}=c.webauthn.credential_options.publicKey;f.name||(f.name=`${f.id}:${s}`),f.displayName||(f.displayName=f.name)}switch(c.webauthn.type){case"create":{const f=D2(c.webauthn.credential_options.publicKey,l?.create),{data:p,error:m}=await O2({publicKey:f,signal:h});return p?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:p}},error:null}:{data:null,error:m}}case"request":{const f=B2(c.webauthn.credential_options.publicKey,l?.request),{data:p,error:m}=await I2(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:f,signal:h}));return p?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:p}},error:null}:{data:null,error:m}}}}catch(c){return Re(c)?{data:null,error:c}:{data:null,error:new hi("Unexpected error in challenge",c)}}}async _verify({challengeId:e,factorId:n,webauthn:s}){return this.client.mfa.verify({factorId:n,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:a}},l){if(!n)return{data:null,error:new Ol("rpId is required for WebAuthn authentication")};try{if(!Vb())return{data:null,error:new hi("Browser does not support WebAuthn",null)};const{data:c,error:d}=await this.challenge({factorId:e,webauthn:{rpId:n,rpOrigins:s},signal:a},{request:l});if(!c)return{data:null,error:d};const{webauthn:h}=c;return this._verify({factorId:e,challengeId:c.challengeId,webauthn:{type:h.type,rpId:n,rpOrigins:s,credential_response:h.credential_response}})}catch(c){return Re(c)?{data:null,error:c}:{data:null,error:new hi("Unexpected error in authenticate",c)}}}async _register({friendlyName:e,rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:a},l){if(!n)return{data:null,error:new Ol("rpId is required for WebAuthn registration")};try{if(!Vb())return{data:null,error:new hi("Browser does not support WebAuthn",null)};const{data:c,error:d}=await this._enroll({friendlyName:e});if(!c)return await this.client.mfa.listFactors().then(p=>{var m;return(m=p.data)===null||m===void 0?void 0:m.all.find(y=>y.factor_type==="webauthn"&&y.friendly_name===e&&y.status!=="unverified")}).then(p=>p?this.client.mfa.unenroll({factorId:p?.id}):void 0),{data:null,error:d};const{data:h,error:f}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:n,rpOrigins:s},signal:a},{create:l});return h?this._verify({factorId:c.id,challengeId:h.challengeId,webauthn:{rpId:n,rpOrigins:s,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:f}}catch(c){return Re(c)?{data:null,error:c}:{data:null,error:new hi("Unexpected error in register",c)}}}}_2();const L2={url:MO,storageKey:DO,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:BO,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Gb(t,e,n){return await n()}const Aa={};class Il{get jwks(){var e,n;return(n=(e=Aa[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){Aa[this.storageKey]=Object.assign(Object.assign({},Aa[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=Aa[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Aa[this.storageKey]=Object.assign(Object.assign({},Aa[this.storageKey]),{cachedAt:e})}constructor(e){var n,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Il.nextInstanceID,Il.nextInstanceID+=1,this.instanceID>0&&Jt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},L2),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new g2({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=nE(a.fetch),this.lock=a.lock||Gb,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:Jt()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=v2:this.lock=Gb,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new U2(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:tE()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Fb(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Fb(this.memoryStorage)),Jt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${JA}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let n={},s="none";if(Jt()&&(n=KO(window.location.href),this._isImplicitGrantCallback(n)?s="implicit":await this._isPKCECallback(n)&&(s="pkce")),Jt()&&this.detectSessionInUrl&&s!=="none"){const{data:a,error:l}=await this._getSessionFromURL(n,s);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),HO(l)){const h=(e=l.details)===null||e===void 0?void 0:e.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:d}=a;return this._debug("#_initialize()","detected session in URL",c,"redirect type",d),await this._saveSession(c),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Re(n)?this._returnResult({error:n}):this._returnResult({error:new hi("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,s,a;try{const l=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(n=e?.options)===null||n===void 0?void 0:n.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(a=e?.options)===null||a===void 0?void 0:a.captchaToken}},xform:Wn}),{data:c,error:d}=l;if(d||!c)return this._returnResult({data:{user:null,session:null},error:d});const h=c.session,f=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:f,session:h},error:null})}catch(l){if(Re(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(e){var n,s,a;try{let l;if("email"in e){const{email:p,password:m,options:y}=e;let _=null,x=null;this.flowType==="pkce"&&([_,x]=await ba(this.storage,this.storageKey)),l=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:y?.emailRedirectTo,body:{email:p,password:m,data:(n=y?.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:y?.captchaToken},code_challenge:_,code_challenge_method:x},xform:Wn})}else if("phone"in e){const{phone:p,password:m,options:y}=e;l=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:m,data:(s=y?.data)!==null&&s!==void 0?s:{},channel:(a=y?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:y?.captchaToken}},xform:Wn})}else throw new Lu("You must provide either an email or phone number and a password");const{data:c,error:d}=l;if(d||!c)return this._returnResult({data:{user:null,session:null},error:d});const h=c.session,f=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:f,session:h},error:null})}catch(l){if(Re(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(e){try{let n;if("email"in e){const{email:l,password:c,options:d}=e;n=await Be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:qb})}else if("phone"in e){const{phone:l,password:c,options:d}=e;n=await Be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:qb})}else throw new Lu("You must provide either an email or phone number and a password");const{data:s,error:a}=n;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!s||!s.session||!s.user){const l=new _a;return this._returnResult({data:{user:null,session:null},error:l})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:a})}catch(n){if(Re(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(e){var n,s,a,l;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(l=e.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;switch(n){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(e){var n,s,a,l,c,d,h,f,p,m,y;let _,x;if("message"in e)_=e.message,x=e.signature;else{const{chain:w,wallet:A,statement:S,options:T}=e;let E;if(Jt())if(typeof A=="object")E=A;else{const q=window;if("ethereum"in q&&typeof q.ethereum=="object"&&"request"in q.ethereum&&typeof q.ethereum.request=="function")E=q.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof A!="object"||!T?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=A}const C=new URL((n=T?.url)!==null&&n!==void 0?n:window.location.href),j=await E.request({method:"eth_requestAccounts"}).then(q=>q).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!j||j.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const O=sE(j[0]);let M=(s=T?.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!M){const q=await E.request({method:"eth_chainId"});M=b2(q)}const D={domain:C.host,address:O,statement:S,uri:C.href,version:"1",chainId:M,nonce:(a=T?.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(c=(l=T?.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(d=T?.signInWithEthereum)===null||d===void 0?void 0:d.expirationTime,notBefore:(h=T?.signInWithEthereum)===null||h===void 0?void 0:h.notBefore,requestId:(f=T?.signInWithEthereum)===null||f===void 0?void 0:f.requestId,resources:(p=T?.signInWithEthereum)===null||p===void 0?void 0:p.resources};_=x2(D),x=await E.request({method:"personal_sign",params:[w2(_),O]})}try{const{data:w,error:A}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:_,signature:x},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:Wn});if(A)throw A;if(!w||!w.session||!w.user){const S=new _a;return this._returnResult({data:{user:null,session:null},error:S})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:A})}catch(w){if(Re(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async signInWithSolana(e){var n,s,a,l,c,d,h,f,p,m,y,_;let x,w;if("message"in e)x=e.message,w=e.signature;else{const{chain:A,wallet:S,statement:T,options:E}=e;let C;if(Jt())if(typeof S=="object")C=S;else{const O=window;if("solana"in O&&typeof O.solana=="object"&&("signIn"in O.solana&&typeof O.solana.signIn=="function"||"signMessage"in O.solana&&typeof O.solana.signMessage=="function"))C=O.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!E?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=S}const j=new URL((n=E?.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in C&&C.signIn){const O=await C.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},E?.signInWithSolana),{version:"1",domain:j.host,uri:j.href}),T?{statement:T}:null));let M;if(Array.isArray(O)&&O[0]&&typeof O[0]=="object")M=O[0];else if(O&&typeof O=="object"&&"signedMessage"in O&&"signature"in O)M=O;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in M&&"signature"in M&&(typeof M.signedMessage=="string"||M.signedMessage instanceof Uint8Array)&&M.signature instanceof Uint8Array)x=typeof M.signedMessage=="string"?M.signedMessage:new TextDecoder().decode(M.signedMessage),w=M.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in C)||typeof C.signMessage!="function"||!("publicKey"in C)||typeof C!="object"||!C.publicKey||!("toBase58"in C.publicKey)||typeof C.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${j.host} wants you to sign in with your Solana account:`,C.publicKey.toBase58(),...T?["",T,""]:[""],"Version: 1",`URI: ${j.href}`,`Issued At: ${(a=(s=E?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((l=E?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${E.signInWithSolana.notBefore}`]:[],...!((c=E?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${E.signInWithSolana.expirationTime}`]:[],...!((d=E?.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${E.signInWithSolana.chainId}`]:[],...!((h=E?.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${E.signInWithSolana.nonce}`]:[],...!((f=E?.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${E.signInWithSolana.requestId}`]:[],...!((m=(p=E?.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||m===void 0)&&m.length?["Resources",...E.signInWithSolana.resources.map(M=>`- ${M}`)]:[]].join(`
`);const O=await C.signMessage(new TextEncoder().encode(x),"utf8");if(!O||!(O instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=O}}try{const{data:A,error:S}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:pi(w)},!((y=e.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(_=e.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:Wn});if(S)throw S;if(!A||!A.session||!A.user){const T=new _a;return this._returnResult({data:{user:null,session:null},error:T})}return A.session&&(await this._saveSession(A.session),await this._notifyAllSubscribers("SIGNED_IN",A.session)),this._returnResult({data:Object.assign({},A),error:S})}catch(A){if(Re(A))return this._returnResult({data:{user:null,session:null},error:A});throw A}}async _exchangeCodeForSession(e){const n=await oi(this.storage,`${this.storageKey}-code-verifier`),[s,a]=(n??"").split("/");try{const{data:l,error:c}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Wn});if(await Ns(this.storage,`${this.storageKey}-code-verifier`),c)throw c;if(!l||!l.session||!l.user){const d=new _a;return this._returnResult({data:{user:null,session:null,redirectType:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:a??null}),error:c})}catch(l){if(Re(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(e){try{const{options:n,provider:s,token:a,access_token:l,nonce:c}=e,d=await Be(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:a,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:n?.captchaToken}},xform:Wn}),{data:h,error:f}=d;if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!h||!h.session||!h.user){const p=new _a;return this._returnResult({data:{user:null,session:null},error:p})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:h,error:f})}catch(n){if(Re(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(e){var n,s,a,l,c;try{if("email"in e){const{email:d,options:h}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await ba(this.storage,this.storageKey));const{error:m}=await Be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(n=h?.data)!==null&&n!==void 0?n:{},create_user:(s=h?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:f,code_challenge_method:p},redirectTo:h?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:m})}if("phone"in e){const{phone:d,options:h}=e,{data:f,error:p}=await Be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(a=h?.data)!==null&&a!==void 0?a:{},create_user:(l=h?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},channel:(c=h?.channel)!==null&&c!==void 0?c:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:f?.message_id},error:p})}throw new Lu("You must provide either an email or phone number.")}catch(d){if(Re(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async verifyOtp(e){var n,s;try{let a,l;"options"in e&&(a=(n=e.options)===null||n===void 0?void 0:n.redirectTo,l=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:c,error:d}=await Be(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:l}}),redirectTo:a,xform:Wn});if(d)throw d;if(!c)throw new Error("An error occurred on token verification.");const h=c.session,f=c.user;return h?.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),this._returnResult({data:{user:f,session:h},error:null})}catch(a){if(Re(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(e){var n,s,a;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await ba(this.storage,this.storageKey));const d=await Be(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&s!==void 0?s:void 0}),!((a=e?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:h2});return this._returnResult(d)}catch(l){if(Re(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;if(s)throw s;if(!n)throw new Kn;const{error:a}=await Be(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(e){if(Re(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:s,type:a,options:l}=e,{error:c}=await Be(this.fetch,"POST",n,{headers:this.headers,body:{email:s,type:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:c})}else if("phone"in e){const{phone:s,type:a,options:l}=e,{data:c,error:d}=await Be(this.fetch,"POST",n,{headers:this.headers,body:{phone:s,type:a,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:c?.message_id},error:d})}throw new Lu("You must provide either an email or phone number and a type")}catch(n){if(Re(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await s,await n()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=n();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await oi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<Wm:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const c=await oi(this.userStorage,this.storageKey+"-user");c?.user?e.user=c.user:e.user=ep()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const c={value:this.suppressGetSessionWarning};e.user=c2(e.user,c),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ds}):await this._useSession(async n=>{var s,a,l;const{data:c,error:d}=n;if(d)throw d;return!(!((s=c.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Kn}:await Be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(a=c.session)===null||a===void 0?void 0:a.access_token)!==null&&l!==void 0?l:void 0,xform:Ds})})}catch(n){if(Re(n))return PO(n)&&(await this._removeSession(),await Ns(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async s=>{const{data:a,error:l}=s;if(l)throw l;if(!a.session)throw new Kn;const c=a.session;let d=null,h=null;this.flowType==="pkce"&&e.email!=null&&([d,h]=await ba(this.storage,this.storageKey));const{data:f,error:p}=await Be(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:d,code_challenge_method:h}),jwt:c.access_token,xform:Ds});if(p)throw p;return c.user=f.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),this._returnResult({data:{user:c.user},error:null})})}catch(s){if(Re(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Kn;const n=Date.now()/1e3;let s=n,a=!0,l=null;const{payload:c}=Zm(e.access_token);if(c.exp&&(s=c.exp,a=s<=n),a){const{data:d,error:h}=await this._callRefreshToken(e.refresh_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!d)return{data:{user:null,session:null},error:null};l=d}else{const{data:d,error:h}=await this._getUser(e.access_token);if(h)throw h;l={access_token:e.access_token,refresh_token:e.refresh_token,user:d.user,token_type:"bearer",expires_in:s-n,expires_at:s},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(n){if(Re(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var s;if(!e){const{data:c,error:d}=n;if(d)throw d;e=(s=c.session)!==null&&s!==void 0?s:void 0}if(!e?.refresh_token)throw new Kn;const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(Re(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(e,n){try{if(!Jt())throw new $u("No browser detected.");if(e.error||e.error_description||e.error_code)throw new $u(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Bb("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new $u("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Bb("No code detected.");const{data:T,error:E}=await this._exchangeCodeForSession(e.code);if(E)throw E;const C=new URL(window.location.href);return C.searchParams.delete("code"),window.history.replaceState(window.history.state,"",C.toString()),{data:{session:T.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:a,access_token:l,refresh_token:c,expires_in:d,expires_at:h,token_type:f}=e;if(!l||!d||!c||!f)throw new $u("No session defined in URL");const p=Math.round(Date.now()/1e3),m=parseInt(d);let y=p+m;h&&(y=parseInt(h));const _=y-p;_*1e3<=Ra&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${m}s`);const x=y-m;p-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,y,p):p-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,y,p);const{data:w,error:A}=await this._getUser(l);if(A)throw A;const S={provider_token:s,provider_refresh_token:a,access_token:l,expires_in:m,expires_at:y,refresh_token:c,token_type:f,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:S,redirectType:e.type},error:null})}catch(s){if(Re(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await oi(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var s;const{data:a,error:l}=n;if(l)return this._returnResult({error:l});const c=(s=a.session)===null||s===void 0?void 0:s.access_token;if(c){const{error:d}=await this.admin.signOut(c,e);if(d&&!(zO(d)&&(d.status===404||d.status===401||d.status===403)))return this._returnResult({error:d})}return e!=="others"&&(await this._removeSession(),await Ns(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const n=XO(),s={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async n=>{var s,a;try{const{data:{session:l},error:c}=n;if(c)throw c;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",e,"session",l)}catch(l){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",l),console.error(l)}})}async resetPasswordForEmail(e,n={}){let s=null,a=null;this.flowType==="pkce"&&([s,a]=await ba(this.storage,this.storageKey,!0));try{return await Be(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:a,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(l){if(Re(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var e;try{const{data:n,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var n;try{const{data:s,error:a}=await this._useSession(async l=>{var c,d,h,f,p;const{data:m,error:y}=l;if(y)throw y;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(d=e.options)===null||d===void 0?void 0:d.scopes,queryParams:(h=e.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await Be(this.fetch,"GET",_,{headers:this.headers,jwt:(p=(f=m.session)===null||f===void 0?void 0:f.access_token)!==null&&p!==void 0?p:void 0})});if(a)throw a;return Jt()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(s?.url),this._returnResult({data:{provider:e.provider,url:s?.url},error:null})}catch(s){if(Re(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async n=>{var s;try{const{error:a,data:{session:l}}=n;if(a)throw a;const{options:c,provider:d,token:h,access_token:f,nonce:p}=e,m=await Be(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=l?.access_token)!==null&&s!==void 0?s:void 0,body:{provider:d,id_token:h,access_token:f,nonce:p,link_identity:!0,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Wn}),{data:y,error:_}=m;return _?this._returnResult({data:{user:null,session:null},error:_}):!y||!y.session||!y.user?this._returnResult({data:{user:null,session:null},error:new _a}):(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("USER_UPDATED",y.session)),this._returnResult({data:y,error:_}))}catch(a){if(Re(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(e){try{return await this._useSession(async n=>{var s,a;const{data:l,error:c}=n;if(c)throw c;return await Be(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(s=l.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0})})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const s=Date.now();return await ZO(async a=>(a>0&&await JO(200*Math.pow(2,a-1)),this._debug(n,"refreshing attempt",a),await Be(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Wn})),(a,l)=>{const c=200*Math.pow(2,a);return l&&Jm(l)&&Date.now()+c-s<Ra})}catch(s){if(this._debug(n,"error",s),Re(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",s),Jt()&&!n.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,n;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const a=await oi(this.storage,this.storageKey);if(a&&this.userStorage){let c=await oi(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:a.user},await ja(this.userStorage,this.storageKey+"-user",c)),a.user=(e=c?.user)!==null&&e!==void 0?e:ep()}else if(a&&!a.user&&!a.user){const c=await oi(this.storage,this.storageKey+"-user");c&&c?.user?(a.user=c.user,await Ns(this.storage,this.storageKey+"-user"),await ja(this.storage,this.storageKey,a)):a.user=ep()}if(this._debug(s,"session from storage",a),!this._isValidSession(a)){this._debug(s,"session is not valid"),a!==null&&await this._removeSession();return}const l=((n=a.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Wm;if(this._debug(s,`session has${l?"":" not"} expired with margin of ${Wm}s`),l){if(this.autoRefreshToken&&a.refresh_token){const{error:c}=await this._callRefreshToken(a.refresh_token);c&&(console.error(c),Jm(c)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:d}=await this._getUser(a.access_token);!d&&c?.user?(a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(s,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(s,"error",a),console.error(a);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var n,s;if(!e)throw new Kn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Zd;const{data:l,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!l.session)throw new Kn;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const d={data:l.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(l){if(this._debug(a,"error",l),Re(l)){const c={data:null,error:l};return Jm(l)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(c),c}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(l),l}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,n,s=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",n,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:n});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(e,n)}catch(h){l.push(h)}});if(await Promise.all(c),l.length>0){for(let d=0;d<l.length;d+=1)console.error(l[d]);throw l[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),s=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&n.user&&await ja(this.userStorage,this.storageKey+"-user",{user:n.user});const a=Object.assign({},n);delete a.user;const l=Pb(a);await ja(this.storage,this.storageKey,l)}else{const a=Pb(n);await ja(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await Ns(this.storage,this.storageKey),await Ns(this.storage,this.storageKey+"-code-verifier"),await Ns(this.storage,this.storageKey+"-user"),this.userStorage&&await Ns(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Jt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ra);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:s}}=n;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((s.expires_at*1e3-e)/Ra);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Ra}ms, refresh threshold is ${Up} ticks`),a<=Up&&await this._callRefreshToken(s.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof rE)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Jt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,s){const a=[`provider=${encodeURIComponent(n)}`];if(s?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&a.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[l,c]=await ba(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});a.push(d.toString())}if(s?.queryParams){const l=new URLSearchParams(s.queryParams);a.push(l.toString())}return s?.skipBrowserRedirect&&a.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var s;const{data:a,error:l}=n;return l?this._returnResult({data:null,error:l}):await Be(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token})})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(e){try{return await this._useSession(async n=>{var s,a;const{data:l,error:c}=n;if(c)return this._returnResult({data:null,error:c});const d=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:h,error:f}=await Be(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(s=l?.session)===null||s===void 0?void 0:s.access_token});return f?this._returnResult({data:null,error:f}):(e.factorType==="totp"&&h.type==="totp"&&(!((a=h?.totp)===null||a===void 0)&&a.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:a,error:l}=n;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?R2(e.webauthn.credential_response):j2(e.webauthn.credential_response)})}:{code:e.code}),{data:d,error:h}=await Be(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:c,headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token});return h?this._returnResult({data:null,error:h}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),this._returnResult({data:d,error:h}))})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:a,error:l}=n;if(l)return this._returnResult({data:null,error:l});const c=await Be(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token});if(c.error)return c;const{data:d}=c;if(d.type!=="webauthn")return{data:d,error:null};switch(d.webauthn.type){case"create":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:T2(d.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:N2(d.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(e){const{data:n,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){var e;const{data:{user:n},error:s}=await this.getUser();if(s)return{data:null,error:s};const a={all:[],phone:[],totp:[],webauthn:[]};for(const l of(e=n?.factors)!==null&&e!==void 0?e:[])a.all.push(l),l.status==="verified"&&a[l.factor_type].push(l);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var e,n;const{data:{session:s},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=Zm(s.access_token);let c=null;l.aal&&(c=l.aal);let d=c;((n=(e=s.user.factors)===null||e===void 0?void 0:e.filter(p=>p.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(d="aal2");const f=l.amr||[];return{data:{currentLevel:c,nextLevel:d,currentAuthenticationMethods:f},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async n=>{const{data:{session:s},error:a}=n;return a?this._returnResult({data:null,error:a}):s?await Be(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new Kn})})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(e,n){try{return await this._useSession(async s=>{const{data:{session:a},error:l}=s;if(l)return this._returnResult({data:null,error:l});if(!a)return this._returnResult({data:null,error:new Kn});const c=await Be(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:d=>({data:d,error:null})});return c.data&&c.data.redirect_url&&Jt()&&!n?.skipBrowserRedirect&&window.location.assign(c.data.redirect_url),c})}catch(s){if(Re(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,n){try{return await this._useSession(async s=>{const{data:{session:a},error:l}=s;if(l)return this._returnResult({data:null,error:l});if(!a)return this._returnResult({data:null,error:new Kn});const c=await Be(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:d=>({data:d,error:null})});return c.data&&c.data.redirect_url&&Jt()&&!n?.skipBrowserRedirect&&window.location.assign(c.data.redirect_url),c})}catch(s){if(Re(s))return this._returnResult({data:null,error:s});throw s}}async fetchJwk(e,n={keys:[]}){let s=n.keys.find(d=>d.kid===e);if(s)return s;const a=Date.now();if(s=this.jwks.keys.find(d=>d.kid===e),s&&this.jwks_cached_at+LO>a)return s;const{data:l,error:c}=await Be(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=a,s=l.keys.find(d=>d.kid===e),!s)?null:s}async getClaims(e,n={}){try{let s=e;if(!s){const{data:_,error:x}=await this.getSession();if(x||!_.session)return this._returnResult({data:null,error:x});s=_.session.access_token}const{header:a,payload:l,signature:c,raw:{header:d,payload:h}}=Zm(s);n?.allowExpired||a2(l.exp);const f=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,n?.keys?{keys:n.keys}:n?.jwks);if(!f){const{error:_}=await this.getUser(s);if(_)throw _;return{data:{claims:l,header:a,signature:c},error:null}}const p=o2(a.alg),m=await crypto.subtle.importKey("jwk",f,p,!0,["verify"]);if(!await crypto.subtle.verify(p,m,c,GO(`${d}.${h}`)))throw new zp("Invalid JWT signature");return{data:{claims:l,header:a,signature:c},error:null}}catch(s){if(Re(s))return this._returnResult({data:null,error:s});throw s}}}Il.nextInstanceID=0;const $2=Il;class z2 extends $2{constructor(e){super(e)}}class P2{constructor(e,n,s){var a,l,c;this.supabaseUrl=e,this.supabaseKey=n;const d=kO(e);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const h=`sb-${d.hostname.split(".")[0]}-auth-token`,f={db:SO,realtime:TO,auth:Object.assign(Object.assign({},CO),{storageKey:h}),global:EO},p=IO(s??{},f);this.storageKey=(a=p.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(l=p.global.headers)!==null&&l!==void 0?l:{},p.accessToken?(this.accessToken=p.accessToken,this.auth=new Proxy({},{get:(m,y)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(y)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=p.auth)!==null&&c!==void 0?c:{},this.headers,p.global.fetch),this.fetch=jO(n,this._getAccessToken.bind(this),p.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},p.realtime)),this.rest=new Mj(new URL("rest/v1",d).href,{headers:this.headers,schema:p.db.schema,fetch:this.fetch}),this.storage=new wO(this.storageUrl.href,this.headers,this.fetch,s?.storage),p.accessToken||this._listenForAuthEvents()}get functions(){return new jj(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,n,s)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,n;if(this.accessToken)return await this.accessToken();const{data:s}=await this.auth.getSession();return(n=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:s,storage:a,userStorage:l,storageKey:c,flowType:d,lock:h,debug:f,throwOnError:p},m,y){const _={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new z2({url:this.authUrl.href,headers:Object.assign(Object.assign({},_),m),storageKey:c,autoRefreshToken:e,persistSession:n,detectSessionInUrl:s,storage:a,userStorage:l,flowType:d,lock:h,debug:f,throwOnError:p,fetch:y,hasCustomAuthorizationHeader:Object.keys(this.headers).some(x=>x.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Wj(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,s)=>{this._handleTokenChanged(n,"CLIENT",s?.access_token)})}_handleTokenChanged(e,n,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const H2=(t,e,n)=>new P2(t,e,n);function q2(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}q2()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");var zu={exports:{}},Yb;function Q2(){if(Yb)return zu.exports;Yb=1;var t=typeof Reflect=="object"?Reflect:null,e=t&&typeof t.apply=="function"?t.apply:function(j,O,M){return Function.prototype.apply.call(j,O,M)},n;t&&typeof t.ownKeys=="function"?n=t.ownKeys:Object.getOwnPropertySymbols?n=function(j){return Object.getOwnPropertyNames(j).concat(Object.getOwnPropertySymbols(j))}:n=function(j){return Object.getOwnPropertyNames(j)};function s(C){console&&console.warn&&console.warn(C)}var a=Number.isNaN||function(j){return j!==j};function l(){l.init.call(this)}zu.exports=l,zu.exports.once=S,l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var c=10;function d(C){if(typeof C!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof C)}Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(C){if(typeof C!="number"||C<0||a(C))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+C+".");c=C}}),l.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(j){if(typeof j!="number"||j<0||a(j))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+j+".");return this._maxListeners=j,this};function h(C){return C._maxListeners===void 0?l.defaultMaxListeners:C._maxListeners}l.prototype.getMaxListeners=function(){return h(this)},l.prototype.emit=function(j){for(var O=[],M=1;M<arguments.length;M++)O.push(arguments[M]);var D=j==="error",q=this._events;if(q!==void 0)D=D&&q.error===void 0;else if(!D)return!1;if(D){var G;if(O.length>0&&(G=O[0]),G instanceof Error)throw G;var V=new Error("Unhandled error."+(G?" ("+G.message+")":""));throw V.context=G,V}var F=q[j];if(F===void 0)return!1;if(typeof F=="function")e(F,this,O);else for(var K=F.length,$=x(F,K),M=0;M<K;++M)e($[M],this,O);return!0};function f(C,j,O,M){var D,q,G;if(d(O),q=C._events,q===void 0?(q=C._events=Object.create(null),C._eventsCount=0):(q.newListener!==void 0&&(C.emit("newListener",j,O.listener?O.listener:O),q=C._events),G=q[j]),G===void 0)G=q[j]=O,++C._eventsCount;else if(typeof G=="function"?G=q[j]=M?[O,G]:[G,O]:M?G.unshift(O):G.push(O),D=h(C),D>0&&G.length>D&&!G.warned){G.warned=!0;var V=new Error("Possible EventEmitter memory leak detected. "+G.length+" "+String(j)+" listeners added. Use emitter.setMaxListeners() to increase limit");V.name="MaxListenersExceededWarning",V.emitter=C,V.type=j,V.count=G.length,s(V)}return C}l.prototype.addListener=function(j,O){return f(this,j,O,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(j,O){return f(this,j,O,!0)};function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function m(C,j,O){var M={fired:!1,wrapFn:void 0,target:C,type:j,listener:O},D=p.bind(M);return D.listener=O,M.wrapFn=D,D}l.prototype.once=function(j,O){return d(O),this.on(j,m(this,j,O)),this},l.prototype.prependOnceListener=function(j,O){return d(O),this.prependListener(j,m(this,j,O)),this},l.prototype.removeListener=function(j,O){var M,D,q,G,V;if(d(O),D=this._events,D===void 0)return this;if(M=D[j],M===void 0)return this;if(M===O||M.listener===O)--this._eventsCount===0?this._events=Object.create(null):(delete D[j],D.removeListener&&this.emit("removeListener",j,M.listener||O));else if(typeof M!="function"){for(q=-1,G=M.length-1;G>=0;G--)if(M[G]===O||M[G].listener===O){V=M[G].listener,q=G;break}if(q<0)return this;q===0?M.shift():w(M,q),M.length===1&&(D[j]=M[0]),D.removeListener!==void 0&&this.emit("removeListener",j,V||O)}return this},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(j){var O,M,D;if(M=this._events,M===void 0)return this;if(M.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):M[j]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete M[j]),this;if(arguments.length===0){var q=Object.keys(M),G;for(D=0;D<q.length;++D)G=q[D],G!=="removeListener"&&this.removeAllListeners(G);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(O=M[j],typeof O=="function")this.removeListener(j,O);else if(O!==void 0)for(D=O.length-1;D>=0;D--)this.removeListener(j,O[D]);return this};function y(C,j,O){var M=C._events;if(M===void 0)return[];var D=M[j];return D===void 0?[]:typeof D=="function"?O?[D.listener||D]:[D]:O?A(D):x(D,D.length)}l.prototype.listeners=function(j){return y(this,j,!0)},l.prototype.rawListeners=function(j){return y(this,j,!1)},l.listenerCount=function(C,j){return typeof C.listenerCount=="function"?C.listenerCount(j):_.call(C,j)},l.prototype.listenerCount=_;function _(C){var j=this._events;if(j!==void 0){var O=j[C];if(typeof O=="function")return 1;if(O!==void 0)return O.length}return 0}l.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function x(C,j){for(var O=new Array(j),M=0;M<j;++M)O[M]=C[M];return O}function w(C,j){for(;j+1<C.length;j++)C[j]=C[j+1];C.pop()}function A(C){for(var j=new Array(C.length),O=0;O<j.length;++O)j[O]=C[O].listener||C[O];return j}function S(C,j){return new Promise(function(O,M){function D(G){C.removeListener(j,q),M(G)}function q(){typeof C.removeListener=="function"&&C.removeListener("error",D),O([].slice.call(arguments))}E(C,j,q,{once:!0}),j!=="error"&&T(C,D,{once:!0})})}function T(C,j,O){typeof C.on=="function"&&E(C,"error",j,O)}function E(C,j,O,M){if(typeof C.on=="function")M.once?C.once(j,O):C.on(j,O);else if(typeof C.addEventListener=="function")C.addEventListener(j,function D(q){M.once&&C.removeEventListener(j,D),O(q)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof C)}return zu.exports}var F2=Q2();const V2=Fl(F2),Rt=new V2,aE="https://gsyznlwsezhwerypyzbe.supabase.co",G2="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdzeXpubHdzZXpod2VyeXB5emJlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ2MTYwMzYsImV4cCI6MjA4MDE5MjAzNn0.vLLiGKSTADkaOsUX8386m2MFIJl1Gx-EB4gQLLOAZGA",gi=aE+"/storage/v1/object/public/embodys/",je=H2(aE,G2);var li={},Ea={},np={},Wo={},Xb;function oE(){return Xb||(Xb=1,(function(t){var e=Wo&&Wo.__awaiter||function(a,l,c,d){function h(f){return f instanceof c?f:new c(function(p){p(f)})}return new(c||(c=Promise))(function(f,p){function m(x){try{_(d.next(x))}catch(w){p(w)}}function y(x){try{_(d.throw(x))}catch(w){p(w)}}function _(x){x.done?f(x.value):h(x.value).then(m,y)}_((d=d.apply(a,l||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.TARGET_URL_HEADER=void 0,t.withMiddleware=n,t.withProxy=s;function n(...a){const l=c=>typeof c=="function";return c=>e(this,void 0,void 0,function*(){let d=Object.assign({},c);for(const h of a.filter(l))d=yield h(d);return d})}t.TARGET_URL_HEADER="x-fal-target-url";function s(a){const l=c=>Promise.resolve(c);return typeof window>"u"?l:c=>c.headers&&t.TARGET_URL_HEADER in c?l(c):Promise.resolve(Object.assign(Object.assign({},c),{url:a.targetUrl,headers:Object.assign(Object.assign({},c.headers||{}),{[t.TARGET_URL_HEADER]:c.url})}))}})(Wo)),Wo}var Xn={},Kb;function Ni(){if(Kb)return Xn;Kb=1;var t=Xn&&Xn.__awaiter||function(c,d,h,f){function p(m){return m instanceof h?m:new h(function(y){y(m)})}return new(h||(h=Promise))(function(m,y){function _(A){try{w(f.next(A))}catch(S){y(S)}}function x(A){try{w(f.throw(A))}catch(S){y(S)}}function w(A){A.done?m(A.value):p(A.value).then(_,x)}w((f=f.apply(c,d||[])).next())})};Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.ValidationError=Xn.ApiError=void 0,Xn.defaultResponseHandler=a,Xn.resultResponseHandler=l;const e="x-fal-request-id";class n extends Error{constructor({message:d,status:h,body:f,requestId:p}){super(d),this.name="ApiError",this.status=h,this.body=f,this.requestId=p||""}}Xn.ApiError=n;class s extends n{constructor(d){super(d),this.name="ValidationError"}get fieldErrors(){return typeof this.body.detail=="string"?[{loc:["body"],msg:this.body.detail,type:"value_error"}]:this.body.detail||[]}getFieldErrors(d){return this.fieldErrors.filter(h=>h.loc[h.loc.length-1]===d)}}Xn.ValidationError=s;function a(c){return t(this,void 0,void 0,function*(){var d;const{status:h,statusText:f}=c,p=(d=c.headers.get("Content-Type"))!==null&&d!==void 0?d:"",m=c.headers.get(e)||void 0;if(!c.ok){if(p.includes("application/json")){const y=yield c.json(),_=h===422?s:n;throw new _({message:y.message||f,status:h,body:y,requestId:m})}throw new n({message:`HTTP ${h}: ${f}`,status:h,requestId:m})}return p.includes("application/json")?c.json():p.includes("text/html")?c.text():p.includes("application/octet-stream")?c.arrayBuffer():c.text()})}function l(c){return t(this,void 0,void 0,function*(){return{data:yield a(c),requestId:c.headers.get(e)||""}})}return Xn}var Jo={},Hn={},Wb;function Ri(){if(Wb)return Hn;Wb=1;var t=Hn&&Hn.__awaiter||function(p,m,y,_){function x(w){return w instanceof y?w:new y(function(A){A(w)})}return new(y||(y=Promise))(function(w,A){function S(C){try{E(_.next(C))}catch(j){A(j)}}function T(C){try{E(_.throw(C))}catch(j){A(j)}}function E(C){C.done?w(C.value):x(C.value).then(S,T)}E((_=_.apply(p,m||[])).next())})};Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.ensureEndpointIdFormat=e,Hn.parseEndpointId=s,Hn.isValidUrl=a,Hn.throttle=l,Hn.isReact=d,Hn.isPlainObject=h,Hn.sleep=f;function e(p){if(p.split("/").length>1)return p;const[,y,_]=/^([0-9]+)-([a-zA-Z0-9-]+)$/.exec(p)||[];if(y&&_)return`${y}/${_}`;throw new Error(`Invalid app id: ${p}. Must be in the format <appOwner>/<appId>`)}const n=["workflows","comfy"];function s(p){const y=e(p).split("/");return n.includes(y[0])?{owner:y[1],alias:y[2],path:y.slice(3).join("/")||void 0,namespace:y[0]}:{owner:y[0],alias:y[1],path:y.slice(2).join("/")||void 0}}function a(p){try{const{host:m}=new URL(p);return/(fal\.(ai|run))$/.test(m)}catch{return!1}}function l(p,m,y=!1){let _,x;return(...w)=>{!x&&y?(p(...w),x=Date.now()):(_&&clearTimeout(_),_=setTimeout(()=>{Date.now()-x>=m&&(p(...w),x=Date.now())},m-(Date.now()-x)))}}let c;function d(){if(c===void 0){const p=new Error().stack;c=!!p&&(p.includes("node_modules/react-dom/")||p.includes("node_modules/next/"))}return c}function h(p){return!!p&&Object.getPrototypeOf(p)===Object.prototype}function f(p){return t(this,void 0,void 0,function*(){return new Promise(m=>setTimeout(m,p))})}return Hn}var Jb;function ef(){return Jb||(Jb=1,(function(t){var e=Jo&&Jo.__awaiter||function(d,h,f,p){function m(y){return y instanceof f?y:new f(function(_){_(y)})}return new(f||(f=Promise))(function(y,_){function x(S){try{A(p.next(S))}catch(T){_(T)}}function w(S){try{A(p.throw(S))}catch(T){_(T)}}function A(S){S.done?y(S.value):m(S.value).then(x,w)}A((p=p.apply(d,h||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_RETRY_OPTIONS=t.DEFAULT_RETRYABLE_STATUS_CODES=void 0,t.isRetryableError=a,t.calculateBackoffDelay=l,t.executeWithRetry=c;const n=Ni(),s=Ri();t.DEFAULT_RETRYABLE_STATUS_CODES=[429,502,503,504],t.DEFAULT_RETRY_OPTIONS={maxRetries:3,baseDelay:1e3,maxDelay:3e4,backoffMultiplier:2,retryableStatusCodes:t.DEFAULT_RETRYABLE_STATUS_CODES,enableJitter:!0};function a(d,h){return d instanceof n.ApiError&&h.includes(d.status)}function l(d,h,f,p,m){const y=Math.min(h*Math.pow(p,d),f);if(m){const _=.25*y*(Math.random()*2-1);return Math.max(0,y+_)}return y}function c(d,h,f){return e(this,void 0,void 0,function*(){const p={totalAttempts:0,totalDelay:0};let m;for(let y=0;y<=h.maxRetries;y++){p.totalAttempts++;try{return{result:yield d(),metrics:p}}catch(_){if(m=_,p.lastError=_,y===h.maxRetries||!a(_,h.retryableStatusCodes))throw _;const x=l(y,h.baseDelay,h.maxDelay,h.backoffMultiplier,h.enableJitter);p.totalDelay+=x,f&&f(y+1,_,x),yield(0,s.sleep)(x)}}throw m})}})(Jo)),Jo}var Zo={};const Y2="@fal-ai/client",X2="1.7.2",K2={name:Y2,version:X2};var Zb;function Og(){if(Zb)return Zo;Zb=1,Object.defineProperty(Zo,"__esModule",{value:!0}),Zo.isBrowser=t,Zo.getUserAgent=n;function t(){return typeof window<"u"&&typeof window.document<"u"}let e=null;function n(){if(e!==null)return e;const s=K2;return e=`${s.name}/${s.version}`,e}return Zo}var ew;function Ig(){return ew||(ew=1,(function(t){var e={};Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsFromEnv=void 0,t.resolveDefaultFetch=c,t.createConfig=p,t.getRestApiUrl=m;const n=oE(),s=Ni(),a=ef(),l=Og();function c(){if(typeof fetch>"u")throw new Error("Your environment does not support fetch. Please provide your own fetch implementation.");return fetch}function d(){return typeof process<"u"&&e&&(typeof e.FAL_KEY<"u"||typeof e.FAL_KEY_ID<"u"&&typeof e.FAL_KEY_SECRET<"u")}const h=()=>{if(d())return typeof e.FAL_KEY<"u"?e.FAL_KEY:e.FAL_KEY_ID?`${e.FAL_KEY_ID}:${e.FAL_KEY_SECRET}`:void 0};t.credentialsFromEnv=h;const f={credentials:t.credentialsFromEnv,suppressLocalCredentialsWarning:!1,requestMiddleware:y=>Promise.resolve(y),responseHandler:s.defaultResponseHandler,retry:a.DEFAULT_RETRY_OPTIONS};function p(y){var _;let x=Object.assign(Object.assign(Object.assign({},f),y),{fetch:(_=y.fetch)!==null&&_!==void 0?_:c(),retry:Object.assign(Object.assign({},a.DEFAULT_RETRY_OPTIONS),y.retry||{})});y.proxyUrl&&(x=Object.assign(Object.assign({},x),{requestMiddleware:(0,n.withMiddleware)(x.requestMiddleware,(0,n.withProxy)({targetUrl:y.proxyUrl}))}));const{credentials:w,suppressLocalCredentialsWarning:A}=x,S=typeof w=="function"?w():w;return(0,l.isBrowser)()&&S&&!A&&console.warn("The fal credentials are exposed in the browser's environment. That's not recommended for production use cases."),x}function m(){return"https://rest.alpha.fal.ai"}})(np)),np}var Pr={},Hr={},tw;function Wl(){if(tw)return Hr;tw=1;var t=Hr&&Hr.__awaiter||function(h,f,p,m){function y(_){return _ instanceof p?_:new p(function(x){x(_)})}return new(p||(p=Promise))(function(_,x){function w(T){try{S(m.next(T))}catch(E){x(E)}}function A(T){try{S(m.throw(T))}catch(E){x(E)}}function S(T){T.done?_(T.value):y(T.value).then(w,A)}S((m=m.apply(h,f||[])).next())})},e=Hr&&Hr.__rest||function(h,f){var p={};for(var m in h)Object.prototype.hasOwnProperty.call(h,m)&&f.indexOf(m)<0&&(p[m]=h[m]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,m=Object.getOwnPropertySymbols(h);y<m.length;y++)f.indexOf(m[y])<0&&Object.prototype.propertyIsEnumerable.call(h,m[y])&&(p[m[y]]=h[m[y]]);return p};Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.dispatchRequest=c,Hr.buildUrl=d;const n=ef(),s=Og(),a=Ri(),l=typeof navigator<"u"&&navigator?.userAgent==="Cloudflare-Workers";function c(h){return t(this,void 0,void 0,function*(){var f;const{targetUrl:p,input:m,config:y,options:_={}}=h,{credentials:x,requestMiddleware:w,responseHandler:A,fetch:S}=y,T=Object.assign(Object.assign({},y.retry),_.retry||{}),E=()=>t(this,void 0,void 0,function*(){var j,O,M;const D=(0,s.isBrowser)()?{}:{"User-Agent":(0,s.getUserAgent)()},q=typeof x=="function"?x():x,{method:G,url:V,headers:F}=yield w({method:((O=(j=h.method)!==null&&j!==void 0?j:_.method)!==null&&O!==void 0?O:"post").toUpperCase(),url:p,headers:h.headers}),K=q?{Authorization:`Key ${q}`}:{},$=Object.assign(Object.assign(Object.assign(Object.assign({},K),{Accept:"application/json","Content-Type":"application/json"}),D),F??{}),{responseHandler:Q,retry:R}=_,U=e(_,["responseHandler","retry"]),B=yield S(V,Object.assign(Object.assign(Object.assign(Object.assign({},U),{method:G,headers:Object.assign(Object.assign({},$),(M=U.headers)!==null&&M!==void 0?M:{})}),!l&&{mode:"cors"}),{signal:_.signal,body:G.toLowerCase()!=="get"&&m?JSON.stringify(m):void 0}));return yield(Q??A)(B)});let C;for(let j=0;j<=T.maxRetries;j++)try{return yield E()}catch(O){if(C=O,j===T.maxRetries||!(0,n.isRetryableError)(O,T.retryableStatusCodes)||((f=_.signal)===null||f===void 0?void 0:f.aborted))throw O;const D=(0,n.calculateBackoffDelay)(j,T.baseDelay,T.maxDelay,T.backoffMultiplier,T.enableJitter);yield(0,a.sleep)(D)}throw C})}function d(h,f={}){var p,m;const y=((p=f.method)!==null&&p!==void 0?p:"post").toLowerCase(),_=((m=f.path)!==null&&m!==void 0?m:"").replace(/^\//,"").replace(/\/{2,}/,"/"),x=f.input,w=Object.assign(Object.assign({},f.query||{}),y==="get"?x:{}),A=Object.keys(w).length>0?`?${new URLSearchParams(w).toString()}`:"";if((0,a.isValidUrl)(h))return`${h.endsWith("/")?h:`${h}/`}${_}${A}`;const S=(0,a.ensureEndpointIdFormat)(h);return`${`https://${f.subdomain?`${f.subdomain}.`:""}fal.run/${S}/${_}`.replace(/\/$/,"")}${A}`}return Hr}var qn={},Pu={},nw;function W2(){if(nw)return Pu;nw=1,Object.defineProperty(Pu,"__esModule",{value:!0});function t(s){let a,l,c,d,h,f,p;return m(),{feed:y,reset:m};function m(){a=!0,l="",c=0,d=-1,h=void 0,f=void 0,p=""}function y(x){l=l?l+x:x,a&&n(l)&&(l=l.slice(e.length)),a=!1;const w=l.length;let A=0,S=!1;for(;A<w;){S&&(l[A]===`
`&&++A,S=!1);let T=-1,E=d,C;for(let j=c;T<0&&j<w;++j)C=l[j],C===":"&&E<0?E=j-A:C==="\r"?(S=!0,T=j-A):C===`
`&&(T=j-A);if(T<0){c=w-A,d=E;break}else c=0,d=-1;_(l,A,E,T),A+=T+1}A===w?l="":A>0&&(l=l.slice(A))}function _(x,w,A,S){if(S===0){p.length>0&&(s({type:"event",id:h,event:f||void 0,data:p.slice(0,-1)}),p="",h=void 0),f=void 0;return}const T=A<0,E=x.slice(w,w+(T?S:A));let C=0;T?C=S:x[w+A+1]===" "?C=A+2:C=A+1;const j=w+C,O=S-C,M=x.slice(j,j+O).toString();if(E==="data")p+=M?"".concat(M,`
`):`
`;else if(E==="event")f=M;else if(E==="id"&&!M.includes("\0"))h=M;else if(E==="retry"){const D=parseInt(M,10);Number.isNaN(D)||s({type:"reconnect-interval",value:D})}}}const e=[239,187,191];function n(s){return e.every((a,l)=>s.charCodeAt(l)===a)}return Pu.createParser=t,Pu}var el={},rw;function lE(){return rw||(rw=1,(function(t){var e=el&&el.__awaiter||function(c,d,h,f){function p(m){return m instanceof h?m:new h(function(y){y(m)})}return new(h||(h=Promise))(function(m,y){function _(A){try{w(f.next(A))}catch(S){y(S)}}function x(A){try{w(f.throw(A))}catch(S){y(S)}}function w(A){A.done?m(A.value):p(A.value).then(_,x)}w((f=f.apply(c,d||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.TOKEN_EXPIRATION_SECONDS=void 0,t.getTemporaryAuthToken=l;const n=Ig(),s=Wl(),a=Ri();t.TOKEN_EXPIRATION_SECONDS=120;function l(c,d){return e(this,void 0,void 0,function*(){const h=(0,a.parseEndpointId)(c),f=yield(0,s.dispatchRequest)({method:"POST",targetUrl:`${(0,n.getRestApiUrl)()}/tokens/`,config:d,input:{allowed_apps:[h.alias],token_expiration:t.TOKEN_EXPIRATION_SECONDS}});return typeof f!="string"&&f.detail?f.detail:f})}})(el)),el}var sw;function cE(){if(sw)return qn;sw=1;var t=qn&&qn.__awaiter||function(m,y,_,x){function w(A){return A instanceof _?A:new _(function(S){S(A)})}return new(_||(_=Promise))(function(A,S){function T(j){try{C(x.next(j))}catch(O){S(O)}}function E(j){try{C(x.throw(j))}catch(O){S(O)}}function C(j){j.done?A(j.value):w(j.value).then(T,E)}C((x=x.apply(m,y||[])).next())})},e=qn&&qn.__await||function(m){return this instanceof e?(this.v=m,this):new e(m)},n=qn&&qn.__asyncGenerator||function(m,y,_){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var x=_.apply(m,y||[]),w,A=[];return w={},T("next"),T("throw"),T("return",S),w[Symbol.asyncIterator]=function(){return this},w;function S(D){return function(q){return Promise.resolve(q).then(D,O)}}function T(D,q){x[D]&&(w[D]=function(G){return new Promise(function(V,F){A.push([D,G,V,F])>1||E(D,G)})},q&&(w[D]=q(w[D])))}function E(D,q){try{C(x[D](q))}catch(G){M(A[0][3],G)}}function C(D){D.value instanceof e?Promise.resolve(D.value.v).then(j,O):M(A[0][2],D)}function j(D){E("next",D)}function O(D){E("throw",D)}function M(D,q){D(q),A.shift(),A.length&&E(A[0][0],A[0][1])}};Object.defineProperty(qn,"__esModule",{value:!0}),qn.FalStream=void 0,qn.createStreamingClient=p;const s=W2(),a=lE(),l=Wl(),c=Ni(),d="text/event-stream",h=15*1e3;class f{constructor(y,_,x){var w;this.listeners=new Map,this.buffer=[],this.currentData=void 0,this.lastEventTimestamp=0,this.streamClosed=!1,this._requestId=null,this.abortController=new AbortController,this.start=()=>t(this,void 0,void 0,function*(){var A,S;const{endpointId:T,options:E}=this,{input:C,method:j="post",connectionMode:O="server"}=E;try{if(O==="client"){const M=yield(0,a.getTemporaryAuthToken)(T,this.config),{fetch:D}=this.config,q=new URL(this.url);q.searchParams.set("fal_jwt_token",M);const G=yield D(q.toString(),{method:j.toUpperCase(),headers:{accept:(A=E.accept)!==null&&A!==void 0?A:d,"content-type":"application/json"},body:C&&j!=="get"?JSON.stringify(C):void 0,signal:this.abortController.signal});return this._requestId=G.headers.get("x-fal-request-id"),yield this.handleResponse(G)}return yield(0,l.dispatchRequest)({method:j.toUpperCase(),targetUrl:this.url,input:C,config:this.config,options:{headers:{accept:(S=E.accept)!==null&&S!==void 0?S:d},responseHandler:M=>t(this,void 0,void 0,function*(){return this._requestId=M.headers.get("x-fal-request-id"),yield this.handleResponse(M)}),signal:this.abortController.signal}})}catch(M){this.handleError(M)}}),this.handleResponse=A=>t(this,void 0,void 0,function*(){var S,T;if(!A.ok){try{yield(0,c.defaultResponseHandler)(A)}catch(G){this.emit("error",G)}return}const E=A.body;if(!E){this.emit("error",new c.ApiError({message:"Response body is empty.",status:400,body:void 0,requestId:this._requestId||void 0}));return}if(!((S=A.headers.get("content-type"))!==null&&S!==void 0?S:"").startsWith(d)){const G=E.getReader(),V=()=>{G.read().then(({done:F,value:K})=>{if(F){this.emit("done",this.currentData);return}this.currentData=K,this.emit("data",K),V()})};V();return}const j=new TextDecoder("utf-8"),O=A.body.getReader(),M=(0,s.createParser)(G=>{if(G.type==="event"){const V=G.data;try{const F=JSON.parse(V);this.buffer.push(F),this.currentData=F,this.emit("data",F),this.emit("message",F)}catch(F){this.emit("error",F)}}}),D=(T=this.options.timeout)!==null&&T!==void 0?T:h,q=()=>t(this,void 0,void 0,function*(){const{value:G,done:V}=yield O.read();this.lastEventTimestamp=Date.now(),M.feed(j.decode(G)),Date.now()-this.lastEventTimestamp>D&&this.emit("error",new c.ApiError({message:`Event stream timed out after ${(D/1e3).toFixed(0)} seconds with no messages.`,status:408,requestId:this._requestId||void 0})),V?this.emit("done",this.currentData):q().catch(this.handleError)});q().catch(this.handleError)}),this.handleError=A=>{var S;if(A.name==="AbortError"||this.signal.aborted)return;const T=A instanceof c.ApiError?A:new c.ApiError({message:(S=A.message)!==null&&S!==void 0?S:"An unknown error occurred",status:500,requestId:this._requestId||void 0});this.emit("error",T)},this.on=(A,S)=>{var T;this.listeners.has(A)||this.listeners.set(A,[]),(T=this.listeners.get(A))===null||T===void 0||T.push(S)},this.emit=(A,S)=>{const T=this.listeners.get(A)||[];for(const E of T)E(S)},this.done=()=>t(this,void 0,void 0,function*(){return this.donePromise}),this.abort=A=>{this.streamClosed||this.abortController.abort(A)},this.endpointId=y,this.config=_,this.url=(w=x.url)!==null&&w!==void 0?w:(0,l.buildUrl)(y,{path:"/stream",query:x.queryParams}),this.options=x,this.donePromise=new Promise((A,S)=>{this.streamClosed&&S(new c.ApiError({message:"Streaming connection is already closed.",status:400,body:void 0,requestId:this._requestId||void 0})),this.signal.addEventListener("abort",()=>{var T;A((T=this.currentData)!==null&&T!==void 0?T:{})}),this.on("done",T=>{this.streamClosed=!0,A(T)}),this.on("error",T=>{this.streamClosed=!0,S(T)})}),x.signal&&x.signal.addEventListener("abort",()=>{this.abortController.abort()}),this.start().catch(this.handleError)}[Symbol.asyncIterator](){return n(this,arguments,function*(){let _=!0;const x=()=>_=!1;for(this.on("error",x),this.on("done",x);_||this.buffer.length>0;){const w=this.buffer.shift();w&&(yield yield e(w)),yield e(new Promise(A=>setTimeout(A,16)))}})}get signal(){return this.abortController.signal}get requestId(){return this._requestId}}qn.FalStream=f;function p({config:m,storage:y}){return{stream(_,x){return t(this,void 0,void 0,function*(){const w=x.input?yield y.transformInput(x.input):void 0;return new f(_,m,Object.assign(Object.assign({},x),{input:w}))})}}}return qn}var iw;function J2(){if(iw)return Pr;iw=1;var t=Pr&&Pr.__awaiter||function(m,y,_,x){function w(A){return A instanceof _?A:new _(function(S){S(A)})}return new(_||(_=Promise))(function(A,S){function T(j){try{C(x.next(j))}catch(O){S(O)}}function E(j){try{C(x.throw(j))}catch(O){S(O)}}function C(j){j.done?A(j.value):w(j.value).then(T,E)}C((x=x.apply(m,y||[])).next())})},e=Pr&&Pr.__rest||function(m,y){var _={};for(var x in m)Object.prototype.hasOwnProperty.call(m,x)&&y.indexOf(x)<0&&(_[x]=m[x]);if(m!=null&&typeof Object.getOwnPropertySymbols=="function")for(var w=0,x=Object.getOwnPropertySymbols(m);w<x.length;w++)y.indexOf(x[w])<0&&Object.prototype.propertyIsEnumerable.call(m,x[w])&&(_[x[w]]=m[x[w]]);return _};Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.createQueueClient=void 0;const n=Wl(),s=Ni(),a=ef(),l=cE(),c=Ri(),d=500,h={maxRetries:3,baseDelay:1e3,maxDelay:6e4,retryableStatusCodes:a.DEFAULT_RETRYABLE_STATUS_CODES},f={maxRetries:5,baseDelay:1e3,maxDelay:3e4,retryableStatusCodes:[...a.DEFAULT_RETRYABLE_STATUS_CODES,500]},p=({config:m,storage:y})=>{const _={submit(x,w){return t(this,void 0,void 0,function*(){const{webhookUrl:A,priority:S,hint:T}=w,E=e(w,["webhookUrl","priority","hint"]),C=w.input?yield y.transformInput(w.input):void 0;return(0,n.dispatchRequest)({method:w.method,targetUrl:(0,n.buildUrl)(x,Object.assign(Object.assign({},E),{subdomain:"queue",query:A?{fal_webhook:A}:void 0})),headers:Object.assign({"x-fal-queue-priority":S??"normal"},T&&{"x-fal-runner-hint":T}),input:C,config:m,options:{signal:w.abortSignal,retry:h}})})},status(x,w){return t(this,arguments,void 0,function*(A,{requestId:S,logs:T=!1,abortSignal:E}){const C=(0,c.parseEndpointId)(A),j=C.namespace?`${C.namespace}/`:"";return(0,n.dispatchRequest)({method:"get",targetUrl:(0,n.buildUrl)(`${j}${C.owner}/${C.alias}`,{subdomain:"queue",query:{logs:T?"1":"0"},path:`/requests/${S}/status`}),config:m,options:{signal:E,retry:f}})})},streamStatus(x,w){return t(this,arguments,void 0,function*(A,{requestId:S,logs:T=!1,connectionMode:E}){const C=(0,c.parseEndpointId)(A),j=C.namespace?`${C.namespace}/`:"",O={logs:T?"1":"0"},M=(0,n.buildUrl)(`${j}${C.owner}/${C.alias}`,{subdomain:"queue",path:`/requests/${S}/status/stream`,query:O});return new l.FalStream(A,m,{url:M,method:"get",connectionMode:E,queryParams:O})})},subscribeToStatus(x,w){return t(this,void 0,void 0,function*(){const A=w.requestId,S=w.timeout;let T;const E=()=>{};if(w.mode==="streaming"){const C=yield _.streamStatus(x,{requestId:A,logs:w.logs,connectionMode:"connectionMode"in w?w.connectionMode:void 0}),j=[];S&&(T=setTimeout(()=>{throw C.abort(),_.cancel(x,{requestId:A}).catch(E),new Error(`Client timed out waiting for the request to complete after ${S}ms`)},S)),C.on("data",M=>{w.onQueueUpdate&&("logs"in M&&Array.isArray(M.logs)&&M.logs.length>0&&j.push(...M.logs),w.onQueueUpdate("logs"in M?Object.assign(Object.assign({},M),{logs:j}):M))});const O=yield C.done();return T&&clearTimeout(T),O}return new Promise((C,j)=>{var O;let M;const D="pollInterval"in w&&typeof w.pollInterval=="number"&&(O=w.pollInterval)!==null&&O!==void 0?O:d,q=()=>{T&&clearTimeout(T),M&&clearTimeout(M)};S&&(T=setTimeout(()=>{q(),_.cancel(x,{requestId:A}).catch(E),j(new Error(`Client timed out waiting for the request to complete after ${S}ms`))},S));const G=()=>t(this,void 0,void 0,function*(){var V;try{const F=yield _.status(x,{requestId:A,logs:(V=w.logs)!==null&&V!==void 0?V:!1,abortSignal:w.abortSignal});if(w.onQueueUpdate&&w.onQueueUpdate(F),F.status==="COMPLETED"){q(),C(F);return}M=setTimeout(G,D)}catch(F){q(),j(F)}});G().catch(j)})})},result(x,w){return t(this,arguments,void 0,function*(A,{requestId:S,abortSignal:T}){const E=(0,c.parseEndpointId)(A),C=E.namespace?`${E.namespace}/`:"";return(0,n.dispatchRequest)({method:"get",targetUrl:(0,n.buildUrl)(`${C}${E.owner}/${E.alias}`,{subdomain:"queue",path:`/requests/${S}`}),config:Object.assign(Object.assign({},m),{responseHandler:s.resultResponseHandler}),options:{signal:T,retry:h}})})},cancel(x,w){return t(this,arguments,void 0,function*(A,{requestId:S,abortSignal:T}){const E=(0,c.parseEndpointId)(A),C=E.namespace?`${E.namespace}/`:"";yield(0,n.dispatchRequest)({method:"put",targetUrl:(0,n.buildUrl)(`${C}${E.owner}/${E.alias}`,{subdomain:"queue",path:`/requests/${S}/cancel`}),config:m,options:{signal:T}})})}};return _};return Pr.createQueueClient=p,Pr}var Hu={};function Z2(t){const e=t.length;let n=0,s=0;for(;s<e;){let a=t.charCodeAt(s++);if((a&4294967168)===0){n++;continue}else if((a&4294965248)===0)n+=2;else{if(a>=55296&&a<=56319&&s<e){const l=t.charCodeAt(s);(l&64512)===56320&&(++s,a=((a&1023)<<10)+(l&1023)+65536)}(a&4294901760)===0?n+=3:n+=4}}return n}function eI(t,e,n){const s=t.length;let a=n,l=0;for(;l<s;){let c=t.charCodeAt(l++);if((c&4294967168)===0){e[a++]=c;continue}else if((c&4294965248)===0)e[a++]=c>>6&31|192;else{if(c>=55296&&c<=56319&&l<s){const d=t.charCodeAt(l);(d&64512)===56320&&(++l,c=((c&1023)<<10)+(d&1023)+65536)}(c&4294901760)===0?(e[a++]=c>>12&15|224,e[a++]=c>>6&63|128):(e[a++]=c>>18&7|240,e[a++]=c>>12&63|128,e[a++]=c>>6&63|128)}e[a++]=c&63|128}}const tI=new TextEncoder,nI=50;function rI(t,e,n){tI.encodeInto(t,e.subarray(n))}function sI(t,e,n){t.length>nI?rI(t,e,n):eI(t,e,n)}const iI=4096;function uE(t,e,n){let s=e;const a=s+n,l=[];let c="";for(;s<a;){const d=t[s++];if((d&128)===0)l.push(d);else if((d&224)===192){const h=t[s++]&63;l.push((d&31)<<6|h)}else if((d&240)===224){const h=t[s++]&63,f=t[s++]&63;l.push((d&31)<<12|h<<6|f)}else if((d&248)===240){const h=t[s++]&63,f=t[s++]&63,p=t[s++]&63;let m=(d&7)<<18|h<<12|f<<6|p;m>65535&&(m-=65536,l.push(m>>>10&1023|55296),m=56320|m&1023),l.push(m)}else l.push(d);l.length>=iI&&(c+=String.fromCharCode(...l),l.length=0)}return l.length>0&&(c+=String.fromCharCode(...l)),c}const aI=new TextDecoder,oI=200;function lI(t,e,n){const s=t.subarray(e,e+n);return aI.decode(s)}function cI(t,e,n){return n>oI?lI(t,e,n):uE(t,e,n)}class ll{constructor(e,n){this.type=e,this.data=n}}class fn extends Error{constructor(e){super(e);const n=Object.create(fn.prototype);Object.setPrototypeOf(this,n),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:fn.name})}}const tl=4294967295;function uI(t,e,n){const s=n/4294967296,a=n;t.setUint32(e,s),t.setUint32(e+4,a)}function dE(t,e,n){const s=Math.floor(n/4294967296),a=n;t.setUint32(e,s),t.setUint32(e+4,a)}function fE(t,e){const n=t.getInt32(e),s=t.getUint32(e+4);return n*4294967296+s}function dI(t,e){const n=t.getUint32(e),s=t.getUint32(e+4);return n*4294967296+s}const hE=-1,fI=4294967296-1,hI=17179869184-1;function mE({sec:t,nsec:e}){if(t>=0&&e>=0&&t<=hI)if(e===0&&t<=fI){const n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t),n}else{const n=t/4294967296,s=t&4294967295,a=new Uint8Array(8),l=new DataView(a.buffer);return l.setUint32(0,e<<2|n&3),l.setUint32(4,s),a}else{const n=new Uint8Array(12),s=new DataView(n.buffer);return s.setUint32(0,e),dE(s,4,t),n}}function pE(t){const e=t.getTime(),n=Math.floor(e/1e3),s=(e-n*1e3)*1e6,a=Math.floor(s/1e9);return{sec:n+a,nsec:s-a*1e9}}function gE(t){if(t instanceof Date){const e=pE(t);return mE(e)}else return null}function yE(t){const e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const n=e.getUint32(0),s=e.getUint32(4),a=(n&3)*4294967296+s,l=n>>>2;return{sec:a,nsec:l}}case 12:{const n=fE(e,4),s=e.getUint32(0);return{sec:n,nsec:s}}default:throw new fn(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${t.length}`)}}function vE(t){const e=yE(t);return new Date(e.sec*1e3+e.nsec/1e6)}const mI={type:hE,encode:gE,decode:vE};class kl{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(mI)}register({type:e,encode:n,decode:s}){if(e>=0)this.encoders[e]=n,this.decoders[e]=s;else{const a=-1-e;this.builtInEncoders[a]=n,this.builtInDecoders[a]=s}}tryToEncode(e,n){for(let s=0;s<this.builtInEncoders.length;s++){const a=this.builtInEncoders[s];if(a!=null){const l=a(e,n);if(l!=null){const c=-1-s;return new ll(c,l)}}}for(let s=0;s<this.encoders.length;s++){const a=this.encoders[s];if(a!=null){const l=a(e,n);if(l!=null){const c=s;return new ll(c,l)}}}return e instanceof ll?e:null}decode(e,n,s){const a=n<0?this.builtInDecoders[-1-n]:this.decoders[n];return a?a(e,n,s):new ll(n,e)}}kl.defaultCodec=new kl;function pI(t){return t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer}function Pp(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):pI(t)?new Uint8Array(t):Uint8Array.from(t)}const gI=100,yI=2048;class tf{constructor(e){this.entered=!1,this.extensionCodec=e?.extensionCodec??kl.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.maxDepth=e?.maxDepth??gI,this.initialBufferSize=e?.initialBufferSize??yI,this.sortKeys=e?.sortKeys??!1,this.forceFloat32=e?.forceFloat32??!1,this.ignoreUndefined=e?.ignoreUndefined??!1,this.forceIntegerToFloat=e?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new tf({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,n){if(n>this.maxDepth)throw new Error(`Too deep objects in depth ${n}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,n)}ensureBufferSizeToWrite(e){const n=this.pos+e;this.view.byteLength<n&&this.resizeBuffer(n*2)}resizeBuffer(e){const n=new ArrayBuffer(e),s=new Uint8Array(n),a=new DataView(n);s.set(this.bytes),this.view=a,this.bytes=s}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const s=Z2(e);this.ensureBufferSizeToWrite(5+s),this.writeStringHeader(s),sI(e,this.bytes,this.pos),this.pos+=s}encodeObject(e,n){const s=this.extensionCodec.tryToEncode(e,this.context);if(s!=null)this.encodeExtension(s);else if(Array.isArray(e))this.encodeArray(e,n);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,n);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const n=e.byteLength;if(n<256)this.writeU8(196),this.writeU8(n);else if(n<65536)this.writeU8(197),this.writeU16(n);else if(n<4294967296)this.writeU8(198),this.writeU32(n);else throw new Error(`Too large binary: ${n}`);const s=Pp(e);this.writeU8a(s)}encodeArray(e,n){const s=e.length;if(s<16)this.writeU8(144+s);else if(s<65536)this.writeU8(220),this.writeU16(s);else if(s<4294967296)this.writeU8(221),this.writeU32(s);else throw new Error(`Too large array: ${s}`);for(const a of e)this.doEncode(a,n+1)}countWithoutUndefined(e,n){let s=0;for(const a of n)e[a]!==void 0&&s++;return s}encodeMap(e,n){const s=Object.keys(e);this.sortKeys&&s.sort();const a=this.ignoreUndefined?this.countWithoutUndefined(e,s):s.length;if(a<16)this.writeU8(128+a);else if(a<65536)this.writeU8(222),this.writeU16(a);else if(a<4294967296)this.writeU8(223),this.writeU32(a);else throw new Error(`Too large map object: ${a}`);for(const l of s){const c=e[l];this.ignoreUndefined&&c===void 0||(this.encodeString(l),this.doEncode(c,n+1))}}encodeExtension(e){if(typeof e.data=="function"){const s=e.data(this.pos+6),a=s.length;if(a>=4294967296)throw new Error(`Too large extension object: ${a}`);this.writeU8(201),this.writeU32(a),this.writeI8(e.type),this.writeU8a(s);return}const n=e.data.length;if(n===1)this.writeU8(212);else if(n===2)this.writeU8(213);else if(n===4)this.writeU8(214);else if(n===8)this.writeU8(215);else if(n===16)this.writeU8(216);else if(n<256)this.writeU8(199),this.writeU8(n);else if(n<65536)this.writeU8(200),this.writeU16(n);else if(n<4294967296)this.writeU8(201),this.writeU32(n);else throw new Error(`Too large extension object: ${n}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const n=e.length;this.ensureBufferSizeToWrite(n),this.bytes.set(e,this.pos),this.pos+=n}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),uI(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),dE(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}}function vI(t,e){return new tf(e).encodeSharedRef(t)}function rp(t){return`${t<0?"-":""}0x${Math.abs(t).toString(16).padStart(2,"0")}`}const _I=16,bI=16;class wI{constructor(e=_I,n=bI){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=n,this.caches=[];for(let s=0;s<this.maxKeyLength;s++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,n,s){const a=this.caches[s-1];e:for(const l of a){const c=l.bytes;for(let d=0;d<s;d++)if(c[d]!==e[n+d])continue e;return l.str}return null}store(e,n){const s=this.caches[e.length-1],a={bytes:e,str:n};s.length>=this.maxLengthPerKey?s[Math.random()*s.length|0]=a:s.push(a)}decode(e,n,s){const a=this.find(e,n,s);if(a!=null)return this.hit++,a;this.miss++;const l=uE(e,n,s),c=Uint8Array.prototype.slice.call(e,n,n+s);return this.store(c,l),l}}const Hp="array",Al="map_key",_E="map_value",xI=t=>{if(typeof t=="string"||typeof t=="number")return t;throw new fn("The type of key must be string or number but "+typeof t)};class AI{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const n=this.getUninitializedStateFromPool();n.type=Hp,n.position=0,n.size=e,n.array=new Array(e)}pushMapState(e){const n=this.getUninitializedStateFromPool();n.type=Al,n.readCount=0,n.size=e,n.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===Hp){const s=e;s.size=0,s.array=void 0,s.position=0,s.type=void 0}if(e.type===Al||e.type===_E){const s=e;s.size=0,s.map=void 0,s.readCount=0,s.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const nl=-1,kg=new DataView(new ArrayBuffer(0)),EI=new Uint8Array(kg.buffer);try{kg.getInt8(0)}catch(t){if(!(t instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const aw=new RangeError("Insufficient data"),SI=new wI;class zs{constructor(e){this.totalPos=0,this.pos=0,this.view=kg,this.bytes=EI,this.headByte=nl,this.stack=new AI,this.entered=!1,this.extensionCodec=e?.extensionCodec??kl.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??tl,this.maxBinLength=e?.maxBinLength??tl,this.maxArrayLength=e?.maxArrayLength??tl,this.maxMapLength=e?.maxMapLength??tl,this.maxExtLength=e?.maxExtLength??tl,this.keyDecoder=e?.keyDecoder!==void 0?e.keyDecoder:SI,this.mapKeyConverter=e?.mapKeyConverter??xI}clone(){return new zs({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=nl,this.stack.reset()}setBuffer(e){const n=Pp(e);this.bytes=n,this.view=new DataView(n.buffer,n.byteOffset,n.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===nl&&!this.hasRemaining(1))this.setBuffer(e);else{const n=this.bytes.subarray(this.pos),s=Pp(e),a=new Uint8Array(n.length+s.length);a.set(n),a.set(s,n.length),this.setBuffer(a)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:n,pos:s}=this;return new RangeError(`Extra ${n.byteLength-s} of ${n.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const n=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return n}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let n=!1,s;for await(const d of e){if(n)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(d);try{s=this.doDecodeSync(),n=!0}catch(h){if(!(h instanceof RangeError))throw h}this.totalPos+=this.pos}if(n){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return s}const{headByte:a,pos:l,totalPos:c}=this;throw new RangeError(`Insufficient data in parsing ${rp(a)} at ${c} (${l} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,n){if(this.entered){yield*this.clone().decodeMultiAsync(e,n);return}try{this.entered=!0;let s=n,a=-1;for await(const l of e){if(n&&a===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(l),s&&(a=this.readArraySize(),s=!1,this.complete());try{for(;yield this.doDecodeSync(),--a!==0;);}catch(c){if(!(c instanceof RangeError))throw c}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let n;if(e>=224)n=e-256;else if(e<192)if(e<128)n=e;else if(e<144){const a=e-128;if(a!==0){this.pushMapState(a),this.complete();continue e}else n={}}else if(e<160){const a=e-144;if(a!==0){this.pushArrayState(a),this.complete();continue e}else n=[]}else{const a=e-160;n=this.decodeString(a,0)}else if(e===192)n=null;else if(e===194)n=!1;else if(e===195)n=!0;else if(e===202)n=this.readF32();else if(e===203)n=this.readF64();else if(e===204)n=this.readU8();else if(e===205)n=this.readU16();else if(e===206)n=this.readU32();else if(e===207)this.useBigInt64?n=this.readU64AsBigInt():n=this.readU64();else if(e===208)n=this.readI8();else if(e===209)n=this.readI16();else if(e===210)n=this.readI32();else if(e===211)this.useBigInt64?n=this.readI64AsBigInt():n=this.readI64();else if(e===217){const a=this.lookU8();n=this.decodeString(a,1)}else if(e===218){const a=this.lookU16();n=this.decodeString(a,2)}else if(e===219){const a=this.lookU32();n=this.decodeString(a,4)}else if(e===220){const a=this.readU16();if(a!==0){this.pushArrayState(a),this.complete();continue e}else n=[]}else if(e===221){const a=this.readU32();if(a!==0){this.pushArrayState(a),this.complete();continue e}else n=[]}else if(e===222){const a=this.readU16();if(a!==0){this.pushMapState(a),this.complete();continue e}else n={}}else if(e===223){const a=this.readU32();if(a!==0){this.pushMapState(a),this.complete();continue e}else n={}}else if(e===196){const a=this.lookU8();n=this.decodeBinary(a,1)}else if(e===197){const a=this.lookU16();n=this.decodeBinary(a,2)}else if(e===198){const a=this.lookU32();n=this.decodeBinary(a,4)}else if(e===212)n=this.decodeExtension(1,0);else if(e===213)n=this.decodeExtension(2,0);else if(e===214)n=this.decodeExtension(4,0);else if(e===215)n=this.decodeExtension(8,0);else if(e===216)n=this.decodeExtension(16,0);else if(e===199){const a=this.lookU8();n=this.decodeExtension(a,1)}else if(e===200){const a=this.lookU16();n=this.decodeExtension(a,2)}else if(e===201){const a=this.lookU32();n=this.decodeExtension(a,4)}else throw new fn(`Unrecognized type byte: ${rp(e)}`);this.complete();const s=this.stack;for(;s.length>0;){const a=s.top();if(a.type===Hp)if(a.array[a.position]=n,a.position++,a.position===a.size)n=a.array,s.release(a);else continue e;else if(a.type===Al){if(n==="__proto__")throw new fn("The key __proto__ is not allowed");a.key=this.mapKeyConverter(n),a.type=_E;continue e}else if(a.map[a.key]=n,a.readCount++,a.readCount===a.size)n=a.map,s.release(a);else{a.key=null,a.type=Al;continue e}}return n}}readHeadByte(){return this.headByte===nl&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=nl}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new fn(`Unrecognized array type byte: ${rp(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new fn(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new fn(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,n){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,n):this.decodeBinary(e,n)}decodeUtf8String(e,n){if(e>this.maxStrLength)throw new fn(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+n+e)throw aw;const s=this.pos+n;let a;return this.stateIsMapKey()&&this.keyDecoder?.canBeCached(e)?a=this.keyDecoder.decode(this.bytes,s,e):a=cI(this.bytes,s,e),this.pos+=n+e,a}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===Al:!1}decodeBinary(e,n){if(e>this.maxBinLength)throw new fn(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+n))throw aw;const s=this.pos+n,a=this.bytes.subarray(s,s+e);return this.pos+=n+e,a}decodeExtension(e,n){if(e>this.maxExtLength)throw new fn(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const s=this.view.getInt8(this.pos+n),a=this.decodeBinary(e,n+1);return this.extensionCodec.decode(a,s,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=dI(this.view,this.pos);return this.pos+=8,e}readI64(){const e=fE(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}}function CI(t,e){return new zs(e).decode(t)}function TI(t,e){return new zs(e).decodeMulti(t)}function NI(t){return t[Symbol.asyncIterator]!=null}async function*RI(t){const e=t.getReader();try{for(;;){const{done:n,value:s}=await e.read();if(n)return;yield s}}finally{e.releaseLock()}}function Mg(t){return NI(t)?t:RI(t)}async function jI(t,e){const n=Mg(t);return new zs(e).decodeAsync(n)}function OI(t,e){const n=Mg(t);return new zs(e).decodeArrayStream(n)}function II(t,e){const n=Mg(t);return new zs(e).decodeStream(n)}const kI=Object.freeze(Object.defineProperty({__proto__:null,DecodeError:fn,Decoder:zs,EXT_TIMESTAMP:hE,Encoder:tf,ExtData:ll,ExtensionCodec:kl,decode:CI,decodeArrayStream:OI,decodeAsync:jI,decodeMulti:TI,decodeMultiStream:II,decodeTimestampExtension:vE,decodeTimestampToTimeSpec:yE,encode:vI,encodeDateToTimeSpec:pE,encodeTimeSpecToTimestamp:mE,encodeTimestampExtension:gE},Symbol.toStringTag,{value:"Module"})),MI=Kx(kI);var En={},ow;function DI(){if(ow)return En;ow=1,Object.defineProperty(En,"__esModule",{value:!0});function t(L){return{enumerable:!0,value:L}}function e(L){return{enumerable:!0,writable:!0,value:L}}let n={},s=()=>!0,a=()=>({}),l=L=>L,c=(L,H,I,P)=>L.apply(I,P)&&H.apply(I,P),d=(L,H,I,[P,Y])=>H.call(I,L.call(I,P,Y),Y),h=(L,H)=>Object.freeze(Object.create(L,H));function f(L,H,I){return L.reduce((P,Y)=>function(...J){return I(P,Y,this,J)},H)}function p(L){return h(this,{fn:t(L)})}let m={},y=p.bind(m),_=L=>y((H,I)=>!!~L(H,I)&&H),x={},w=p.bind(x);function A(L,H){return H.filter(I=>L.isPrototypeOf(I))}function S(L,H,...I){let P=f(A(x,I).map(J=>J.fn),s,c),Y=f(A(m,I).map(J=>J.fn),l,d);return h(this,{from:t(L),to:t(H),guards:t(P),reducers:t(Y)})}let T={},E={},C=S.bind(T),j=S.bind(E,null);function O(L,H,I){return Q(H,L,I,this.immediates)||L}function M(L){let H=new Map;for(let I of L)H.has(I.from)||H.set(I.from,[]),H.get(I.from).push(I);return H}let D={enter:l};function q(...L){let H=A(T,L),I=A(E,L),P={final:t(L.length===0),transitions:t(M(H))};return I.length&&(P.immediates=t(I),P.enter=t(O)),h(D,P)}let G={enter(L,H,I){let P=this.fn.call(H,H.context,I);return K.isPrototypeOf(P)?h(V,{machine:t(P),transitions:t(this.transitions)}).enter(L,H,I):(P.then(Y=>H.send({type:"done",data:Y})).catch(Y=>H.send({type:"error",error:Y})),L)}},V={enter(L,H,I){if(H.child=B(this.machine,P=>{H.onChange(P),H.child==P&&P.machine.state.value.final&&(delete H.child,H.send({type:"done",data:P.context}))},H.context,I),H.child.machine.state.value.final){let P=H.child.context;return delete H.child,Q(H,L,{type:"done",data:P},this.transitions.get("done"))}return L}};function F(L,...H){let I=t(M(H));return K.isPrototypeOf(L)?h(V,{machine:t(L),transitions:I}):h(G,{fn:t(L),transitions:I})}let K={get state(){return{name:this.current,value:this.states[this.current]}}};function $(L,H,I=a){return typeof L!="string"&&(I=H||a,H=L,L=Object.keys(H)[0]),n._create&&n._create(L,H),h(K,{context:t(I),current:t(L),states:t(H)})}function Q(L,H,I,P){let{context:Y}=L;for(let{to:J,guards:Z,reducers:ae}of P)if(Z(Y,I)){L.context=ae.call(L,Y,I);let ce=H.original||H,he=h(ce,{current:t(J),original:{value:ce}});return n._onEnter&&n._onEnter(H,J,L.context,Y,I),he.state.value.enter(he,L,I)}}function R(L,H){let I=H.type||H,{machine:P}=L,{value:Y,name:J}=P.state;return Y.transitions.has(I)?Q(L,P,H,Y.transitions.get(I))||P:(n._send&&n._send(I,J),P)}let U={send(L){this.machine=R(this,L),this.onChange(this)}};function B(L,H,I,P){let Y=Object.create(U,{machine:e(L),context:e(L.context(I,P)),onChange:t(H)});return Y.send=Y.send.bind(Y),Y.machine=Y.machine.state.value.enter(Y.machine,Y,P),Y}return En.action=_,En.createMachine=$,En.d=n,En.guard=w,En.immediate=j,En.interpret=B,En.invoke=F,En.reduce=y,En.state=q,En.transition=C,En}var lw;function BI(){if(lw)return Hu;lw=1,Object.defineProperty(Hu,"__esModule",{value:!0}),Hu.createRealtimeClient=V;const t=MI,e=DI(),n=lE(),s=Ni(),a=Og(),l=Ri(),c=()=>({enqueuedMessage:void 0});function d(F){return F.token!==void 0}function h(F){return!d(F)}function f(F,K){return Object.assign(Object.assign({},F),{enqueuedMessage:K.message})}function p(F){return F.websocket&&F.websocket.readyState===WebSocket.OPEN&&F.websocket.close(),Object.assign(Object.assign({},F),{websocket:void 0})}function m(F,K){return F.websocket&&F.websocket.readyState===WebSocket.OPEN?(K.message instanceof Uint8Array?F.websocket.send(K.message):F.websocket.send((0,t.encode)(K.message)),Object.assign(Object.assign({},F),{enqueuedMessage:void 0})):Object.assign(Object.assign({},F),{enqueuedMessage:K.message})}function y(F){return Object.assign(Object.assign({},F),{token:void 0})}function _(F,K){return Object.assign(Object.assign({},F),{token:K.token})}function x(F,K){return Object.assign(Object.assign({},F),{websocket:K.websocket})}const w=(0,e.createMachine)("idle",{idle:(0,e.state)((0,e.transition)("send","connecting",(0,e.reduce)(f)),(0,e.transition)("expireToken","idle",(0,e.reduce)(y)),(0,e.transition)("close","idle",(0,e.reduce)(p))),connecting:(0,e.state)((0,e.transition)("connecting","connecting"),(0,e.transition)("connected","active",(0,e.reduce)(x)),(0,e.transition)("connectionClosed","idle",(0,e.reduce)(p)),(0,e.transition)("send","connecting",(0,e.reduce)(f)),(0,e.transition)("close","idle",(0,e.reduce)(p)),(0,e.immediate)("authRequired",(0,e.guard)(h))),authRequired:(0,e.state)((0,e.transition)("initiateAuth","authInProgress"),(0,e.transition)("send","authRequired",(0,e.reduce)(f)),(0,e.transition)("close","idle",(0,e.reduce)(p))),authInProgress:(0,e.state)((0,e.transition)("authenticated","connecting",(0,e.reduce)(_)),(0,e.transition)("unauthorized","idle",(0,e.reduce)(y),(0,e.reduce)(p)),(0,e.transition)("send","authInProgress",(0,e.reduce)(f)),(0,e.transition)("close","idle",(0,e.reduce)(p))),active:(0,e.state)((0,e.transition)("send","active",(0,e.reduce)(m)),(0,e.transition)("unauthorized","idle",(0,e.reduce)(y)),(0,e.transition)("connectionClosed","idle",(0,e.reduce)(p)),(0,e.transition)("close","idle",(0,e.reduce)(p))),failed:(0,e.state)((0,e.transition)("send","failed"),(0,e.transition)("close","idle",(0,e.reduce)(p)))},c);function A(F,{token:K,maxBuffering:$}){if($!==void 0&&($<1||$>60))throw new Error("The `maxBuffering` must be between 1 and 60 (inclusive)");const Q=new URLSearchParams({fal_jwt_token:K});return $!==void 0&&Q.set("max_buffering",$.toFixed(0)),`wss://fal.run/${(0,l.ensureEndpointIdFormat)(F)}/realtime?${Q.toString()}`}const S=128;function T(F){return F.status==="error"&&F.error==="Unauthorized"}const E={NORMAL_CLOSURE:1e3},C=new Map,j=new Map;function O(F,K,$){if(!C.has(F)){const Q=(0,e.interpret)(w,$);C.set(F,Object.assign(Object.assign({},Q),{throttledSend:K>0?(0,l.throttle)(Q.send,K,!0):Q.send}))}return C.get(F)}const M=()=>{},D={send:M,close:M};function q(F){return F.status!=="error"&&F.type!=="x-fal-message"&&!G(F)}function G(F){return F.type==="x-fal-error"}function V({config:F}){return{connect(K,$){const{clientOnly:Q=(0,l.isReact)()&&!(0,a.isBrowser)(),connectionKey:R=crypto.randomUUID(),maxBuffering:U,throttleInterval:B=S}=$;if(Q&&!(0,a.isBrowser)())return D;let L;j.set(R,{onError:$.onError,onResult:$.onResult});const H=()=>j.get(R),I=O(R,B,({context:J,machine:Z,send:ae})=>{const{enqueuedMessage:ce,token:he}=J;if(Z.current==="active"&&ce&&ae({type:"send",message:ce}),Z.current==="authRequired"&&he===void 0&&L!==Z.current&&(ae({type:"initiateAuth"}),(0,n.getTemporaryAuthToken)(K,F).then(ye=>{ae({type:"authenticated",token:ye});const pe=Math.round(n.TOKEN_EXPIRATION_SECONDS*.9*1e3);setTimeout(()=>{ae({type:"expireToken"})},pe)}).catch(ye=>{ae({type:"unauthorized",error:ye})})),Z.current==="connecting"&&L!==Z.current&&he!==void 0){const ye=new WebSocket(A(K,{token:he,maxBuffering:U}));ye.onopen=()=>{ae({type:"connected",websocket:ye})},ye.onclose=pe=>{if(pe.code!==E.NORMAL_CLOSURE){const{onError:_e=M}=H();_e(new s.ApiError({message:`Error closing the connection: ${pe.reason}`,status:pe.code}))}ae({type:"connectionClosed",code:pe.code})},ye.onerror=pe=>{const{onError:_e=M}=H();_e(new s.ApiError({message:"Unknown error",status:500}))},ye.onmessage=pe=>{const{onResult:_e}=H();if(pe.data instanceof ArrayBuffer){const we=(0,t.decode)(new Uint8Array(pe.data));_e(we);return}if(pe.data instanceof Uint8Array){const we=(0,t.decode)(pe.data);_e(we);return}if(pe.data instanceof Blob){pe.data.arrayBuffer().then(we=>{const ue=(0,t.decode)(new Uint8Array(we));_e(ue)});return}const be=JSON.parse(pe.data);if(T(be)){ae({type:"unauthorized",error:new Error("Unauthorized")});return}if(q(be)){_e(be);return}if(G(be)){if(be.error==="TIMEOUT")return;const{onError:we=M}=H();we(new s.ApiError({message:`${be.error}: ${be.reason}`,status:400,body:be}));return}}}L=Z.current});return{send:J=>{I.throttledSend({type:"send",message:J})},close:()=>{I.send({type:"close"})}}}}}return Hu}var Rs={},cw;function UI(){if(cw)return Rs;cw=1;var t=Rs&&Rs.__awaiter||function(p,m,y,_){function x(w){return w instanceof y?w:new y(function(A){A(w)})}return new(y||(y=Promise))(function(w,A){function S(C){try{E(_.next(C))}catch(j){A(j)}}function T(C){try{E(_.throw(C))}catch(j){A(j)}}function E(C){C.done?w(C.value):x(C.value).then(S,T)}E((_=_.apply(p,m||[])).next())})};Object.defineProperty(Rs,"__esModule",{value:!0}),Rs.LIFECYCLE_DURATIONS=void 0,Rs.createStorageClient=f;const e=Ig(),n=Wl(),s=Ri();Rs.LIFECYCLE_DURATIONS={ONE_DAY:86400,ONE_WEEK:604800,ONE_MONTH:2592e3,ONE_YEAR:31536e3,UNLIMITED:31536e6};function a(p){var m;const[,y]=p.split("/");return(m=y.split(/[-;]/)[0])!==null&&m!==void 0?m:"bin"}function l(p,m,y,_){return t(this,void 0,void 0,function*(){const x=p.name||`${Date.now()}.${a(y)}`,w={};return _&&(w["X-Fal-Object-Lifecycle"]=JSON.stringify(_)),yield(0,n.dispatchRequest)({method:"POST",targetUrl:`${(0,e.getRestApiUrl)()}/storage/upload/initiate?storage_type=fal-cdn-v3`,input:{content_type:y,file_name:x},config:m,headers:w})})}function c(p,m,y,_){return t(this,void 0,void 0,function*(){const x=p.name||`${Date.now()}.${a(y)}`,w={};return _&&(w["X-Fal-Object-Lifecycle"]=JSON.stringify(_)),yield(0,n.dispatchRequest)({method:"POST",targetUrl:`${(0,e.getRestApiUrl)()}/storage/upload/initiate-multipart?storage_type=fal-cdn-v3`,input:{content_type:y,file_name:x},config:m,headers:w})})}function d(p,m,y){return t(this,arguments,void 0,function*(_,x,w,A=3){if(A===0)throw new Error("Part upload failed, retries exhausted");const{fetch:S,responseHandler:T}=w;try{const E=yield S(_,{method:"PUT",body:x});return yield T(E)}catch{return yield d(_,x,w,A-1)}})}function h(p,m,y){return t(this,void 0,void 0,function*(){const{fetch:_,responseHandler:x}=m,w=p.type||"application/octet-stream",{upload_url:A,file_url:S}=yield c(p,m,w,y),T=10*1024*1024,E=Math.ceil(p.size/T),C=new URL(A),j=[];for(let D=0;D<E;D++){const q=D*T,G=Math.min(q+T,p.size),V=p.slice(q,G),F=D+1,K=`${C.origin}${C.pathname}/${F}${C.search}`;j.push(yield d(K,V,m))}const O=`${C.origin}${C.pathname}/complete${C.search}`,M=yield _(O,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({parts:j.map(D=>({partNumber:D.partNumber,etag:D.etag}))})});return yield x(M),S})}function f({config:p}){const m={upload:(y,_)=>t(this,void 0,void 0,function*(){const x=_?.lifecycle;if(y.size>94371840)return yield h(y,p,x);const w=y.type||"application/octet-stream",{fetch:A,responseHandler:S}=p,{upload_url:T,file_url:E}=yield l(y,p,w,x),C=yield A(T,{method:"PUT",body:y,headers:{"Content-Type":y.type||"application/octet-stream"}});return yield S(C),E}),transformInput:y=>t(this,void 0,void 0,function*(){if(Array.isArray(y))return Promise.all(y.map(_=>m.transformInput(_)));if(y instanceof Blob)return yield m.upload(y);if((0,s.isPlainObject)(y)){const x=Object.entries(y).map(A=>t(this,[A],void 0,function*([S,T]){return[S,yield m.transformInput(T)]})),w=yield Promise.all(x);return Object.fromEntries(w)}return y})};return m}return Rs}var uw;function dw(){if(uw)return Ea;uw=1;var t=Ea&&Ea.__awaiter||function(f,p,m,y){function _(x){return x instanceof m?x:new m(function(w){w(x)})}return new(m||(m=Promise))(function(x,w){function A(E){try{T(y.next(E))}catch(C){w(C)}}function S(E){try{T(y.throw(E))}catch(C){w(C)}}function T(E){E.done?x(E.value):_(E.value).then(A,S)}T((y=y.apply(f,p||[])).next())})};Object.defineProperty(Ea,"__esModule",{value:!0}),Ea.createFalClient=h;const e=Ig(),n=J2(),s=BI(),a=Wl(),l=Ni(),c=UI(),d=cE();function h(f={}){const p=(0,e.createConfig)(f),m=(0,c.createStorageClient)({config:p}),y=(0,n.createQueueClient)({config:p,storage:m}),_=(0,d.createStreamingClient)({config:p,storage:m}),x=(0,s.createRealtimeClient)({config:p});return{queue:y,realtime:x,storage:m,streaming:_,stream:_.stream,run(w){return t(this,arguments,void 0,function*(A,S={}){const T=S.input?yield m.transformInput(S.input):void 0;return(0,a.dispatchRequest)({method:S.method,targetUrl:(0,a.buildUrl)(A,S),input:T,config:Object.assign(Object.assign({},p),{responseHandler:l.resultResponseHandler}),options:{signal:S.abortSignal,retry:{maxRetries:3,baseDelay:500,maxDelay:15e3}}})})},subscribe:(w,A)=>t(this,void 0,void 0,function*(){const{request_id:S}=yield y.submit(w,A);return A.onEnqueue&&A.onEnqueue(S),yield y.subscribeToStatus(w,Object.assign({requestId:S},A)),y.result(w,{requestId:S})})}}return Ea}var rl={},fw;function LI(){if(fw)return rl;fw=1,Object.defineProperty(rl,"__esModule",{value:!0}),rl.isQueueStatus=t,rl.isCompletedQueueStatus=e;function t(n){return n&&n.status&&n.response_url}function e(n){return t(n)&&n.status==="COMPLETED"}return rl}var hw;function $I(){return hw||(hw=1,(function(t){var e=li&&li.__createBinding||(Object.create?(function(f,p,m,y){y===void 0&&(y=m);var _=Object.getOwnPropertyDescriptor(p,m);(!_||("get"in _?!p.__esModule:_.writable||_.configurable))&&(_={enumerable:!0,get:function(){return p[m]}}),Object.defineProperty(f,y,_)}):(function(f,p,m,y){y===void 0&&(y=m),f[y]=p[m]})),n=li&&li.__exportStar||function(f,p){for(var m in f)m!=="default"&&!Object.prototype.hasOwnProperty.call(p,m)&&e(p,f,m)};Object.defineProperty(t,"__esModule",{value:!0}),t.fal=t.parseEndpointId=t.isRetryableError=t.ValidationError=t.ApiError=t.withProxy=t.withMiddleware=t.createFalClient=void 0;const s=dw();var a=dw();Object.defineProperty(t,"createFalClient",{enumerable:!0,get:function(){return a.createFalClient}});var l=oE();Object.defineProperty(t,"withMiddleware",{enumerable:!0,get:function(){return l.withMiddleware}}),Object.defineProperty(t,"withProxy",{enumerable:!0,get:function(){return l.withProxy}});var c=Ni();Object.defineProperty(t,"ApiError",{enumerable:!0,get:function(){return c.ApiError}}),Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return c.ValidationError}});var d=ef();Object.defineProperty(t,"isRetryableError",{enumerable:!0,get:function(){return d.isRetryableError}}),n(LI(),t);var h=Ri();Object.defineProperty(t,"parseEndpointId",{enumerable:!0,get:function(){return h.parseEndpointId}}),t.fal=(function(){let p=(0,s.createFalClient)();return{config(m){p=(0,s.createFalClient)(m)},get queue(){return p.queue},get realtime(){return p.realtime},get storage(){return p.storage},get streaming(){return p.streaming},run(m,y){return p.run(m,y)},subscribe(m,y){return p.subscribe(m,y)},stream(m,y){return p.stream(m,y)}}})()})(li)),li}var Rd=$I();const bE=k.createContext({}),zI=({children:t})=>{const[e,n]=k.useState(null),[s,a]=k.useState(null),[l,c]=k.useState(!1),[d,h]=k.useState(!1),[f,p]=k.useState(""),[m,y]=k.useState({}),[_,x]=k.useState({}),[w,A]=k.useState(""),[S,T]=k.useState(""),[E,C]=k.useState({}),[j,O]=k.useState({}),[M,D]=k.useState([]),[q,G]=k.useState({}),[V,F]=k.useState(!1),[K,$]=k.useState({});k.useEffect(()=>{console.log("projectId :",f),f&&(Q(),R())},[f]),k.useEffect(()=>{w&&U()},[w]);const Q=async()=>{if(console.log(" updateEmbodyCache:",f),!f){console.error("Project ID is not set");return}const{data:H,error:I}=await je.from("embodys").select("name,type,id,prompt").eq("project_id",parseInt(f));if(I){console.error("Error fetching embody data:",I.message);return}C(H.reduce((P,Y)=>({...P,[Y.id]:Y}),{}))},R=async()=>{if(console.log(" fetchProjectData:",f),!f){console.error("Project ID is not set");return}const{data:H,error:I}=await je.from("projects").select("*").eq("id",parseInt(f)).single();if(I){console.error("Error fetching project data:",I.message);return}y(H)},U=async()=>{if(!w){console.error("EP ID is not set");return}F(!0),console.log(" refreshShotsData:",w),je.from("movie_eps").select("*").eq("id",w).single().then(({data:P,error:Y})=>{if(Y){console.log("EP:",Y),F(!1);return}x(P)});const{data:H,error:I}=await je.from("movie_scs").select(`
          *,
          movie_seqs(
            *,
            movie_shots(
              *,
              flows(
                *
              )
            )
          ).order('index', { ascending: true })
        `).order("index",{ascending:!0}).eq("ep_id",w);if(I){console.error(":",I);return}console.log(":",H),F(!1),H.forEach(P=>{P.movie_seqs.forEach(Y=>{Y.movie_shots.sort((J,Z)=>J.index-Z.index),Y.movie_shots.forEach(J=>{q[J.id]=J})})}),D(H)},L={user:e,setUser:n,userProfile:s,setUserProfile:a,isCollapsed:l,isProfileLoading:d,projectId:f,setProjectId:p,projectData:m,setProjectData:y,ep_id:w,setEpId:A,editShotId:S,setEditShotId:T,embodyCache:E,setEmbodyCache:C,deepseekProvider:j,setDeepseekProvider:O,scDatas:M,setScDatas:D,shotWithId:q,setShotWithId:G,isLoading_shots_data:V,setIsLoading_shots_data:F,ep_data:_,setEpData:x,bitImageUrlToThumb:K,setBitImageUrlToThumb:$,fetchUserProfile:async()=>{if(s){console.log("");return}console.log(""),h(!0);const{data:{user:H}}=await je.auth.getUser();if(!H)return console.error("User not authenticated"),h(!1),null;n(H);const{data:I,error:P}=await je.from("profiles").select("*").eq("id",H.id).single();if(P)return console.error("Error fetching user profile:",P.message),h(!1),null;a(I),h(!1)},updateEmbodyCache:Q,refreshShotsData:U,fetchProjectData:R};return b.jsx(bE.Provider,{value:L,children:t})};function On(){const t=k.useContext(bE);if(!t)throw new Error("useGlobal must be used within a GlobalProvider");return t}function PI(){const{user:t,userProfile:e,fetchUserProfile:n,projectId:s,setProjectId:a,setEpId:l,updateEmbodyCache:c}=On(),d=Ls();k.useEffect(()=>{n(),Rt.on("StartEditorMode",()=>{h(!0)}),Rt.on("EndEditorMode",()=>{h(!1)}),console.log("LocalStorage:",localStorage.getItem("projectId")),localStorage.getItem("projectId")&&a(localStorage.getItem("projectId")),localStorage.getItem("epId")&&l(localStorage.getItem("epId"))},[]),h(!0);function h(p){const m=document.documentElement;p?(m.style.setProperty("--avatar-size","30px"),m.style.setProperty("--avatar-bacground-color","transparent"),m.style.setProperty("--avatar-bacground-border","none"),m.style.setProperty("--user-text-display","none")):(m.style.setProperty("--avatar-size","50px"),m.style.setProperty("--avatar-bacground-color","#2a2a2a"),m.style.setProperty("--avatar-bacground-border","1px solid #333"),m.style.setProperty("--user-text-display","block"))}function f(){e?.id?d("/profile"):d("/login")}return b.jsx("div",{className:"user-info-container",onClick:f,children:b.jsx("img",{src:e?.avatar_url||"./default_avatar.png",alt:"",className:"avatar"})})}function HI(){const[t,e]=k.useState(""),[n,s]=k.useState(""),[a,l]=k.useState(""),[c,d]=k.useState(!1),h=Ls(),f=async p=>{p.preventDefault(),l(""),d(!0);try{const{error:m}=await je.auth.signInWithPassword({email:t,password:n});if(m){l(m.message);return}h("/profile")}catch{l("")}finally{d(!1)}};return b.jsx("div",{className:"login-container",children:b.jsxs("div",{className:"login-form",children:[b.jsx("h2",{children:""}),a&&b.jsx("p",{className:"error-message",children:a}),b.jsxs("form",{onSubmit:f,children:[b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"email",children:""}),b.jsx("input",{type:"email",id:"email",value:t,onChange:p=>e(p.target.value),required:!0,placeholder:""})]}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"password",children:""}),b.jsx("input",{type:"password",id:"password",value:n,onChange:p=>s(p.target.value),required:!0,placeholder:""})]}),b.jsx("button",{type:"submit",disabled:c,children:c?"...":""}),b.jsx("div",{className:"register-link",children:b.jsxs("p",{children:["",b.jsx(bi,{to:"/register",children:""})]})})]})]})})}function qI(){const[t,e]=k.useState(""),[n,s]=k.useState(""),[a,l]=k.useState(""),[c,d]=k.useState(""),[h,f]=k.useState(""),[p,m]=k.useState(!1);Ls();const y=async _=>{if(_.preventDefault(),d(""),f(""),!t||!n||!a){d("");return}if(n!==a){d("");return}if(n.length<6){d("6");return}m(!0);try{const{error:x}=await je.auth.signUp({email:t,password:n});if(x){d(x.message);return}f(""),e(""),s(""),l("")}catch{d("")}finally{m(!1)}};return b.jsx("div",{className:"register-container",children:b.jsxs("div",{className:"register-form",children:[b.jsx("h2",{children:""}),c&&b.jsx("p",{className:"error-message",children:c}),h&&b.jsx("p",{className:"success-message",children:h}),b.jsxs("form",{onSubmit:y,children:[b.jsxs("div",{className:"form-group",children:[b.jsxs("label",{htmlFor:"email",children:[" ",b.jsx("span",{className:"required",children:"*"})]}),b.jsx("input",{type:"email",id:"email",value:t,onChange:_=>e(_.target.value),required:!0,placeholder:""})]}),b.jsxs("div",{className:"form-group",children:[b.jsxs("label",{htmlFor:"password",children:[" ",b.jsx("span",{className:"required",children:"*"})]}),b.jsx("input",{type:"password",id:"password",value:n,onChange:_=>s(_.target.value),required:!0,placeholder:"6"})]}),b.jsxs("div",{className:"form-group",children:[b.jsxs("label",{htmlFor:"confirmPassword",children:[" ",b.jsx("span",{className:"required",children:"*"})]}),b.jsx("input",{type:"password",id:"confirmPassword",value:a,onChange:_=>l(_.target.value),required:!0,placeholder:""})]}),b.jsx("button",{type:"submit",disabled:p,children:p?"...":""}),b.jsx("div",{className:"login-link",children:b.jsxs("p",{children:["",b.jsx(bi,{to:"/login",children:""})]})})]})]})})}function QI({children:t}){return b.jsx("div",{className:"main-panel-header",children:t})}function FI(){const{user:t,userProfile:e,fetchUserProfile:n,projectId:s,setProjectId:a}=On(),[l,c]=k.useState(!1),[d,h]=k.useState(""),[f,p]=k.useState(""),[m,y]=k.useState(!1),[_,x]=k.useState(""),[w,A]=k.useState(""),[S,T]=k.useState([]),[E,C]=k.useState(!0),[j,O]=k.useState({}),M=Ls(),D=()=>{G(),c(!0)},q=()=>{G(),c(!1)},G=()=>{h(""),p(""),x(""),A("")},V=()=>d.trim()?d.trim().length>50?(x("50"),!1):f.trim().length>200?(x("200"),!1):!0:(x(""),!1),F=()=>{e&&(C(!0),je.from("projects").select("*").eq("team_id",e?.team_id||null).then(({data:B,error:L})=>{if(C(!1),L){console.error(":",L),x("");return}console.log("projects ",B),T(B)}))},K=async()=>{if(x(""),!!V())try{y(!0);const{error:B}=await je.from("projects").insert({name:d.trim(),description:f.trim(),user_id:t?.id,team_id:e?.team_id||null});if(B){console.error(":",B),x(""+B.message);return}await F(),A(""),q()}catch(B){x(""+B.message),console.error(":",B.message)}finally{y(!1)}};k.useEffect(()=>{F()},[e]),k.useEffect(()=>{s&&M("/editor")},[]);const $=B=>{B.key==="Enter"&&!B.shiftKey&&(B.preventDefault(),K())},Q=B=>{O(L=>({...L,[B.id]:"opening"})),console.log("set project id ",B.id),a(B.id),Rt.emit("StartEditorMode"),localStorage.setItem("projectId",B.id),M("/editor")},R=(B,L)=>{B.stopPropagation(),O(H=>({...H,[L.id]:"editing"})),localStorage.setItem("projectId",L.id),M("/editor"),Rt.emit("StartEditorMode")},U=(B,L)=>{B.stopPropagation(),window.confirm(`"${L.name}"`)&&(console.log(":",L.name),O(H=>({...H,[L.id]:"deleting"})),je.from("projects").delete().eq("id",L.id).then(({error:H})=>{if(H){console.error(":",H),x(""),O(I=>({...I,[L.id]:null}));return}F(),A(""),O(I=>({...I,[L.id]:null}))}))};return b.jsxs("div",{children:[b.jsx(QI,{children:b.jsx("h2",{children:""})}),b.jsx("div",{className:"main-panel-buttons",children:b.jsx("button",{onClick:D,disabled:E,children:E?b.jsxs(b.Fragment,{children:[b.jsx("span",{className:"loading-spinner-small"}),"..."]}):""})}),b.jsx("div",{className:`main-panel-content ${S.length===0?"empty":""}`,children:E?b.jsxs("div",{className:"loading-container",children:[b.jsx("div",{className:"loading-spinner-large"}),b.jsx("p",{children:"..."})]}):S.length>0?S.map(B=>b.jsxs("div",{className:`project-item ${j[B.id]?"loading":""}`,onClick:()=>Q(B),children:[b.jsxs("div",{className:"project-item-content",children:[b.jsx("h4",{children:B.name}),b.jsx("p",{children:B.description})]}),b.jsxs("div",{className:"project-actions",children:[b.jsx("button",{className:"edit-button",onClick:L=>R(L,B),title:"",disabled:j[B.id],children:j[B.id]==="editing"?b.jsxs(b.Fragment,{children:[b.jsx("span",{className:"loading-spinner-small"}),"..."]}):""}),b.jsx("button",{className:"delete-button",onClick:L=>U(L,B),title:"",disabled:j[B.id],children:j[B.id]==="deleting"?b.jsxs(b.Fragment,{children:[b.jsx("span",{className:"loading-spinner-small"}),"..."]}):""})]})]},B.id)):b.jsxs("div",{className:"empty-state",children:[b.jsx("p",{children:""}),b.jsx("button",{onClick:D,children:""})]})}),l&&b.jsx("div",{className:"create-panel-overlay",onClick:q,children:b.jsxs("div",{className:"create-panel",onClick:B=>B.stopPropagation(),children:[b.jsxs("div",{className:"create-panel-header",children:[b.jsx("h3",{children:""}),b.jsx("button",{className:"close-button",onClick:q,disabled:m,children:""})]}),b.jsxs("div",{className:"create-panel-content",children:[_&&b.jsx("div",{className:"error-message",children:_}),w&&b.jsx("div",{className:"success-message",children:w}),b.jsx("input",{type:"text",placeholder:"",className:"story-name-input",value:d,onChange:B=>h(B.target.value),onKeyPress:$,disabled:m||!!w}),b.jsx("textarea",{placeholder:"",className:"story-description-input",value:f,onChange:B=>p(B.target.value),onKeyPress:$,disabled:m||!!w}),b.jsxs("div",{className:"char-count",children:[b.jsxs("span",{children:[": ",d.length,"/50"]}),b.jsxs("span",{children:[": ",f.length,"/200"]})]})]}),b.jsxs("div",{className:"create-panel-footer",children:[b.jsx("button",{className:"cancel-button",onClick:q,disabled:m,children:""}),b.jsxs("button",{className:"confirm-button",onClick:K,disabled:m||!!w,children:[m&&b.jsx("span",{className:"loading-spinner"}),m?"...":""]})]})]})})]})}function VI(){const{user:t,userProfile:e,setProjectId:n,setUserProfile:s,setUser:a,isProfileLoading:l,fetchUserProfile:c}=On(),[d,h]=k.useState(!1),[f,p]=k.useState(!1),[m,y]=k.useState(""),[_,x]=k.useState(!1),[w,A]=k.useState(""),[S,T]=k.useState("./default_avatar.png"),[E,C]=k.useState(!1),[j,O]=k.useState([]),[M,D]=k.useState(""),[q,G]=k.useState(""),[V,F]=k.useState(""),[K,$]=k.useState(!1),[Q,R]=k.useState("list"),U=Ls();k.useEffect(()=>{e||c()},[]),k.useEffect(()=>{B(),e?.avatar_url&&T(e.avatar_url)},[e]);const B=async()=>{if(!e?.team_id){D("");return}try{const{data:pe,error:_e}=await je.from("teams").select("name").eq("id",e.team_id).single();_e?(console.error("Error fetching team name:",_e.message),D("")):D(pe.name)}catch(pe){console.error("Error in fetchTeamName:",pe),D("")}},L=async()=>{try{await je.auth.signOut(),a(null),s(null),n(null),U("/")}catch(pe){console.error(":",pe)}},H=async()=>{try{const{data:pe,error:_e}=await je.from("teams").select("id, name").contains("members",[t.id]);if(_e)throw _e;O(pe||[])}catch(pe){console.error(":",pe),F("")}},I=()=>{H(),F(""),D(""),G(""),R("list"),p(!0)},P=()=>{p(!1),F("")},Y=async()=>{if(!M.trim()){F("");return}if(M.length>20){F("20");return}$(!0),F("");try{const{data:pe,error:_e}=await je.from("teams").insert({name:M.trim(),create_by:t.id,members:[t.id]}).select("id, name");if(_e)throw _e;console.log("newTeam",pe),O(be=>[...be,pe[0]]),D(""),F("","success"),R("list")}catch(pe){console.error(":",pe),F("")}finally{$(!1)}},J=async()=>{if(!q.trim()){F("");return}$(!0),F("");try{if(await new Promise(pe=>setTimeout(pe,1e3)),q==="INVITE1"){const pe={id:Date.now().toString(),name:"",code:q};O(_e=>[..._e,pe]),G(""),F("","success"),R("list")}else F("")}catch(pe){console.error(":",pe),F("")}finally{$(!1)}},Z=async pe=>{$(!0);try{const{error:_e}=await je.from("profiles").update({team_id:pe.id}).eq("id",t.id);if(_e)throw _e;P(),Rt.emit("updateProfile")}catch(_e){console.error(":",_e),F("")}finally{$(!1)}},ae=()=>{y(profile?.display_name||""),A(""),h(!0)},ce=()=>{h(!1),A("")},he=async pe=>{const _e=pe.target.files[0];if(!_e)return;if(!["image/jpeg","image/png","image/gif","image/webp"].includes(_e.type)){alert("JPG, PNG, GIF, WebP");return}if(_e.size>5*1024*1024){alert("5MB");return}C(!0);try{const we=`${Date.now()}${_e.name.slice(_e.name.lastIndexOf("."))}`;console.log("avatar filename = ",we);const{error:ue}=await je.storage.from("avatars").upload(`${t.id}/${we}`,_e,{cacheControl:"3600",upsert:!1});if(ue)throw ue;const{data:te}=je.storage.from("avatars").getPublicUrl(`${t.id}/${we}`);console.log("avatar url = ",te.publicUrl),T(te.publicUrl);const{error:fe}=await je.from("profiles").update({avatar_url:te.publicUrl}).eq("id",t.id);fe&&console.log("update error = ",fe)}catch(we){console.error(":",we),alert("")}finally{C(!1),pe.target.value=""}},ye=async()=>{if(!m.trim()){A("");return}if(m.length>10){A("10");return}x(!0),A("");try{const{error:pe}=await je.from("profiles").update({display_name:m.trim()}).eq("id",t.id);if(pe){console.error(":",pe),A("");return}Rt.emit("updateProfile"),ce()}catch(pe){console.error(":",pe),A("")}finally{x(!1)}};return l?b.jsx("div",{className:"loading",children:"..."}):b.jsxs("div",{className:"profile-container",children:[b.jsxs("div",{className:"profile-header",children:[b.jsx("h1",{children:""}),b.jsx("button",{className:"logout-button",onClick:L,children:""})]}),b.jsx("div",{className:"profile-info",children:b.jsxs("div",{className:"info-section",children:[b.jsx("h2",{children:""}),b.jsxs("div",{className:"avatar-container",onClick:()=>document.getElementById("avatar-upload").click(),children:[E&&b.jsx("div",{className:"avatar-upload-overlay",children:b.jsx("span",{children:"..."})}),b.jsx("img",{src:S||"./default_avatar.png",alt:"",className:"avatar"}),b.jsx("div",{className:"avatar-hint",children:""}),b.jsx("input",{type:"file",id:"avatar-upload",accept:"image/*",style:{display:"none"},onChange:he})]}),b.jsxs("div",{className:"info-item",children:[b.jsx("span",{className:"label",children:""}),b.jsx("span",{className:"value",children:e?.display_name||""}),b.jsx("button",{className:"",onClick:ae,children:""})]}),b.jsxs("div",{className:"info-item",children:[b.jsx("span",{className:"label",children:""}),b.jsx("span",{className:"value",children:e?.gold_coins||"0"}),b.jsx("button",{className:"",children:""})]}),b.jsxs("div",{className:"info-item",children:[b.jsx("span",{className:"label",children:""}),b.jsx("span",{className:"value",children:t?.email||""})]}),b.jsxs("div",{className:"info-item",children:[b.jsx("span",{className:"label",children:""}),b.jsx("span",{className:"value",children:M}),b.jsx("button",{className:"team-switch-button",onClick:I,children:""})]}),b.jsxs("div",{className:"info-item",children:[b.jsx("span",{className:"label",children:""}),b.jsx("span",{className:"value",children:t?.created_at?new Date(t.created_at).toLocaleString():""})]})]})}),d&&b.jsx("div",{className:"modal-overlay",onClick:ce,children:b.jsxs("div",{className:"modal-content",onClick:pe=>pe.stopPropagation(),children:[b.jsxs("div",{className:"modal-header",children:[b.jsx("h3",{children:""}),b.jsx("button",{className:"close-button",onClick:ce,children:""})]}),b.jsxs("div",{className:"modal-body",children:[w&&b.jsx("p",{className:"error-message",children:w}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"displayName",children:""}),b.jsx("input",{type:"text",id:"displayName",value:m,onChange:pe=>y(pe.target.value),placeholder:"",maxLength:50})]})]}),b.jsxs("div",{className:"modal-footer",children:[b.jsx("button",{className:"cancel-button",onClick:ce,children:""}),b.jsx("button",{className:"save-button",onClick:ye,disabled:_,children:_?"...":""})]})]})}),f&&b.jsx("div",{className:"modal-overlay",onClick:P,children:b.jsxs("div",{className:"team-modal-content",onClick:pe=>pe.stopPropagation(),children:[b.jsxs("div",{className:"modal-header",children:[b.jsx("h3",{children:""}),b.jsx("button",{className:"close-button",onClick:P,children:""})]}),b.jsxs("div",{className:"team-modal-tabs",children:[b.jsx("button",{className:`team-tab-button ${Q==="list"?"active":""}`,onClick:()=>R("list"),children:""}),b.jsx("button",{className:`team-tab-button ${Q==="create"?"active":""}`,onClick:()=>R("create"),children:""}),b.jsx("button",{className:`team-tab-button ${Q==="join"?"active":""}`,onClick:()=>R("join"),children:""})]}),b.jsxs("div",{className:"modal-body",children:[V&&b.jsx("p",{className:`${V.includes("")?"success-message":"error-message"}`,children:V}),Q==="list"&&b.jsx("div",{className:"team-list",children:j.length===0?b.jsx("p",{className:"empty-message",children:""}):j.map(pe=>b.jsxs("div",{className:"team-item",children:[b.jsx("div",{className:"team-info",children:b.jsx("h4",{children:pe.name})}),b.jsx("button",{className:"switch-team-button",onClick:()=>Z(pe),disabled:K,children:K?"...":""})]},pe.id))}),Q==="create"&&b.jsxs("div",{className:"create-team-form",children:[b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"teamName",children:""}),b.jsx("input",{type:"text",id:"teamName",value:M,onChange:pe=>D(pe.target.value),placeholder:"",maxLength:20,disabled:K})]}),b.jsx("p",{className:"form-hint",children:""})]}),Q==="join"&&b.jsxs("div",{className:"join-team-form",children:[b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"teamCode",children:"ID"}),b.jsx("input",{type:"text",id:"teamCode",value:q,onChange:pe=>G(pe.target.value.toUpperCase()),placeholder:"ID",disabled:K})]}),b.jsx("p",{className:"form-hint",children:""})]})]}),b.jsxs("div",{className:"modal-footer",children:[Q!=="list"&&b.jsx("button",{className:"action-button",onClick:Q==="create"?Y:J,disabled:K,children:K?"...":Q==="create"?"":""}),b.jsx("button",{className:"cancel-button",onClick:P,children:""})]})]})})]})}function GI(){const{user:t,userProfile:e}=On();return b.jsxs("div",{className:"home-page",children:[b.jsx("h1",{children:""}),b.jsx("p",{children:t?`: ${t.email}`:""})]})}function ld({id:t,type:e,name:n,pic:s,description:a,onEdit:l,onDelete:c}){const d={scene:"",character:"",item:""};return k.useEffect(()=>{console.log(s)},[]),b.jsxs("div",{className:"embody-card",onClick:()=>l&&l(t),children:[b.jsxs("div",{className:"embody-card-header",children:[b.jsx("div",{className:"embody-card-type",children:b.jsx("span",{className:"embody-name",children:n})}),b.jsx("div",{className:"embody-card-actions",children:b.jsx("button",{className:"card-action-btn delete-btn",onClick:()=>c&&c(t),title:"",children:""})})]}),b.jsx("div",{className:"embody-card-image",children:s&&s.length>0?b.jsx("img",{src:gi+s[0].path,alt:n}):b.jsx("img",{src:"./no_pic.png",alt:d[e]})}),b.jsxs("div",{className:"embody-card-content",children:[b.jsx("h3",{className:"embody-card-title",children:n}),b.jsx("p",{className:"embody-card-description",children:a||""})]})]})}function YI(){const{projectId:t,ep_id:e,embodyCache:n,editShotId:s,setEditShotId:a,scDatas:l,shotWithId:c,isLoading_shots_data:d,ep_data:h}=On(),[f,p]=k.useState([]),[m,y]=k.useState({}),[_,x]=k.useState({}),[w,A]=k.useState({}),[S,T]=k.useState(null),[E,C]=k.useState(null),[j,O]=k.useState(""),[M,D]=k.useState(null),[q,G]=k.useState([]);k.useRef(null);const[V,F]=k.useState(!1),[K,$]=k.useState([]),[Q,R]=k.useState(""),[U,B]=k.useState([]),[L,H]=k.useState({}),[I,P]=k.useState(!1),[Y,J]=k.useState(null),[Z,ae]=k.useState(null),[ce,he]=k.useState(""),[ye,pe]=k.useState(""),[_e,be]=k.useState(!1);k.useEffect(()=>{l&&console.log("scDatas",l)},[l]);const we=ge=>{alert("")},ue=ge=>{a(ge),console.log(":",ge),Rt.emit("changeEditorMode","edit")},te=ge=>{window.confirm(""+ge)&&je.from("movie_seqs").delete().eq("id",ge).then(({data:Le,error:Me})=>{if(Me){console.error(":",Me);return}console.log(":",Le),refreshShotsData(new AbortController)})};function fe(ge,Le){console.log(":",ge,Le),C(ge),O(Le);const Me=c[ge][Le]||"";if(console.log(Me),D(Me),Le==="embodys"){var Ke=[];Me.forEach(tt=>{n[tt]?Ke.push(n[tt]):console.error("ID:",tt)}),console.log("emlist",Ke),G(Ke)}}const Te=ge=>({character:"#3498db",item:"#2ecc71",scene:"#e74c3c",:"#f39c12",:"#9b59b6"})[ge]||"#95a5a6",De=ge=>!ge||ge===""||ge===""||!Array.isArray(ge)||ge.length===0?"":ge.map((Me,Ke)=>{if(n&&n[Me]){const tt=n[Me],pt=Te(tt.type);return b.jsxs("span",{style:{marginRight:"8px"},children:[b.jsx("span",{style:{color:pt,fontWeight:"bold",marginRight:"2px"},children:tt.name}),Ke<ge.length-1&&", "]},Me)}else return console.log("ID:",Me),b.jsxs("span",{style:{marginRight:"8px",color:"#999"},children:["",Ke<ge.length-1&&", "]},Me)}),Xe=ge=>{B(Le=>Le.includes(ge)?Le.filter(Me=>Me!==ge):[...Le,ge])},ct=()=>{const ge=K.filter(Ke=>U.includes(Ke.id)),Le=new Set(q.map(Ke=>Ke.name)),Me=ge.filter(Ke=>!Le.has(Ke.name)).map(Ke=>({id:Ke.id,name:Ke.name,type:Ke.type}));console.log(":",Me),G(Ke=>[...Ke,...Me]),F(!1),B([]),R("")},et=async ge=>{if(ge.preventDefault(),n){const Le=Object.values(n);$(Le),console.log("embodyCache:",Le.length)}else console.warn("embodyCache"),$([]);F(!0)},pn=ge=>{const Le=[...q];Le.splice(ge,1),G(Le)},Gt=()=>{},ft=ge=>{window.confirm(""+ge)&&je.from("movie_shots").delete().eq("id",ge).then(({data:Le,error:Me})=>{if(Me){console.error(":",Me);return}console.log(":",Le),refreshShotsData(new AbortController)})},gn=ge=>{window.confirm(""+ge)&&je.from("movie_scs").delete().eq("id",ge).then(({data:Le,error:Me})=>{if(Me){console.error(":",Me);return}console.log(":",Le),refreshShotsData(new AbortController)})},kn=(ge,Le)=>{J(ge),ae(Le),he(""),pe(""),P(!0)},nn=async()=>{if(!ce.trim()){alert("");return}try{const{data:ge,error:Le}=await je.from("movie_seqs").select("index").eq("sc_id",Y).order("index",{ascending:!1}).limit(1);let Me=1;!Le&&ge&&ge.length>0&&(Me=ge[0].index+1);const Ke={sc_id:Y,name:ce.trim(),index:Me},{data:tt,error:pt}=await je.from("movie_seqs").insert(Ke);if(pt){console.error(":",pt),alert("");return}console.log(":",tt),refreshShotsData(new AbortController),P(!1)}catch(ge){console.error(":",ge),alert("")}},rn=async()=>{if(!E||!j){console.error("");return}try{let ge=M;if(console.log(M),j==="embodys"){const tt=(Array.isArray(q)?q:[]).filter(pt=>pt&&pt.id);ge=tt.map(pt=>pt.id),console.log(":",tt)}const{data:Le,error:Me}=await je.from("movie_shots").update({[j]:ge}).eq("id",E);if(Me){console.error(":",Me),alert("");return}c[E]&&(c[E][j]=ge,setShotWithId({...c})),await refreshShotsData(new AbortController)}catch(ge){console.error(":",ge),alert("")}finally{C(null),O(null),D(""),G([])}},br=async()=>{try{const{data:ge,error:Le}=await je.from("movie_scs").select("index").eq("ep_id",e).order("index",{ascending:!1}).limit(1);let Me=1;!Le&&ge&&ge.length>0&&(Me=ge[0].index+1);const Ke={ep_id:e,name:"",index:Me},{data:tt,error:pt}=await je.from("movie_scs").insert(Ke);if(pt){console.error(":",pt),alert("");return}console.log(":",tt),refreshShotsData(new AbortController)}catch(ge){console.error(":",ge),alert("")}};return b.jsxs("div",{className:"editor-shots-content",children:[b.jsxs("div",{className:"editor-shots-header",children:[b.jsxs("h3",{className:"ep-number",children:[" ",h.index,"   -  ",h.title]}),b.jsx("button",{className:"add-sc-button",onClick:br,children:""})]}),d&&b.jsxs("div",{className:"shots-loading-overlay",children:[b.jsx("div",{className:"shots-loading-spinner"}),b.jsx("div",{className:"shots-loading-text",children:"..."})]}),b.jsx("div",{className:"editor-shots-container-left",children:l.map(ge=>b.jsxs("div",{className:"sc-card",children:[b.jsxs("div",{className:"sc-card-header",children:[b.jsxs("h3",{className:"sc-name",children:["",ge.index,"-",ge.name]}),b.jsx("button",{className:"add-seq-button",title:"",onClick:()=>gn(ge.id),children:"-"}),b.jsx("button",{className:"add-seq-button",title:"",onClick:()=>kn(ge.id,ge.index),children:"+"})]}),b.jsx("div",{className:"sc-seqs",children:ge.movie_seqs.map(Le=>b.jsxs("div",{className:"seq-item",children:[b.jsxs("div",{className:"seq-item-header",children:[b.jsx("p",{className:"seq-item-name",children:Le.name}),b.jsx("button",{className:"add-shot-button",title:"",onClick:()=>te(Le.id),children:"-"}),b.jsx("button",{className:"add-shot-button",title:"",onClick:()=>we(Le.id),children:"+"})]}),b.jsx("div",{className:"seq-shots",children:b.jsxs("table",{className:"shot-table",children:[b.jsx("thead",{children:b.jsxs("tr",{children:[b.jsx("th",{children:""}),b.jsx("th",{children:""}),b.jsx("th",{children:""}),b.jsx("th",{children:""}),b.jsx("th",{children:""}),b.jsx("th",{children:""})]})}),b.jsx("tbody",{children:Le.movie_shots.map((Me,Ke)=>b.jsxs("tr",{className:"shot-item",children:[b.jsx("td",{children:Me.index}),b.jsx("td",{children:Me.pic?b.jsx("img",{src:Me.pic,alt:Me.descript||"./shot_thumb_default.png",style:{width:"120px",height:"60px",objectFit:"cover",objectPosition:"center"}}):b.jsx("img",{src:"./shot_thumb_default.png",alt:"",style:{width:"60px",height:"50px",objectFit:"cover",objectPosition:"center"}})}),b.jsx("td",{onClick:()=>fe(Me.id,"description"),style:{cursor:"pointer"},children:Me.description||""}),b.jsx("td",{onClick:()=>fe(Me.id,"prompt"),style:{cursor:"pointer"},children:Me.prompt||""}),b.jsx("td",{onClick:()=>fe(Me.id,"embodys"),style:{cursor:"pointer"},children:De(Me.embodys)}),b.jsxs("td",{className:"shot-action-buttons",children:[b.jsx("button",{onClick:()=>ue(Me.id),title:"",className:"op-button op-edit-button",children:""}),b.jsx("button",{onClick:()=>ft(Me.id),title:"",className:"op-button op-delete-button",children:""})]})]},Me.id))})]})})]},Le.id))})]},ge.index))}),b.jsxs("div",{className:"editor-shots-container-right",style:{display:E?"block":"none"},children:[j==="description"&&b.jsxs("div",{className:"right-edit-field",children:[b.jsx("label",{children:":"}),b.jsx("textarea",{className:"edit-field-textarea",value:M,onChange:ge=>D(ge.target.value)}),b.jsxs("div",{className:"edit-button-container",children:[b.jsx("button",{className:"expand-button",onClick:Gt,children:""}),b.jsx("button",{className:"save-button",onClick:rn,children:""})]})]}),j==="prompt"&&b.jsxs("div",{className:"right-edit-field",children:[b.jsx("label",{children:":"}),b.jsx("textarea",{className:"edit-field-textarea",value:M,onChange:ge=>D(ge.target.value)}),b.jsxs("div",{className:"edit-button-container",children:[b.jsx("button",{className:"expand-button",onClick:Gt,children:""}),b.jsx("button",{className:"save-button",onClick:rn,children:""})]})]}),j==="embodys"&&b.jsxs("div",{className:"right-edit-field",children:[b.jsx("label",{children:":"}),b.jsx("div",{className:"embodys-list-container",children:b.jsx("div",{className:"embodys-list",children:q.map((ge,Le)=>b.jsxs("div",{className:"embodys-item",children:[b.jsx("span",{className:"embodys-name",children:ge.name}),b.jsx("span",{className:"embodys-type",children:ge.type}),b.jsx("button",{className:"delete-embodys-item",onClick:()=>pn(Le),children:""})]},Le))})}),b.jsxs("div",{className:"edit-button-container",children:[b.jsx("button",{className:"add-embodys-button",onClick:et,children:""}),b.jsx("button",{className:"save-button",onClick:rn,children:""})]})]})]}),I&&b.jsx("div",{className:"modal-overlay",children:b.jsxs("div",{className:"modal-content",children:[b.jsxs("div",{className:"modal-header",children:[b.jsx("h3",{children:""}),b.jsx("button",{className:"modal-close",onClick:()=>P(!1),children:""})]}),b.jsx("div",{className:"modal-body",children:b.jsxs("div",{className:"form-group",children:[b.jsx("label",{children:":"}),b.jsx("input",{type:"text",value:ce,onChange:ge=>he(ge.target.value),placeholder:"",className:"modal-input"})]})}),b.jsxs("div",{className:"modal-footer",children:[b.jsx("button",{className:"modal-cancel",onClick:()=>P(!1),children:""}),b.jsx("button",{className:"modal-confirm",onClick:nn,children:""})]})]})}),V&&b.jsx("div",{className:"modal-overlay",children:b.jsxs("div",{className:"modal-content embody-select-modal",children:[b.jsxs("div",{className:"modal-header",children:[b.jsx("h3",{children:""}),b.jsx("button",{className:"modal-close",onClick:()=>{F(!1),B([]),R("")},children:""})]}),b.jsxs("div",{className:"modal-body",children:[b.jsxs("div",{className:"form-group",children:[b.jsx("label",{children:":"}),b.jsx("input",{type:"text",value:Q,onChange:ge=>R(ge.target.value),placeholder:"",className:"modal-input"})]}),b.jsxs("div",{className:"embodys-select-list card-view",children:[K.filter(ge=>ge.name.toLowerCase().includes(Q.toLowerCase())||ge.description?.toLowerCase().includes(Q.toLowerCase())).map(ge=>b.jsxs("div",{className:`embody-card-wrapper ${U.includes(ge.id)?"selected":""}`,onClick:Le=>{Le.stopPropagation(),Xe(ge.id)},children:[b.jsx(ld,{id:ge.id,type:ge.type,name:ge.name,pic:ge.pic,description:ge.description,onEdit:()=>{},onDelete:()=>{}}),U.includes(ge.id)&&b.jsx("div",{className:"card-select-indicator",children:""})]},ge.id)),K.filter(ge=>ge.name.toLowerCase().includes(Q.toLowerCase())||ge.description?.toLowerCase().includes(Q.toLowerCase())).length===0&&b.jsx("p",{className:"no-results",children:""})]})]}),b.jsxs("div",{className:"modal-footer",children:[b.jsx("button",{className:"modal-cancel",onClick:()=>{F(!1),B([]),R("")},children:""}),b.jsxs("button",{className:"modal-confirm",onClick:ct,disabled:U.length===0,children:[" (",U.length,")"]})]})]})})]})}function Ot(t){if(typeof t=="string"||typeof t=="number")return""+t;let e="";if(Array.isArray(t))for(let n=0,s;n<t.length;n++)(s=Ot(t[n]))!==""&&(e+=(e&&" ")+s);else for(let n in t)t[n]&&(e+=(e&&" ")+n);return e}var XI={value:()=>{}};function nf(){for(var t=0,e=arguments.length,n={},s;t<e;++t){if(!(s=arguments[t]+"")||s in n||/[\s.]/.test(s))throw new Error("illegal type: "+s);n[s]=[]}return new cd(n)}function cd(t){this._=t}function KI(t,e){return t.trim().split(/^|\s+/).map(function(n){var s="",a=n.indexOf(".");if(a>=0&&(s=n.slice(a+1),n=n.slice(0,a)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:s}})}cd.prototype=nf.prototype={constructor:cd,on:function(t,e){var n=this._,s=KI(t+"",n),a,l=-1,c=s.length;if(arguments.length<2){for(;++l<c;)if((a=(t=s[l]).type)&&(a=WI(n[a],t.name)))return a;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++l<c;)if(a=(t=s[l]).type)n[a]=mw(n[a],t.name,e);else if(e==null)for(a in n)n[a]=mw(n[a],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new cd(t)},call:function(t,e){if((a=arguments.length-2)>0)for(var n=new Array(a),s=0,a,l;s<a;++s)n[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(l=this._[t],s=0,a=l.length;s<a;++s)l[s].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var s=this._[t],a=0,l=s.length;a<l;++a)s[a].value.apply(e,n)}};function WI(t,e){for(var n=0,s=t.length,a;n<s;++n)if((a=t[n]).name===e)return a.value}function mw(t,e,n){for(var s=0,a=t.length;s<a;++s)if(t[s].name===e){t[s]=XI,t=t.slice(0,s).concat(t.slice(s+1));break}return n!=null&&t.push({name:e,value:n}),t}var qp="http://www.w3.org/1999/xhtml";const pw={svg:"http://www.w3.org/2000/svg",xhtml:qp,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function rf(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),pw.hasOwnProperty(e)?{space:pw[e],local:t}:t}function JI(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===qp&&e.documentElement.namespaceURI===qp?e.createElement(t):e.createElementNS(n,t)}}function ZI(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function wE(t){var e=rf(t);return(e.local?ZI:JI)(e)}function ek(){}function Dg(t){return t==null?ek:function(){return this.querySelector(t)}}function tk(t){typeof t!="function"&&(t=Dg(t));for(var e=this._groups,n=e.length,s=new Array(n),a=0;a<n;++a)for(var l=e[a],c=l.length,d=s[a]=new Array(c),h,f,p=0;p<c;++p)(h=l[p])&&(f=t.call(h,h.__data__,p,l))&&("__data__"in h&&(f.__data__=h.__data__),d[p]=f);return new In(s,this._parents)}function nk(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function rk(){return[]}function xE(t){return t==null?rk:function(){return this.querySelectorAll(t)}}function sk(t){return function(){return nk(t.apply(this,arguments))}}function ik(t){typeof t=="function"?t=sk(t):t=xE(t);for(var e=this._groups,n=e.length,s=[],a=[],l=0;l<n;++l)for(var c=e[l],d=c.length,h,f=0;f<d;++f)(h=c[f])&&(s.push(t.call(h,h.__data__,f,c)),a.push(h));return new In(s,a)}function AE(t){return function(){return this.matches(t)}}function EE(t){return function(e){return e.matches(t)}}var ak=Array.prototype.find;function ok(t){return function(){return ak.call(this.children,t)}}function lk(){return this.firstElementChild}function ck(t){return this.select(t==null?lk:ok(typeof t=="function"?t:EE(t)))}var uk=Array.prototype.filter;function dk(){return Array.from(this.children)}function fk(t){return function(){return uk.call(this.children,t)}}function hk(t){return this.selectAll(t==null?dk:fk(typeof t=="function"?t:EE(t)))}function mk(t){typeof t!="function"&&(t=AE(t));for(var e=this._groups,n=e.length,s=new Array(n),a=0;a<n;++a)for(var l=e[a],c=l.length,d=s[a]=[],h,f=0;f<c;++f)(h=l[f])&&t.call(h,h.__data__,f,l)&&d.push(h);return new In(s,this._parents)}function SE(t){return new Array(t.length)}function pk(){return new In(this._enter||this._groups.map(SE),this._parents)}function jd(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}jd.prototype={constructor:jd,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function gk(t){return function(){return t}}function yk(t,e,n,s,a,l){for(var c=0,d,h=e.length,f=l.length;c<f;++c)(d=e[c])?(d.__data__=l[c],s[c]=d):n[c]=new jd(t,l[c]);for(;c<h;++c)(d=e[c])&&(a[c]=d)}function vk(t,e,n,s,a,l,c){var d,h,f=new Map,p=e.length,m=l.length,y=new Array(p),_;for(d=0;d<p;++d)(h=e[d])&&(y[d]=_=c.call(h,h.__data__,d,e)+"",f.has(_)?a[d]=h:f.set(_,h));for(d=0;d<m;++d)_=c.call(t,l[d],d,l)+"",(h=f.get(_))?(s[d]=h,h.__data__=l[d],f.delete(_)):n[d]=new jd(t,l[d]);for(d=0;d<p;++d)(h=e[d])&&f.get(y[d])===h&&(a[d]=h)}function _k(t){return t.__data__}function bk(t,e){if(!arguments.length)return Array.from(this,_k);var n=e?vk:yk,s=this._parents,a=this._groups;typeof t!="function"&&(t=gk(t));for(var l=a.length,c=new Array(l),d=new Array(l),h=new Array(l),f=0;f<l;++f){var p=s[f],m=a[f],y=m.length,_=wk(t.call(p,p&&p.__data__,f,s)),x=_.length,w=d[f]=new Array(x),A=c[f]=new Array(x),S=h[f]=new Array(y);n(p,m,w,A,S,_,e);for(var T=0,E=0,C,j;T<x;++T)if(C=w[T]){for(T>=E&&(E=T+1);!(j=A[E])&&++E<x;);C._next=j||null}}return c=new In(c,s),c._enter=d,c._exit=h,c}function wk(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function xk(){return new In(this._exit||this._groups.map(SE),this._parents)}function Ak(t,e,n){var s=this.enter(),a=this,l=this.exit();return typeof t=="function"?(s=t(s),s&&(s=s.selection())):s=s.append(t+""),e!=null&&(a=e(a),a&&(a=a.selection())),n==null?l.remove():n(l),s&&a?s.merge(a).order():a}function Ek(t){for(var e=t.selection?t.selection():t,n=this._groups,s=e._groups,a=n.length,l=s.length,c=Math.min(a,l),d=new Array(a),h=0;h<c;++h)for(var f=n[h],p=s[h],m=f.length,y=d[h]=new Array(m),_,x=0;x<m;++x)(_=f[x]||p[x])&&(y[x]=_);for(;h<a;++h)d[h]=n[h];return new In(d,this._parents)}function Sk(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var s=t[e],a=s.length-1,l=s[a],c;--a>=0;)(c=s[a])&&(l&&c.compareDocumentPosition(l)^4&&l.parentNode.insertBefore(c,l),l=c);return this}function Ck(t){t||(t=Tk);function e(m,y){return m&&y?t(m.__data__,y.__data__):!m-!y}for(var n=this._groups,s=n.length,a=new Array(s),l=0;l<s;++l){for(var c=n[l],d=c.length,h=a[l]=new Array(d),f,p=0;p<d;++p)(f=c[p])&&(h[p]=f);h.sort(e)}return new In(a,this._parents).order()}function Tk(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Nk(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Rk(){return Array.from(this)}function jk(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var s=t[e],a=0,l=s.length;a<l;++a){var c=s[a];if(c)return c}return null}function Ok(){let t=0;for(const e of this)++t;return t}function Ik(){return!this.node()}function kk(t){for(var e=this._groups,n=0,s=e.length;n<s;++n)for(var a=e[n],l=0,c=a.length,d;l<c;++l)(d=a[l])&&t.call(d,d.__data__,l,a);return this}function Mk(t){return function(){this.removeAttribute(t)}}function Dk(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Bk(t,e){return function(){this.setAttribute(t,e)}}function Uk(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Lk(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function $k(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function zk(t,e){var n=rf(t);if(arguments.length<2){var s=this.node();return n.local?s.getAttributeNS(n.space,n.local):s.getAttribute(n)}return this.each((e==null?n.local?Dk:Mk:typeof e=="function"?n.local?$k:Lk:n.local?Uk:Bk)(n,e))}function CE(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Pk(t){return function(){this.style.removeProperty(t)}}function Hk(t,e,n){return function(){this.style.setProperty(t,e,n)}}function qk(t,e,n){return function(){var s=e.apply(this,arguments);s==null?this.style.removeProperty(t):this.style.setProperty(t,s,n)}}function Qk(t,e,n){return arguments.length>1?this.each((e==null?Pk:typeof e=="function"?qk:Hk)(t,e,n??"")):Pa(this.node(),t)}function Pa(t,e){return t.style.getPropertyValue(e)||CE(t).getComputedStyle(t,null).getPropertyValue(e)}function Fk(t){return function(){delete this[t]}}function Vk(t,e){return function(){this[t]=e}}function Gk(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Yk(t,e){return arguments.length>1?this.each((e==null?Fk:typeof e=="function"?Gk:Vk)(t,e)):this.node()[t]}function TE(t){return t.trim().split(/^|\s+/)}function Bg(t){return t.classList||new NE(t)}function NE(t){this._node=t,this._names=TE(t.getAttribute("class")||"")}NE.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function RE(t,e){for(var n=Bg(t),s=-1,a=e.length;++s<a;)n.add(e[s])}function jE(t,e){for(var n=Bg(t),s=-1,a=e.length;++s<a;)n.remove(e[s])}function Xk(t){return function(){RE(this,t)}}function Kk(t){return function(){jE(this,t)}}function Wk(t,e){return function(){(e.apply(this,arguments)?RE:jE)(this,t)}}function Jk(t,e){var n=TE(t+"");if(arguments.length<2){for(var s=Bg(this.node()),a=-1,l=n.length;++a<l;)if(!s.contains(n[a]))return!1;return!0}return this.each((typeof e=="function"?Wk:e?Xk:Kk)(n,e))}function Zk(){this.textContent=""}function eM(t){return function(){this.textContent=t}}function tM(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function nM(t){return arguments.length?this.each(t==null?Zk:(typeof t=="function"?tM:eM)(t)):this.node().textContent}function rM(){this.innerHTML=""}function sM(t){return function(){this.innerHTML=t}}function iM(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function aM(t){return arguments.length?this.each(t==null?rM:(typeof t=="function"?iM:sM)(t)):this.node().innerHTML}function oM(){this.nextSibling&&this.parentNode.appendChild(this)}function lM(){return this.each(oM)}function cM(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function uM(){return this.each(cM)}function dM(t){var e=typeof t=="function"?t:wE(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function fM(){return null}function hM(t,e){var n=typeof t=="function"?t:wE(t),s=e==null?fM:typeof e=="function"?e:Dg(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),s.apply(this,arguments)||null)})}function mM(){var t=this.parentNode;t&&t.removeChild(this)}function pM(){return this.each(mM)}function gM(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function yM(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function vM(t){return this.select(t?yM:gM)}function _M(t){return arguments.length?this.property("__data__",t):this.node().__data__}function bM(t){return function(e){t.call(this,e,this.__data__)}}function wM(t){return t.trim().split(/^|\s+/).map(function(e){var n="",s=e.indexOf(".");return s>=0&&(n=e.slice(s+1),e=e.slice(0,s)),{type:e,name:n}})}function xM(t){return function(){var e=this.__on;if(e){for(var n=0,s=-1,a=e.length,l;n<a;++n)l=e[n],(!t.type||l.type===t.type)&&l.name===t.name?this.removeEventListener(l.type,l.listener,l.options):e[++s]=l;++s?e.length=s:delete this.__on}}}function AM(t,e,n){return function(){var s=this.__on,a,l=bM(e);if(s){for(var c=0,d=s.length;c<d;++c)if((a=s[c]).type===t.type&&a.name===t.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=l,a.options=n),a.value=e;return}}this.addEventListener(t.type,l,n),a={type:t.type,name:t.name,value:e,listener:l,options:n},s?s.push(a):this.__on=[a]}}function EM(t,e,n){var s=wM(t+""),a,l=s.length,c;if(arguments.length<2){var d=this.node().__on;if(d){for(var h=0,f=d.length,p;h<f;++h)for(a=0,p=d[h];a<l;++a)if((c=s[a]).type===p.type&&c.name===p.name)return p.value}return}for(d=e?AM:xM,a=0;a<l;++a)this.each(d(s[a],e,n));return this}function OE(t,e,n){var s=CE(t),a=s.CustomEvent;typeof a=="function"?a=new a(e,n):(a=s.document.createEvent("Event"),n?(a.initEvent(e,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(e,!1,!1)),t.dispatchEvent(a)}function SM(t,e){return function(){return OE(this,t,e)}}function CM(t,e){return function(){return OE(this,t,e.apply(this,arguments))}}function TM(t,e){return this.each((typeof e=="function"?CM:SM)(t,e))}function*NM(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var s=t[e],a=0,l=s.length,c;a<l;++a)(c=s[a])&&(yield c)}var IE=[null];function In(t,e){this._groups=t,this._parents=e}function Jl(){return new In([[document.documentElement]],IE)}function RM(){return this}In.prototype=Jl.prototype={constructor:In,select:tk,selectAll:ik,selectChild:ck,selectChildren:hk,filter:mk,data:bk,enter:pk,exit:xk,join:Ak,merge:Ek,selection:RM,order:Sk,sort:Ck,call:Nk,nodes:Rk,node:jk,size:Ok,empty:Ik,each:kk,attr:zk,style:Qk,property:Yk,classed:Jk,text:nM,html:aM,raise:lM,lower:uM,append:dM,insert:hM,remove:pM,clone:vM,datum:_M,on:EM,dispatch:TM,[Symbol.iterator]:NM};function jn(t){return typeof t=="string"?new In([[document.querySelector(t)]],[document.documentElement]):new In([[t]],IE)}function jM(t){let e;for(;e=t.sourceEvent;)t=e;return t}function tr(t,e){if(t=jM(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var s=n.createSVGPoint();return s.x=t.clientX,s.y=t.clientY,s=s.matrixTransform(e.getScreenCTM().inverse()),[s.x,s.y]}if(e.getBoundingClientRect){var a=e.getBoundingClientRect();return[t.clientX-a.left-e.clientLeft,t.clientY-a.top-e.clientTop]}}return[t.pageX,t.pageY]}const OM={passive:!1},Ml={capture:!0,passive:!1};function sp(t){t.stopImmediatePropagation()}function La(t){t.preventDefault(),t.stopImmediatePropagation()}function kE(t){var e=t.document.documentElement,n=jn(t).on("dragstart.drag",La,Ml);"onselectstart"in e?n.on("selectstart.drag",La,Ml):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function ME(t,e){var n=t.document.documentElement,s=jn(t).on("dragstart.drag",null);e&&(s.on("click.drag",La,Ml),setTimeout(function(){s.on("click.drag",null)},0)),"onselectstart"in n?s.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const qu=t=>()=>t;function Qp(t,{sourceEvent:e,subject:n,target:s,identifier:a,active:l,x:c,y:d,dx:h,dy:f,dispatch:p}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:s,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:l,enumerable:!0,configurable:!0},x:{value:c,enumerable:!0,configurable:!0},y:{value:d,enumerable:!0,configurable:!0},dx:{value:h,enumerable:!0,configurable:!0},dy:{value:f,enumerable:!0,configurable:!0},_:{value:p}})}Qp.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function IM(t){return!t.ctrlKey&&!t.button}function kM(){return this.parentNode}function MM(t,e){return e??{x:t.x,y:t.y}}function DM(){return navigator.maxTouchPoints||"ontouchstart"in this}function DE(){var t=IM,e=kM,n=MM,s=DM,a={},l=nf("start","drag","end"),c=0,d,h,f,p,m=0;function y(C){C.on("mousedown.drag",_).filter(s).on("touchstart.drag",A).on("touchmove.drag",S,OM).on("touchend.drag touchcancel.drag",T).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function _(C,j){if(!(p||!t.call(this,C,j))){var O=E(this,e.call(this,C,j),C,j,"mouse");O&&(jn(C.view).on("mousemove.drag",x,Ml).on("mouseup.drag",w,Ml),kE(C.view),sp(C),f=!1,d=C.clientX,h=C.clientY,O("start",C))}}function x(C){if(La(C),!f){var j=C.clientX-d,O=C.clientY-h;f=j*j+O*O>m}a.mouse("drag",C)}function w(C){jn(C.view).on("mousemove.drag mouseup.drag",null),ME(C.view,f),La(C),a.mouse("end",C)}function A(C,j){if(t.call(this,C,j)){var O=C.changedTouches,M=e.call(this,C,j),D=O.length,q,G;for(q=0;q<D;++q)(G=E(this,M,C,j,O[q].identifier,O[q]))&&(sp(C),G("start",C,O[q]))}}function S(C){var j=C.changedTouches,O=j.length,M,D;for(M=0;M<O;++M)(D=a[j[M].identifier])&&(La(C),D("drag",C,j[M]))}function T(C){var j=C.changedTouches,O=j.length,M,D;for(p&&clearTimeout(p),p=setTimeout(function(){p=null},500),M=0;M<O;++M)(D=a[j[M].identifier])&&(sp(C),D("end",C,j[M]))}function E(C,j,O,M,D,q){var G=l.copy(),V=tr(q||O,j),F,K,$;if(($=n.call(C,new Qp("beforestart",{sourceEvent:O,target:y,identifier:D,active:c,x:V[0],y:V[1],dx:0,dy:0,dispatch:G}),M))!=null)return F=$.x-V[0]||0,K=$.y-V[1]||0,function Q(R,U,B){var L=V,H;switch(R){case"start":a[D]=Q,H=c++;break;case"end":delete a[D],--c;case"drag":V=tr(B||U,j),H=c;break}G.call(R,C,new Qp(R,{sourceEvent:U,subject:$,target:y,identifier:D,active:H,x:V[0]+F,y:V[1]+K,dx:V[0]-L[0],dy:V[1]-L[1],dispatch:G}),M)}}return y.filter=function(C){return arguments.length?(t=typeof C=="function"?C:qu(!!C),y):t},y.container=function(C){return arguments.length?(e=typeof C=="function"?C:qu(C),y):e},y.subject=function(C){return arguments.length?(n=typeof C=="function"?C:qu(C),y):n},y.touchable=function(C){return arguments.length?(s=typeof C=="function"?C:qu(!!C),y):s},y.on=function(){var C=l.on.apply(l,arguments);return C===l?y:C},y.clickDistance=function(C){return arguments.length?(m=(C=+C)*C,y):Math.sqrt(m)},y}function Ug(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function BE(t,e){var n=Object.create(t.prototype);for(var s in e)n[s]=e[s];return n}function Zl(){}var Dl=.7,Od=1/Dl,$a="\\s*([+-]?\\d+)\\s*",Bl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",gr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",BM=/^#([0-9a-f]{3,8})$/,UM=new RegExp(`^rgb\\(${$a},${$a},${$a}\\)$`),LM=new RegExp(`^rgb\\(${gr},${gr},${gr}\\)$`),$M=new RegExp(`^rgba\\(${$a},${$a},${$a},${Bl}\\)$`),zM=new RegExp(`^rgba\\(${gr},${gr},${gr},${Bl}\\)$`),PM=new RegExp(`^hsl\\(${Bl},${gr},${gr}\\)$`),HM=new RegExp(`^hsla\\(${Bl},${gr},${gr},${Bl}\\)$`),gw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ug(Zl,Ai,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:yw,formatHex:yw,formatHex8:qM,formatHsl:QM,formatRgb:vw,toString:vw});function yw(){return this.rgb().formatHex()}function qM(){return this.rgb().formatHex8()}function QM(){return UE(this).formatHsl()}function vw(){return this.rgb().formatRgb()}function Ai(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=BM.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?_w(e):n===3?new mn(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Qu(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Qu(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=UM.exec(t))?new mn(e[1],e[2],e[3],1):(e=LM.exec(t))?new mn(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=$M.exec(t))?Qu(e[1],e[2],e[3],e[4]):(e=zM.exec(t))?Qu(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=PM.exec(t))?xw(e[1],e[2]/100,e[3]/100,1):(e=HM.exec(t))?xw(e[1],e[2]/100,e[3]/100,e[4]):gw.hasOwnProperty(t)?_w(gw[t]):t==="transparent"?new mn(NaN,NaN,NaN,0):null}function _w(t){return new mn(t>>16&255,t>>8&255,t&255,1)}function Qu(t,e,n,s){return s<=0&&(t=e=n=NaN),new mn(t,e,n,s)}function FM(t){return t instanceof Zl||(t=Ai(t)),t?(t=t.rgb(),new mn(t.r,t.g,t.b,t.opacity)):new mn}function Fp(t,e,n,s){return arguments.length===1?FM(t):new mn(t,e,n,s??1)}function mn(t,e,n,s){this.r=+t,this.g=+e,this.b=+n,this.opacity=+s}Ug(mn,Fp,BE(Zl,{brighter(t){return t=t==null?Od:Math.pow(Od,t),new mn(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Dl:Math.pow(Dl,t),new mn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new mn(wi(this.r),wi(this.g),wi(this.b),Id(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:bw,formatHex:bw,formatHex8:VM,formatRgb:ww,toString:ww}));function bw(){return`#${yi(this.r)}${yi(this.g)}${yi(this.b)}`}function VM(){return`#${yi(this.r)}${yi(this.g)}${yi(this.b)}${yi((isNaN(this.opacity)?1:this.opacity)*255)}`}function ww(){const t=Id(this.opacity);return`${t===1?"rgb(":"rgba("}${wi(this.r)}, ${wi(this.g)}, ${wi(this.b)}${t===1?")":`, ${t})`}`}function Id(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function wi(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function yi(t){return t=wi(t),(t<16?"0":"")+t.toString(16)}function xw(t,e,n,s){return s<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new nr(t,e,n,s)}function UE(t){if(t instanceof nr)return new nr(t.h,t.s,t.l,t.opacity);if(t instanceof Zl||(t=Ai(t)),!t)return new nr;if(t instanceof nr)return t;t=t.rgb();var e=t.r/255,n=t.g/255,s=t.b/255,a=Math.min(e,n,s),l=Math.max(e,n,s),c=NaN,d=l-a,h=(l+a)/2;return d?(e===l?c=(n-s)/d+(n<s)*6:n===l?c=(s-e)/d+2:c=(e-n)/d+4,d/=h<.5?l+a:2-l-a,c*=60):d=h>0&&h<1?0:c,new nr(c,d,h,t.opacity)}function GM(t,e,n,s){return arguments.length===1?UE(t):new nr(t,e,n,s??1)}function nr(t,e,n,s){this.h=+t,this.s=+e,this.l=+n,this.opacity=+s}Ug(nr,GM,BE(Zl,{brighter(t){return t=t==null?Od:Math.pow(Od,t),new nr(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Dl:Math.pow(Dl,t),new nr(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,s=n+(n<.5?n:1-n)*e,a=2*n-s;return new mn(ip(t>=240?t-240:t+120,a,s),ip(t,a,s),ip(t<120?t+240:t-120,a,s),this.opacity)},clamp(){return new nr(Aw(this.h),Fu(this.s),Fu(this.l),Id(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Id(this.opacity);return`${t===1?"hsl(":"hsla("}${Aw(this.h)}, ${Fu(this.s)*100}%, ${Fu(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Aw(t){return t=(t||0)%360,t<0?t+360:t}function Fu(t){return Math.max(0,Math.min(1,t||0))}function ip(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Lg=t=>()=>t;function YM(t,e){return function(n){return t+n*e}}function XM(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(s){return Math.pow(t+s*e,n)}}function KM(t){return(t=+t)==1?LE:function(e,n){return n-e?XM(e,n,t):Lg(isNaN(e)?n:e)}}function LE(t,e){var n=e-t;return n?YM(t,n):Lg(isNaN(t)?e:t)}const kd=(function t(e){var n=KM(e);function s(a,l){var c=n((a=Fp(a)).r,(l=Fp(l)).r),d=n(a.g,l.g),h=n(a.b,l.b),f=LE(a.opacity,l.opacity);return function(p){return a.r=c(p),a.g=d(p),a.b=h(p),a.opacity=f(p),a+""}}return s.gamma=t,s})(1);function WM(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,s=e.slice(),a;return function(l){for(a=0;a<n;++a)s[a]=t[a]*(1-l)+e[a]*l;return s}}function JM(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function ZM(t,e){var n=e?e.length:0,s=t?Math.min(n,t.length):0,a=new Array(s),l=new Array(n),c;for(c=0;c<s;++c)a[c]=El(t[c],e[c]);for(;c<n;++c)l[c]=e[c];return function(d){for(c=0;c<s;++c)l[c]=a[c](d);return l}}function eD(t,e){var n=new Date;return t=+t,e=+e,function(s){return n.setTime(t*(1-s)+e*s),n}}function mr(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function tD(t,e){var n={},s={},a;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(a in e)a in t?n[a]=El(t[a],e[a]):s[a]=e[a];return function(l){for(a in n)s[a]=n[a](l);return s}}var Vp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ap=new RegExp(Vp.source,"g");function nD(t){return function(){return t}}function rD(t){return function(e){return t(e)+""}}function $E(t,e){var n=Vp.lastIndex=ap.lastIndex=0,s,a,l,c=-1,d=[],h=[];for(t=t+"",e=e+"";(s=Vp.exec(t))&&(a=ap.exec(e));)(l=a.index)>n&&(l=e.slice(n,l),d[c]?d[c]+=l:d[++c]=l),(s=s[0])===(a=a[0])?d[c]?d[c]+=a:d[++c]=a:(d[++c]=null,h.push({i:c,x:mr(s,a)})),n=ap.lastIndex;return n<e.length&&(l=e.slice(n),d[c]?d[c]+=l:d[++c]=l),d.length<2?h[0]?rD(h[0].x):nD(e):(e=h.length,function(f){for(var p=0,m;p<e;++p)d[(m=h[p]).i]=m.x(f);return d.join("")})}function El(t,e){var n=typeof e,s;return e==null||n==="boolean"?Lg(e):(n==="number"?mr:n==="string"?(s=Ai(e))?(e=s,kd):$E:e instanceof Ai?kd:e instanceof Date?eD:JM(e)?WM:Array.isArray(e)?ZM:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?tD:mr)(t,e)}var Ew=180/Math.PI,Gp={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function zE(t,e,n,s,a,l){var c,d,h;return(c=Math.sqrt(t*t+e*e))&&(t/=c,e/=c),(h=t*n+e*s)&&(n-=t*h,s-=e*h),(d=Math.sqrt(n*n+s*s))&&(n/=d,s/=d,h/=d),t*s<e*n&&(t=-t,e=-e,h=-h,c=-c),{translateX:a,translateY:l,rotate:Math.atan2(e,t)*Ew,skewX:Math.atan(h)*Ew,scaleX:c,scaleY:d}}var Vu;function sD(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Gp:zE(e.a,e.b,e.c,e.d,e.e,e.f)}function iD(t){return t==null||(Vu||(Vu=document.createElementNS("http://www.w3.org/2000/svg","g")),Vu.setAttribute("transform",t),!(t=Vu.transform.baseVal.consolidate()))?Gp:(t=t.matrix,zE(t.a,t.b,t.c,t.d,t.e,t.f))}function PE(t,e,n,s){function a(f){return f.length?f.pop()+" ":""}function l(f,p,m,y,_,x){if(f!==m||p!==y){var w=_.push("translate(",null,e,null,n);x.push({i:w-4,x:mr(f,m)},{i:w-2,x:mr(p,y)})}else(m||y)&&_.push("translate("+m+e+y+n)}function c(f,p,m,y){f!==p?(f-p>180?p+=360:p-f>180&&(f+=360),y.push({i:m.push(a(m)+"rotate(",null,s)-2,x:mr(f,p)})):p&&m.push(a(m)+"rotate("+p+s)}function d(f,p,m,y){f!==p?y.push({i:m.push(a(m)+"skewX(",null,s)-2,x:mr(f,p)}):p&&m.push(a(m)+"skewX("+p+s)}function h(f,p,m,y,_,x){if(f!==m||p!==y){var w=_.push(a(_)+"scale(",null,",",null,")");x.push({i:w-4,x:mr(f,m)},{i:w-2,x:mr(p,y)})}else(m!==1||y!==1)&&_.push(a(_)+"scale("+m+","+y+")")}return function(f,p){var m=[],y=[];return f=t(f),p=t(p),l(f.translateX,f.translateY,p.translateX,p.translateY,m,y),c(f.rotate,p.rotate,m,y),d(f.skewX,p.skewX,m,y),h(f.scaleX,f.scaleY,p.scaleX,p.scaleY,m,y),f=p=null,function(_){for(var x=-1,w=y.length,A;++x<w;)m[(A=y[x]).i]=A.x(_);return m.join("")}}}var aD=PE(sD,"px, ","px)","deg)"),oD=PE(iD,", ",")",")"),lD=1e-12;function Sw(t){return((t=Math.exp(t))+1/t)/2}function cD(t){return((t=Math.exp(t))-1/t)/2}function uD(t){return((t=Math.exp(2*t))-1)/(t+1)}const ud=(function t(e,n,s){function a(l,c){var d=l[0],h=l[1],f=l[2],p=c[0],m=c[1],y=c[2],_=p-d,x=m-h,w=_*_+x*x,A,S;if(w<lD)S=Math.log(y/f)/e,A=function(M){return[d+M*_,h+M*x,f*Math.exp(e*M*S)]};else{var T=Math.sqrt(w),E=(y*y-f*f+s*w)/(2*f*n*T),C=(y*y-f*f-s*w)/(2*y*n*T),j=Math.log(Math.sqrt(E*E+1)-E),O=Math.log(Math.sqrt(C*C+1)-C);S=(O-j)/e,A=function(M){var D=M*S,q=Sw(j),G=f/(n*T)*(q*uD(e*D+j)-cD(j));return[d+G*_,h+G*x,f*q/Sw(e*D+j)]}}return A.duration=S*1e3*e/Math.SQRT2,A}return a.rho=function(l){var c=Math.max(.001,+l),d=c*c,h=d*d;return t(c,d,h)},a})(Math.SQRT2,2,4);var Ha=0,cl=0,sl=0,HE=1e3,Md,ul,Dd=0,Ei=0,sf=0,Ul=typeof performance=="object"&&performance.now?performance:Date,qE=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function $g(){return Ei||(qE(dD),Ei=Ul.now()+sf)}function dD(){Ei=0}function Bd(){this._call=this._time=this._next=null}Bd.prototype=QE.prototype={constructor:Bd,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?$g():+n)+(e==null?0:+e),!this._next&&ul!==this&&(ul?ul._next=this:Md=this,ul=this),this._call=t,this._time=n,Yp()},stop:function(){this._call&&(this._call=null,this._time=1/0,Yp())}};function QE(t,e,n){var s=new Bd;return s.restart(t,e,n),s}function fD(){$g(),++Ha;for(var t=Md,e;t;)(e=Ei-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Ha}function Cw(){Ei=(Dd=Ul.now())+sf,Ha=cl=0;try{fD()}finally{Ha=0,mD(),Ei=0}}function hD(){var t=Ul.now(),e=t-Dd;e>HE&&(sf-=e,Dd=t)}function mD(){for(var t,e=Md,n,s=1/0;e;)e._call?(s>e._time&&(s=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Md=n);ul=t,Yp(s)}function Yp(t){if(!Ha){cl&&(cl=clearTimeout(cl));var e=t-Ei;e>24?(t<1/0&&(cl=setTimeout(Cw,t-Ul.now()-sf)),sl&&(sl=clearInterval(sl))):(sl||(Dd=Ul.now(),sl=setInterval(hD,HE)),Ha=1,qE(Cw))}}function Tw(t,e,n){var s=new Bd;return e=e==null?0:+e,s.restart(a=>{s.stop(),t(a+e)},e,n),s}var pD=nf("start","end","cancel","interrupt"),gD=[],FE=0,Nw=1,Xp=2,dd=3,Rw=4,Kp=5,fd=6;function af(t,e,n,s,a,l){var c=t.__transition;if(!c)t.__transition={};else if(n in c)return;yD(t,n,{name:e,index:s,group:a,on:pD,tween:gD,time:l.time,delay:l.delay,duration:l.duration,ease:l.ease,timer:null,state:FE})}function zg(t,e){var n=ar(t,e);if(n.state>FE)throw new Error("too late; already scheduled");return n}function _r(t,e){var n=ar(t,e);if(n.state>dd)throw new Error("too late; already running");return n}function ar(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function yD(t,e,n){var s=t.__transition,a;s[e]=n,n.timer=QE(l,0,n.time);function l(f){n.state=Nw,n.timer.restart(c,n.delay,n.time),n.delay<=f&&c(f-n.delay)}function c(f){var p,m,y,_;if(n.state!==Nw)return h();for(p in s)if(_=s[p],_.name===n.name){if(_.state===dd)return Tw(c);_.state===Rw?(_.state=fd,_.timer.stop(),_.on.call("interrupt",t,t.__data__,_.index,_.group),delete s[p]):+p<e&&(_.state=fd,_.timer.stop(),_.on.call("cancel",t,t.__data__,_.index,_.group),delete s[p])}if(Tw(function(){n.state===dd&&(n.state=Rw,n.timer.restart(d,n.delay,n.time),d(f))}),n.state=Xp,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Xp){for(n.state=dd,a=new Array(y=n.tween.length),p=0,m=-1;p<y;++p)(_=n.tween[p].value.call(t,t.__data__,n.index,n.group))&&(a[++m]=_);a.length=m+1}}function d(f){for(var p=f<n.duration?n.ease.call(null,f/n.duration):(n.timer.restart(h),n.state=Kp,1),m=-1,y=a.length;++m<y;)a[m].call(t,p);n.state===Kp&&(n.on.call("end",t,t.__data__,n.index,n.group),h())}function h(){n.state=fd,n.timer.stop(),delete s[e];for(var f in s)return;delete t.__transition}}function hd(t,e){var n=t.__transition,s,a,l=!0,c;if(n){e=e==null?null:e+"";for(c in n){if((s=n[c]).name!==e){l=!1;continue}a=s.state>Xp&&s.state<Kp,s.state=fd,s.timer.stop(),s.on.call(a?"interrupt":"cancel",t,t.__data__,s.index,s.group),delete n[c]}l&&delete t.__transition}}function vD(t){return this.each(function(){hd(this,t)})}function _D(t,e){var n,s;return function(){var a=_r(this,t),l=a.tween;if(l!==n){s=n=l;for(var c=0,d=s.length;c<d;++c)if(s[c].name===e){s=s.slice(),s.splice(c,1);break}}a.tween=s}}function bD(t,e,n){var s,a;if(typeof n!="function")throw new Error;return function(){var l=_r(this,t),c=l.tween;if(c!==s){a=(s=c).slice();for(var d={name:e,value:n},h=0,f=a.length;h<f;++h)if(a[h].name===e){a[h]=d;break}h===f&&a.push(d)}l.tween=a}}function wD(t,e){var n=this._id;if(t+="",arguments.length<2){for(var s=ar(this.node(),n).tween,a=0,l=s.length,c;a<l;++a)if((c=s[a]).name===t)return c.value;return null}return this.each((e==null?_D:bD)(n,t,e))}function Pg(t,e,n){var s=t._id;return t.each(function(){var a=_r(this,s);(a.value||(a.value={}))[e]=n.apply(this,arguments)}),function(a){return ar(a,s).value[e]}}function VE(t,e){var n;return(typeof e=="number"?mr:e instanceof Ai?kd:(n=Ai(e))?(e=n,kd):$E)(t,e)}function xD(t){return function(){this.removeAttribute(t)}}function AD(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ED(t,e,n){var s,a=n+"",l;return function(){var c=this.getAttribute(t);return c===a?null:c===s?l:l=e(s=c,n)}}function SD(t,e,n){var s,a=n+"",l;return function(){var c=this.getAttributeNS(t.space,t.local);return c===a?null:c===s?l:l=e(s=c,n)}}function CD(t,e,n){var s,a,l;return function(){var c,d=n(this),h;return d==null?void this.removeAttribute(t):(c=this.getAttribute(t),h=d+"",c===h?null:c===s&&h===a?l:(a=h,l=e(s=c,d)))}}function TD(t,e,n){var s,a,l;return function(){var c,d=n(this),h;return d==null?void this.removeAttributeNS(t.space,t.local):(c=this.getAttributeNS(t.space,t.local),h=d+"",c===h?null:c===s&&h===a?l:(a=h,l=e(s=c,d)))}}function ND(t,e){var n=rf(t),s=n==="transform"?oD:VE;return this.attrTween(t,typeof e=="function"?(n.local?TD:CD)(n,s,Pg(this,"attr."+t,e)):e==null?(n.local?AD:xD)(n):(n.local?SD:ED)(n,s,e))}function RD(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function jD(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function OD(t,e){var n,s;function a(){var l=e.apply(this,arguments);return l!==s&&(n=(s=l)&&jD(t,l)),n}return a._value=e,a}function ID(t,e){var n,s;function a(){var l=e.apply(this,arguments);return l!==s&&(n=(s=l)&&RD(t,l)),n}return a._value=e,a}function kD(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var s=rf(t);return this.tween(n,(s.local?OD:ID)(s,e))}function MD(t,e){return function(){zg(this,t).delay=+e.apply(this,arguments)}}function DD(t,e){return e=+e,function(){zg(this,t).delay=e}}function BD(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?MD:DD)(e,t)):ar(this.node(),e).delay}function UD(t,e){return function(){_r(this,t).duration=+e.apply(this,arguments)}}function LD(t,e){return e=+e,function(){_r(this,t).duration=e}}function $D(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?UD:LD)(e,t)):ar(this.node(),e).duration}function zD(t,e){if(typeof e!="function")throw new Error;return function(){_r(this,t).ease=e}}function PD(t){var e=this._id;return arguments.length?this.each(zD(e,t)):ar(this.node(),e).ease}function HD(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;_r(this,t).ease=n}}function qD(t){if(typeof t!="function")throw new Error;return this.each(HD(this._id,t))}function QD(t){typeof t!="function"&&(t=AE(t));for(var e=this._groups,n=e.length,s=new Array(n),a=0;a<n;++a)for(var l=e[a],c=l.length,d=s[a]=[],h,f=0;f<c;++f)(h=l[f])&&t.call(h,h.__data__,f,l)&&d.push(h);return new Kr(s,this._parents,this._name,this._id)}function FD(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,s=e.length,a=n.length,l=Math.min(s,a),c=new Array(s),d=0;d<l;++d)for(var h=e[d],f=n[d],p=h.length,m=c[d]=new Array(p),y,_=0;_<p;++_)(y=h[_]||f[_])&&(m[_]=y);for(;d<s;++d)c[d]=e[d];return new Kr(c,this._parents,this._name,this._id)}function VD(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function GD(t,e,n){var s,a,l=VD(e)?zg:_r;return function(){var c=l(this,t),d=c.on;d!==s&&(a=(s=d).copy()).on(e,n),c.on=a}}function YD(t,e){var n=this._id;return arguments.length<2?ar(this.node(),n).on.on(t):this.each(GD(n,t,e))}function XD(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function KD(){return this.on("end.remove",XD(this._id))}function WD(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Dg(t));for(var s=this._groups,a=s.length,l=new Array(a),c=0;c<a;++c)for(var d=s[c],h=d.length,f=l[c]=new Array(h),p,m,y=0;y<h;++y)(p=d[y])&&(m=t.call(p,p.__data__,y,d))&&("__data__"in p&&(m.__data__=p.__data__),f[y]=m,af(f[y],e,n,y,f,ar(p,n)));return new Kr(l,this._parents,e,n)}function JD(t){var e=this._name,n=this._id;typeof t!="function"&&(t=xE(t));for(var s=this._groups,a=s.length,l=[],c=[],d=0;d<a;++d)for(var h=s[d],f=h.length,p,m=0;m<f;++m)if(p=h[m]){for(var y=t.call(p,p.__data__,m,h),_,x=ar(p,n),w=0,A=y.length;w<A;++w)(_=y[w])&&af(_,e,n,w,y,x);l.push(y),c.push(p)}return new Kr(l,c,e,n)}var ZD=Jl.prototype.constructor;function eB(){return new ZD(this._groups,this._parents)}function tB(t,e){var n,s,a;return function(){var l=Pa(this,t),c=(this.style.removeProperty(t),Pa(this,t));return l===c?null:l===n&&c===s?a:a=e(n=l,s=c)}}function GE(t){return function(){this.style.removeProperty(t)}}function nB(t,e,n){var s,a=n+"",l;return function(){var c=Pa(this,t);return c===a?null:c===s?l:l=e(s=c,n)}}function rB(t,e,n){var s,a,l;return function(){var c=Pa(this,t),d=n(this),h=d+"";return d==null&&(h=d=(this.style.removeProperty(t),Pa(this,t))),c===h?null:c===s&&h===a?l:(a=h,l=e(s=c,d))}}function sB(t,e){var n,s,a,l="style."+e,c="end."+l,d;return function(){var h=_r(this,t),f=h.on,p=h.value[l]==null?d||(d=GE(e)):void 0;(f!==n||a!==p)&&(s=(n=f).copy()).on(c,a=p),h.on=s}}function iB(t,e,n){var s=(t+="")=="transform"?aD:VE;return e==null?this.styleTween(t,tB(t,s)).on("end.style."+t,GE(t)):typeof e=="function"?this.styleTween(t,rB(t,s,Pg(this,"style."+t,e))).each(sB(this._id,t)):this.styleTween(t,nB(t,s,e),n).on("end.style."+t,null)}function aB(t,e,n){return function(s){this.style.setProperty(t,e.call(this,s),n)}}function oB(t,e,n){var s,a;function l(){var c=e.apply(this,arguments);return c!==a&&(s=(a=c)&&aB(t,c,n)),s}return l._value=e,l}function lB(t,e,n){var s="style."+(t+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(e==null)return this.tween(s,null);if(typeof e!="function")throw new Error;return this.tween(s,oB(t,e,n??""))}function cB(t){return function(){this.textContent=t}}function uB(t){return function(){var e=t(this);this.textContent=e??""}}function dB(t){return this.tween("text",typeof t=="function"?uB(Pg(this,"text",t)):cB(t==null?"":t+""))}function fB(t){return function(e){this.textContent=t.call(this,e)}}function hB(t){var e,n;function s(){var a=t.apply(this,arguments);return a!==n&&(e=(n=a)&&fB(a)),e}return s._value=t,s}function mB(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,hB(t))}function pB(){for(var t=this._name,e=this._id,n=YE(),s=this._groups,a=s.length,l=0;l<a;++l)for(var c=s[l],d=c.length,h,f=0;f<d;++f)if(h=c[f]){var p=ar(h,e);af(h,t,n,f,c,{time:p.time+p.delay+p.duration,delay:0,duration:p.duration,ease:p.ease})}return new Kr(s,this._parents,t,n)}function gB(){var t,e,n=this,s=n._id,a=n.size();return new Promise(function(l,c){var d={value:c},h={value:function(){--a===0&&l()}};n.each(function(){var f=_r(this,s),p=f.on;p!==t&&(e=(t=p).copy(),e._.cancel.push(d),e._.interrupt.push(d),e._.end.push(h)),f.on=e}),a===0&&l()})}var yB=0;function Kr(t,e,n,s){this._groups=t,this._parents=e,this._name=n,this._id=s}function YE(){return++yB}var qr=Jl.prototype;Kr.prototype={constructor:Kr,select:WD,selectAll:JD,selectChild:qr.selectChild,selectChildren:qr.selectChildren,filter:QD,merge:FD,selection:eB,transition:pB,call:qr.call,nodes:qr.nodes,node:qr.node,size:qr.size,empty:qr.empty,each:qr.each,on:YD,attr:ND,attrTween:kD,style:iB,styleTween:lB,text:dB,textTween:mB,remove:KD,tween:wD,delay:BD,duration:$D,ease:PD,easeVarying:qD,end:gB,[Symbol.iterator]:qr[Symbol.iterator]};function vB(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var _B={time:null,delay:0,duration:250,ease:vB};function bB(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function wB(t){var e,n;t instanceof Kr?(e=t._id,t=t._name):(e=YE(),(n=_B).time=$g(),t=t==null?null:t+"");for(var s=this._groups,a=s.length,l=0;l<a;++l)for(var c=s[l],d=c.length,h,f=0;f<d;++f)(h=c[f])&&af(h,t,e,f,c,n||bB(h,e));return new Kr(s,this._parents,t,e)}Jl.prototype.interrupt=vD;Jl.prototype.transition=wB;const Gu=t=>()=>t;function xB(t,{sourceEvent:e,target:n,transform:s,dispatch:a}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:s,enumerable:!0,configurable:!0},_:{value:a}})}function Gr(t,e,n){this.k=t,this.x=e,this.y=n}Gr.prototype={constructor:Gr,scale:function(t){return t===1?this:new Gr(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Gr(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var of=new Gr(1,0,0);XE.prototype=Gr.prototype;function XE(t){for(;!t.__zoom;)if(!(t=t.parentNode))return of;return t.__zoom}function op(t){t.stopImmediatePropagation()}function il(t){t.preventDefault(),t.stopImmediatePropagation()}function AB(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function EB(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function jw(){return this.__zoom||of}function SB(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function CB(){return navigator.maxTouchPoints||"ontouchstart"in this}function TB(t,e,n){var s=t.invertX(e[0][0])-n[0][0],a=t.invertX(e[1][0])-n[1][0],l=t.invertY(e[0][1])-n[0][1],c=t.invertY(e[1][1])-n[1][1];return t.translate(a>s?(s+a)/2:Math.min(0,s)||Math.max(0,a),c>l?(l+c)/2:Math.min(0,l)||Math.max(0,c))}function KE(){var t=AB,e=EB,n=TB,s=SB,a=CB,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],d=250,h=ud,f=nf("start","zoom","end"),p,m,y,_=500,x=150,w=0,A=10;function S($){$.property("__zoom",jw).on("wheel.zoom",D,{passive:!1}).on("mousedown.zoom",q).on("dblclick.zoom",G).filter(a).on("touchstart.zoom",V).on("touchmove.zoom",F).on("touchend.zoom touchcancel.zoom",K).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}S.transform=function($,Q,R,U){var B=$.selection?$.selection():$;B.property("__zoom",jw),$!==B?j($,Q,R,U):B.interrupt().each(function(){O(this,arguments).event(U).start().zoom(null,typeof Q=="function"?Q.apply(this,arguments):Q).end()})},S.scaleBy=function($,Q,R,U){S.scaleTo($,function(){var B=this.__zoom.k,L=typeof Q=="function"?Q.apply(this,arguments):Q;return B*L},R,U)},S.scaleTo=function($,Q,R,U){S.transform($,function(){var B=e.apply(this,arguments),L=this.__zoom,H=R==null?C(B):typeof R=="function"?R.apply(this,arguments):R,I=L.invert(H),P=typeof Q=="function"?Q.apply(this,arguments):Q;return n(E(T(L,P),H,I),B,c)},R,U)},S.translateBy=function($,Q,R,U){S.transform($,function(){return n(this.__zoom.translate(typeof Q=="function"?Q.apply(this,arguments):Q,typeof R=="function"?R.apply(this,arguments):R),e.apply(this,arguments),c)},null,U)},S.translateTo=function($,Q,R,U,B){S.transform($,function(){var L=e.apply(this,arguments),H=this.__zoom,I=U==null?C(L):typeof U=="function"?U.apply(this,arguments):U;return n(of.translate(I[0],I[1]).scale(H.k).translate(typeof Q=="function"?-Q.apply(this,arguments):-Q,typeof R=="function"?-R.apply(this,arguments):-R),L,c)},U,B)};function T($,Q){return Q=Math.max(l[0],Math.min(l[1],Q)),Q===$.k?$:new Gr(Q,$.x,$.y)}function E($,Q,R){var U=Q[0]-R[0]*$.k,B=Q[1]-R[1]*$.k;return U===$.x&&B===$.y?$:new Gr($.k,U,B)}function C($){return[(+$[0][0]+ +$[1][0])/2,(+$[0][1]+ +$[1][1])/2]}function j($,Q,R,U){$.on("start.zoom",function(){O(this,arguments).event(U).start()}).on("interrupt.zoom end.zoom",function(){O(this,arguments).event(U).end()}).tween("zoom",function(){var B=this,L=arguments,H=O(B,L).event(U),I=e.apply(B,L),P=R==null?C(I):typeof R=="function"?R.apply(B,L):R,Y=Math.max(I[1][0]-I[0][0],I[1][1]-I[0][1]),J=B.__zoom,Z=typeof Q=="function"?Q.apply(B,L):Q,ae=h(J.invert(P).concat(Y/J.k),Z.invert(P).concat(Y/Z.k));return function(ce){if(ce===1)ce=Z;else{var he=ae(ce),ye=Y/he[2];ce=new Gr(ye,P[0]-he[0]*ye,P[1]-he[1]*ye)}H.zoom(null,ce)}})}function O($,Q,R){return!R&&$.__zooming||new M($,Q)}function M($,Q){this.that=$,this.args=Q,this.active=0,this.sourceEvent=null,this.extent=e.apply($,Q),this.taps=0}M.prototype={event:function($){return $&&(this.sourceEvent=$),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function($,Q){return this.mouse&&$!=="mouse"&&(this.mouse[1]=Q.invert(this.mouse[0])),this.touch0&&$!=="touch"&&(this.touch0[1]=Q.invert(this.touch0[0])),this.touch1&&$!=="touch"&&(this.touch1[1]=Q.invert(this.touch1[0])),this.that.__zoom=Q,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function($){var Q=jn(this.that).datum();f.call($,this.that,new xB($,{sourceEvent:this.sourceEvent,target:S,transform:this.that.__zoom,dispatch:f}),Q)}};function D($,...Q){if(!t.apply(this,arguments))return;var R=O(this,Q).event($),U=this.__zoom,B=Math.max(l[0],Math.min(l[1],U.k*Math.pow(2,s.apply(this,arguments)))),L=tr($);if(R.wheel)(R.mouse[0][0]!==L[0]||R.mouse[0][1]!==L[1])&&(R.mouse[1]=U.invert(R.mouse[0]=L)),clearTimeout(R.wheel);else{if(U.k===B)return;R.mouse=[L,U.invert(L)],hd(this),R.start()}il($),R.wheel=setTimeout(H,x),R.zoom("mouse",n(E(T(U,B),R.mouse[0],R.mouse[1]),R.extent,c));function H(){R.wheel=null,R.end()}}function q($,...Q){if(y||!t.apply(this,arguments))return;var R=$.currentTarget,U=O(this,Q,!0).event($),B=jn($.view).on("mousemove.zoom",P,!0).on("mouseup.zoom",Y,!0),L=tr($,R),H=$.clientX,I=$.clientY;kE($.view),op($),U.mouse=[L,this.__zoom.invert(L)],hd(this),U.start();function P(J){if(il(J),!U.moved){var Z=J.clientX-H,ae=J.clientY-I;U.moved=Z*Z+ae*ae>w}U.event(J).zoom("mouse",n(E(U.that.__zoom,U.mouse[0]=tr(J,R),U.mouse[1]),U.extent,c))}function Y(J){B.on("mousemove.zoom mouseup.zoom",null),ME(J.view,U.moved),il(J),U.event(J).end()}}function G($,...Q){if(t.apply(this,arguments)){var R=this.__zoom,U=tr($.changedTouches?$.changedTouches[0]:$,this),B=R.invert(U),L=R.k*($.shiftKey?.5:2),H=n(E(T(R,L),U,B),e.apply(this,Q),c);il($),d>0?jn(this).transition().duration(d).call(j,H,U,$):jn(this).call(S.transform,H,U,$)}}function V($,...Q){if(t.apply(this,arguments)){var R=$.touches,U=R.length,B=O(this,Q,$.changedTouches.length===U).event($),L,H,I,P;for(op($),H=0;H<U;++H)I=R[H],P=tr(I,this),P=[P,this.__zoom.invert(P),I.identifier],B.touch0?!B.touch1&&B.touch0[2]!==P[2]&&(B.touch1=P,B.taps=0):(B.touch0=P,L=!0,B.taps=1+!!p);p&&(p=clearTimeout(p)),L&&(B.taps<2&&(m=P[0],p=setTimeout(function(){p=null},_)),hd(this),B.start())}}function F($,...Q){if(this.__zooming){var R=O(this,Q).event($),U=$.changedTouches,B=U.length,L,H,I,P;for(il($),L=0;L<B;++L)H=U[L],I=tr(H,this),R.touch0&&R.touch0[2]===H.identifier?R.touch0[0]=I:R.touch1&&R.touch1[2]===H.identifier&&(R.touch1[0]=I);if(H=R.that.__zoom,R.touch1){var Y=R.touch0[0],J=R.touch0[1],Z=R.touch1[0],ae=R.touch1[1],ce=(ce=Z[0]-Y[0])*ce+(ce=Z[1]-Y[1])*ce,he=(he=ae[0]-J[0])*he+(he=ae[1]-J[1])*he;H=T(H,Math.sqrt(ce/he)),I=[(Y[0]+Z[0])/2,(Y[1]+Z[1])/2],P=[(J[0]+ae[0])/2,(J[1]+ae[1])/2]}else if(R.touch0)I=R.touch0[0],P=R.touch0[1];else return;R.zoom("touch",n(E(H,I,P),R.extent,c))}}function K($,...Q){if(this.__zooming){var R=O(this,Q).event($),U=$.changedTouches,B=U.length,L,H;for(op($),y&&clearTimeout(y),y=setTimeout(function(){y=null},_),L=0;L<B;++L)H=U[L],R.touch0&&R.touch0[2]===H.identifier?delete R.touch0:R.touch1&&R.touch1[2]===H.identifier&&delete R.touch1;if(R.touch1&&!R.touch0&&(R.touch0=R.touch1,delete R.touch1),R.touch0)R.touch0[1]=this.__zoom.invert(R.touch0[0]);else if(R.end(),R.taps===2&&(H=tr(H,this),Math.hypot(m[0]-H[0],m[1]-H[1])<A)){var I=jn(this).on("dblclick.zoom");I&&I.apply(this,arguments)}}}return S.wheelDelta=function($){return arguments.length?(s=typeof $=="function"?$:Gu(+$),S):s},S.filter=function($){return arguments.length?(t=typeof $=="function"?$:Gu(!!$),S):t},S.touchable=function($){return arguments.length?(a=typeof $=="function"?$:Gu(!!$),S):a},S.extent=function($){return arguments.length?(e=typeof $=="function"?$:Gu([[+$[0][0],+$[0][1]],[+$[1][0],+$[1][1]]]),S):e},S.scaleExtent=function($){return arguments.length?(l[0]=+$[0],l[1]=+$[1],S):[l[0],l[1]]},S.translateExtent=function($){return arguments.length?(c[0][0]=+$[0][0],c[1][0]=+$[1][0],c[0][1]=+$[0][1],c[1][1]=+$[1][1],S):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},S.constrain=function($){return arguments.length?(n=$,S):n},S.duration=function($){return arguments.length?(d=+$,S):d},S.interpolate=function($){return arguments.length?(h=$,S):h},S.on=function(){var $=f.on.apply(f,arguments);return $===f?S:$},S.clickDistance=function($){return arguments.length?(w=($=+$)*$,S):Math.sqrt(w)},S.tapDistance=function($){return arguments.length?(A=+$,S):A},S}const ir={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:t=>`Node type "${t}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:t=>`The old edge with id=${t} does not exist.`,error009:t=>`Marker type "${t}" doesn't exist.`,error008:(t,{id:e,sourceHandle:n,targetHandle:s})=>`Couldn't create edge for ${t} handle id: "${t==="source"?n:s}", edge id: ${e}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:t=>`Edge type "${t}" not found. Using fallback type "default".`,error012:t=>`Node with id "${t}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(t="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${t}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},Ll=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],WE=["Enter"," ","Escape"],JE={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:t,x:e,y:n})=>`Moved selected node ${t}. New position, x: ${e}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var qa;(function(t){t.Strict="strict",t.Loose="loose"})(qa||(qa={}));var xi;(function(t){t.Free="free",t.Vertical="vertical",t.Horizontal="horizontal"})(xi||(xi={}));var $l;(function(t){t.Partial="partial",t.Full="full"})($l||($l={}));const ZE={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var Bs;(function(t){t.Bezier="default",t.Straight="straight",t.Step="step",t.SmoothStep="smoothstep",t.SimpleBezier="simplebezier"})(Bs||(Bs={}));var Ud;(function(t){t.Arrow="arrow",t.ArrowClosed="arrowclosed"})(Ud||(Ud={}));var xe;(function(t){t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom"})(xe||(xe={}));const Ow={[xe.Left]:xe.Right,[xe.Right]:xe.Left,[xe.Top]:xe.Bottom,[xe.Bottom]:xe.Top};function NB(t,e){if(!t&&!e)return!0;if(!t||!e||t.size!==e.size)return!1;if(!t.size&&!e.size)return!0;for(const n of t.keys())if(!e.has(n))return!1;return!0}function Iw(t,e,n){if(!n)return;const s=[];t.forEach((a,l)=>{e?.has(l)||s.push(a)}),s.length&&n(s)}function eS(t){return t===null?null:t?"valid":"invalid"}const tS=t=>"id"in t&&"source"in t&&"target"in t,RB=t=>"id"in t&&"position"in t&&!("source"in t)&&!("target"in t),Hg=t=>"id"in t&&"internals"in t&&!("source"in t)&&!("target"in t),ec=(t,e=[0,0])=>{const{width:n,height:s}=Zr(t),a=t.origin??e,l=n*a[0],c=s*a[1];return{x:t.position.x-l,y:t.position.y-c}},jB=(t,e={nodeOrigin:[0,0]})=>{if(t.length===0)return{x:0,y:0,width:0,height:0};const n=t.reduce((s,a)=>{const l=typeof a=="string";let c=!e.nodeLookup&&!l?a:void 0;e.nodeLookup&&(c=l?e.nodeLookup.get(a):Hg(a)?a:e.nodeLookup.get(a.id));const d=c?Ld(c,e.nodeOrigin):{x:0,y:0,x2:0,y2:0};return lf(s,d)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return cf(n)},tc=(t,e={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},s=!1;return t.forEach(a=>{(e.filter===void 0||e.filter(a))&&(n=lf(n,Ld(a)),s=!0)}),s?cf(n):{x:0,y:0,width:0,height:0}},qg=(t,e,[n,s,a]=[0,0,1],l=!1,c=!1)=>{const d={...rc(e,[n,s,a]),width:e.width/a,height:e.height/a},h=[];for(const f of t.values()){const{measured:p,selectable:m=!0,hidden:y=!1}=f;if(c&&!m||y)continue;const _=p.width??f.width??f.initialWidth??null,x=p.height??f.height??f.initialHeight??null,w=zl(d,Fa(f)),A=(_??0)*(x??0),S=l&&w>0;(!f.internals.handleBounds||S||w>=A||f.dragging)&&h.push(f)}return h},OB=(t,e)=>{const n=new Set;return t.forEach(s=>{n.add(s.id)}),e.filter(s=>n.has(s.source)||n.has(s.target))};function IB(t,e){const n=new Map,s=e?.nodes?new Set(e.nodes.map(a=>a.id)):null;return t.forEach(a=>{a.measured.width&&a.measured.height&&(e?.includeHiddenNodes||!a.hidden)&&(!s||s.has(a.id))&&n.set(a.id,a)}),n}async function kB({nodes:t,width:e,height:n,panZoom:s,minZoom:a,maxZoom:l},c){if(t.size===0)return Promise.resolve(!0);const d=IB(t,c),h=tc(d),f=Qg(h,e,n,c?.minZoom??a,c?.maxZoom??l,c?.padding??.1);return await s.setViewport(f,{duration:c?.duration,ease:c?.ease,interpolate:c?.interpolate}),Promise.resolve(!0)}function nS({nodeId:t,nextPosition:e,nodeLookup:n,nodeOrigin:s=[0,0],nodeExtent:a,onError:l}){const c=n.get(t),d=c.parentId?n.get(c.parentId):void 0,{x:h,y:f}=d?d.internals.positionAbsolute:{x:0,y:0},p=c.origin??s;let m=c.extent||a;if(c.extent==="parent"&&!c.expandParent)if(!d)l?.("005",ir.error005());else{const _=d.measured.width,x=d.measured.height;_&&x&&(m=[[h,f],[h+_,f+x]])}else d&&Va(c.extent)&&(m=[[c.extent[0][0]+h,c.extent[0][1]+f],[c.extent[1][0]+h,c.extent[1][1]+f]]);const y=Va(m)?Si(e,m,c.measured):e;return(c.measured.width===void 0||c.measured.height===void 0)&&l?.("015",ir.error015()),{position:{x:y.x-h+(c.measured.width??0)*p[0],y:y.y-f+(c.measured.height??0)*p[1]},positionAbsolute:y}}async function MB({nodesToRemove:t=[],edgesToRemove:e=[],nodes:n,edges:s,onBeforeDelete:a}){const l=new Set(t.map(y=>y.id)),c=[];for(const y of n){if(y.deletable===!1)continue;const _=l.has(y.id),x=!_&&y.parentId&&c.find(w=>w.id===y.parentId);(_||x)&&c.push(y)}const d=new Set(e.map(y=>y.id)),h=s.filter(y=>y.deletable!==!1),p=OB(c,h);for(const y of h)d.has(y.id)&&!p.find(x=>x.id===y.id)&&p.push(y);if(!a)return{edges:p,nodes:c};const m=await a({nodes:c,edges:p});return typeof m=="boolean"?m?{edges:p,nodes:c}:{edges:[],nodes:[]}:m}const Qa=(t,e=0,n=1)=>Math.min(Math.max(t,e),n),Si=(t={x:0,y:0},e,n)=>({x:Qa(t.x,e[0][0],e[1][0]-(n?.width??0)),y:Qa(t.y,e[0][1],e[1][1]-(n?.height??0))});function rS(t,e,n){const{width:s,height:a}=Zr(n),{x:l,y:c}=n.internals.positionAbsolute;return Si(t,[[l,c],[l+s,c+a]],e)}const kw=(t,e,n)=>t<e?Qa(Math.abs(t-e),1,e)/e:t>n?-Qa(Math.abs(t-n),1,e)/e:0,sS=(t,e,n=15,s=40)=>{const a=kw(t.x,s,e.width-s)*n,l=kw(t.y,s,e.height-s)*n;return[a,l]},lf=(t,e)=>({x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x2,e.x2),y2:Math.max(t.y2,e.y2)}),Wp=({x:t,y:e,width:n,height:s})=>({x:t,y:e,x2:t+n,y2:e+s}),cf=({x:t,y:e,x2:n,y2:s})=>({x:t,y:e,width:n-t,height:s-e}),Fa=(t,e=[0,0])=>{const{x:n,y:s}=Hg(t)?t.internals.positionAbsolute:ec(t,e);return{x:n,y:s,width:t.measured?.width??t.width??t.initialWidth??0,height:t.measured?.height??t.height??t.initialHeight??0}},Ld=(t,e=[0,0])=>{const{x:n,y:s}=Hg(t)?t.internals.positionAbsolute:ec(t,e);return{x:n,y:s,x2:n+(t.measured?.width??t.width??t.initialWidth??0),y2:s+(t.measured?.height??t.height??t.initialHeight??0)}},iS=(t,e)=>cf(lf(Wp(t),Wp(e))),zl=(t,e)=>{const n=Math.max(0,Math.min(t.x+t.width,e.x+e.width)-Math.max(t.x,e.x)),s=Math.max(0,Math.min(t.y+t.height,e.y+e.height)-Math.max(t.y,e.y));return Math.ceil(n*s)},Mw=t=>rr(t.width)&&rr(t.height)&&rr(t.x)&&rr(t.y),rr=t=>!isNaN(t)&&isFinite(t),DB=(t,e)=>{},nc=(t,e=[1,1])=>({x:e[0]*Math.round(t.x/e[0]),y:e[1]*Math.round(t.y/e[1])}),rc=({x:t,y:e},[n,s,a],l=!1,c=[1,1])=>{const d={x:(t-n)/a,y:(e-s)/a};return l?nc(d,c):d},$d=({x:t,y:e},[n,s,a])=>({x:t*a+n,y:e*a+s});function Sa(t,e){if(typeof t=="number")return Math.floor((e-e/(1+t))*.5);if(typeof t=="string"&&t.endsWith("px")){const n=parseFloat(t);if(!Number.isNaN(n))return Math.floor(n)}if(typeof t=="string"&&t.endsWith("%")){const n=parseFloat(t);if(!Number.isNaN(n))return Math.floor(e*n*.01)}return console.error(`[React Flow] The padding value "${t}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function BB(t,e,n){if(typeof t=="string"||typeof t=="number"){const s=Sa(t,n),a=Sa(t,e);return{top:s,right:a,bottom:s,left:a,x:a*2,y:s*2}}if(typeof t=="object"){const s=Sa(t.top??t.y??0,n),a=Sa(t.bottom??t.y??0,n),l=Sa(t.left??t.x??0,e),c=Sa(t.right??t.x??0,e);return{top:s,right:c,bottom:a,left:l,x:l+c,y:s+a}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function UB(t,e,n,s,a,l){const{x:c,y:d}=$d(t,[e,n,s]),{x:h,y:f}=$d({x:t.x+t.width,y:t.y+t.height},[e,n,s]),p=a-h,m=l-f;return{left:Math.floor(c),top:Math.floor(d),right:Math.floor(p),bottom:Math.floor(m)}}const Qg=(t,e,n,s,a,l)=>{const c=BB(l,e,n),d=(e-c.x)/t.width,h=(n-c.y)/t.height,f=Math.min(d,h),p=Qa(f,s,a),m=t.x+t.width/2,y=t.y+t.height/2,_=e/2-m*p,x=n/2-y*p,w=UB(t,_,x,p,e,n),A={left:Math.min(w.left-c.left,0),top:Math.min(w.top-c.top,0),right:Math.min(w.right-c.right,0),bottom:Math.min(w.bottom-c.bottom,0)};return{x:_-A.left+A.right,y:x-A.top+A.bottom,zoom:p}},Pl=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function Va(t){return t!=null&&t!=="parent"}function Zr(t){return{width:t.measured?.width??t.width??t.initialWidth??0,height:t.measured?.height??t.height??t.initialHeight??0}}function aS(t){return(t.measured?.width??t.width??t.initialWidth)!==void 0&&(t.measured?.height??t.height??t.initialHeight)!==void 0}function oS(t,e={width:0,height:0},n,s,a){const l={...t},c=s.get(n);if(c){const d=c.origin||a;l.x+=c.internals.positionAbsolute.x-(e.width??0)*d[0],l.y+=c.internals.positionAbsolute.y-(e.height??0)*d[1]}return l}function Dw(t,e){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}function LB(){let t,e;return{promise:new Promise((s,a)=>{t=s,e=a}),resolve:t,reject:e}}function $B(t){return{...JE,...t||{}}}function Sl(t,{snapGrid:e=[0,0],snapToGrid:n=!1,transform:s,containerBounds:a}){const{x:l,y:c}=sr(t),d=rc({x:l-(a?.left??0),y:c-(a?.top??0)},s),{x:h,y:f}=n?nc(d,e):d;return{xSnapped:h,ySnapped:f,...d}}const Fg=t=>({width:t.offsetWidth,height:t.offsetHeight}),lS=t=>t?.getRootNode?.()||window?.document,zB=["INPUT","SELECT","TEXTAREA"];function cS(t){const e=t.composedPath?.()?.[0]||t.target;return e?.nodeType!==1?!1:zB.includes(e.nodeName)||e.hasAttribute("contenteditable")||!!e.closest(".nokey")}const uS=t=>"clientX"in t,sr=(t,e)=>{const n=uS(t),s=n?t.clientX:t.touches?.[0].clientX,a=n?t.clientY:t.touches?.[0].clientY;return{x:s-(e?.left??0),y:a-(e?.top??0)}},Bw=(t,e,n,s,a)=>{const l=e.querySelectorAll(`.${t}`);return!l||!l.length?null:Array.from(l).map(c=>{const d=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),type:t,nodeId:a,position:c.getAttribute("data-handlepos"),x:(d.left-n.left)/s,y:(d.top-n.top)/s,...Fg(c)}})};function dS({sourceX:t,sourceY:e,targetX:n,targetY:s,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:d}){const h=t*.125+a*.375+c*.375+n*.125,f=e*.125+l*.375+d*.375+s*.125,p=Math.abs(h-t),m=Math.abs(f-e);return[h,f,p,m]}function Yu(t,e){return t>=0?.5*t:e*25*Math.sqrt(-t)}function Uw({pos:t,x1:e,y1:n,x2:s,y2:a,c:l}){switch(t){case xe.Left:return[e-Yu(e-s,l),n];case xe.Right:return[e+Yu(s-e,l),n];case xe.Top:return[e,n-Yu(n-a,l)];case xe.Bottom:return[e,n+Yu(a-n,l)]}}function Vg({sourceX:t,sourceY:e,sourcePosition:n=xe.Bottom,targetX:s,targetY:a,targetPosition:l=xe.Top,curvature:c=.25}){const[d,h]=Uw({pos:n,x1:t,y1:e,x2:s,y2:a,c}),[f,p]=Uw({pos:l,x1:s,y1:a,x2:t,y2:e,c}),[m,y,_,x]=dS({sourceX:t,sourceY:e,targetX:s,targetY:a,sourceControlX:d,sourceControlY:h,targetControlX:f,targetControlY:p});return[`M${t},${e} C${d},${h} ${f},${p} ${s},${a}`,m,y,_,x]}function fS({sourceX:t,sourceY:e,targetX:n,targetY:s}){const a=Math.abs(n-t)/2,l=n<t?n+a:n-a,c=Math.abs(s-e)/2,d=s<e?s+c:s-c;return[l,d,a,c]}function PB({sourceNode:t,targetNode:e,selected:n=!1,zIndex:s,elevateOnSelect:a=!1}){if(s!==void 0)return s;const l=a&&n?1e3:0,c=Math.max(t.parentId||a&&t.selected?t.internals.z:0,e.parentId||a&&e.selected?e.internals.z:0);return l+c}function HB({sourceNode:t,targetNode:e,width:n,height:s,transform:a}){const l=lf(Ld(t),Ld(e));l.x===l.x2&&(l.x2+=1),l.y===l.y2&&(l.y2+=1);const c={x:-a[0]/a[2],y:-a[1]/a[2],width:n/a[2],height:s/a[2]};return zl(c,cf(l))>0}const qB=({source:t,sourceHandle:e,target:n,targetHandle:s})=>`xy-edge__${t}${e||""}-${n}${s||""}`,QB=(t,e)=>e.some(n=>n.source===t.source&&n.target===t.target&&(n.sourceHandle===t.sourceHandle||!n.sourceHandle&&!t.sourceHandle)&&(n.targetHandle===t.targetHandle||!n.targetHandle&&!t.targetHandle)),hS=(t,e)=>{if(!t.source||!t.target)return e;let n;return tS(t)?n={...t}:n={...t,id:qB(t)},QB(n,e)?e:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,e.concat(n))};function mS({sourceX:t,sourceY:e,targetX:n,targetY:s}){const[a,l,c,d]=fS({sourceX:t,sourceY:e,targetX:n,targetY:s});return[`M ${t},${e}L ${n},${s}`,a,l,c,d]}const Lw={[xe.Left]:{x:-1,y:0},[xe.Right]:{x:1,y:0},[xe.Top]:{x:0,y:-1},[xe.Bottom]:{x:0,y:1}},FB=({source:t,sourcePosition:e=xe.Bottom,target:n})=>e===xe.Left||e===xe.Right?t.x<n.x?{x:1,y:0}:{x:-1,y:0}:t.y<n.y?{x:0,y:1}:{x:0,y:-1},$w=(t,e)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));function VB({source:t,sourcePosition:e=xe.Bottom,target:n,targetPosition:s=xe.Top,center:a,offset:l,stepPosition:c}){const d=Lw[e],h=Lw[s],f={x:t.x+d.x*l,y:t.y+d.y*l},p={x:n.x+h.x*l,y:n.y+h.y*l},m=FB({source:f,sourcePosition:e,target:p}),y=m.x!==0?"x":"y",_=m[y];let x=[],w,A;const S={x:0,y:0},T={x:0,y:0},[,,E,C]=fS({sourceX:t.x,sourceY:t.y,targetX:n.x,targetY:n.y});if(d[y]*h[y]===-1){y==="x"?(w=a.x??f.x+(p.x-f.x)*c,A=a.y??(f.y+p.y)/2):(w=a.x??(f.x+p.x)/2,A=a.y??f.y+(p.y-f.y)*c);const O=[{x:w,y:f.y},{x:w,y:p.y}],M=[{x:f.x,y:A},{x:p.x,y:A}];d[y]===_?x=y==="x"?O:M:x=y==="x"?M:O}else{const O=[{x:f.x,y:p.y}],M=[{x:p.x,y:f.y}];if(y==="x"?x=d.x===_?M:O:x=d.y===_?O:M,e===s){const F=Math.abs(t[y]-n[y]);if(F<=l){const K=Math.min(l-1,l-F);d[y]===_?S[y]=(f[y]>t[y]?-1:1)*K:T[y]=(p[y]>n[y]?-1:1)*K}}if(e!==s){const F=y==="x"?"y":"x",K=d[y]===h[F],$=f[F]>p[F],Q=f[F]<p[F];(d[y]===1&&(!K&&$||K&&Q)||d[y]!==1&&(!K&&Q||K&&$))&&(x=y==="x"?O:M)}const D={x:f.x+S.x,y:f.y+S.y},q={x:p.x+T.x,y:p.y+T.y},G=Math.max(Math.abs(D.x-x[0].x),Math.abs(q.x-x[0].x)),V=Math.max(Math.abs(D.y-x[0].y),Math.abs(q.y-x[0].y));G>=V?(w=(D.x+q.x)/2,A=x[0].y):(w=x[0].x,A=(D.y+q.y)/2)}return[[t,{x:f.x+S.x,y:f.y+S.y},...x,{x:p.x+T.x,y:p.y+T.y},n],w,A,E,C]}function GB(t,e,n,s){const a=Math.min($w(t,e)/2,$w(e,n)/2,s),{x:l,y:c}=e;if(t.x===l&&l===n.x||t.y===c&&c===n.y)return`L${l} ${c}`;if(t.y===c){const f=t.x<n.x?-1:1,p=t.y<n.y?1:-1;return`L ${l+a*f},${c}Q ${l},${c} ${l},${c+a*p}`}const d=t.x<n.x?1:-1,h=t.y<n.y?-1:1;return`L ${l},${c+a*h}Q ${l},${c} ${l+a*d},${c}`}function Jp({sourceX:t,sourceY:e,sourcePosition:n=xe.Bottom,targetX:s,targetY:a,targetPosition:l=xe.Top,borderRadius:c=5,centerX:d,centerY:h,offset:f=20,stepPosition:p=.5}){const[m,y,_,x,w]=VB({source:{x:t,y:e},sourcePosition:n,target:{x:s,y:a},targetPosition:l,center:{x:d,y:h},offset:f,stepPosition:p});return[m.reduce((S,T,E)=>{let C="";return E>0&&E<m.length-1?C=GB(m[E-1],T,m[E+1],c):C=`${E===0?"M":"L"}${T.x} ${T.y}`,S+=C,S},""),y,_,x,w]}function zw(t){return t&&!!(t.internals.handleBounds||t.handles?.length)&&!!(t.measured.width||t.width||t.initialWidth)}function YB(t){const{sourceNode:e,targetNode:n}=t;if(!zw(e)||!zw(n))return null;const s=e.internals.handleBounds||Pw(e.handles),a=n.internals.handleBounds||Pw(n.handles),l=Hw(s?.source??[],t.sourceHandle),c=Hw(t.connectionMode===qa.Strict?a?.target??[]:(a?.target??[]).concat(a?.source??[]),t.targetHandle);if(!l||!c)return t.onError?.("008",ir.error008(l?"target":"source",{id:t.id,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle})),null;const d=l?.position||xe.Bottom,h=c?.position||xe.Top,f=Hl(e,l,d),p=Hl(n,c,h);return{sourceX:f.x,sourceY:f.y,targetX:p.x,targetY:p.y,sourcePosition:d,targetPosition:h}}function Pw(t){if(!t)return null;const e=[],n=[];for(const s of t)s.width=s.width??1,s.height=s.height??1,s.type==="source"?e.push(s):s.type==="target"&&n.push(s);return{source:e,target:n}}function Hl(t,e,n=xe.Left,s=!1){const a=(e?.x??0)+t.internals.positionAbsolute.x,l=(e?.y??0)+t.internals.positionAbsolute.y,{width:c,height:d}=e??Zr(t);if(s)return{x:a+c/2,y:l+d/2};switch(e?.position??n){case xe.Top:return{x:a+c/2,y:l};case xe.Right:return{x:a+c,y:l+d/2};case xe.Bottom:return{x:a+c/2,y:l+d};case xe.Left:return{x:a,y:l+d/2}}}function Hw(t,e){return t&&(e?t.find(n=>n.id===e):t[0])||null}function Zp(t,e){return t?typeof t=="string"?t:`${e?`${e}__`:""}${Object.keys(t).sort().map(s=>`${s}=${t[s]}`).join("&")}`:""}function XB(t,{id:e,defaultColor:n,defaultMarkerStart:s,defaultMarkerEnd:a}){const l=new Set;return t.reduce((c,d)=>([d.markerStart||s,d.markerEnd||a].forEach(h=>{if(h&&typeof h=="object"){const f=Zp(h,e);l.has(f)||(c.push({id:f,color:h.color||n,...h}),l.add(f))}}),c),[]).sort((c,d)=>c.id.localeCompare(d.id))}const pS=1e3,KB=10,Gg={nodeOrigin:[0,0],nodeExtent:Ll,elevateNodesOnSelect:!0,defaults:{}},WB={...Gg,checkEquality:!0};function Yg(t,e){const n={...t};for(const s in e)e[s]!==void 0&&(n[s]=e[s]);return n}function JB(t,e,n){const s=Yg(Gg,n);for(const a of t.values())if(a.parentId)Xg(a,t,e,s);else{const l=ec(a,s.nodeOrigin),c=Va(a.extent)?a.extent:s.nodeExtent,d=Si(l,c,Zr(a));a.internals.positionAbsolute=d}}function ZB(t,e){if(!t.handles)return t.measured?e?.internals.handleBounds:void 0;const n=[],s=[];for(const a of t.handles){const l={id:a.id,width:a.width??1,height:a.height??1,nodeId:t.id,x:a.x,y:a.y,position:a.position,type:a.type};a.type==="source"?n.push(l):a.type==="target"&&s.push(l)}return{source:n,target:s}}function eg(t,e,n,s){const a=Yg(WB,s);let l={i:-1},c=t.length>0;const d=new Map(e),h=a?.elevateNodesOnSelect?pS:0;e.clear(),n.clear();for(const f of t){let p=d.get(f.id);if(a.checkEquality&&f===p?.internals.userNode)e.set(f.id,p);else{const m=ec(f,a.nodeOrigin),y=Va(f.extent)?f.extent:a.nodeExtent,_=Si(m,y,Zr(f));p={...a.defaults,...f,measured:{width:f.measured?.width,height:f.measured?.height},internals:{positionAbsolute:_,handleBounds:ZB(f,p),z:gS(f,h),userNode:f}},e.set(f.id,p)}(p.measured===void 0||p.measured.width===void 0||p.measured.height===void 0)&&!p.hidden&&(c=!1),f.parentId&&Xg(p,e,n,s,l)}return c}function eU(t,e){if(!t.parentId)return;const n=e.get(t.parentId);n?n.set(t.id,t):e.set(t.parentId,new Map([[t.id,t]]))}function Xg(t,e,n,s,a){const{elevateNodesOnSelect:l,nodeOrigin:c,nodeExtent:d}=Yg(Gg,s),h=t.parentId,f=e.get(h);if(!f){console.warn(`Parent node ${h} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}eU(t,n),a&&!f.parentId&&f.internals.rootParentIndex===void 0&&(f.internals.rootParentIndex=++a.i,f.internals.z=f.internals.z+a.i*KB),a&&f.internals.rootParentIndex!==void 0&&(a.i=f.internals.rootParentIndex);const p=l?pS:0,{x:m,y,z:_}=tU(t,f,c,d,p),{positionAbsolute:x}=t.internals,w=m!==x.x||y!==x.y;(w||_!==t.internals.z)&&e.set(t.id,{...t,internals:{...t.internals,positionAbsolute:w?{x:m,y}:x,z:_}})}function gS(t,e){return(rr(t.zIndex)?t.zIndex:0)+(t.selected?e:0)}function tU(t,e,n,s,a){const{x:l,y:c}=e.internals.positionAbsolute,d=Zr(t),h=ec(t,n),f=Va(t.extent)?Si(h,t.extent,d):h;let p=Si({x:l+f.x,y:c+f.y},s,d);t.extent==="parent"&&(p=rS(p,d,e));const m=gS(t,a),y=e.internals.z??0;return{x:p.x,y:p.y,z:y>=m?y+1:m}}function Kg(t,e,n,s=[0,0]){const a=[],l=new Map;for(const c of t){const d=e.get(c.parentId);if(!d)continue;const h=l.get(c.parentId)?.expandedRect??Fa(d),f=iS(h,c.rect);l.set(c.parentId,{expandedRect:f,parent:d})}return l.size>0&&l.forEach(({expandedRect:c,parent:d},h)=>{const f=d.internals.positionAbsolute,p=Zr(d),m=d.origin??s,y=c.x<f.x?Math.round(Math.abs(f.x-c.x)):0,_=c.y<f.y?Math.round(Math.abs(f.y-c.y)):0,x=Math.max(p.width,Math.round(c.width)),w=Math.max(p.height,Math.round(c.height)),A=(x-p.width)*m[0],S=(w-p.height)*m[1];(y>0||_>0||A||S)&&(a.push({id:h,type:"position",position:{x:d.position.x-y+A,y:d.position.y-_+S}}),n.get(h)?.forEach(T=>{t.some(E=>E.id===T.id)||a.push({id:T.id,type:"position",position:{x:T.position.x+y,y:T.position.y+_}})})),(p.width<c.width||p.height<c.height||y||_)&&a.push({id:h,type:"dimensions",setAttributes:!0,dimensions:{width:x+(y?m[0]*y-A:0),height:w+(_?m[1]*_-S:0)}})}),a}function nU(t,e,n,s,a,l){const c=s?.querySelector(".xyflow__viewport");let d=!1;if(!c)return{changes:[],updatedInternals:d};const h=[],f=window.getComputedStyle(c),{m22:p}=new window.DOMMatrixReadOnly(f.transform),m=[];for(const y of t.values()){const _=e.get(y.id);if(!_)continue;if(_.hidden){e.set(_.id,{..._,internals:{..._.internals,handleBounds:void 0}}),d=!0;continue}const x=Fg(y.nodeElement),w=_.measured.width!==x.width||_.measured.height!==x.height;if(!!(x.width&&x.height&&(w||!_.internals.handleBounds||y.force))){const S=y.nodeElement.getBoundingClientRect(),T=Va(_.extent)?_.extent:l;let{positionAbsolute:E}=_.internals;_.parentId&&_.extent==="parent"?E=rS(E,x,e.get(_.parentId)):T&&(E=Si(E,T,x));const C={..._,measured:x,internals:{..._.internals,positionAbsolute:E,handleBounds:{source:Bw("source",y.nodeElement,S,p,_.id),target:Bw("target",y.nodeElement,S,p,_.id)}}};e.set(_.id,C),_.parentId&&Xg(C,e,n,{nodeOrigin:a}),d=!0,w&&(h.push({id:_.id,type:"dimensions",dimensions:x}),_.expandParent&&_.parentId&&m.push({id:_.id,parentId:_.parentId,rect:Fa(C,a)}))}}if(m.length>0){const y=Kg(m,e,n,a);h.push(...y)}return{changes:h,updatedInternals:d}}async function rU({delta:t,panZoom:e,transform:n,translateExtent:s,width:a,height:l}){if(!e||!t.x&&!t.y)return Promise.resolve(!1);const c=await e.setViewportConstrained({x:n[0]+t.x,y:n[1]+t.y,zoom:n[2]},[[0,0],[a,l]],s),d=!!c&&(c.x!==n[0]||c.y!==n[1]||c.k!==n[2]);return Promise.resolve(d)}function qw(t,e,n,s,a,l){let c=a;const d=s.get(c)||new Map;s.set(c,d.set(n,e)),c=`${a}-${t}`;const h=s.get(c)||new Map;if(s.set(c,h.set(n,e)),l){c=`${a}-${t}-${l}`;const f=s.get(c)||new Map;s.set(c,f.set(n,e))}}function yS(t,e,n){t.clear(),e.clear();for(const s of n){const{source:a,target:l,sourceHandle:c=null,targetHandle:d=null}=s,h={edgeId:s.id,source:a,target:l,sourceHandle:c,targetHandle:d},f=`${a}-${c}--${l}-${d}`,p=`${l}-${d}--${a}-${c}`;qw("source",h,p,t,a,c),qw("target",h,f,t,l,d),e.set(s.id,s)}}function sU(t,e){if(t===null||e===null)return!1;const n=Array.isArray(t)?t:[t],s=Array.isArray(e)?e:[e];if(n.length!==s.length)return!1;for(let a=0;a<n.length;a++)if(n[a].id!==s[a].id||n[a].type!==s[a].type||!Object.is(n[a].data,s[a].data))return!1;return!0}function vS(t,e){if(!t.parentId)return!1;const n=e.get(t.parentId);return n?n.selected?!0:vS(n,e):!1}function Qw(t,e,n){let s=t;do{if(s?.matches?.(e))return!0;if(s===n)return!1;s=s?.parentElement}while(s);return!1}function iU(t,e,n,s){const a=new Map;for(const[l,c]of t)if((c.selected||c.id===s)&&(!c.parentId||!vS(c,t))&&(c.draggable||e&&typeof c.draggable>"u")){const d=t.get(l);d&&a.set(l,{id:l,position:d.position||{x:0,y:0},distance:{x:n.x-d.internals.positionAbsolute.x,y:n.y-d.internals.positionAbsolute.y},extent:d.extent,parentId:d.parentId,origin:d.origin,expandParent:d.expandParent,internals:{positionAbsolute:d.internals.positionAbsolute||{x:0,y:0}},measured:{width:d.measured.width??0,height:d.measured.height??0}})}return a}function lp({nodeId:t,dragItems:e,nodeLookup:n,dragging:s=!0}){const a=[];for(const[c,d]of e){const h=n.get(c)?.internals.userNode;h&&a.push({...h,position:d.position,dragging:s})}if(!t)return[a[0],a];const l=n.get(t)?.internals.userNode;return[l?{...l,position:e.get(t)?.position||l.position,dragging:s}:a[0],a]}function aU({dragItems:t,snapGrid:e,x:n,y:s}){const a=t.values().next().value;if(!a)return null;const l={x:n-a.distance.x,y:s-a.distance.y},c=nc(l,e);return{x:c.x-l.x,y:c.y-l.y}}function oU({onNodeMouseDown:t,getStoreItems:e,onDragStart:n,onDrag:s,onDragStop:a}){let l={x:null,y:null},c=0,d=new Map,h=!1,f={x:0,y:0},p=null,m=!1,y=null,_=!1,x=!1,w=null;function A({noDragClassName:T,handleSelector:E,domNode:C,isSelectable:j,nodeId:O,nodeClickDistance:M=0}){y=jn(C);function D({x:F,y:K}){const{nodeLookup:$,nodeExtent:Q,snapGrid:R,snapToGrid:U,nodeOrigin:B,onNodeDrag:L,onSelectionDrag:H,onError:I,updateNodePositions:P}=e();l={x:F,y:K};let Y=!1;const J=d.size>1,Z=J&&Q?Wp(tc(d)):null,ae=J&&U?aU({dragItems:d,snapGrid:R,x:F,y:K}):null;for(const[ce,he]of d){if(!$.has(ce))continue;let ye={x:F-he.distance.x,y:K-he.distance.y};U&&(ye=ae?{x:Math.round(ye.x+ae.x),y:Math.round(ye.y+ae.y)}:nc(ye,R));let pe=null;if(J&&Q&&!he.extent&&Z){const{positionAbsolute:we}=he.internals,ue=we.x-Z.x+Q[0][0],te=we.x+he.measured.width-Z.x2+Q[1][0],fe=we.y-Z.y+Q[0][1],Te=we.y+he.measured.height-Z.y2+Q[1][1];pe=[[ue,fe],[te,Te]]}const{position:_e,positionAbsolute:be}=nS({nodeId:ce,nextPosition:ye,nodeLookup:$,nodeExtent:pe||Q,nodeOrigin:B,onError:I});Y=Y||he.position.x!==_e.x||he.position.y!==_e.y,he.position=_e,he.internals.positionAbsolute=be}if(x=x||Y,!!Y&&(P(d,!0),w&&(s||L||!O&&H))){const[ce,he]=lp({nodeId:O,dragItems:d,nodeLookup:$});s?.(w,d,ce,he),L?.(w,ce,he),O||H?.(w,he)}}async function q(){if(!p)return;const{transform:F,panBy:K,autoPanSpeed:$,autoPanOnNodeDrag:Q}=e();if(!Q){h=!1,cancelAnimationFrame(c);return}const[R,U]=sS(f,p,$);(R!==0||U!==0)&&(l.x=(l.x??0)-R/F[2],l.y=(l.y??0)-U/F[2],await K({x:R,y:U})&&D(l)),c=requestAnimationFrame(q)}function G(F){const{nodeLookup:K,multiSelectionActive:$,nodesDraggable:Q,transform:R,snapGrid:U,snapToGrid:B,selectNodesOnDrag:L,onNodeDragStart:H,onSelectionDragStart:I,unselectNodesAndEdges:P}=e();m=!0,(!L||!j)&&!$&&O&&(K.get(O)?.selected||P()),j&&L&&O&&t?.(O);const Y=Sl(F.sourceEvent,{transform:R,snapGrid:U,snapToGrid:B,containerBounds:p});if(l=Y,d=iU(K,Q,Y,O),d.size>0&&(n||H||!O&&I)){const[J,Z]=lp({nodeId:O,dragItems:d,nodeLookup:K});n?.(F.sourceEvent,d,J,Z),H?.(F.sourceEvent,J,Z),O||I?.(F.sourceEvent,Z)}}const V=DE().clickDistance(M).on("start",F=>{const{domNode:K,nodeDragThreshold:$,transform:Q,snapGrid:R,snapToGrid:U}=e();p=K?.getBoundingClientRect()||null,_=!1,x=!1,w=F.sourceEvent,$===0&&G(F),l=Sl(F.sourceEvent,{transform:Q,snapGrid:R,snapToGrid:U,containerBounds:p}),f=sr(F.sourceEvent,p)}).on("drag",F=>{const{autoPanOnNodeDrag:K,transform:$,snapGrid:Q,snapToGrid:R,nodeDragThreshold:U,nodeLookup:B}=e(),L=Sl(F.sourceEvent,{transform:$,snapGrid:Q,snapToGrid:R,containerBounds:p});if(w=F.sourceEvent,(F.sourceEvent.type==="touchmove"&&F.sourceEvent.touches.length>1||O&&!B.has(O))&&(_=!0),!_){if(!h&&K&&m&&(h=!0,q()),!m){const H=sr(F.sourceEvent,p),I=H.x-f.x,P=H.y-f.y;Math.sqrt(I*I+P*P)>U&&G(F)}(l.x!==L.xSnapped||l.y!==L.ySnapped)&&d&&m&&(f=sr(F.sourceEvent,p),D(L))}}).on("end",F=>{if(!(!m||_)&&(h=!1,m=!1,cancelAnimationFrame(c),d.size>0)){const{nodeLookup:K,updateNodePositions:$,onNodeDragStop:Q,onSelectionDragStop:R}=e();if(x&&($(d,!1),x=!1),a||Q||!O&&R){const[U,B]=lp({nodeId:O,dragItems:d,nodeLookup:K,dragging:!1});a?.(F.sourceEvent,d,U,B),Q?.(F.sourceEvent,U,B),O||R?.(F.sourceEvent,B)}}}).filter(F=>{const K=F.target;return!F.button&&(!T||!Qw(K,`.${T}`,C))&&(!E||Qw(K,E,C))});y.call(V)}function S(){y?.on(".drag",null)}return{update:A,destroy:S}}function lU(t,e,n){const s=[],a={x:t.x-n,y:t.y-n,width:n*2,height:n*2};for(const l of e.values())zl(a,Fa(l))>0&&s.push(l);return s}const cU=250;function uU(t,e,n,s){let a=[],l=1/0;const c=lU(t,n,e+cU);for(const d of c){const h=[...d.internals.handleBounds?.source??[],...d.internals.handleBounds?.target??[]];for(const f of h){if(s.nodeId===f.nodeId&&s.type===f.type&&s.id===f.id)continue;const{x:p,y:m}=Hl(d,f,f.position,!0),y=Math.sqrt(Math.pow(p-t.x,2)+Math.pow(m-t.y,2));y>e||(y<l?(a=[{...f,x:p,y:m}],l=y):y===l&&a.push({...f,x:p,y:m}))}}if(!a.length)return null;if(a.length>1){const d=s.type==="source"?"target":"source";return a.find(h=>h.type===d)??a[0]}return a[0]}function _S(t,e,n,s,a,l=!1){const c=s.get(t);if(!c)return null;const d=a==="strict"?c.internals.handleBounds?.[e]:[...c.internals.handleBounds?.source??[],...c.internals.handleBounds?.target??[]],h=(n?d?.find(f=>f.id===n):d?.[0])??null;return h&&l?{...h,...Hl(c,h,h.position,!0)}:h}function bS(t,e){return t||(e?.classList.contains("target")?"target":e?.classList.contains("source")?"source":null)}function dU(t,e){let n=null;return e?n=!0:t&&!e&&(n=!1),n}const wS=()=>!0;function fU(t,{connectionMode:e,connectionRadius:n,handleId:s,nodeId:a,edgeUpdaterType:l,isTarget:c,domNode:d,nodeLookup:h,lib:f,autoPanOnConnect:p,flowId:m,panBy:y,cancelConnection:_,onConnectStart:x,onConnect:w,onConnectEnd:A,isValidConnection:S=wS,onReconnectEnd:T,updateConnection:E,getTransform:C,getFromHandle:j,autoPanSpeed:O,dragThreshold:M=1,handleDomNode:D}){const q=lS(t.target);let G=0,V;const{x:F,y:K}=sr(t),$=bS(l,D),Q=d?.getBoundingClientRect();let R=!1;if(!Q||!$)return;const U=_S(a,$,s,h,e);if(!U)return;let B=sr(t,Q),L=!1,H=null,I=!1,P=null;function Y(){if(!p||!Q)return;const[_e,be]=sS(B,Q,O);y({x:_e,y:be}),G=requestAnimationFrame(Y)}const J={...U,nodeId:a,type:$,position:U.position},Z=h.get(a);let ce={inProgress:!0,isValid:null,from:Hl(Z,J,xe.Left,!0),fromHandle:J,fromPosition:J.position,fromNode:Z,to:B,toHandle:null,toPosition:Ow[J.position],toNode:null,pointer:B};function he(){R=!0,E(ce),x?.(t,{nodeId:a,handleId:s,handleType:$})}M===0&&he();function ye(_e){if(!R){const{x:te,y:fe}=sr(_e),Te=te-F,De=fe-K;if(!(Te*Te+De*De>M*M))return;he()}if(!j()||!J){pe(_e);return}const be=C();B=sr(_e,Q),V=uU(rc(B,be,!1,[1,1]),n,h,J),L||(Y(),L=!0);const we=xS(_e,{handle:V,connectionMode:e,fromNodeId:a,fromHandleId:s,fromType:c?"target":"source",isValidConnection:S,doc:q,lib:f,flowId:m,nodeLookup:h});P=we.handleDomNode,H=we.connection,I=dU(!!V,we.isValid);const ue={...ce,isValid:I,to:we.toHandle&&I?$d({x:we.toHandle.x,y:we.toHandle.y},be):B,toHandle:we.toHandle,toPosition:I&&we.toHandle?we.toHandle.position:Ow[J.position],toNode:we.toHandle?h.get(we.toHandle.nodeId):null,pointer:B};E(ue),ce=ue}function pe(_e){if(!("touches"in _e&&_e.touches.length>0)){if(R){(V||P)&&H&&I&&w?.(H);const{inProgress:be,...we}=ce,ue={...we,toPosition:ce.toHandle?ce.toPosition:null};A?.(_e,ue),l&&T?.(_e,ue)}_(),cancelAnimationFrame(G),L=!1,I=!1,H=null,P=null,q.removeEventListener("mousemove",ye),q.removeEventListener("mouseup",pe),q.removeEventListener("touchmove",ye),q.removeEventListener("touchend",pe)}}q.addEventListener("mousemove",ye),q.addEventListener("mouseup",pe),q.addEventListener("touchmove",ye),q.addEventListener("touchend",pe)}function xS(t,{handle:e,connectionMode:n,fromNodeId:s,fromHandleId:a,fromType:l,doc:c,lib:d,flowId:h,isValidConnection:f=wS,nodeLookup:p}){const m=l==="target",y=e?c.querySelector(`.${d}-flow__handle[data-id="${h}-${e?.nodeId}-${e?.id}-${e?.type}"]`):null,{x:_,y:x}=sr(t),w=c.elementFromPoint(_,x),A=w?.classList.contains(`${d}-flow__handle`)?w:y,S={handleDomNode:A,isValid:!1,connection:null,toHandle:null};if(A){const T=bS(void 0,A),E=A.getAttribute("data-nodeid"),C=A.getAttribute("data-handleid"),j=A.classList.contains("connectable"),O=A.classList.contains("connectableend");if(!E||!T)return S;const M={source:m?E:s,sourceHandle:m?C:a,target:m?s:E,targetHandle:m?a:C};S.connection=M;const q=j&&O&&(n===qa.Strict?m&&T==="source"||!m&&T==="target":E!==s||C!==a);S.isValid=q&&f(M),S.toHandle=_S(E,T,C,p,n,!0)}return S}const tg={onPointerDown:fU,isValid:xS};function hU({domNode:t,panZoom:e,getTransform:n,getViewScale:s}){const a=jn(t);function l({translateExtent:d,width:h,height:f,zoomStep:p=1,pannable:m=!0,zoomable:y=!0,inversePan:_=!1}){const x=E=>{if(E.sourceEvent.type!=="wheel"||!e)return;const C=n(),j=E.sourceEvent.ctrlKey&&Pl()?10:1,O=-E.sourceEvent.deltaY*(E.sourceEvent.deltaMode===1?.05:E.sourceEvent.deltaMode?1:.002)*p,M=C[2]*Math.pow(2,O*j);e.scaleTo(M)};let w=[0,0];const A=E=>{(E.sourceEvent.type==="mousedown"||E.sourceEvent.type==="touchstart")&&(w=[E.sourceEvent.clientX??E.sourceEvent.touches[0].clientX,E.sourceEvent.clientY??E.sourceEvent.touches[0].clientY])},S=E=>{const C=n();if(E.sourceEvent.type!=="mousemove"&&E.sourceEvent.type!=="touchmove"||!e)return;const j=[E.sourceEvent.clientX??E.sourceEvent.touches[0].clientX,E.sourceEvent.clientY??E.sourceEvent.touches[0].clientY],O=[j[0]-w[0],j[1]-w[1]];w=j;const M=s()*Math.max(C[2],Math.log(C[2]))*(_?-1:1),D={x:C[0]-O[0]*M,y:C[1]-O[1]*M},q=[[0,0],[h,f]];e.setViewportConstrained({x:D.x,y:D.y,zoom:C[2]},q,d)},T=KE().on("start",A).on("zoom",m?S:null).on("zoom.wheel",y?x:null);a.call(T,{})}function c(){a.on("zoom",null)}return{update:l,destroy:c,pointer:tr}}const uf=t=>({x:t.x,y:t.y,zoom:t.k}),cp=({x:t,y:e,zoom:n})=>of.translate(t,e).scale(n),Ma=(t,e)=>t.target.closest(`.${e}`),AS=(t,e)=>e===2&&Array.isArray(t)&&t.includes(2),mU=t=>((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2,up=(t,e=0,n=mU,s=()=>{})=>{const a=typeof e=="number"&&e>0;return a||s(),a?t.transition().duration(e).ease(n).on("end",s):t},ES=t=>{const e=t.ctrlKey&&Pl()?10:1;return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*e};function pU({zoomPanValues:t,noWheelClassName:e,d3Selection:n,d3Zoom:s,panOnScrollMode:a,panOnScrollSpeed:l,zoomOnPinch:c,onPanZoomStart:d,onPanZoom:h,onPanZoomEnd:f}){return p=>{if(Ma(p,e))return p.ctrlKey&&p.preventDefault(),!1;p.preventDefault(),p.stopImmediatePropagation();const m=n.property("__zoom").k||1;if(p.ctrlKey&&c){const A=tr(p),S=ES(p),T=m*Math.pow(2,S);s.scaleTo(n,T,A,p);return}const y=p.deltaMode===1?20:1;let _=a===xi.Vertical?0:p.deltaX*y,x=a===xi.Horizontal?0:p.deltaY*y;!Pl()&&p.shiftKey&&a!==xi.Vertical&&(_=p.deltaY*y,x=0),s.translateBy(n,-(_/m)*l,-(x/m)*l,{internal:!0});const w=uf(n.property("__zoom"));clearTimeout(t.panScrollTimeout),t.isPanScrolling?(h?.(p,w),t.panScrollTimeout=setTimeout(()=>{f?.(p,w),t.isPanScrolling=!1},150)):(t.isPanScrolling=!0,d?.(p,w))}}function gU({noWheelClassName:t,preventScrolling:e,d3ZoomHandler:n}){return function(s,a){const l=s.type==="wheel",c=!e&&l&&!s.ctrlKey,d=Ma(s,t);if(s.ctrlKey&&l&&d&&s.preventDefault(),c||d)return null;s.preventDefault(),n.call(this,s,a)}}function yU({zoomPanValues:t,onDraggingChange:e,onPanZoomStart:n}){return s=>{if(s.sourceEvent?.internal)return;const a=uf(s.transform);t.mouseButton=s.sourceEvent?.button||0,t.isZoomingOrPanning=!0,t.prevViewport=a,s.sourceEvent?.type==="mousedown"&&e(!0),n&&n?.(s.sourceEvent,a)}}function vU({zoomPanValues:t,panOnDrag:e,onPaneContextMenu:n,onTransformChange:s,onPanZoom:a}){return l=>{t.usedRightMouseButton=!!(n&&AS(e,t.mouseButton??0)),l.sourceEvent?.sync||s([l.transform.x,l.transform.y,l.transform.k]),a&&!l.sourceEvent?.internal&&a?.(l.sourceEvent,uf(l.transform))}}function _U({zoomPanValues:t,panOnDrag:e,panOnScroll:n,onDraggingChange:s,onPanZoomEnd:a,onPaneContextMenu:l}){return c=>{if(!c.sourceEvent?.internal&&(t.isZoomingOrPanning=!1,l&&AS(e,t.mouseButton??0)&&!t.usedRightMouseButton&&c.sourceEvent&&l(c.sourceEvent),t.usedRightMouseButton=!1,s(!1),a)){const d=uf(c.transform);t.prevViewport=d,clearTimeout(t.timerId),t.timerId=setTimeout(()=>{a?.(c.sourceEvent,d)},n?150:0)}}}function bU({zoomActivationKeyPressed:t,zoomOnScroll:e,zoomOnPinch:n,panOnDrag:s,panOnScroll:a,zoomOnDoubleClick:l,userSelectionActive:c,noWheelClassName:d,noPanClassName:h,lib:f,connectionInProgress:p}){return m=>{const y=t||e,_=n&&m.ctrlKey,x=m.type==="wheel";if(m.button===1&&m.type==="mousedown"&&(Ma(m,`${f}-flow__node`)||Ma(m,`${f}-flow__edge`)))return!0;if(!s&&!y&&!a&&!l&&!n||c||p&&!x||Ma(m,d)&&x||Ma(m,h)&&(!x||a&&x&&!t)||!n&&m.ctrlKey&&x)return!1;if(!n&&m.type==="touchstart"&&m.touches?.length>1)return m.preventDefault(),!1;if(!y&&!a&&!_&&x||!s&&(m.type==="mousedown"||m.type==="touchstart")||Array.isArray(s)&&!s.includes(m.button)&&m.type==="mousedown")return!1;const w=Array.isArray(s)&&s.includes(m.button)||!m.button||m.button<=1;return(!m.ctrlKey||x)&&w}}function wU({domNode:t,minZoom:e,maxZoom:n,translateExtent:s,viewport:a,onPanZoom:l,onPanZoomStart:c,onPanZoomEnd:d,onDraggingChange:h}){const f={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},p=t.getBoundingClientRect(),m=KE().scaleExtent([e,n]).translateExtent(s),y=jn(t).call(m);T({x:a.x,y:a.y,zoom:Qa(a.zoom,e,n)},[[0,0],[p.width,p.height]],s);const _=y.on("wheel.zoom"),x=y.on("dblclick.zoom");m.wheelDelta(ES);function w(V,F){return y?new Promise(K=>{m?.interpolate(F?.interpolate==="linear"?El:ud).transform(up(y,F?.duration,F?.ease,()=>K(!0)),V)}):Promise.resolve(!1)}function A({noWheelClassName:V,noPanClassName:F,onPaneContextMenu:K,userSelectionActive:$,panOnScroll:Q,panOnDrag:R,panOnScrollMode:U,panOnScrollSpeed:B,preventScrolling:L,zoomOnPinch:H,zoomOnScroll:I,zoomOnDoubleClick:P,zoomActivationKeyPressed:Y,lib:J,onTransformChange:Z,connectionInProgress:ae,paneClickDistance:ce,selectionOnDrag:he}){$&&!f.isZoomingOrPanning&&S();const ye=Q&&!Y&&!$;m.clickDistance(he?1/0:!rr(ce)||ce<0?0:ce);const pe=ye?pU({zoomPanValues:f,noWheelClassName:V,d3Selection:y,d3Zoom:m,panOnScrollMode:U,panOnScrollSpeed:B,zoomOnPinch:H,onPanZoomStart:c,onPanZoom:l,onPanZoomEnd:d}):gU({noWheelClassName:V,preventScrolling:L,d3ZoomHandler:_});if(y.on("wheel.zoom",pe,{passive:!1}),!$){const be=yU({zoomPanValues:f,onDraggingChange:h,onPanZoomStart:c});m.on("start",be);const we=vU({zoomPanValues:f,panOnDrag:R,onPaneContextMenu:!!K,onPanZoom:l,onTransformChange:Z});m.on("zoom",we);const ue=_U({zoomPanValues:f,panOnDrag:R,panOnScroll:Q,onPaneContextMenu:K,onPanZoomEnd:d,onDraggingChange:h});m.on("end",ue)}const _e=bU({zoomActivationKeyPressed:Y,panOnDrag:R,zoomOnScroll:I,panOnScroll:Q,zoomOnDoubleClick:P,zoomOnPinch:H,userSelectionActive:$,noPanClassName:F,noWheelClassName:V,lib:J,connectionInProgress:ae});m.filter(_e),P?y.on("dblclick.zoom",x):y.on("dblclick.zoom",null)}function S(){m.on("zoom",null)}async function T(V,F,K){const $=cp(V),Q=m?.constrain()($,F,K);return Q&&await w(Q),new Promise(R=>R(Q))}async function E(V,F){const K=cp(V);return await w(K,F),new Promise($=>$(K))}function C(V){if(y){const F=cp(V),K=y.property("__zoom");(K.k!==V.zoom||K.x!==V.x||K.y!==V.y)&&m?.transform(y,F,null,{sync:!0})}}function j(){const V=y?XE(y.node()):{x:0,y:0,k:1};return{x:V.x,y:V.y,zoom:V.k}}function O(V,F){return y?new Promise(K=>{m?.interpolate(F?.interpolate==="linear"?El:ud).scaleTo(up(y,F?.duration,F?.ease,()=>K(!0)),V)}):Promise.resolve(!1)}function M(V,F){return y?new Promise(K=>{m?.interpolate(F?.interpolate==="linear"?El:ud).scaleBy(up(y,F?.duration,F?.ease,()=>K(!0)),V)}):Promise.resolve(!1)}function D(V){m?.scaleExtent(V)}function q(V){m?.translateExtent(V)}function G(V){const F=!rr(V)||V<0?0:V;m?.clickDistance(F)}return{update:A,destroy:S,setViewport:E,setViewportConstrained:T,getViewport:j,scaleTo:O,scaleBy:M,setScaleExtent:D,setTranslateExtent:q,syncViewport:C,setClickDistance:G}}var Ga;(function(t){t.Line="line",t.Handle="handle"})(Ga||(Ga={}));function xU({width:t,prevWidth:e,height:n,prevHeight:s,affectsX:a,affectsY:l}){const c=t-e,d=n-s,h=[c>0?1:c<0?-1:0,d>0?1:d<0?-1:0];return c&&a&&(h[0]=h[0]*-1),d&&l&&(h[1]=h[1]*-1),h}function Fw(t){const e=t.includes("right")||t.includes("left"),n=t.includes("bottom")||t.includes("top"),s=t.includes("left"),a=t.includes("top");return{isHorizontal:e,isVertical:n,affectsX:s,affectsY:a}}function js(t,e){return Math.max(0,e-t)}function Os(t,e){return Math.max(0,t-e)}function Xu(t,e,n){return Math.max(0,e-t,t-n)}function Vw(t,e){return t?!e:e}function AU(t,e,n,s,a,l,c,d){let{affectsX:h,affectsY:f}=e;const{isHorizontal:p,isVertical:m}=e,y=p&&m,{xSnapped:_,ySnapped:x}=n,{minWidth:w,maxWidth:A,minHeight:S,maxHeight:T}=s,{x:E,y:C,width:j,height:O,aspectRatio:M}=t;let D=Math.floor(p?_-t.pointerX:0),q=Math.floor(m?x-t.pointerY:0);const G=j+(h?-D:D),V=O+(f?-q:q),F=-l[0]*j,K=-l[1]*O;let $=Xu(G,w,A),Q=Xu(V,S,T);if(c){let B=0,L=0;h&&D<0?B=js(E+D+F,c[0][0]):!h&&D>0&&(B=Os(E+G+F,c[1][0])),f&&q<0?L=js(C+q+K,c[0][1]):!f&&q>0&&(L=Os(C+V+K,c[1][1])),$=Math.max($,B),Q=Math.max(Q,L)}if(d){let B=0,L=0;h&&D>0?B=Os(E+D,d[0][0]):!h&&D<0&&(B=js(E+G,d[1][0])),f&&q>0?L=Os(C+q,d[0][1]):!f&&q<0&&(L=js(C+V,d[1][1])),$=Math.max($,B),Q=Math.max(Q,L)}if(a){if(p){const B=Xu(G/M,S,T)*M;if($=Math.max($,B),c){let L=0;!h&&!f||h&&!f&&y?L=Os(C+K+G/M,c[1][1])*M:L=js(C+K+(h?D:-D)/M,c[0][1])*M,$=Math.max($,L)}if(d){let L=0;!h&&!f||h&&!f&&y?L=js(C+G/M,d[1][1])*M:L=Os(C+(h?D:-D)/M,d[0][1])*M,$=Math.max($,L)}}if(m){const B=Xu(V*M,w,A)/M;if(Q=Math.max(Q,B),c){let L=0;!h&&!f||f&&!h&&y?L=Os(E+V*M+F,c[1][0])/M:L=js(E+(f?q:-q)*M+F,c[0][0])/M,Q=Math.max(Q,L)}if(d){let L=0;!h&&!f||f&&!h&&y?L=js(E+V*M,d[1][0])/M:L=Os(E+(f?q:-q)*M,d[0][0])/M,Q=Math.max(Q,L)}}}q=q+(q<0?Q:-Q),D=D+(D<0?$:-$),a&&(y?G>V*M?q=(Vw(h,f)?-D:D)/M:D=(Vw(h,f)?-q:q)*M:p?(q=D/M,f=h):(D=q*M,h=f));const R=h?E+D:E,U=f?C+q:C;return{width:j+(h?-D:D),height:O+(f?-q:q),x:l[0]*D*(h?-1:1)+R,y:l[1]*q*(f?-1:1)+U}}const SS={width:0,height:0,x:0,y:0},EU={...SS,pointerX:0,pointerY:0,aspectRatio:1};function SU(t){return[[0,0],[t.measured.width,t.measured.height]]}function CU(t,e,n){const s=e.position.x+t.position.x,a=e.position.y+t.position.y,l=t.measured.width??0,c=t.measured.height??0,d=n[0]*l,h=n[1]*c;return[[s-d,a-h],[s+l-d,a+c-h]]}function TU({domNode:t,nodeId:e,getStoreItems:n,onChange:s,onEnd:a}){const l=jn(t);let c={controlDirection:Fw("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function d({controlPosition:f,boundaries:p,keepAspectRatio:m,resizeDirection:y,onResizeStart:_,onResize:x,onResizeEnd:w,shouldResize:A}){let S={...SS},T={...EU};c={boundaries:p,resizeDirection:y,keepAspectRatio:m,controlDirection:Fw(f)};let E,C=null,j=[],O,M,D,q=!1;const G=DE().on("start",V=>{const{nodeLookup:F,transform:K,snapGrid:$,snapToGrid:Q,nodeOrigin:R,paneDomNode:U}=n();if(E=F.get(e),!E)return;C=U?.getBoundingClientRect()??null;const{xSnapped:B,ySnapped:L}=Sl(V.sourceEvent,{transform:K,snapGrid:$,snapToGrid:Q,containerBounds:C});S={width:E.measured.width??0,height:E.measured.height??0,x:E.position.x??0,y:E.position.y??0},T={...S,pointerX:B,pointerY:L,aspectRatio:S.width/S.height},O=void 0,E.parentId&&(E.extent==="parent"||E.expandParent)&&(O=F.get(E.parentId),M=O&&E.extent==="parent"?SU(O):void 0),j=[],D=void 0;for(const[H,I]of F)if(I.parentId===e&&(j.push({id:H,position:{...I.position},extent:I.extent}),I.extent==="parent"||I.expandParent)){const P=CU(I,E,I.origin??R);D?D=[[Math.min(P[0][0],D[0][0]),Math.min(P[0][1],D[0][1])],[Math.max(P[1][0],D[1][0]),Math.max(P[1][1],D[1][1])]]:D=P}_?.(V,{...S})}).on("drag",V=>{const{transform:F,snapGrid:K,snapToGrid:$,nodeOrigin:Q}=n(),R=Sl(V.sourceEvent,{transform:F,snapGrid:K,snapToGrid:$,containerBounds:C}),U=[];if(!E)return;const{x:B,y:L,width:H,height:I}=S,P={},Y=E.origin??Q,{width:J,height:Z,x:ae,y:ce}=AU(T,c.controlDirection,R,c.boundaries,c.keepAspectRatio,Y,M,D),he=J!==H,ye=Z!==I,pe=ae!==B&&he,_e=ce!==L&&ye;if(!pe&&!_e&&!he&&!ye)return;if((pe||_e||Y[0]===1||Y[1]===1)&&(P.x=pe?ae:S.x,P.y=_e?ce:S.y,S.x=P.x,S.y=P.y,j.length>0)){const te=ae-B,fe=ce-L;for(const Te of j)Te.position={x:Te.position.x-te+Y[0]*(J-H),y:Te.position.y-fe+Y[1]*(Z-I)},U.push(Te)}if((he||ye)&&(P.width=he&&(!c.resizeDirection||c.resizeDirection==="horizontal")?J:S.width,P.height=ye&&(!c.resizeDirection||c.resizeDirection==="vertical")?Z:S.height,S.width=P.width,S.height=P.height),O&&E.expandParent){const te=Y[0]*(P.width??0);P.x&&P.x<te&&(S.x=te,T.x=T.x-(P.x-te));const fe=Y[1]*(P.height??0);P.y&&P.y<fe&&(S.y=fe,T.y=T.y-(P.y-fe))}const be=xU({width:S.width,prevWidth:H,height:S.height,prevHeight:I,affectsX:c.controlDirection.affectsX,affectsY:c.controlDirection.affectsY}),we={...S,direction:be};A?.(V,we)!==!1&&(q=!0,x?.(V,we),s(P,U))}).on("end",V=>{q&&(w?.(V,{...S}),a?.({...S}),q=!1)});l.call(G)}function h(){l.on(".drag",null)}return{update:d,destroy:h}}var dp={exports:{}},fp={},hp={exports:{}},mp={};var Gw;function NU(){if(Gw)return mp;Gw=1;var t=Vl();function e(m,y){return m===y&&(m!==0||1/m===1/y)||m!==m&&y!==y}var n=typeof Object.is=="function"?Object.is:e,s=t.useState,a=t.useEffect,l=t.useLayoutEffect,c=t.useDebugValue;function d(m,y){var _=y(),x=s({inst:{value:_,getSnapshot:y}}),w=x[0].inst,A=x[1];return l(function(){w.value=_,w.getSnapshot=y,h(w)&&A({inst:w})},[m,_,y]),a(function(){return h(w)&&A({inst:w}),m(function(){h(w)&&A({inst:w})})},[m]),c(_),_}function h(m){var y=m.getSnapshot;m=m.value;try{var _=y();return!n(m,_)}catch{return!0}}function f(m,y){return y()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:d;return mp.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:p,mp}var Yw;function RU(){return Yw||(Yw=1,hp.exports=NU()),hp.exports}var Xw;function jU(){if(Xw)return fp;Xw=1;var t=Vl(),e=RU();function n(f,p){return f===p&&(f!==0||1/f===1/p)||f!==f&&p!==p}var s=typeof Object.is=="function"?Object.is:n,a=e.useSyncExternalStore,l=t.useRef,c=t.useEffect,d=t.useMemo,h=t.useDebugValue;return fp.useSyncExternalStoreWithSelector=function(f,p,m,y,_){var x=l(null);if(x.current===null){var w={hasValue:!1,value:null};x.current=w}else w=x.current;x=d(function(){function S(O){if(!T){if(T=!0,E=O,O=y(O),_!==void 0&&w.hasValue){var M=w.value;if(_(M,O))return C=M}return C=O}if(M=C,s(E,O))return M;var D=y(O);return _!==void 0&&_(M,D)?(E=O,M):(E=O,C=D)}var T=!1,E,C,j=m===void 0?null:m;return[function(){return S(p())},j===null?void 0:function(){return S(j())}]},[p,m,y,_]);var A=a(f,x[0],x[1]);return c(function(){w.hasValue=!0,w.value=A},[A]),h(A),A},fp}var Kw;function OU(){return Kw||(Kw=1,dp.exports=jU()),dp.exports}var IU=OU();const kU=Fl(IU),MU={},Ww=t=>{let e;const n=new Set,s=(p,m)=>{const y=typeof p=="function"?p(e):p;if(!Object.is(y,e)){const _=e;e=m??(typeof y!="object"||y===null)?y:Object.assign({},e,y),n.forEach(x=>x(e,_))}},a=()=>e,h={setState:s,getState:a,getInitialState:()=>f,subscribe:p=>(n.add(p),()=>n.delete(p)),destroy:()=>{(MU?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},f=e=t(s,a,h);return h},DU=t=>t?Ww(t):Ww,{useDebugValue:BU}=KN,{useSyncExternalStoreWithSelector:UU}=kU,LU=t=>t;function CS(t,e=LU,n){const s=UU(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return BU(s),s}const Jw=(t,e)=>{const n=DU(t),s=(a,l=e)=>CS(n,a,l);return Object.assign(s,n),s},$U=(t,e)=>t?Jw(t,e):Jw;function vt(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(const[s,a]of t)if(!Object.is(a,e.get(s)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(const s of t)if(!e.has(s))return!1;return!0}const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!1;for(const s of n)if(!Object.prototype.hasOwnProperty.call(e,s)||!Object.is(t[s],e[s]))return!1;return!0}const df=k.createContext(null),zU=df.Provider,TS=ir.error001();function Ge(t,e){const n=k.useContext(df);if(n===null)throw new Error(TS);return CS(n,t,e)}function mt(){const t=k.useContext(df);if(t===null)throw new Error(TS);return k.useMemo(()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe}),[t])}const Zw={display:"none"},PU={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},NS="react-flow__node-desc",RS="react-flow__edge-desc",HU="react-flow__aria-live",qU=t=>t.ariaLiveMessage,QU=t=>t.ariaLabelConfig;function FU({rfId:t}){const e=Ge(qU);return b.jsx("div",{id:`${HU}-${t}`,"aria-live":"assertive","aria-atomic":"true",style:PU,children:e})}function VU({rfId:t,disableKeyboardA11y:e}){const n=Ge(QU);return b.jsxs(b.Fragment,{children:[b.jsx("div",{id:`${NS}-${t}`,style:Zw,children:e?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),b.jsx("div",{id:`${RS}-${t}`,style:Zw,children:n["edge.a11yDescription.default"]}),!e&&b.jsx(FU,{rfId:t})]})}const ff=k.forwardRef(({position:t="top-left",children:e,className:n,style:s,...a},l)=>{const c=`${t}`.split("-");return b.jsx("div",{className:Ot(["react-flow__panel",n,...c]),style:s,ref:l,...a,children:e})});ff.displayName="Panel";function GU({proOptions:t,position:e="bottom-right"}){return t?.hideAttribution?null:b.jsx(ff,{position:e,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:b.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const YU=t=>{const e=[],n=[];for(const[,s]of t.nodeLookup)s.selected&&e.push(s.internals.userNode);for(const[,s]of t.edgeLookup)s.selected&&n.push(s);return{selectedNodes:e,selectedEdges:n}},Ku=t=>t.id;function XU(t,e){return vt(t.selectedNodes.map(Ku),e.selectedNodes.map(Ku))&&vt(t.selectedEdges.map(Ku),e.selectedEdges.map(Ku))}function KU({onSelectionChange:t}){const e=mt(),{selectedNodes:n,selectedEdges:s}=Ge(YU,XU);return k.useEffect(()=>{const a={nodes:n,edges:s};t?.(a),e.getState().onSelectionChangeHandlers.forEach(l=>l(a))},[n,s,t]),null}const WU=t=>!!t.onSelectionChangeHandlers;function JU({onSelectionChange:t}){const e=Ge(WU);return t||e?b.jsx(KU,{onSelectionChange:t}):null}const jS=[0,0],ZU={x:0,y:0,zoom:1},e3=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig"],ex=[...e3,"rfId"],t3=t=>({setNodes:t.setNodes,setEdges:t.setEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges}),tx={translateExtent:Ll,nodeOrigin:jS,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function n3(t){const{setNodes:e,setEdges:n,setMinZoom:s,setMaxZoom:a,setTranslateExtent:l,setNodeExtent:c,reset:d,setDefaultNodesAndEdges:h}=Ge(t3,vt),f=mt();k.useEffect(()=>(h(t.defaultNodes,t.defaultEdges),()=>{p.current=tx,d()}),[]);const p=k.useRef(tx);return k.useEffect(()=>{for(const m of ex){const y=t[m],_=p.current[m];y!==_&&(typeof t[m]>"u"||(m==="nodes"?e(y):m==="edges"?n(y):m==="minZoom"?s(y):m==="maxZoom"?a(y):m==="translateExtent"?l(y):m==="nodeExtent"?c(y):m==="ariaLabelConfig"?f.setState({ariaLabelConfig:$B(y)}):m==="fitView"?f.setState({fitViewQueued:y}):m==="fitViewOptions"?f.setState({fitViewOptions:y}):f.setState({[m]:y})))}p.current=t},ex.map(m=>t[m])),null}function nx(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function r3(t){const[e,n]=k.useState(t==="system"?null:t);return k.useEffect(()=>{if(t!=="system"){n(t);return}const s=nx(),a=()=>n(s?.matches?"dark":"light");return a(),s?.addEventListener("change",a),()=>{s?.removeEventListener("change",a)}},[t]),e!==null?e:nx()?.matches?"dark":"light"}const rx=typeof document<"u"?document:null;function ql(t=null,e={target:rx,actInsideInputWithModifier:!0}){const[n,s]=k.useState(!1),a=k.useRef(!1),l=k.useRef(new Set([])),[c,d]=k.useMemo(()=>{if(t!==null){const f=(Array.isArray(t)?t:[t]).filter(m=>typeof m=="string").map(m=>m.replace("+",`
`).replace(`

`,`
+`).split(`
`)),p=f.reduce((m,y)=>m.concat(...y),[]);return[f,p]}return[[],[]]},[t]);return k.useEffect(()=>{const h=e?.target??rx,f=e?.actInsideInputWithModifier??!0;if(t!==null){const p=_=>{if(a.current=_.ctrlKey||_.metaKey||_.shiftKey||_.altKey,(!a.current||a.current&&!f)&&cS(_))return!1;const w=ix(_.code,d);if(l.current.add(_[w]),sx(c,l.current,!1)){const A=_.composedPath?.()?.[0]||_.target,S=A?.nodeName==="BUTTON"||A?.nodeName==="A";e.preventDefault!==!1&&(a.current||!S)&&_.preventDefault(),s(!0)}},m=_=>{const x=ix(_.code,d);sx(c,l.current,!0)?(s(!1),l.current.clear()):l.current.delete(_[x]),_.key==="Meta"&&l.current.clear(),a.current=!1},y=()=>{l.current.clear(),s(!1)};return h?.addEventListener("keydown",p),h?.addEventListener("keyup",m),window.addEventListener("blur",y),window.addEventListener("contextmenu",y),()=>{h?.removeEventListener("keydown",p),h?.removeEventListener("keyup",m),window.removeEventListener("blur",y),window.removeEventListener("contextmenu",y)}}},[t,s]),n}function sx(t,e,n){return t.filter(s=>n||s.length===e.size).some(s=>s.every(a=>e.has(a)))}function ix(t,e){return e.includes(t)?"code":"key"}const s3=()=>{const t=mt();return k.useMemo(()=>({zoomIn:e=>{const{panZoom:n}=t.getState();return n?n.scaleBy(1.2,{duration:e?.duration}):Promise.resolve(!1)},zoomOut:e=>{const{panZoom:n}=t.getState();return n?n.scaleBy(1/1.2,{duration:e?.duration}):Promise.resolve(!1)},zoomTo:(e,n)=>{const{panZoom:s}=t.getState();return s?s.scaleTo(e,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>t.getState().transform[2],setViewport:async(e,n)=>{const{transform:[s,a,l],panZoom:c}=t.getState();return c?(await c.setViewport({x:e.x??s,y:e.y??a,zoom:e.zoom??l},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[e,n,s]=t.getState().transform;return{x:e,y:n,zoom:s}},setCenter:async(e,n,s)=>t.getState().setCenter(e,n,s),fitBounds:async(e,n)=>{const{width:s,height:a,minZoom:l,maxZoom:c,panZoom:d}=t.getState(),h=Qg(e,s,a,l,c,n?.padding??.1);return d?(await d.setViewport(h,{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(e,n={})=>{const{transform:s,snapGrid:a,snapToGrid:l,domNode:c}=t.getState();if(!c)return e;const{x:d,y:h}=c.getBoundingClientRect(),f={x:e.x-d,y:e.y-h},p=n.snapGrid??a,m=n.snapToGrid??l;return rc(f,s,m,p)},flowToScreenPosition:e=>{const{transform:n,domNode:s}=t.getState();if(!s)return e;const{x:a,y:l}=s.getBoundingClientRect(),c=$d(e,n);return{x:c.x+a,y:c.y+l}}}),[])};function OS(t,e){const n=[],s=new Map,a=[];for(const l of t)if(l.type==="add"){a.push(l);continue}else if(l.type==="remove"||l.type==="replace")s.set(l.id,[l]);else{const c=s.get(l.id);c?c.push(l):s.set(l.id,[l])}for(const l of e){const c=s.get(l.id);if(!c){n.push(l);continue}if(c[0].type==="remove")continue;if(c[0].type==="replace"){n.push({...c[0].item});continue}const d={...l};for(const h of c)i3(h,d);n.push(d)}return a.length&&a.forEach(l=>{l.index!==void 0?n.splice(l.index,0,{...l.item}):n.push({...l.item})}),n}function i3(t,e){switch(t.type){case"select":{e.selected=t.selected;break}case"position":{typeof t.position<"u"&&(e.position=t.position),typeof t.dragging<"u"&&(e.dragging=t.dragging);break}case"dimensions":{typeof t.dimensions<"u"&&(e.measured??={},e.measured.width=t.dimensions.width,e.measured.height=t.dimensions.height,t.setAttributes&&((t.setAttributes===!0||t.setAttributes==="width")&&(e.width=t.dimensions.width),(t.setAttributes===!0||t.setAttributes==="height")&&(e.height=t.dimensions.height))),typeof t.resizing=="boolean"&&(e.resizing=t.resizing);break}}}function IS(t,e){return OS(t,e)}function kS(t,e){return OS(t,e)}function ui(t,e){return{id:t,type:"select",selected:e}}function Da(t,e=new Set,n=!1){const s=[];for(const[a,l]of t){const c=e.has(a);!(l.selected===void 0&&!c)&&l.selected!==c&&(n&&(l.selected=c),s.push(ui(l.id,c)))}return s}function ax({items:t=[],lookup:e}){const n=[],s=new Map(t.map(a=>[a.id,a]));for(const[a,l]of t.entries()){const c=e.get(l.id),d=c?.internals?.userNode??c;d!==void 0&&d!==l&&n.push({id:l.id,item:l,type:"replace"}),d===void 0&&n.push({item:l,type:"add",index:a})}for(const[a]of e)s.get(a)===void 0&&n.push({id:a,type:"remove"});return n}function ox(t){return{id:t.id,type:"remove"}}const lx=t=>RB(t),a3=t=>tS(t);function MS(t){return k.forwardRef(t)}const o3=typeof window<"u"?k.useLayoutEffect:k.useEffect;function cx(t){const[e,n]=k.useState(BigInt(0)),[s]=k.useState(()=>l3(()=>n(a=>a+BigInt(1))));return o3(()=>{const a=s.get();a.length&&(t(a),s.reset())},[e]),s}function l3(t){let e=[];return{get:()=>e,reset:()=>{e=[]},push:n=>{e.push(n),t()}}}const DS=k.createContext(null);function c3({children:t}){const e=mt(),n=k.useCallback(d=>{const{nodes:h=[],setNodes:f,hasDefaultNodes:p,onNodesChange:m,nodeLookup:y,fitViewQueued:_}=e.getState();let x=h;for(const A of d)x=typeof A=="function"?A(x):A;const w=ax({items:x,lookup:y});p&&f(x),w.length>0?m?.(w):_&&window.requestAnimationFrame(()=>{const{fitViewQueued:A,nodes:S,setNodes:T}=e.getState();A&&T(S)})},[]),s=cx(n),a=k.useCallback(d=>{const{edges:h=[],setEdges:f,hasDefaultEdges:p,onEdgesChange:m,edgeLookup:y}=e.getState();let _=h;for(const x of d)_=typeof x=="function"?x(_):x;p?f(_):m&&m(ax({items:_,lookup:y}))},[]),l=cx(a),c=k.useMemo(()=>({nodeQueue:s,edgeQueue:l}),[]);return b.jsx(DS.Provider,{value:c,children:t})}function u3(){const t=k.useContext(DS);if(!t)throw new Error("useBatchContext must be used within a BatchProvider");return t}const d3=t=>!!t.panZoom;function Wr(){const t=s3(),e=mt(),n=u3(),s=Ge(d3),a=k.useMemo(()=>{const l=m=>e.getState().nodeLookup.get(m),c=m=>{n.nodeQueue.push(m)},d=m=>{n.edgeQueue.push(m)},h=m=>{const{nodeLookup:y,nodeOrigin:_}=e.getState(),x=lx(m)?m:y.get(m.id),w=x.parentId?oS(x.position,x.measured,x.parentId,y,_):x.position,A={...x,position:w,width:x.measured?.width??x.width,height:x.measured?.height??x.height};return Fa(A)},f=(m,y,_={replace:!1})=>{c(x=>x.map(w=>{if(w.id===m){const A=typeof y=="function"?y(w):y;return _.replace&&lx(A)?A:{...w,...A}}return w}))},p=(m,y,_={replace:!1})=>{d(x=>x.map(w=>{if(w.id===m){const A=typeof y=="function"?y(w):y;return _.replace&&a3(A)?A:{...w,...A}}return w}))};return{getNodes:()=>e.getState().nodes.map(m=>({...m})),getNode:m=>l(m)?.internals.userNode,getInternalNode:l,getEdges:()=>{const{edges:m=[]}=e.getState();return m.map(y=>({...y}))},getEdge:m=>e.getState().edgeLookup.get(m),setNodes:c,setEdges:d,addNodes:m=>{const y=Array.isArray(m)?m:[m];n.nodeQueue.push(_=>[..._,...y])},addEdges:m=>{const y=Array.isArray(m)?m:[m];n.edgeQueue.push(_=>[..._,...y])},toObject:()=>{const{nodes:m=[],edges:y=[],transform:_}=e.getState(),[x,w,A]=_;return{nodes:m.map(S=>({...S})),edges:y.map(S=>({...S})),viewport:{x,y:w,zoom:A}}},deleteElements:async({nodes:m=[],edges:y=[]})=>{const{nodes:_,edges:x,onNodesDelete:w,onEdgesDelete:A,triggerNodeChanges:S,triggerEdgeChanges:T,onDelete:E,onBeforeDelete:C}=e.getState(),{nodes:j,edges:O}=await MB({nodesToRemove:m,edgesToRemove:y,nodes:_,edges:x,onBeforeDelete:C}),M=O.length>0,D=j.length>0;if(M){const q=O.map(ox);A?.(O),T(q)}if(D){const q=j.map(ox);w?.(j),S(q)}return(D||M)&&E?.({nodes:j,edges:O}),{deletedNodes:j,deletedEdges:O}},getIntersectingNodes:(m,y=!0,_)=>{const x=Mw(m),w=x?m:h(m),A=_!==void 0;return w?(_||e.getState().nodes).filter(S=>{const T=e.getState().nodeLookup.get(S.id);if(T&&!x&&(S.id===m.id||!T.internals.positionAbsolute))return!1;const E=Fa(A?S:T),C=zl(E,w);return y&&C>0||C>=E.width*E.height||C>=w.width*w.height}):[]},isNodeIntersecting:(m,y,_=!0)=>{const w=Mw(m)?m:h(m);if(!w)return!1;const A=zl(w,y);return _&&A>0||A>=y.width*y.height||A>=w.width*w.height},updateNode:f,updateNodeData:(m,y,_={replace:!1})=>{f(m,x=>{const w=typeof y=="function"?y(x):y;return _.replace?{...x,data:w}:{...x,data:{...x.data,...w}}},_)},updateEdge:p,updateEdgeData:(m,y,_={replace:!1})=>{p(m,x=>{const w=typeof y=="function"?y(x):y;return _.replace?{...x,data:w}:{...x,data:{...x.data,...w}}},_)},getNodesBounds:m=>{const{nodeLookup:y,nodeOrigin:_}=e.getState();return jB(m,{nodeLookup:y,nodeOrigin:_})},getHandleConnections:({type:m,id:y,nodeId:_})=>Array.from(e.getState().connectionLookup.get(`${_}-${m}${y?`-${y}`:""}`)?.values()??[]),getNodeConnections:({type:m,handleId:y,nodeId:_})=>Array.from(e.getState().connectionLookup.get(`${_}${m?y?`-${m}-${y}`:`-${m}`:""}`)?.values()??[]),fitView:async m=>{const y=e.getState().fitViewResolver??LB();return e.setState({fitViewQueued:!0,fitViewOptions:m,fitViewResolver:y}),n.nodeQueue.push(_=>[..._]),y.promise}}},[]);return k.useMemo(()=>({...a,...t,viewportInitialized:s}),[s])}const ux=t=>t.selected,f3=typeof window<"u"?window:void 0;function h3({deleteKeyCode:t,multiSelectionKeyCode:e}){const n=mt(),{deleteElements:s}=Wr(),a=ql(t,{actInsideInputWithModifier:!1}),l=ql(e,{target:f3});k.useEffect(()=>{if(a){const{edges:c,nodes:d}=n.getState();s({nodes:d.filter(ux),edges:c.filter(ux)}),n.setState({nodesSelectionActive:!1})}},[a]),k.useEffect(()=>{n.setState({multiSelectionActive:l})},[l])}function m3(t){const e=mt();k.useEffect(()=>{const n=()=>{if(!t.current||!(t.current.checkVisibility?.()??!0))return!1;const s=Fg(t.current);(s.height===0||s.width===0)&&e.getState().onError?.("004",ir.error004()),e.setState({width:s.width||500,height:s.height||500})};if(t.current){n(),window.addEventListener("resize",n);const s=new ResizeObserver(()=>n());return s.observe(t.current),()=>{window.removeEventListener("resize",n),s&&t.current&&s.unobserve(t.current)}}},[])}const hf={position:"absolute",width:"100%",height:"100%",top:0,left:0},p3=t=>({userSelectionActive:t.userSelectionActive,lib:t.lib,connectionInProgress:t.connection.inProgress});function g3({onPaneContextMenu:t,zoomOnScroll:e=!0,zoomOnPinch:n=!0,panOnScroll:s=!1,panOnScrollSpeed:a=.5,panOnScrollMode:l=xi.Free,zoomOnDoubleClick:c=!0,panOnDrag:d=!0,defaultViewport:h,translateExtent:f,minZoom:p,maxZoom:m,zoomActivationKeyCode:y,preventScrolling:_=!0,children:x,noWheelClassName:w,noPanClassName:A,onViewportChange:S,isControlledViewport:T,paneClickDistance:E,selectionOnDrag:C}){const j=mt(),O=k.useRef(null),{userSelectionActive:M,lib:D,connectionInProgress:q}=Ge(p3,vt),G=ql(y),V=k.useRef();m3(O);const F=k.useCallback(K=>{S?.({x:K[0],y:K[1],zoom:K[2]}),T||j.setState({transform:K})},[S,T]);return k.useEffect(()=>{if(O.current){V.current=wU({domNode:O.current,minZoom:p,maxZoom:m,translateExtent:f,viewport:h,onDraggingChange:R=>j.setState({paneDragging:R}),onPanZoomStart:(R,U)=>{const{onViewportChangeStart:B,onMoveStart:L}=j.getState();L?.(R,U),B?.(U)},onPanZoom:(R,U)=>{const{onViewportChange:B,onMove:L}=j.getState();L?.(R,U),B?.(U)},onPanZoomEnd:(R,U)=>{const{onViewportChangeEnd:B,onMoveEnd:L}=j.getState();L?.(R,U),B?.(U)}});const{x:K,y:$,zoom:Q}=V.current.getViewport();return j.setState({panZoom:V.current,transform:[K,$,Q],domNode:O.current.closest(".react-flow")}),()=>{V.current?.destroy()}}},[]),k.useEffect(()=>{V.current?.update({onPaneContextMenu:t,zoomOnScroll:e,zoomOnPinch:n,panOnScroll:s,panOnScrollSpeed:a,panOnScrollMode:l,zoomOnDoubleClick:c,panOnDrag:d,zoomActivationKeyPressed:G,preventScrolling:_,noPanClassName:A,userSelectionActive:M,noWheelClassName:w,lib:D,onTransformChange:F,connectionInProgress:q,selectionOnDrag:C,paneClickDistance:E})},[t,e,n,s,a,l,c,d,G,_,A,M,w,D,F,q,C,E]),b.jsx("div",{className:"react-flow__renderer",ref:O,style:hf,children:x})}const y3=t=>({userSelectionActive:t.userSelectionActive,userSelectionRect:t.userSelectionRect});function v3(){const{userSelectionActive:t,userSelectionRect:e}=Ge(y3,vt);return t&&e?b.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:e.width,height:e.height,transform:`translate(${e.x}px, ${e.y}px)`}}):null}const pp=(t,e)=>n=>{n.target===e.current&&t?.(n)},_3=t=>({userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable,connectionInProgress:t.connection.inProgress,dragging:t.paneDragging});function b3({isSelecting:t,selectionKeyPressed:e,selectionMode:n=$l.Full,panOnDrag:s,paneClickDistance:a,selectionOnDrag:l,onSelectionStart:c,onSelectionEnd:d,onPaneClick:h,onPaneContextMenu:f,onPaneScroll:p,onPaneMouseEnter:m,onPaneMouseMove:y,onPaneMouseLeave:_,children:x}){const w=mt(),{userSelectionActive:A,elementsSelectable:S,dragging:T,connectionInProgress:E}=Ge(_3,vt),C=S&&(t||A),j=k.useRef(null),O=k.useRef(),M=k.useRef(new Set),D=k.useRef(new Set),q=k.useRef(!1),G=B=>{if(q.current||E){q.current=!1;return}h?.(B),w.getState().resetSelectedElements(),w.setState({nodesSelectionActive:!1})},V=B=>{if(Array.isArray(s)&&s?.includes(2)){B.preventDefault();return}f?.(B)},F=p?B=>p(B):void 0,K=B=>{q.current&&(B.stopPropagation(),q.current=!1)},$=B=>{const{domNode:L}=w.getState();if(O.current=L?.getBoundingClientRect(),!O.current)return;const H=B.target===j.current;if(!H&&!!B.target.closest(".nokey")||!t||!(l&&H||e)||B.button!==0||!B.isPrimary)return;B.target?.setPointerCapture?.(B.pointerId),q.current=!1;const{x:Y,y:J}=sr(B.nativeEvent,O.current);w.setState({userSelectionRect:{width:0,height:0,startX:Y,startY:J,x:Y,y:J}}),H||(B.stopPropagation(),B.preventDefault())},Q=B=>{const{userSelectionRect:L,transform:H,nodeLookup:I,edgeLookup:P,connectionLookup:Y,triggerNodeChanges:J,triggerEdgeChanges:Z,defaultEdgeOptions:ae,resetSelectedElements:ce}=w.getState();if(!O.current||!L)return;const{x:he,y:ye}=sr(B.nativeEvent,O.current),{startX:pe,startY:_e}=L;if(!q.current){const fe=e?0:a;if(Math.hypot(he-pe,ye-_e)<=fe)return;ce(),c?.(B)}q.current=!0;const be={startX:pe,startY:_e,x:he<pe?he:pe,y:ye<_e?ye:_e,width:Math.abs(he-pe),height:Math.abs(ye-_e)},we=M.current,ue=D.current;M.current=new Set(qg(I,be,H,n===$l.Partial,!0).map(fe=>fe.id)),D.current=new Set;const te=ae?.selectable??!0;for(const fe of M.current){const Te=Y.get(fe);if(Te)for(const{edgeId:De}of Te.values()){const Xe=P.get(De);Xe&&(Xe.selectable??te)&&D.current.add(De)}}if(!Dw(we,M.current)){const fe=Da(I,M.current,!0);J(fe)}if(!Dw(ue,D.current)){const fe=Da(P,D.current);Z(fe)}w.setState({userSelectionRect:be,userSelectionActive:!0,nodesSelectionActive:!1})},R=B=>{B.button===0&&(B.target?.releasePointerCapture?.(B.pointerId),!A&&B.target===j.current&&w.getState().userSelectionRect&&G?.(B),w.setState({userSelectionActive:!1,userSelectionRect:null}),q.current&&(d?.(B),w.setState({nodesSelectionActive:M.current.size>0})))},U=s===!0||Array.isArray(s)&&s.includes(0);return b.jsxs("div",{className:Ot(["react-flow__pane",{draggable:U,dragging:T,selection:t}]),onClick:C?void 0:pp(G,j),onContextMenu:pp(V,j),onWheel:pp(F,j),onPointerEnter:C?void 0:m,onPointerMove:C?Q:y,onPointerUp:C?R:void 0,onPointerDownCapture:C?$:void 0,onClickCapture:C?K:void 0,onPointerLeave:_,ref:j,style:hf,children:[x,b.jsx(v3,{})]})}function ng({id:t,store:e,unselect:n=!1,nodeRef:s}){const{addSelectedNodes:a,unselectNodesAndEdges:l,multiSelectionActive:c,nodeLookup:d,onError:h}=e.getState(),f=d.get(t);if(!f){h?.("012",ir.error012(t));return}e.setState({nodesSelectionActive:!1}),f.selected?(n||f.selected&&c)&&(l({nodes:[f],edges:[]}),requestAnimationFrame(()=>s?.current?.blur())):a([t])}function BS({nodeRef:t,disabled:e=!1,noDragClassName:n,handleSelector:s,nodeId:a,isSelectable:l,nodeClickDistance:c}){const d=mt(),[h,f]=k.useState(!1),p=k.useRef();return k.useEffect(()=>{p.current=oU({getStoreItems:()=>d.getState(),onNodeMouseDown:m=>{ng({id:m,store:d,nodeRef:t})},onDragStart:()=>{f(!0)},onDragStop:()=>{f(!1)}})},[]),k.useEffect(()=>{if(e)p.current?.destroy();else if(t.current)return p.current?.update({noDragClassName:n,handleSelector:s,domNode:t.current,isSelectable:l,nodeId:a,nodeClickDistance:c}),()=>{p.current?.destroy()}},[n,s,e,l,t,a]),h}const w3=t=>e=>e.selected&&(e.draggable||t&&typeof e.draggable>"u");function US(){const t=mt();return k.useCallback(n=>{const{nodeExtent:s,snapToGrid:a,snapGrid:l,nodesDraggable:c,onError:d,updateNodePositions:h,nodeLookup:f,nodeOrigin:p}=t.getState(),m=new Map,y=w3(c),_=a?l[0]:5,x=a?l[1]:5,w=n.direction.x*_*n.factor,A=n.direction.y*x*n.factor;for(const[,S]of f){if(!y(S))continue;let T={x:S.internals.positionAbsolute.x+w,y:S.internals.positionAbsolute.y+A};a&&(T=nc(T,l));const{position:E,positionAbsolute:C}=nS({nodeId:S.id,nextPosition:T,nodeLookup:f,nodeExtent:s,nodeOrigin:p,onError:d});S.position=E,S.internals.positionAbsolute=C,m.set(S.id,S)}h(m)},[])}const Wg=k.createContext(null),x3=Wg.Provider;Wg.Consumer;const Jg=()=>k.useContext(Wg),A3=t=>({connectOnClick:t.connectOnClick,noPanClassName:t.noPanClassName,rfId:t.rfId}),E3=(t,e,n)=>s=>{const{connectionClickStartHandle:a,connectionMode:l,connection:c}=s,{fromHandle:d,toHandle:h,isValid:f}=c,p=h?.nodeId===t&&h?.id===e&&h?.type===n;return{connectingFrom:d?.nodeId===t&&d?.id===e&&d?.type===n,connectingTo:p,clickConnecting:a?.nodeId===t&&a?.id===e&&a?.type===n,isPossibleEndHandle:l===qa.Strict?d?.type!==n:t!==d?.nodeId||e!==d?.id,connectionInProcess:!!d,clickConnectionInProcess:!!a,valid:p&&f}};function S3({type:t="source",position:e=xe.Top,isValidConnection:n,isConnectable:s=!0,isConnectableStart:a=!0,isConnectableEnd:l=!0,id:c,onConnect:d,children:h,className:f,onMouseDown:p,onTouchStart:m,...y},_){const x=c||null,w=t==="target",A=mt(),S=Jg(),{connectOnClick:T,noPanClassName:E,rfId:C}=Ge(A3,vt),{connectingFrom:j,connectingTo:O,clickConnecting:M,isPossibleEndHandle:D,connectionInProcess:q,clickConnectionInProcess:G,valid:V}=Ge(E3(S,x,t),vt);S||A.getState().onError?.("010",ir.error010());const F=Q=>{const{defaultEdgeOptions:R,onConnect:U,hasDefaultEdges:B}=A.getState(),L={...R,...Q};if(B){const{edges:H,setEdges:I}=A.getState();I(hS(L,H))}U?.(L),d?.(L)},K=Q=>{if(!S)return;const R=uS(Q.nativeEvent);if(a&&(R&&Q.button===0||!R)){const U=A.getState();tg.onPointerDown(Q.nativeEvent,{handleDomNode:Q.currentTarget,autoPanOnConnect:U.autoPanOnConnect,connectionMode:U.connectionMode,connectionRadius:U.connectionRadius,domNode:U.domNode,nodeLookup:U.nodeLookup,lib:U.lib,isTarget:w,handleId:x,nodeId:S,flowId:U.rfId,panBy:U.panBy,cancelConnection:U.cancelConnection,onConnectStart:U.onConnectStart,onConnectEnd:U.onConnectEnd,updateConnection:U.updateConnection,onConnect:F,isValidConnection:n||U.isValidConnection,getTransform:()=>A.getState().transform,getFromHandle:()=>A.getState().connection.fromHandle,autoPanSpeed:U.autoPanSpeed,dragThreshold:U.connectionDragThreshold})}R?p?.(Q):m?.(Q)},$=Q=>{const{onClickConnectStart:R,onClickConnectEnd:U,connectionClickStartHandle:B,connectionMode:L,isValidConnection:H,lib:I,rfId:P,nodeLookup:Y,connection:J}=A.getState();if(!S||!B&&!a)return;if(!B){R?.(Q.nativeEvent,{nodeId:S,handleId:x,handleType:t}),A.setState({connectionClickStartHandle:{nodeId:S,type:t,id:x}});return}const Z=lS(Q.target),ae=n||H,{connection:ce,isValid:he}=tg.isValid(Q.nativeEvent,{handle:{nodeId:S,id:x,type:t},connectionMode:L,fromNodeId:B.nodeId,fromHandleId:B.id||null,fromType:B.type,isValidConnection:ae,flowId:P,doc:Z,lib:I,nodeLookup:Y});he&&ce&&F(ce);const ye=structuredClone(J);delete ye.inProgress,ye.toPosition=ye.toHandle?ye.toHandle.position:null,U?.(Q,ye),A.setState({connectionClickStartHandle:null})};return b.jsx("div",{"data-handleid":x,"data-nodeid":S,"data-handlepos":e,"data-id":`${C}-${S}-${x}-${t}`,className:Ot(["react-flow__handle",`react-flow__handle-${e}`,"nodrag",E,f,{source:!w,target:w,connectable:s,connectablestart:a,connectableend:l,clickconnecting:M,connectingfrom:j,connectingto:O,valid:V,connectionindicator:s&&(!q||D)&&(q||G?l:a)}]),onMouseDown:K,onTouchStart:K,onClick:T?$:void 0,ref:_,...y,children:h})}const $t=k.memo(MS(S3));function C3({data:t,isConnectable:e,sourcePosition:n=xe.Bottom}){return b.jsxs(b.Fragment,{children:[t?.label,b.jsx($t,{type:"source",position:n,isConnectable:e})]})}function T3({data:t,isConnectable:e,targetPosition:n=xe.Top,sourcePosition:s=xe.Bottom}){return b.jsxs(b.Fragment,{children:[b.jsx($t,{type:"target",position:n,isConnectable:e}),t?.label,b.jsx($t,{type:"source",position:s,isConnectable:e})]})}function N3(){return null}function R3({data:t,isConnectable:e,targetPosition:n=xe.Top}){return b.jsxs(b.Fragment,{children:[b.jsx($t,{type:"target",position:n,isConnectable:e}),t?.label]})}const zd={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},dx={input:C3,default:T3,output:R3,group:N3};function j3(t){return t.internals.handleBounds===void 0?{width:t.width??t.initialWidth??t.style?.width,height:t.height??t.initialHeight??t.style?.height}:{width:t.width??t.style?.width,height:t.height??t.style?.height}}const O3=t=>{const{width:e,height:n,x:s,y:a}=tc(t.nodeLookup,{filter:l=>!!l.selected});return{width:rr(e)?e:null,height:rr(n)?n:null,userSelectionActive:t.userSelectionActive,transformString:`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]}) translate(${s}px,${a}px)`}};function I3({onSelectionContextMenu:t,noPanClassName:e,disableKeyboardA11y:n}){const s=mt(),{width:a,height:l,transformString:c,userSelectionActive:d}=Ge(O3,vt),h=US(),f=k.useRef(null);if(k.useEffect(()=>{n||f.current?.focus({preventScroll:!0})},[n]),BS({nodeRef:f}),d||!a||!l)return null;const p=t?y=>{const _=s.getState().nodes.filter(x=>x.selected);t(y,_)}:void 0,m=y=>{Object.prototype.hasOwnProperty.call(zd,y.key)&&(y.preventDefault(),h({direction:zd[y.key],factor:y.shiftKey?4:1}))};return b.jsx("div",{className:Ot(["react-flow__nodesselection","react-flow__container",e]),style:{transform:c},children:b.jsx("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:p,tabIndex:n?void 0:-1,onKeyDown:n?void 0:m,style:{width:a,height:l}})})}const fx=typeof window<"u"?window:void 0,k3=t=>({nodesSelectionActive:t.nodesSelectionActive,userSelectionActive:t.userSelectionActive});function LS({children:t,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:s,onPaneMouseLeave:a,onPaneContextMenu:l,onPaneScroll:c,paneClickDistance:d,deleteKeyCode:h,selectionKeyCode:f,selectionOnDrag:p,selectionMode:m,onSelectionStart:y,onSelectionEnd:_,multiSelectionKeyCode:x,panActivationKeyCode:w,zoomActivationKeyCode:A,elementsSelectable:S,zoomOnScroll:T,zoomOnPinch:E,panOnScroll:C,panOnScrollSpeed:j,panOnScrollMode:O,zoomOnDoubleClick:M,panOnDrag:D,defaultViewport:q,translateExtent:G,minZoom:V,maxZoom:F,preventScrolling:K,onSelectionContextMenu:$,noWheelClassName:Q,noPanClassName:R,disableKeyboardA11y:U,onViewportChange:B,isControlledViewport:L}){const{nodesSelectionActive:H,userSelectionActive:I}=Ge(k3),P=ql(f,{target:fx}),Y=ql(w,{target:fx}),J=Y||D,Z=Y||C,ae=p&&J!==!0,ce=P||I||ae;return h3({deleteKeyCode:h,multiSelectionKeyCode:x}),b.jsx(g3,{onPaneContextMenu:l,elementsSelectable:S,zoomOnScroll:T,zoomOnPinch:E,panOnScroll:Z,panOnScrollSpeed:j,panOnScrollMode:O,zoomOnDoubleClick:M,panOnDrag:!P&&J,defaultViewport:q,translateExtent:G,minZoom:V,maxZoom:F,zoomActivationKeyCode:A,preventScrolling:K,noWheelClassName:Q,noPanClassName:R,onViewportChange:B,isControlledViewport:L,paneClickDistance:d,selectionOnDrag:ae,children:b.jsxs(b3,{onSelectionStart:y,onSelectionEnd:_,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:s,onPaneMouseLeave:a,onPaneContextMenu:l,onPaneScroll:c,panOnDrag:J,isSelecting:!!ce,selectionMode:m,selectionKeyPressed:P,paneClickDistance:d,selectionOnDrag:ae,children:[t,H&&b.jsx(I3,{onSelectionContextMenu:$,noPanClassName:R,disableKeyboardA11y:U})]})})}LS.displayName="FlowRenderer";const M3=k.memo(LS),D3=t=>e=>t?qg(e.nodeLookup,{x:0,y:0,width:e.width,height:e.height},e.transform,!0).map(n=>n.id):Array.from(e.nodeLookup.keys());function B3(t){return Ge(k.useCallback(D3(t),[t]),vt)}const U3=t=>t.updateNodeInternals;function L3(){const t=Ge(U3),[e]=k.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const s=new Map;n.forEach(a=>{const l=a.target.getAttribute("data-id");s.set(l,{id:l,nodeElement:a.target,force:!0})}),t(s)}));return k.useEffect(()=>()=>{e?.disconnect()},[e]),e}function $3({node:t,nodeType:e,hasDimensions:n,resizeObserver:s}){const a=mt(),l=k.useRef(null),c=k.useRef(null),d=k.useRef(t.sourcePosition),h=k.useRef(t.targetPosition),f=k.useRef(e),p=n&&!!t.internals.handleBounds;return k.useEffect(()=>{l.current&&!t.hidden&&(!p||c.current!==l.current)&&(c.current&&s?.unobserve(c.current),s?.observe(l.current),c.current=l.current)},[p,t.hidden]),k.useEffect(()=>()=>{c.current&&(s?.unobserve(c.current),c.current=null)},[]),k.useEffect(()=>{if(l.current){const m=f.current!==e,y=d.current!==t.sourcePosition,_=h.current!==t.targetPosition;(m||y||_)&&(f.current=e,d.current=t.sourcePosition,h.current=t.targetPosition,a.getState().updateNodeInternals(new Map([[t.id,{id:t.id,nodeElement:l.current,force:!0}]])))}},[t.id,e,t.sourcePosition,t.targetPosition]),l}function z3({id:t,onClick:e,onMouseEnter:n,onMouseMove:s,onMouseLeave:a,onContextMenu:l,onDoubleClick:c,nodesDraggable:d,elementsSelectable:h,nodesConnectable:f,nodesFocusable:p,resizeObserver:m,noDragClassName:y,noPanClassName:_,disableKeyboardA11y:x,rfId:w,nodeTypes:A,nodeClickDistance:S,onError:T}){const{node:E,internals:C,isParent:j}=Ge(he=>{const ye=he.nodeLookup.get(t),pe=he.parentLookup.has(t);return{node:ye,internals:ye.internals,isParent:pe}},vt);let O=E.type||"default",M=A?.[O]||dx[O];M===void 0&&(T?.("003",ir.error003(O)),O="default",M=A?.default||dx.default);const D=!!(E.draggable||d&&typeof E.draggable>"u"),q=!!(E.selectable||h&&typeof E.selectable>"u"),G=!!(E.connectable||f&&typeof E.connectable>"u"),V=!!(E.focusable||p&&typeof E.focusable>"u"),F=mt(),K=aS(E),$=$3({node:E,nodeType:O,hasDimensions:K,resizeObserver:m}),Q=BS({nodeRef:$,disabled:E.hidden||!D,noDragClassName:y,handleSelector:E.dragHandle,nodeId:t,isSelectable:q,nodeClickDistance:S}),R=US();if(E.hidden)return null;const U=Zr(E),B=j3(E),L=q||D||e||n||s||a,H=n?he=>n(he,{...C.userNode}):void 0,I=s?he=>s(he,{...C.userNode}):void 0,P=a?he=>a(he,{...C.userNode}):void 0,Y=l?he=>l(he,{...C.userNode}):void 0,J=c?he=>c(he,{...C.userNode}):void 0,Z=he=>{const{selectNodesOnDrag:ye,nodeDragThreshold:pe}=F.getState();q&&(!ye||!D||pe>0)&&ng({id:t,store:F,nodeRef:$}),e&&e(he,{...C.userNode})},ae=he=>{if(!(cS(he.nativeEvent)||x)){if(WE.includes(he.key)&&q){const ye=he.key==="Escape";ng({id:t,store:F,unselect:ye,nodeRef:$})}else if(D&&E.selected&&Object.prototype.hasOwnProperty.call(zd,he.key)){he.preventDefault();const{ariaLabelConfig:ye}=F.getState();F.setState({ariaLiveMessage:ye["node.a11yDescription.ariaLiveMessage"]({direction:he.key.replace("Arrow","").toLowerCase(),x:~~C.positionAbsolute.x,y:~~C.positionAbsolute.y})}),R({direction:zd[he.key],factor:he.shiftKey?4:1})}}},ce=()=>{if(x||!$.current?.matches(":focus-visible"))return;const{transform:he,width:ye,height:pe,autoPanOnNodeFocus:_e,setCenter:be}=F.getState();if(!_e)return;qg(new Map([[t,E]]),{x:0,y:0,width:ye,height:pe},he,!0).length>0||be(E.position.x+U.width/2,E.position.y+U.height/2,{zoom:he[2]})};return b.jsx("div",{className:Ot(["react-flow__node",`react-flow__node-${O}`,{[_]:D},E.className,{selected:E.selected,selectable:q,parent:j,draggable:D,dragging:Q}]),ref:$,style:{zIndex:C.z,transform:`translate(${C.positionAbsolute.x}px,${C.positionAbsolute.y}px)`,pointerEvents:L?"all":"none",visibility:K?"visible":"hidden",...E.style,...B},"data-id":t,"data-testid":`rf__node-${t}`,onMouseEnter:H,onMouseMove:I,onMouseLeave:P,onContextMenu:Y,onClick:Z,onDoubleClick:J,onKeyDown:V?ae:void 0,tabIndex:V?0:void 0,onFocus:V?ce:void 0,role:E.ariaRole??(V?"group":void 0),"aria-roledescription":"node","aria-describedby":x?void 0:`${NS}-${w}`,"aria-label":E.ariaLabel,...E.domAttributes,children:b.jsx(x3,{value:t,children:b.jsx(M,{id:t,data:E.data,type:O,positionAbsoluteX:C.positionAbsolute.x,positionAbsoluteY:C.positionAbsolute.y,selected:E.selected??!1,selectable:q,draggable:D,deletable:E.deletable??!0,isConnectable:G,sourcePosition:E.sourcePosition,targetPosition:E.targetPosition,dragging:Q,dragHandle:E.dragHandle,zIndex:C.z,parentId:E.parentId,...U})})})}var P3=k.memo(z3);const H3=t=>({nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,nodesFocusable:t.nodesFocusable,elementsSelectable:t.elementsSelectable,onError:t.onError});function $S(t){const{nodesDraggable:e,nodesConnectable:n,nodesFocusable:s,elementsSelectable:a,onError:l}=Ge(H3,vt),c=B3(t.onlyRenderVisibleElements),d=L3();return b.jsx("div",{className:"react-flow__nodes",style:hf,children:c.map(h=>b.jsx(P3,{id:h,nodeTypes:t.nodeTypes,nodeExtent:t.nodeExtent,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,rfId:t.rfId,disableKeyboardA11y:t.disableKeyboardA11y,resizeObserver:d,nodesDraggable:e,nodesConnectable:n,nodesFocusable:s,elementsSelectable:a,nodeClickDistance:t.nodeClickDistance,onError:l},h))})}$S.displayName="NodeRenderer";const q3=k.memo($S);function Q3(t){return Ge(k.useCallback(n=>{if(!t)return n.edges.map(a=>a.id);const s=[];if(n.width&&n.height)for(const a of n.edges){const l=n.nodeLookup.get(a.source),c=n.nodeLookup.get(a.target);l&&c&&HB({sourceNode:l,targetNode:c,width:n.width,height:n.height,transform:n.transform})&&s.push(a.id)}return s},[t]),vt)}const F3=({color:t="none",strokeWidth:e=1})=>{const n={strokeWidth:e,...t&&{stroke:t}};return b.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},V3=({color:t="none",strokeWidth:e=1})=>{const n={strokeWidth:e,...t&&{stroke:t,fill:t}};return b.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},hx={[Ud.Arrow]:F3,[Ud.ArrowClosed]:V3};function G3(t){const e=mt();return k.useMemo(()=>Object.prototype.hasOwnProperty.call(hx,t)?hx[t]:(e.getState().onError?.("009",ir.error009(t)),null),[t])}const Y3=({id:t,type:e,color:n,width:s=12.5,height:a=12.5,markerUnits:l="strokeWidth",strokeWidth:c,orient:d="auto-start-reverse"})=>{const h=G3(e);return h?b.jsx("marker",{className:"react-flow__arrowhead",id:t,markerWidth:`${s}`,markerHeight:`${a}`,viewBox:"-10 -10 20 20",markerUnits:l,orient:d,refX:"0",refY:"0",children:b.jsx(h,{color:n,strokeWidth:c})}):null},zS=({defaultColor:t,rfId:e})=>{const n=Ge(l=>l.edges),s=Ge(l=>l.defaultEdgeOptions),a=k.useMemo(()=>XB(n,{id:e,defaultColor:t,defaultMarkerStart:s?.markerStart,defaultMarkerEnd:s?.markerEnd}),[n,s,e,t]);return a.length?b.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:b.jsx("defs",{children:a.map(l=>b.jsx(Y3,{id:l.id,type:l.type,color:l.color,width:l.width,height:l.height,markerUnits:l.markerUnits,strokeWidth:l.strokeWidth,orient:l.orient},l.id))})}):null};zS.displayName="MarkerDefinitions";var X3=k.memo(zS);function PS({x:t,y:e,label:n,labelStyle:s,labelShowBg:a=!0,labelBgStyle:l,labelBgPadding:c=[2,4],labelBgBorderRadius:d=2,children:h,className:f,...p}){const[m,y]=k.useState({x:1,y:0,width:0,height:0}),_=Ot(["react-flow__edge-textwrapper",f]),x=k.useRef(null);return k.useEffect(()=>{if(x.current){const w=x.current.getBBox();y({x:w.x,y:w.y,width:w.width,height:w.height})}},[n]),n?b.jsxs("g",{transform:`translate(${t-m.width/2} ${e-m.height/2})`,className:_,visibility:m.width?"visible":"hidden",...p,children:[a&&b.jsx("rect",{width:m.width+2*c[0],x:-c[0],y:-c[1],height:m.height+2*c[1],className:"react-flow__edge-textbg",style:l,rx:d,ry:d}),b.jsx("text",{className:"react-flow__edge-text",y:m.height/2,dy:"0.3em",ref:x,style:s,children:n}),h]}):null}PS.displayName="EdgeText";const K3=k.memo(PS);function mf({path:t,labelX:e,labelY:n,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:h,interactionWidth:f=20,...p}){return b.jsxs(b.Fragment,{children:[b.jsx("path",{...p,d:t,fill:"none",className:Ot(["react-flow__edge-path",p.className])}),f?b.jsx("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:f,className:"react-flow__edge-interaction"}):null,s&&rr(e)&&rr(n)?b.jsx(K3,{x:e,y:n,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:h}):null]})}function mx({pos:t,x1:e,y1:n,x2:s,y2:a}){return t===xe.Left||t===xe.Right?[.5*(e+s),n]:[e,.5*(n+a)]}function HS({sourceX:t,sourceY:e,sourcePosition:n=xe.Bottom,targetX:s,targetY:a,targetPosition:l=xe.Top}){const[c,d]=mx({pos:n,x1:t,y1:e,x2:s,y2:a}),[h,f]=mx({pos:l,x1:s,y1:a,x2:t,y2:e}),[p,m,y,_]=dS({sourceX:t,sourceY:e,targetX:s,targetY:a,sourceControlX:c,sourceControlY:d,targetControlX:h,targetControlY:f});return[`M${t},${e} C${c},${d} ${h},${f} ${s},${a}`,p,m,y,_]}function qS(t){return k.memo(({id:e,sourceX:n,sourceY:s,targetX:a,targetY:l,sourcePosition:c,targetPosition:d,label:h,labelStyle:f,labelShowBg:p,labelBgStyle:m,labelBgPadding:y,labelBgBorderRadius:_,style:x,markerEnd:w,markerStart:A,interactionWidth:S})=>{const[T,E,C]=HS({sourceX:n,sourceY:s,sourcePosition:c,targetX:a,targetY:l,targetPosition:d}),j=t.isInternal?void 0:e;return b.jsx(mf,{id:j,path:T,labelX:E,labelY:C,label:h,labelStyle:f,labelShowBg:p,labelBgStyle:m,labelBgPadding:y,labelBgBorderRadius:_,style:x,markerEnd:w,markerStart:A,interactionWidth:S})})}const W3=qS({isInternal:!1}),QS=qS({isInternal:!0});W3.displayName="SimpleBezierEdge";QS.displayName="SimpleBezierEdgeInternal";function FS(t){return k.memo(({id:e,sourceX:n,sourceY:s,targetX:a,targetY:l,label:c,labelStyle:d,labelShowBg:h,labelBgStyle:f,labelBgPadding:p,labelBgBorderRadius:m,style:y,sourcePosition:_=xe.Bottom,targetPosition:x=xe.Top,markerEnd:w,markerStart:A,pathOptions:S,interactionWidth:T})=>{const[E,C,j]=Jp({sourceX:n,sourceY:s,sourcePosition:_,targetX:a,targetY:l,targetPosition:x,borderRadius:S?.borderRadius,offset:S?.offset,stepPosition:S?.stepPosition}),O=t.isInternal?void 0:e;return b.jsx(mf,{id:O,path:E,labelX:C,labelY:j,label:c,labelStyle:d,labelShowBg:h,labelBgStyle:f,labelBgPadding:p,labelBgBorderRadius:m,style:y,markerEnd:w,markerStart:A,interactionWidth:T})})}const VS=FS({isInternal:!1}),GS=FS({isInternal:!0});VS.displayName="SmoothStepEdge";GS.displayName="SmoothStepEdgeInternal";function YS(t){return k.memo(({id:e,...n})=>{const s=t.isInternal?void 0:e;return b.jsx(VS,{...n,id:s,pathOptions:k.useMemo(()=>({borderRadius:0,offset:n.pathOptions?.offset}),[n.pathOptions?.offset])})})}const J3=YS({isInternal:!1}),XS=YS({isInternal:!0});J3.displayName="StepEdge";XS.displayName="StepEdgeInternal";function KS(t){return k.memo(({id:e,sourceX:n,sourceY:s,targetX:a,targetY:l,label:c,labelStyle:d,labelShowBg:h,labelBgStyle:f,labelBgPadding:p,labelBgBorderRadius:m,style:y,markerEnd:_,markerStart:x,interactionWidth:w})=>{const[A,S,T]=mS({sourceX:n,sourceY:s,targetX:a,targetY:l}),E=t.isInternal?void 0:e;return b.jsx(mf,{id:E,path:A,labelX:S,labelY:T,label:c,labelStyle:d,labelShowBg:h,labelBgStyle:f,labelBgPadding:p,labelBgBorderRadius:m,style:y,markerEnd:_,markerStart:x,interactionWidth:w})})}const Z3=KS({isInternal:!1}),WS=KS({isInternal:!0});Z3.displayName="StraightEdge";WS.displayName="StraightEdgeInternal";function JS(t){return k.memo(({id:e,sourceX:n,sourceY:s,targetX:a,targetY:l,sourcePosition:c=xe.Bottom,targetPosition:d=xe.Top,label:h,labelStyle:f,labelShowBg:p,labelBgStyle:m,labelBgPadding:y,labelBgBorderRadius:_,style:x,markerEnd:w,markerStart:A,pathOptions:S,interactionWidth:T})=>{const[E,C,j]=Vg({sourceX:n,sourceY:s,sourcePosition:c,targetX:a,targetY:l,targetPosition:d,curvature:S?.curvature}),O=t.isInternal?void 0:e;return b.jsx(mf,{id:O,path:E,labelX:C,labelY:j,label:h,labelStyle:f,labelShowBg:p,labelBgStyle:m,labelBgPadding:y,labelBgBorderRadius:_,style:x,markerEnd:w,markerStart:A,interactionWidth:T})})}const eL=JS({isInternal:!1}),ZS=JS({isInternal:!0});eL.displayName="BezierEdge";ZS.displayName="BezierEdgeInternal";const px={default:ZS,straight:WS,step:XS,smoothstep:GS,simplebezier:QS},gx={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},tL=(t,e,n)=>n===xe.Left?t-e:n===xe.Right?t+e:t,nL=(t,e,n)=>n===xe.Top?t-e:n===xe.Bottom?t+e:t,yx="react-flow__edgeupdater";function vx({position:t,centerX:e,centerY:n,radius:s=10,onMouseDown:a,onMouseEnter:l,onMouseOut:c,type:d}){return b.jsx("circle",{onMouseDown:a,onMouseEnter:l,onMouseOut:c,className:Ot([yx,`${yx}-${d}`]),cx:tL(e,s,t),cy:nL(n,s,t),r:s,stroke:"transparent",fill:"transparent"})}function rL({isReconnectable:t,reconnectRadius:e,edge:n,sourceX:s,sourceY:a,targetX:l,targetY:c,sourcePosition:d,targetPosition:h,onReconnect:f,onReconnectStart:p,onReconnectEnd:m,setReconnecting:y,setUpdateHover:_}){const x=mt(),w=(C,j)=>{if(C.button!==0)return;const{autoPanOnConnect:O,domNode:M,isValidConnection:D,connectionMode:q,connectionRadius:G,lib:V,onConnectStart:F,onConnectEnd:K,cancelConnection:$,nodeLookup:Q,rfId:R,panBy:U,updateConnection:B}=x.getState(),L=j.type==="target",H=(Y,J)=>{y(!1),m?.(Y,n,j.type,J)},I=Y=>f?.(n,Y),P=(Y,J)=>{y(!0),p?.(C,n,j.type),F?.(Y,J)};tg.onPointerDown(C.nativeEvent,{autoPanOnConnect:O,connectionMode:q,connectionRadius:G,domNode:M,handleId:j.id,nodeId:j.nodeId,nodeLookup:Q,isTarget:L,edgeUpdaterType:j.type,lib:V,flowId:R,cancelConnection:$,panBy:U,isValidConnection:D,onConnect:I,onConnectStart:P,onConnectEnd:K,onReconnectEnd:H,updateConnection:B,getTransform:()=>x.getState().transform,getFromHandle:()=>x.getState().connection.fromHandle,dragThreshold:x.getState().connectionDragThreshold,handleDomNode:C.currentTarget})},A=C=>w(C,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),S=C=>w(C,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),T=()=>_(!0),E=()=>_(!1);return b.jsxs(b.Fragment,{children:[(t===!0||t==="source")&&b.jsx(vx,{position:d,centerX:s,centerY:a,radius:e,onMouseDown:A,onMouseEnter:T,onMouseOut:E,type:"source"}),(t===!0||t==="target")&&b.jsx(vx,{position:h,centerX:l,centerY:c,radius:e,onMouseDown:S,onMouseEnter:T,onMouseOut:E,type:"target"})]})}function sL({id:t,edgesFocusable:e,edgesReconnectable:n,elementsSelectable:s,onClick:a,onDoubleClick:l,onContextMenu:c,onMouseEnter:d,onMouseMove:h,onMouseLeave:f,reconnectRadius:p,onReconnect:m,onReconnectStart:y,onReconnectEnd:_,rfId:x,edgeTypes:w,noPanClassName:A,onError:S,disableKeyboardA11y:T}){let E=Ge(be=>be.edgeLookup.get(t));const C=Ge(be=>be.defaultEdgeOptions);E=C?{...C,...E}:E;let j=E.type||"default",O=w?.[j]||px[j];O===void 0&&(S?.("011",ir.error011(j)),j="default",O=w?.default||px.default);const M=!!(E.focusable||e&&typeof E.focusable>"u"),D=typeof m<"u"&&(E.reconnectable||n&&typeof E.reconnectable>"u"),q=!!(E.selectable||s&&typeof E.selectable>"u"),G=k.useRef(null),[V,F]=k.useState(!1),[K,$]=k.useState(!1),Q=mt(),{zIndex:R,sourceX:U,sourceY:B,targetX:L,targetY:H,sourcePosition:I,targetPosition:P}=Ge(k.useCallback(be=>{const we=be.nodeLookup.get(E.source),ue=be.nodeLookup.get(E.target);if(!we||!ue)return{zIndex:E.zIndex,...gx};const te=YB({id:t,sourceNode:we,targetNode:ue,sourceHandle:E.sourceHandle||null,targetHandle:E.targetHandle||null,connectionMode:be.connectionMode,onError:S});return{zIndex:PB({selected:E.selected,zIndex:E.zIndex,sourceNode:we,targetNode:ue,elevateOnSelect:be.elevateEdgesOnSelect}),...te||gx}},[E.source,E.target,E.sourceHandle,E.targetHandle,E.selected,E.zIndex]),vt),Y=k.useMemo(()=>E.markerStart?`url('#${Zp(E.markerStart,x)}')`:void 0,[E.markerStart,x]),J=k.useMemo(()=>E.markerEnd?`url('#${Zp(E.markerEnd,x)}')`:void 0,[E.markerEnd,x]);if(E.hidden||U===null||B===null||L===null||H===null)return null;const Z=be=>{const{addSelectedEdges:we,unselectNodesAndEdges:ue,multiSelectionActive:te}=Q.getState();q&&(Q.setState({nodesSelectionActive:!1}),E.selected&&te?(ue({nodes:[],edges:[E]}),G.current?.blur()):we([t])),a&&a(be,E)},ae=l?be=>{l(be,{...E})}:void 0,ce=c?be=>{c(be,{...E})}:void 0,he=d?be=>{d(be,{...E})}:void 0,ye=h?be=>{h(be,{...E})}:void 0,pe=f?be=>{f(be,{...E})}:void 0,_e=be=>{if(!T&&WE.includes(be.key)&&q){const{unselectNodesAndEdges:we,addSelectedEdges:ue}=Q.getState();be.key==="Escape"?(G.current?.blur(),we({edges:[E]})):ue([t])}};return b.jsx("svg",{style:{zIndex:R},children:b.jsxs("g",{className:Ot(["react-flow__edge",`react-flow__edge-${j}`,E.className,A,{selected:E.selected,animated:E.animated,inactive:!q&&!a,updating:V,selectable:q}]),onClick:Z,onDoubleClick:ae,onContextMenu:ce,onMouseEnter:he,onMouseMove:ye,onMouseLeave:pe,onKeyDown:M?_e:void 0,tabIndex:M?0:void 0,role:E.ariaRole??(M?"group":"img"),"aria-roledescription":"edge","data-id":t,"data-testid":`rf__edge-${t}`,"aria-label":E.ariaLabel===null?void 0:E.ariaLabel||`Edge from ${E.source} to ${E.target}`,"aria-describedby":M?`${RS}-${x}`:void 0,ref:G,...E.domAttributes,children:[!K&&b.jsx(O,{id:t,source:E.source,target:E.target,type:E.type,selected:E.selected,animated:E.animated,selectable:q,deletable:E.deletable??!0,label:E.label,labelStyle:E.labelStyle,labelShowBg:E.labelShowBg,labelBgStyle:E.labelBgStyle,labelBgPadding:E.labelBgPadding,labelBgBorderRadius:E.labelBgBorderRadius,sourceX:U,sourceY:B,targetX:L,targetY:H,sourcePosition:I,targetPosition:P,data:E.data,style:E.style,sourceHandleId:E.sourceHandle,targetHandleId:E.targetHandle,markerStart:Y,markerEnd:J,pathOptions:"pathOptions"in E?E.pathOptions:void 0,interactionWidth:E.interactionWidth}),D&&b.jsx(rL,{edge:E,isReconnectable:D,reconnectRadius:p,onReconnect:m,onReconnectStart:y,onReconnectEnd:_,sourceX:U,sourceY:B,targetX:L,targetY:H,sourcePosition:I,targetPosition:P,setUpdateHover:F,setReconnecting:$})]})})}var iL=k.memo(sL);const aL=t=>({edgesFocusable:t.edgesFocusable,edgesReconnectable:t.edgesReconnectable,elementsSelectable:t.elementsSelectable,connectionMode:t.connectionMode,onError:t.onError});function e1({defaultMarkerColor:t,onlyRenderVisibleElements:e,rfId:n,edgeTypes:s,noPanClassName:a,onReconnect:l,onEdgeContextMenu:c,onEdgeMouseEnter:d,onEdgeMouseMove:h,onEdgeMouseLeave:f,onEdgeClick:p,reconnectRadius:m,onEdgeDoubleClick:y,onReconnectStart:_,onReconnectEnd:x,disableKeyboardA11y:w}){const{edgesFocusable:A,edgesReconnectable:S,elementsSelectable:T,onError:E}=Ge(aL,vt),C=Q3(e);return b.jsxs("div",{className:"react-flow__edges",children:[b.jsx(X3,{defaultColor:t,rfId:n}),C.map(j=>b.jsx(iL,{id:j,edgesFocusable:A,edgesReconnectable:S,elementsSelectable:T,noPanClassName:a,onReconnect:l,onContextMenu:c,onMouseEnter:d,onMouseMove:h,onMouseLeave:f,onClick:p,reconnectRadius:m,onDoubleClick:y,onReconnectStart:_,onReconnectEnd:x,rfId:n,onError:E,edgeTypes:s,disableKeyboardA11y:w},j))]})}e1.displayName="EdgeRenderer";const oL=k.memo(e1),lL=t=>`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`;function cL({children:t}){const e=Ge(lL);return b.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:e},children:t})}function uL(t){const e=Wr(),n=k.useRef(!1);k.useEffect(()=>{!n.current&&e.viewportInitialized&&t&&(setTimeout(()=>t(e),1),n.current=!0)},[t,e.viewportInitialized])}const dL=t=>t.panZoom?.syncViewport;function fL(t){const e=Ge(dL),n=mt();return k.useEffect(()=>{t&&(e?.(t),n.setState({transform:[t.x,t.y,t.zoom]}))},[t,e]),null}function hL(t){return t.connection.inProgress?{...t.connection,to:rc(t.connection.to,t.transform)}:{...t.connection}}function mL(t){return hL}function pL(t){const e=mL();return Ge(e,vt)}const gL=t=>({nodesConnectable:t.nodesConnectable,isValid:t.connection.isValid,inProgress:t.connection.inProgress,width:t.width,height:t.height});function yL({containerStyle:t,style:e,type:n,component:s}){const{nodesConnectable:a,width:l,height:c,isValid:d,inProgress:h}=Ge(gL,vt);return!(l&&a&&h)?null:b.jsx("svg",{style:t,width:l,height:c,className:"react-flow__connectionline react-flow__container",children:b.jsx("g",{className:Ot(["react-flow__connection",eS(d)]),children:b.jsx(t1,{style:e,type:n,CustomComponent:s,isValid:d})})})}const t1=({style:t,type:e=Bs.Bezier,CustomComponent:n,isValid:s})=>{const{inProgress:a,from:l,fromNode:c,fromHandle:d,fromPosition:h,to:f,toNode:p,toHandle:m,toPosition:y,pointer:_}=pL();if(!a)return;if(n)return b.jsx(n,{connectionLineType:e,connectionLineStyle:t,fromNode:c,fromHandle:d,fromX:l.x,fromY:l.y,toX:f.x,toY:f.y,fromPosition:h,toPosition:y,connectionStatus:eS(s),toNode:p,toHandle:m,pointer:_});let x="";const w={sourceX:l.x,sourceY:l.y,sourcePosition:h,targetX:f.x,targetY:f.y,targetPosition:y};switch(e){case Bs.Bezier:[x]=Vg(w);break;case Bs.SimpleBezier:[x]=HS(w);break;case Bs.Step:[x]=Jp({...w,borderRadius:0});break;case Bs.SmoothStep:[x]=Jp(w);break;default:[x]=mS(w)}return b.jsx("path",{d:x,fill:"none",className:"react-flow__connection-path",style:t})};t1.displayName="ConnectionLine";const vL={};function _x(t=vL){k.useRef(t),mt(),k.useEffect(()=>{},[t])}function _L(){mt(),k.useRef(!1),k.useEffect(()=>{},[])}function n1({nodeTypes:t,edgeTypes:e,onInit:n,onNodeClick:s,onEdgeClick:a,onNodeDoubleClick:l,onEdgeDoubleClick:c,onNodeMouseEnter:d,onNodeMouseMove:h,onNodeMouseLeave:f,onNodeContextMenu:p,onSelectionContextMenu:m,onSelectionStart:y,onSelectionEnd:_,connectionLineType:x,connectionLineStyle:w,connectionLineComponent:A,connectionLineContainerStyle:S,selectionKeyCode:T,selectionOnDrag:E,selectionMode:C,multiSelectionKeyCode:j,panActivationKeyCode:O,zoomActivationKeyCode:M,deleteKeyCode:D,onlyRenderVisibleElements:q,elementsSelectable:G,defaultViewport:V,translateExtent:F,minZoom:K,maxZoom:$,preventScrolling:Q,defaultMarkerColor:R,zoomOnScroll:U,zoomOnPinch:B,panOnScroll:L,panOnScrollSpeed:H,panOnScrollMode:I,zoomOnDoubleClick:P,panOnDrag:Y,onPaneClick:J,onPaneMouseEnter:Z,onPaneMouseMove:ae,onPaneMouseLeave:ce,onPaneScroll:he,onPaneContextMenu:ye,paneClickDistance:pe,nodeClickDistance:_e,onEdgeContextMenu:be,onEdgeMouseEnter:we,onEdgeMouseMove:ue,onEdgeMouseLeave:te,reconnectRadius:fe,onReconnect:Te,onReconnectStart:De,onReconnectEnd:Xe,noDragClassName:ct,noWheelClassName:et,noPanClassName:pn,disableKeyboardA11y:Gt,nodeExtent:ft,rfId:gn,viewport:kn,onViewportChange:nn}){return _x(t),_x(e),_L(),uL(n),fL(kn),b.jsx(M3,{onPaneClick:J,onPaneMouseEnter:Z,onPaneMouseMove:ae,onPaneMouseLeave:ce,onPaneContextMenu:ye,onPaneScroll:he,paneClickDistance:pe,deleteKeyCode:D,selectionKeyCode:T,selectionOnDrag:E,selectionMode:C,onSelectionStart:y,onSelectionEnd:_,multiSelectionKeyCode:j,panActivationKeyCode:O,zoomActivationKeyCode:M,elementsSelectable:G,zoomOnScroll:U,zoomOnPinch:B,zoomOnDoubleClick:P,panOnScroll:L,panOnScrollSpeed:H,panOnScrollMode:I,panOnDrag:Y,defaultViewport:V,translateExtent:F,minZoom:K,maxZoom:$,onSelectionContextMenu:m,preventScrolling:Q,noDragClassName:ct,noWheelClassName:et,noPanClassName:pn,disableKeyboardA11y:Gt,onViewportChange:nn,isControlledViewport:!!kn,children:b.jsxs(cL,{children:[b.jsx(oL,{edgeTypes:e,onEdgeClick:a,onEdgeDoubleClick:c,onReconnect:Te,onReconnectStart:De,onReconnectEnd:Xe,onlyRenderVisibleElements:q,onEdgeContextMenu:be,onEdgeMouseEnter:we,onEdgeMouseMove:ue,onEdgeMouseLeave:te,reconnectRadius:fe,defaultMarkerColor:R,noPanClassName:pn,disableKeyboardA11y:Gt,rfId:gn}),b.jsx(yL,{style:w,type:x,component:A,containerStyle:S}),b.jsx("div",{className:"react-flow__edgelabel-renderer"}),b.jsx(q3,{nodeTypes:t,onNodeClick:s,onNodeDoubleClick:l,onNodeMouseEnter:d,onNodeMouseMove:h,onNodeMouseLeave:f,onNodeContextMenu:p,nodeClickDistance:_e,onlyRenderVisibleElements:q,noPanClassName:pn,noDragClassName:ct,disableKeyboardA11y:Gt,nodeExtent:ft,rfId:gn}),b.jsx("div",{className:"react-flow__viewport-portal"})]})})}n1.displayName="GraphView";const bL=k.memo(n1),bx=({nodes:t,edges:e,defaultNodes:n,defaultEdges:s,width:a,height:l,fitView:c,fitViewOptions:d,minZoom:h=.5,maxZoom:f=2,nodeOrigin:p,nodeExtent:m}={})=>{const y=new Map,_=new Map,x=new Map,w=new Map,A=s??e??[],S=n??t??[],T=p??[0,0],E=m??Ll;yS(x,w,A);const C=eg(S,y,_,{nodeOrigin:T,nodeExtent:E,elevateNodesOnSelect:!1});let j=[0,0,1];if(c&&a&&l){const O=tc(y,{filter:G=>!!((G.width||G.initialWidth)&&(G.height||G.initialHeight))}),{x:M,y:D,zoom:q}=Qg(O,a,l,h,f,d?.padding??.1);j=[M,D,q]}return{rfId:"1",width:a??0,height:l??0,transform:j,nodes:S,nodesInitialized:C,nodeLookup:y,parentLookup:_,edges:A,edgeLookup:w,connectionLookup:x,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:s!==void 0,panZoom:null,minZoom:h,maxZoom:f,translateExtent:Ll,nodeExtent:E,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:qa.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:T,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:c??!1,fitViewOptions:d,fitViewResolver:null,connection:{...ZE},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:DB,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:JE}},wL=({nodes:t,edges:e,defaultNodes:n,defaultEdges:s,width:a,height:l,fitView:c,fitViewOptions:d,minZoom:h,maxZoom:f,nodeOrigin:p,nodeExtent:m})=>$U((y,_)=>{async function x(){const{nodeLookup:w,panZoom:A,fitViewOptions:S,fitViewResolver:T,width:E,height:C,minZoom:j,maxZoom:O}=_();A&&(await kB({nodes:w,width:E,height:C,panZoom:A,minZoom:j,maxZoom:O},S),T?.resolve(!0),y({fitViewResolver:null}))}return{...bx({nodes:t,edges:e,width:a,height:l,fitView:c,fitViewOptions:d,minZoom:h,maxZoom:f,nodeOrigin:p,nodeExtent:m,defaultNodes:n,defaultEdges:s}),setNodes:w=>{const{nodeLookup:A,parentLookup:S,nodeOrigin:T,elevateNodesOnSelect:E,fitViewQueued:C}=_(),j=eg(w,A,S,{nodeOrigin:T,nodeExtent:m,elevateNodesOnSelect:E,checkEquality:!0});C&&j?(x(),y({nodes:w,nodesInitialized:j,fitViewQueued:!1,fitViewOptions:void 0})):y({nodes:w,nodesInitialized:j})},setEdges:w=>{const{connectionLookup:A,edgeLookup:S}=_();yS(A,S,w),y({edges:w})},setDefaultNodesAndEdges:(w,A)=>{if(w){const{setNodes:S}=_();S(w),y({hasDefaultNodes:!0})}if(A){const{setEdges:S}=_();S(A),y({hasDefaultEdges:!0})}},updateNodeInternals:w=>{const{triggerNodeChanges:A,nodeLookup:S,parentLookup:T,domNode:E,nodeOrigin:C,nodeExtent:j,debug:O,fitViewQueued:M}=_(),{changes:D,updatedInternals:q}=nU(w,S,T,E,C,j);q&&(JB(S,T,{nodeOrigin:C,nodeExtent:j}),M?(x(),y({fitViewQueued:!1,fitViewOptions:void 0})):y({}),D?.length>0&&(O&&console.log("React Flow: trigger node changes",D),A?.(D)))},updateNodePositions:(w,A=!1)=>{const S=[],T=[],{nodeLookup:E,triggerNodeChanges:C}=_();for(const[j,O]of w){const M=E.get(j),D=!!(M?.expandParent&&M?.parentId&&O?.position),q={id:j,type:"position",position:D?{x:Math.max(0,O.position.x),y:Math.max(0,O.position.y)}:O.position,dragging:A};D&&M.parentId&&S.push({id:j,parentId:M.parentId,rect:{...O.internals.positionAbsolute,width:O.measured.width??0,height:O.measured.height??0}}),T.push(q)}if(S.length>0){const{parentLookup:j,nodeOrigin:O}=_(),M=Kg(S,E,j,O);T.push(...M)}C(T)},triggerNodeChanges:w=>{const{onNodesChange:A,setNodes:S,nodes:T,hasDefaultNodes:E,debug:C}=_();if(w?.length){if(E){const j=IS(w,T);S(j)}C&&console.log("React Flow: trigger node changes",w),A?.(w)}},triggerEdgeChanges:w=>{const{onEdgesChange:A,setEdges:S,edges:T,hasDefaultEdges:E,debug:C}=_();if(w?.length){if(E){const j=kS(w,T);S(j)}C&&console.log("React Flow: trigger edge changes",w),A?.(w)}},addSelectedNodes:w=>{const{multiSelectionActive:A,edgeLookup:S,nodeLookup:T,triggerNodeChanges:E,triggerEdgeChanges:C}=_();if(A){const j=w.map(O=>ui(O,!0));E(j);return}E(Da(T,new Set([...w]),!0)),C(Da(S))},addSelectedEdges:w=>{const{multiSelectionActive:A,edgeLookup:S,nodeLookup:T,triggerNodeChanges:E,triggerEdgeChanges:C}=_();if(A){const j=w.map(O=>ui(O,!0));C(j);return}C(Da(S,new Set([...w]))),E(Da(T,new Set,!0))},unselectNodesAndEdges:({nodes:w,edges:A}={})=>{const{edges:S,nodes:T,nodeLookup:E,triggerNodeChanges:C,triggerEdgeChanges:j}=_(),O=w||T,M=A||S,D=O.map(G=>{const V=E.get(G.id);return V&&(V.selected=!1),ui(G.id,!1)}),q=M.map(G=>ui(G.id,!1));C(D),j(q)},setMinZoom:w=>{const{panZoom:A,maxZoom:S}=_();A?.setScaleExtent([w,S]),y({minZoom:w})},setMaxZoom:w=>{const{panZoom:A,minZoom:S}=_();A?.setScaleExtent([S,w]),y({maxZoom:w})},setTranslateExtent:w=>{_().panZoom?.setTranslateExtent(w),y({translateExtent:w})},resetSelectedElements:()=>{const{edges:w,nodes:A,triggerNodeChanges:S,triggerEdgeChanges:T,elementsSelectable:E}=_();if(!E)return;const C=A.reduce((O,M)=>M.selected?[...O,ui(M.id,!1)]:O,[]),j=w.reduce((O,M)=>M.selected?[...O,ui(M.id,!1)]:O,[]);S(C),T(j)},setNodeExtent:w=>{const{nodes:A,nodeLookup:S,parentLookup:T,nodeOrigin:E,elevateNodesOnSelect:C,nodeExtent:j}=_();w[0][0]===j[0][0]&&w[0][1]===j[0][1]&&w[1][0]===j[1][0]&&w[1][1]===j[1][1]||(eg(A,S,T,{nodeOrigin:E,nodeExtent:w,elevateNodesOnSelect:C,checkEquality:!1}),y({nodeExtent:w}))},panBy:w=>{const{transform:A,width:S,height:T,panZoom:E,translateExtent:C}=_();return rU({delta:w,panZoom:E,transform:A,translateExtent:C,width:S,height:T})},setCenter:async(w,A,S)=>{const{width:T,height:E,maxZoom:C,panZoom:j}=_();if(!j)return Promise.resolve(!1);const O=typeof S?.zoom<"u"?S.zoom:C;return await j.setViewport({x:T/2-w*O,y:E/2-A*O,zoom:O},{duration:S?.duration,ease:S?.ease,interpolate:S?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{y({connection:{...ZE}})},updateConnection:w=>{y({connection:w})},reset:()=>y({...bx()})}},Object.is);function xL({initialNodes:t,initialEdges:e,defaultNodes:n,defaultEdges:s,initialWidth:a,initialHeight:l,initialMinZoom:c,initialMaxZoom:d,initialFitViewOptions:h,fitView:f,nodeOrigin:p,nodeExtent:m,children:y}){const[_]=k.useState(()=>wL({nodes:t,edges:e,defaultNodes:n,defaultEdges:s,width:a,height:l,fitView:f,minZoom:c,maxZoom:d,fitViewOptions:h,nodeOrigin:p,nodeExtent:m}));return b.jsx(zU,{value:_,children:b.jsx(c3,{children:y})})}function AL({children:t,nodes:e,edges:n,defaultNodes:s,defaultEdges:a,width:l,height:c,fitView:d,fitViewOptions:h,minZoom:f,maxZoom:p,nodeOrigin:m,nodeExtent:y}){return k.useContext(df)?b.jsx(b.Fragment,{children:t}):b.jsx(xL,{initialNodes:e,initialEdges:n,defaultNodes:s,defaultEdges:a,initialWidth:l,initialHeight:c,fitView:d,initialFitViewOptions:h,initialMinZoom:f,initialMaxZoom:p,nodeOrigin:m,nodeExtent:y,children:t})}const EL={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function SL({nodes:t,edges:e,defaultNodes:n,defaultEdges:s,className:a,nodeTypes:l,edgeTypes:c,onNodeClick:d,onEdgeClick:h,onInit:f,onMove:p,onMoveStart:m,onMoveEnd:y,onConnect:_,onConnectStart:x,onConnectEnd:w,onClickConnectStart:A,onClickConnectEnd:S,onNodeMouseEnter:T,onNodeMouseMove:E,onNodeMouseLeave:C,onNodeContextMenu:j,onNodeDoubleClick:O,onNodeDragStart:M,onNodeDrag:D,onNodeDragStop:q,onNodesDelete:G,onEdgesDelete:V,onDelete:F,onSelectionChange:K,onSelectionDragStart:$,onSelectionDrag:Q,onSelectionDragStop:R,onSelectionContextMenu:U,onSelectionStart:B,onSelectionEnd:L,onBeforeDelete:H,connectionMode:I,connectionLineType:P=Bs.Bezier,connectionLineStyle:Y,connectionLineComponent:J,connectionLineContainerStyle:Z,deleteKeyCode:ae="Backspace",selectionKeyCode:ce="Shift",selectionOnDrag:he=!1,selectionMode:ye=$l.Full,panActivationKeyCode:pe="Space",multiSelectionKeyCode:_e=Pl()?"Meta":"Control",zoomActivationKeyCode:be=Pl()?"Meta":"Control",snapToGrid:we,snapGrid:ue,onlyRenderVisibleElements:te=!1,selectNodesOnDrag:fe,nodesDraggable:Te,autoPanOnNodeFocus:De,nodesConnectable:Xe,nodesFocusable:ct,nodeOrigin:et=jS,edgesFocusable:pn,edgesReconnectable:Gt,elementsSelectable:ft=!0,defaultViewport:gn=ZU,minZoom:kn=.5,maxZoom:nn=2,translateExtent:rn=Ll,preventScrolling:br=!0,nodeExtent:ge,defaultMarkerColor:Le="#b1b1b7",zoomOnScroll:Me=!0,zoomOnPinch:Ke=!0,panOnScroll:tt=!1,panOnScrollSpeed:pt=.5,panOnScrollMode:Zt=xi.Free,zoomOnDoubleClick:Sf=!0,panOnDrag:Cf=!0,onPaneClick:Tf,onPaneMouseEnter:ji,onPaneMouseMove:Oi,onPaneMouseLeave:Ii,onPaneScroll:wr,onPaneContextMenu:ki,paneClickDistance:Ps=1,nodeClickDistance:Nf=0,children:oc,onReconnect:eo,onReconnectStart:Hs,onReconnectEnd:Rf,onEdgeContextMenu:lc,onEdgeDoubleClick:cc,onEdgeMouseEnter:uc,onEdgeMouseMove:to,onEdgeMouseLeave:no,reconnectRadius:dc=10,onNodesChange:fc,onEdgesChange:or,noDragClassName:It="nodrag",noWheelClassName:Yt="nowheel",noPanClassName:xr="nopan",fitView:Mi,fitViewOptions:hc,connectOnClick:jf,attributionPosition:mc,proOptions:qs,defaultEdgeOptions:ro,elevateNodesOnSelect:es,elevateEdgesOnSelect:ts,disableKeyboardA11y:ns=!1,autoPanOnConnect:rs,autoPanOnNodeDrag:At,autoPanSpeed:pc,connectionRadius:gc,isValidConnection:Ar,onError:ss,style:Of,id:so,nodeDragThreshold:yc,connectionDragThreshold:If,viewport:Di,onViewportChange:Bi,width:Fn,height:sn,colorMode:vc="light",debug:kf,onScroll:Ui,ariaLabelConfig:_c,...Li},Mf){const Xt=so||"1",io=r3(vc),bc=k.useCallback($i=>{$i.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Ui?.($i)},[Ui]);return b.jsx("div",{"data-testid":"rf__wrapper",...Li,onScroll:bc,style:{...Of,...EL},ref:Mf,className:Ot(["react-flow",a,io]),id:so,role:"application",children:b.jsxs(AL,{nodes:t,edges:e,width:Fn,height:sn,fitView:Mi,fitViewOptions:hc,minZoom:kn,maxZoom:nn,nodeOrigin:et,nodeExtent:ge,children:[b.jsx(bL,{onInit:f,onNodeClick:d,onEdgeClick:h,onNodeMouseEnter:T,onNodeMouseMove:E,onNodeMouseLeave:C,onNodeContextMenu:j,onNodeDoubleClick:O,nodeTypes:l,edgeTypes:c,connectionLineType:P,connectionLineStyle:Y,connectionLineComponent:J,connectionLineContainerStyle:Z,selectionKeyCode:ce,selectionOnDrag:he,selectionMode:ye,deleteKeyCode:ae,multiSelectionKeyCode:_e,panActivationKeyCode:pe,zoomActivationKeyCode:be,onlyRenderVisibleElements:te,defaultViewport:gn,translateExtent:rn,minZoom:kn,maxZoom:nn,preventScrolling:br,zoomOnScroll:Me,zoomOnPinch:Ke,zoomOnDoubleClick:Sf,panOnScroll:tt,panOnScrollSpeed:pt,panOnScrollMode:Zt,panOnDrag:Cf,onPaneClick:Tf,onPaneMouseEnter:ji,onPaneMouseMove:Oi,onPaneMouseLeave:Ii,onPaneScroll:wr,onPaneContextMenu:ki,paneClickDistance:Ps,nodeClickDistance:Nf,onSelectionContextMenu:U,onSelectionStart:B,onSelectionEnd:L,onReconnect:eo,onReconnectStart:Hs,onReconnectEnd:Rf,onEdgeContextMenu:lc,onEdgeDoubleClick:cc,onEdgeMouseEnter:uc,onEdgeMouseMove:to,onEdgeMouseLeave:no,reconnectRadius:dc,defaultMarkerColor:Le,noDragClassName:It,noWheelClassName:Yt,noPanClassName:xr,rfId:Xt,disableKeyboardA11y:ns,nodeExtent:ge,viewport:Di,onViewportChange:Bi}),b.jsx(n3,{nodes:t,edges:e,defaultNodes:n,defaultEdges:s,onConnect:_,onConnectStart:x,onConnectEnd:w,onClickConnectStart:A,onClickConnectEnd:S,nodesDraggable:Te,autoPanOnNodeFocus:De,nodesConnectable:Xe,nodesFocusable:ct,edgesFocusable:pn,edgesReconnectable:Gt,elementsSelectable:ft,elevateNodesOnSelect:es,elevateEdgesOnSelect:ts,minZoom:kn,maxZoom:nn,nodeExtent:ge,onNodesChange:fc,onEdgesChange:or,snapToGrid:we,snapGrid:ue,connectionMode:I,translateExtent:rn,connectOnClick:jf,defaultEdgeOptions:ro,fitView:Mi,fitViewOptions:hc,onNodesDelete:G,onEdgesDelete:V,onDelete:F,onNodeDragStart:M,onNodeDrag:D,onNodeDragStop:q,onSelectionDrag:Q,onSelectionDragStart:$,onSelectionDragStop:R,onMove:p,onMoveStart:m,onMoveEnd:y,noPanClassName:xr,nodeOrigin:et,rfId:Xt,autoPanOnConnect:rs,autoPanOnNodeDrag:At,autoPanSpeed:pc,onError:ss,connectionRadius:gc,isValidConnection:Ar,selectNodesOnDrag:fe,nodeDragThreshold:yc,connectionDragThreshold:If,onBeforeDelete:H,debug:kf,ariaLabelConfig:_c}),b.jsx(JU,{onSelectionChange:K}),oc,b.jsx(GU,{proOptions:qs,position:mc}),b.jsx(VU,{rfId:Xt,disableKeyboardA11y:ns})]})})}var CL=MS(SL);const TL=ir.error014();function Zg({id:t,handleType:e,handleId:n,onConnect:s,onDisconnect:a}={}){const l=Jg(),c=t??l;if(!c)throw new Error(TL);const d=k.useRef(null),h=Ge(f=>f.connectionLookup.get(`${c}${e?n?`-${e}-${n}`:`-${e}`:""}`),NB);return k.useEffect(()=>{if(d.current&&d.current!==h){const f=h??new Map;Iw(d.current,f,a),Iw(f,d.current,s)}d.current=h??new Map},[h,s,a]),k.useMemo(()=>Array.from(h?.values()??[]),[h])}function r1(t){return Ge(k.useCallback(n=>{const s=[],a=Array.isArray(t),l=a?t:[t];for(const c of l){const d=n.nodeLookup.get(c);d&&s.push({id:d.id,type:d.type,data:d.data})}return a?s:s[0]??null},[t]),sU)}function NL({dimensions:t,lineWidth:e,variant:n,className:s}){return b.jsx("path",{strokeWidth:e,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`,className:Ot(["react-flow__background-pattern",n,s])})}function RL({radius:t,className:e}){return b.jsx("circle",{cx:t,cy:t,r:t,className:Ot(["react-flow__background-pattern","dots",e])})}var Us;(function(t){t.Lines="lines",t.Dots="dots",t.Cross="cross"})(Us||(Us={}));const jL={[Us.Dots]:1,[Us.Lines]:1,[Us.Cross]:6},OL=t=>({transform:t.transform,patternId:`pattern-${t.rfId}`});function s1({id:t,variant:e=Us.Dots,gap:n=20,size:s,lineWidth:a=1,offset:l=0,color:c,bgColor:d,style:h,className:f,patternClassName:p}){const m=k.useRef(null),{transform:y,patternId:_}=Ge(OL,vt),x=s||jL[e],w=e===Us.Dots,A=e===Us.Cross,S=Array.isArray(n)?n:[n,n],T=[S[0]*y[2]||1,S[1]*y[2]||1],E=x*y[2],C=Array.isArray(l)?l:[l,l],j=A?[E,E]:T,O=[C[0]*y[2]||1+j[0]/2,C[1]*y[2]||1+j[1]/2],M=`${_}${t||""}`;return b.jsxs("svg",{className:Ot(["react-flow__background",f]),style:{...h,...hf,"--xy-background-color-props":d,"--xy-background-pattern-color-props":c},ref:m,"data-testid":"rf__background",children:[b.jsx("pattern",{id:M,x:y[0]%T[0],y:y[1]%T[1],width:T[0],height:T[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${O[0]},-${O[1]})`,children:w?b.jsx(RL,{radius:E/2,className:p}):b.jsx(NL,{dimensions:j,lineWidth:a,variant:e,className:p})}),b.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${M})`})]})}s1.displayName="Background";const IL=k.memo(s1);function kL(){return b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:b.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function ML(){return b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:b.jsx("path",{d:"M0 0h32v4.2H0z"})})}function DL(){return b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:b.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function BL(){return b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:b.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function UL(){return b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:b.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Wu({children:t,className:e,...n}){return b.jsx("button",{type:"button",className:Ot(["react-flow__controls-button",e]),...n,children:t})}const LL=t=>({isInteractive:t.nodesDraggable||t.nodesConnectable||t.elementsSelectable,minZoomReached:t.transform[2]<=t.minZoom,maxZoomReached:t.transform[2]>=t.maxZoom,ariaLabelConfig:t.ariaLabelConfig});function i1({style:t,showZoom:e=!0,showFitView:n=!0,showInteractive:s=!0,fitViewOptions:a,onZoomIn:l,onZoomOut:c,onFitView:d,onInteractiveChange:h,className:f,children:p,position:m="bottom-left",orientation:y="vertical","aria-label":_}){const x=mt(),{isInteractive:w,minZoomReached:A,maxZoomReached:S,ariaLabelConfig:T}=Ge(LL,vt),{zoomIn:E,zoomOut:C,fitView:j}=Wr(),O=()=>{E(),l?.()},M=()=>{C(),c?.()},D=()=>{j(a),d?.()},q=()=>{x.setState({nodesDraggable:!w,nodesConnectable:!w,elementsSelectable:!w}),h?.(!w)},G=y==="horizontal"?"horizontal":"vertical";return b.jsxs(ff,{className:Ot(["react-flow__controls",G,f]),position:m,style:t,"data-testid":"rf__controls","aria-label":_??T["controls.ariaLabel"],children:[e&&b.jsxs(b.Fragment,{children:[b.jsx(Wu,{onClick:O,className:"react-flow__controls-zoomin",title:T["controls.zoomIn.ariaLabel"],"aria-label":T["controls.zoomIn.ariaLabel"],disabled:S,children:b.jsx(kL,{})}),b.jsx(Wu,{onClick:M,className:"react-flow__controls-zoomout",title:T["controls.zoomOut.ariaLabel"],"aria-label":T["controls.zoomOut.ariaLabel"],disabled:A,children:b.jsx(ML,{})})]}),n&&b.jsx(Wu,{className:"react-flow__controls-fitview",onClick:D,title:T["controls.fitView.ariaLabel"],"aria-label":T["controls.fitView.ariaLabel"],children:b.jsx(DL,{})}),s&&b.jsx(Wu,{className:"react-flow__controls-interactive",onClick:q,title:T["controls.interactive.ariaLabel"],"aria-label":T["controls.interactive.ariaLabel"],children:w?b.jsx(UL,{}):b.jsx(BL,{})}),p]})}i1.displayName="Controls";const $L=k.memo(i1);function zL({id:t,x:e,y:n,width:s,height:a,style:l,color:c,strokeColor:d,strokeWidth:h,className:f,borderRadius:p,shapeRendering:m,selected:y,onClick:_}){const{background:x,backgroundColor:w}=l||{},A=c||x||w;return b.jsx("rect",{className:Ot(["react-flow__minimap-node",{selected:y},f]),x:e,y:n,rx:p,ry:p,width:s,height:a,style:{fill:A,stroke:d,strokeWidth:h},shapeRendering:m,onClick:_?S=>_(S,t):void 0})}const PL=k.memo(zL),HL=t=>t.nodes.map(e=>e.id),gp=t=>t instanceof Function?t:()=>t;function qL({nodeStrokeColor:t,nodeColor:e,nodeClassName:n="",nodeBorderRadius:s=5,nodeStrokeWidth:a,nodeComponent:l=PL,onClick:c}){const d=Ge(HL,vt),h=gp(e),f=gp(t),p=gp(n),m=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return b.jsx(b.Fragment,{children:d.map(y=>b.jsx(FL,{id:y,nodeColorFunc:h,nodeStrokeColorFunc:f,nodeClassNameFunc:p,nodeBorderRadius:s,nodeStrokeWidth:a,NodeComponent:l,onClick:c,shapeRendering:m},y))})}function QL({id:t,nodeColorFunc:e,nodeStrokeColorFunc:n,nodeClassNameFunc:s,nodeBorderRadius:a,nodeStrokeWidth:l,shapeRendering:c,NodeComponent:d,onClick:h}){const{node:f,x:p,y:m,width:y,height:_}=Ge(x=>{const{internals:w}=x.nodeLookup.get(t),A=w.userNode,{x:S,y:T}=w.positionAbsolute,{width:E,height:C}=Zr(A);return{node:A,x:S,y:T,width:E,height:C}},vt);return!f||f.hidden||!aS(f)?null:b.jsx(d,{x:p,y:m,width:y,height:_,style:f.style,selected:!!f.selected,className:s(f),color:e(f),borderRadius:a,strokeColor:n(f),strokeWidth:l,shapeRendering:c,onClick:h,id:f.id})}const FL=k.memo(QL);var VL=k.memo(qL);const GL=200,YL=150,XL=t=>!t.hidden,KL=t=>{const e={x:-t.transform[0]/t.transform[2],y:-t.transform[1]/t.transform[2],width:t.width/t.transform[2],height:t.height/t.transform[2]};return{viewBB:e,boundingRect:t.nodeLookup.size>0?iS(tc(t.nodeLookup,{filter:XL}),e):e,rfId:t.rfId,panZoom:t.panZoom,translateExtent:t.translateExtent,flowWidth:t.width,flowHeight:t.height,ariaLabelConfig:t.ariaLabelConfig}},WL="react-flow__minimap-desc";function a1({style:t,className:e,nodeStrokeColor:n,nodeColor:s,nodeClassName:a="",nodeBorderRadius:l=5,nodeStrokeWidth:c,nodeComponent:d,bgColor:h,maskColor:f,maskStrokeColor:p,maskStrokeWidth:m,position:y="bottom-right",onClick:_,onNodeClick:x,pannable:w=!1,zoomable:A=!1,ariaLabel:S,inversePan:T,zoomStep:E=1,offsetScale:C=5}){const j=mt(),O=k.useRef(null),{boundingRect:M,viewBB:D,rfId:q,panZoom:G,translateExtent:V,flowWidth:F,flowHeight:K,ariaLabelConfig:$}=Ge(KL,vt),Q=t?.width??GL,R=t?.height??YL,U=M.width/Q,B=M.height/R,L=Math.max(U,B),H=L*Q,I=L*R,P=C*L,Y=M.x-(H-M.width)/2-P,J=M.y-(I-M.height)/2-P,Z=H+P*2,ae=I+P*2,ce=`${WL}-${q}`,he=k.useRef(0),ye=k.useRef();he.current=L,k.useEffect(()=>{if(O.current&&G)return ye.current=hU({domNode:O.current,panZoom:G,getTransform:()=>j.getState().transform,getViewScale:()=>he.current}),()=>{ye.current?.destroy()}},[G]),k.useEffect(()=>{ye.current?.update({translateExtent:V,width:F,height:K,inversePan:T,pannable:w,zoomStep:E,zoomable:A})},[w,A,T,E,V,F,K]);const pe=_?we=>{const[ue,te]=ye.current?.pointer(we)||[0,0];_(we,{x:ue,y:te})}:void 0,_e=x?k.useCallback((we,ue)=>{const te=j.getState().nodeLookup.get(ue).internals.userNode;x(we,te)},[]):void 0,be=S??$["minimap.ariaLabel"];return b.jsx(ff,{position:y,style:{...t,"--xy-minimap-background-color-props":typeof h=="string"?h:void 0,"--xy-minimap-mask-background-color-props":typeof f=="string"?f:void 0,"--xy-minimap-mask-stroke-color-props":typeof p=="string"?p:void 0,"--xy-minimap-mask-stroke-width-props":typeof m=="number"?m*L:void 0,"--xy-minimap-node-background-color-props":typeof s=="string"?s:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof c=="number"?c:void 0},className:Ot(["react-flow__minimap",e]),"data-testid":"rf__minimap",children:b.jsxs("svg",{width:Q,height:R,viewBox:`${Y} ${J} ${Z} ${ae}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":ce,ref:O,onClick:pe,children:[be&&b.jsx("title",{id:ce,children:be}),b.jsx(VL,{onClick:_e,nodeColor:s,nodeStrokeColor:n,nodeBorderRadius:l,nodeClassName:a,nodeStrokeWidth:c,nodeComponent:d}),b.jsx("path",{className:"react-flow__minimap-mask",d:`M${Y-P},${J-P}h${Z+P*2}v${ae+P*2}h${-Z-P*2}z
        M${D.x},${D.y}h${D.width}v${D.height}h${-D.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}a1.displayName="MiniMap";k.memo(a1);const JL=t=>e=>t?`${Math.max(1/e.transform[2],1)}`:void 0,ZL={[Ga.Line]:"right",[Ga.Handle]:"bottom-right"};function e$({nodeId:t,position:e,variant:n=Ga.Handle,className:s,style:a=void 0,children:l,color:c,minWidth:d=10,minHeight:h=10,maxWidth:f=Number.MAX_VALUE,maxHeight:p=Number.MAX_VALUE,keepAspectRatio:m=!1,resizeDirection:y,autoScale:_=!0,shouldResize:x,onResizeStart:w,onResize:A,onResizeEnd:S}){const T=Jg(),E=typeof t=="string"?t:T,C=mt(),j=k.useRef(null),O=n===Ga.Handle,M=Ge(k.useCallback(JL(O&&_),[O,_]),vt),D=k.useRef(null),q=e??ZL[n];k.useEffect(()=>{if(!(!j.current||!E))return D.current||(D.current=TU({domNode:j.current,nodeId:E,getStoreItems:()=>{const{nodeLookup:V,transform:F,snapGrid:K,snapToGrid:$,nodeOrigin:Q,domNode:R}=C.getState();return{nodeLookup:V,transform:F,snapGrid:K,snapToGrid:$,nodeOrigin:Q,paneDomNode:R}},onChange:(V,F)=>{const{triggerNodeChanges:K,nodeLookup:$,parentLookup:Q,nodeOrigin:R}=C.getState(),U=[],B={x:V.x,y:V.y},L=$.get(E);if(L&&L.expandParent&&L.parentId){const H=L.origin??R,I=V.width??L.measured.width??0,P=V.height??L.measured.height??0,Y={id:L.id,parentId:L.parentId,rect:{width:I,height:P,...oS({x:V.x??L.position.x,y:V.y??L.position.y},{width:I,height:P},L.parentId,$,H)}},J=Kg([Y],$,Q,R);U.push(...J),B.x=V.x?Math.max(H[0]*I,V.x):void 0,B.y=V.y?Math.max(H[1]*P,V.y):void 0}if(B.x!==void 0&&B.y!==void 0){const H={id:E,type:"position",position:{...B}};U.push(H)}if(V.width!==void 0&&V.height!==void 0){const I={id:E,type:"dimensions",resizing:!0,setAttributes:y?y==="horizontal"?"width":"height":!0,dimensions:{width:V.width,height:V.height}};U.push(I)}for(const H of F){const I={...H,type:"position"};U.push(I)}K(U)},onEnd:({width:V,height:F})=>{const K={id:E,type:"dimensions",resizing:!1,dimensions:{width:V,height:F}};C.getState().triggerNodeChanges([K])}})),D.current.update({controlPosition:q,boundaries:{minWidth:d,minHeight:h,maxWidth:f,maxHeight:p},keepAspectRatio:m,resizeDirection:y,onResizeStart:w,onResize:A,onResizeEnd:S,shouldResize:x}),()=>{D.current?.destroy()}},[q,d,h,f,p,m,w,A,S,x]);const G=q.split("-");return b.jsx("div",{className:Ot(["react-flow__resize-control","nodrag",...G,n,s]),ref:j,style:{...a,scale:M,...c&&{[O?"backgroundColor":"borderColor"]:c}},children:l})}k.memo(e$);const o1=t=>b.jsx($t,{...t,type:"target",position:xe.Left,id:"exec-in",acceptHandle:"exec-out",style:{...t.style,width:20,height:20,borderRadius:"4px",backgroundColor:"#ff0072"}}),l1=t=>b.jsx($t,{...t,type:"source",position:xe.Right,id:"exec-out",acceptHandle:"exec-in",acceptConnection:({connection:e})=>e.targetHandle==="exec-in",style:{width:20,height:20,borderRadius:"4px",backgroundColor:"#ff0072"}}),t$=({data:t})=>{const{updateNodeData:e}=Wr(),{shot:n={}}=t,{description:s="",prompt:a="",embodys:l=[]}=n;k.useEffect(()=>{},[]);const c=d=>[];return b.jsxs("div",{className:"common-node-area",children:[b.jsx("h4",{className:"shot-node-input-title common-node-title",children:""}),b.jsx("div",{className:"shot-node-input-handle",children:b.jsx(l1,{id:"exec-out"})}),b.jsxs("div",{className:"shot-node-input-handle",children:[b.jsx($t,{type:"source",position:xe.Right,id:"description"}),b.jsx("span",{className:"handle-label",children:""})]}),b.jsxs("div",{className:"shot-node-input-handle",children:[b.jsx($t,{type:"source",position:xe.Right,id:"prompt"}),b.jsx("span",{className:"handle-label",children:""})]}),l.map((d,h)=>{const f=c();return b.jsxs("div",{className:"shot-node-input-handle",children:[b.jsx($t,{type:"source",position:xe.Right,id:`embody-${d}`}),b.jsx("span",{className:"handle-label",children:f.name})]},`embody-${d}`)})]})},n$=t=>(Zg({handleType:t.type}),b.jsx($t,{...t}));function r$({data:t}){return b.jsxs("div",{className:"common-node-area",children:[b.jsx("h4",{className:"common-node-title console-node-title",children:""}),b.jsxs("div",{className:"common-exec-handle-area",children:[b.jsx(o1,{id:"exec-in"}),b.jsx(l1,{id:"exec-out"})]}),b.jsxs("div",{className:"shot-node-input-handle",children:[b.jsx(n$,{type:"target",position:xe.Left,id:"input"}),b.jsx("span",{className:"handle-label",children:""})]})]})}const s$=({data:t})=>{const{output:e={}}=t;return b.jsxs("div",{className:"common-node-area",children:[b.jsx("h4",{className:"shot-node-output-title common-node-title",children:""}),b.jsx("div",{className:"shot-node-output-handle",children:b.jsx(o1,{id:"exec-in"})}),b.jsxs("div",{className:"shot-node-output-handle",children:[b.jsx($t,{type:"target",position:xe.Left,id:"image"}),b.jsx("span",{className:"handle-label",children:""})]}),b.jsxs("div",{className:"shot-node-output-handle",children:[b.jsx($t,{type:"target",position:xe.Left,id:"video"}),b.jsx("span",{className:"handle-label",children:""})]}),b.jsxs("div",{className:"shot-node-output-handle",children:[b.jsx($t,{type:"target",position:xe.Left,id:"audio"}),b.jsx("span",{className:"handle-label",children:""})]})]})};function i$({id:t,data:e,selected:n}){const{ep_id:s,editShotId:a}=On(),{updateNodeData:l}=Wr(),[c,d]=k.useState(null),[h,f]=k.useState(!1),[p,m]=k.useState(!1),[y,_]=k.useState([]),[x,w]=k.useState([]),[A,S]=k.useState([]),[T,E]=k.useState({}),[C,j]=k.useState(""),[O,M]=k.useState("16:9"),[D,q]=k.useState(1),[G,V]=k.useState("fal-ai/nano-banana/edit"),[F,K]=k.useState(0),[$,Q]=k.useState(0);Wr();const R=()=>{switch(O){case"16:9":return{paddingBottom:"56.25%",width:"100%",position:"relative",height:0,overflow:"hidden"};case"9:16":return{paddingBottom:"177.78%",width:"100%",position:"relative",height:0,overflow:"hidden"};case"4:3":return{paddingBottom:"75%",width:"100%",position:"relative",height:0,overflow:"hidden"};default:return{paddingBottom:"56.25%",width:"100%",position:"relative",height:0,overflow:"hidden"}}},U=()=>({position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"contain"}),L=Zg({handleType:"target",handleId:"ref_images"}).map(Z=>Z.source),H=r1(L),I=()=>H?(Array.isArray(H)?H:[H]).flatMap(ce=>ce&&ce.data&&Array.isArray(ce.data.outputImages)?Y(ce.data.outputImages):[]):[];k.useEffect(()=>{S(I())},[H]),k.useEffect(()=>{K(y.length),y.length>0&&d(y[$].url)},[y,$]);const P=Z=>typeof Z=="string"?Z.replace(/[`\s]/g,""):Z,Y=Z=>Array.isArray(Z)?Z.map(ae=>ae&&ae.url?{...ae,url:P(ae.url)}:ae):[];k.useEffect(()=>{j(e.prompt),M(e.aspect_ratio),q(e.num_images),V(e.model),_(Y(e.images||e.outputImages||[])),w(Y(e.images_small||[]))},[t]),k.useEffect(()=>{l(t,{images:y,aspect_ratio:O,num_images:D,model:G,prompt:C,outputImages:y,images_small:x})},[y,O,D,G,C,x]);const J=async()=>{let Z={};console.log("referenceImages:",A),G==="fal-ai/nano-banana/edit"&&(Z={prompt:C,num_images:Number(D),aspect_ratio:O,output_format:"png",image_urls:A.map(ae=>ae!=null&&ae.url?P(ae.url):"")}),G==="fal-ai/nano-banana-pro/edit"&&(Z={prompt:e.prompt}),G==="fal-ai/bytedance/seedream/v4/edit"&&(Z={prompt:e.prompt}),console.log(Z);try{Rd.fal.config({credentials:"d0f5c4fd-29b2-4024-bc64-a4719276c027:5b06c17b429cc06d2f5e044e95ca5164"});const ae=await Rd.fal.subscribe(G,{input:Z,logs:!0,onQueueUpdate:ce=>{ce.status==="IN_PROGRESS"&&f(!0),ce.status==="SUCCEEDED"&&f(!1)},onResult:ce=>{console.log(ce)},onError:ce=>{console.error("Error:",ce),f(!1)}});Rt.emit("makeShotThumb",a,ae.data.images[0].url),d(null),console.log(ae.data),f(!1),_(ae.data.images),Q(0)}catch(ae){console.error("Error:",ae),f(!1)}};return b.jsxs("div",{className:"txt-image-node-area",children:[b.jsxs("div",{className:"txt2img-handles-container",children:[b.jsx($t,{type:"target",position:xe.Left,id:"ref_images"}),b.jsx($t,{type:"source",position:xe.Right,id:"out_image"})]}),b.jsxs("div",{className:"txt2img-preview-container",children:[b.jsxs("div",{className:"txt2img-preview-header",children:[b.jsxs("div",{className:"txt2img-preview-title",children:["Image-",$]}),b.jsx("div",{className:"txt2img-preview-controls",children:b.jsx("span",{className:"",children:G})})]}),b.jsxs("div",{className:"txt2img-preview-image",children:[b.jsx("div",{className:"txt2img-placeholder-image",style:R(),children:c?b.jsxs(b.Fragment,{children:[b.jsx("img",{src:c,alt:"Generated",style:U()}),b.jsx("button",{className:"embody-view-large-btn",onClick:()=>{console.log("currentImageUrl",c),Rt.emit("showLargeImageModal",c)},style:{position:"absolute",top:"8px",right:"8px",zIndex:10},children:""})]}):b.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",padding:"20px"},className:"txt2img-placeholder-text",children:""})}),y.length>1&&b.jsxs("div",{className:"txt2img-pagination",children:[b.jsx("button",{className:"txt2img-pagination-btn",onClick:()=>Q(Z=>Math.max(Z-1,0)),children:""}),b.jsxs("span",{className:"txt2img-pagination-text",children:[$+1," / ",F]}),b.jsx("button",{className:"txt2img-pagination-btn",onClick:()=>Q(Z=>Math.min(Z+1,F-1)),children:""})]}),h&&b.jsxs("div",{className:"txt2img-loading-overlay",children:[b.jsx("div",{className:"txt2img-loading-spinner"}),b.jsx("span",{className:"txt2img-loading-text",children:"..."})]})]})]}),n&&b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"txt2img-prompt-container",children:b.jsx("textarea",{className:"txt2img-prompt-textarea",value:C,onChange:Z=>{const ae=Z.target.value;j(ae)},placeholder:"..."})}),b.jsxs("div",{className:"txt2img-reference-container",children:[b.jsxs("div",{className:"txt2img-reference-title",children:[" (",A.length,"/10)"]}),b.jsx("div",{className:"txt2img-reference-grid",children:A&&A.map((Z,ae)=>b.jsx("div",{className:"txt2img-reference-item",children:b.jsx("img",{src:Z.url||"",alt:`Reference ${ae+1}`})},ae))})]}),b.jsxs("div",{className:"txt2img-bottom-controls",children:[b.jsxs("div",{className:"txt2img-controls-left",children:[b.jsx("div",{className:"txt2img-control-group",children:b.jsxs("select",{value:G,onChange:Z=>{const ae=Z.target.value;V(ae)},className:"txt2img-control-select",children:[b.jsx("option",{value:"fal-ai/nano-banana/edit",children:"Nano Banana"}),b.jsx("option",{value:"fal-ai/nano-banana-pro/edit",children:"Nano Banana Pro"}),b.jsx("option",{value:"fal-ai/bytedance/seedream/v4/edit",children:"v4"})]})}),b.jsx("div",{className:"txt2img-control-group",children:b.jsxs("select",{value:O,onChange:Z=>{const ae=Z.target.value;M(ae)},className:"txt2img-control-select",children:[b.jsx("option",{value:"16:9",children:"16:9 "}),b.jsx("option",{value:"9:16",children:"9:16 "}),b.jsx("option",{value:"4:3",children:"4:3 "})]})}),b.jsx("div",{className:"txt2img-control-group",children:b.jsxs("select",{value:D,onChange:Z=>{const ae=Z.target.value;q(ae)},className:"txt2img-control-select",children:[b.jsx("option",{value:"1",children:"1"}),b.jsx("option",{value:"2",children:"2"}),b.jsx("option",{value:"3",children:"3"}),b.jsx("option",{value:"4",children:"4"})]})})]}),b.jsxs("div",{className:"txt2img-controls-right",children:[b.jsx("button",{onClick:()=>{console.log("ep_id:",s),Rt.emit("makeShotThumb",a,y[0].url)},className:"txt2img-control-button",children:""}),b.jsx("button",{onClick:J,className:"txt2img-generate-button",children:""})]})]})]})]})}function a$({id:t,data:e,selected:n}){const{updateNodeData:s}=Wr(),[a,l]=k.useState(null),[c,d]=k.useState(!1),[h,f]=k.useState({}),[p,m]=k.useState(""),[y,_]=k.useState(""),[x,w]=k.useState([]),[A,S]=k.useState([0]),[T,E]=k.useState([]),[C,j]=k.useState(""),[O,M]=k.useState(""),[D,q]=k.useState(1),G={character:"",scene:"",item:""},F={...{characterName:"",characterDescription:"",imageUrl:"/default_avatar.png"},...e};k.useEffect(()=>{j(F.characterName),M(F.characterDescription)},[F]),k.useEffect(()=>{e.id&&je.from("embodys").select(`
          *,
          embody_images(
            path
          )
        `).eq("id",e.id).single().then(R=>{f(R.data),m(R.data.name),_(G[R.data.type]||"");const U=R.data.embody_images.map(L=>({path:L.path,url:gi+L.path}));U.length==0&&U.push({path:"/public/Common/default_charactar_big.png",url:"https://gsyznlwsezhwerypyzbe.supabase.co/storage/v1/object/public/embodys/public/Common/no_pic.png"}),w(U),S([0]),l(U[0].url),R.data.embody_images&&R.data.embody_images.length>0&&gi+R.data.embody_images[0].path;let B=[];e.outputImages&&e.outputImages.forEach(L=>{for(let H=0;H<U.length;H++)L.path==U[H].path&&B.push(H)}),B.length==0&&B.push(0),S(B)})},[t]),k.useEffect(()=>{x.length>0&&s(t,{outputImages:A.map(R=>x[R])})},[A]);const K=()=>{console.log("")},$=R=>{S(U=>U.includes(R)?U.filter(B=>B!==R):[...U,R]),console.log(":",A)},Q=R=>{if(R>=1&&R<=A.length&&(q(R),A.length>0)){let U=gi+x[A[R-1]].path;l(U)}};return b.jsxs("div",{className:"embody-node-area",children:[b.jsx("div",{className:"embody-handles-container",children:b.jsx($t,{type:"source",position:xe.Right,id:"embody_out"})}),b.jsxs("div",{className:"embody-preview-container",children:[b.jsxs("div",{className:"embody-preview-header",children:[b.jsx("div",{className:"embody-preview-title",children:p||""}),b.jsx("span",{children:y||""}),b.jsx("div",{className:"embody-preview-controls",children:n&&b.jsx("button",{className:"embody-control-btn",onClick:K,children:""})})]}),b.jsxs("div",{className:"embody-preview-image",children:[b.jsx("div",{className:"embody-placeholder-image",children:a?b.jsxs(b.Fragment,{children:[b.jsx("img",{src:a,alt:"Character Preview"}),b.jsx("button",{className:"embody-view-large-btn",onClick:()=>{console.log("currentImageUrl",a),Rt.emit("showLargeImageModal",a)},children:""})]}):b.jsx("div",{className:"embody-placeholder-text",children:""})}),c&&b.jsxs("div",{className:"embody-loading-overlay",children:[b.jsx("div",{className:"embody-loading-spinner"}),b.jsx("span",{className:"embody-loading-text",children:"..."})]}),A.length>1&&b.jsxs("div",{className:"embody-pagination",children:[b.jsx("button",{className:"embody-pagination-btn",onClick:()=>Q(D-1),disabled:D===1,children:""}),b.jsxs("span",{className:"embody-pagination-text",children:[D," / ",A.length]}),b.jsx("button",{className:"embody-pagination-btn",onClick:()=>Q(D+1),disabled:D===A.length,children:""})]})]})]}),n&&b.jsx(b.Fragment,{children:b.jsx("div",{className:"embody-info-container",children:b.jsxs("div",{className:"embody-info-item",children:[b.jsx("label",{className:"embody-info-label",children:""}),b.jsx("div",{className:"embody-info-images",children:x.map((R,U)=>b.jsxs("div",{className:`embody-info-image-item ${A.includes(U)?"selected":""}`,onClick:()=>$(U),children:[b.jsx("img",{src:gi+R.path,alt:`${U}`}),A.includes(U)&&b.jsx("div",{className:"embody-image-checkmark",children:""})]},U))})]})})})]})}function o$({id:t,data:e,selected:n}){const{updateNodeData:s}=Wr(),[a,l]=k.useState(null),[c,d]=k.useState(!1),[h,f]=k.useState([]),[p,m]=k.useState([]),[y,_]=k.useState(""),[x,w]=k.useState("blur, distort, and low quality"),[A,S]=k.useState(.5),[T,E]=k.useState(5),[C,j]=k.useState(24),[O,M]=k.useState("fal-ai/kling-video/v2.1/master/image-to-video"),[D,q]=k.useState(0),[G,V]=k.useState(0),[F,K]=k.useState("");Wr();const $=()=>({paddingBottom:"56.25%",width:"100%",position:"relative",height:0,overflow:"hidden"}),Q=()=>({position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"contain"}),U=Zg({handleType:"target",handleId:"ref_images"}).map(I=>I.source),B=r1(U),L=()=>B?(Array.isArray(B)?B:[B]).flatMap(Y=>Y&&Y.data&&Array.isArray(Y.data.outputImages)?Y.data.outputImages:[]):[];k.useEffect(()=>{m(L())},[B]),k.useEffect(()=>{q(h.length),h.length>0&&l(h[G].url)},[h,G]),k.useEffect(()=>{_(e.prompt||""),E(e.duration||5),M(e.model||"fal-ai/kling-video/v2.1/master/image-to-video"),f(e.videos||[]),w(e.negative_prompt||"blur, distort, and low quality"),S(e.cfg_scale||.5)},[]),k.useEffect(()=>{s(t,{videos:h,duration:T,fps:C,model:O,prompt:y,negative_prompt:x,cfg_scale:A})},[h,T,O,y,x,A]);const H=async()=>{K("");let I={};if(console.log("referenceImages:",p),!y.trim()){K("");return}if(p.length===0){K("");return}O==="fal-ai/kling-video/v2.5-turbo/pro/image-to-video"&&(I={prompt:y,negative_prompt:x,duration:T,cfg_scale:A,image_url:p[0].url}),console.log("model:",O),console.log("inputData:",I);try{Rd.fal.config({credentials:"d0f5c4fd-29b2-4024-bc64-a4719276c027:5b06c17b429cc06d2f5e044e95ca5164"});const P=await Rd.fal.subscribe(O,{input:I,logs:!0,onQueueUpdate:Y=>{Y.status==="IN_PROGRESS"&&d(!0),Y.status==="SUCCEEDED"&&d(!1)},onResult:Y=>{console.log(Y)},onError:Y=>{console.error("Error:",Y),K(": "+(Y.message||"")),d(!1)}});l(null),console.log(P.data),f([P.data.video]),V(0),d(!1)}catch(P){console.error("Error:",P),K(": "+(P.message||"")),d(!1)}};return b.jsxs("div",{className:"image2video-node-area",children:[b.jsxs("div",{className:"image2video-handles-container",children:[b.jsx($t,{type:"target",position:xe.Left,id:"ref_images"}),b.jsx($t,{type:"source",position:xe.Right,id:"video"})]}),b.jsxs("div",{className:"image2video-preview-container",children:[b.jsxs("div",{className:"image2video-preview-header",children:[b.jsxs("div",{className:"image2video-preview-title",children:["ref-",p.length]}),b.jsx("div",{className:"image2video-preview-controls",children:b.jsx("span",{className:"",children:O})})]}),F&&b.jsxs("div",{className:"image2video-error-message",children:[b.jsx("span",{className:"image2video-error-icon",children:""}),b.jsx("span",{className:"image2video-error-text",children:F}),b.jsx("button",{className:"image2video-error-close",onClick:()=>K(""),children:""})]}),b.jsxs("div",{className:"image2video-preview-video",children:[b.jsx("div",{className:"image2video-placeholder-video",style:$(),children:a?b.jsxs(b.Fragment,{children:[b.jsx("video",{src:a,alt:"Generated Video",style:Q(),controls:!0,autoPlay:!0,muted:!0}),b.jsx("button",{className:"embody-view-large-btn",onClick:()=>{console.log("currentVideoUrl",a),Rt.emit("showLargeVideoModal",a)},style:{position:"absolute",top:"8px",right:"8px",zIndex:10},children:""})]}):b.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",padding:"20px"},className:"image2video-placeholder-text",children:""})}),h.length>1&&b.jsxs("div",{className:"image2video-pagination",children:[b.jsx("button",{className:"image2video-pagination-btn",onClick:()=>V(I=>Math.max(I-1,0)),children:""}),b.jsxs("span",{className:"image2video-pagination-text",children:[G+1," / ",D]}),b.jsx("button",{className:"image2video-pagination-btn",onClick:()=>V(I=>Math.min(I+1,D-1)),children:""})]}),c&&b.jsxs("div",{className:"image2video-loading-overlay",children:[b.jsx("div",{className:"image2video-loading-spinner"}),b.jsx("span",{className:"image2video-loading-text",children:"..."})]})]})]}),n&&b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"image2video-prompt-container",children:b.jsx("textarea",{className:"image2video-prompt-textarea",value:y,onChange:I=>{const P=I.target.value;_(P)},placeholder:"..."})}),b.jsx("div",{className:"image2video-prompt-container",children:b.jsx("textarea",{className:"image2video-prompt-textarea",value:x,onChange:I=>{const P=I.target.value;w(P)},placeholder:"..."})}),b.jsxs("div",{className:"image2video-bottom-controls",children:[b.jsxs("div",{className:"image2video-controls-left",children:[b.jsx("div",{className:"image2video-control-group",children:b.jsxs("select",{value:O,onChange:I=>{const P=I.target.value;M(P)},className:"image2video-control-select",children:[b.jsx("option",{value:"fal-ai/kling-video/v2.5-turbo/pro/image-to-video",children:"kling-video/v2.5-turbo"}),b.jsx("option",{value:"fal-ai/kling-video/v2.1/master/image-to-video",children:"kling-video/v2.1/master"})]})}),b.jsx("div",{className:"image2video-control-group",children:b.jsx("input",{type:"number",value:T,onChange:I=>{const P=parseFloat(I.target.value);E(`${P}`)},className:"image2video-control-input",min:"5",max:"30",placeholder:" ()"})}),b.jsx("div",{className:"image2video-control-group",children:b.jsx("input",{type:"number",value:A,onChange:I=>{const P=parseFloat(I.target.value);S(isNaN(P)?.5:P)},className:"image2video-control-input",min:"0",max:"1",placeholder:" (CFG Scale)"})})]}),b.jsxs("div",{className:"image2video-controls-right",children:[b.jsx("button",{className:"image2video-control-button",children:""}),b.jsx("button",{disabled:c,onClick:H,className:"image2video-generate-button",children:""})]})]})]})]})}const l$=({id:t,source:e,target:n,sourceX:s,sourceY:a,targetX:l,targetY:c,sourcePosition:d,targetPosition:h,selected:f,data:p})=>{const[m,y]=k.useMemo(()=>{const C=Vg({sourceX:s,sourceY:a,targetX:l,targetY:c,sourcePosition:d,targetPosition:h}),j=document.createElementNS("http://www.w3.org/2000/svg","path");j.setAttribute("d",C[0]),document.body.appendChild(j);const O=j.getTotalLength();return document.body.removeChild(j),[C[0],O]},[s,a,l,c,d,h]),[_,x]=k.useState(`${t}-animate`),[w,A]=k.useState(!0),S=Math.max(3,Math.min(8,y/5));k.useEffect(()=>{x(`${t}-animate-${Date.now()}`)},[t]);const T={stroke:f?"#ff4088":"#ff0072",strokeWidth:f?3:2,fill:"none",cursor:"pointer",transition:"stroke 0.2s, stroke-width 0.2s"},E={stroke:"white",strokeWidth:"3",fill:"none",strokeDasharray:"12, 8",strokeLinecap:"round",pointerEvents:"none"};return b.jsxs(b.Fragment,{children:[b.jsx("path",{id:t,d:m,className:`exec-edge ${f?"selected":""}`,style:T,onMouseEnter:C=>{C.currentTarget.style.stroke="#ff4088",C.currentTarget.style.strokeWidth="3"},onMouseLeave:C=>{C.currentTarget.style.stroke=f?"#ff4088":"#ff0072",C.currentTarget.style.strokeWidth=f?"3":"2"}}),w&&b.jsx("path",{id:_,d:m,className:"exec-edge-flow",style:{...E,animation:w?`flowAnimation ${S}s linear infinite`:"none",visibility:y>0?"visible":"hidden"}}),b.jsxs("defs",{children:[b.jsx("marker",{id:"exec-arrow",markerWidth:"10",markerHeight:"10",refX:"9",refY:"3",orient:"auto",markerUnits:"strokeWidth",children:b.jsx("path",{d:"M0,0 L0,6 L9,3 z",fill:"#ff0072"})}),b.jsx("style",{type:"text/css",children:`
            @keyframes flowAnimation {
              0% {
                stroke-dashoffset: 200; /*  */
              }
              100% {
                stroke-dashoffset: 0;
              }
            }
            
            .exec-edge-flow {
              /*  */
              filter: drop-shadow(0 0 2px rgba(255, 255, 255, 0.7));
              /*  */
              will-change: stroke-dashoffset;
            }
            
            /*  */
            .exec-edge.selected + .exec-edge-flow {
              stroke-width: 4; /*  */
              filter: drop-shadow(0 0 4px rgba(255, 255, 255, 0.9));
              animation-duration: 3s; /*  */
            }
          `})]})]})},c$=({position:t,visible:e,onClose:n,onAddTxt2ImgNode:s,onAddImage2VideoNode:a,onAddEmbodyNode:l})=>{const{embodyCache:c}=On(),d=k.useRef(null);return k.useEffect(()=>{const h=p=>{d.current&&!d.current.contains(p.target)&&n()},f=p=>{p.key==="Escape"&&n()};return e&&(document.addEventListener("mousedown",h),document.addEventListener("keydown",f)),()=>{document.removeEventListener("mousedown",h),document.removeEventListener("keydown",f)}},[e,n]),e?b.jsx("div",{ref:d,className:"context-menu",style:{position:"fixed",left:`${t.x}px`,top:`${t.y}px`,zIndex:1e3},children:b.jsxs("ul",{children:[b.jsx("li",{onClick:s,children:""}),b.jsx("li",{onClick:a,children:""}),b.jsxs("li",{className:"has-submenu",style:{position:"relative",cursor:"pointer",overflow:"visible"},onMouseEnter:h=>{if(h.currentTarget){const f=h.currentTarget.querySelector(".submenu");f&&(f.style.display="block")}},onMouseLeave:h=>{setTimeout(()=>{if(h.currentTarget){const f=h.currentTarget.querySelector(".submenu"),p=f?.matches(":hover");f&&!p&&(f.style.display="none")}},100)},children:["",b.jsx("ul",{className:"submenu",style:{position:"absolute",left:"100%",top:"0",backgroundColor:"#ffffff",borderRadius:"8px",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.12), 0 2px 6px rgba(0, 0, 0, 0.08)",minWidth:"180px",padding:"6px 0",zIndex:"9999",display:"none",margin:"0 0 0 4px",listStyle:"none",border:"1px solid rgba(0, 0, 0, 0.08)"},onMouseEnter:h=>{h.currentTarget.style.display="block"},onMouseLeave:h=>{h.currentTarget.style.display="none"},children:Object.values(c).length>0?Object.values(c).map(h=>b.jsx("li",{onClick:()=>l(h),style:{padding:"8px 16px",cursor:"pointer"},children:h.name},h.id)):b.jsx("li",{style:{padding:"8px 16px",color:"#999"},children:""})})]})]})}):null};function u$(){const{projectId:t,projectData:e,ep_id:n,editShotId:s,ep_data:a,setEditShotId:l,scDatas:c,shotWithId:d,isLoading_shots_data:h}=On(),[f,p]=k.useState(!0),[m,y]=k.useState([]),[_,x]=k.useState(null),[w,A]=k.useState(!1),[S,T]=k.useState({x:0,y:0}),[E,C]=k.useState(null),[j,O]=k.useState(!1),M=ue=>{l(ue.id)},D=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(ue){var te=Math.random()*16|0,fe=ue==="x"?te:te&3|8;return fe.toString(16)}),q=ue=>{console.log("setupInitNodes:",ue);const te=D();let fe=[],Te=[];fe.push({id:te,type:"txt2imgNode",position:{x:900,y:100},data:{prompt:ue.prompt,num_images:1,aspect_ratio:"16:9",model:"fal-ai/nano-banana/edit",images:[]},selected:_==="0",style:{border:_==="0"?"2px solid #3b82f6":"none"}});for(let De=0;De<ue.embodys.length;De++){const Xe=ue.embodys[De],ct=D();fe.push({id:ct,type:"embodyNode",position:{x:100,y:500*De},data:{id:Xe,selected:_===ct},selected:_===ct,style:{border:_===ct?"2px solid #3b82f6":"none"}}),Te.push({id:D(),source:ct,sourceHandle:"embody_out",target:te,targetHandle:"ref_images",type:"default",data:{}})}y(fe),V(Te)};k.useEffect(()=>{console.log("editShotId:",s),s||console.log("editShotId "),s?(O(!0),je.from("movie_shots").select(`
      *,
      flows(
        *
      )
    `).eq("id",s).single().then(ue=>{O(!1),console.log("shot:",ue.data),ue.data.flows.nodes&&ue.data.flows.edges?(y(JSON.parse(ue.data.flows.nodes)),V(JSON.parse(ue.data.flows.edges))):q(ue.data)}).finally(()=>{O(!1)})):console.log("editShotId  ReactFLow")},[s]);const[G,V]=k.useState([]),F={shotNodeInput:t$,consoleNode:r$,shotNodeOutput:s$,txt2imgNode:i$,embodyNode:a$,image2videoNode:o$},K={execEdge:l$},$=ue=>{V(te=>{if(ue.target==="2"&&te.some(De=>De.target==="2"))return console.warn("ConsoleNode"),te;const fe={...ue,type:ue.sourceHandle==="exec-out"&&ue.targetHandle==="exec-in"?"execEdge":"default"};return hS(fe,te)})},Q=async()=>{if(!s){console.log("editShotId  ");return}if(!E){console.log("reactFlowInstance  ");return}const ue=E.toObject();try{const{data:te,error:fe}=await je.from("flows").update({nodes:JSON.stringify(ue.nodes),edges:JSON.stringify(ue.edges)}).eq("id",s).select()}catch(te){console.error(":",te.message)}};k.useEffect(()=>{if(s){const ue=setInterval(()=>{Q()},3e3);return()=>clearInterval(ue)}},[s,Q]),k.useEffect(()=>{const ue=te=>{if(te.key==="Delete"){const fe=m.filter(De=>De.selected),Te=G.filter(De=>De.selected);if(fe.length>0){const De=m.filter(et=>!et.selected);y(De);const Xe=fe.map(et=>et.id),ct=G.filter(et=>!Xe.includes(et.source)&&!Xe.includes(et.target));V(ct)}else if(Te.length>0){const De=G.filter(Xe=>!Xe.selected);V(De)}}};return window.addEventListener("keydown",ue),()=>window.removeEventListener("keydown",ue)},[m,G]);const R=(ue,te)=>{ue.stopPropagation();const fe=te.id;x(fe),y(Te=>Te.map(De=>({...De,selected:De.id===fe,style:{...De.style,border:De.id===fe?"2px solid #3b82f6":"none"}}))),console.log(":",fe)},U=(ue,te)=>{ue.preventDefault(),te||(T({x:ue.clientX,y:ue.clientY}),A(!0))},B=()=>{A(!1)},L=()=>(m.reduce((te,fe)=>{const Te=parseInt(fe.id);return isNaN(Te)?te:Math.max(te,Te)},0)+1).toString(),H=()=>{if(E){const ue=E.screenToFlowPosition(S),te={id:L(),type:"txt2imgNode",position:{x:ue.x-40,y:ue.y-50},data:{prompt:"",imageUrl:null},selected:!1,style:{border:"none"}};y(fe=>[...fe,te]),console.log(":",te.id)}B()},I=()=>{if(E){const ue=E.screenToFlowPosition(S),te={id:L(),type:"image2videoNode",position:{x:ue.x-40,y:ue.y-50},data:{prompt:"",imageUrl:null},selected:!1,style:{border:"none"}};y(fe=>[...fe,te]),console.log(":",te.id)}B()},P=(ue=null)=>{if(E){const te=E.screenToFlowPosition(S),fe={id:L(),type:"embodyNode",position:{x:te.x-40,y:te.y-50},data:{characterName:ue?.name||"",characterDescription:ue?.prompt||"",id:ue?.id||""},selected:!1,style:{border:"none"}};y(Te=>[...Te,fe]),console.log(":",fe.id)}B()},Y=k.useCallback(ue=>{V(te=>kS(ue,te)),Q()},[Q]),J=k.useCallback(ue=>{y(te=>IS(ue,te)),Q()},[Q]),Z=k.useRef(null),ae=k.useRef(!1),ce=k.useRef(0),he=k.useRef(0),ye=ue=>{ue.preventDefault(),Z.current&&(Z.current.scrollLeft+=ue.deltaY)},pe=ue=>{Z.current&&(ae.current=!0,ce.current=ue.pageX-Z.current.offsetLeft,he.current=Z.current.scrollLeft,Z.current.style.cursor="grabbing")},_e=ue=>{if(!ae.current||!Z.current)return;ue.preventDefault();const fe=(ue.pageX-Z.current.offsetLeft-ce.current)*2;Z.current.scrollLeft=he.current-fe},be=()=>{ae.current=!1,Z.current&&(Z.current.style.cursor="grab")},we=()=>{ae.current=!1,Z.current&&(Z.current.style.cursor="grab")};return k.useEffect(()=>{const ue=Z.current;if(ue)return ue.addEventListener("wheel",ye,{passive:!1}),ue.addEventListener("mousedown",pe),document.addEventListener("mousemove",_e),document.addEventListener("mouseup",be),document.addEventListener("mouseleave",we),()=>{ue.removeEventListener("wheel",ye),ue.removeEventListener("mousedown",pe),document.removeEventListener("mousemove",_e),document.removeEventListener("mouseup",be),document.removeEventListener("mouseleave",we)}},[]),b.jsxs("div",{className:"editor-flow-container",children:[b.jsx("div",{className:"story-nav",ref:Z,children:b.jsx("div",{className:"flow-nav-info",children:c.map(ue=>b.jsxs("div",{className:"flow-nav-sc-card",children:[b.jsx("div",{className:"flow-nav-sc-name",children:b.jsx("p",{children:ue.name})}),b.jsx("div",{className:"flow-nav-sc-content",children:ue.movie_seqs.map(te=>b.jsxs("div",{className:"flow-nav-seq-card",children:[b.jsx("div",{className:"flow-nav-seq-name",children:b.jsx("p",{children:te.name})}),b.jsx("div",{className:"flow-nav-seq-content",children:te.movie_shots.map(fe=>b.jsx("div",{className:`flow-nav-shot-card ${s===fe.id?"nav-selected-shot":""}`,onClick:()=>M(fe),children:b.jsx("div",{className:"flow-nav-shot-thumb",children:b.jsx("img",{src:fe.pic?fe.pic:"./shot_thumb_default.png"})})},fe.id))})]},te.id))})]},ue.id))})}),b.jsxs("div",{className:"flow-editor",children:[j&&b.jsxs("div",{className:"loading-overlay",children:[b.jsx("div",{className:"loading-spinner"}),b.jsx("div",{className:"loading-text",children:"..."})]}),b.jsxs(CL,{nodes:m,edges:G,nodeTypes:F,onInit:C,edgeTypes:K,onConnect:$,onEdgesChange:Y,onNodesChange:J,onNodeClick:R,defaultViewport:{x:0,y:0,zoom:.6},onPaneClick:()=>{x(null),B(),y(ue=>ue.map(te=>({...te,selected:!1,style:{...te.style,border:"none"}})))},onContextMenu:U,attributionPosition:"bottom-right",children:[b.jsxs("div",{className:"flow-project-path",children:[b.jsx("span",{className:"path-item",children:e?.name||""}),b.jsx("span",{className:"path-separator",children:">"}),b.jsxs("span",{className:"path-item",children:["",a?.index||""," "]}),b.jsx("span",{className:"path-separator",children:">"}),b.jsxs("span",{className:"path-item",children:["",c?.find(ue=>ue.movie_seqs?.some(te=>te.movie_shots?.some(fe=>fe.id===s)))?.index||"",""]}),b.jsx("span",{className:"path-separator",children:">"}),b.jsxs("span",{className:"path-item",children:[d[s]?.name||"Shot"," ",String(d[s]?.index||0).padStart(3,"0")]})]}),b.jsx($L,{}),b.jsx(IL,{variant:"dots",gap:20,size:1,strokeColor:"#333"})]}),b.jsx(c$,{position:S,visible:w,onClose:B,onAddTxt2ImgNode:H,onAddImage2VideoNode:I,onAddEmbodyNode:P})]})]})}function Ue(t,e,n,s,a){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}function se(t,e,n,s){if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?s:n==="a"?s.call(t):s?s.value:e.get(t)}let c1=function(){const{crypto:t}=globalThis;if(t?.randomUUID)return c1=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,s=>(+s^n()&15>>+s/4).toString(16))};function rg(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const sg=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};class Ie extends Error{}class Vt extends Ie{constructor(e,n,s,a){super(`${Vt.makeMessage(e,n,s)}`),this.status=e,this.headers=a,this.requestID=a?.get("x-request-id"),this.error=n;const l=n;this.code=l?.code,this.param=l?.param,this.type=l?.type}static makeMessage(e,n,s){const a=n?.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):s;return e&&a?`${e} ${a}`:e?`${e} status code (no body)`:a||"(no status code or body)"}static generate(e,n,s,a){if(!e||!a)return new pf({message:s,cause:sg(n)});const l=n?.error;return e===400?new u1(e,l,s,a):e===401?new d1(e,l,s,a):e===403?new f1(e,l,s,a):e===404?new h1(e,l,s,a):e===409?new m1(e,l,s,a):e===422?new p1(e,l,s,a):e===429?new g1(e,l,s,a):e>=500?new y1(e,l,s,a):new Vt(e,l,s,a)}}class Qn extends Vt{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class pf extends Vt{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class ey extends pf{constructor({message:e}={}){super({message:e??"Request timed out."})}}class u1 extends Vt{}class d1 extends Vt{}class f1 extends Vt{}class h1 extends Vt{}class m1 extends Vt{}class p1 extends Vt{}class g1 extends Vt{}class y1 extends Vt{}class v1 extends Ie{constructor(){super("Could not parse response content as the length limit was reached")}}class _1 extends Ie{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class dl extends Error{constructor(e){super(e)}}const d$=/^[a-z][a-z0-9+.-]*:/i,f$=t=>d$.test(t);let hn=t=>(hn=Array.isArray,hn(t)),wx=hn;function b1(t){return typeof t!="object"?{}:t??{}}function h$(t){if(!t)return!0;for(const e in t)return!1;return!0}function m$(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function yp(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}const p$=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Ie(`${t} must be an integer`);if(e<0)throw new Ie(`${t} must be a positive integer`);return e},g$=t=>{try{return JSON.parse(t)}catch{return}},sc=t=>new Promise(e=>setTimeout(e,t)),Oa="6.9.1",y$=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function v$(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const _$=()=>{const t=v$();if(t==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oa,"X-Stainless-OS":Ax(Deno.build.os),"X-Stainless-Arch":xx(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oa,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(t==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oa,"X-Stainless-OS":Ax(globalThis.process.platform??"unknown"),"X-Stainless-Arch":xx(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const e=b$();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oa,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oa,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function b$(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const s=n.exec(navigator.userAgent);if(s){const a=s[1]||0,l=s[2]||0,c=s[3]||0;return{browser:e,version:`${a}.${l}.${c}`}}}return null}const xx=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",Ax=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let Ex;const w$=()=>Ex??(Ex=_$());function x$(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function w1(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function x1(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return w1({start(){},async pull(n){const{done:s,value:a}=await e.next();s?n.close():n.enqueue(a)},async cancel(){await e.return?.()}})}function A1(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n?.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function A$(t){if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await t[Symbol.asyncIterator]().return?.();return}const e=t.getReader(),n=e.cancel();e.releaseLock(),await n}const E$=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)}),E1="RFC3986",S1=t=>String(t),Sx={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:S1},S$="RFC1738";let ig=(t,e)=>(ig=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),ig(t,e));const fr=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),vp=1024,C$=(t,e,n,s,a)=>{if(t.length===0)return t;let l=t;if(typeof t=="symbol"?l=Symbol.prototype.toString.call(t):typeof t!="string"&&(l=String(t)),n==="iso-8859-1")return escape(l).replace(/%u[0-9a-f]{4}/gi,function(d){return"%26%23"+parseInt(d.slice(2),16)+"%3B"});let c="";for(let d=0;d<l.length;d+=vp){const h=l.length>=vp?l.slice(d,d+vp):l,f=[];for(let p=0;p<h.length;++p){let m=h.charCodeAt(p);if(m===45||m===46||m===95||m===126||m>=48&&m<=57||m>=65&&m<=90||m>=97&&m<=122||a===S$&&(m===40||m===41)){f[f.length]=h.charAt(p);continue}if(m<128){f[f.length]=fr[m];continue}if(m<2048){f[f.length]=fr[192|m>>6]+fr[128|m&63];continue}if(m<55296||m>=57344){f[f.length]=fr[224|m>>12]+fr[128|m>>6&63]+fr[128|m&63];continue}p+=1,m=65536+((m&1023)<<10|h.charCodeAt(p)&1023),f[f.length]=fr[240|m>>18]+fr[128|m>>12&63]+fr[128|m>>6&63]+fr[128|m&63]}c+=f.join("")}return c};function T$(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function Cx(t,e){if(hn(t)){const n=[];for(let s=0;s<t.length;s+=1)n.push(e(t[s]));return n}return e(t)}const C1={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},T1=function(t,e){Array.prototype.push.apply(t,hn(e)?e:[e])};let Tx;const Bt={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:C$,encodeValuesOnly:!1,format:E1,formatter:S1,indices:!1,serializeDate(t){return(Tx??(Tx=Function.prototype.call.bind(Date.prototype.toISOString)))(t)},skipNulls:!1,strictNullHandling:!1};function N$(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const _p={};function N1(t,e,n,s,a,l,c,d,h,f,p,m,y,_,x,w,A,S){let T=t,E=S,C=0,j=!1;for(;(E=E.get(_p))!==void 0&&!j;){const G=E.get(t);if(C+=1,typeof G<"u"){if(G===C)throw new RangeError("Cyclic object value");j=!0}typeof E.get(_p)>"u"&&(C=0)}if(typeof f=="function"?T=f(e,T):T instanceof Date?T=y?.(T):n==="comma"&&hn(T)&&(T=Cx(T,function(G){return G instanceof Date?y?.(G):G})),T===null){if(l)return h&&!w?h(e,Bt.encoder,A,"key",_):e;T=""}if(N$(T)||T$(T)){if(h){const G=w?e:h(e,Bt.encoder,A,"key",_);return[x?.(G)+"="+x?.(h(T,Bt.encoder,A,"value",_))]}return[x?.(e)+"="+x?.(String(T))]}const O=[];if(typeof T>"u")return O;let M;if(n==="comma"&&hn(T))w&&h&&(T=Cx(T,h)),M=[{value:T.length>0?T.join(",")||null:void 0}];else if(hn(f))M=f;else{const G=Object.keys(T);M=p?G.sort(p):G}const D=d?String(e).replace(/\./g,"%2E"):String(e),q=s&&hn(T)&&T.length===1?D+"[]":D;if(a&&hn(T)&&T.length===0)return q+"[]";for(let G=0;G<M.length;++G){const V=M[G],F=typeof V=="object"&&typeof V.value<"u"?V.value:T[V];if(c&&F===null)continue;const K=m&&d?V.replace(/\./g,"%2E"):V,$=hn(T)?typeof n=="function"?n(q,K):q:q+(m?"."+K:"["+K+"]");S.set(t,C);const Q=new WeakMap;Q.set(_p,S),T1(O,N1(F,$,n,s,a,l,c,d,n==="comma"&&w&&hn(T)?null:h,f,p,m,y,_,x,w,A,Q))}return O}function R$(t=Bt){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||Bt.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=E1;if(typeof t.format<"u"){if(!ig(Sx,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const s=Sx[n];let a=Bt.filter;(typeof t.filter=="function"||hn(t.filter))&&(a=t.filter);let l;if(t.arrayFormat&&t.arrayFormat in C1?l=t.arrayFormat:"indices"in t?l=t.indices?"indices":"repeat":l=Bt.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const c=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:Bt.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:Bt.addQueryPrefix,allowDots:c,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:Bt.allowEmptyArrays,arrayFormat:l,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Bt.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?Bt.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:Bt.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:Bt.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:Bt.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:Bt.encodeValuesOnly,filter:a,format:n,formatter:s,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:Bt.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:Bt.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Bt.strictNullHandling}}function j$(t,e={}){let n=t;const s=R$(e);let a,l;typeof s.filter=="function"?(l=s.filter,n=l("",n)):hn(s.filter)&&(l=s.filter,a=l);const c=[];if(typeof n!="object"||n===null)return"";const d=C1[s.arrayFormat],h=d==="comma"&&s.commaRoundTrip;a||(a=Object.keys(n)),s.sort&&a.sort(s.sort);const f=new WeakMap;for(let y=0;y<a.length;++y){const _=a[y];s.skipNulls&&n[_]===null||T1(c,N1(n[_],_,d,h,s.allowEmptyArrays,s.strictNullHandling,s.skipNulls,s.encodeDotInKeys,s.encode?s.encoder:null,s.filter,s.sort,s.allowDots,s.serializeDate,s.format,s.formatter,s.encodeValuesOnly,s.charset,f))}const p=c.join(s.delimiter);let m=s.addQueryPrefix===!0?"?":"";return s.charsetSentinel&&(s.charset==="iso-8859-1"?m+="utf8=%26%2310003%3B&":m+="utf8=%E2%9C%93&"),p.length>0?m+p:""}function O$(t){let e=0;for(const a of t)e+=a.length;const n=new Uint8Array(e);let s=0;for(const a of t)n.set(a,s),s+=a.length;return n}let Nx;function ty(t){let e;return(Nx??(e=new globalThis.TextEncoder,Nx=e.encode.bind(e)))(t)}let Rx;function jx(t){let e;return(Rx??(e=new globalThis.TextDecoder,Rx=e.decode.bind(e)))(t)}var Sn,Cn;class gf{constructor(){Sn.set(this,void 0),Cn.set(this,void 0),Ue(this,Sn,new Uint8Array),Ue(this,Cn,null)}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?ty(e):e;Ue(this,Sn,O$([se(this,Sn,"f"),n]));const s=[];let a;for(;(a=I$(se(this,Sn,"f"),se(this,Cn,"f")))!=null;){if(a.carriage&&se(this,Cn,"f")==null){Ue(this,Cn,a.index);continue}if(se(this,Cn,"f")!=null&&(a.index!==se(this,Cn,"f")+1||a.carriage)){s.push(jx(se(this,Sn,"f").subarray(0,se(this,Cn,"f")-1))),Ue(this,Sn,se(this,Sn,"f").subarray(se(this,Cn,"f"))),Ue(this,Cn,null);continue}const l=se(this,Cn,"f")!==null?a.preceding-1:a.preceding,c=jx(se(this,Sn,"f").subarray(0,l));s.push(c),Ue(this,Sn,se(this,Sn,"f").subarray(a.index)),Ue(this,Cn,null)}return s}flush(){return se(this,Sn,"f").length?this.decode(`
`):[]}}Sn=new WeakMap,Cn=new WeakMap;gf.NEWLINE_CHARS=new Set([`
`,"\r"]);gf.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function I$(t,e){for(let a=e??0;a<t.length;a++){if(t[a]===10)return{preceding:a,index:a+1,carriage:!1};if(t[a]===13)return{preceding:a,index:a+1,carriage:!0}}return null}function k$(t){for(let s=0;s<t.length-1;s++){if(t[s]===10&&t[s+1]===10||t[s]===13&&t[s+1]===13)return s+2;if(t[s]===13&&t[s+1]===10&&s+3<t.length&&t[s+2]===13&&t[s+3]===10)return s+4}return-1}const Pd={off:0,error:200,warn:300,info:400,debug:500},Ox=(t,e,n)=>{if(t){if(m$(Pd,t))return t;Qt(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(Pd))}`)}};function fl(){}function Ju(t,e,n){return!e||Pd[t]>Pd[n]?fl:e[t].bind(e)}const M$={error:fl,warn:fl,info:fl,debug:fl};let Ix=new WeakMap;function Qt(t){const e=t.logger,n=t.logLevel??"off";if(!e)return M$;const s=Ix.get(e);if(s&&s[0]===n)return s[1];const a={error:Ju("error",e,n),warn:Ju("warn",e,n),info:Ju("info",e,n),debug:Ju("debug",e,n)};return Ix.set(e,[n,a]),a}const di=t=>(t.options&&(t.options={...t.options},delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);var al;class pr{constructor(e,n,s){this.iterator=e,al.set(this,void 0),this.controller=n,Ue(this,al,s)}static fromSSEResponse(e,n,s){let a=!1;const l=s?Qt(s):console;async function*c(){if(a)throw new Ie("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let d=!1;try{for await(const h of D$(e,n))if(!d){if(h.data.startsWith("[DONE]")){d=!0;continue}if(h.event===null||!h.event.startsWith("thread.")){let f;try{f=JSON.parse(h.data)}catch(p){throw l.error("Could not parse message into JSON:",h.data),l.error("From chunk:",h.raw),p}if(f&&f.error)throw new Vt(void 0,f.error,void 0,e.headers);yield f}else{let f;try{f=JSON.parse(h.data)}catch(p){throw console.error("Could not parse message into JSON:",h.data),console.error("From chunk:",h.raw),p}if(h.event=="error")throw new Vt(void 0,f.error,f.message,void 0);yield{event:h.event,data:f}}}d=!0}catch(h){if(rg(h))return;throw h}finally{d||n.abort()}}return new pr(c,n,s)}static fromReadableStream(e,n,s){let a=!1;async function*l(){const d=new gf,h=A1(e);for await(const f of h)for(const p of d.decode(f))yield p;for(const f of d.flush())yield f}async function*c(){if(a)throw new Ie("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let d=!1;try{for await(const h of l())d||h&&(yield JSON.parse(h));d=!0}catch(h){if(rg(h))return;throw h}finally{d||n.abort()}}return new pr(c,n,s)}[(al=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const e=[],n=[],s=this.iterator(),a=l=>({next:()=>{if(l.length===0){const c=s.next();e.push(c),n.push(c)}return l.shift()}});return[new pr(()=>a(e),this.controller,se(this,al,"f")),new pr(()=>a(n),this.controller,se(this,al,"f"))]}toReadableStream(){const e=this;let n;return w1({async start(){n=e[Symbol.asyncIterator]()},async pull(s){try{const{value:a,done:l}=await n.next();if(l)return s.close();const c=ty(JSON.stringify(a)+`
`);s.enqueue(c)}catch(a){s.error(a)}},async cancel(){await n.return?.()}})}}async function*D$(t,e){if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Ie("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Ie("Attempted to iterate over a response with no body");const n=new U$,s=new gf,a=A1(t.body);for await(const l of B$(a))for(const c of s.decode(l)){const d=n.decode(c);d&&(yield d)}for(const l of s.flush()){const c=n.decode(l);c&&(yield c)}}async function*B$(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const s=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?ty(n):n;let a=new Uint8Array(e.length+s.length);a.set(e),a.set(s,e.length),e=a;let l;for(;(l=k$(e))!==-1;)yield e.slice(0,l),e=e.slice(l)}e.length>0&&(yield e)}class U${constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const l={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],l}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,s,a]=L$(e,":");return a.startsWith(" ")&&(a=a.substring(1)),n==="event"?this.event=a:n==="data"&&this.data.push(a),null}}function L$(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}async function R1(t,e){const{response:n,requestLogID:s,retryOfRequestLogID:a,startTime:l}=e,c=await(async()=>{if(e.options.stream)return Qt(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):pr.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const h=n.headers.get("content-type")?.split(";")[0]?.trim();if(h?.includes("application/json")||h?.endsWith("+json")){const m=await n.json();return j1(m,n)}return await n.text()})();return Qt(t).debug(`[${s}] response parsed`,di({retryOfRequestLogID:a,url:n.url,status:n.status,body:c,durationMs:Date.now()-l})),c}function j1(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}var hl;class yf extends Promise{constructor(e,n,s=R1){super(a=>{a(null)}),this.responsePromise=n,this.parseResponse=s,hl.set(this,void 0),Ue(this,hl,e)}_thenUnwrap(e){return new yf(se(this,hl,"f"),this.responsePromise,async(n,s)=>j1(e(await this.parseResponse(n,s),s),s.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(se(this,hl,"f"),e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}hl=new WeakMap;var Zu;class ny{constructor(e,n,s,a){Zu.set(this,void 0),Ue(this,Zu,e),this.options=a,this.response=n,this.body=s}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const e=this.nextPageRequestOptions();if(!e)throw new Ie("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await se(this,Zu,"f").requestAPIList(this.constructor,e)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Zu=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class $$ extends yf{constructor(e,n,s){super(e,n,async(a,l)=>new s(a,l.response,await R1(a,l),l.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}class vf extends ny{constructor(e,n,s,a){super(e,n,s,a),this.data=s.data||[],this.object=s.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class jt extends ny{constructor(e,n,s,a){super(e,n,s,a),this.data=s.data||[],this.has_more=s.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const e=this.getPaginatedItems(),n=e[e.length-1]?.id;return n?{...this.options,query:{...b1(this.options.query),after:n}}:null}}class Hd extends ny{constructor(e,n,s,a){super(e,n,s,a),this.data=s.data||[],this.has_more=s.has_more||!1,this.last_id=s.last_id||""}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const e=this.last_id;return e?{...this.options,query:{...b1(this.options.query),after:e}}:null}}const O1=()=>{if(typeof File>"u"){const{process:t}=globalThis,e=typeof t?.versions?.node=="string"&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(e?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Cl(t,e,n){return O1(),new File(t,e??"unknown_file",n)}function md(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const ry=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",kx=async(t,e)=>ag(t.body)?{...t,body:await I1(t.body,e)}:t,Ci=async(t,e)=>({...t,body:await I1(t.body,e)}),Mx=new WeakMap;function z$(t){const e=typeof t=="function"?t:t.fetch,n=Mx.get(e);if(n)return n;const s=(async()=>{try{const a="Response"in e?e.Response:(await e("data:,")).constructor,l=new FormData;return l.toString()!==await new a(l).text()}catch{return!0}})();return Mx.set(e,s),s}const I1=async(t,e)=>{if(!await z$(e))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const n=new FormData;return await Promise.all(Object.entries(t||{}).map(([s,a])=>og(n,s,a))),n},k1=t=>t instanceof Blob&&"name"in t,P$=t=>typeof t=="object"&&t!==null&&(t instanceof Response||ry(t)||k1(t)),ag=t=>{if(P$(t))return!0;if(Array.isArray(t))return t.some(ag);if(t&&typeof t=="object"){for(const e in t)if(ag(t[e]))return!0}return!1},og=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(n instanceof Response)t.append(e,Cl([await n.blob()],md(n)));else if(ry(n))t.append(e,Cl([await new Response(x1(n)).blob()],md(n)));else if(k1(n))t.append(e,n,md(n));else if(Array.isArray(n))await Promise.all(n.map(s=>og(t,e+"[]",s)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([s,a])=>og(t,`${e}[${s}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}},M1=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",H$=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&M1(t),q$=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function Q$(t,e,n){if(O1(),t=await t,H$(t))return t instanceof File?t:Cl([await t.arrayBuffer()],t.name);if(q$(t)){const a=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),Cl(await lg(a),e,n)}const s=await lg(t);if(e||(e=md(t)),!n?.type){const a=s.find(l=>typeof l=="object"&&"type"in l&&l.type);typeof a=="string"&&(n={...n,type:a})}return Cl(s,e,n)}async function lg(t){let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(M1(t))e.push(t instanceof Blob?t:await t.arrayBuffer());else if(ry(t))for await(const n of t)e.push(...await lg(n));else{const n=t?.constructor?.name;throw new Error(`Unexpected data type: ${typeof t}${n?`; constructor: ${n}`:""}${F$(t)}`)}return e}function F$(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}class Ne{constructor(e){this._client=e}}function D1(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Dx=Object.freeze(Object.create(null)),V$=(t=D1)=>function(n,...s){if(n.length===1)return n[0];let a=!1;const l=[],c=n.reduce((p,m,y)=>{/[?#]/.test(m)&&(a=!0);const _=s[y];let x=(a?encodeURIComponent:t)(""+_);return y!==s.length&&(_==null||typeof _=="object"&&_.toString===Object.getPrototypeOf(Object.getPrototypeOf(_.hasOwnProperty??Dx)??Dx)?.toString)&&(x=_+"",l.push({start:p.length+m.length,length:x.length,error:`Value of type ${Object.prototype.toString.call(_).slice(8,-1)} is not a valid path parameter`})),p+m+(y===s.length?"":x)},""),d=c.split(/[?#]/,1)[0],h=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let f;for(;(f=h.exec(d))!==null;)l.push({start:f.index,length:f[0].length,error:`Value "${f[0]}" can't be safely passed as a path parameter`});if(l.sort((p,m)=>p.start-m.start),l.length>0){let p=0;const m=l.reduce((y,_)=>{const x=" ".repeat(_.start-p),w="^".repeat(_.length);return p=_.start+_.length,y+x+w},"");throw new Ie(`Path parameters result in path with invalid segments:
${l.map(y=>y.error).join(`
`)}
${c}
${m}`)}return c},ve=V$(D1);let B1=class extends Ne{list(e,n={},s){return this._client.getAPIList(ve`/chat/completions/${e}/messages`,jt,{query:n,...s})}};function qd(t){return t!==void 0&&"function"in t&&t.function!==void 0}function sy(t){return t?.$brand==="auto-parseable-response-format"}function ic(t){return t?.$brand==="auto-parseable-tool"}function G$(t,e){return!e||!U1(e)?{...t,choices:t.choices.map(n=>(L1(n.message.tool_calls),{...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:iy(t,e)}function iy(t,e){const n=t.choices.map(s=>{if(s.finish_reason==="length")throw new v1;if(s.finish_reason==="content_filter")throw new _1;return L1(s.message.tool_calls),{...s,message:{...s.message,...s.message.tool_calls?{tool_calls:s.message.tool_calls?.map(a=>X$(e,a))??void 0}:void 0,parsed:s.message.content&&!s.message.refusal?Y$(e,s.message.content):null}}});return{...t,choices:n}}function Y$(t,e){return t.response_format?.type!=="json_schema"?null:t.response_format?.type==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function X$(t,e){const n=t.tools?.find(s=>qd(s)&&s.function?.name===e.function.name);return{...e,function:{...e.function,parsed_arguments:ic(n)?n.$parseRaw(e.function.arguments):n?.function.strict?JSON.parse(e.function.arguments):null}}}function K$(t,e){if(!t||!("tools"in t)||!t.tools)return!1;const n=t.tools?.find(s=>qd(s)&&s.function?.name===e.function.name);return qd(n)&&(ic(n)||n?.function.strict||!1)}function U1(t){return sy(t.response_format)?!0:t.tools?.some(e=>ic(e)||e.type==="function"&&e.function.strict===!0)??!1}function L1(t){for(const e of t||[])if(e.type!=="function")throw new Ie(`Currently only \`function\` tool calls are supported; Received \`${e.type}\``)}function W$(t){for(const e of t??[]){if(e.type!=="function")throw new Ie(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new Ie(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}const Qd=t=>t?.role==="assistant",$1=t=>t?.role==="tool";var cg,pd,gd,ml,pl,yd,gl,Fr,yl,Fd,Vd,Ia,z1;class ay{constructor(){cg.add(this),this.controller=new AbortController,pd.set(this,void 0),gd.set(this,()=>{}),ml.set(this,()=>{}),pl.set(this,void 0),yd.set(this,()=>{}),gl.set(this,()=>{}),Fr.set(this,{}),yl.set(this,!1),Fd.set(this,!1),Vd.set(this,!1),Ia.set(this,!1),Ue(this,pd,new Promise((e,n)=>{Ue(this,gd,e,"f"),Ue(this,ml,n,"f")})),Ue(this,pl,new Promise((e,n)=>{Ue(this,yd,e,"f"),Ue(this,gl,n,"f")})),se(this,pd,"f").catch(()=>{}),se(this,pl,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},se(this,cg,"m",z1).bind(this))},0)}_connected(){this.ended||(se(this,gd,"f").call(this),this._emit("connect"))}get ended(){return se(this,yl,"f")}get errored(){return se(this,Fd,"f")}get aborted(){return se(this,Vd,"f")}abort(){this.controller.abort()}on(e,n){return(se(this,Fr,"f")[e]||(se(this,Fr,"f")[e]=[])).push({listener:n}),this}off(e,n){const s=se(this,Fr,"f")[e];if(!s)return this;const a=s.findIndex(l=>l.listener===n);return a>=0&&s.splice(a,1),this}once(e,n){return(se(this,Fr,"f")[e]||(se(this,Fr,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,s)=>{Ue(this,Ia,!0),e!=="error"&&this.once("error",s),this.once(e,n)})}async done(){Ue(this,Ia,!0),await se(this,pl,"f")}_emit(e,...n){if(se(this,yl,"f"))return;e==="end"&&(Ue(this,yl,!0),se(this,yd,"f").call(this));const s=se(this,Fr,"f")[e];if(s&&(se(this,Fr,"f")[e]=s.filter(a=>!a.once),s.forEach(({listener:a})=>a(...n))),e==="abort"){const a=n[0];!se(this,Ia,"f")&&!s?.length&&Promise.reject(a),se(this,ml,"f").call(this,a),se(this,gl,"f").call(this,a),this._emit("end");return}if(e==="error"){const a=n[0];!se(this,Ia,"f")&&!s?.length&&Promise.reject(a),se(this,ml,"f").call(this,a),se(this,gl,"f").call(this,a),this._emit("end")}}_emitFinal(){}}pd=new WeakMap,gd=new WeakMap,ml=new WeakMap,pl=new WeakMap,yd=new WeakMap,gl=new WeakMap,Fr=new WeakMap,yl=new WeakMap,Fd=new WeakMap,Vd=new WeakMap,Ia=new WeakMap,cg=new WeakSet,z1=function(e){if(Ue(this,Fd,!0),e instanceof Error&&e.name==="AbortError"&&(e=new Qn),e instanceof Qn)return Ue(this,Vd,!0),this._emit("abort",e);if(e instanceof Ie)return this._emit("error",e);if(e instanceof Error){const n=new Ie(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new Ie(String(e)))};function J$(t){return typeof t.parse=="function"}var tn,ug,Gd,dg,fg,hg,P1,H1;const Z$=10;class q1 extends ay{constructor(){super(...arguments),tn.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=e.choices[0]?.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),$1(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(Qd(e)&&e.tool_calls)for(const s of e.tool_calls)s.type==="function"&&this._emit("functionToolCall",s.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new Ie("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),se(this,tn,"m",ug).call(this)}async finalMessage(){return await this.done(),se(this,tn,"m",Gd).call(this)}async finalFunctionToolCall(){return await this.done(),se(this,tn,"m",dg).call(this)}async finalFunctionToolCallResult(){return await this.done(),se(this,tn,"m",fg).call(this)}async totalUsage(){return await this.done(),se(this,tn,"m",hg).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=se(this,tn,"m",Gd).call(this);n&&this._emit("finalMessage",n);const s=se(this,tn,"m",ug).call(this);s&&this._emit("finalContent",s);const a=se(this,tn,"m",dg).call(this);a&&this._emit("finalFunctionToolCall",a);const l=se(this,tn,"m",fg).call(this);l!=null&&this._emit("finalFunctionToolCallResult",l),this._chatCompletions.some(c=>c.usage)&&this._emit("totalUsage",se(this,tn,"m",hg).call(this))}async _createChatCompletion(e,n,s){const a=s?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),se(this,tn,"m",P1).call(this,n);const l=await e.chat.completions.create({...n,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addChatCompletion(iy(l,n))}async _runChatCompletion(e,n,s){for(const a of n.messages)this._addMessage(a,!1);return await this._createChatCompletion(e,n,s)}async _runTools(e,n,s){const a="tool",{tool_choice:l="auto",stream:c,...d}=n,h=typeof l!="string"&&l.type==="function"&&l?.function?.name,{maxChatCompletions:f=Z$}=s||{},p=n.tools.map(_=>{if(ic(_)){if(!_.$callback)throw new Ie("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:_.$callback,name:_.function.name,description:_.function.description||"",parameters:_.function.parameters,parse:_.$parseRaw,strict:!0}}}return _}),m={};for(const _ of p)_.type==="function"&&(m[_.function.name||_.function.function.name]=_.function);const y="tools"in n?p.map(_=>_.type==="function"?{type:"function",function:{name:_.function.name||_.function.function.name,parameters:_.function.parameters,description:_.function.description,strict:_.function.strict}}:_):void 0;for(const _ of n.messages)this._addMessage(_,!1);for(let _=0;_<f;++_){const w=(await this._createChatCompletion(e,{...d,tool_choice:l,tools:y,messages:[...this.messages]},s)).choices[0]?.message;if(!w)throw new Ie("missing message in ChatCompletion response");if(!w.tool_calls?.length)return;for(const A of w.tool_calls){if(A.type!=="function")continue;const S=A.id,{name:T,arguments:E}=A.function,C=m[T];if(C){if(h&&h!==T){const D=`Invalid tool_call: ${JSON.stringify(T)}. ${JSON.stringify(h)} requested. Please try again`;this._addMessage({role:a,tool_call_id:S,content:D});continue}}else{const D=`Invalid tool_call: ${JSON.stringify(T)}. Available options are: ${Object.keys(m).map(q=>JSON.stringify(q)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:S,content:D});continue}let j;try{j=J$(C)?await C.parse(E):E}catch(D){const q=D instanceof Error?D.message:String(D);this._addMessage({role:a,tool_call_id:S,content:q});continue}const O=await C.function(j,this),M=se(this,tn,"m",H1).call(this,O);if(this._addMessage({role:a,tool_call_id:S,content:M}),h)return}}}}tn=new WeakSet,ug=function(){return se(this,tn,"m",Gd).call(this).content??null},Gd=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(Qd(n))return{...n,content:n.content??null,refusal:n.refusal??null}}throw new Ie("stream ended without producing a ChatCompletionMessage with role=assistant")},dg=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(Qd(n)&&n?.tool_calls?.length)return n.tool_calls.filter(s=>s.type==="function").at(-1)?.function}},fg=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if($1(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(s=>s.role==="assistant"&&s.tool_calls?.some(a=>a.type==="function"&&a.id===n.tool_call_id)))return n.content}},hg=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},P1=function(e){if(e.n!=null&&e.n>1)throw new Ie("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},H1=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class oy extends q1{static runTools(e,n,s){const a=new oy,l={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(e,n,l)),a}_addMessage(e,n=!0){super._addMessage(e,n),Qd(e)&&e.content&&this._emit("content",e.content)}}const Q1=1,F1=2,V1=4,G1=8,Y1=16,X1=32,K1=64,W1=128,J1=256,Z1=W1|J1,eC=Y1|X1|Z1|K1,tC=Q1|F1|eC,nC=V1|G1,ez=tC|nC,Lt={STR:Q1,NUM:F1,ARR:V1,OBJ:G1,NULL:Y1,BOOL:X1,NAN:K1,INFINITY:W1,MINUS_INFINITY:J1,INF:Z1,SPECIAL:eC,ATOM:tC,COLLECTION:nC,ALL:ez};class tz extends Error{}class nz extends Error{}function rz(t,e=Lt.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return sz(t.trim(),e)}const sz=(t,e)=>{const n=t.length;let s=0;const a=y=>{throw new tz(`${y} at position ${s}`)},l=y=>{throw new nz(`${y} at position ${s}`)},c=()=>(m(),s>=n&&a("Unexpected end of input"),t[s]==='"'?d():t[s]==="{"?h():t[s]==="["?f():t.substring(s,s+4)==="null"||Lt.NULL&e&&n-s<4&&"null".startsWith(t.substring(s))?(s+=4,null):t.substring(s,s+4)==="true"||Lt.BOOL&e&&n-s<4&&"true".startsWith(t.substring(s))?(s+=4,!0):t.substring(s,s+5)==="false"||Lt.BOOL&e&&n-s<5&&"false".startsWith(t.substring(s))?(s+=5,!1):t.substring(s,s+8)==="Infinity"||Lt.INFINITY&e&&n-s<8&&"Infinity".startsWith(t.substring(s))?(s+=8,1/0):t.substring(s,s+9)==="-Infinity"||Lt.MINUS_INFINITY&e&&1<n-s&&n-s<9&&"-Infinity".startsWith(t.substring(s))?(s+=9,-1/0):t.substring(s,s+3)==="NaN"||Lt.NAN&e&&n-s<3&&"NaN".startsWith(t.substring(s))?(s+=3,NaN):p()),d=()=>{const y=s;let _=!1;for(s++;s<n&&(t[s]!=='"'||_&&t[s-1]==="\\");)_=t[s]==="\\"?!_:!1,s++;if(t.charAt(s)=='"')try{return JSON.parse(t.substring(y,++s-Number(_)))}catch(x){l(String(x))}else if(Lt.STR&e)try{return JSON.parse(t.substring(y,s-Number(_))+'"')}catch{return JSON.parse(t.substring(y,t.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},h=()=>{s++,m();const y={};try{for(;t[s]!=="}";){if(m(),s>=n&&Lt.OBJ&e)return y;const _=d();m(),s++;try{const x=c();Object.defineProperty(y,_,{value:x,writable:!0,enumerable:!0,configurable:!0})}catch(x){if(Lt.OBJ&e)return y;throw x}m(),t[s]===","&&s++}}catch{if(Lt.OBJ&e)return y;a("Expected '}' at end of object")}return s++,y},f=()=>{s++;const y=[];try{for(;t[s]!=="]";)y.push(c()),m(),t[s]===","&&s++}catch{if(Lt.ARR&e)return y;a("Expected ']' at end of array")}return s++,y},p=()=>{if(s===0){t==="-"&&Lt.NUM&e&&a("Not sure what '-' is");try{return JSON.parse(t)}catch(_){if(Lt.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}l(String(_))}}const y=s;for(t[s]==="-"&&s++;t[s]&&!",]}".includes(t[s]);)s++;s==n&&!(Lt.NUM&e)&&a("Unterminated number literal");try{return JSON.parse(t.substring(y,s))}catch{t.substring(y,s)==="-"&&Lt.NUM&e&&a("Not sure what '-' is");try{return JSON.parse(t.substring(y,t.lastIndexOf("e")))}catch(x){l(String(x))}}},m=()=>{for(;s<n&&` 
\r	`.includes(t[s]);)s++};return c()},Bx=t=>rz(t,Lt.ALL^Lt.NUM);var Mt,Qr,Ca,Is,bp,ed,wp,xp,Ap,td,Ep,Ux;class Ql extends q1{constructor(e){super(),Mt.add(this),Qr.set(this,void 0),Ca.set(this,void 0),Is.set(this,void 0),Ue(this,Qr,e),Ue(this,Ca,[])}get currentChatCompletionSnapshot(){return se(this,Is,"f")}static fromReadableStream(e){const n=new Ql(null);return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,s){const a=new Ql(n);return a._run(()=>a._runChatCompletion(e,{...n,stream:!0},{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(e,n,s){super._createChatCompletion;const a=s?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),se(this,Mt,"m",bp).call(this);const l=await e.chat.completions.create({...n,stream:!0},{...s,signal:this.controller.signal});this._connected();for await(const c of l)se(this,Mt,"m",wp).call(this,c);if(l.controller.signal?.aborted)throw new Qn;return this._addChatCompletion(se(this,Mt,"m",td).call(this))}async _fromReadableStream(e,n){const s=n?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),se(this,Mt,"m",bp).call(this),this._connected();const a=pr.fromReadableStream(e,this.controller);let l;for await(const c of a)l&&l!==c.id&&this._addChatCompletion(se(this,Mt,"m",td).call(this)),se(this,Mt,"m",wp).call(this,c),l=c.id;if(a.controller.signal?.aborted)throw new Qn;return this._addChatCompletion(se(this,Mt,"m",td).call(this))}[(Qr=new WeakMap,Ca=new WeakMap,Is=new WeakMap,Mt=new WeakSet,bp=function(){this.ended||Ue(this,Is,void 0)},ed=function(n){let s=se(this,Ca,"f")[n.index];return s||(s={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},se(this,Ca,"f")[n.index]=s,s)},wp=function(n){if(this.ended)return;const s=se(this,Mt,"m",Ux).call(this,n);this._emit("chunk",n,s);for(const a of n.choices){const l=s.choices[a.index];a.delta.content!=null&&l.message?.role==="assistant"&&l.message?.content&&(this._emit("content",a.delta.content,l.message.content),this._emit("content.delta",{delta:a.delta.content,snapshot:l.message.content,parsed:l.message.parsed})),a.delta.refusal!=null&&l.message?.role==="assistant"&&l.message?.refusal&&this._emit("refusal.delta",{delta:a.delta.refusal,snapshot:l.message.refusal}),a.logprobs?.content!=null&&l.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:a.logprobs?.content,snapshot:l.logprobs?.content??[]}),a.logprobs?.refusal!=null&&l.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:a.logprobs?.refusal,snapshot:l.logprobs?.refusal??[]});const c=se(this,Mt,"m",ed).call(this,l);l.finish_reason&&(se(this,Mt,"m",Ap).call(this,l),c.current_tool_call_index!=null&&se(this,Mt,"m",xp).call(this,l,c.current_tool_call_index));for(const d of a.delta.tool_calls??[])c.current_tool_call_index!==d.index&&(se(this,Mt,"m",Ap).call(this,l),c.current_tool_call_index!=null&&se(this,Mt,"m",xp).call(this,l,c.current_tool_call_index)),c.current_tool_call_index=d.index;for(const d of a.delta.tool_calls??[]){const h=l.message.tool_calls?.[d.index];h?.type&&(h?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:h.function?.name,index:d.index,arguments:h.function.arguments,parsed_arguments:h.function.parsed_arguments,arguments_delta:d.function?.arguments??""}):(h?.type,void 0))}}},xp=function(n,s){if(se(this,Mt,"m",ed).call(this,n).done_tool_calls.has(s))return;const l=n.message.tool_calls?.[s];if(!l)throw new Error("no tool call snapshot");if(!l.type)throw new Error("tool call snapshot missing `type`");if(l.type==="function"){const c=se(this,Qr,"f")?.tools?.find(d=>qd(d)&&d.function.name===l.function.name);this._emit("tool_calls.function.arguments.done",{name:l.function.name,index:s,arguments:l.function.arguments,parsed_arguments:ic(c)?c.$parseRaw(l.function.arguments):c?.function.strict?JSON.parse(l.function.arguments):null})}else l.type},Ap=function(n){const s=se(this,Mt,"m",ed).call(this,n);if(n.message.content&&!s.content_done){s.content_done=!0;const a=se(this,Mt,"m",Ep).call(this);this._emit("content.done",{content:n.message.content,parsed:a?a.$parseRaw(n.message.content):null})}n.message.refusal&&!s.refusal_done&&(s.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),n.logprobs?.content&&!s.logprobs_content_done&&(s.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),n.logprobs?.refusal&&!s.logprobs_refusal_done&&(s.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},td=function(){if(this.ended)throw new Ie("stream has ended, this shouldn't happen");const n=se(this,Is,"f");if(!n)throw new Ie("request ended without sending any chunks");return Ue(this,Is,void 0),Ue(this,Ca,[]),iz(n,se(this,Qr,"f"))},Ep=function(){const n=se(this,Qr,"f")?.response_format;return sy(n)?n:null},Ux=function(n){var s,a,l,c;let d=se(this,Is,"f");const{choices:h,...f}=n;d?Object.assign(d,f):d=Ue(this,Is,{...f,choices:[]});for(const{delta:p,finish_reason:m,index:y,logprobs:_=null,...x}of n.choices){let w=d.choices[y];if(w||(w=d.choices[y]={finish_reason:m,index:y,message:{},logprobs:_,...x}),_)if(!w.logprobs)w.logprobs=Object.assign({},_);else{const{content:O,refusal:M,...D}=_;Object.assign(w.logprobs,D),O&&((s=w.logprobs).content??(s.content=[]),w.logprobs.content.push(...O)),M&&((a=w.logprobs).refusal??(a.refusal=[]),w.logprobs.refusal.push(...M))}if(m&&(w.finish_reason=m,se(this,Qr,"f")&&U1(se(this,Qr,"f")))){if(m==="length")throw new v1;if(m==="content_filter")throw new _1}if(Object.assign(w,x),!p)continue;const{content:A,refusal:S,function_call:T,role:E,tool_calls:C,...j}=p;if(Object.assign(w.message,j),S&&(w.message.refusal=(w.message.refusal||"")+S),E&&(w.message.role=E),T&&(w.message.function_call?(T.name&&(w.message.function_call.name=T.name),T.arguments&&((l=w.message.function_call).arguments??(l.arguments=""),w.message.function_call.arguments+=T.arguments)):w.message.function_call=T),A&&(w.message.content=(w.message.content||"")+A,!w.message.refusal&&se(this,Mt,"m",Ep).call(this)&&(w.message.parsed=Bx(w.message.content))),C){w.message.tool_calls||(w.message.tool_calls=[]);for(const{index:O,id:M,type:D,function:q,...G}of C){const V=(c=w.message.tool_calls)[O]??(c[O]={});Object.assign(V,G),M&&(V.id=M),D&&(V.type=D),q&&(V.function??(V.function={name:q.name??"",arguments:""})),q?.name&&(V.function.name=q.name),q?.arguments&&(V.function.arguments+=q.arguments,K$(se(this,Qr,"f"),V)&&(V.function.parsed_arguments=Bx(V.function.arguments)))}}}return d},Symbol.asyncIterator)](){const e=[],n=[];let s=!1;return this.on("chunk",a=>{const l=n.shift();l?l.resolve(a):e.push(a)}),this.on("end",()=>{s=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{s=!0;for(const l of n)l.reject(a);n.length=0}),this.on("error",a=>{s=!0;for(const l of n)l.reject(a);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((l,c)=>n.push({resolve:l,reject:c})).then(l=>l?{value:l,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new pr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function iz(t,e){const{id:n,choices:s,created:a,model:l,system_fingerprint:c,...d}=t,h={...d,id:n,choices:s.map(({message:f,finish_reason:p,index:m,logprobs:y,..._})=>{if(!p)throw new Ie(`missing finish_reason for choice ${m}`);const{content:x=null,function_call:w,tool_calls:A,...S}=f,T=f.role;if(!T)throw new Ie(`missing role for choice ${m}`);if(w){const{arguments:E,name:C}=w;if(E==null)throw new Ie(`missing function_call.arguments for choice ${m}`);if(!C)throw new Ie(`missing function_call.name for choice ${m}`);return{..._,message:{content:x,function_call:{arguments:E,name:C},role:T,refusal:f.refusal??null},finish_reason:p,index:m,logprobs:y}}return A?{..._,index:m,finish_reason:p,logprobs:y,message:{...S,role:T,content:x,refusal:f.refusal??null,tool_calls:A.map((E,C)=>{const{function:j,type:O,id:M,...D}=E,{arguments:q,name:G,...V}=j||{};if(M==null)throw new Ie(`missing choices[${m}].tool_calls[${C}].id
${nd(t)}`);if(O==null)throw new Ie(`missing choices[${m}].tool_calls[${C}].type
${nd(t)}`);if(G==null)throw new Ie(`missing choices[${m}].tool_calls[${C}].function.name
${nd(t)}`);if(q==null)throw new Ie(`missing choices[${m}].tool_calls[${C}].function.arguments
${nd(t)}`);return{...D,id:M,type:O,function:{...V,name:G,arguments:q}}})}}:{..._,message:{...S,content:x,role:T,refusal:f.refusal??null},finish_reason:p,index:m,logprobs:y}}),created:a,model:l,object:"chat.completion",...c?{system_fingerprint:c}:{}};return G$(h,e)}function nd(t){return JSON.stringify(t)}class Yd extends Ql{static fromReadableStream(e){const n=new Yd(null);return n._run(()=>n._fromReadableStream(e)),n}static runTools(e,n,s){const a=new Yd(n),l={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(e,n,l)),a}}let ly=class extends Ne{constructor(){super(...arguments),this.messages=new B1(this._client)}create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}retrieve(e,n){return this._client.get(ve`/chat/completions/${e}`,n)}update(e,n,s){return this._client.post(ve`/chat/completions/${e}`,{body:n,...s})}list(e={},n){return this._client.getAPIList("/chat/completions",jt,{query:e,...n})}delete(e,n){return this._client.delete(ve`/chat/completions/${e}`,n)}parse(e,n){return W$(e.tools),this._client.chat.completions.create(e,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(s=>iy(s,e))}runTools(e,n){return e.stream?Yd.runTools(this._client,e,n):oy.runTools(this._client,e,n)}stream(e,n){return Ql.createChatCompletion(this._client,e,n)}};ly.Messages=B1;class cy extends Ne{constructor(){super(...arguments),this.completions=new ly(this._client)}}cy.Completions=ly;const rC=Symbol("brand.privateNullableHeaders");function*az(t){if(!t)return;if(rC in t){const{values:s,nulls:a}=t;yield*s.entries();for(const l of a)yield[l,null];return}let e=!1,n;t instanceof Headers?n=t.entries():wx(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let s of n){const a=s[0];if(typeof a!="string")throw new TypeError("expected header name to be a string");const l=wx(s[1])?s[1]:[s[1]];let c=!1;for(const d of l)d!==void 0&&(e&&!c&&(c=!0,yield[a,null]),yield[a,d])}}const Ee=t=>{const e=new Headers,n=new Set;for(const s of t){const a=new Set;for(const[l,c]of az(s)){const d=l.toLowerCase();a.has(d)||(e.delete(l),a.add(d)),c===null?(e.delete(l),n.add(d)):(e.append(l,c),n.delete(d))}}return{[rC]:!0,values:e,nulls:n}};class sC extends Ne{create(e,n){return this._client.post("/audio/speech",{body:e,...n,headers:Ee([{Accept:"application/octet-stream"},n?.headers]),__binaryResponse:!0})}}class iC extends Ne{create(e,n){return this._client.post("/audio/transcriptions",Ci({body:e,...n,stream:e.stream??!1,__metadata:{model:e.model}},this._client))}}class aC extends Ne{create(e,n){return this._client.post("/audio/translations",Ci({body:e,...n,__metadata:{model:e.model}},this._client))}}class ac extends Ne{constructor(){super(...arguments),this.transcriptions=new iC(this._client),this.translations=new aC(this._client),this.speech=new sC(this._client)}}ac.Transcriptions=iC;ac.Translations=aC;ac.Speech=sC;class oC extends Ne{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(ve`/batches/${e}`,n)}list(e={},n){return this._client.getAPIList("/batches",jt,{query:e,...n})}cancel(e,n){return this._client.post(ve`/batches/${e}/cancel`,n)}}class lC extends Ne{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:Ee([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(e,n){return this._client.get(ve`/assistants/${e}`,{...n,headers:Ee([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(e,n,s){return this._client.post(ve`/assistants/${e}`,{body:n,...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e={},n){return this._client.getAPIList("/assistants",jt,{query:e,...n,headers:Ee([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}delete(e,n){return this._client.delete(ve`/assistants/${e}`,{...n,headers:Ee([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}}let cC=class extends Ne{create(e,n){return this._client.post("/realtime/sessions",{body:e,...n,headers:Ee([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}};class uC extends Ne{create(e,n){return this._client.post("/realtime/transcription_sessions",{body:e,...n,headers:Ee([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}}let _f=class extends Ne{constructor(){super(...arguments),this.sessions=new cC(this._client),this.transcriptionSessions=new uC(this._client)}};_f.Sessions=cC;_f.TranscriptionSessions=uC;class dC extends Ne{create(e,n){return this._client.post("/chatkit/sessions",{body:e,...n,headers:Ee([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}cancel(e,n){return this._client.post(ve`/chatkit/sessions/${e}/cancel`,{...n,headers:Ee([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}}let fC=class extends Ne{retrieve(e,n){return this._client.get(ve`/chatkit/threads/${e}`,{...n,headers:Ee([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}list(e={},n){return this._client.getAPIList("/chatkit/threads",Hd,{query:e,...n,headers:Ee([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}delete(e,n){return this._client.delete(ve`/chatkit/threads/${e}`,{...n,headers:Ee([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}listItems(e,n={},s){return this._client.getAPIList(ve`/chatkit/threads/${e}/items`,Hd,{query:n,...s,headers:Ee([{"OpenAI-Beta":"chatkit_beta=v1"},s?.headers])})}};class bf extends Ne{constructor(){super(...arguments),this.sessions=new dC(this._client),this.threads=new fC(this._client)}}bf.Sessions=dC;bf.Threads=fC;class hC extends Ne{create(e,n,s){return this._client.post(ve`/threads/${e}/messages`,{body:n,...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}retrieve(e,n,s){const{thread_id:a}=n;return this._client.get(ve`/threads/${a}/messages/${e}`,{...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}update(e,n,s){const{thread_id:a,...l}=n;return this._client.post(ve`/threads/${a}/messages/${e}`,{body:l,...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e,n={},s){return this._client.getAPIList(ve`/threads/${e}/messages`,jt,{query:n,...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}delete(e,n,s){const{thread_id:a}=n;return this._client.delete(ve`/threads/${a}/messages/${e}`,{...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}class mC extends Ne{retrieve(e,n,s){const{thread_id:a,run_id:l,...c}=n;return this._client.get(ve`/threads/${a}/runs/${l}/steps/${e}`,{query:c,...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e,n,s){const{thread_id:a,...l}=n;return this._client.getAPIList(ve`/threads/${a}/runs/${e}/steps`,jt,{query:l,...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}const oz=t=>{if(typeof Buffer<"u"){const e=Buffer.from(t,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(t),n=e.length,s=new Uint8Array(n);for(let a=0;a<n;a++)s[a]=e.charCodeAt(a);return Array.from(new Float32Array(s.buffer))}};var lz={};const Ta=t=>{if(typeof globalThis.process<"u")return lz?.[t]?.trim()??void 0;if(typeof globalThis.Deno<"u")return globalThis.Deno.env?.get?.(t)?.trim()};var Ft,vi,mg,hr,vd,Zn,_i,Ba,mi,Xd,Tn,_d,bd,Tl,vl,_l,Lx,$x,zx,Px,Hx,qx,Qx;class Nl extends ay{constructor(){super(...arguments),Ft.add(this),mg.set(this,[]),hr.set(this,{}),vd.set(this,{}),Zn.set(this,void 0),_i.set(this,void 0),Ba.set(this,void 0),mi.set(this,void 0),Xd.set(this,void 0),Tn.set(this,void 0),_d.set(this,void 0),bd.set(this,void 0),Tl.set(this,void 0)}[(mg=new WeakMap,hr=new WeakMap,vd=new WeakMap,Zn=new WeakMap,_i=new WeakMap,Ba=new WeakMap,mi=new WeakMap,Xd=new WeakMap,Tn=new WeakMap,_d=new WeakMap,bd=new WeakMap,Tl=new WeakMap,Ft=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let s=!1;return this.on("event",a=>{const l=n.shift();l?l.resolve(a):e.push(a)}),this.on("end",()=>{s=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{s=!0;for(const l of n)l.reject(a);n.length=0}),this.on("error",a=>{s=!0;for(const l of n)l.reject(a);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((l,c)=>n.push({resolve:l,reject:c})).then(l=>l?{value:l,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new vi;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){const s=n?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=pr.fromReadableStream(e,this.controller);for await(const l of a)se(this,Ft,"m",vl).call(this,l);if(a.controller.signal?.aborted)throw new Qn;return this._addRun(se(this,Ft,"m",_l).call(this))}toReadableStream(){return new pr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,s,a){const l=new vi;return l._run(()=>l._runToolAssistantStream(e,n,s,{...a,headers:{...a?.headers,"X-Stainless-Helper-Method":"stream"}})),l}async _createToolAssistantStream(e,n,s,a){const l=a?.signal;l&&(l.aborted&&this.controller.abort(),l.addEventListener("abort",()=>this.controller.abort()));const c={...s,stream:!0},d=await e.submitToolOutputs(n,c,{...a,signal:this.controller.signal});this._connected();for await(const h of d)se(this,Ft,"m",vl).call(this,h);if(d.controller.signal?.aborted)throw new Qn;return this._addRun(se(this,Ft,"m",_l).call(this))}static createThreadAssistantStream(e,n,s){const a=new vi;return a._run(()=>a._threadAssistantStream(e,n,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(e,n,s,a){const l=new vi;return l._run(()=>l._runAssistantStream(e,n,s,{...a,headers:{...a?.headers,"X-Stainless-Helper-Method":"stream"}})),l}currentEvent(){return se(this,_d,"f")}currentRun(){return se(this,bd,"f")}currentMessageSnapshot(){return se(this,Zn,"f")}currentRunStepSnapshot(){return se(this,Tl,"f")}async finalRunSteps(){return await this.done(),Object.values(se(this,hr,"f"))}async finalMessages(){return await this.done(),Object.values(se(this,vd,"f"))}async finalRun(){if(await this.done(),!se(this,_i,"f"))throw Error("Final run was not received.");return se(this,_i,"f")}async _createThreadAssistantStream(e,n,s){const a=s?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const l={...n,stream:!0},c=await e.createAndRun(l,{...s,signal:this.controller.signal});this._connected();for await(const d of c)se(this,Ft,"m",vl).call(this,d);if(c.controller.signal?.aborted)throw new Qn;return this._addRun(se(this,Ft,"m",_l).call(this))}async _createAssistantStream(e,n,s,a){const l=a?.signal;l&&(l.aborted&&this.controller.abort(),l.addEventListener("abort",()=>this.controller.abort()));const c={...s,stream:!0},d=await e.create(n,c,{...a,signal:this.controller.signal});this._connected();for await(const h of d)se(this,Ft,"m",vl).call(this,h);if(d.controller.signal?.aborted)throw new Qn;return this._addRun(se(this,Ft,"m",_l).call(this))}static accumulateDelta(e,n){for(const[s,a]of Object.entries(n)){if(!e.hasOwnProperty(s)){e[s]=a;continue}let l=e[s];if(l==null){e[s]=a;continue}if(s==="index"||s==="type"){e[s]=a;continue}if(typeof l=="string"&&typeof a=="string")l+=a;else if(typeof l=="number"&&typeof a=="number")l+=a;else if(yp(l)&&yp(a))l=this.accumulateDelta(l,a);else if(Array.isArray(l)&&Array.isArray(a)){if(l.every(c=>typeof c=="string"||typeof c=="number")){l.push(...a);continue}for(const c of a){if(!yp(c))throw new Error(`Expected array delta entry to be an object but got: ${c}`);const d=c.index;if(d==null)throw console.error(c),new Error("Expected array delta entry to have an `index` property");if(typeof d!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${d}`);const h=l[d];h==null?l.push(c):l[d]=this.accumulateDelta(h,c)}continue}else throw Error(`Unhandled record type: ${s}, deltaValue: ${a}, accValue: ${l}`);e[s]=l}return e}_addRun(e){return e}async _threadAssistantStream(e,n,s){return await this._createThreadAssistantStream(n,e,s)}async _runAssistantStream(e,n,s,a){return await this._createAssistantStream(n,e,s,a)}async _runToolAssistantStream(e,n,s,a){return await this._createToolAssistantStream(n,e,s,a)}}vi=Nl,vl=function(e){if(!this.ended)switch(Ue(this,_d,e),se(this,Ft,"m",zx).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":se(this,Ft,"m",Qx).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":se(this,Ft,"m",$x).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":se(this,Ft,"m",Lx).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},_l=function(){if(this.ended)throw new Ie("stream has ended, this shouldn't happen");if(!se(this,_i,"f"))throw Error("Final run has not been received");return se(this,_i,"f")},Lx=function(e){const[n,s]=se(this,Ft,"m",Hx).call(this,e,se(this,Zn,"f"));Ue(this,Zn,n),se(this,vd,"f")[n.id]=n;for(const a of s){const l=n.content[a.index];l?.type=="text"&&this._emit("textCreated",l.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const a of e.data.delta.content){if(a.type=="text"&&a.text){let l=a.text,c=n.content[a.index];if(c&&c.type=="text")this._emit("textDelta",l,c.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(a.index!=se(this,Ba,"f")){if(se(this,mi,"f"))switch(se(this,mi,"f").type){case"text":this._emit("textDone",se(this,mi,"f").text,se(this,Zn,"f"));break;case"image_file":this._emit("imageFileDone",se(this,mi,"f").image_file,se(this,Zn,"f"));break}Ue(this,Ba,a.index)}Ue(this,mi,n.content[a.index])}break;case"thread.message.completed":case"thread.message.incomplete":if(se(this,Ba,"f")!==void 0){const a=e.data.content[se(this,Ba,"f")];if(a)switch(a.type){case"image_file":this._emit("imageFileDone",a.image_file,se(this,Zn,"f"));break;case"text":this._emit("textDone",a.text,se(this,Zn,"f"));break}}se(this,Zn,"f")&&this._emit("messageDone",e.data),Ue(this,Zn,void 0)}},$x=function(e){const n=se(this,Ft,"m",Px).call(this,e);switch(Ue(this,Tl,n),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const s=e.data.delta;if(s.step_details&&s.step_details.type=="tool_calls"&&s.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const l of s.step_details.tool_calls)l.index==se(this,Xd,"f")?this._emit("toolCallDelta",l,n.step_details.tool_calls[l.index]):(se(this,Tn,"f")&&this._emit("toolCallDone",se(this,Tn,"f")),Ue(this,Xd,l.index),Ue(this,Tn,n.step_details.tool_calls[l.index]),se(this,Tn,"f")&&this._emit("toolCallCreated",se(this,Tn,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Ue(this,Tl,void 0),e.data.step_details.type=="tool_calls"&&se(this,Tn,"f")&&(this._emit("toolCallDone",se(this,Tn,"f")),Ue(this,Tn,void 0)),this._emit("runStepDone",e.data,n);break}},zx=function(e){se(this,mg,"f").push(e),this._emit("event",e)},Px=function(e){switch(e.event){case"thread.run.step.created":return se(this,hr,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=se(this,hr,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let s=e.data;if(s.delta){const a=vi.accumulateDelta(n,s.delta);se(this,hr,"f")[e.data.id]=a}return se(this,hr,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":se(this,hr,"f")[e.data.id]=e.data;break}if(se(this,hr,"f")[e.data.id])return se(this,hr,"f")[e.data.id];throw new Error("No snapshot available")},Hx=function(e,n){let s=[];switch(e.event){case"thread.message.created":return[e.data,s];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let a=e.data;if(a.delta.content)for(const l of a.delta.content)if(l.index in n.content){let c=n.content[l.index];n.content[l.index]=se(this,Ft,"m",qx).call(this,l,c)}else n.content[l.index]=l,s.push(l);return[n,s];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,s];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},qx=function(e,n){return vi.accumulateDelta(n,e)},Qx=function(e){switch(Ue(this,bd,e.data),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":Ue(this,_i,e.data),se(this,Tn,"f")&&(this._emit("toolCallDone",se(this,Tn,"f")),Ue(this,Tn,void 0));break}};let uy=class extends Ne{constructor(){super(...arguments),this.steps=new mC(this._client)}create(e,n,s){const{include:a,...l}=n;return this._client.post(ve`/threads/${e}/runs`,{query:{include:a},body:l,...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers]),stream:n.stream??!1})}retrieve(e,n,s){const{thread_id:a}=n;return this._client.get(ve`/threads/${a}/runs/${e}`,{...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}update(e,n,s){const{thread_id:a,...l}=n;return this._client.post(ve`/threads/${a}/runs/${e}`,{body:l,...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e,n={},s){return this._client.getAPIList(ve`/threads/${e}/runs`,jt,{query:n,...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}cancel(e,n,s){const{thread_id:a}=n;return this._client.post(ve`/threads/${a}/runs/${e}/cancel`,{...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async createAndPoll(e,n,s){const a=await this.create(e,n,s);return await this.poll(a.id,{thread_id:e},s)}createAndStream(e,n,s){return Nl.createAssistantStream(e,this._client.beta.threads.runs,n,s)}async poll(e,n,s){const a=Ee([s?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":s?.pollIntervalMs?.toString()??void 0}]);for(;;){const{data:l,response:c}=await this.retrieve(e,n,{...s,headers:{...s?.headers,...a}}).withResponse();switch(l.status){case"queued":case"in_progress":case"cancelling":let d=5e3;if(s?.pollIntervalMs)d=s.pollIntervalMs;else{const h=c.headers.get("openai-poll-after-ms");if(h){const f=parseInt(h);isNaN(f)||(d=f)}}await sc(d);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return l}}}stream(e,n,s){return Nl.createAssistantStream(e,this._client.beta.threads.runs,n,s)}submitToolOutputs(e,n,s){const{thread_id:a,...l}=n;return this._client.post(ve`/threads/${a}/runs/${e}/submit_tool_outputs`,{body:l,...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers]),stream:n.stream??!1})}async submitToolOutputsAndPoll(e,n,s){const a=await this.submitToolOutputs(e,n,s);return await this.poll(a.id,n,s)}submitToolOutputsStream(e,n,s){return Nl.createToolAssistantStream(e,this._client.beta.threads.runs,n,s)}};uy.Steps=mC;class wf extends Ne{constructor(){super(...arguments),this.runs=new uy(this._client),this.messages=new hC(this._client)}create(e={},n){return this._client.post("/threads",{body:e,...n,headers:Ee([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(e,n){return this._client.get(ve`/threads/${e}`,{...n,headers:Ee([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(e,n,s){return this._client.post(ve`/threads/${e}`,{body:n,...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}delete(e,n){return this._client.delete(ve`/threads/${e}`,{...n,headers:Ee([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:Ee([{"OpenAI-Beta":"assistants=v2"},n?.headers]),stream:e.stream??!1})}async createAndRunPoll(e,n){const s=await this.createAndRun(e,n);return await this.runs.poll(s.id,{thread_id:s.thread_id},n)}createAndRunStream(e,n){return Nl.createThreadAssistantStream(e,this._client.beta.threads,n)}}wf.Runs=uy;wf.Messages=hC;class Ja extends Ne{constructor(){super(...arguments),this.realtime=new _f(this._client),this.chatkit=new bf(this._client),this.assistants=new lC(this._client),this.threads=new wf(this._client)}}Ja.Realtime=_f;Ja.ChatKit=bf;Ja.Assistants=lC;Ja.Threads=wf;class pC extends Ne{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}class gC extends Ne{retrieve(e,n,s){const{container_id:a}=n;return this._client.get(ve`/containers/${a}/files/${e}/content`,{...s,headers:Ee([{Accept:"application/binary"},s?.headers]),__binaryResponse:!0})}}let dy=class extends Ne{constructor(){super(...arguments),this.content=new gC(this._client)}create(e,n,s){return this._client.post(ve`/containers/${e}/files`,Ci({body:n,...s},this._client))}retrieve(e,n,s){const{container_id:a}=n;return this._client.get(ve`/containers/${a}/files/${e}`,s)}list(e,n={},s){return this._client.getAPIList(ve`/containers/${e}/files`,jt,{query:n,...s})}delete(e,n,s){const{container_id:a}=n;return this._client.delete(ve`/containers/${a}/files/${e}`,{...s,headers:Ee([{Accept:"*/*"},s?.headers])})}};dy.Content=gC;class fy extends Ne{constructor(){super(...arguments),this.files=new dy(this._client)}create(e,n){return this._client.post("/containers",{body:e,...n})}retrieve(e,n){return this._client.get(ve`/containers/${e}`,n)}list(e={},n){return this._client.getAPIList("/containers",jt,{query:e,...n})}delete(e,n){return this._client.delete(ve`/containers/${e}`,{...n,headers:Ee([{Accept:"*/*"},n?.headers])})}}fy.Files=dy;class yC extends Ne{create(e,n,s){const{include:a,...l}=n;return this._client.post(ve`/conversations/${e}/items`,{query:{include:a},body:l,...s})}retrieve(e,n,s){const{conversation_id:a,...l}=n;return this._client.get(ve`/conversations/${a}/items/${e}`,{query:l,...s})}list(e,n={},s){return this._client.getAPIList(ve`/conversations/${e}/items`,Hd,{query:n,...s})}delete(e,n,s){const{conversation_id:a}=n;return this._client.delete(ve`/conversations/${a}/items/${e}`,s)}}class hy extends Ne{constructor(){super(...arguments),this.items=new yC(this._client)}create(e={},n){return this._client.post("/conversations",{body:e,...n})}retrieve(e,n){return this._client.get(ve`/conversations/${e}`,n)}update(e,n,s){return this._client.post(ve`/conversations/${e}`,{body:n,...s})}delete(e,n){return this._client.delete(ve`/conversations/${e}`,n)}}hy.Items=yC;class vC extends Ne{create(e,n){const s=!!e.encoding_format;let a=s?e.encoding_format:"base64";s&&Qt(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);const l=this._client.post("/embeddings",{body:{...e,encoding_format:a},...n});return s?l:(Qt(this._client).debug("embeddings/decoding base64 embeddings from base64"),l._thenUnwrap(c=>(c&&c.data&&c.data.forEach(d=>{const h=d.embedding;d.embedding=oz(h)}),c)))}}class _C extends Ne{retrieve(e,n,s){const{eval_id:a,run_id:l}=n;return this._client.get(ve`/evals/${a}/runs/${l}/output_items/${e}`,s)}list(e,n,s){const{eval_id:a,...l}=n;return this._client.getAPIList(ve`/evals/${a}/runs/${e}/output_items`,jt,{query:l,...s})}}class my extends Ne{constructor(){super(...arguments),this.outputItems=new _C(this._client)}create(e,n,s){return this._client.post(ve`/evals/${e}/runs`,{body:n,...s})}retrieve(e,n,s){const{eval_id:a}=n;return this._client.get(ve`/evals/${a}/runs/${e}`,s)}list(e,n={},s){return this._client.getAPIList(ve`/evals/${e}/runs`,jt,{query:n,...s})}delete(e,n,s){const{eval_id:a}=n;return this._client.delete(ve`/evals/${a}/runs/${e}`,s)}cancel(e,n,s){const{eval_id:a}=n;return this._client.post(ve`/evals/${a}/runs/${e}`,s)}}my.OutputItems=_C;class py extends Ne{constructor(){super(...arguments),this.runs=new my(this._client)}create(e,n){return this._client.post("/evals",{body:e,...n})}retrieve(e,n){return this._client.get(ve`/evals/${e}`,n)}update(e,n,s){return this._client.post(ve`/evals/${e}`,{body:n,...s})}list(e={},n){return this._client.getAPIList("/evals",jt,{query:e,...n})}delete(e,n){return this._client.delete(ve`/evals/${e}`,n)}}py.Runs=my;let bC=class extends Ne{create(e,n){return this._client.post("/files",Ci({body:e,...n},this._client))}retrieve(e,n){return this._client.get(ve`/files/${e}`,n)}list(e={},n){return this._client.getAPIList("/files",jt,{query:e,...n})}delete(e,n){return this._client.delete(ve`/files/${e}`,n)}content(e,n){return this._client.get(ve`/files/${e}/content`,{...n,headers:Ee([{Accept:"application/binary"},n?.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:s=1800*1e3}={}){const a=new Set(["processed","error","deleted"]),l=Date.now();let c=await this.retrieve(e);for(;!c.status||!a.has(c.status);)if(await sc(n),c=await this.retrieve(e),Date.now()-l>s)throw new ey({message:`Giving up on waiting for file ${e} to finish processing after ${s} milliseconds.`});return c}};class wC extends Ne{}let xC=class extends Ne{run(e,n){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...n})}validate(e,n){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...n})}};class gy extends Ne{constructor(){super(...arguments),this.graders=new xC(this._client)}}gy.Graders=xC;class AC extends Ne{create(e,n,s){return this._client.getAPIList(ve`/fine_tuning/checkpoints/${e}/permissions`,vf,{body:n,method:"post",...s})}retrieve(e,n={},s){return this._client.get(ve`/fine_tuning/checkpoints/${e}/permissions`,{query:n,...s})}delete(e,n,s){const{fine_tuned_model_checkpoint:a}=n;return this._client.delete(ve`/fine_tuning/checkpoints/${a}/permissions/${e}`,s)}}let yy=class extends Ne{constructor(){super(...arguments),this.permissions=new AC(this._client)}};yy.Permissions=AC;class EC extends Ne{list(e,n={},s){return this._client.getAPIList(ve`/fine_tuning/jobs/${e}/checkpoints`,jt,{query:n,...s})}}class vy extends Ne{constructor(){super(...arguments),this.checkpoints=new EC(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(ve`/fine_tuning/jobs/${e}`,n)}list(e={},n){return this._client.getAPIList("/fine_tuning/jobs",jt,{query:e,...n})}cancel(e,n){return this._client.post(ve`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},s){return this._client.getAPIList(ve`/fine_tuning/jobs/${e}/events`,jt,{query:n,...s})}pause(e,n){return this._client.post(ve`/fine_tuning/jobs/${e}/pause`,n)}resume(e,n){return this._client.post(ve`/fine_tuning/jobs/${e}/resume`,n)}}vy.Checkpoints=EC;class Za extends Ne{constructor(){super(...arguments),this.methods=new wC(this._client),this.jobs=new vy(this._client),this.checkpoints=new yy(this._client),this.alpha=new gy(this._client)}}Za.Methods=wC;Za.Jobs=vy;Za.Checkpoints=yy;Za.Alpha=gy;class SC extends Ne{}class _y extends Ne{constructor(){super(...arguments),this.graderModels=new SC(this._client)}}_y.GraderModels=SC;class CC extends Ne{createVariation(e,n){return this._client.post("/images/variations",Ci({body:e,...n},this._client))}edit(e,n){return this._client.post("/images/edits",Ci({body:e,...n,stream:e.stream??!1},this._client))}generate(e,n){return this._client.post("/images/generations",{body:e,...n,stream:e.stream??!1})}}class TC extends Ne{retrieve(e,n){return this._client.get(ve`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",vf,e)}delete(e,n){return this._client.delete(ve`/models/${e}`,n)}}class NC extends Ne{create(e,n){return this._client.post("/moderations",{body:e,...n})}}class RC extends Ne{accept(e,n,s){return this._client.post(ve`/realtime/calls/${e}/accept`,{body:n,...s,headers:Ee([{Accept:"*/*"},s?.headers])})}hangup(e,n){return this._client.post(ve`/realtime/calls/${e}/hangup`,{...n,headers:Ee([{Accept:"*/*"},n?.headers])})}refer(e,n,s){return this._client.post(ve`/realtime/calls/${e}/refer`,{body:n,...s,headers:Ee([{Accept:"*/*"},s?.headers])})}reject(e,n={},s){return this._client.post(ve`/realtime/calls/${e}/reject`,{body:n,...s,headers:Ee([{Accept:"*/*"},s?.headers])})}}class jC extends Ne{create(e,n){return this._client.post("/realtime/client_secrets",{body:e,...n})}}class xf extends Ne{constructor(){super(...arguments),this.clientSecrets=new jC(this._client),this.calls=new RC(this._client)}}xf.ClientSecrets=jC;xf.Calls=RC;function cz(t,e){return!e||!dz(e)?{...t,output_parsed:null,output:t.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(s=>({...s,parsed:null}))}:n)}:OC(t,e)}function OC(t,e){const n=t.output.map(a=>{if(a.type==="function_call")return{...a,parsed_arguments:mz(e,a)};if(a.type==="message"){const l=a.content.map(c=>c.type==="output_text"?{...c,parsed:uz(e,c.text)}:c);return{...a,content:l}}return a}),s=Object.assign({},t,{output:n});return Object.getOwnPropertyDescriptor(t,"output_text")||pg(s),Object.defineProperty(s,"output_parsed",{enumerable:!0,get(){for(const a of s.output)if(a.type==="message"){for(const l of a.content)if(l.type==="output_text"&&l.parsed!==null)return l.parsed}return null}}),s}function uz(t,e){return t.text?.format?.type!=="json_schema"?null:"$parseRaw"in t.text?.format?(t.text?.format).$parseRaw(e):JSON.parse(e)}function dz(t){return!!sy(t.text?.format)}function fz(t){return t?.$brand==="auto-parseable-tool"}function hz(t,e){return t.find(n=>n.type==="function"&&n.name===e)}function mz(t,e){const n=hz(t.tools??[],e.name);return{...e,...e,parsed_arguments:fz(n)?n.$parseRaw(e.arguments):n?.strict?JSON.parse(e.arguments):null}}function pg(t){const e=[];for(const n of t.output)if(n.type==="message")for(const s of n.content)s.type==="output_text"&&e.push(s.text);t.output_text=e.join("")}var Na,rd,ks,sd,Fx,Vx,Gx,Yx;class by extends ay{constructor(e){super(),Na.add(this),rd.set(this,void 0),ks.set(this,void 0),sd.set(this,void 0),Ue(this,rd,e)}static createResponse(e,n,s){const a=new by(n);return a._run(()=>a._createOrRetrieveResponse(e,n,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createOrRetrieveResponse(e,n,s){const a=s?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),se(this,Na,"m",Fx).call(this);let l,c=null;"response_id"in n?(l=await e.responses.retrieve(n.response_id,{stream:!0},{...s,signal:this.controller.signal,stream:!0}),c=n.starting_after??null):l=await e.responses.create({...n,stream:!0},{...s,signal:this.controller.signal}),this._connected();for await(const d of l)se(this,Na,"m",Vx).call(this,d,c);if(l.controller.signal?.aborted)throw new Qn;return se(this,Na,"m",Gx).call(this)}[(rd=new WeakMap,ks=new WeakMap,sd=new WeakMap,Na=new WeakSet,Fx=function(){this.ended||Ue(this,ks,void 0)},Vx=function(n,s){if(this.ended)return;const a=(c,d)=>{(s==null||d.sequence_number>s)&&this._emit(c,d)},l=se(this,Na,"m",Yx).call(this,n);switch(a("event",n),n.type){case"response.output_text.delta":{const c=l.output[n.output_index];if(!c)throw new Ie(`missing output at index ${n.output_index}`);if(c.type==="message"){const d=c.content[n.content_index];if(!d)throw new Ie(`missing content at index ${n.content_index}`);if(d.type!=="output_text")throw new Ie(`expected content to be 'output_text', got ${d.type}`);a("response.output_text.delta",{...n,snapshot:d.text})}break}case"response.function_call_arguments.delta":{const c=l.output[n.output_index];if(!c)throw new Ie(`missing output at index ${n.output_index}`);c.type==="function_call"&&a("response.function_call_arguments.delta",{...n,snapshot:c.arguments});break}default:a(n.type,n);break}},Gx=function(){if(this.ended)throw new Ie("stream has ended, this shouldn't happen");const n=se(this,ks,"f");if(!n)throw new Ie("request ended without sending any events");Ue(this,ks,void 0);const s=pz(n,se(this,rd,"f"));return Ue(this,sd,s),s},Yx=function(n){let s=se(this,ks,"f");if(!s){if(n.type!=="response.created")throw new Ie(`When snapshot hasn't been set yet, expected 'response.created' event, got ${n.type}`);return s=Ue(this,ks,n.response),s}switch(n.type){case"response.output_item.added":{s.output.push(n.item);break}case"response.content_part.added":{const a=s.output[n.output_index];if(!a)throw new Ie(`missing output at index ${n.output_index}`);const l=a.type,c=n.part;l==="message"&&c.type!=="reasoning_text"?a.content.push(c):l==="reasoning"&&c.type==="reasoning_text"&&(a.content||(a.content=[]),a.content.push(c));break}case"response.output_text.delta":{const a=s.output[n.output_index];if(!a)throw new Ie(`missing output at index ${n.output_index}`);if(a.type==="message"){const l=a.content[n.content_index];if(!l)throw new Ie(`missing content at index ${n.content_index}`);if(l.type!=="output_text")throw new Ie(`expected content to be 'output_text', got ${l.type}`);l.text+=n.delta}break}case"response.function_call_arguments.delta":{const a=s.output[n.output_index];if(!a)throw new Ie(`missing output at index ${n.output_index}`);a.type==="function_call"&&(a.arguments+=n.delta);break}case"response.reasoning_text.delta":{const a=s.output[n.output_index];if(!a)throw new Ie(`missing output at index ${n.output_index}`);if(a.type==="reasoning"){const l=a.content?.[n.content_index];if(!l)throw new Ie(`missing content at index ${n.content_index}`);if(l.type!=="reasoning_text")throw new Ie(`expected content to be 'reasoning_text', got ${l.type}`);l.text+=n.delta}break}case"response.completed":{Ue(this,ks,n.response);break}}return s},Symbol.asyncIterator)](){const e=[],n=[];let s=!1;return this.on("event",a=>{const l=n.shift();l?l.resolve(a):e.push(a)}),this.on("end",()=>{s=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{s=!0;for(const l of n)l.reject(a);n.length=0}),this.on("error",a=>{s=!0;for(const l of n)l.reject(a);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((l,c)=>n.push({resolve:l,reject:c})).then(l=>l?{value:l,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=se(this,sd,"f");if(!e)throw new Ie("stream ended without producing a ChatCompletion");return e}}function pz(t,e){return cz(t,e)}class IC extends Ne{list(e,n={},s){return this._client.getAPIList(ve`/responses/${e}/input_items`,jt,{query:n,...s})}}class kC extends Ne{count(e={},n){return this._client.post("/responses/input_tokens",{body:e,...n})}}class Af extends Ne{constructor(){super(...arguments),this.inputItems=new IC(this._client),this.inputTokens=new kC(this._client)}create(e,n){return this._client.post("/responses",{body:e,...n,stream:e.stream??!1})._thenUnwrap(s=>("object"in s&&s.object==="response"&&pg(s),s))}retrieve(e,n={},s){return this._client.get(ve`/responses/${e}`,{query:n,...s,stream:n?.stream??!1})._thenUnwrap(a=>("object"in a&&a.object==="response"&&pg(a),a))}delete(e,n){return this._client.delete(ve`/responses/${e}`,{...n,headers:Ee([{Accept:"*/*"},n?.headers])})}parse(e,n){return this._client.responses.create(e,n)._thenUnwrap(s=>OC(s,e))}stream(e,n){return by.createResponse(this._client,e,n)}cancel(e,n){return this._client.post(ve`/responses/${e}/cancel`,n)}}Af.InputItems=IC;Af.InputTokens=kC;class MC extends Ne{create(e,n,s){return this._client.post(ve`/uploads/${e}/parts`,Ci({body:n,...s},this._client))}}class wy extends Ne{constructor(){super(...arguments),this.parts=new MC(this._client)}create(e,n){return this._client.post("/uploads",{body:e,...n})}cancel(e,n){return this._client.post(ve`/uploads/${e}/cancel`,n)}complete(e,n,s){return this._client.post(ve`/uploads/${e}/complete`,{body:n,...s})}}wy.Parts=MC;const gz=async t=>{const e=await Promise.allSettled(t),n=e.filter(a=>a.status==="rejected");if(n.length){for(const a of n)console.error(a.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const s=[];for(const a of e)a.status==="fulfilled"&&s.push(a.value);return s};class DC extends Ne{create(e,n,s){return this._client.post(ve`/vector_stores/${e}/file_batches`,{body:n,...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}retrieve(e,n,s){const{vector_store_id:a}=n;return this._client.get(ve`/vector_stores/${a}/file_batches/${e}`,{...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}cancel(e,n,s){const{vector_store_id:a}=n;return this._client.post(ve`/vector_stores/${a}/file_batches/${e}/cancel`,{...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async createAndPoll(e,n,s){const a=await this.create(e,n);return await this.poll(e,a.id,s)}listFiles(e,n,s){const{vector_store_id:a,...l}=n;return this._client.getAPIList(ve`/vector_stores/${a}/file_batches/${e}/files`,jt,{query:l,...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async poll(e,n,s){const a=Ee([s?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":s?.pollIntervalMs?.toString()??void 0}]);for(;;){const{data:l,response:c}=await this.retrieve(n,{vector_store_id:e},{...s,headers:a}).withResponse();switch(l.status){case"in_progress":let d=5e3;if(s?.pollIntervalMs)d=s.pollIntervalMs;else{const h=c.headers.get("openai-poll-after-ms");if(h){const f=parseInt(h);isNaN(f)||(d=f)}}await sc(d);break;case"failed":case"cancelled":case"completed":return l}}}async uploadAndPoll(e,{files:n,fileIds:s=[]},a){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const l=a?.maxConcurrency??5,c=Math.min(l,n.length),d=this._client,h=n.values(),f=[...s];async function p(y){for(let _ of y){const x=await d.files.create({file:_,purpose:"assistants"},a);f.push(x.id)}}const m=Array(c).fill(h).map(p);return await gz(m),await this.createAndPoll(e,{file_ids:f})}}class BC extends Ne{create(e,n,s){return this._client.post(ve`/vector_stores/${e}/files`,{body:n,...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}retrieve(e,n,s){const{vector_store_id:a}=n;return this._client.get(ve`/vector_stores/${a}/files/${e}`,{...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}update(e,n,s){const{vector_store_id:a,...l}=n;return this._client.post(ve`/vector_stores/${a}/files/${e}`,{body:l,...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e,n={},s){return this._client.getAPIList(ve`/vector_stores/${e}/files`,jt,{query:n,...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}delete(e,n,s){const{vector_store_id:a}=n;return this._client.delete(ve`/vector_stores/${a}/files/${e}`,{...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async createAndPoll(e,n,s){const a=await this.create(e,n,s);return await this.poll(e,a.id,s)}async poll(e,n,s){const a=Ee([s?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":s?.pollIntervalMs?.toString()??void 0}]);for(;;){const l=await this.retrieve(n,{vector_store_id:e},{...s,headers:a}).withResponse(),c=l.data;switch(c.status){case"in_progress":let d=5e3;if(s?.pollIntervalMs)d=s.pollIntervalMs;else{const h=l.response.headers.get("openai-poll-after-ms");if(h){const f=parseInt(h);isNaN(f)||(d=f)}}await sc(d);break;case"failed":case"completed":return c}}}async upload(e,n,s){const a=await this._client.files.create({file:n,purpose:"assistants"},s);return this.create(e,{file_id:a.id},s)}async uploadAndPoll(e,n,s){const a=await this.upload(e,n,s);return await this.poll(e,a.id,s)}content(e,n,s){const{vector_store_id:a}=n;return this._client.getAPIList(ve`/vector_stores/${a}/files/${e}/content`,vf,{...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}class Ef extends Ne{constructor(){super(...arguments),this.files=new BC(this._client),this.fileBatches=new DC(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:Ee([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(e,n){return this._client.get(ve`/vector_stores/${e}`,{...n,headers:Ee([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(e,n,s){return this._client.post(ve`/vector_stores/${e}`,{body:n,...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e={},n){return this._client.getAPIList("/vector_stores",jt,{query:e,...n,headers:Ee([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}delete(e,n){return this._client.delete(ve`/vector_stores/${e}`,{...n,headers:Ee([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}search(e,n,s){return this._client.getAPIList(ve`/vector_stores/${e}/search`,vf,{body:n,method:"post",...s,headers:Ee([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}Ef.Files=BC;Ef.FileBatches=DC;class UC extends Ne{create(e,n){return this._client.post("/videos",kx({body:e,...n},this._client))}retrieve(e,n){return this._client.get(ve`/videos/${e}`,n)}list(e={},n){return this._client.getAPIList("/videos",Hd,{query:e,...n})}delete(e,n){return this._client.delete(ve`/videos/${e}`,n)}downloadContent(e,n={},s){return this._client.get(ve`/videos/${e}/content`,{query:n,...s,headers:Ee([{Accept:"application/binary"},s?.headers]),__binaryResponse:!0})}remix(e,n,s){return this._client.post(ve`/videos/${e}/remix`,kx({body:n,...s},this._client))}}var ka,LC,wd;class $C extends Ne{constructor(){super(...arguments),ka.add(this)}async unwrap(e,n,s=this._client.webhookSecret,a=300){return await this.verifySignature(e,n,s,a),JSON.parse(e)}async verifySignature(e,n,s=this._client.webhookSecret,a=300){if(typeof crypto>"u"||typeof crypto.subtle.importKey!="function"||typeof crypto.subtle.verify!="function")throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");se(this,ka,"m",LC).call(this,s);const l=Ee([n]).values,c=se(this,ka,"m",wd).call(this,l,"webhook-signature"),d=se(this,ka,"m",wd).call(this,l,"webhook-timestamp"),h=se(this,ka,"m",wd).call(this,l,"webhook-id"),f=parseInt(d,10);if(isNaN(f))throw new dl("Invalid webhook timestamp format");const p=Math.floor(Date.now()/1e3);if(p-f>a)throw new dl("Webhook timestamp is too old");if(f>p+a)throw new dl("Webhook timestamp is too new");const m=c.split(" ").map(w=>w.startsWith("v1,")?w.substring(3):w),y=s.startsWith("whsec_")?Buffer.from(s.replace("whsec_",""),"base64"):Buffer.from(s,"utf-8"),_=h?`${h}.${d}.${e}`:`${d}.${e}`,x=await crypto.subtle.importKey("raw",y,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(const w of m)try{const A=Buffer.from(w,"base64");if(await crypto.subtle.verify("HMAC",x,A,new TextEncoder().encode(_)))return}catch{continue}throw new dl("The given webhook signature does not match the expected signature")}}ka=new WeakSet,LC=function(e){if(typeof e!="string"||e.length===0)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},wd=function(e,n){if(!e)throw new Error("Headers are required");const s=e.get(n);if(s==null)throw new Error(`Missing required header: ${n}`);return s};var gg,xy,xd,zC;class He{constructor({baseURL:e=Ta("OPENAI_BASE_URL"),apiKey:n=Ta("OPENAI_API_KEY"),organization:s=Ta("OPENAI_ORG_ID")??null,project:a=Ta("OPENAI_PROJECT_ID")??null,webhookSecret:l=Ta("OPENAI_WEBHOOK_SECRET")??null,...c}={}){if(gg.add(this),xd.set(this,void 0),this.completions=new pC(this),this.chat=new cy(this),this.embeddings=new vC(this),this.files=new bC(this),this.images=new CC(this),this.audio=new ac(this),this.moderations=new NC(this),this.models=new TC(this),this.fineTuning=new Za(this),this.graders=new _y(this),this.vectorStores=new Ef(this),this.webhooks=new $C(this),this.beta=new Ja(this),this.batches=new oC(this),this.uploads=new wy(this),this.responses=new Af(this),this.realtime=new xf(this),this.conversations=new hy(this),this.evals=new py(this),this.containers=new fy(this),this.videos=new UC(this),n===void 0)throw new Ie("Missing credentials. Please pass an `apiKey`, or set the `OPENAI_API_KEY` environment variable.");const d={apiKey:n,organization:s,project:a,webhookSecret:l,...c,baseURL:e||"https://api.openai.com/v1"};if(!d.dangerouslyAllowBrowser&&y$())throw new Ie(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=d.baseURL,this.timeout=d.timeout??xy.DEFAULT_TIMEOUT,this.logger=d.logger??console;const h="warn";this.logLevel=h,this.logLevel=Ox(d.logLevel,"ClientOptions.logLevel",this)??Ox(Ta("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??h,this.fetchOptions=d.fetchOptions,this.maxRetries=d.maxRetries??2,this.fetch=d.fetch??x$(),Ue(this,xd,E$),this._options=d,this.apiKey=typeof n=="string"?n:"Missing Key",this.organization=s,this.project=a,this.webhookSecret=l}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){}async authHeaders(e){return Ee([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(e){return j$(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${Oa}`}defaultIdempotencyKey(){return`stainless-node-retry-${c1()}`}makeStatusError(e,n,s,a){return Vt.generate(e,n,s,a)}async _callApiKey(){const e=this._options.apiKey;if(typeof e!="function")return!1;let n;try{n=await e()}catch(s){throw s instanceof Ie?s:new Ie(`Failed to get token from 'apiKey' function: ${s.message}`,{cause:s})}if(typeof n!="string"||!n)throw new Ie(`Expected 'apiKey' function argument to return a string but it returned ${n}`);return this.apiKey=n,!0}buildURL(e,n,s){const a=!se(this,gg,"m",zC).call(this)&&s||this.baseURL,l=f$(e)?new URL(e):new URL(a+(a.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),c=this.defaultQuery();return h$(c)||(n={...c,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(l.search=this.stringifyQuery(n)),l.toString()}async prepareOptions(e){await this._callApiKey()}async prepareRequest(e,{url:n,options:s}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,s){return this.request(Promise.resolve(s).then(a=>({method:e,path:n,...a})))}request(e,n=null){return new yf(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,s){const a=await e,l=a.maxRetries??this.maxRetries;n==null&&(n=l),await this.prepareOptions(a);const{req:c,url:d,timeout:h}=await this.buildRequest(a,{retryCount:l-n});await this.prepareRequest(c,{url:d,options:a});const f="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),p=s===void 0?"":`, retryOf: ${s}`,m=Date.now();if(Qt(this).debug(`[${f}] sending request`,di({retryOfRequestLogID:s,method:a.method,url:d,options:a,headers:c.headers})),a.signal?.aborted)throw new Qn;const y=new AbortController,_=await this.fetchWithTimeout(d,c,h,y).catch(sg),x=Date.now();if(_ instanceof globalThis.Error){const S=`retrying, ${n} attempts remaining`;if(a.signal?.aborted)throw new Qn;const T=rg(_)||/timed? ?out/i.test(String(_)+("cause"in _?String(_.cause):""));if(n)return Qt(this).info(`[${f}] connection ${T?"timed out":"failed"} - ${S}`),Qt(this).debug(`[${f}] connection ${T?"timed out":"failed"} (${S})`,di({retryOfRequestLogID:s,url:d,durationMs:x-m,message:_.message})),this.retryRequest(a,n,s??f);throw Qt(this).info(`[${f}] connection ${T?"timed out":"failed"} - error; no more retries left`),Qt(this).debug(`[${f}] connection ${T?"timed out":"failed"} (error; no more retries left)`,di({retryOfRequestLogID:s,url:d,durationMs:x-m,message:_.message})),T?new ey:new pf({cause:_})}const w=[..._.headers.entries()].filter(([S])=>S==="x-request-id").map(([S,T])=>", "+S+": "+JSON.stringify(T)).join(""),A=`[${f}${p}${w}] ${c.method} ${d} ${_.ok?"succeeded":"failed"} with status ${_.status} in ${x-m}ms`;if(!_.ok){const S=await this.shouldRetry(_);if(n&&S){const M=`retrying, ${n} attempts remaining`;return await A$(_.body),Qt(this).info(`${A} - ${M}`),Qt(this).debug(`[${f}] response error (${M})`,di({retryOfRequestLogID:s,url:_.url,status:_.status,headers:_.headers,durationMs:x-m})),this.retryRequest(a,n,s??f,_.headers)}const T=S?"error; no more retries left":"error; not retryable";Qt(this).info(`${A} - ${T}`);const E=await _.text().catch(M=>sg(M).message),C=g$(E),j=C?void 0:E;throw Qt(this).debug(`[${f}] response error (${T})`,di({retryOfRequestLogID:s,url:_.url,status:_.status,headers:_.headers,message:j,durationMs:Date.now()-m})),this.makeStatusError(_.status,C,j,_.headers)}return Qt(this).info(A),Qt(this).debug(`[${f}] response start`,di({retryOfRequestLogID:s,url:_.url,status:_.status,headers:_.headers,durationMs:x-m})),{response:_,options:a,controller:y,requestLogID:f,retryOfRequestLogID:s,startTime:m}}getAPIList(e,n,s){return this.requestAPIList(n,{method:"get",path:e,...s})}requestAPIList(e,n){const s=this.makeRequest(n,null,void 0);return new $$(this,s,e)}async fetchWithTimeout(e,n,s,a){const{signal:l,method:c,...d}=n||{};l&&l.addEventListener("abort",()=>a.abort());const h=setTimeout(()=>a.abort(),s),f=globalThis.ReadableStream&&d.body instanceof globalThis.ReadableStream||typeof d.body=="object"&&d.body!==null&&Symbol.asyncIterator in d.body,p={signal:a.signal,...f?{duplex:"half"}:{},method:"GET",...d};c&&(p.method=c.toUpperCase());try{return await this.fetch.call(void 0,e,p)}finally{clearTimeout(h)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,s,a){let l;const c=a?.get("retry-after-ms");if(c){const h=parseFloat(c);Number.isNaN(h)||(l=h)}const d=a?.get("retry-after");if(d&&!l){const h=parseFloat(d);Number.isNaN(h)?l=Date.parse(d)-Date.now():l=h*1e3}if(!(l&&0<=l&&l<60*1e3)){const h=e.maxRetries??this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(n,h)}return await sc(l),this.makeRequest(e,n-1,s)}calculateDefaultRetryTimeoutMillis(e,n){const l=n-e,c=Math.min(.5*Math.pow(2,l),8),d=1-Math.random()*.25;return c*d*1e3}async buildRequest(e,{retryCount:n=0}={}){const s={...e},{method:a,path:l,query:c,defaultBaseURL:d}=s,h=this.buildURL(l,c,d);"timeout"in s&&p$("timeout",s.timeout),s.timeout=s.timeout??this.timeout;const{bodyHeaders:f,body:p}=this.buildBody({options:s}),m=await this.buildHeaders({options:e,method:a,bodyHeaders:f,retryCount:n});return{req:{method:a,headers:m,...s.signal&&{signal:s.signal},...globalThis.ReadableStream&&p instanceof globalThis.ReadableStream&&{duplex:"half"},...p&&{body:p},...this.fetchOptions??{},...s.fetchOptions??{}},url:h,timeout:s.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:s,retryCount:a}){let l={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=e.idempotencyKey);const c=Ee([l,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(a),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...w$(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(e),this._options.defaultHeaders,s,e.headers]);return this.validateHeaders(c),c.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const s=Ee([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&s.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:x1(e)}:se(this,xd,"f").call(this,{body:e,headers:s})}}xy=He,xd=new WeakMap,gg=new WeakSet,zC=function(){return this.baseURL!=="https://api.openai.com/v1"};He.OpenAI=xy;He.DEFAULT_TIMEOUT=6e5;He.OpenAIError=Ie;He.APIError=Vt;He.APIConnectionError=pf;He.APIConnectionTimeoutError=ey;He.APIUserAbortError=Qn;He.NotFoundError=h1;He.ConflictError=m1;He.RateLimitError=g1;He.BadRequestError=u1;He.AuthenticationError=d1;He.InternalServerError=y1;He.PermissionDeniedError=f1;He.UnprocessableEntityError=p1;He.InvalidWebhookSignatureError=dl;He.toFile=Q$;He.Completions=pC;He.Chat=cy;He.Embeddings=vC;He.Files=bC;He.Images=CC;He.Audio=ac;He.Moderations=NC;He.Models=TC;He.FineTuning=Za;He.Graders=_y;He.VectorStores=Ef;He.Webhooks=$C;He.Beta=Ja;He.Batches=oC;He.Uploads=wy;He.Responses=Af;He.Realtime=xf;He.Conversations=hy;He.Evals=py;He.Containers=fy;He.Videos=UC;function yz(){const{projectId:t,ep_id:e,setEpId:n,setDeepseekProvider:s,updateEmbodyCache:a,embodyCache:l,isLoading_shots_data:c,refreshShotsData:d}=On(),[h,f]=k.useState(null),[p,m]=k.useState([]),[y,_]=k.useState(!1),[x,w]=k.useState(""),[A,S]=k.useState("");Ls();let T=[];k.useEffect(()=>{t&&(f(""),je.from("movie_eps").select("*").eq("project_id",t).order("index",{ascending:!0}).then(({data:$,error:Q})=>{if(Q){f(Q.message);return}m($),console.log($)}),je.from("LLM").select("*").eq("provider_name","deepseek").single().then(({data:$,error:Q})=>{if(Q){f(Q.message);return}s($)}))},[t]);const E=()=>{_(!0)},C=()=>{if(!A.trim()){f("");return}const $=document.createElement("input");$.type="file",$.accept=".json",$.onchange=j,$.click()},j=$=>{const Q=$.target.files[0];if(Q){const R=new FileReader;R.readAsText(Q,"utf-8"),R.onload=U=>{const B=U.target.result;try{const L=JSON.parse(B);console.log(L),V(L)}catch(L){console.error("JSON :",L)}}}},O=$=>{n($),localStorage.setItem("epId",$),Rt.emit("changeEditorMode","shot")},M=()=>{_(!1),w(""),S(""),f(null)},[D,q]=k.useState(!1),G=async($,Q,R)=>{let U=[];console.log(T);for(let B of Q){let L=T.find(H=>H.name===B);if(L)U.push(L.id);else{const{data:H,error:I}=await je.from("embodys").insert([{project_id:t,name:B,type:"character"}]).select("id, name,type").single();if(I){f(I.message);return}U.push(H.id),T.push(H)}}{let B=T.find(L=>L.name===$);if(B)U.push(B.id);else{const{data:L,error:H}=await je.from("embodys").insert([{project_id:t,name:$,type:"scene"}]).select("id, name,type").single();if(H){f(H.message);return}U.push(L.id),T.push(L)}}for(let B of R){let L=T.find(H=>H.name===B);if(L)U.push(L.id);else{const{data:H,error:I}=await je.from("embodys").insert([{project_id:t,name:B,type:"item"}]).select("id, name,type").single();if(I){f(I.message);return}U.push(H.id),T.push(H)}}return U},V=async $=>{q(!0),await a(),T=Object.values(l);try{const{data:Q,error:R}=await je.from("movie_eps").insert([{project_id:t,title:$.episode_name,description:$.description,index:parseInt(A)}]).select("*").single();if(R)throw R;if($.sc&&Array.isArray($.sc))for(let U=0;U<$.sc.length;U++){const B=$.sc[U],{data:L,error:H}=await je.from("movie_scs").insert([{ep_id:Q.id,name:B.scene_name,description:B.description,index:U+1}]).select("*").single();if(H){console.error(":",H),q(!1);continue}if(console.log(` ${B.scene_name} `),B.seq)for(let I=0;I<B.seq.length;I++){const P=B.seq[I],{data:Y,error:J}=await je.from("movie_seqs").insert([{sc_id:L.id,name:P.sequence_name,index:I+1}]).select("*").single();if(J){console.error(":",J),q(!1);continue}console.log(` ${P.sequence_name} ${P.shots.length}  ${Y.id}`);for(let Z=0;Z<P.shots.length;Z++){const ae=P.shots[Z],{data:ce,error:he}=await je.from("movie_shots").insert([{seq_id:Y.id,description:ae.description,index:Z+1,prompt:ae.prompt,duration:parseFloat(ae.duration),dialogue:ae.dialogue,embodys:await G(ae.scene,ae.Character,ae.Prop)}]).select("*").single();if(he){console.error(":",he),q(!1);continue}console.log(` ${ae.sequence_name}  ${ce.id}`)}}}m([...p,Q]),M(),await a()}catch(Q){f(": "+Q.message)}finally{q(!1)}},F=async()=>{if(!A.trim()){f("");return}const $=parseInt(A);if(p.find(R=>R.index===$)){f(`${$}`);return}q(!0),f(null);try{let R=!1,U={};if(!R){const L=await(await fetch("./test_story.json",{})).json();console.log("testData:",L),U=L}return}catch(R){f(": "+R.message)}finally{q(!1)}},K=async $=>{try{const{error:Q}=await je.from("movie_eps").delete().eq("id",$.id);if(Q)throw Q;m(p.filter(R=>R.id!==$.id))}catch(Q){f(": "+Q.message)}finally{}};return b.jsxs("div",{className:"ep-editor-container",children:[c&&b.jsxs("div",{className:"shots-loading-overlay",children:[b.jsx("div",{className:"shots-loading-spinner"}),b.jsx("div",{className:"shots-loading-text",children:"..."})]}),b.jsx("div",{className:"ep-editor-header",children:b.jsx("button",{className:"add-ep-button",onClick:E,children:"+ "})}),h&&b.jsx("div",{className:"error-message",children:b.jsx("p",{children:h})}),b.jsx("div",{className:"ep-list",children:p.length>0?p.map($=>b.jsxs("div",{className:"ep-card",onClick:()=>O($.id),children:[b.jsx("div",{className:"ep-thumbnail",children:$.pic?b.jsx("img",{src:$.pic,alt:$.title}):b.jsx("span",{children:""})}),b.jsxs("div",{className:"ep-content",children:[b.jsx("h3",{className:"ep-title",children:$.title||`EP ${$.index||""}`}),b.jsx("p",{className:"ep-description",children:$.description||""}),b.jsxs("div",{className:"ep-info",children:[b.jsxs("span",{children:["",$.index||"?",""]}),b.jsx("span",{children:$.created_at?new Date($.created_at).toLocaleDateString():""})]})]}),b.jsx("button",{className:"delete-ep-button",onClick:Q=>{Q.stopPropagation(),K($)},children:""})]},$.id)):b.jsxs("div",{className:"empty-state",children:[b.jsx("h3",{children:""}),b.jsx("p",{children:'""'})]})}),y&&b.jsx("div",{className:"modal-overlay",onClick:M,children:b.jsxs("div",{className:"modal-content",onClick:$=>$.stopPropagation(),children:[b.jsxs("div",{className:"modal-header",children:[b.jsx("h3",{children:""}),b.jsx("button",{className:"close-button",onClick:M,children:""})]}),h&&b.jsx("div",{className:"error-message",children:b.jsx("p",{children:h})}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"ep-number",children:" *"}),b.jsx("input",{id:"ep-number",type:"number",value:A,onChange:$=>{const Q=parseInt($.target.value),R=p.find(U=>U.index===Q);console.log(R),R!=null?f(`${Q}`):f(null),S($.target.value)},placeholder:"",min:"1",required:!0})]}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"ep-description",children:" *"}),b.jsx("textarea",{id:"ep-description",value:x,onChange:$=>w($.target.value),placeholder:"",rows:"18"})]}),b.jsxs("div",{className:"modal-actions",children:[b.jsx("button",{className:"cancel-button",onClick:C,disabled:D,children:""}),b.jsx("button",{className:"cancel-button",onClick:M,children:""}),b.jsx("button",{className:"save-button",onClick:F,disabled:D,children:D?"...":""})]})]})})]})}function vz(){const{projectId:t,setProjectId:e}=On(),[n,s]=k.useState(""),[a,l]=k.useState("script"),[c,d]=k.useState(""),[h,f]=k.useState(null),p=Ls();return k.useEffect(()=>{t&&(Rt.emit("StartEditorMode"),je.from("projects").select("*").eq("id",t).single().then(({data:m,error:y})=>{y?(console.error(":",y),f(""),d("// : ")):s(m.name||"")}),Rt.on("changeEditorMode",m=>{l(m)}),je.from("embodys").select("*").eq("project_id",t).then(({data:m,error:y})=>{y&&(console.error(":",y),f(""),d("// : "))}))},[t]),b.jsxs("div",{className:"editor-container",children:[h&&b.jsx("div",{className:"error-message",children:b.jsx("p",{children:h})}),b.jsxs("div",{className:"editor-header",children:[b.jsx("div",{className:"project_name",onClick:()=>{p("/dashboard"),Rt.emit("EndEditorMode"),e(null)},children:b.jsxs("h3",{children:["< ",n]})}),b.jsxs("div",{className:"editor-nav",children:[b.jsx("div",{className:`editor-nav-item ${a==="script"?"editor-nav-item-selected":""}`,onClick:()=>l("script"),children:""}),b.jsx("div",{className:`editor-nav-item ${a==="shot"?"editor-nav-item-selected":""}`,onClick:()=>l("shot"),children:""}),b.jsx("div",{className:`editor-nav-item ${a==="edit"?"editor-nav-item-selected":""}`,onClick:()=>l("edit"),children:""})]})]}),b.jsxs("div",{className:"editor-content",children:[a==="script"&&b.jsx(yz,{}),a==="shot"&&b.jsx(YI,{}),a==="edit"&&b.jsx(u$,{})]})]})}function _z(){const{projectId:t}=On(),[e,n]=k.useState(!1),[s,a]=k.useState([]),[l,c]=k.useState([]),[d,h]=k.useState([]),[f,p]=k.useState(""),[m,y]=k.useState("all"),[_,x]=k.useState(!0),[w,A]=k.useState(""),[S,T]=k.useState([]),[E,C]=k.useState(""),j=k.useRef(null),[O,M]=k.useState(null),[D,q]=k.useState({type:"",name:"",pic:"",description:"",embody_images:[]}),[G,V]=k.useState(!1),[F,K]=k.useState(!1),[$,Q]=k.useState({project_id:t,type:"scene",name:"",prompt:"",description:"",pic:""}),[R,U]=k.useState(null),[B,L]=k.useState("");k.useEffect(()=>{if(!t){A("ID Embody"),x(!1);return}const te=new AbortController;return I(te),()=>{console.log("FetchEmboody:",te.signal),te.abort()}},[t]),k.useEffect(()=>{},[G]);const H=(te,fe)=>{const Te=S.filter(Xe=>Xe.type===fe);if(f.trim()==="")return Te;const De=f.toLowerCase();return Te.filter(Xe=>Xe.name.toLowerCase().includes(De)||Xe.description&&Xe.description.toLowerCase().includes(De))},I=async te=>{if(!t)return A("ID Embody"),alert("ID Embody"),x(!1),null;x(!0),A("");try{console.log(" ID:",t);const{data:fe}=await je.from("embodys").select(`
                    *,
                    embody_images (
                        *
                    )
                `).abortSignal(te.signal).eq("project_id",t);T(fe||[]),console.log(":",fe||[])}catch(fe){fe.name==="AbortError"?console.log("FetchEmboody:",fe):(console.error(":",fe),A(""))}finally{x(!1)}},P=te=>{const fe=S.find(Te=>Te.id===te);fe&&(console.log(":",fe),M(te),q({id:fe.id,type:fe.type,name:fe.name||"",pic:fe.pic||"",description:fe.description||"",prompt:fe.prompt||"",embody_images:fe.embody_images||[]}))},Y=async()=>{if(O)try{console.log(":",O,D);const{error:te}=await je.from("embodys").update({name:D.name,type:D.type,description:D.description,prompt:D.prompt}).eq("id",O);if(te){console.error(":",te),alert("");return}I(new AbortController),M(null)}catch(te){console.error(":",te),alert("")}},J=async()=>{try{const te=D.type==="scene"?"":D.type==="character"?"":"",fe=D.name||`${te}`;alert("..."),await new Promise(De=>setTimeout(De,1e3));let Te="";D.type==="scene"?Te=`${fe}8K`:D.type==="character"?Te=`${fe}8K`:Te=`${fe}3D8K`,q({...D,prompt:Te}),alert("")}catch(te){console.error(":",te),alert("")}},Z=()=>{j.current.click()},ae=async te=>{const fe=Array.from(te.target.files);if(fe.length>0){n(!0),console.log("Selected file:",fe),fe.forEach((et,pn)=>{console.log(":",et)}),console.log(D);let Te=fe.map(async(et,pn)=>{const Gt=Date.now(),ft=et.name.split(".").pop()||"",gn=`public/${t}/${D.type}/${Gt}_${pn}${ft?"."+ft:""}`;console.log(":",gn);const{data:kn,error:nn}=await je.storage.from("embodys").upload(gn,et,{cacheControl:"3600",upsert:!1});if(nn)throw console.error(":",nn),new Error(": "+nn.message);const{data:rn,error:br}=await je.from("embody_images").insert({description:$.description,path:gn,ref_id:D.id}).select("id, path").single();if(br)throw console.error("embody-images:",br),new Error("images: "+br.message);return console.log(":",rn),{insertedDataId:rn.id,fileName:gn}});const De=await Promise.all(Te);let Xe=De.map(et=>et.insertedDataId),ct=De.map(et=>({path:et.fileName}));console.log("IDs:",Xe),console.log(":",ct),q({...D,images:ct}),n(!1),I(new AbortController)}},ce=async()=>{try{if(!D.prompt){alert("");return}alert("..."),await new Promise(te=>setTimeout(te,2e3)),alert(`
AI`)}catch(te){console.error(":",te),alert("")}},he=async()=>{if(!$.name.trim()){alert("");return}if(!$.prompt.trim()){alert("");return}if(!$.description.trim()){alert("");return}if(!$.project_id&&($.project_id=globalData.projectId||localStorage.getItem("projectId"),!$.project_id)){alert("ID"),K(!1);return}try{let te=$.pic,fe="";if(R){const ct=Date.now(),et=R.name.split(".").pop()||"";fe=`${$.project_id}/${$.type}s/${ct}${et?"."+et:""}`,console.log(":",fe);const{data:pn,error:Gt}=await je.storage.from("embodys").upload(fe,R,{cacheControl:"3600",upsert:!1});if(Gt)throw console.error(":",Gt),new Error(": "+Gt.message);const{data:{publicUrl:ft}}=await je.storage.from("embodys").getPublicUrl(fe);te=ft,console.log("URL:",te)}const Te={...$,pic:fe};console.log(":",Te);const{data:De,error:Xe}=await je.from("embodys").insert([Te]);if(Xe)throw console.error(":",Xe),Xe;V(ct=>!ct),K(!1),Q({project_id:globalData.projectId||localStorage.getItem("projectId"),type:"scene",name:"",prompt:"",description:"",pic:""}),U(null),L(""),document.getElementById("embody-file")&&(document.getElementById("embody-file").value=""),alert("")}catch(te){console.error(":",te),alert(""+(te.message||""))}},ye=async(te,fe)=>{if(window.confirm(`${fe==="scene"?"":fe==="character"?"":""}`))try{const{error:Te}=await je.from("embodys").delete().eq("id",te);if(Te)throw Te;console.log(":",te),I(new AbortController)}catch(Te){console.error(":",Te)}},_e=(()=>{const te=S.filter(De=>De.type==="scene").length,fe=S.filter(De=>De.type==="character").length,Te=S.filter(De=>De.type==="item").length;return{scene:te,character:fe,item:Te,all:te+fe+Te}})(),be=H(s,"scene"),we=H(l,"character"),ue=H(d,"item");return b.jsxs("div",{className:"embody-container",children:[b.jsxs("div",{className:"embody-left-panel",children:[b.jsxs("div",{className:"embody-header",children:[b.jsxs("div",{className:"header-left",children:[b.jsx("h2",{children:""}),b.jsxs("p",{className:"total-count",children:[E," -  ",_e.all," "]})]}),b.jsxs("div",{className:"header-right",children:[b.jsx("input",{type:"file",multiple:!0,ref:j,style:{display:"none"},onChange:ae}),b.jsx("div",{className:"search-bar",children:b.jsx("input",{type:"text",placeholder:"...",value:f,onChange:te=>p(te.target.value)})})]})]}),b.jsxs("div",{className:"category-filter",children:[b.jsxs("button",{className:`filter-btn ${m==="all"?"active":""}`,onClick:()=>y("all"),children:[" (",_e.all,")"]}),b.jsxs("button",{className:`filter-btn ${m==="scene"?"active":""}`,onClick:()=>y("scene"),children:[" (",_e.scene,")"]}),b.jsxs("button",{className:`filter-btn ${m==="character"?"active":""}`,onClick:()=>y("character"),children:[" (",_e.character,")"]}),b.jsxs("button",{className:`filter-btn ${m==="item"?"active":""}`,onClick:()=>y("item"),children:[" (",_e.item,")"]}),b.jsx("button",{onClick:()=>K(!0),className:"add-embody-btn",children:""})]}),b.jsx("div",{className:"embody-content",children:_?b.jsxs("div",{className:"loading-container",children:[b.jsx("div",{className:"loading-spinner"}),b.jsx("p",{children:"..."})]}):w?b.jsxs("div",{className:"error-container",children:[b.jsx("p",{className:"error-message",children:w}),b.jsx("button",{className:"retry-btn",onClick:()=>I(new AbortController),children:""})]}):b.jsxs(b.Fragment,{children:[(m==="all"||m==="scene")&&be.length>0&&b.jsxs("div",{className:"category-section",children:[b.jsx("h3",{className:"section-title",children:""}),b.jsx("div",{className:"card-grid",children:be.map(te=>b.jsx(ld,{id:te.id,type:"scene",name:te.name,pic:te.embody_images,description:te.description,onEdit:()=>P(te.id),onDelete:()=>ye(te.id,"scene")},te.id))})]}),(m==="all"||m==="character")&&we.length>0&&b.jsxs("div",{className:"category-section",children:[b.jsx("h3",{className:"section-title",children:""}),b.jsx("div",{className:"card-grid",children:we.map(te=>b.jsx(ld,{id:te.id,type:"character",name:te.name,pic:te.embody_images,description:te.description,onEdit:()=>P(te.id),onDelete:()=>ye(te.id,"character")},te.id))})]}),(m==="all"||m==="item")&&ue.length>0&&b.jsxs("div",{className:"category-section",children:[b.jsx("h3",{className:"section-title",children:""}),b.jsx("div",{className:"card-grid",children:ue.map(te=>b.jsx(ld,{id:te.id,type:"item",name:te.name,pic:te.embody_images,description:te.description,onEdit:()=>P(te.id),onDelete:()=>ye(te.id,"item")},te.id))})]}),(m==="all"&&_e.all===0||m==="scene"&&be.length===0||m==="character"&&we.length===0||m==="item"&&ue.length===0)&&b.jsx("div",{className:"empty-container",children:b.jsx("p",{children:""})})]})})]}),b.jsx("div",{className:"embody-right-panel",children:O?b.jsxs("div",{className:"edit-panel",children:[b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"edit-name",children:""}),b.jsx("input",{id:"edit-name",type:"text",value:D.name,onChange:te=>q({...D,name:te.target.value}),placeholder:""})]}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"edit-type",children:""}),b.jsxs("select",{id:"edit-type",value:D.type,onChange:te=>q({...D,type:te.target.value}),children:[b.jsx("option",{value:"scene",children:""}),b.jsx("option",{value:"character",children:""}),b.jsx("option",{value:"item",children:""})]})]}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"edit-description",children:""}),b.jsx("textarea",{id:"edit-description",value:D.description,onChange:te=>q({...D,description:te.target.value}),placeholder:"",rows:"3"})]}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"edit-prompt",children:""}),b.jsx("textarea",{id:"edit-prompt",value:D.prompt,onChange:te=>q({...D,prompt:te.target.value}),placeholder:"AI",rows:"4"}),b.jsx("button",{className:"prompt-generate-btn",onClick:J,children:""})]}),b.jsx("div",{className:"form-group",children:b.jsx("div",{className:"preview-images-container",children:D.embody_images.map((te,fe)=>b.jsx("div",{className:"small-preview-image",children:b.jsx("img",{src:gi+te.path,alt:D.name})},fe))})}),D.pic&&b.jsx("div",{className:"preview-image",children:b.jsx("img",{src:gi+D.pic,alt:D.name})}),b.jsxs("button",{className:"",onClick:Z,disabled:e,children:[" ",e?"...":""]}),b.jsx("button",{className:"generate-image-btn",onClick:ce,children:"AI"}),b.jsx("button",{className:"save-btn",onClick:Y,children:""}),b.jsx("button",{className:"cancel-btn",onClick:()=>M(null),children:""})]}):b.jsx("div",{className:"empty-edit-panel",children:b.jsx("p",{children:""})})}),F&&b.jsx("div",{className:"modal-overlay",onClick:()=>K(!1),children:b.jsxs("div",{className:"modal-content",onClick:te=>te.stopPropagation(),children:[b.jsxs("div",{className:"modal-header",children:[b.jsx("h3",{children:""}),b.jsx("button",{className:"close-btn",onClick:()=>K(!1),children:""})]}),b.jsxs("div",{className:"modal-body",children:[b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"embody-type",children:""}),b.jsxs("select",{id:"embody-type",value:$.type,onChange:te=>Q({...$,type:te.target.value}),children:[b.jsx("option",{value:"scene",children:""}),b.jsx("option",{value:"character",children:""}),b.jsx("option",{value:"item",children:""})]})]}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"embody-name",children:""}),b.jsx("input",{type:"text",id:"embody-name",value:$.name,onChange:te=>Q({...$,name:te.target.value}),placeholder:""})]}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"embody-prompt",children:""}),b.jsx("textarea",{id:"embody-prompt",value:$.prompt,onChange:te=>Q({...$,prompt:te.target.value}),placeholder:"",rows:"3"})]}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"embody-description",children:""}),b.jsx("textarea",{id:"embody-description",value:$.description,onChange:te=>Q({...$,description:te.target.value}),placeholder:"",rows:"4"})]}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{children:""}),b.jsxs("div",{className:"file-upload-container",children:[b.jsx("input",{type:"file",multiple:!0,id:"embody-file",accept:"image/*",onChange:te=>{const fe=te.target.files[0];if(U(fe),fe){const Te=URL.createObjectURL(fe);L(Te)}else L("")},style:{display:"none"}}),b.jsx("button",{type:"button",className:"file-upload-btn",onClick:()=>document.getElementById("embody-file").click(),children:R?R.name:""}),B&&b.jsxs("div",{className:"image-preview",children:[b.jsx("img",{src:B,alt:""}),b.jsx("button",{type:"button",className:"remove-image-btn",onClick:()=>{U(null),L(""),document.getElementById("embody-file").value=""},children:""})]})]})]})]}),b.jsxs("div",{className:"modal-footer",children:[b.jsx("button",{className:"cancel-btn",onClick:()=>K(!1),children:""}),b.jsx("button",{className:"save-btn",onClick:()=>he(),children:""})]})]})})]})}function id(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Sp={exports:{}};var Xx;function bz(){return Xx||(Xx=1,(function(t,e){(function(n){t.exports=n()})(function(){return(function(){function n(s,a,l){function c(f,p){if(!a[f]){if(!s[f]){var m=typeof id=="function"&&id;if(!p&&m)return m(f,!0);if(d)return d(f,!0);var y=new Error("Cannot find module '"+f+"'");throw y.code="MODULE_NOT_FOUND",y}var _=a[f]={exports:{}};s[f][0].call(_.exports,function(x){var w=s[f][1][x];return c(w||x)},_,_.exports,n,s,a,l)}return a[f].exports}for(var d=typeof id=="function"&&id,h=0;h<l.length;h++)c(l[h]);return c}return n})()({1:[function(n,s,a){var l=n("multimath"),c=n("./mm_unsharp_mask"),d=n("./mm_resize");function h(f){var p=f||[],m={js:p.indexOf("js")>=0,wasm:p.indexOf("wasm")>=0};l.call(this,m),this.features={js:m.js,wasm:m.wasm&&this.has_wasm()},this.use(c),this.use(d)}h.prototype=Object.create(l.prototype),h.prototype.constructor=h,h.prototype.resizeAndUnsharp=function(p,m){var y=this.resize(p,m);return p.unsharpAmount&&this.unsharp_mask(y,p.toWidth,p.toHeight,p.unsharpAmount,p.unsharpRadius,p.unsharpThreshold),y},s.exports=h},{"./mm_resize":4,"./mm_unsharp_mask":9,multimath:19}],2:[function(n,s,a){function l(m){return m<0?0:m>255?255:m}function c(m){return m>=0?m:0}function d(m,y,_,x,w,A){var S,T,E,C,j,O,M,D,q,G,V,F=0,K=0;for(q=0;q<x;q++){for(j=0,G=0;G<w;G++){for(O=A[j++],M=A[j++],D=F+O*4|0,S=T=E=C=0;M>0;M--)V=A[j++],C=C+V*m[D+3]|0,E=E+V*m[D+2]|0,T=T+V*m[D+1]|0,S=S+V*m[D]|0,D=D+4|0;y[K+3]=c(C>>7),y[K+2]=c(E>>7),y[K+1]=c(T>>7),y[K]=c(S>>7),K=K+x*4|0}K=(q+1)*4|0,F=(q+1)*_*4|0}}function h(m,y,_,x,w,A){var S,T,E,C,j,O,M,D,q,G,V,F=0,K=0;for(q=0;q<x;q++){for(j=0,G=0;G<w;G++){for(O=A[j++],M=A[j++],D=F+O*4|0,S=T=E=C=0;M>0;M--)V=A[j++],C=C+V*m[D+3]|0,E=E+V*m[D+2]|0,T=T+V*m[D+1]|0,S=S+V*m[D]|0,D=D+4|0;S>>=7,T>>=7,E>>=7,C>>=7,y[K+3]=l(C+8192>>14),y[K+2]=l(E+8192>>14),y[K+1]=l(T+8192>>14),y[K]=l(S+8192>>14),K=K+x*4|0}K=(q+1)*4|0,F=(q+1)*_*4|0}}function f(m,y,_,x,w,A){var S,T,E,C,j,O,M,D,q,G,V,F,K=0,$=0;for(G=0;G<x;G++){for(O=0,V=0;V<w;V++){for(M=A[O++],D=A[O++],q=K+M*4|0,S=T=E=C=0;D>0;D--)F=A[O++],j=m[q+3],C=C+F*j|0,E=E+F*m[q+2]*j|0,T=T+F*m[q+1]*j|0,S=S+F*m[q]*j|0,q=q+4|0;E=E/255|0,T=T/255|0,S=S/255|0,y[$+3]=c(C>>7),y[$+2]=c(E>>7),y[$+1]=c(T>>7),y[$]=c(S>>7),$=$+x*4|0}$=(G+1)*4|0,K=(G+1)*_*4|0}}function p(m,y,_,x,w,A){var S,T,E,C,j,O,M,D,q,G,V,F=0,K=0;for(q=0;q<x;q++){for(j=0,G=0;G<w;G++){for(O=A[j++],M=A[j++],D=F+O*4|0,S=T=E=C=0;M>0;M--)V=A[j++],C=C+V*m[D+3]|0,E=E+V*m[D+2]|0,T=T+V*m[D+1]|0,S=S+V*m[D]|0,D=D+4|0;S>>=7,T>>=7,E>>=7,C>>=7,C=l(C+8192>>14),C>0&&(S=S*255/C|0,T=T*255/C|0,E=E*255/C|0),y[K+3]=C,y[K+2]=l(E+8192>>14),y[K+1]=l(T+8192>>14),y[K]=l(S+8192>>14),K=K+x*4|0}K=(q+1)*4|0,F=(q+1)*_*4|0}}s.exports={convolveHor:d,convolveVert:h,convolveHorWithPre:f,convolveVertWithPre:p}},{}],3:[function(n,s,a){s.exports="AGFzbQEAAAAADAZkeWxpbmsAAAAAAAEYA2AGf39/f39/AGAAAGAIf39/f39/f38AAg8BA2VudgZtZW1vcnkCAAADBwYBAAAAAAIGBgF/AEEACweUAQgRX193YXNtX2NhbGxfY3RvcnMAAAtjb252b2x2ZUhvcgABDGNvbnZvbHZlVmVydAACEmNvbnZvbHZlSG9yV2l0aFByZQADE2NvbnZvbHZlVmVydFdpdGhQcmUABApjb252b2x2ZUhWAAUMX19kc29faGFuZGxlAwAYX193YXNtX2FwcGx5X2RhdGFfcmVsb2NzAAAKyA4GAwABC4wDARB/AkAgA0UNACAERQ0AIANBAnQhFQNAQQAhE0EAIQsDQCALQQJqIQcCfyALQQF0IAVqIgYuAQIiC0UEQEEAIQhBACEGQQAhCUEAIQogBwwBCyASIAYuAQBqIQhBACEJQQAhCiALIRRBACEOIAchBkEAIQ8DQCAFIAZBAXRqLgEAIhAgACAIQQJ0aigCACIRQRh2bCAPaiEPIBFB/wFxIBBsIAlqIQkgEUEQdkH/AXEgEGwgDmohDiARQQh2Qf8BcSAQbCAKaiEKIAhBAWohCCAGQQFqIQYgFEEBayIUDQALIAlBB3UhCCAKQQd1IQYgDkEHdSEJIA9BB3UhCiAHIAtqCyELIAEgDEEBdCIHaiAIQQAgCEEAShs7AQAgASAHQQJyaiAGQQAgBkEAShs7AQAgASAHQQRyaiAJQQAgCUEAShs7AQAgASAHQQZyaiAKQQAgCkEAShs7AQAgDCAVaiEMIBNBAWoiEyAERw0ACyANQQFqIg0gAmwhEiANQQJ0IQwgAyANRw0ACwsL2gMBD38CQCADRQ0AIARFDQAgAkECdCEUA0AgCyEMQQAhE0EAIQIDQCACQQJqIQYCfyACQQF0IAVqIgcuAQIiAkUEQEEAIQhBACEHQQAhCkEAIQkgBgwBCyAHLgEAQQJ0IBJqIQhBACEJIAIhCkEAIQ0gBiEHQQAhDkEAIQ8DQCAFIAdBAXRqLgEAIhAgACAIQQF0IhFqLwEAbCAJaiEJIAAgEUEGcmovAQAgEGwgDmohDiAAIBFBBHJqLwEAIBBsIA9qIQ8gACARQQJyai8BACAQbCANaiENIAhBBGohCCAHQQFqIQcgCkEBayIKDQALIAlBB3UhCCANQQd1IQcgDkEHdSEKIA9BB3UhCSACIAZqCyECIAEgDEECdGogB0GAQGtBDnUiBkH/ASAGQf8BSBsiBkEAIAZBAEobQQh0QYD+A3EgCUGAQGtBDnUiBkH/ASAGQf8BSBsiBkEAIAZBAEobQRB0QYCA/AdxIApBgEBrQQ51IgZB/wEgBkH/AUgbIgZBACAGQQBKG0EYdHJyIAhBgEBrQQ51IgZB/wEgBkH/AUgbIgZBACAGQQBKG3I2AgAgAyAMaiEMIBNBAWoiEyAERw0ACyAUIAtBAWoiC2whEiADIAtHDQALCwuSAwEQfwJAIANFDQAgBEUNACADQQJ0IRUDQEEAIRNBACEGA0AgBkECaiEIAn8gBkEBdCAFaiIGLgECIgdFBEBBACEJQQAhDEEAIQ1BACEOIAgMAQsgEiAGLgEAaiEJQQAhDkEAIQ1BACEMIAchFEEAIQ8gCCEGA0AgBSAGQQF0ai4BACAAIAlBAnRqKAIAIhBBGHZsIhEgD2ohDyARIBBBEHZB/wFxbCAMaiEMIBEgEEEIdkH/AXFsIA1qIQ0gESAQQf8BcWwgDmohDiAJQQFqIQkgBkEBaiEGIBRBAWsiFA0ACyAPQQd1IQkgByAIagshBiABIApBAXQiCGogDkH/AW1BB3UiB0EAIAdBAEobOwEAIAEgCEECcmogDUH/AW1BB3UiB0EAIAdBAEobOwEAIAEgCEEEcmogDEH/AW1BB3UiB0EAIAdBAEobOwEAIAEgCEEGcmogCUEAIAlBAEobOwEAIAogFWohCiATQQFqIhMgBEcNAAsgC0EBaiILIAJsIRIgC0ECdCEKIAMgC0cNAAsLC4IEAQ9/AkAgA0UNACAERQ0AIAJBAnQhFANAIAshDEEAIRJBACEHA0AgB0ECaiEKAn8gB0EBdCAFaiICLgECIhNFBEBBACEIQQAhCUEAIQYgCiEHQQAMAQsgAi4BAEECdCARaiEJQQAhByATIQJBACENIAohBkEAIQ5BACEPA0AgBSAGQQF0ai4BACIIIAAgCUEBdCIQai8BAGwgB2ohByAAIBBBBnJqLwEAIAhsIA5qIQ4gACAQQQRyai8BACAIbCAPaiEPIAAgEEECcmovAQAgCGwgDWohDSAJQQRqIQkgBkEBaiEGIAJBAWsiAg0ACyAHQQd1IQggDUEHdSEJIA9BB3UhBiAKIBNqIQcgDkEHdQtBgEBrQQ51IgJB/wEgAkH/AUgbIgJBACACQQBKGyIKQf8BcQRAIAlB/wFsIAJtIQkgCEH/AWwgAm0hCCAGQf8BbCACbSEGCyABIAxBAnRqIAlBgEBrQQ51IgJB/wEgAkH/AUgbIgJBACACQQBKG0EIdEGA/gNxIAZBgEBrQQ51IgJB/wEgAkH/AUgbIgJBACACQQBKG0EQdEGAgPwHcSAKQRh0ciAIQYBAa0EOdSICQf8BIAJB/wFIGyICQQAgAkEAShtycjYCACADIAxqIQwgEkEBaiISIARHDQALIBQgC0EBaiILbCERIAMgC0cNAAsLC0AAIAcEQEEAIAIgAyAEIAUgABADIAJBACAEIAUgBiABEAQPC0EAIAIgAyAEIAUgABABIAJBACAEIAUgBiABEAIL"},{}],4:[function(n,s,a){s.exports={name:"resize",fn:n("./resize"),wasm_fn:n("./resize_wasm"),wasm_src:n("./convolve_wasm_base64")}},{"./convolve_wasm_base64":3,"./resize":5,"./resize_wasm":8}],5:[function(n,s,a){var l=n("./resize_filter_gen"),c=n("./convolve"),d=c.convolveHor,h=c.convolveVert,f=c.convolveHorWithPre,p=c.convolveVertWithPre;function m(_,x,w){for(var A=3,S=x*w*4|0;A<S;){if(_[A]!==255)return!0;A=A+4|0}return!1}function y(_,x,w){for(var A=3,S=x*w*4|0;A<S;)_[A]=255,A=A+4|0}s.exports=function(x){var w=x.src,A=x.width,S=x.height,T=x.toWidth,E=x.toHeight,C=x.scaleX||x.toWidth/x.width,j=x.scaleY||x.toHeight/x.height,O=x.offsetX||0,M=x.offsetY||0,D=x.dest||new Uint8Array(T*E*4),q=typeof x.filter>"u"?"mks2013":x.filter,G=l(q,A,T,C,O),V=l(q,S,E,j,M),F=new Uint16Array(T*S*4);return m(w,A,S)?(f(w,F,A,S,T,G),p(F,D,S,T,E,V)):(d(w,F,A,S,T,G),h(F,D,S,T,E,V),y(D,T,E)),D}},{"./convolve":2,"./resize_filter_gen":6}],6:[function(n,s,a){var l=n("./resize_filter_info"),c=14;function d(h){return Math.round(h*((1<<c)-1))}s.exports=function(f,p,m,y,_){var x=l.filter[f].fn,w=1/y,A=Math.min(1,y),S=l.filter[f].win/A,T,E,C,j,O,M,D,q,G,V,F,K,$,Q,R,U,B,L=Math.floor((S+1)*2),H=new Int16Array((L+2)*m),I=0,P=!H.subarray||!H.set;for(T=0;T<m;T++){for(E=(T+.5)*w+_,C=Math.max(0,Math.floor(E-S)),j=Math.min(p-1,Math.ceil(E+S)),O=j-C+1,M=new Float32Array(O),D=new Int16Array(O),q=0,G=C,V=0;G<=j;G++,V++)F=x((G+.5-E)*A),q+=F,M[V]=F;for(K=0,V=0;V<M.length;V++)$=M[V]/q,K+=$,D[V]=d($);for(D[m>>1]+=d(1-K),Q=0;Q<D.length&&D[Q]===0;)Q++;if(Q<D.length){for(R=D.length-1;R>0&&D[R]===0;)R--;if(U=C+Q,B=R-Q+1,H[I++]=U,H[I++]=B,!P)H.set(D.subarray(Q,R+1),I),I+=B;else for(V=Q;V<=R;V++)H[I++]=D[V]}else H[I++]=0,H[I++]=0}return H}},{"./resize_filter_info":7}],7:[function(n,s,a){var l={box:{win:.5,fn:function(d){return d<0&&(d=-d),d<.5?1:0}},hamming:{win:1,fn:function(d){if(d<0&&(d=-d),d>=1)return 0;if(d<11920929e-14)return 1;var h=d*Math.PI;return Math.sin(h)/h*(.54+.46*Math.cos(h/1))}},lanczos2:{win:2,fn:function(d){if(d<0&&(d=-d),d>=2)return 0;if(d<11920929e-14)return 1;var h=d*Math.PI;return Math.sin(h)/h*Math.sin(h/2)/(h/2)}},lanczos3:{win:3,fn:function(d){if(d<0&&(d=-d),d>=3)return 0;if(d<11920929e-14)return 1;var h=d*Math.PI;return Math.sin(h)/h*Math.sin(h/3)/(h/3)}},mks2013:{win:2.5,fn:function(d){return d<0&&(d=-d),d>=2.5?0:d>=1.5?-.125*(d-2.5)*(d-2.5):d>=.5?.25*(4*d*d-11*d+7):1.0625-1.75*d*d}}};s.exports={filter:l,f2q:{box:0,hamming:1,lanczos2:2,lanczos3:3},q2f:["box","hamming","lanczos2","lanczos3"]}},{}],8:[function(n,s,a){var l=n("./resize_filter_gen");function c(m,y,_){for(var x=3,w=y*_*4|0;x<w;){if(m[x]!==255)return!0;x=x+4|0}return!1}function d(m,y,_){for(var x=3,w=y*_*4|0;x<w;)m[x]=255,x=x+4|0}function h(m){return new Uint8Array(m.buffer,0,m.byteLength)}var f=!0;try{f=new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0]===1}catch{}function p(m,y,_){if(f){y.set(h(m),_);return}for(var x=_,w=0;w<m.length;w++){var A=m[w];y[x++]=A&255,y[x++]=A>>8&255}}s.exports=function(y){var _=y.src,x=y.width,w=y.height,A=y.toWidth,S=y.toHeight,T=y.scaleX||y.toWidth/y.width,E=y.scaleY||y.toHeight/y.height,C=y.offsetX||0,j=y.offsetY||0,O=y.dest||new Uint8Array(A*S*4),M=typeof y.filter>"u"?"mks2013":y.filter,D=l(M,x,A,T,C),q=l(M,w,S,E,j),G=0,V=Math.max(_.byteLength,O.byteLength),F=this.__align(G+V),K=w*A*4*2,$=this.__align(F+K),Q=this.__align($+D.byteLength),R=Q+q.byteLength,U=this.__instance("resize",R),B=new Uint8Array(this.__memory.buffer),L=new Uint32Array(this.__memory.buffer),H=new Uint32Array(_.buffer);L.set(H),p(D,B,$),p(q,B,Q);var I=U.exports.convolveHV||U.exports._convolveHV;c(_,x,w)?I($,Q,F,x,w,A,S,1):(I($,Q,F,x,w,A,S,0),d(O,A,S));var P=new Uint32Array(O.buffer);return P.set(new Uint32Array(this.__memory.buffer,0,S*A)),O}},{"./resize_filter_gen":6}],9:[function(n,s,a){s.exports={name:"unsharp_mask",fn:n("./unsharp_mask"),wasm_fn:n("./unsharp_mask_wasm"),wasm_src:n("./unsharp_mask_wasm_base64")}},{"./unsharp_mask":10,"./unsharp_mask_wasm":11,"./unsharp_mask_wasm_base64":12}],10:[function(n,s,a){var l=n("glur/mono16");function c(d,h,f){for(var p=h*f,m=new Uint16Array(p),y,_,x,w,A=0;A<p;A++)y=d[4*A],_=d[4*A+1],x=d[4*A+2],w=y>=_&&y>=x?y:_>=x&&_>=y?_:x,m[A]=w<<8;return m}s.exports=function(h,f,p,m,y,_){var x,w,A,S,T;if(!(m===0||y<.5)){y>2&&(y=2);var E=c(h,f,p),C=new Uint16Array(E);l(C,f,p,y);for(var j=m/100*4096+.5|0,O=_<<8,M=f*p,D=0;D<M;D++)x=E[D],S=x-C[D],Math.abs(S)>=O&&(w=x+(j*S+2048>>12),w=w>65280?65280:w,w=w<0?0:w,x=x!==0?x:1,A=(w<<12)/x|0,T=D*4,h[T]=h[T]*A+2048>>12,h[T+1]=h[T+1]*A+2048>>12,h[T+2]=h[T+2]*A+2048>>12)}}},{"glur/mono16":18}],11:[function(n,s,a){s.exports=function(c,d,h,f,p,m){if(!(f===0||p<.5)){p>2&&(p=2);var y=d*h,_=y*4,x=y*2,w=y*2,A=Math.max(d,h)*4,S=32,T=0,E=_,C=E+x,j=C+w,O=j+w,M=O+A,D=this.__instance("unsharp_mask",_+x+w*2+A+S,{exp:Math.exp}),q=new Uint32Array(c.buffer),G=new Uint32Array(this.__memory.buffer);G.set(q);var V=D.exports.hsv_v16||D.exports._hsv_v16;V(T,E,d,h),V=D.exports.blurMono16||D.exports._blurMono16,V(E,C,j,O,M,d,h,p),V=D.exports.unsharp||D.exports._unsharp,V(T,T,E,C,d,h,f,m),q.set(new Uint32Array(this.__memory.buffer,0,y))}}},{}],12:[function(n,s,a){s.exports="AGFzbQEAAAAADAZkeWxpbmsAAAAAAAE0B2AAAGAEf39/fwBgBn9/f39/fwBgCH9/f39/f39/AGAIf39/f39/f30AYAJ9fwBgAXwBfAIZAgNlbnYDZXhwAAYDZW52Bm1lbW9yeQIAAAMHBgAFAgQBAwYGAX8AQQALB4oBCBFfX3dhc21fY2FsbF9jdG9ycwABFl9fYnVpbGRfZ2F1c3NpYW5fY29lZnMAAg5fX2dhdXNzMTZfbGluZQADCmJsdXJNb25vMTYABAdoc3ZfdjE2AAUHdW5zaGFycAAGDF9fZHNvX2hhbmRsZQMAGF9fd2FzbV9hcHBseV9kYXRhX3JlbG9jcwABCsUMBgMAAQvWAQEHfCABRNuGukOCGvs/IAC7oyICRAAAAAAAAADAohAAIgW2jDgCFCABIAKaEAAiAyADoCIGtjgCECABRAAAAAAAAPA/IAOhIgQgBKIgAyACIAKgokQAAAAAAADwP6AgBaGjIgS2OAIAIAEgBSAEmqIiB7Y4AgwgASADIAJEAAAAAAAA8D+gIASioiIItjgCCCABIAMgAkQAAAAAAADwv6AgBKKiIgK2OAIEIAEgByAIoCAFRAAAAAAAAPA/IAahoCIDo7Y4AhwgASAEIAKgIAOjtjgCGAuGBQMGfwl8An0gAyoCDCEVIAMqAgghFiADKgIUuyERIAMqAhC7IRACQCAEQQFrIghBAEgiCQRAIAIhByAAIQYMAQsgAiAALwEAuCIPIAMqAhi7oiIMIBGiIg0gDCAQoiAPIAMqAgS7IhOiIhQgAyoCALsiEiAPoqCgoCIOtjgCACACQQRqIQcgAEECaiEGIAhFDQAgCEEBIAhBAUgbIgpBf3MhCwJ/IAQgCmtBAXFFBEAgDiENIAgMAQsgAiANIA4gEKIgFCASIAAvAQK4Ig+ioKCgIg22OAIEIAJBCGohByAAQQRqIQYgDiEMIARBAmsLIQIgC0EAIARrRg0AA0AgByAMIBGiIA0gEKIgDyAToiASIAYvAQC4Ig6ioKCgIgy2OAIAIAcgDSARoiAMIBCiIA4gE6IgEiAGLwECuCIPoqCgoCINtjgCBCAHQQhqIQcgBkEEaiEGIAJBAkohACACQQJrIQIgAA0ACwsCQCAJDQAgASAFIAhsQQF0aiIAAn8gBkECay8BACICuCINIBW7IhKiIA0gFrsiE6KgIA0gAyoCHLuiIgwgEKKgIAwgEaKgIg8gB0EEayIHKgIAu6AiDkQAAAAAAADwQWMgDkQAAAAAAAAAAGZxBEAgDqsMAQtBAAs7AQAgCEUNACAGQQRrIQZBACAFa0EBdCEBA0ACfyANIBKiIAJB//8DcbgiDSAToqAgDyIOIBCioCAMIBGioCIPIAdBBGsiByoCALugIgxEAAAAAAAA8EFjIAxEAAAAAAAAAABmcQRAIAyrDAELQQALIQMgBi8BACECIAAgAWoiACADOwEAIAZBAmshBiAIQQFKIQMgDiEMIAhBAWshCCADDQALCwvRAgIBfwd8AkAgB0MAAAAAWw0AIARE24a6Q4Ia+z8gB0MAAAA/l7ujIglEAAAAAAAAAMCiEAAiDLaMOAIUIAQgCZoQACIKIAqgIg22OAIQIAREAAAAAAAA8D8gCqEiCyALoiAKIAkgCaCiRAAAAAAAAPA/oCAMoaMiC7Y4AgAgBCAMIAuaoiIOtjgCDCAEIAogCUQAAAAAAADwP6AgC6KiIg+2OAIIIAQgCiAJRAAAAAAAAPC/oCALoqIiCbY4AgQgBCAOIA+gIAxEAAAAAAAA8D8gDaGgIgqjtjgCHCAEIAsgCaAgCqO2OAIYIAYEQANAIAAgBSAIbEEBdGogAiAIQQF0aiADIAQgBSAGEAMgCEEBaiIIIAZHDQALCyAFRQ0AQQAhCANAIAIgBiAIbEEBdGogASAIQQF0aiADIAQgBiAFEAMgCEEBaiIIIAVHDQALCwtxAQN/IAIgA2wiBQRAA0AgASAAKAIAIgRBEHZB/wFxIgIgAiAEQQh2Qf8BcSIDIAMgBEH/AXEiBEkbIAIgA0sbIgYgBiAEIAIgBEsbIAMgBEsbQQh0OwEAIAFBAmohASAAQQRqIQAgBUEBayIFDQALCwuZAgIDfwF8IAQgBWwhBAJ/IAazQwAAgEWUQwAAyEKVu0QAAAAAAADgP6AiC5lEAAAAAAAA4EFjBEAgC6oMAQtBgICAgHgLIQUgBARAIAdBCHQhCUEAIQYDQCAJIAIgBkEBdCIHai8BACIBIAMgB2ovAQBrIgcgB0EfdSIIaiAIc00EQCAAIAZBAnQiCGoiCiAFIAdsQYAQakEMdSABaiIHQYD+AyAHQYD+A0gbIgdBACAHQQBKG0EMdCABQQEgARtuIgEgCi0AAGxBgBBqQQx2OgAAIAAgCEEBcmoiByABIActAABsQYAQakEMdjoAACAAIAhBAnJqIgcgASAHLQAAbEGAEGpBDHY6AAALIAZBAWoiBiAERw0ACwsL"},{}],13:[function(n,s,a){var l=100;function c(d,h){this.create=d,this.available=[],this.acquired={},this.lastId=1,this.timeoutId=0,this.idle=h||2e3}c.prototype.acquire=function(){var d=this,h;return this.available.length!==0?h=this.available.pop():(h=this.create(),h.id=this.lastId++,h.release=function(){return d.release(h)}),this.acquired[h.id]=h,h},c.prototype.release=function(d){var h=this;delete this.acquired[d.id],d.lastUsed=Date.now(),this.available.push(d),this.timeoutId===0&&(this.timeoutId=setTimeout(function(){return h.gc()},l))},c.prototype.gc=function(){var d=this,h=Date.now();this.available=this.available.filter(function(f){return h-f.lastUsed>d.idle?(f.destroy(),!1):!0}),this.available.length!==0?this.timeoutId=setTimeout(function(){return d.gc()},l):this.timeoutId=0},s.exports=c},{}],14:[function(n,s,a){var l=2;s.exports=function(d,h,f,p,m,y){var _=f/d,x=p/h,w=(2*y+l+1)/m;if(w>.5)return[[f,p]];var A=Math.ceil(Math.log(Math.min(_,x))/Math.log(w));if(A<=1)return[[f,p]];for(var S=[],T=0;T<A;T++){var E=Math.round(Math.pow(Math.pow(d,A-T-1)*Math.pow(f,T+1),1/A)),C=Math.round(Math.pow(Math.pow(h,A-T-1)*Math.pow(p,T+1),1/A));S.push([E,C])}return S}},{}],15:[function(n,s,a){var l=1e-5;function c(h){var f=Math.round(h);return Math.abs(h-f)<l?f:Math.floor(h)}function d(h){var f=Math.round(h);return Math.abs(h-f)<l?f:Math.ceil(h)}s.exports=function(f){var p=f.toWidth/f.width,m=f.toHeight/f.height,y=c(f.srcTileSize*p)-2*f.destTileBorder,_=c(f.srcTileSize*m)-2*f.destTileBorder;if(y<1||_<1)throw new Error("Internal error in pica: target tile width/height is too small.");var x,w,A,S,T,E,C=[],j;for(S=0;S<f.toHeight;S+=_)for(A=0;A<f.toWidth;A+=y)x=A-f.destTileBorder,x<0&&(x=0),T=A+y+f.destTileBorder-x,x+T>=f.toWidth&&(T=f.toWidth-x),w=S-f.destTileBorder,w<0&&(w=0),E=S+_+f.destTileBorder-w,w+E>=f.toHeight&&(E=f.toHeight-w),j={toX:x,toY:w,toWidth:T,toHeight:E,toInnerX:A,toInnerY:S,toInnerWidth:y,toInnerHeight:_,offsetX:x/p-c(x/p),offsetY:w/m-c(w/m),scaleX:p,scaleY:m,x:c(x/p),y:c(w/m),width:d(T/p),height:d(E/m)},C.push(j);return C}},{}],16:[function(n,s,a){function l(c){return Object.prototype.toString.call(c)}s.exports.isCanvas=function(d){var h=l(d);return h==="[object HTMLCanvasElement]"||h==="[object OffscreenCanvas]"||h==="[object Canvas]"},s.exports.isImage=function(d){return l(d)==="[object HTMLImageElement]"},s.exports.isImageBitmap=function(d){return l(d)==="[object ImageBitmap]"},s.exports.limiter=function(d){var h=0,f=[];function p(){h<d&&f.length&&(h++,f.shift()())}return function(y){return new Promise(function(_,x){f.push(function(){y().then(function(w){_(w),h--,p()},function(w){x(w),h--,p()})}),p()})}},s.exports.cib_quality_name=function(d){switch(d){case 0:return"pixelated";case 1:return"low";case 2:return"medium"}return"high"},s.exports.cib_support=function(d){return Promise.resolve().then(function(){if(typeof createImageBitmap>"u")return!1;var h=d(100,100);return createImageBitmap(h,0,0,100,100,{resizeWidth:10,resizeHeight:10,resizeQuality:"high"}).then(function(f){var p=f.width===10;return f.close(),h=null,p})}).catch(function(){return!1})},s.exports.worker_offscreen_canvas_support=function(){return new Promise(function(d,h){if(typeof OffscreenCanvas>"u"){d(!1);return}function f(y){if(typeof createImageBitmap>"u"){y.postMessage(!1);return}Promise.resolve().then(function(){var _=new OffscreenCanvas(10,10),x=_.getContext("2d");return x.rect(0,0,1,1),createImageBitmap(_,0,0,1,1)}).then(function(){return y.postMessage(!0)},function(){return y.postMessage(!1)})}var p=btoa("(".concat(f.toString(),")(self);")),m=new Worker("data:text/javascript;base64,".concat(p));m.onmessage=function(y){return d(y.data)},m.onerror=h}).then(function(d){return d},function(){return!1})},s.exports.can_use_canvas=function(d){var h=!1;try{var f=d(2,1),p=f.getContext("2d"),m=p.createImageData(2,1);m.data[0]=12,m.data[1]=23,m.data[2]=34,m.data[3]=255,m.data[4]=45,m.data[5]=56,m.data[6]=67,m.data[7]=255,p.putImageData(m,0,0),m=null,m=p.getImageData(0,0,2,1),m.data[0]===12&&m.data[1]===23&&m.data[2]===34&&m.data[3]===255&&m.data[4]===45&&m.data[5]===56&&m.data[6]===67&&m.data[7]===255&&(h=!0)}catch{}return h},s.exports.cib_can_use_region=function(){return new Promise(function(d){if(typeof Image>"u"||typeof createImageBitmap>"u"){d(!1);return}var h=new Image;h.src="data:image/jpeg;base64,/9j/4QBiRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAYAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAAAAABIAAAAAQAAAEgAAAAB/9sAQwAEAwMEAwMEBAMEBQQEBQYKBwYGBgYNCQoICg8NEBAPDQ8OERMYFBESFxIODxUcFRcZGRsbGxAUHR8dGh8YGhsa/9sAQwEEBQUGBQYMBwcMGhEPERoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoa/8IAEQgAAQACAwERAAIRAQMRAf/EABQAAQAAAAAAAAAAAAAAAAAAAAf/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAF/P//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAQUCf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Bf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Bf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEABj8Cf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8hf//aAAwDAQACAAMAAAAQH//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Qf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Qf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8Qf//Z",h.onload=function(){createImageBitmap(h,0,0,h.width,h.height).then(function(f){f.width===h.width&&f.height===h.height?d(!0):d(!1)},function(){return d(!1)})},h.onerror=function(){return d(!1)}})}},{}],17:[function(n,s,a){s.exports=function(){var l=n("./mathlib"),c;onmessage=function(h){var f=h.data.opts;if(!f.src&&f.srcBitmap){var p=new OffscreenCanvas(f.width,f.height),m=p.getContext("2d");m.drawImage(f.srcBitmap,0,0),f.src=m.getImageData(0,0,f.width,f.height).data,p.width=p.height=0,p=null,f.srcBitmap.close(),f.srcBitmap=null}c||(c=new l(h.data.features));var y=c.resizeAndUnsharp(f);postMessage({data:y},[y.buffer])}}},{"./mathlib":1}],18:[function(n,s,a){var l,c,d,h,f,p,m,y;function _(A){A<.5&&(A=.5);var S=Math.exp(.726*.726)/A,T=Math.exp(-S),E=Math.exp(-2*S),C=(1-T)*(1-T)/(1+2*S*T-E);return l=C,c=C*(S-1)*T,d=C*(S+1)*T,h=-C*E,f=2*T,p=-E,m=(l+c)/(1-f-p),y=(d+h)/(1-f-p),new Float32Array([l,c,d,h,f,p,m,y])}function x(A,S,T,E,C,j){var O,M,D,q,G,V,F,K,$,Q,R,U,B,L;for($=0;$<j;$++){for(V=$*C,F=$,K=0,O=A[V],G=O*E[6],q=G,R=E[0],U=E[1],B=E[4],L=E[5],Q=0;Q<C;Q++)M=A[V],D=M*R+O*U+q*B+G*L,G=q,q=D,O=M,T[K]=q,K++,V++;for(V--,K--,F+=j*(C-1),O=A[V],G=O*E[7],q=G,M=O,R=E[2],U=E[3],Q=C-1;Q>=0;Q--)D=M*R+O*U+q*B+G*L,G=q,q=D,O=M,M=A[V],S[F]=T[K]+q,V--,K--,F-=j}}function w(A,S,T,E){if(E){var C=new Uint16Array(A.length),j=new Float32Array(Math.max(S,T)),O=_(E);x(A,C,j,O,S,T),x(C,A,j,O,T,S)}}s.exports=w},{}],19:[function(n,s,a){var l=n("object-assign"),c=n("./lib/base64decode"),d=n("./lib/wa_detect"),h={js:!0,wasm:!0};function f(p){if(!(this instanceof f))return new f(p);var m=l({},h,p||{});if(this.options=m,this.__cache={},this.__init_promise=null,this.__modules=m.modules||{},this.__memory=null,this.__wasm={},this.__isLE=new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0]===1,!this.options.js&&!this.options.wasm)throw new Error('mathlib: at least "js" or "wasm" should be enabled')}f.prototype.has_wasm=d,f.prototype.use=function(p){return this.__modules[p.name]=p,this.options.wasm&&this.has_wasm()&&p.wasm_fn?this[p.name]=p.wasm_fn:this[p.name]=p.fn,this},f.prototype.init=function(){if(this.__init_promise)return this.__init_promise;if(!this.options.js&&this.options.wasm&&!this.has_wasm())return Promise.reject(new Error(`mathlib: only "wasm" was enabled, but it's not supported`));var p=this;return this.__init_promise=Promise.all(Object.keys(p.__modules).map(function(m){var y=p.__modules[m];return!p.options.wasm||!p.has_wasm()||!y.wasm_fn||p.__wasm[m]?null:WebAssembly.compile(p.__base64decode(y.wasm_src)).then(function(_){p.__wasm[m]=_})})).then(function(){return p}),this.__init_promise},f.prototype.__base64decode=c,f.prototype.__reallocate=function(m){if(!this.__memory)return this.__memory=new WebAssembly.Memory({initial:Math.ceil(m/(64*1024))}),this.__memory;var y=this.__memory.buffer.byteLength;return y<m&&this.__memory.grow(Math.ceil((m-y)/(64*1024))),this.__memory},f.prototype.__instance=function(m,y,_){if(y&&this.__reallocate(y),!this.__wasm[m]){var x=this.__modules[m];this.__wasm[m]=new WebAssembly.Module(this.__base64decode(x.wasm_src))}if(!this.__cache[m]){var w={memoryBase:0,memory:this.__memory,tableBase:0,table:new WebAssembly.Table({initial:0,element:"anyfunc"})};this.__cache[m]=new WebAssembly.Instance(this.__wasm[m],{env:l(w,_||{})})}return this.__cache[m]},f.prototype.__align=function(m,y){y=y||8;var _=m%y;return m+(_?y-_:0)},s.exports=f},{"./lib/base64decode":20,"./lib/wa_detect":21,"object-assign":22}],20:[function(n,s,a){var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";s.exports=function(d){for(var h=d.replace(/[\r\n=]/g,""),f=h.length,p=new Uint8Array(f*3>>2),m=0,y=0,_=0;_<f;_++)_%4===0&&_&&(p[y++]=m>>16&255,p[y++]=m>>8&255,p[y++]=m&255),m=m<<6|l.indexOf(h.charAt(_));var x=f%4*6;return x===0?(p[y++]=m>>16&255,p[y++]=m>>8&255,p[y++]=m&255):x===18?(p[y++]=m>>10&255,p[y++]=m>>2&255):x===12&&(p[y++]=m>>4&255),p}},{}],21:[function(n,s,a){var l;s.exports=function(){if(typeof l<"u"||(l=!1,typeof WebAssembly>"u"))return l;try{var d=new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11]),h=new WebAssembly.Module(d),f=new WebAssembly.Instance(h,{});return f.exports.test(4)!==0&&(l=!0),l}catch{}return l}},{}],22:[function(n,s,a){var l=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable;function h(p){if(p==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(p)}function f(){try{if(!Object.assign)return!1;var p=new String("abc");if(p[5]="de",Object.getOwnPropertyNames(p)[0]==="5")return!1;for(var m={},y=0;y<10;y++)m["_"+String.fromCharCode(y)]=y;var _=Object.getOwnPropertyNames(m).map(function(w){return m[w]});if(_.join("")!=="0123456789")return!1;var x={};return"abcdefghijklmnopqrst".split("").forEach(function(w){x[w]=w}),Object.keys(Object.assign({},x)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}s.exports=f()?Object.assign:function(p,m){for(var y,_=h(p),x,w=1;w<arguments.length;w++){y=Object(arguments[w]);for(var A in y)c.call(y,A)&&(_[A]=y[A]);if(l){x=l(y);for(var S=0;S<x.length;S++)d.call(y,x[S])&&(_[x[S]]=y[x[S]])}}return _}},{}],23:[function(n,s,a){var l=arguments[3],c=arguments[4],d=arguments[5],h=JSON.stringify;s.exports=function(f,p){for(var m,y=Object.keys(d),_=0,x=y.length;_<x;_++){var w=y[_],A=d[w].exports;if(A===f||A&&A.default===f){m=w;break}}if(!m){m=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var S={},_=0,x=y.length;_<x;_++){var w=y[_];S[w]=w}c[m]=["function(require,module,exports){"+f+"(self); }",S]}var T=Math.floor(Math.pow(16,8)*Math.random()).toString(16),E={};E[m]=m,c[T]=["function(require,module,exports){var f = require("+h(m)+");(f.default ? f.default : f)(self);}",E];var C={};j(T);function j(V){C[V]=!0;for(var F in c[V][1]){var K=c[V][1][F];C[K]||j(K)}}var O="("+l+")({"+Object.keys(C).map(function(V){return h(V)+":["+c[V][0]+","+h(c[V][1])+"]"}).join(",")+"},{},["+h(T)+"])",M=window.URL||window.webkitURL||window.mozURL||window.msURL,D=new Blob([O],{type:"text/javascript"});if(p&&p.bare)return D;var q=M.createObjectURL(D),G=new Worker(q);return G.objectURL=q,G}},{}],"/index.js":[function(n,s,a){function l(R,U){return p(R)||f(R,U)||d(R,U)||c()}function c(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d(R,U){if(R){if(typeof R=="string")return h(R,U);var B=Object.prototype.toString.call(R).slice(8,-1);if(B==="Object"&&R.constructor&&(B=R.constructor.name),B==="Map"||B==="Set")return Array.from(R);if(B==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(B))return h(R,U)}}function h(R,U){(U==null||U>R.length)&&(U=R.length);for(var B=0,L=new Array(U);B<U;B++)L[B]=R[B];return L}function f(R,U){var B=R==null?null:typeof Symbol<"u"&&R[Symbol.iterator]||R["@@iterator"];if(B!=null){var L=[],H=!0,I=!1,P,Y;try{for(B=B.call(R);!(H=(P=B.next()).done)&&(L.push(P.value),!(U&&L.length===U));H=!0);}catch(J){I=!0,Y=J}finally{try{!H&&B.return!=null&&B.return()}finally{if(I)throw Y}}return L}}function p(R){if(Array.isArray(R))return R}var m=n("object-assign"),y=n("webworkify"),_=n("./lib/mathlib"),x=n("./lib/pool"),w=n("./lib/utils"),A=n("./lib/worker"),S=n("./lib/stepper"),T=n("./lib/tiler"),E=n("./lib/mm_resize/resize_filter_info"),C={},j=!1;try{typeof navigator<"u"&&navigator.userAgent&&(j=navigator.userAgent.indexOf("Safari")>=0)}catch{}var O=1;typeof navigator<"u"&&(O=Math.min(navigator.hardwareConcurrency||1,4));var M={tile:1024,concurrency:O,features:["js","wasm","ww"],idle:2e3,createCanvas:function(U,B){var L=document.createElement("canvas");return L.width=U,L.height=B,L}},D={filter:"mks2013",unsharpAmount:0,unsharpRadius:0,unsharpThreshold:0},q=!1,G=!1,V=!1,F=!1,K=!1;function $(){return{value:y(A),destroy:function(){if(this.value.terminate(),typeof window<"u"){var U=window.URL||window.webkitURL||window.mozURL||window.msURL;U&&U.revokeObjectURL&&this.value.objectURL&&U.revokeObjectURL(this.value.objectURL)}}}}function Q(R){if(!(this instanceof Q))return new Q(R);this.options=m({},M,R||{});var U="lk_".concat(this.options.concurrency);this.__limit=C[U]||w.limiter(this.options.concurrency),C[U]||(C[U]=this.__limit),this.features={js:!1,wasm:!1,cib:!1,ww:!1},this.__workersPool=null,this.__requested_features=[],this.__mathlib=null}Q.prototype.init=function(){var R=this;if(this.__initPromise)return this.__initPromise;if(typeof ImageData<"u"&&typeof Uint8ClampedArray<"u")try{new ImageData(new Uint8ClampedArray(400),10,10),q=!0}catch{}typeof ImageBitmap<"u"&&(ImageBitmap.prototype&&ImageBitmap.prototype.close?G=!0:this.debug("ImageBitmap does not support .close(), disabled"));var U=this.options.features.slice();if(U.indexOf("all")>=0&&(U=["cib","wasm","js","ww"]),this.__requested_features=U,this.__mathlib=new _(U),U.indexOf("ww")>=0&&typeof window<"u"&&"Worker"in window)try{var B=n("webworkify")(function(){});B.terminate(),this.features.ww=!0;var L="wp_".concat(JSON.stringify(this.options));C[L]?this.__workersPool=C[L]:(this.__workersPool=new x($,this.options.idle),C[L]=this.__workersPool)}catch{}var H=this.__mathlib.init().then(function(J){m(R.features,J.features)}),I;G?I=w.cib_support(this.options.createCanvas).then(function(J){if(R.features.cib&&U.indexOf("cib")<0){R.debug("createImageBitmap() resize supported, but disabled by config");return}U.indexOf("cib")>=0&&(R.features.cib=J)}):I=Promise.resolve(!1),V=w.can_use_canvas(this.options.createCanvas);var P;G&&q&&U.indexOf("ww")!==-1?P=w.worker_offscreen_canvas_support():P=Promise.resolve(!1),P=P.then(function(J){F=J});var Y=w.cib_can_use_region().then(function(J){K=J});return this.__initPromise=Promise.all([H,I,P,Y]).then(function(){return R}),this.__initPromise},Q.prototype.__invokeResize=function(R,U){var B=this;return U.__mathCache=U.__mathCache||{},Promise.resolve().then(function(){return B.features.ww?new Promise(function(L,H){var I=B.__workersPool.acquire();U.cancelToken&&U.cancelToken.catch(function(Y){return H(Y)}),I.value.onmessage=function(Y){I.release(),Y.data.err?H(Y.data.err):L(Y.data)};var P=[];R.src&&P.push(R.src.buffer),R.srcBitmap&&P.push(R.srcBitmap),I.value.postMessage({opts:R,features:B.__requested_features,preload:{wasm_nodule:B.__mathlib.__}},P)}):{data:B.__mathlib.resizeAndUnsharp(R,U.__mathCache)}})},Q.prototype.__extractTileData=function(R,U,B,L,H){if(this.features.ww&&F&&(w.isCanvas(U)||K))return this.debug("Create tile for OffscreenCanvas"),createImageBitmap(L.srcImageBitmap||U,R.x,R.y,R.width,R.height).then(function(Y){return H.srcBitmap=Y,H});if(w.isCanvas(U))return L.srcCtx||(L.srcCtx=U.getContext("2d")),this.debug("Get tile pixel data"),H.src=L.srcCtx.getImageData(R.x,R.y,R.width,R.height).data,H;this.debug("Draw tile imageBitmap/image to temporary canvas");var I=this.options.createCanvas(R.width,R.height),P=I.getContext("2d");return P.globalCompositeOperation="copy",P.drawImage(L.srcImageBitmap||U,R.x,R.y,R.width,R.height,0,0,R.width,R.height),this.debug("Get tile pixel data"),H.src=P.getImageData(0,0,R.width,R.height).data,I.width=I.height=0,H},Q.prototype.__landTileData=function(R,U,B){var L;if(this.debug("Convert raw rgba tile result to ImageData"),U.bitmap)return B.toCtx.drawImage(U.bitmap,R.toX,R.toY),null;if(q)L=new ImageData(new Uint8ClampedArray(U.data),R.toWidth,R.toHeight);else if(L=B.toCtx.createImageData(R.toWidth,R.toHeight),L.data.set)L.data.set(U.data);else for(var H=L.data.length-1;H>=0;H--)L.data[H]=U.data[H];return this.debug("Draw tile"),j?B.toCtx.putImageData(L,R.toX,R.toY,R.toInnerX-R.toX,R.toInnerY-R.toY,R.toInnerWidth+1e-5,R.toInnerHeight+1e-5):B.toCtx.putImageData(L,R.toX,R.toY,R.toInnerX-R.toX,R.toInnerY-R.toY,R.toInnerWidth,R.toInnerHeight),null},Q.prototype.__tileAndResize=function(R,U,B){var L=this,H={srcCtx:null,srcImageBitmap:null,isImageBitmapReused:!1,toCtx:null},I=function(Y){return L.__limit(function(){if(B.canceled)return B.cancelToken;var J={width:Y.width,height:Y.height,toWidth:Y.toWidth,toHeight:Y.toHeight,scaleX:Y.scaleX,scaleY:Y.scaleY,offsetX:Y.offsetX,offsetY:Y.offsetY,filter:B.filter,unsharpAmount:B.unsharpAmount,unsharpRadius:B.unsharpRadius,unsharpThreshold:B.unsharpThreshold};return L.debug("Invoke resize math"),Promise.resolve(J).then(function(Z){return L.__extractTileData(Y,R,B,H,Z)}).then(function(Z){return L.debug("Invoke resize math"),L.__invokeResize(Z,B)}).then(function(Z){return B.canceled?B.cancelToken:(H.srcImageData=null,L.__landTileData(Y,Z,H))})})};return Promise.resolve().then(function(){if(H.toCtx=U.getContext("2d"),w.isCanvas(R))return null;if(w.isImageBitmap(R))return H.srcImageBitmap=R,H.isImageBitmapReused=!0,null;if(w.isImage(R))return G?(L.debug("Decode image via createImageBitmap"),createImageBitmap(R).then(function(P){H.srcImageBitmap=P}).catch(function(P){return null})):null;throw new Error('Pica: ".from" should be Image, Canvas or ImageBitmap')}).then(function(){if(B.canceled)return B.cancelToken;L.debug("Calculate tiles");var P=T({width:B.width,height:B.height,srcTileSize:L.options.tile,toWidth:B.toWidth,toHeight:B.toHeight,destTileBorder:B.__destTileBorder}),Y=P.map(function(Z){return I(Z)});function J(Z){Z.srcImageBitmap&&(Z.isImageBitmapReused||Z.srcImageBitmap.close(),Z.srcImageBitmap=null)}return L.debug("Process tiles"),Promise.all(Y).then(function(){return L.debug("Finished!"),J(H),U},function(Z){throw J(H),Z})})},Q.prototype.__processStages=function(R,U,B,L){var H=this;if(L.canceled)return L.cancelToken;var I=R.shift(),P=l(I,2),Y=P[0],J=P[1],Z=R.length===0,ae;Z||E.q2f.indexOf(L.filter)<0?ae=L.filter:L.filter==="box"?ae="box":ae="hamming",L=m({},L,{toWidth:Y,toHeight:J,filter:ae});var ce;return Z||(ce=this.options.createCanvas(Y,J)),this.__tileAndResize(U,Z?B:ce,L).then(function(){return Z?B:(L.width=Y,L.height=J,H.__processStages(R,ce,B,L))}).then(function(he){return ce&&(ce.width=ce.height=0),he})},Q.prototype.__resizeViaCreateImageBitmap=function(R,U,B){var L=this,H=U.getContext("2d");return this.debug("Resize via createImageBitmap()"),createImageBitmap(R,{resizeWidth:B.toWidth,resizeHeight:B.toHeight,resizeQuality:w.cib_quality_name(E.f2q[B.filter])}).then(function(I){if(B.canceled)return B.cancelToken;if(!B.unsharpAmount)return H.drawImage(I,0,0),I.close(),H=null,L.debug("Finished!"),U;L.debug("Unsharp result");var P=L.options.createCanvas(B.toWidth,B.toHeight),Y=P.getContext("2d");Y.drawImage(I,0,0),I.close();var J=Y.getImageData(0,0,B.toWidth,B.toHeight);return L.__mathlib.unsharp_mask(J.data,B.toWidth,B.toHeight,B.unsharpAmount,B.unsharpRadius,B.unsharpThreshold),H.putImageData(J,0,0),P.width=P.height=0,J=Y=P=H=null,L.debug("Finished!"),U})},Q.prototype.resize=function(R,U,B){var L=this;this.debug("Start resize...");var H=m({},D);if(isNaN(B)?B&&(H=m(H,B)):H=m(H,{quality:B}),H.toWidth=U.width,H.toHeight=U.height,H.width=R.naturalWidth||R.width,H.height=R.naturalHeight||R.height,Object.prototype.hasOwnProperty.call(H,"quality")){if(H.quality<0||H.quality>3)throw new Error("Pica: .quality should be [0..3], got ".concat(H.quality));H.filter=E.q2f[H.quality]}if(U.width===0||U.height===0)return Promise.reject(new Error("Invalid output size: ".concat(U.width,"x").concat(U.height)));H.unsharpRadius>2&&(H.unsharpRadius=2),H.canceled=!1,H.cancelToken&&(H.cancelToken=H.cancelToken.then(function(P){throw H.canceled=!0,P},function(P){throw H.canceled=!0,P}));var I=3;return H.__destTileBorder=Math.ceil(Math.max(I,2.5*H.unsharpRadius|0)),this.init().then(function(){if(H.canceled)return H.cancelToken;if(L.features.cib){if(E.q2f.indexOf(H.filter)>=0)return L.__resizeViaCreateImageBitmap(R,U,H);L.debug("cib is enabled, but not supports provided filter, fallback to manual math")}if(!V){var P=new Error("Pica: cannot use getImageData on canvas, make sure fingerprinting protection isn't enabled");throw P.code="ERR_GET_IMAGE_DATA",P}var Y=S(H.width,H.height,H.toWidth,H.toHeight,L.options.tile,H.__destTileBorder);return L.__processStages(Y,R,U,H)})},Q.prototype.resizeBuffer=function(R){var U=this,B=m({},D,R);if(Object.prototype.hasOwnProperty.call(B,"quality")){if(B.quality<0||B.quality>3)throw new Error("Pica: .quality should be [0..3], got ".concat(B.quality));B.filter=E.q2f[B.quality]}return this.init().then(function(){return U.__mathlib.resizeAndUnsharp(B)})},Q.prototype.toBlob=function(R,U,B){return U=U||"image/png",new Promise(function(L){if(R.toBlob){R.toBlob(function(J){return L(J)},U,B);return}if(R.convertToBlob){L(R.convertToBlob({type:U,quality:B}));return}for(var H=atob(R.toDataURL(U,B).split(",")[1]),I=H.length,P=new Uint8Array(I),Y=0;Y<I;Y++)P[Y]=H.charCodeAt(Y);L(new Blob([P],{type:U}))})},Q.prototype.debug=function(){},s.exports=Q},{"./lib/mathlib":1,"./lib/mm_resize/resize_filter_info":7,"./lib/pool":13,"./lib/stepper":14,"./lib/tiler":15,"./lib/utils":16,"./lib/worker":17,"object-assign":22,webworkify:23}]},{},[])("/index.js")})})(Sp)),Sp.exports}var wz=bz();const xz=Fl(wz);function Az(){const t=On(),{refreshShotsData:e}=On();k.useEffect(()=>{n.current=t},[e]);const n=k.useRef(t);k.useEffect(()=>(Rt.on("makeShotThumb",(p,m)=>{console.log("1:",p,m),f(p,m)}),()=>{}),[]);const s=300,a=200,[l,c]=k.useState(""),d=xz(),h=async p=>{const m=Math.min(s/p.width,a/p.height),y=p.width*m,_=p.height*m,x=document.createElement("canvas");x.width=y,x.height=_;const w=await d.resize(p,x,{unsharpAmount:80,unsharpRadius:.6,unsharpThreshold:2});return d.toBlob(w,"image/jpeg",.85)},f=async(p,m)=>{console.log("saveSmallImage",p,m);{const y=await fetch(m,{mode:"cors"});if(!y.ok)throw new Error(`Failed to fetch image: ${y.status} ${y.statusText}`);const _=await y.blob(),x=URL.createObjectURL(_),w=new Image;await new Promise((O,M)=>{w.onload=O,w.onerror=M,w.src=x});const A=await h(w),S=URL.createObjectURL(A);c(S),console.log(S),console.log("Resized Blob size:",(A.size/1024).toFixed(2),"KB"),URL.revokeObjectURL(x);const T=`public/small_images/resized_${Date.now()}.jpeg`,E="shot_images",{data:C,error:j}=await je.storage.from(E).upload(T,A,{contentType:"image/jpeg",cacheControl:"3600",upsert:!1});if(j)return console.log("Upload Error:",j),j;{const{data:O}=je.storage.from(E).getPublicUrl(T);console.log("Upload successful:",O.publicUrl),je.from("movie_shots").update({pic:O.publicUrl}).eq("id",p).then(({data:M,error:D})=>{if(D){console.error(":",D);return}console.log("");const q=n.current.refreshShotsData;q()})}}};return b.jsx(b.Fragment,{})}function Ez(){const[t,e]=k.useState(null),[n,s]=k.useState(!1),[a,l]=k.useState("");k.useEffect(()=>{const d=async()=>{const{data:{user:f}}=await je.auth.getUser();e(f)},{data:h}=je.auth.onAuthStateChange((f,p)=>{e(p?.user||null)});return d(),Rt.on("StartEditorMode",()=>{console.log(":")}),Rt.on("EndEditorMode",()=>{console.log("")}),Rt.on("showLargeImageModal",f=>{s(!0),l(f)}),()=>{}},[]);function c(d){const h=document.documentElement;h.style.setProperty("--left-panel-width","40px"),h.style.setProperty("--logo-text-display","none")}return c(),b.jsx(zI,{children:b.jsxs(pj,{children:[b.jsxs("div",{className:"layout-container",children:[b.jsxs("div",{className:"left-panel",children:[b.jsxs(bi,{to:"/",className:"home-logo",children:[b.jsx("img",{className:"home-logo-img",src:"./vite.svg",alt:"home"}),b.jsx("p",{className:"home-logo-text",children:"AI"})]}),b.jsxs("div",{className:"nav-items",children:[b.jsxs(bi,{to:"/dashboard",className:"nav-item",title:"",children:[b.jsx("img",{className:"nav-item-icon",src:"./home.png",alt:""}),b.jsx("span",{children:""})]}),b.jsxs(bi,{to:"/embody",className:"nav-item",title:"",children:[b.jsx("img",{className:"nav-item-icon",src:"./layers.png",alt:""}),b.jsx("span",{children:"  "})]})]}),b.jsx(PI,{}),b.jsx(Az,{})]}),b.jsx("div",{className:"right-panel",children:b.jsxs(VR,{children:[b.jsx(Ms,{path:"/",element:b.jsx(GI,{})}),b.jsx(Ms,{path:"/editor",element:b.jsx(vz,{})}),b.jsx(Ms,{path:"/embody",element:b.jsx(_z,{})}),b.jsx(Ms,{path:"/login",element:b.jsx(HI,{})}),b.jsx(Ms,{path:"/register",element:b.jsx(qI,{})}),b.jsx(Ms,{path:"/dashboard",element:b.jsx(FI,{})}),b.jsx(Ms,{path:"/profile",element:b.jsx(VI,{})})]})})]}),n&&b.jsxs("div",{className:"large-image-modal",children:[b.jsx("img",{src:a,alt:"Large Character Preview"}),b.jsx("button",{onClick:()=>s(!1),children:""})]})]})})}nR.createRoot(document.getElementById("root")).render(b.jsx(k.StrictMode,{children:b.jsx(Ez,{})}));
