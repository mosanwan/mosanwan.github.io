function FN(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in t)){const l=Object.getOwnPropertyDescriptor(s,a);l&&Object.defineProperty(t,a,l.get?l:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();function Yl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Kx(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function s(){var a=!1;try{a=this instanceof s}catch{}return a?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var a=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,a.get?a:{enumerable:!0,get:function(){return t[s]}})}),n}var $m={exports:{}},Wo={};var ib;function GN(){if(ib)return Wo;ib=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(s,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var d in a)d!=="key"&&(l[d]=a[d])}else l=a;return a=l.ref,{$$typeof:t,type:s,key:c,ref:a!==void 0?a:null,props:l}}return Wo.Fragment=e,Wo.jsx=n,Wo.jsxs=n,Wo}var ab;function YN(){return ab||(ab=1,$m.exports=GN()),$m.exports}var b=YN(),zm={exports:{}},Le={};var ob;function XN(){if(ob)return Le;ob=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.for("react.activity"),y=Symbol.iterator;function _(M){return M===null||typeof M!="object"?null:(M=y&&M[y]||M["@@iterator"],typeof M=="function"?M:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,A={};function S(M,q,X){this.props=M,this.context=q,this.refs=A,this.updater=X||x}S.prototype.isReactComponent={},S.prototype.setState=function(M,q){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,q,"setState")},S.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function T(){}T.prototype=S.prototype;function E(M,q,X){this.props=M,this.context=q,this.refs=A,this.updater=X||x}var C=E.prototype=new T;C.constructor=E,w(C,S.prototype),C.isPureReactComponent=!0;var O=Array.isArray;function j(){}var I={H:null,A:null,T:null,S:null},D=Object.prototype.hasOwnProperty;function P(M,q,X){var Z=X.ref;return{$$typeof:t,type:M,key:q,ref:Z!==void 0?Z:null,props:X}}function G(M,q){return P(M.type,q,M.props)}function V(M){return typeof M=="object"&&M!==null&&M.$$typeof===t}function z(M){var q={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(X){return q[X]})}var Y=/\/+/g;function H(M,q){return typeof M=="object"&&M!==null&&M.key!=null?z(""+M.key):q.toString(36)}function F(M){switch(M.status){case"fulfilled":return M.value;case"rejected":throw M.reason;default:switch(typeof M.status=="string"?M.then(j,j):(M.status="pending",M.then(function(q){M.status==="pending"&&(M.status="fulfilled",M.value=q)},function(q){M.status==="pending"&&(M.status="rejected",M.reason=q)})),M.status){case"fulfilled":return M.value;case"rejected":throw M.reason}}throw M}function N(M,q,X,Z,J){var ae=typeof M;(ae==="undefined"||ae==="boolean")&&(M=null);var ce=!1;if(M===null)ce=!0;else switch(ae){case"bigint":case"string":case"number":ce=!0;break;case"object":switch(M.$$typeof){case t:case e:ce=!0;break;case p:return ce=M._init,N(ce(M._payload),q,X,Z,J)}}if(ce)return J=J(M),ce=Z===""?"."+H(M,0):Z,O(J)?(X="",ce!=null&&(X=ce.replace(Y,"$&/")+"/"),N(J,q,X,"",function(oe){return oe})):J!=null&&(V(J)&&(J=G(J,X+(J.key==null||M&&M.key===J.key?"":(""+J.key).replace(Y,"$&/")+"/")+ce)),q.push(J)),1;ce=0;var de=Z===""?".":Z+":";if(O(M))for(var ie=0;ie<M.length;ie++)Z=M[ie],ae=de+H(Z,ie),ce+=N(Z,q,X,ae,J);else if(ie=_(M),typeof ie=="function")for(M=ie.call(M),ie=0;!(Z=M.next()).done;)Z=Z.value,ae=de+H(Z,ie++),ce+=N(Z,q,X,ae,J);else if(ae==="object"){if(typeof M.then=="function")return N(F(M),q,X,Z,J);throw q=String(M),Error("Objects are not valid as a React child (found: "+(q==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":q)+"). If you meant to render a collection of children, use an array instead.")}return ce}function B(M,q,X){if(M==null)return M;var Z=[],J=0;return N(M,Z,"","",function(ae){return q.call(X,ae,J++)}),Z}function U(M){if(M._status===-1){var q=M._result;q=q(),q.then(function(X){(M._status===0||M._status===-1)&&(M._status=1,M._result=X)},function(X){(M._status===0||M._status===-1)&&(M._status=2,M._result=X)}),M._status===-1&&(M._status=0,M._result=q)}if(M._status===1)return M._result.default;throw M._result}var $=typeof reportError=="function"?reportError:function(M){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof M=="object"&&M!==null&&typeof M.message=="string"?String(M.message):String(M),error:M});if(!window.dispatchEvent(q))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",M);return}console.error(M)},Q={map:B,forEach:function(M,q,X){B(M,function(){q.apply(this,arguments)},X)},count:function(M){var q=0;return B(M,function(){q++}),q},toArray:function(M){return B(M,function(q){return q})||[]},only:function(M){if(!V(M))throw Error("React.Children.only expected to receive a single React element child.");return M}};return Le.Activity=m,Le.Children=Q,Le.Component=S,Le.Fragment=n,Le.Profiler=a,Le.PureComponent=E,Le.StrictMode=s,Le.Suspense=f,Le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,Le.__COMPILER_RUNTIME={__proto__:null,c:function(M){return I.H.useMemoCache(M)}},Le.cache=function(M){return function(){return M.apply(null,arguments)}},Le.cacheSignal=function(){return null},Le.cloneElement=function(M,q,X){if(M==null)throw Error("The argument must be a React element, but you passed "+M+".");var Z=w({},M.props),J=M.key;if(q!=null)for(ae in q.key!==void 0&&(J=""+q.key),q)!D.call(q,ae)||ae==="key"||ae==="__self"||ae==="__source"||ae==="ref"&&q.ref===void 0||(Z[ae]=q[ae]);var ae=arguments.length-2;if(ae===1)Z.children=X;else if(1<ae){for(var ce=Array(ae),de=0;de<ae;de++)ce[de]=arguments[de+2];Z.children=ce}return P(M.type,J,Z)},Le.createContext=function(M){return M={$$typeof:c,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null},M.Provider=M,M.Consumer={$$typeof:l,_context:M},M},Le.createElement=function(M,q,X){var Z,J={},ae=null;if(q!=null)for(Z in q.key!==void 0&&(ae=""+q.key),q)D.call(q,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(J[Z]=q[Z]);var ce=arguments.length-2;if(ce===1)J.children=X;else if(1<ce){for(var de=Array(ce),ie=0;ie<ce;ie++)de[ie]=arguments[ie+2];J.children=de}if(M&&M.defaultProps)for(Z in ce=M.defaultProps,ce)J[Z]===void 0&&(J[Z]=ce[Z]);return P(M,ae,J)},Le.createRef=function(){return{current:null}},Le.forwardRef=function(M){return{$$typeof:d,render:M}},Le.isValidElement=V,Le.lazy=function(M){return{$$typeof:p,_payload:{_status:-1,_result:M},_init:U}},Le.memo=function(M,q){return{$$typeof:h,type:M,compare:q===void 0?null:q}},Le.startTransition=function(M){var q=I.T,X={};I.T=X;try{var Z=M(),J=I.S;J!==null&&J(X,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(j,$)}catch(ae){$(ae)}finally{q!==null&&X.types!==null&&(q.types=X.types),I.T=q}},Le.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},Le.use=function(M){return I.H.use(M)},Le.useActionState=function(M,q,X){return I.H.useActionState(M,q,X)},Le.useCallback=function(M,q){return I.H.useCallback(M,q)},Le.useContext=function(M){return I.H.useContext(M)},Le.useDebugValue=function(){},Le.useDeferredValue=function(M,q){return I.H.useDeferredValue(M,q)},Le.useEffect=function(M,q){return I.H.useEffect(M,q)},Le.useEffectEvent=function(M){return I.H.useEffectEvent(M)},Le.useId=function(){return I.H.useId()},Le.useImperativeHandle=function(M,q,X){return I.H.useImperativeHandle(M,q,X)},Le.useInsertionEffect=function(M,q){return I.H.useInsertionEffect(M,q)},Le.useLayoutEffect=function(M,q){return I.H.useLayoutEffect(M,q)},Le.useMemo=function(M,q){return I.H.useMemo(M,q)},Le.useOptimistic=function(M,q){return I.H.useOptimistic(M,q)},Le.useReducer=function(M,q,X){return I.H.useReducer(M,q,X)},Le.useRef=function(M){return I.H.useRef(M)},Le.useState=function(M){return I.H.useState(M)},Le.useSyncExternalStore=function(M,q,X){return I.H.useSyncExternalStore(M,q,X)},Le.useTransition=function(){return I.H.useTransition()},Le.version="19.2.0",Le}var lb;function Xl(){return lb||(lb=1,zm.exports=XN()),zm.exports}var k=Xl();const KN=Yl(k);var Pm={exports:{}},Jo={},Hm={exports:{}},qm={};var cb;function WN(){return cb||(cb=1,(function(t){function e(N,B){var U=N.length;N.push(B);e:for(;0<U;){var $=U-1>>>1,Q=N[$];if(0<a(Q,B))N[$]=B,N[U]=Q,U=$;else break e}}function n(N){return N.length===0?null:N[0]}function s(N){if(N.length===0)return null;var B=N[0],U=N.pop();if(U!==B){N[0]=U;e:for(var $=0,Q=N.length,M=Q>>>1;$<M;){var q=2*($+1)-1,X=N[q],Z=q+1,J=N[Z];if(0>a(X,U))Z<Q&&0>a(J,X)?(N[$]=J,N[Z]=U,$=Z):(N[$]=X,N[q]=U,$=q);else if(Z<Q&&0>a(J,U))N[$]=J,N[Z]=U,$=Z;else break e}}return B}function a(N,B){var U=N.sortIndex-B.sortIndex;return U!==0?U:N.id-B.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();t.unstable_now=function(){return c.now()-d}}var f=[],h=[],p=1,m=null,y=3,_=!1,x=!1,w=!1,A=!1,S=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function C(N){for(var B=n(h);B!==null;){if(B.callback===null)s(h);else if(B.startTime<=N)s(h),B.sortIndex=B.expirationTime,e(f,B);else break;B=n(h)}}function O(N){if(w=!1,C(N),!x)if(n(f)!==null)x=!0,j||(j=!0,z());else{var B=n(h);B!==null&&F(O,B.startTime-N)}}var j=!1,I=-1,D=5,P=-1;function G(){return A?!0:!(t.unstable_now()-P<D)}function V(){if(A=!1,j){var N=t.unstable_now();P=N;var B=!0;try{e:{x=!1,w&&(w=!1,T(I),I=-1),_=!0;var U=y;try{t:{for(C(N),m=n(f);m!==null&&!(m.expirationTime>N&&G());){var $=m.callback;if(typeof $=="function"){m.callback=null,y=m.priorityLevel;var Q=$(m.expirationTime<=N);if(N=t.unstable_now(),typeof Q=="function"){m.callback=Q,C(N),B=!0;break t}m===n(f)&&s(f),C(N)}else s(f);m=n(f)}if(m!==null)B=!0;else{var M=n(h);M!==null&&F(O,M.startTime-N),B=!1}}break e}finally{m=null,y=U,_=!1}B=void 0}}finally{B?z():j=!1}}}var z;if(typeof E=="function")z=function(){E(V)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,H=Y.port2;Y.port1.onmessage=V,z=function(){H.postMessage(null)}}else z=function(){S(V,0)};function F(N,B){I=S(function(){N(t.unstable_now())},B)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(N){N.callback=null},t.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<N?Math.floor(1e3/N):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_next=function(N){switch(y){case 1:case 2:case 3:var B=3;break;default:B=y}var U=y;y=B;try{return N()}finally{y=U}},t.unstable_requestPaint=function(){A=!0},t.unstable_runWithPriority=function(N,B){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var U=y;y=N;try{return B()}finally{y=U}},t.unstable_scheduleCallback=function(N,B,U){var $=t.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?$+U:$):U=$,N){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=U+Q,N={id:p++,callback:B,priorityLevel:N,startTime:U,expirationTime:Q,sortIndex:-1},U>$?(N.sortIndex=U,e(h,N),n(f)===null&&N===n(h)&&(w?(T(I),I=-1):w=!0,F(O,U-$))):(N.sortIndex=Q,e(f,N),x||_||(x=!0,j||(j=!0,z()))),N},t.unstable_shouldYield=G,t.unstable_wrapCallback=function(N){var B=y;return function(){var U=y;y=B;try{return N.apply(this,arguments)}finally{y=U}}}})(qm)),qm}var ub;function JN(){return ub||(ub=1,Hm.exports=WN()),Hm.exports}var Qm={exports:{}},Kt={};var db;function ZN(){if(db)return Kt;db=1;var t=Xl();function e(f){var h="https://react.dev/errors/"+f;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)h+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+f+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var s={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(f,h,p){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:m==null?null:""+m,children:f,containerInfo:h,implementation:p}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(f,h){if(f==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Kt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Kt.createPortal=function(f,h){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return l(f,h,null,p)},Kt.flushSync=function(f){var h=c.T,p=s.p;try{if(c.T=null,s.p=2,f)return f()}finally{c.T=h,s.p=p,s.d.f()}},Kt.preconnect=function(f,h){typeof f=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,s.d.C(f,h))},Kt.prefetchDNS=function(f){typeof f=="string"&&s.d.D(f)},Kt.preinit=function(f,h){if(typeof f=="string"&&h&&typeof h.as=="string"){var p=h.as,m=d(p,h.crossOrigin),y=typeof h.integrity=="string"?h.integrity:void 0,_=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;p==="style"?s.d.S(f,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:m,integrity:y,fetchPriority:_}):p==="script"&&s.d.X(f,{crossOrigin:m,integrity:y,fetchPriority:_,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Kt.preinitModule=function(f,h){if(typeof f=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var p=d(h.as,h.crossOrigin);s.d.M(f,{crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&s.d.M(f)},Kt.preload=function(f,h){if(typeof f=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var p=h.as,m=d(p,h.crossOrigin);s.d.L(f,p,{crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Kt.preloadModule=function(f,h){if(typeof f=="string")if(h){var p=d(h.as,h.crossOrigin);s.d.m(f,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else s.d.m(f)},Kt.requestFormReset=function(f){s.d.r(f)},Kt.unstable_batchedUpdates=function(f,h){return f(h)},Kt.useFormState=function(f,h,p){return c.H.useFormState(f,h,p)},Kt.useFormStatus=function(){return c.H.useHostTransitionStatus()},Kt.version="19.2.0",Kt}var fb;function Wx(){if(fb)return Qm.exports;fb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Qm.exports=ZN(),Qm.exports}var hb;function eR(){if(hb)return Jo;hb=1;var t=JN(),e=Xl(),n=Wx();function s(r){var i="https://react.dev/errors/"+r;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function l(r){var i=r,o=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(o=i.return),r=i.return;while(r)}return i.tag===3?o:null}function c(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function d(r){if(r.tag===31){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function f(r){if(l(r)!==r)throw Error(s(188))}function h(r){var i=r.alternate;if(!i){if(i=l(r),i===null)throw Error(s(188));return i!==r?null:r}for(var o=r,u=i;;){var g=o.return;if(g===null)break;var v=g.alternate;if(v===null){if(u=g.return,u!==null){o=u;continue}break}if(g.child===v.child){for(v=g.child;v;){if(v===o)return f(g),r;if(v===u)return f(g),i;v=v.sibling}throw Error(s(188))}if(o.return!==u.return)o=g,u=v;else{for(var R=!1,L=g.child;L;){if(L===o){R=!0,o=g,u=v;break}if(L===u){R=!0,u=g,o=v;break}L=L.sibling}if(!R){for(L=v.child;L;){if(L===o){R=!0,o=v,u=g;break}if(L===u){R=!0,u=v,o=g;break}L=L.sibling}if(!R)throw Error(s(189))}}if(o.alternate!==u)throw Error(s(190))}if(o.tag!==3)throw Error(s(188));return o.stateNode.current===o?r:i}function p(r){var i=r.tag;if(i===5||i===26||i===27||i===6)return r;for(r=r.child;r!==null;){if(i=p(r),i!==null)return i;r=r.sibling}return null}var m=Object.assign,y=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),T=Symbol.for("react.consumer"),E=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),P=Symbol.for("react.activity"),G=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function z(r){return r===null||typeof r!="object"?null:(r=V&&r[V]||r["@@iterator"],typeof r=="function"?r:null)}var Y=Symbol.for("react.client.reference");function H(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===Y?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case w:return"Fragment";case S:return"Profiler";case A:return"StrictMode";case O:return"Suspense";case j:return"SuspenseList";case P:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case x:return"Portal";case E:return r.displayName||"Context";case T:return(r._context.displayName||"Context")+".Consumer";case C:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case I:return i=r.displayName||null,i!==null?i:H(r.type)||"Memo";case D:i=r._payload,r=r._init;try{return H(r(i))}catch{}}return null}var F=Array.isArray,N=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,B=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U={pending:!1,data:null,method:null,action:null},$=[],Q=-1;function M(r){return{current:r}}function q(r){0>Q||(r.current=$[Q],$[Q]=null,Q--)}function X(r,i){Q++,$[Q]=r.current,r.current=i}var Z=M(null),J=M(null),ae=M(null),ce=M(null);function de(r,i){switch(X(ae,i),X(J,r),X(Z,null),i.nodeType){case 9:case 11:r=(r=i.documentElement)&&(r=r.namespaceURI)?N_(r):0;break;default:if(r=i.tagName,i=i.namespaceURI)i=N_(i),r=R_(i,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}q(Z),X(Z,r)}function ie(){q(Z),q(J),q(ae)}function oe(r){r.memoizedState!==null&&X(ce,r);var i=Z.current,o=R_(i,r.type);i!==o&&(X(J,r),X(Z,o))}function pe(r){J.current===r&&(q(Z),q(J)),ce.current===r&&(q(ce),Go._currentValue=U)}var be,_e;function Me(r){if(be===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);be=i&&i[1]||"",_e=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+be+r+_e}var fe=!1;function ve(r,i){if(!r||fe)return"";fe=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(i){var me=function(){throw Error()};if(Object.defineProperty(me.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(me,[])}catch(le){var se=le}Reflect.construct(r,[],me)}else{try{me.call()}catch(le){se=le}r.call(me.prototype)}}else{try{throw Error()}catch(le){se=le}(me=r())&&typeof me.catch=="function"&&me.catch(function(){})}}catch(le){if(le&&se&&typeof le.stack=="string")return[le.stack,se.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=u.DetermineComponentFrameRoot(),R=v[0],L=v[1];if(R&&L){var K=R.split(`
`),ne=L.split(`
`);for(g=u=0;u<K.length&&!K[u].includes("DetermineComponentFrameRoot");)u++;for(;g<ne.length&&!ne[g].includes("DetermineComponentFrameRoot");)g++;if(u===K.length||g===ne.length)for(u=K.length-1,g=ne.length-1;1<=u&&0<=g&&K[u]!==ne[g];)g--;for(;1<=u&&0<=g;u--,g--)if(K[u]!==ne[g]){if(u!==1||g!==1)do if(u--,g--,0>g||K[u]!==ne[g]){var ue=`
`+K[u].replace(" at new "," at ");return r.displayName&&ue.includes("<anonymous>")&&(ue=ue.replace("<anonymous>",r.displayName)),ue}while(1<=u&&0<=g);break}}}finally{fe=!1,Error.prepareStackTrace=o}return(o=r?r.displayName||r.name:"")?Me(o):""}function Ie(r,i){switch(r.tag){case 26:case 27:case 5:return Me(r.type);case 16:return Me("Lazy");case 13:return r.child!==i&&i!==null?Me("Suspense Fallback"):Me("Suspense");case 19:return Me("SuspenseList");case 0:case 15:return ve(r.type,!1);case 11:return ve(r.type.render,!1);case 1:return ve(r.type,!0);case 31:return Me("Activity");default:return""}}function Xe(r){try{var i="",o=null;do i+=Ie(r,o),o=r,r=r.return;while(r);return i}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var Je=Object.prototype.hasOwnProperty,pt=t.unstable_scheduleCallback,it=t.unstable_cancelCallback,mn=t.unstable_shouldYield,Zt=t.unstable_requestPaint,dt=t.unstable_now,pn=t.unstable_getCurrentPriorityLevel,In=t.unstable_ImmediatePriority,nn=t.unstable_UserBlockingPriority,gn=t.unstable_NormalPriority,wr=t.unstable_LowPriority,ts=t.unstable_IdlePriority,to=t.log,no=t.unstable_setDisableYieldValue,Qn=null,$t=null;function ge(r){if(typeof to=="function"&&no(r),$t&&typeof $t.setStrictMode=="function")try{$t.setStrictMode(Qn,r)}catch{}}var Ee=Math.clz32?Math.clz32:lt,ke=Math.log,Ye=Math.LN2;function lt(r){return r>>>=0,r===0?32:31-(ke(r)/Ye|0)|0}var ft=256,ns=262144,ki=4194304;function xr(r){var i=r&42;if(i!==0)return i;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Mi(r,i,o){var u=r.pendingLanes;if(u===0)return 0;var g=0,v=r.suspendedLanes,R=r.pingedLanes;r=r.warmLanes;var L=u&134217727;return L!==0?(u=L&~v,u!==0?g=xr(u):(R&=L,R!==0?g=xr(R):o||(o=L&~r,o!==0&&(g=xr(o))))):(L=u&~v,L!==0?g=xr(L):R!==0?g=xr(R):o||(o=u&~r,o!==0&&(g=xr(o)))),g===0?0:i!==0&&i!==g&&(i&v)===0&&(v=g&-g,o=i&-i,v>=o||v===32&&(o&4194048)!==0)?i:g}function Qs(r,i){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&i)===0}function Nf(r,i){switch(r){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function uc(){var r=ki;return ki<<=1,(ki&62914560)===0&&(ki=4194304),r}function ro(r){for(var i=[],o=0;31>o;o++)i.push(r);return i}function Vs(r,i){r.pendingLanes|=i,i!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Rf(r,i,o,u,g,v){var R=r.pendingLanes;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=o,r.entangledLanes&=o,r.errorRecoveryDisabledLanes&=o,r.shellSuspendCounter=0;var L=r.entanglements,K=r.expirationTimes,ne=r.hiddenUpdates;for(o=R&~o;0<o;){var ue=31-Ee(o),me=1<<ue;L[ue]=0,K[ue]=-1;var se=ne[ue];if(se!==null)for(ne[ue]=null,ue=0;ue<se.length;ue++){var le=se[ue];le!==null&&(le.lane&=-536870913)}o&=~me}u!==0&&dc(r,u,0),v!==0&&g===0&&r.tag!==0&&(r.suspendedLanes|=v&~(R&~i))}function dc(r,i,o){r.pendingLanes|=i,r.suspendedLanes&=~i;var u=31-Ee(i);r.entangledLanes|=i,r.entanglements[u]=r.entanglements[u]|1073741824|o&261930}function fc(r,i){var o=r.entangledLanes|=i;for(r=r.entanglements;o;){var u=31-Ee(o),g=1<<u;g&i|r[u]&i&&(r[u]|=i),o&=~g}}function hc(r,i){var o=i&-i;return o=(o&42)!==0?1:so(o),(o&(r.suspendedLanes|i))!==0?0:o}function so(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function io(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function mc(){var r=B.p;return r!==0?r:(r=window.event,r===void 0?32:J_(r.type))}function pc(r,i){var o=B.p;try{return B.p=r,i()}finally{B.p=o}}var or=Math.random().toString(36).slice(2),jt="__reactFiber$"+or,Yt="__reactProps$"+or,Ar="__reactContainer$"+or,Di="__reactEvents$"+or,gc="__reactListeners$"+or,Of="__reactHandles$"+or,yc="__reactResources$"+or,Fs="__reactMarker$"+or;function ao(r){delete r[jt],delete r[Yt],delete r[Di],delete r[gc],delete r[Of]}function rs(r){var i=r[jt];if(i)return i;for(var o=r.parentNode;o;){if(i=o[Ar]||o[jt]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(r=B_(r);r!==null;){if(o=r[jt])return o;r=B_(r)}return i}r=o,o=r.parentNode}return null}function ss(r){if(r=r[jt]||r[Ar]){var i=r.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return r}return null}function is(r){var i=r.tag;if(i===5||i===26||i===27||i===6)return r.stateNode;throw Error(s(33))}function as(r){var i=r[yc];return i||(i=r[yc]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function At(r){r[Fs]=!0}var vc=new Set,_c={};function Er(r,i){os(r,i),os(r+"Capture",i)}function os(r,i){for(_c[r]=i,r=0;r<i.length;r++)vc.add(i[r])}var jf=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),oo={},bc={};function If(r){return Je.call(bc,r)?!0:Je.call(oo,r)?!1:jf.test(r)?bc[r]=!0:(oo[r]=!0,!1)}function Bi(r,i,o){if(If(i))if(o===null)r.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":r.removeAttribute(i);return;case"boolean":var u=i.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){r.removeAttribute(i);return}}r.setAttribute(i,""+o)}}function Ui(r,i,o){if(o===null)r.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(i);return}r.setAttribute(i,""+o)}}function Vn(r,i,o,u){if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttributeNS(i,o,""+u)}}function rn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function wc(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function kf(r,i,o){var u=Object.getOwnPropertyDescriptor(r.constructor.prototype,i);if(!r.hasOwnProperty(i)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var g=u.get,v=u.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return g.call(this)},set:function(R){o=""+R,v.call(this,R)}}),Object.defineProperty(r,i,{enumerable:u.enumerable}),{getValue:function(){return o},setValue:function(R){o=""+R},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function Li(r){if(!r._valueTracker){var i=wc(r)?"checked":"value";r._valueTracker=kf(r,i,""+r[i])}}function xc(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var o=i.getValue(),u="";return r&&(u=wc(r)?r.checked?"true":"false":r.value),r=u,r!==o?(i.setValue(r),!0):!1}function $i(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Mf=/[\n"\\]/g;function Xt(r){return r.replace(Mf,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function lo(r,i,o,u,g,v,R,L){r.name="",R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?r.type=R:r.removeAttribute("type"),i!=null?R==="number"?(i===0&&r.value===""||r.value!=i)&&(r.value=""+rn(i)):r.value!==""+rn(i)&&(r.value=""+rn(i)):R!=="submit"&&R!=="reset"||r.removeAttribute("value"),i!=null?zi(r,R,rn(i)):o!=null?zi(r,R,rn(o)):u!=null&&r.removeAttribute("value"),g==null&&v!=null&&(r.defaultChecked=!!v),g!=null&&(r.checked=g&&typeof g!="function"&&typeof g!="symbol"),L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?r.name=""+rn(L):r.removeAttribute("name")}function Ac(r,i,o,u,g,v,R,L){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(r.type=v),i!=null||o!=null){if(!(v!=="submit"&&v!=="reset"||i!=null)){Li(r);return}o=o!=null?""+rn(o):"",i=i!=null?""+rn(i):o,L||i===r.value||(r.value=i),r.defaultValue=i}u=u??g,u=typeof u!="function"&&typeof u!="symbol"&&!!u,r.checked=L?r.checked:!!u,r.defaultChecked=!!u,R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(r.name=R),Li(r)}function zi(r,i,o){i==="number"&&$i(r.ownerDocument)===r||r.defaultValue===""+o||(r.defaultValue=""+o)}function Pi(r,i,o,u){if(r=r.options,i){i={};for(var g=0;g<o.length;g++)i["$"+o[g]]=!0;for(o=0;o<r.length;o++)g=i.hasOwnProperty("$"+r[o].value),r[o].selected!==g&&(r[o].selected=g),g&&u&&(r[o].defaultSelected=!0)}else{for(o=""+rn(o),i=null,g=0;g<r.length;g++){if(r[g].value===o){r[g].selected=!0,u&&(r[g].defaultSelected=!0);return}i!==null||r[g].disabled||(i=r[g])}i!==null&&(i.selected=!0)}}function Ay(r,i,o){if(i!=null&&(i=""+rn(i),i!==r.value&&(r.value=i),o==null)){r.defaultValue!==i&&(r.defaultValue=i);return}r.defaultValue=o!=null?""+rn(o):""}function Ey(r,i,o,u){if(i==null){if(u!=null){if(o!=null)throw Error(s(92));if(F(u)){if(1<u.length)throw Error(s(93));u=u[0]}o=u}o==null&&(o=""),i=o}o=rn(i),r.defaultValue=o,u=r.textContent,u===o&&u!==""&&u!==null&&(r.value=u),Li(r)}function Hi(r,i){if(i){var o=r.firstChild;if(o&&o===r.lastChild&&o.nodeType===3){o.nodeValue=i;return}}r.textContent=i}var PC=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Sy(r,i,o){var u=i.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?r.setProperty(i,""):i==="float"?r.cssFloat="":r[i]="":u?r.setProperty(i,o):typeof o!="number"||o===0||PC.has(i)?i==="float"?r.cssFloat=o:r[i]=(""+o).trim():r[i]=o+"px"}function Cy(r,i,o){if(i!=null&&typeof i!="object")throw Error(s(62));if(r=r.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||i!=null&&i.hasOwnProperty(u)||(u.indexOf("--")===0?r.setProperty(u,""):u==="float"?r.cssFloat="":r[u]="");for(var g in i)u=i[g],i.hasOwnProperty(g)&&o[g]!==u&&Sy(r,g,u)}else for(var v in i)i.hasOwnProperty(v)&&Sy(r,v,i[v])}function Df(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var HC=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),qC=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ec(r){return qC.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Sr(){}var Bf=null;function Uf(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var qi=null,Qi=null;function Ty(r){var i=ss(r);if(i&&(r=i.stateNode)){var o=r[Yt]||null;e:switch(r=i.stateNode,i.type){case"input":if(lo(r,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),i=o.name,o.type==="radio"&&i!=null){for(o=r;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Xt(""+i)+'"][type="radio"]'),i=0;i<o.length;i++){var u=o[i];if(u!==r&&u.form===r.form){var g=u[Yt]||null;if(!g)throw Error(s(90));lo(u,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(i=0;i<o.length;i++)u=o[i],u.form===r.form&&xc(u)}break e;case"textarea":Ay(r,o.value,o.defaultValue);break e;case"select":i=o.value,i!=null&&Pi(r,!!o.multiple,i,!1)}}}var Lf=!1;function Ny(r,i,o){if(Lf)return r(i,o);Lf=!0;try{var u=r(i);return u}finally{if(Lf=!1,(qi!==null||Qi!==null)&&(du(),qi&&(i=qi,r=Qi,Qi=qi=null,Ty(i),r)))for(i=0;i<r.length;i++)Ty(r[i])}}function co(r,i){var o=r.stateNode;if(o===null)return null;var u=o[Yt]||null;if(u===null)return null;o=u[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(r=r.type,u=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!u;break e;default:r=!1}if(r)return null;if(o&&typeof o!="function")throw Error(s(231,i,typeof o));return o}var Cr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),$f=!1;if(Cr)try{var uo={};Object.defineProperty(uo,"passive",{get:function(){$f=!0}}),window.addEventListener("test",uo,uo),window.removeEventListener("test",uo,uo)}catch{$f=!1}var ls=null,zf=null,Sc=null;function Ry(){if(Sc)return Sc;var r,i=zf,o=i.length,u,g="value"in ls?ls.value:ls.textContent,v=g.length;for(r=0;r<o&&i[r]===g[r];r++);var R=o-r;for(u=1;u<=R&&i[o-u]===g[v-u];u++);return Sc=g.slice(r,1<u?1-u:void 0)}function Cc(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function Tc(){return!0}function Oy(){return!1}function sn(r){function i(o,u,g,v,R){this._reactName=o,this._targetInst=g,this.type=u,this.nativeEvent=v,this.target=R,this.currentTarget=null;for(var L in r)r.hasOwnProperty(L)&&(o=r[L],this[L]=o?o(v):v[L]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Tc:Oy,this.isPropagationStopped=Oy,this}return m(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Tc)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Tc)},persist:function(){},isPersistent:Tc}),i}var Gs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nc=sn(Gs),fo=m({},Gs,{view:0,detail:0}),QC=sn(fo),Pf,Hf,ho,Rc=m({},fo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qf,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==ho&&(ho&&r.type==="mousemove"?(Pf=r.screenX-ho.screenX,Hf=r.screenY-ho.screenY):Hf=Pf=0,ho=r),Pf)},movementY:function(r){return"movementY"in r?r.movementY:Hf}}),jy=sn(Rc),VC=m({},Rc,{dataTransfer:0}),FC=sn(VC),GC=m({},fo,{relatedTarget:0}),qf=sn(GC),YC=m({},Gs,{animationName:0,elapsedTime:0,pseudoElement:0}),XC=sn(YC),KC=m({},Gs,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),WC=sn(KC),JC=m({},Gs,{data:0}),Iy=sn(JC),ZC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nT(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=tT[r])?!!i[r]:!1}function Qf(){return nT}var rT=m({},fo,{key:function(r){if(r.key){var i=ZC[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=Cc(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?eT[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qf,charCode:function(r){return r.type==="keypress"?Cc(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Cc(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),sT=sn(rT),iT=m({},Rc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ky=sn(iT),aT=m({},fo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qf}),oT=sn(aT),lT=m({},Gs,{propertyName:0,elapsedTime:0,pseudoElement:0}),cT=sn(lT),uT=m({},Rc,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),dT=sn(uT),fT=m({},Gs,{newState:0,oldState:0}),hT=sn(fT),mT=[9,13,27,32],Vf=Cr&&"CompositionEvent"in window,mo=null;Cr&&"documentMode"in document&&(mo=document.documentMode);var pT=Cr&&"TextEvent"in window&&!mo,My=Cr&&(!Vf||mo&&8<mo&&11>=mo),Dy=" ",By=!1;function Uy(r,i){switch(r){case"keyup":return mT.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ly(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Vi=!1;function gT(r,i){switch(r){case"compositionend":return Ly(i);case"keypress":return i.which!==32?null:(By=!0,Dy);case"textInput":return r=i.data,r===Dy&&By?null:r;default:return null}}function yT(r,i){if(Vi)return r==="compositionend"||!Vf&&Uy(r,i)?(r=Ry(),Sc=zf=ls=null,Vi=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return My&&i.locale!=="ko"?null:i.data;default:return null}}var vT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $y(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!vT[r.type]:i==="textarea"}function zy(r,i,o,u){qi?Qi?Qi.push(u):Qi=[u]:qi=u,i=vu(i,"onChange"),0<i.length&&(o=new Nc("onChange","change",null,o,u),r.push({event:o,listeners:i}))}var po=null,go=null;function _T(r){x_(r,0)}function Oc(r){var i=is(r);if(xc(i))return r}function Py(r,i){if(r==="change")return i}var Hy=!1;if(Cr){var Ff;if(Cr){var Gf="oninput"in document;if(!Gf){var qy=document.createElement("div");qy.setAttribute("oninput","return;"),Gf=typeof qy.oninput=="function"}Ff=Gf}else Ff=!1;Hy=Ff&&(!document.documentMode||9<document.documentMode)}function Qy(){po&&(po.detachEvent("onpropertychange",Vy),go=po=null)}function Vy(r){if(r.propertyName==="value"&&Oc(go)){var i=[];zy(i,go,r,Uf(r)),Ny(_T,i)}}function bT(r,i,o){r==="focusin"?(Qy(),po=i,go=o,po.attachEvent("onpropertychange",Vy)):r==="focusout"&&Qy()}function wT(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Oc(go)}function xT(r,i){if(r==="click")return Oc(i)}function AT(r,i){if(r==="input"||r==="change")return Oc(i)}function ET(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var yn=typeof Object.is=="function"?Object.is:ET;function yo(r,i){if(yn(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var o=Object.keys(r),u=Object.keys(i);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var g=o[u];if(!Je.call(i,g)||!yn(r[g],i[g]))return!1}return!0}function Fy(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Gy(r,i){var o=Fy(r);r=0;for(var u;o;){if(o.nodeType===3){if(u=r+o.textContent.length,r<=i&&u>=i)return{node:o,offset:i-r};r=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Fy(o)}}function Yy(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?Yy(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function Xy(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var i=$i(r.document);i instanceof r.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)r=i.contentWindow;else break;i=$i(r.document)}return i}function Yf(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}var ST=Cr&&"documentMode"in document&&11>=document.documentMode,Fi=null,Xf=null,vo=null,Kf=!1;function Ky(r,i,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Kf||Fi==null||Fi!==$i(u)||(u=Fi,"selectionStart"in u&&Yf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),vo&&yo(vo,u)||(vo=u,u=vu(Xf,"onSelect"),0<u.length&&(i=new Nc("onSelect","select",null,i,o),r.push({event:i,listeners:u}),i.target=Fi)))}function Ys(r,i){var o={};return o[r.toLowerCase()]=i.toLowerCase(),o["Webkit"+r]="webkit"+i,o["Moz"+r]="moz"+i,o}var Gi={animationend:Ys("Animation","AnimationEnd"),animationiteration:Ys("Animation","AnimationIteration"),animationstart:Ys("Animation","AnimationStart"),transitionrun:Ys("Transition","TransitionRun"),transitionstart:Ys("Transition","TransitionStart"),transitioncancel:Ys("Transition","TransitionCancel"),transitionend:Ys("Transition","TransitionEnd")},Wf={},Wy={};Cr&&(Wy=document.createElement("div").style,"AnimationEvent"in window||(delete Gi.animationend.animation,delete Gi.animationiteration.animation,delete Gi.animationstart.animation),"TransitionEvent"in window||delete Gi.transitionend.transition);function Xs(r){if(Wf[r])return Wf[r];if(!Gi[r])return r;var i=Gi[r],o;for(o in i)if(i.hasOwnProperty(o)&&o in Wy)return Wf[r]=i[o];return r}var Jy=Xs("animationend"),Zy=Xs("animationiteration"),e0=Xs("animationstart"),CT=Xs("transitionrun"),TT=Xs("transitionstart"),NT=Xs("transitioncancel"),t0=Xs("transitionend"),n0=new Map,Jf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Jf.push("scrollEnd");function Fn(r,i){n0.set(r,i),Er(i,[r])}var jc=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},kn=[],Yi=0,Zf=0;function Ic(){for(var r=Yi,i=Zf=Yi=0;i<r;){var o=kn[i];kn[i++]=null;var u=kn[i];kn[i++]=null;var g=kn[i];kn[i++]=null;var v=kn[i];if(kn[i++]=null,u!==null&&g!==null){var R=u.pending;R===null?g.next=g:(g.next=R.next,R.next=g),u.pending=g}v!==0&&r0(o,g,v)}}function kc(r,i,o,u){kn[Yi++]=r,kn[Yi++]=i,kn[Yi++]=o,kn[Yi++]=u,Zf|=u,r.lanes|=u,r=r.alternate,r!==null&&(r.lanes|=u)}function eh(r,i,o,u){return kc(r,i,o,u),Mc(r)}function Ks(r,i){return kc(r,null,null,i),Mc(r)}function r0(r,i,o){r.lanes|=o;var u=r.alternate;u!==null&&(u.lanes|=o);for(var g=!1,v=r.return;v!==null;)v.childLanes|=o,u=v.alternate,u!==null&&(u.childLanes|=o),v.tag===22&&(r=v.stateNode,r===null||r._visibility&1||(g=!0)),r=v,v=v.return;return r.tag===3?(v=r.stateNode,g&&i!==null&&(g=31-Ee(o),r=v.hiddenUpdates,u=r[g],u===null?r[g]=[i]:u.push(i),i.lane=o|536870912),v):null}function Mc(r){if(50<zo)throw zo=0,cm=null,Error(s(185));for(var i=r.return;i!==null;)r=i,i=r.return;return r.tag===3?r.stateNode:null}var Xi={};function RT(r,i,o,u){this.tag=r,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vn(r,i,o,u){return new RT(r,i,o,u)}function th(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Tr(r,i){var o=r.alternate;return o===null?(o=vn(r.tag,i,r.key,r.mode),o.elementType=r.elementType,o.type=r.type,o.stateNode=r.stateNode,o.alternate=r,r.alternate=o):(o.pendingProps=i,o.type=r.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=r.flags&65011712,o.childLanes=r.childLanes,o.lanes=r.lanes,o.child=r.child,o.memoizedProps=r.memoizedProps,o.memoizedState=r.memoizedState,o.updateQueue=r.updateQueue,i=r.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=r.sibling,o.index=r.index,o.ref=r.ref,o.refCleanup=r.refCleanup,o}function s0(r,i){r.flags&=65011714;var o=r.alternate;return o===null?(r.childLanes=0,r.lanes=i,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,i=o.dependencies,r.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),r}function Dc(r,i,o,u,g,v){var R=0;if(u=r,typeof r=="function")th(r)&&(R=1);else if(typeof r=="string")R=MN(r,o,Z.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case P:return r=vn(31,o,i,g),r.elementType=P,r.lanes=v,r;case w:return Ws(o.children,g,v,i);case A:R=8,g|=24;break;case S:return r=vn(12,o,i,g|2),r.elementType=S,r.lanes=v,r;case O:return r=vn(13,o,i,g),r.elementType=O,r.lanes=v,r;case j:return r=vn(19,o,i,g),r.elementType=j,r.lanes=v,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case E:R=10;break e;case T:R=9;break e;case C:R=11;break e;case I:R=14;break e;case D:R=16,u=null;break e}R=29,o=Error(s(130,r===null?"null":typeof r,"")),u=null}return i=vn(R,o,i,g),i.elementType=r,i.type=u,i.lanes=v,i}function Ws(r,i,o,u){return r=vn(7,r,u,i),r.lanes=o,r}function nh(r,i,o){return r=vn(6,r,null,i),r.lanes=o,r}function i0(r){var i=vn(18,null,null,0);return i.stateNode=r,i}function rh(r,i,o){return i=vn(4,r.children!==null?r.children:[],r.key,i),i.lanes=o,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}var a0=new WeakMap;function Mn(r,i){if(typeof r=="object"&&r!==null){var o=a0.get(r);return o!==void 0?o:(i={value:r,source:i,stack:Xe(i)},a0.set(r,i),i)}return{value:r,source:i,stack:Xe(i)}}var Ki=[],Wi=0,Bc=null,_o=0,Dn=[],Bn=0,cs=null,lr=1,cr="";function Nr(r,i){Ki[Wi++]=_o,Ki[Wi++]=Bc,Bc=r,_o=i}function o0(r,i,o){Dn[Bn++]=lr,Dn[Bn++]=cr,Dn[Bn++]=cs,cs=r;var u=lr;r=cr;var g=32-Ee(u)-1;u&=~(1<<g),o+=1;var v=32-Ee(i)+g;if(30<v){var R=g-g%5;v=(u&(1<<R)-1).toString(32),u>>=R,g-=R,lr=1<<32-Ee(i)+g|o<<g|u,cr=v+r}else lr=1<<v|o<<g|u,cr=r}function sh(r){r.return!==null&&(Nr(r,1),o0(r,1,0))}function ih(r){for(;r===Bc;)Bc=Ki[--Wi],Ki[Wi]=null,_o=Ki[--Wi],Ki[Wi]=null;for(;r===cs;)cs=Dn[--Bn],Dn[Bn]=null,cr=Dn[--Bn],Dn[Bn]=null,lr=Dn[--Bn],Dn[Bn]=null}function l0(r,i){Dn[Bn++]=lr,Dn[Bn++]=cr,Dn[Bn++]=cs,lr=i.id,cr=i.overflow,cs=r}var zt=null,ct=null,Ge=!1,us=null,Un=!1,ah=Error(s(519));function ds(r){var i=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw bo(Mn(i,r)),ah}function c0(r){var i=r.stateNode,o=r.type,u=r.memoizedProps;switch(i[jt]=r,i[Yt]=u,o){case"dialog":qe("cancel",i),qe("close",i);break;case"iframe":case"object":case"embed":qe("load",i);break;case"video":case"audio":for(o=0;o<Ho.length;o++)qe(Ho[o],i);break;case"source":qe("error",i);break;case"img":case"image":case"link":qe("error",i),qe("load",i);break;case"details":qe("toggle",i);break;case"input":qe("invalid",i),Ac(i,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":qe("invalid",i);break;case"textarea":qe("invalid",i),Ey(i,u.value,u.defaultValue,u.children)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||i.textContent===""+o||u.suppressHydrationWarning===!0||C_(i.textContent,o)?(u.popover!=null&&(qe("beforetoggle",i),qe("toggle",i)),u.onScroll!=null&&qe("scroll",i),u.onScrollEnd!=null&&qe("scrollend",i),u.onClick!=null&&(i.onclick=Sr),i=!0):i=!1,i||ds(r,!0)}function u0(r){for(zt=r.return;zt;)switch(zt.tag){case 5:case 31:case 13:Un=!1;return;case 27:case 3:Un=!0;return;default:zt=zt.return}}function Ji(r){if(r!==zt)return!1;if(!Ge)return u0(r),Ge=!0,!1;var i=r.tag,o;if((o=i!==3&&i!==27)&&((o=i===5)&&(o=r.type,o=!(o!=="form"&&o!=="button")||Em(r.type,r.memoizedProps)),o=!o),o&&ct&&ds(r),u0(r),i===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(317));ct=D_(r)}else if(i===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(317));ct=D_(r)}else i===27?(i=ct,Ss(r.type)?(r=Rm,Rm=null,ct=r):ct=i):ct=zt?$n(r.stateNode.nextSibling):null;return!0}function Js(){ct=zt=null,Ge=!1}function oh(){var r=us;return r!==null&&(cn===null?cn=r:cn.push.apply(cn,r),us=null),r}function bo(r){us===null?us=[r]:us.push(r)}var lh=M(null),Zs=null,Rr=null;function fs(r,i,o){X(lh,i._currentValue),i._currentValue=o}function Or(r){r._currentValue=lh.current,q(lh)}function ch(r,i,o){for(;r!==null;){var u=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,u!==null&&(u.childLanes|=i)):u!==null&&(u.childLanes&i)!==i&&(u.childLanes|=i),r===o)break;r=r.return}}function uh(r,i,o,u){var g=r.child;for(g!==null&&(g.return=r);g!==null;){var v=g.dependencies;if(v!==null){var R=g.child;v=v.firstContext;e:for(;v!==null;){var L=v;v=g;for(var K=0;K<i.length;K++)if(L.context===i[K]){v.lanes|=o,L=v.alternate,L!==null&&(L.lanes|=o),ch(v.return,o,r),u||(R=null);break e}v=L.next}}else if(g.tag===18){if(R=g.return,R===null)throw Error(s(341));R.lanes|=o,v=R.alternate,v!==null&&(v.lanes|=o),ch(R,o,r),R=null}else R=g.child;if(R!==null)R.return=g;else for(R=g;R!==null;){if(R===r){R=null;break}if(g=R.sibling,g!==null){g.return=R.return,R=g;break}R=R.return}g=R}}function Zi(r,i,o,u){r=null;for(var g=i,v=!1;g!==null;){if(!v){if((g.flags&524288)!==0)v=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var R=g.alternate;if(R===null)throw Error(s(387));if(R=R.memoizedProps,R!==null){var L=g.type;yn(g.pendingProps.value,R.value)||(r!==null?r.push(L):r=[L])}}else if(g===ce.current){if(R=g.alternate,R===null)throw Error(s(387));R.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(r!==null?r.push(Go):r=[Go])}g=g.return}r!==null&&uh(i,r,o,u),i.flags|=262144}function Uc(r){for(r=r.firstContext;r!==null;){if(!yn(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function ei(r){Zs=r,Rr=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Pt(r){return d0(Zs,r)}function Lc(r,i){return Zs===null&&ei(r),d0(r,i)}function d0(r,i){var o=i._currentValue;if(i={context:i,memoizedValue:o,next:null},Rr===null){if(r===null)throw Error(s(308));Rr=i,r.dependencies={lanes:0,firstContext:i},r.flags|=524288}else Rr=Rr.next=i;return o}var OT=typeof AbortController<"u"?AbortController:function(){var r=[],i=this.signal={aborted:!1,addEventListener:function(o,u){r.push(u)}};this.abort=function(){i.aborted=!0,r.forEach(function(o){return o()})}},jT=t.unstable_scheduleCallback,IT=t.unstable_NormalPriority,Et={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function dh(){return{controller:new OT,data:new Map,refCount:0}}function wo(r){r.refCount--,r.refCount===0&&jT(IT,function(){r.controller.abort()})}var xo=null,fh=0,ea=0,ta=null;function kT(r,i){if(xo===null){var o=xo=[];fh=0,ea=pm(),ta={status:"pending",value:void 0,then:function(u){o.push(u)}}}return fh++,i.then(f0,f0),i}function f0(){if(--fh===0&&xo!==null){ta!==null&&(ta.status="fulfilled");var r=xo;xo=null,ea=0,ta=null;for(var i=0;i<r.length;i++)(0,r[i])()}}function MT(r,i){var o=[],u={status:"pending",value:null,reason:null,then:function(g){o.push(g)}};return r.then(function(){u.status="fulfilled",u.value=i;for(var g=0;g<o.length;g++)(0,o[g])(i)},function(g){for(u.status="rejected",u.reason=g,g=0;g<o.length;g++)(0,o[g])(void 0)}),u}var h0=N.S;N.S=function(r,i){Kv=dt(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&kT(r,i),h0!==null&&h0(r,i)};var ti=M(null);function hh(){var r=ti.current;return r!==null?r:at.pooledCache}function $c(r,i){i===null?X(ti,ti.current):X(ti,i.pool)}function m0(){var r=hh();return r===null?null:{parent:Et._currentValue,pool:r}}var na=Error(s(460)),mh=Error(s(474)),zc=Error(s(542)),Pc={then:function(){}};function p0(r){return r=r.status,r==="fulfilled"||r==="rejected"}function g0(r,i,o){switch(o=r[o],o===void 0?r.push(i):o!==i&&(i.then(Sr,Sr),i=o),i.status){case"fulfilled":return i.value;case"rejected":throw r=i.reason,v0(r),r;default:if(typeof i.status=="string")i.then(Sr,Sr);else{if(r=at,r!==null&&100<r.shellSuspendCounter)throw Error(s(482));r=i,r.status="pending",r.then(function(u){if(i.status==="pending"){var g=i;g.status="fulfilled",g.value=u}},function(u){if(i.status==="pending"){var g=i;g.status="rejected",g.reason=u}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw r=i.reason,v0(r),r}throw ri=i,na}}function ni(r){try{var i=r._init;return i(r._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(ri=o,na):o}}var ri=null;function y0(){if(ri===null)throw Error(s(459));var r=ri;return ri=null,r}function v0(r){if(r===na||r===zc)throw Error(s(483))}var ra=null,Ao=0;function Hc(r){var i=Ao;return Ao+=1,ra===null&&(ra=[]),g0(ra,r,i)}function Eo(r,i){i=i.props.ref,r.ref=i!==void 0?i:null}function qc(r,i){throw i.$$typeof===y?Error(s(525)):(r=Object.prototype.toString.call(i),Error(s(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r)))}function _0(r){function i(ee,W){if(r){var te=ee.deletions;te===null?(ee.deletions=[W],ee.flags|=16):te.push(W)}}function o(ee,W){if(!r)return null;for(;W!==null;)i(ee,W),W=W.sibling;return null}function u(ee){for(var W=new Map;ee!==null;)ee.key!==null?W.set(ee.key,ee):W.set(ee.index,ee),ee=ee.sibling;return W}function g(ee,W){return ee=Tr(ee,W),ee.index=0,ee.sibling=null,ee}function v(ee,W,te){return ee.index=te,r?(te=ee.alternate,te!==null?(te=te.index,te<W?(ee.flags|=67108866,W):te):(ee.flags|=67108866,W)):(ee.flags|=1048576,W)}function R(ee){return r&&ee.alternate===null&&(ee.flags|=67108866),ee}function L(ee,W,te,he){return W===null||W.tag!==6?(W=nh(te,ee.mode,he),W.return=ee,W):(W=g(W,te),W.return=ee,W)}function K(ee,W,te,he){var Oe=te.type;return Oe===w?ue(ee,W,te.props.children,he,te.key):W!==null&&(W.elementType===Oe||typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===D&&ni(Oe)===W.type)?(W=g(W,te.props),Eo(W,te),W.return=ee,W):(W=Dc(te.type,te.key,te.props,null,ee.mode,he),Eo(W,te),W.return=ee,W)}function ne(ee,W,te,he){return W===null||W.tag!==4||W.stateNode.containerInfo!==te.containerInfo||W.stateNode.implementation!==te.implementation?(W=rh(te,ee.mode,he),W.return=ee,W):(W=g(W,te.children||[]),W.return=ee,W)}function ue(ee,W,te,he,Oe){return W===null||W.tag!==7?(W=Ws(te,ee.mode,he,Oe),W.return=ee,W):(W=g(W,te),W.return=ee,W)}function me(ee,W,te){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=nh(""+W,ee.mode,te),W.return=ee,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case _:return te=Dc(W.type,W.key,W.props,null,ee.mode,te),Eo(te,W),te.return=ee,te;case x:return W=rh(W,ee.mode,te),W.return=ee,W;case D:return W=ni(W),me(ee,W,te)}if(F(W)||z(W))return W=Ws(W,ee.mode,te,null),W.return=ee,W;if(typeof W.then=="function")return me(ee,Hc(W),te);if(W.$$typeof===E)return me(ee,Lc(ee,W),te);qc(ee,W)}return null}function se(ee,W,te,he){var Oe=W!==null?W.key:null;if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return Oe!==null?null:L(ee,W,""+te,he);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case _:return te.key===Oe?K(ee,W,te,he):null;case x:return te.key===Oe?ne(ee,W,te,he):null;case D:return te=ni(te),se(ee,W,te,he)}if(F(te)||z(te))return Oe!==null?null:ue(ee,W,te,he,null);if(typeof te.then=="function")return se(ee,W,Hc(te),he);if(te.$$typeof===E)return se(ee,W,Lc(ee,te),he);qc(ee,te)}return null}function le(ee,W,te,he,Oe){if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return ee=ee.get(te)||null,L(W,ee,""+he,Oe);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case _:return ee=ee.get(he.key===null?te:he.key)||null,K(W,ee,he,Oe);case x:return ee=ee.get(he.key===null?te:he.key)||null,ne(W,ee,he,Oe);case D:return he=ni(he),le(ee,W,te,he,Oe)}if(F(he)||z(he))return ee=ee.get(te)||null,ue(W,ee,he,Oe,null);if(typeof he.then=="function")return le(ee,W,te,Hc(he),Oe);if(he.$$typeof===E)return le(ee,W,te,Lc(W,he),Oe);qc(W,he)}return null}function xe(ee,W,te,he){for(var Oe=null,Ke=null,Se=W,ze=W=0,Ve=null;Se!==null&&ze<te.length;ze++){Se.index>ze?(Ve=Se,Se=null):Ve=Se.sibling;var We=se(ee,Se,te[ze],he);if(We===null){Se===null&&(Se=Ve);break}r&&Se&&We.alternate===null&&i(ee,Se),W=v(We,W,ze),Ke===null?Oe=We:Ke.sibling=We,Ke=We,Se=Ve}if(ze===te.length)return o(ee,Se),Ge&&Nr(ee,ze),Oe;if(Se===null){for(;ze<te.length;ze++)Se=me(ee,te[ze],he),Se!==null&&(W=v(Se,W,ze),Ke===null?Oe=Se:Ke.sibling=Se,Ke=Se);return Ge&&Nr(ee,ze),Oe}for(Se=u(Se);ze<te.length;ze++)Ve=le(Se,ee,ze,te[ze],he),Ve!==null&&(r&&Ve.alternate!==null&&Se.delete(Ve.key===null?ze:Ve.key),W=v(Ve,W,ze),Ke===null?Oe=Ve:Ke.sibling=Ve,Ke=Ve);return r&&Se.forEach(function(Os){return i(ee,Os)}),Ge&&Nr(ee,ze),Oe}function De(ee,W,te,he){if(te==null)throw Error(s(151));for(var Oe=null,Ke=null,Se=W,ze=W=0,Ve=null,We=te.next();Se!==null&&!We.done;ze++,We=te.next()){Se.index>ze?(Ve=Se,Se=null):Ve=Se.sibling;var Os=se(ee,Se,We.value,he);if(Os===null){Se===null&&(Se=Ve);break}r&&Se&&Os.alternate===null&&i(ee,Se),W=v(Os,W,ze),Ke===null?Oe=Os:Ke.sibling=Os,Ke=Os,Se=Ve}if(We.done)return o(ee,Se),Ge&&Nr(ee,ze),Oe;if(Se===null){for(;!We.done;ze++,We=te.next())We=me(ee,We.value,he),We!==null&&(W=v(We,W,ze),Ke===null?Oe=We:Ke.sibling=We,Ke=We);return Ge&&Nr(ee,ze),Oe}for(Se=u(Se);!We.done;ze++,We=te.next())We=le(Se,ee,ze,We.value,he),We!==null&&(r&&We.alternate!==null&&Se.delete(We.key===null?ze:We.key),W=v(We,W,ze),Ke===null?Oe=We:Ke.sibling=We,Ke=We);return r&&Se.forEach(function(VN){return i(ee,VN)}),Ge&&Nr(ee,ze),Oe}function st(ee,W,te,he){if(typeof te=="object"&&te!==null&&te.type===w&&te.key===null&&(te=te.props.children),typeof te=="object"&&te!==null){switch(te.$$typeof){case _:e:{for(var Oe=te.key;W!==null;){if(W.key===Oe){if(Oe=te.type,Oe===w){if(W.tag===7){o(ee,W.sibling),he=g(W,te.props.children),he.return=ee,ee=he;break e}}else if(W.elementType===Oe||typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===D&&ni(Oe)===W.type){o(ee,W.sibling),he=g(W,te.props),Eo(he,te),he.return=ee,ee=he;break e}o(ee,W);break}else i(ee,W);W=W.sibling}te.type===w?(he=Ws(te.props.children,ee.mode,he,te.key),he.return=ee,ee=he):(he=Dc(te.type,te.key,te.props,null,ee.mode,he),Eo(he,te),he.return=ee,ee=he)}return R(ee);case x:e:{for(Oe=te.key;W!==null;){if(W.key===Oe)if(W.tag===4&&W.stateNode.containerInfo===te.containerInfo&&W.stateNode.implementation===te.implementation){o(ee,W.sibling),he=g(W,te.children||[]),he.return=ee,ee=he;break e}else{o(ee,W);break}else i(ee,W);W=W.sibling}he=rh(te,ee.mode,he),he.return=ee,ee=he}return R(ee);case D:return te=ni(te),st(ee,W,te,he)}if(F(te))return xe(ee,W,te,he);if(z(te)){if(Oe=z(te),typeof Oe!="function")throw Error(s(150));return te=Oe.call(te),De(ee,W,te,he)}if(typeof te.then=="function")return st(ee,W,Hc(te),he);if(te.$$typeof===E)return st(ee,W,Lc(ee,te),he);qc(ee,te)}return typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint"?(te=""+te,W!==null&&W.tag===6?(o(ee,W.sibling),he=g(W,te),he.return=ee,ee=he):(o(ee,W),he=nh(te,ee.mode,he),he.return=ee,ee=he),R(ee)):o(ee,W)}return function(ee,W,te,he){try{Ao=0;var Oe=st(ee,W,te,he);return ra=null,Oe}catch(Se){if(Se===na||Se===zc)throw Se;var Ke=vn(29,Se,null,ee.mode);return Ke.lanes=he,Ke.return=ee,Ke}finally{}}}var si=_0(!0),b0=_0(!1),hs=!1;function ph(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function gh(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function ms(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function ps(r,i,o){var u=r.updateQueue;if(u===null)return null;if(u=u.shared,(Ze&2)!==0){var g=u.pending;return g===null?i.next=i:(i.next=g.next,g.next=i),u.pending=i,i=Mc(r),r0(r,null,o),i}return kc(r,u,i,o),Mc(r)}function So(r,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194048)!==0)){var u=i.lanes;u&=r.pendingLanes,o|=u,i.lanes=o,fc(r,o)}}function yh(r,i){var o=r.updateQueue,u=r.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var g=null,v=null;if(o=o.firstBaseUpdate,o!==null){do{var R={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};v===null?g=v=R:v=v.next=R,o=o.next}while(o!==null);v===null?g=v=i:v=v.next=i}else g=v=i;o={baseState:u.baseState,firstBaseUpdate:g,lastBaseUpdate:v,shared:u.shared,callbacks:u.callbacks},r.updateQueue=o;return}r=o.lastBaseUpdate,r===null?o.firstBaseUpdate=i:r.next=i,o.lastBaseUpdate=i}var vh=!1;function Co(){if(vh){var r=ta;if(r!==null)throw r}}function To(r,i,o,u){vh=!1;var g=r.updateQueue;hs=!1;var v=g.firstBaseUpdate,R=g.lastBaseUpdate,L=g.shared.pending;if(L!==null){g.shared.pending=null;var K=L,ne=K.next;K.next=null,R===null?v=ne:R.next=ne,R=K;var ue=r.alternate;ue!==null&&(ue=ue.updateQueue,L=ue.lastBaseUpdate,L!==R&&(L===null?ue.firstBaseUpdate=ne:L.next=ne,ue.lastBaseUpdate=K))}if(v!==null){var me=g.baseState;R=0,ue=ne=K=null,L=v;do{var se=L.lane&-536870913,le=se!==L.lane;if(le?(Qe&se)===se:(u&se)===se){se!==0&&se===ea&&(vh=!0),ue!==null&&(ue=ue.next={lane:0,tag:L.tag,payload:L.payload,callback:null,next:null});e:{var xe=r,De=L;se=i;var st=o;switch(De.tag){case 1:if(xe=De.payload,typeof xe=="function"){me=xe.call(st,me,se);break e}me=xe;break e;case 3:xe.flags=xe.flags&-65537|128;case 0:if(xe=De.payload,se=typeof xe=="function"?xe.call(st,me,se):xe,se==null)break e;me=m({},me,se);break e;case 2:hs=!0}}se=L.callback,se!==null&&(r.flags|=64,le&&(r.flags|=8192),le=g.callbacks,le===null?g.callbacks=[se]:le.push(se))}else le={lane:se,tag:L.tag,payload:L.payload,callback:L.callback,next:null},ue===null?(ne=ue=le,K=me):ue=ue.next=le,R|=se;if(L=L.next,L===null){if(L=g.shared.pending,L===null)break;le=L,L=le.next,le.next=null,g.lastBaseUpdate=le,g.shared.pending=null}}while(!0);ue===null&&(K=me),g.baseState=K,g.firstBaseUpdate=ne,g.lastBaseUpdate=ue,v===null&&(g.shared.lanes=0),bs|=R,r.lanes=R,r.memoizedState=me}}function w0(r,i){if(typeof r!="function")throw Error(s(191,r));r.call(i)}function x0(r,i){var o=r.callbacks;if(o!==null)for(r.callbacks=null,r=0;r<o.length;r++)w0(o[r],i)}var sa=M(null),Qc=M(0);function A0(r,i){r=$r,X(Qc,r),X(sa,i),$r=r|i.baseLanes}function _h(){X(Qc,$r),X(sa,sa.current)}function bh(){$r=Qc.current,q(sa),q(Qc)}var _n=M(null),Ln=null;function gs(r){var i=r.alternate;X(wt,wt.current&1),X(_n,r),Ln===null&&(i===null||sa.current!==null||i.memoizedState!==null)&&(Ln=r)}function wh(r){X(wt,wt.current),X(_n,r),Ln===null&&(Ln=r)}function E0(r){r.tag===22?(X(wt,wt.current),X(_n,r),Ln===null&&(Ln=r)):ys()}function ys(){X(wt,wt.current),X(_n,_n.current)}function bn(r){q(_n),Ln===r&&(Ln=null),q(wt)}var wt=M(0);function Vc(r){for(var i=r;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||Tm(o)||Nm(o)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var jr=0,$e=null,nt=null,St=null,Fc=!1,ia=!1,ii=!1,Gc=0,No=0,aa=null,DT=0;function _t(){throw Error(s(321))}function xh(r,i){if(i===null)return!1;for(var o=0;o<i.length&&o<r.length;o++)if(!yn(r[o],i[o]))return!1;return!0}function Ah(r,i,o,u,g,v){return jr=v,$e=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,N.H=r===null||r.memoizedState===null?ov:Lh,ii=!1,v=o(u,g),ii=!1,ia&&(v=C0(i,o,u,g)),S0(r),v}function S0(r){N.H=jo;var i=nt!==null&&nt.next!==null;if(jr=0,St=nt=$e=null,Fc=!1,No=0,aa=null,i)throw Error(s(300));r===null||Ct||(r=r.dependencies,r!==null&&Uc(r)&&(Ct=!0))}function C0(r,i,o,u){$e=r;var g=0;do{if(ia&&(aa=null),No=0,ia=!1,25<=g)throw Error(s(301));if(g+=1,St=nt=null,r.updateQueue!=null){var v=r.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}N.H=lv,v=i(o,u)}while(ia);return v}function BT(){var r=N.H,i=r.useState()[0];return i=typeof i.then=="function"?Ro(i):i,r=r.useState()[0],(nt!==null?nt.memoizedState:null)!==r&&($e.flags|=1024),i}function Eh(){var r=Gc!==0;return Gc=0,r}function Sh(r,i,o){i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~o}function Ch(r){if(Fc){for(r=r.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Fc=!1}jr=0,St=nt=$e=null,ia=!1,No=Gc=0,aa=null}function en(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return St===null?$e.memoizedState=St=r:St=St.next=r,St}function xt(){if(nt===null){var r=$e.alternate;r=r!==null?r.memoizedState:null}else r=nt.next;var i=St===null?$e.memoizedState:St.next;if(i!==null)St=i,nt=r;else{if(r===null)throw $e.alternate===null?Error(s(467)):Error(s(310));nt=r,r={memoizedState:nt.memoizedState,baseState:nt.baseState,baseQueue:nt.baseQueue,queue:nt.queue,next:null},St===null?$e.memoizedState=St=r:St=St.next=r}return St}function Yc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ro(r){var i=No;return No+=1,aa===null&&(aa=[]),r=g0(aa,r,i),i=$e,(St===null?i.memoizedState:St.next)===null&&(i=i.alternate,N.H=i===null||i.memoizedState===null?ov:Lh),r}function Xc(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Ro(r);if(r.$$typeof===E)return Pt(r)}throw Error(s(438,String(r)))}function Th(r){var i=null,o=$e.updateQueue;if(o!==null&&(i=o.memoCache),i==null){var u=$e.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(i={data:u.data.map(function(g){return g.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),o===null&&(o=Yc(),$e.updateQueue=o),o.memoCache=i,o=i.data[i.index],o===void 0)for(o=i.data[i.index]=Array(r),u=0;u<r;u++)o[u]=G;return i.index++,o}function Ir(r,i){return typeof i=="function"?i(r):i}function Kc(r){var i=xt();return Nh(i,nt,r)}function Nh(r,i,o){var u=r.queue;if(u===null)throw Error(s(311));u.lastRenderedReducer=o;var g=r.baseQueue,v=u.pending;if(v!==null){if(g!==null){var R=g.next;g.next=v.next,v.next=R}i.baseQueue=g=v,u.pending=null}if(v=r.baseState,g===null)r.memoizedState=v;else{i=g.next;var L=R=null,K=null,ne=i,ue=!1;do{var me=ne.lane&-536870913;if(me!==ne.lane?(Qe&me)===me:(jr&me)===me){var se=ne.revertLane;if(se===0)K!==null&&(K=K.next={lane:0,revertLane:0,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null}),me===ea&&(ue=!0);else if((jr&se)===se){ne=ne.next,se===ea&&(ue=!0);continue}else me={lane:0,revertLane:ne.revertLane,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},K===null?(L=K=me,R=v):K=K.next=me,$e.lanes|=se,bs|=se;me=ne.action,ii&&o(v,me),v=ne.hasEagerState?ne.eagerState:o(v,me)}else se={lane:me,revertLane:ne.revertLane,gesture:ne.gesture,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},K===null?(L=K=se,R=v):K=K.next=se,$e.lanes|=me,bs|=me;ne=ne.next}while(ne!==null&&ne!==i);if(K===null?R=v:K.next=L,!yn(v,r.memoizedState)&&(Ct=!0,ue&&(o=ta,o!==null)))throw o;r.memoizedState=v,r.baseState=R,r.baseQueue=K,u.lastRenderedState=v}return g===null&&(u.lanes=0),[r.memoizedState,u.dispatch]}function Rh(r){var i=xt(),o=i.queue;if(o===null)throw Error(s(311));o.lastRenderedReducer=r;var u=o.dispatch,g=o.pending,v=i.memoizedState;if(g!==null){o.pending=null;var R=g=g.next;do v=r(v,R.action),R=R.next;while(R!==g);yn(v,i.memoizedState)||(Ct=!0),i.memoizedState=v,i.baseQueue===null&&(i.baseState=v),o.lastRenderedState=v}return[v,u]}function T0(r,i,o){var u=$e,g=xt(),v=Ge;if(v){if(o===void 0)throw Error(s(407));o=o()}else o=i();var R=!yn((nt||g).memoizedState,o);if(R&&(g.memoizedState=o,Ct=!0),g=g.queue,Ih(O0.bind(null,u,g,r),[r]),g.getSnapshot!==i||R||St!==null&&St.memoizedState.tag&1){if(u.flags|=2048,oa(9,{destroy:void 0},R0.bind(null,u,g,o,i),null),at===null)throw Error(s(349));v||(jr&127)!==0||N0(u,i,o)}return o}function N0(r,i,o){r.flags|=16384,r={getSnapshot:i,value:o},i=$e.updateQueue,i===null?(i=Yc(),$e.updateQueue=i,i.stores=[r]):(o=i.stores,o===null?i.stores=[r]:o.push(r))}function R0(r,i,o,u){i.value=o,i.getSnapshot=u,j0(i)&&I0(r)}function O0(r,i,o){return o(function(){j0(i)&&I0(r)})}function j0(r){var i=r.getSnapshot;r=r.value;try{var o=i();return!yn(r,o)}catch{return!0}}function I0(r){var i=Ks(r,2);i!==null&&un(i,r,2)}function Oh(r){var i=en();if(typeof r=="function"){var o=r;if(r=o(),ii){ge(!0);try{o()}finally{ge(!1)}}}return i.memoizedState=i.baseState=r,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ir,lastRenderedState:r},i}function k0(r,i,o,u){return r.baseState=o,Nh(r,nt,typeof u=="function"?u:Ir)}function UT(r,i,o,u,g){if(Zc(r))throw Error(s(485));if(r=i.action,r!==null){var v={payload:g,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(R){v.listeners.push(R)}};N.T!==null?o(!0):v.isTransition=!1,u(v),o=i.pending,o===null?(v.next=i.pending=v,M0(i,v)):(v.next=o.next,i.pending=o.next=v)}}function M0(r,i){var o=i.action,u=i.payload,g=r.state;if(i.isTransition){var v=N.T,R={};N.T=R;try{var L=o(g,u),K=N.S;K!==null&&K(R,L),D0(r,i,L)}catch(ne){jh(r,i,ne)}finally{v!==null&&R.types!==null&&(v.types=R.types),N.T=v}}else try{v=o(g,u),D0(r,i,v)}catch(ne){jh(r,i,ne)}}function D0(r,i,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){B0(r,i,u)},function(u){return jh(r,i,u)}):B0(r,i,o)}function B0(r,i,o){i.status="fulfilled",i.value=o,U0(i),r.state=o,i=r.pending,i!==null&&(o=i.next,o===i?r.pending=null:(o=o.next,i.next=o,M0(r,o)))}function jh(r,i,o){var u=r.pending;if(r.pending=null,u!==null){u=u.next;do i.status="rejected",i.reason=o,U0(i),i=i.next;while(i!==u)}r.action=null}function U0(r){r=r.listeners;for(var i=0;i<r.length;i++)(0,r[i])()}function L0(r,i){return i}function $0(r,i){if(Ge){var o=at.formState;if(o!==null){e:{var u=$e;if(Ge){if(ct){t:{for(var g=ct,v=Un;g.nodeType!==8;){if(!v){g=null;break t}if(g=$n(g.nextSibling),g===null){g=null;break t}}v=g.data,g=v==="F!"||v==="F"?g:null}if(g){ct=$n(g.nextSibling),u=g.data==="F!";break e}}ds(u)}u=!1}u&&(i=o[0])}}return o=en(),o.memoizedState=o.baseState=i,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:L0,lastRenderedState:i},o.queue=u,o=sv.bind(null,$e,u),u.dispatch=o,u=Oh(!1),v=Uh.bind(null,$e,!1,u.queue),u=en(),g={state:i,dispatch:null,action:r,pending:null},u.queue=g,o=UT.bind(null,$e,g,v,o),g.dispatch=o,u.memoizedState=r,[i,o,!1]}function z0(r){var i=xt();return P0(i,nt,r)}function P0(r,i,o){if(i=Nh(r,i,L0)[0],r=Kc(Ir)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var u=Ro(i)}catch(R){throw R===na?zc:R}else u=i;i=xt();var g=i.queue,v=g.dispatch;return o!==i.memoizedState&&($e.flags|=2048,oa(9,{destroy:void 0},LT.bind(null,g,o),null)),[u,v,r]}function LT(r,i){r.action=i}function H0(r){var i=xt(),o=nt;if(o!==null)return P0(i,o,r);xt(),i=i.memoizedState,o=xt();var u=o.queue.dispatch;return o.memoizedState=r,[i,u,!1]}function oa(r,i,o,u){return r={tag:r,create:o,deps:u,inst:i,next:null},i=$e.updateQueue,i===null&&(i=Yc(),$e.updateQueue=i),o=i.lastEffect,o===null?i.lastEffect=r.next=r:(u=o.next,o.next=r,r.next=u,i.lastEffect=r),r}function q0(){return xt().memoizedState}function Wc(r,i,o,u){var g=en();$e.flags|=r,g.memoizedState=oa(1|i,{destroy:void 0},o,u===void 0?null:u)}function Jc(r,i,o,u){var g=xt();u=u===void 0?null:u;var v=g.memoizedState.inst;nt!==null&&u!==null&&xh(u,nt.memoizedState.deps)?g.memoizedState=oa(i,v,o,u):($e.flags|=r,g.memoizedState=oa(1|i,v,o,u))}function Q0(r,i){Wc(8390656,8,r,i)}function Ih(r,i){Jc(2048,8,r,i)}function $T(r){$e.flags|=4;var i=$e.updateQueue;if(i===null)i=Yc(),$e.updateQueue=i,i.events=[r];else{var o=i.events;o===null?i.events=[r]:o.push(r)}}function V0(r){var i=xt().memoizedState;return $T({ref:i,nextImpl:r}),function(){if((Ze&2)!==0)throw Error(s(440));return i.impl.apply(void 0,arguments)}}function F0(r,i){return Jc(4,2,r,i)}function G0(r,i){return Jc(4,4,r,i)}function Y0(r,i){if(typeof i=="function"){r=r();var o=i(r);return function(){typeof o=="function"?o():i(null)}}if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function X0(r,i,o){o=o!=null?o.concat([r]):null,Jc(4,4,Y0.bind(null,i,r),o)}function kh(){}function K0(r,i){var o=xt();i=i===void 0?null:i;var u=o.memoizedState;return i!==null&&xh(i,u[1])?u[0]:(o.memoizedState=[r,i],r)}function W0(r,i){var o=xt();i=i===void 0?null:i;var u=o.memoizedState;if(i!==null&&xh(i,u[1]))return u[0];if(u=r(),ii){ge(!0);try{r()}finally{ge(!1)}}return o.memoizedState=[u,i],u}function Mh(r,i,o){return o===void 0||(jr&1073741824)!==0&&(Qe&261930)===0?r.memoizedState=i:(r.memoizedState=o,r=Jv(),$e.lanes|=r,bs|=r,o)}function J0(r,i,o,u){return yn(o,i)?o:sa.current!==null?(r=Mh(r,o,u),yn(r,i)||(Ct=!0),r):(jr&42)===0||(jr&1073741824)!==0&&(Qe&261930)===0?(Ct=!0,r.memoizedState=o):(r=Jv(),$e.lanes|=r,bs|=r,i)}function Z0(r,i,o,u,g){var v=B.p;B.p=v!==0&&8>v?v:8;var R=N.T,L={};N.T=L,Uh(r,!1,i,o);try{var K=g(),ne=N.S;if(ne!==null&&ne(L,K),K!==null&&typeof K=="object"&&typeof K.then=="function"){var ue=MT(K,u);Oo(r,i,ue,An(r))}else Oo(r,i,u,An(r))}catch(me){Oo(r,i,{then:function(){},status:"rejected",reason:me},An())}finally{B.p=v,R!==null&&L.types!==null&&(R.types=L.types),N.T=R}}function zT(){}function Dh(r,i,o,u){if(r.tag!==5)throw Error(s(476));var g=ev(r).queue;Z0(r,g,i,U,o===null?zT:function(){return tv(r),o(u)})}function ev(r){var i=r.memoizedState;if(i!==null)return i;i={memoizedState:U,baseState:U,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ir,lastRenderedState:U},next:null};var o={};return i.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ir,lastRenderedState:o},next:null},r.memoizedState=i,r=r.alternate,r!==null&&(r.memoizedState=i),i}function tv(r){var i=ev(r);i.next===null&&(i=r.alternate.memoizedState),Oo(r,i.next.queue,{},An())}function Bh(){return Pt(Go)}function nv(){return xt().memoizedState}function rv(){return xt().memoizedState}function PT(r){for(var i=r.return;i!==null;){switch(i.tag){case 24:case 3:var o=An();r=ms(o);var u=ps(i,r,o);u!==null&&(un(u,i,o),So(u,i,o)),i={cache:dh()},r.payload=i;return}i=i.return}}function HT(r,i,o){var u=An();o={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Zc(r)?iv(i,o):(o=eh(r,i,o,u),o!==null&&(un(o,r,u),av(o,i,u)))}function sv(r,i,o){var u=An();Oo(r,i,o,u)}function Oo(r,i,o,u){var g={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Zc(r))iv(i,g);else{var v=r.alternate;if(r.lanes===0&&(v===null||v.lanes===0)&&(v=i.lastRenderedReducer,v!==null))try{var R=i.lastRenderedState,L=v(R,o);if(g.hasEagerState=!0,g.eagerState=L,yn(L,R))return kc(r,i,g,0),at===null&&Ic(),!1}catch{}finally{}if(o=eh(r,i,g,u),o!==null)return un(o,r,u),av(o,i,u),!0}return!1}function Uh(r,i,o,u){if(u={lane:2,revertLane:pm(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Zc(r)){if(i)throw Error(s(479))}else i=eh(r,o,u,2),i!==null&&un(i,r,2)}function Zc(r){var i=r.alternate;return r===$e||i!==null&&i===$e}function iv(r,i){ia=Fc=!0;var o=r.pending;o===null?i.next=i:(i.next=o.next,o.next=i),r.pending=i}function av(r,i,o){if((o&4194048)!==0){var u=i.lanes;u&=r.pendingLanes,o|=u,i.lanes=o,fc(r,o)}}var jo={readContext:Pt,use:Xc,useCallback:_t,useContext:_t,useEffect:_t,useImperativeHandle:_t,useLayoutEffect:_t,useInsertionEffect:_t,useMemo:_t,useReducer:_t,useRef:_t,useState:_t,useDebugValue:_t,useDeferredValue:_t,useTransition:_t,useSyncExternalStore:_t,useId:_t,useHostTransitionStatus:_t,useFormState:_t,useActionState:_t,useOptimistic:_t,useMemoCache:_t,useCacheRefresh:_t};jo.useEffectEvent=_t;var ov={readContext:Pt,use:Xc,useCallback:function(r,i){return en().memoizedState=[r,i===void 0?null:i],r},useContext:Pt,useEffect:Q0,useImperativeHandle:function(r,i,o){o=o!=null?o.concat([r]):null,Wc(4194308,4,Y0.bind(null,i,r),o)},useLayoutEffect:function(r,i){return Wc(4194308,4,r,i)},useInsertionEffect:function(r,i){Wc(4,2,r,i)},useMemo:function(r,i){var o=en();i=i===void 0?null:i;var u=r();if(ii){ge(!0);try{r()}finally{ge(!1)}}return o.memoizedState=[u,i],u},useReducer:function(r,i,o){var u=en();if(o!==void 0){var g=o(i);if(ii){ge(!0);try{o(i)}finally{ge(!1)}}}else g=i;return u.memoizedState=u.baseState=g,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:g},u.queue=r,r=r.dispatch=HT.bind(null,$e,r),[u.memoizedState,r]},useRef:function(r){var i=en();return r={current:r},i.memoizedState=r},useState:function(r){r=Oh(r);var i=r.queue,o=sv.bind(null,$e,i);return i.dispatch=o,[r.memoizedState,o]},useDebugValue:kh,useDeferredValue:function(r,i){var o=en();return Mh(o,r,i)},useTransition:function(){var r=Oh(!1);return r=Z0.bind(null,$e,r.queue,!0,!1),en().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,i,o){var u=$e,g=en();if(Ge){if(o===void 0)throw Error(s(407));o=o()}else{if(o=i(),at===null)throw Error(s(349));(Qe&127)!==0||N0(u,i,o)}g.memoizedState=o;var v={value:o,getSnapshot:i};return g.queue=v,Q0(O0.bind(null,u,v,r),[r]),u.flags|=2048,oa(9,{destroy:void 0},R0.bind(null,u,v,o,i),null),o},useId:function(){var r=en(),i=at.identifierPrefix;if(Ge){var o=cr,u=lr;o=(u&~(1<<32-Ee(u)-1)).toString(32)+o,i="_"+i+"R_"+o,o=Gc++,0<o&&(i+="H"+o.toString(32)),i+="_"}else o=DT++,i="_"+i+"r_"+o.toString(32)+"_";return r.memoizedState=i},useHostTransitionStatus:Bh,useFormState:$0,useActionState:$0,useOptimistic:function(r){var i=en();i.memoizedState=i.baseState=r;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=o,i=Uh.bind(null,$e,!0,o),o.dispatch=i,[r,i]},useMemoCache:Th,useCacheRefresh:function(){return en().memoizedState=PT.bind(null,$e)},useEffectEvent:function(r){var i=en(),o={impl:r};return i.memoizedState=o,function(){if((Ze&2)!==0)throw Error(s(440));return o.impl.apply(void 0,arguments)}}},Lh={readContext:Pt,use:Xc,useCallback:K0,useContext:Pt,useEffect:Ih,useImperativeHandle:X0,useInsertionEffect:F0,useLayoutEffect:G0,useMemo:W0,useReducer:Kc,useRef:q0,useState:function(){return Kc(Ir)},useDebugValue:kh,useDeferredValue:function(r,i){var o=xt();return J0(o,nt.memoizedState,r,i)},useTransition:function(){var r=Kc(Ir)[0],i=xt().memoizedState;return[typeof r=="boolean"?r:Ro(r),i]},useSyncExternalStore:T0,useId:nv,useHostTransitionStatus:Bh,useFormState:z0,useActionState:z0,useOptimistic:function(r,i){var o=xt();return k0(o,nt,r,i)},useMemoCache:Th,useCacheRefresh:rv};Lh.useEffectEvent=V0;var lv={readContext:Pt,use:Xc,useCallback:K0,useContext:Pt,useEffect:Ih,useImperativeHandle:X0,useInsertionEffect:F0,useLayoutEffect:G0,useMemo:W0,useReducer:Rh,useRef:q0,useState:function(){return Rh(Ir)},useDebugValue:kh,useDeferredValue:function(r,i){var o=xt();return nt===null?Mh(o,r,i):J0(o,nt.memoizedState,r,i)},useTransition:function(){var r=Rh(Ir)[0],i=xt().memoizedState;return[typeof r=="boolean"?r:Ro(r),i]},useSyncExternalStore:T0,useId:nv,useHostTransitionStatus:Bh,useFormState:H0,useActionState:H0,useOptimistic:function(r,i){var o=xt();return nt!==null?k0(o,nt,r,i):(o.baseState=r,[r,o.queue.dispatch])},useMemoCache:Th,useCacheRefresh:rv};lv.useEffectEvent=V0;function $h(r,i,o,u){i=r.memoizedState,o=o(u,i),o=o==null?i:m({},i,o),r.memoizedState=o,r.lanes===0&&(r.updateQueue.baseState=o)}var zh={enqueueSetState:function(r,i,o){r=r._reactInternals;var u=An(),g=ms(u);g.payload=i,o!=null&&(g.callback=o),i=ps(r,g,u),i!==null&&(un(i,r,u),So(i,r,u))},enqueueReplaceState:function(r,i,o){r=r._reactInternals;var u=An(),g=ms(u);g.tag=1,g.payload=i,o!=null&&(g.callback=o),i=ps(r,g,u),i!==null&&(un(i,r,u),So(i,r,u))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var o=An(),u=ms(o);u.tag=2,i!=null&&(u.callback=i),i=ps(r,u,o),i!==null&&(un(i,r,o),So(i,r,o))}};function cv(r,i,o,u,g,v,R){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(u,v,R):i.prototype&&i.prototype.isPureReactComponent?!yo(o,u)||!yo(g,v):!0}function uv(r,i,o,u){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,u),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,u),i.state!==r&&zh.enqueueReplaceState(i,i.state,null)}function ai(r,i){var o=i;if("ref"in i){o={};for(var u in i)u!=="ref"&&(o[u]=i[u])}if(r=r.defaultProps){o===i&&(o=m({},o));for(var g in r)o[g]===void 0&&(o[g]=r[g])}return o}function dv(r){jc(r)}function fv(r){console.error(r)}function hv(r){jc(r)}function eu(r,i){try{var o=r.onUncaughtError;o(i.value,{componentStack:i.stack})}catch(u){setTimeout(function(){throw u})}}function mv(r,i,o){try{var u=r.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Ph(r,i,o){return o=ms(o),o.tag=3,o.payload={element:null},o.callback=function(){eu(r,i)},o}function pv(r){return r=ms(r),r.tag=3,r}function gv(r,i,o,u){var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var v=u.value;r.payload=function(){return g(v)},r.callback=function(){mv(i,o,u)}}var R=o.stateNode;R!==null&&typeof R.componentDidCatch=="function"&&(r.callback=function(){mv(i,o,u),typeof g!="function"&&(ws===null?ws=new Set([this]):ws.add(this));var L=u.stack;this.componentDidCatch(u.value,{componentStack:L!==null?L:""})})}function qT(r,i,o,u,g){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(i=o.alternate,i!==null&&Zi(i,o,g,!0),o=_n.current,o!==null){switch(o.tag){case 31:case 13:return Ln===null?fu():o.alternate===null&&bt===0&&(bt=3),o.flags&=-257,o.flags|=65536,o.lanes=g,u===Pc?o.flags|=16384:(i=o.updateQueue,i===null?o.updateQueue=new Set([u]):i.add(u),fm(r,u,g)),!1;case 22:return o.flags|=65536,u===Pc?o.flags|=16384:(i=o.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=i):(o=i.retryQueue,o===null?i.retryQueue=new Set([u]):o.add(u)),fm(r,u,g)),!1}throw Error(s(435,o.tag))}return fm(r,u,g),fu(),!1}if(Ge)return i=_n.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=g,u!==ah&&(r=Error(s(422),{cause:u}),bo(Mn(r,o)))):(u!==ah&&(i=Error(s(423),{cause:u}),bo(Mn(i,o))),r=r.current.alternate,r.flags|=65536,g&=-g,r.lanes|=g,u=Mn(u,o),g=Ph(r.stateNode,u,g),yh(r,g),bt!==4&&(bt=2)),!1;var v=Error(s(520),{cause:u});if(v=Mn(v,o),$o===null?$o=[v]:$o.push(v),bt!==4&&(bt=2),i===null)return!0;u=Mn(u,o),o=i;do{switch(o.tag){case 3:return o.flags|=65536,r=g&-g,o.lanes|=r,r=Ph(o.stateNode,u,r),yh(o,r),!1;case 1:if(i=o.type,v=o.stateNode,(o.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(ws===null||!ws.has(v))))return o.flags|=65536,g&=-g,o.lanes|=g,g=pv(g),gv(g,r,o,u),yh(o,g),!1}o=o.return}while(o!==null);return!1}var Hh=Error(s(461)),Ct=!1;function Ht(r,i,o,u){i.child=r===null?b0(i,null,o,u):si(i,r.child,o,u)}function yv(r,i,o,u,g){o=o.render;var v=i.ref;if("ref"in u){var R={};for(var L in u)L!=="ref"&&(R[L]=u[L])}else R=u;return ei(i),u=Ah(r,i,o,R,v,g),L=Eh(),r!==null&&!Ct?(Sh(r,i,g),kr(r,i,g)):(Ge&&L&&sh(i),i.flags|=1,Ht(r,i,u,g),i.child)}function vv(r,i,o,u,g){if(r===null){var v=o.type;return typeof v=="function"&&!th(v)&&v.defaultProps===void 0&&o.compare===null?(i.tag=15,i.type=v,_v(r,i,v,u,g)):(r=Dc(o.type,null,u,i,i.mode,g),r.ref=i.ref,r.return=i,i.child=r)}if(v=r.child,!Kh(r,g)){var R=v.memoizedProps;if(o=o.compare,o=o!==null?o:yo,o(R,u)&&r.ref===i.ref)return kr(r,i,g)}return i.flags|=1,r=Tr(v,u),r.ref=i.ref,r.return=i,i.child=r}function _v(r,i,o,u,g){if(r!==null){var v=r.memoizedProps;if(yo(v,u)&&r.ref===i.ref)if(Ct=!1,i.pendingProps=u=v,Kh(r,g))(r.flags&131072)!==0&&(Ct=!0);else return i.lanes=r.lanes,kr(r,i,g)}return qh(r,i,o,u,g)}function bv(r,i,o,u){var g=u.children,v=r!==null?r.memoizedState:null;if(r===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((i.flags&128)!==0){if(v=v!==null?v.baseLanes|o:o,r!==null){for(u=i.child=r.child,g=0;u!==null;)g=g|u.lanes|u.childLanes,u=u.sibling;u=g&~v}else u=0,i.child=null;return wv(r,i,v,o,u)}if((o&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},r!==null&&$c(i,v!==null?v.cachePool:null),v!==null?A0(i,v):_h(),E0(i);else return u=i.lanes=536870912,wv(r,i,v!==null?v.baseLanes|o:o,o,u)}else v!==null?($c(i,v.cachePool),A0(i,v),ys(),i.memoizedState=null):(r!==null&&$c(i,null),_h(),ys());return Ht(r,i,g,o),i.child}function Io(r,i){return r!==null&&r.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function wv(r,i,o,u,g){var v=hh();return v=v===null?null:{parent:Et._currentValue,pool:v},i.memoizedState={baseLanes:o,cachePool:v},r!==null&&$c(i,null),_h(),E0(i),r!==null&&Zi(r,i,u,!0),i.childLanes=g,null}function tu(r,i){return i=ru({mode:i.mode,children:i.children},r.mode),i.ref=r.ref,r.child=i,i.return=r,i}function xv(r,i,o){return si(i,r.child,null,o),r=tu(i,i.pendingProps),r.flags|=2,bn(i),i.memoizedState=null,r}function QT(r,i,o){var u=i.pendingProps,g=(i.flags&128)!==0;if(i.flags&=-129,r===null){if(Ge){if(u.mode==="hidden")return r=tu(i,u),i.lanes=536870912,Io(null,r);if(wh(i),(r=ct)?(r=M_(r,Un),r=r!==null&&r.data==="&"?r:null,r!==null&&(i.memoizedState={dehydrated:r,treeContext:cs!==null?{id:lr,overflow:cr}:null,retryLane:536870912,hydrationErrors:null},o=i0(r),o.return=i,i.child=o,zt=i,ct=null)):r=null,r===null)throw ds(i);return i.lanes=536870912,null}return tu(i,u)}var v=r.memoizedState;if(v!==null){var R=v.dehydrated;if(wh(i),g)if(i.flags&256)i.flags&=-257,i=xv(r,i,o);else if(i.memoizedState!==null)i.child=r.child,i.flags|=128,i=null;else throw Error(s(558));else if(Ct||Zi(r,i,o,!1),g=(o&r.childLanes)!==0,Ct||g){if(u=at,u!==null&&(R=hc(u,o),R!==0&&R!==v.retryLane))throw v.retryLane=R,Ks(r,R),un(u,r,R),Hh;fu(),i=xv(r,i,o)}else r=v.treeContext,ct=$n(R.nextSibling),zt=i,Ge=!0,us=null,Un=!1,r!==null&&l0(i,r),i=tu(i,u),i.flags|=4096;return i}return r=Tr(r.child,{mode:u.mode,children:u.children}),r.ref=i.ref,i.child=r,r.return=i,r}function nu(r,i){var o=i.ref;if(o===null)r!==null&&r.ref!==null&&(i.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(s(284));(r===null||r.ref!==o)&&(i.flags|=4194816)}}function qh(r,i,o,u,g){return ei(i),o=Ah(r,i,o,u,void 0,g),u=Eh(),r!==null&&!Ct?(Sh(r,i,g),kr(r,i,g)):(Ge&&u&&sh(i),i.flags|=1,Ht(r,i,o,g),i.child)}function Av(r,i,o,u,g,v){return ei(i),i.updateQueue=null,o=C0(i,u,o,g),S0(r),u=Eh(),r!==null&&!Ct?(Sh(r,i,v),kr(r,i,v)):(Ge&&u&&sh(i),i.flags|=1,Ht(r,i,o,v),i.child)}function Ev(r,i,o,u,g){if(ei(i),i.stateNode===null){var v=Xi,R=o.contextType;typeof R=="object"&&R!==null&&(v=Pt(R)),v=new o(u,v),i.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=zh,i.stateNode=v,v._reactInternals=i,v=i.stateNode,v.props=u,v.state=i.memoizedState,v.refs={},ph(i),R=o.contextType,v.context=typeof R=="object"&&R!==null?Pt(R):Xi,v.state=i.memoizedState,R=o.getDerivedStateFromProps,typeof R=="function"&&($h(i,o,R,u),v.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(R=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),R!==v.state&&zh.enqueueReplaceState(v,v.state,null),To(i,u,v,g),Co(),v.state=i.memoizedState),typeof v.componentDidMount=="function"&&(i.flags|=4194308),u=!0}else if(r===null){v=i.stateNode;var L=i.memoizedProps,K=ai(o,L);v.props=K;var ne=v.context,ue=o.contextType;R=Xi,typeof ue=="object"&&ue!==null&&(R=Pt(ue));var me=o.getDerivedStateFromProps;ue=typeof me=="function"||typeof v.getSnapshotBeforeUpdate=="function",L=i.pendingProps!==L,ue||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(L||ne!==R)&&uv(i,v,u,R),hs=!1;var se=i.memoizedState;v.state=se,To(i,u,v,g),Co(),ne=i.memoizedState,L||se!==ne||hs?(typeof me=="function"&&($h(i,o,me,u),ne=i.memoizedState),(K=hs||cv(i,o,K,u,se,ne,R))?(ue||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(i.flags|=4194308)):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=u,i.memoizedState=ne),v.props=u,v.state=ne,v.context=R,u=K):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),u=!1)}else{v=i.stateNode,gh(r,i),R=i.memoizedProps,ue=ai(o,R),v.props=ue,me=i.pendingProps,se=v.context,ne=o.contextType,K=Xi,typeof ne=="object"&&ne!==null&&(K=Pt(ne)),L=o.getDerivedStateFromProps,(ne=typeof L=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(R!==me||se!==K)&&uv(i,v,u,K),hs=!1,se=i.memoizedState,v.state=se,To(i,u,v,g),Co();var le=i.memoizedState;R!==me||se!==le||hs||r!==null&&r.dependencies!==null&&Uc(r.dependencies)?(typeof L=="function"&&($h(i,o,L,u),le=i.memoizedState),(ue=hs||cv(i,o,ue,u,se,le,K)||r!==null&&r.dependencies!==null&&Uc(r.dependencies))?(ne||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(u,le,K),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(u,le,K)),typeof v.componentDidUpdate=="function"&&(i.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof v.componentDidUpdate!="function"||R===r.memoizedProps&&se===r.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||R===r.memoizedProps&&se===r.memoizedState||(i.flags|=1024),i.memoizedProps=u,i.memoizedState=le),v.props=u,v.state=le,v.context=K,u=ue):(typeof v.componentDidUpdate!="function"||R===r.memoizedProps&&se===r.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||R===r.memoizedProps&&se===r.memoizedState||(i.flags|=1024),u=!1)}return v=u,nu(r,i),u=(i.flags&128)!==0,v||u?(v=i.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:v.render(),i.flags|=1,r!==null&&u?(i.child=si(i,r.child,null,g),i.child=si(i,null,o,g)):Ht(r,i,o,g),i.memoizedState=v.state,r=i.child):r=kr(r,i,g),r}function Sv(r,i,o,u){return Js(),i.flags|=256,Ht(r,i,o,u),i.child}var Qh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Vh(r){return{baseLanes:r,cachePool:m0()}}function Fh(r,i,o){return r=r!==null?r.childLanes&~o:0,i&&(r|=xn),r}function Cv(r,i,o){var u=i.pendingProps,g=!1,v=(i.flags&128)!==0,R;if((R=v)||(R=r!==null&&r.memoizedState===null?!1:(wt.current&2)!==0),R&&(g=!0,i.flags&=-129),R=(i.flags&32)!==0,i.flags&=-33,r===null){if(Ge){if(g?gs(i):ys(),(r=ct)?(r=M_(r,Un),r=r!==null&&r.data!=="&"?r:null,r!==null&&(i.memoizedState={dehydrated:r,treeContext:cs!==null?{id:lr,overflow:cr}:null,retryLane:536870912,hydrationErrors:null},o=i0(r),o.return=i,i.child=o,zt=i,ct=null)):r=null,r===null)throw ds(i);return Nm(r)?i.lanes=32:i.lanes=536870912,null}var L=u.children;return u=u.fallback,g?(ys(),g=i.mode,L=ru({mode:"hidden",children:L},g),u=Ws(u,g,o,null),L.return=i,u.return=i,L.sibling=u,i.child=L,u=i.child,u.memoizedState=Vh(o),u.childLanes=Fh(r,R,o),i.memoizedState=Qh,Io(null,u)):(gs(i),Gh(i,L))}var K=r.memoizedState;if(K!==null&&(L=K.dehydrated,L!==null)){if(v)i.flags&256?(gs(i),i.flags&=-257,i=Yh(r,i,o)):i.memoizedState!==null?(ys(),i.child=r.child,i.flags|=128,i=null):(ys(),L=u.fallback,g=i.mode,u=ru({mode:"visible",children:u.children},g),L=Ws(L,g,o,null),L.flags|=2,u.return=i,L.return=i,u.sibling=L,i.child=u,si(i,r.child,null,o),u=i.child,u.memoizedState=Vh(o),u.childLanes=Fh(r,R,o),i.memoizedState=Qh,i=Io(null,u));else if(gs(i),Nm(L)){if(R=L.nextSibling&&L.nextSibling.dataset,R)var ne=R.dgst;R=ne,u=Error(s(419)),u.stack="",u.digest=R,bo({value:u,source:null,stack:null}),i=Yh(r,i,o)}else if(Ct||Zi(r,i,o,!1),R=(o&r.childLanes)!==0,Ct||R){if(R=at,R!==null&&(u=hc(R,o),u!==0&&u!==K.retryLane))throw K.retryLane=u,Ks(r,u),un(R,r,u),Hh;Tm(L)||fu(),i=Yh(r,i,o)}else Tm(L)?(i.flags|=192,i.child=r.child,i=null):(r=K.treeContext,ct=$n(L.nextSibling),zt=i,Ge=!0,us=null,Un=!1,r!==null&&l0(i,r),i=Gh(i,u.children),i.flags|=4096);return i}return g?(ys(),L=u.fallback,g=i.mode,K=r.child,ne=K.sibling,u=Tr(K,{mode:"hidden",children:u.children}),u.subtreeFlags=K.subtreeFlags&65011712,ne!==null?L=Tr(ne,L):(L=Ws(L,g,o,null),L.flags|=2),L.return=i,u.return=i,u.sibling=L,i.child=u,Io(null,u),u=i.child,L=r.child.memoizedState,L===null?L=Vh(o):(g=L.cachePool,g!==null?(K=Et._currentValue,g=g.parent!==K?{parent:K,pool:K}:g):g=m0(),L={baseLanes:L.baseLanes|o,cachePool:g}),u.memoizedState=L,u.childLanes=Fh(r,R,o),i.memoizedState=Qh,Io(r.child,u)):(gs(i),o=r.child,r=o.sibling,o=Tr(o,{mode:"visible",children:u.children}),o.return=i,o.sibling=null,r!==null&&(R=i.deletions,R===null?(i.deletions=[r],i.flags|=16):R.push(r)),i.child=o,i.memoizedState=null,o)}function Gh(r,i){return i=ru({mode:"visible",children:i},r.mode),i.return=r,r.child=i}function ru(r,i){return r=vn(22,r,null,i),r.lanes=0,r}function Yh(r,i,o){return si(i,r.child,null,o),r=Gh(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function Tv(r,i,o){r.lanes|=i;var u=r.alternate;u!==null&&(u.lanes|=i),ch(r.return,i,o)}function Xh(r,i,o,u,g,v){var R=r.memoizedState;R===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:g,treeForkCount:v}:(R.isBackwards=i,R.rendering=null,R.renderingStartTime=0,R.last=u,R.tail=o,R.tailMode=g,R.treeForkCount=v)}function Nv(r,i,o){var u=i.pendingProps,g=u.revealOrder,v=u.tail;u=u.children;var R=wt.current,L=(R&2)!==0;if(L?(R=R&1|2,i.flags|=128):R&=1,X(wt,R),Ht(r,i,u,o),u=Ge?_o:0,!L&&r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Tv(r,o,i);else if(r.tag===19)Tv(r,o,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(g){case"forwards":for(o=i.child,g=null;o!==null;)r=o.alternate,r!==null&&Vc(r)===null&&(g=o),o=o.sibling;o=g,o===null?(g=i.child,i.child=null):(g=o.sibling,o.sibling=null),Xh(i,!1,g,o,v,u);break;case"backwards":case"unstable_legacy-backwards":for(o=null,g=i.child,i.child=null;g!==null;){if(r=g.alternate,r!==null&&Vc(r)===null){i.child=g;break}r=g.sibling,g.sibling=o,o=g,g=r}Xh(i,!0,o,null,v,u);break;case"together":Xh(i,!1,null,null,void 0,u);break;default:i.memoizedState=null}return i.child}function kr(r,i,o){if(r!==null&&(i.dependencies=r.dependencies),bs|=i.lanes,(o&i.childLanes)===0)if(r!==null){if(Zi(r,i,o,!1),(o&i.childLanes)===0)return null}else return null;if(r!==null&&i.child!==r.child)throw Error(s(153));if(i.child!==null){for(r=i.child,o=Tr(r,r.pendingProps),i.child=o,o.return=i;r.sibling!==null;)r=r.sibling,o=o.sibling=Tr(r,r.pendingProps),o.return=i;o.sibling=null}return i.child}function Kh(r,i){return(r.lanes&i)!==0?!0:(r=r.dependencies,!!(r!==null&&Uc(r)))}function VT(r,i,o){switch(i.tag){case 3:de(i,i.stateNode.containerInfo),fs(i,Et,r.memoizedState.cache),Js();break;case 27:case 5:oe(i);break;case 4:de(i,i.stateNode.containerInfo);break;case 10:fs(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,wh(i),null;break;case 13:var u=i.memoizedState;if(u!==null)return u.dehydrated!==null?(gs(i),i.flags|=128,null):(o&i.child.childLanes)!==0?Cv(r,i,o):(gs(i),r=kr(r,i,o),r!==null?r.sibling:null);gs(i);break;case 19:var g=(r.flags&128)!==0;if(u=(o&i.childLanes)!==0,u||(Zi(r,i,o,!1),u=(o&i.childLanes)!==0),g){if(u)return Nv(r,i,o);i.flags|=128}if(g=i.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),X(wt,wt.current),u)break;return null;case 22:return i.lanes=0,bv(r,i,o,i.pendingProps);case 24:fs(i,Et,r.memoizedState.cache)}return kr(r,i,o)}function Rv(r,i,o){if(r!==null)if(r.memoizedProps!==i.pendingProps)Ct=!0;else{if(!Kh(r,o)&&(i.flags&128)===0)return Ct=!1,VT(r,i,o);Ct=(r.flags&131072)!==0}else Ct=!1,Ge&&(i.flags&1048576)!==0&&o0(i,_o,i.index);switch(i.lanes=0,i.tag){case 16:e:{var u=i.pendingProps;if(r=ni(i.elementType),i.type=r,typeof r=="function")th(r)?(u=ai(r,u),i.tag=1,i=Ev(null,i,r,u,o)):(i.tag=0,i=qh(null,i,r,u,o));else{if(r!=null){var g=r.$$typeof;if(g===C){i.tag=11,i=yv(null,i,r,u,o);break e}else if(g===I){i.tag=14,i=vv(null,i,r,u,o);break e}}throw i=H(r)||r,Error(s(306,i,""))}}return i;case 0:return qh(r,i,i.type,i.pendingProps,o);case 1:return u=i.type,g=ai(u,i.pendingProps),Ev(r,i,u,g,o);case 3:e:{if(de(i,i.stateNode.containerInfo),r===null)throw Error(s(387));u=i.pendingProps;var v=i.memoizedState;g=v.element,gh(r,i),To(i,u,null,o);var R=i.memoizedState;if(u=R.cache,fs(i,Et,u),u!==v.cache&&uh(i,[Et],o,!0),Co(),u=R.element,v.isDehydrated)if(v={element:u,isDehydrated:!1,cache:R.cache},i.updateQueue.baseState=v,i.memoizedState=v,i.flags&256){i=Sv(r,i,u,o);break e}else if(u!==g){g=Mn(Error(s(424)),i),bo(g),i=Sv(r,i,u,o);break e}else{switch(r=i.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(ct=$n(r.firstChild),zt=i,Ge=!0,us=null,Un=!0,o=b0(i,null,u,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(Js(),u===g){i=kr(r,i,o);break e}Ht(r,i,u,o)}i=i.child}return i;case 26:return nu(r,i),r===null?(o=z_(i.type,null,i.pendingProps,null))?i.memoizedState=o:Ge||(o=i.type,r=i.pendingProps,u=_u(ae.current).createElement(o),u[jt]=i,u[Yt]=r,qt(u,o,r),At(u),i.stateNode=u):i.memoizedState=z_(i.type,r.memoizedProps,i.pendingProps,r.memoizedState),null;case 27:return oe(i),r===null&&Ge&&(u=i.stateNode=U_(i.type,i.pendingProps,ae.current),zt=i,Un=!0,g=ct,Ss(i.type)?(Rm=g,ct=$n(u.firstChild)):ct=g),Ht(r,i,i.pendingProps.children,o),nu(r,i),r===null&&(i.flags|=4194304),i.child;case 5:return r===null&&Ge&&((g=u=ct)&&(u=wN(u,i.type,i.pendingProps,Un),u!==null?(i.stateNode=u,zt=i,ct=$n(u.firstChild),Un=!1,g=!0):g=!1),g||ds(i)),oe(i),g=i.type,v=i.pendingProps,R=r!==null?r.memoizedProps:null,u=v.children,Em(g,v)?u=null:R!==null&&Em(g,R)&&(i.flags|=32),i.memoizedState!==null&&(g=Ah(r,i,BT,null,null,o),Go._currentValue=g),nu(r,i),Ht(r,i,u,o),i.child;case 6:return r===null&&Ge&&((r=o=ct)&&(o=xN(o,i.pendingProps,Un),o!==null?(i.stateNode=o,zt=i,ct=null,r=!0):r=!1),r||ds(i)),null;case 13:return Cv(r,i,o);case 4:return de(i,i.stateNode.containerInfo),u=i.pendingProps,r===null?i.child=si(i,null,u,o):Ht(r,i,u,o),i.child;case 11:return yv(r,i,i.type,i.pendingProps,o);case 7:return Ht(r,i,i.pendingProps,o),i.child;case 8:return Ht(r,i,i.pendingProps.children,o),i.child;case 12:return Ht(r,i,i.pendingProps.children,o),i.child;case 10:return u=i.pendingProps,fs(i,i.type,u.value),Ht(r,i,u.children,o),i.child;case 9:return g=i.type._context,u=i.pendingProps.children,ei(i),g=Pt(g),u=u(g),i.flags|=1,Ht(r,i,u,o),i.child;case 14:return vv(r,i,i.type,i.pendingProps,o);case 15:return _v(r,i,i.type,i.pendingProps,o);case 19:return Nv(r,i,o);case 31:return QT(r,i,o);case 22:return bv(r,i,o,i.pendingProps);case 24:return ei(i),u=Pt(Et),r===null?(g=hh(),g===null&&(g=at,v=dh(),g.pooledCache=v,v.refCount++,v!==null&&(g.pooledCacheLanes|=o),g=v),i.memoizedState={parent:u,cache:g},ph(i),fs(i,Et,g)):((r.lanes&o)!==0&&(gh(r,i),To(i,null,null,o),Co()),g=r.memoizedState,v=i.memoizedState,g.parent!==u?(g={parent:u,cache:u},i.memoizedState=g,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=g),fs(i,Et,u)):(u=v.cache,fs(i,Et,u),u!==g.cache&&uh(i,[Et],o,!0))),Ht(r,i,i.pendingProps.children,o),i.child;case 29:throw i.pendingProps}throw Error(s(156,i.tag))}function Mr(r){r.flags|=4}function Wh(r,i,o,u,g){if((i=(r.mode&32)!==0)&&(i=!1),i){if(r.flags|=16777216,(g&335544128)===g)if(r.stateNode.complete)r.flags|=8192;else if(n_())r.flags|=8192;else throw ri=Pc,mh}else r.flags&=-16777217}function Ov(r,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!V_(i))if(n_())r.flags|=8192;else throw ri=Pc,mh}function su(r,i){i!==null&&(r.flags|=4),r.flags&16384&&(i=r.tag!==22?uc():536870912,r.lanes|=i,da|=i)}function ko(r,i){if(!Ge)switch(r.tailMode){case"hidden":i=r.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?r.tail=null:o.sibling=null;break;case"collapsed":o=r.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:u.sibling=null}}function ut(r){var i=r.alternate!==null&&r.alternate.child===r.child,o=0,u=0;if(i)for(var g=r.child;g!==null;)o|=g.lanes|g.childLanes,u|=g.subtreeFlags&65011712,u|=g.flags&65011712,g.return=r,g=g.sibling;else for(g=r.child;g!==null;)o|=g.lanes|g.childLanes,u|=g.subtreeFlags,u|=g.flags,g.return=r,g=g.sibling;return r.subtreeFlags|=u,r.childLanes=o,i}function FT(r,i,o){var u=i.pendingProps;switch(ih(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ut(i),null;case 1:return ut(i),null;case 3:return o=i.stateNode,u=null,r!==null&&(u=r.memoizedState.cache),i.memoizedState.cache!==u&&(i.flags|=2048),Or(Et),ie(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(r===null||r.child===null)&&(Ji(i)?Mr(i):r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,oh())),ut(i),null;case 26:var g=i.type,v=i.memoizedState;return r===null?(Mr(i),v!==null?(ut(i),Ov(i,v)):(ut(i),Wh(i,g,null,u,o))):v?v!==r.memoizedState?(Mr(i),ut(i),Ov(i,v)):(ut(i),i.flags&=-16777217):(r=r.memoizedProps,r!==u&&Mr(i),ut(i),Wh(i,g,r,u,o)),null;case 27:if(pe(i),o=ae.current,g=i.type,r!==null&&i.stateNode!=null)r.memoizedProps!==u&&Mr(i);else{if(!u){if(i.stateNode===null)throw Error(s(166));return ut(i),null}r=Z.current,Ji(i)?c0(i):(r=U_(g,u,o),i.stateNode=r,Mr(i))}return ut(i),null;case 5:if(pe(i),g=i.type,r!==null&&i.stateNode!=null)r.memoizedProps!==u&&Mr(i);else{if(!u){if(i.stateNode===null)throw Error(s(166));return ut(i),null}if(v=Z.current,Ji(i))c0(i);else{var R=_u(ae.current);switch(v){case 1:v=R.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:v=R.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":v=R.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":v=R.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":v=R.createElement("div"),v.innerHTML="<script><\/script>",v=v.removeChild(v.firstChild);break;case"select":v=typeof u.is=="string"?R.createElement("select",{is:u.is}):R.createElement("select"),u.multiple?v.multiple=!0:u.size&&(v.size=u.size);break;default:v=typeof u.is=="string"?R.createElement(g,{is:u.is}):R.createElement(g)}}v[jt]=i,v[Yt]=u;e:for(R=i.child;R!==null;){if(R.tag===5||R.tag===6)v.appendChild(R.stateNode);else if(R.tag!==4&&R.tag!==27&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===i)break e;for(;R.sibling===null;){if(R.return===null||R.return===i)break e;R=R.return}R.sibling.return=R.return,R=R.sibling}i.stateNode=v;e:switch(qt(v,g,u),g){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Mr(i)}}return ut(i),Wh(i,i.type,r===null?null:r.memoizedProps,i.pendingProps,o),null;case 6:if(r&&i.stateNode!=null)r.memoizedProps!==u&&Mr(i);else{if(typeof u!="string"&&i.stateNode===null)throw Error(s(166));if(r=ae.current,Ji(i)){if(r=i.stateNode,o=i.memoizedProps,u=null,g=zt,g!==null)switch(g.tag){case 27:case 5:u=g.memoizedProps}r[jt]=i,r=!!(r.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||C_(r.nodeValue,o)),r||ds(i,!0)}else r=_u(r).createTextNode(u),r[jt]=i,i.stateNode=r}return ut(i),null;case 31:if(o=i.memoizedState,r===null||r.memoizedState!==null){if(u=Ji(i),o!==null){if(r===null){if(!u)throw Error(s(318));if(r=i.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(557));r[jt]=i}else Js(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;ut(i),r=!1}else o=oh(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=o),r=!0;if(!r)return i.flags&256?(bn(i),i):(bn(i),null);if((i.flags&128)!==0)throw Error(s(558))}return ut(i),null;case 13:if(u=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(g=Ji(i),u!==null&&u.dehydrated!==null){if(r===null){if(!g)throw Error(s(318));if(g=i.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(s(317));g[jt]=i}else Js(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;ut(i),g=!1}else g=oh(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=g),g=!0;if(!g)return i.flags&256?(bn(i),i):(bn(i),null)}return bn(i),(i.flags&128)!==0?(i.lanes=o,i):(o=u!==null,r=r!==null&&r.memoizedState!==null,o&&(u=i.child,g=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(g=u.alternate.memoizedState.cachePool.pool),v=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(v=u.memoizedState.cachePool.pool),v!==g&&(u.flags|=2048)),o!==r&&o&&(i.child.flags|=8192),su(i,i.updateQueue),ut(i),null);case 4:return ie(),r===null&&_m(i.stateNode.containerInfo),ut(i),null;case 10:return Or(i.type),ut(i),null;case 19:if(q(wt),u=i.memoizedState,u===null)return ut(i),null;if(g=(i.flags&128)!==0,v=u.rendering,v===null)if(g)ko(u,!1);else{if(bt!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(v=Vc(r),v!==null){for(i.flags|=128,ko(u,!1),r=v.updateQueue,i.updateQueue=r,su(i,r),i.subtreeFlags=0,r=o,o=i.child;o!==null;)s0(o,r),o=o.sibling;return X(wt,wt.current&1|2),Ge&&Nr(i,u.treeForkCount),i.child}r=r.sibling}u.tail!==null&&dt()>cu&&(i.flags|=128,g=!0,ko(u,!1),i.lanes=4194304)}else{if(!g)if(r=Vc(v),r!==null){if(i.flags|=128,g=!0,r=r.updateQueue,i.updateQueue=r,su(i,r),ko(u,!0),u.tail===null&&u.tailMode==="hidden"&&!v.alternate&&!Ge)return ut(i),null}else 2*dt()-u.renderingStartTime>cu&&o!==536870912&&(i.flags|=128,g=!0,ko(u,!1),i.lanes=4194304);u.isBackwards?(v.sibling=i.child,i.child=v):(r=u.last,r!==null?r.sibling=v:i.child=v,u.last=v)}return u.tail!==null?(r=u.tail,u.rendering=r,u.tail=r.sibling,u.renderingStartTime=dt(),r.sibling=null,o=wt.current,X(wt,g?o&1|2:o&1),Ge&&Nr(i,u.treeForkCount),r):(ut(i),null);case 22:case 23:return bn(i),bh(),u=i.memoizedState!==null,r!==null?r.memoizedState!==null!==u&&(i.flags|=8192):u&&(i.flags|=8192),u?(o&536870912)!==0&&(i.flags&128)===0&&(ut(i),i.subtreeFlags&6&&(i.flags|=8192)):ut(i),o=i.updateQueue,o!==null&&su(i,o.retryQueue),o=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),u=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),u!==o&&(i.flags|=2048),r!==null&&q(ti),null;case 24:return o=null,r!==null&&(o=r.memoizedState.cache),i.memoizedState.cache!==o&&(i.flags|=2048),Or(Et),ut(i),null;case 25:return null;case 30:return null}throw Error(s(156,i.tag))}function GT(r,i){switch(ih(i),i.tag){case 1:return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return Or(Et),ie(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 26:case 27:case 5:return pe(i),null;case 31:if(i.memoizedState!==null){if(bn(i),i.alternate===null)throw Error(s(340));Js()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 13:if(bn(i),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(s(340));Js()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return q(wt),null;case 4:return ie(),null;case 10:return Or(i.type),null;case 22:case 23:return bn(i),bh(),r!==null&&q(ti),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 24:return Or(Et),null;case 25:return null;default:return null}}function jv(r,i){switch(ih(i),i.tag){case 3:Or(Et),ie();break;case 26:case 27:case 5:pe(i);break;case 4:ie();break;case 31:i.memoizedState!==null&&bn(i);break;case 13:bn(i);break;case 19:q(wt);break;case 10:Or(i.type);break;case 22:case 23:bn(i),bh(),r!==null&&q(ti);break;case 24:Or(Et)}}function Mo(r,i){try{var o=i.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var g=u.next;o=g;do{if((o.tag&r)===r){u=void 0;var v=o.create,R=o.inst;u=v(),R.destroy=u}o=o.next}while(o!==g)}}catch(L){tt(i,i.return,L)}}function vs(r,i,o){try{var u=i.updateQueue,g=u!==null?u.lastEffect:null;if(g!==null){var v=g.next;u=v;do{if((u.tag&r)===r){var R=u.inst,L=R.destroy;if(L!==void 0){R.destroy=void 0,g=i;var K=o,ne=L;try{ne()}catch(ue){tt(g,K,ue)}}}u=u.next}while(u!==v)}}catch(ue){tt(i,i.return,ue)}}function Iv(r){var i=r.updateQueue;if(i!==null){var o=r.stateNode;try{x0(i,o)}catch(u){tt(r,r.return,u)}}}function kv(r,i,o){o.props=ai(r.type,r.memoizedProps),o.state=r.memoizedState;try{o.componentWillUnmount()}catch(u){tt(r,i,u)}}function Do(r,i){try{var o=r.ref;if(o!==null){switch(r.tag){case 26:case 27:case 5:var u=r.stateNode;break;case 30:u=r.stateNode;break;default:u=r.stateNode}typeof o=="function"?r.refCleanup=o(u):o.current=u}}catch(g){tt(r,i,g)}}function ur(r,i){var o=r.ref,u=r.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(g){tt(r,i,g)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(g){tt(r,i,g)}else o.current=null}function Mv(r){var i=r.type,o=r.memoizedProps,u=r.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(g){tt(r,r.return,g)}}function Jh(r,i,o){try{var u=r.stateNode;pN(u,r.type,o,i),u[Yt]=i}catch(g){tt(r,r.return,g)}}function Dv(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Ss(r.type)||r.tag===4}function Zh(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Dv(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Ss(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function em(r,i,o){var u=r.tag;if(u===5||u===6)r=r.stateNode,i?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(r,i):(i=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,i.appendChild(r),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=Sr));else if(u!==4&&(u===27&&Ss(r.type)&&(o=r.stateNode,i=null),r=r.child,r!==null))for(em(r,i,o),r=r.sibling;r!==null;)em(r,i,o),r=r.sibling}function iu(r,i,o){var u=r.tag;if(u===5||u===6)r=r.stateNode,i?o.insertBefore(r,i):o.appendChild(r);else if(u!==4&&(u===27&&Ss(r.type)&&(o=r.stateNode),r=r.child,r!==null))for(iu(r,i,o),r=r.sibling;r!==null;)iu(r,i,o),r=r.sibling}function Bv(r){var i=r.stateNode,o=r.memoizedProps;try{for(var u=r.type,g=i.attributes;g.length;)i.removeAttributeNode(g[0]);qt(i,u,o),i[jt]=r,i[Yt]=o}catch(v){tt(r,r.return,v)}}var Dr=!1,Tt=!1,tm=!1,Uv=typeof WeakSet=="function"?WeakSet:Set,Bt=null;function YT(r,i){if(r=r.containerInfo,xm=Cu,r=Xy(r),Yf(r)){if("selectionStart"in r)var o={start:r.selectionStart,end:r.selectionEnd};else e:{o=(o=r.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var g=u.anchorOffset,v=u.focusNode;u=u.focusOffset;try{o.nodeType,v.nodeType}catch{o=null;break e}var R=0,L=-1,K=-1,ne=0,ue=0,me=r,se=null;t:for(;;){for(var le;me!==o||g!==0&&me.nodeType!==3||(L=R+g),me!==v||u!==0&&me.nodeType!==3||(K=R+u),me.nodeType===3&&(R+=me.nodeValue.length),(le=me.firstChild)!==null;)se=me,me=le;for(;;){if(me===r)break t;if(se===o&&++ne===g&&(L=R),se===v&&++ue===u&&(K=R),(le=me.nextSibling)!==null)break;me=se,se=me.parentNode}me=le}o=L===-1||K===-1?null:{start:L,end:K}}else o=null}o=o||{start:0,end:0}}else o=null;for(Am={focusedElem:r,selectionRange:o},Cu=!1,Bt=i;Bt!==null;)if(i=Bt,r=i.child,(i.subtreeFlags&1028)!==0&&r!==null)r.return=i,Bt=r;else for(;Bt!==null;){switch(i=Bt,v=i.alternate,r=i.flags,i.tag){case 0:if((r&4)!==0&&(r=i.updateQueue,r=r!==null?r.events:null,r!==null))for(o=0;o<r.length;o++)g=r[o],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&v!==null){r=void 0,o=i,g=v.memoizedProps,v=v.memoizedState,u=o.stateNode;try{var xe=ai(o.type,g);r=u.getSnapshotBeforeUpdate(xe,v),u.__reactInternalSnapshotBeforeUpdate=r}catch(De){tt(o,o.return,De)}}break;case 3:if((r&1024)!==0){if(r=i.stateNode.containerInfo,o=r.nodeType,o===9)Cm(r);else if(o===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Cm(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(s(163))}if(r=i.sibling,r!==null){r.return=i.return,Bt=r;break}Bt=i.return}}function Lv(r,i,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:Ur(r,o),u&4&&Mo(5,o);break;case 1:if(Ur(r,o),u&4)if(r=o.stateNode,i===null)try{r.componentDidMount()}catch(R){tt(o,o.return,R)}else{var g=ai(o.type,i.memoizedProps);i=i.memoizedState;try{r.componentDidUpdate(g,i,r.__reactInternalSnapshotBeforeUpdate)}catch(R){tt(o,o.return,R)}}u&64&&Iv(o),u&512&&Do(o,o.return);break;case 3:if(Ur(r,o),u&64&&(r=o.updateQueue,r!==null)){if(i=null,o.child!==null)switch(o.child.tag){case 27:case 5:i=o.child.stateNode;break;case 1:i=o.child.stateNode}try{x0(r,i)}catch(R){tt(o,o.return,R)}}break;case 27:i===null&&u&4&&Bv(o);case 26:case 5:Ur(r,o),i===null&&u&4&&Mv(o),u&512&&Do(o,o.return);break;case 12:Ur(r,o);break;case 31:Ur(r,o),u&4&&Pv(r,o);break;case 13:Ur(r,o),u&4&&Hv(r,o),u&64&&(r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(o=rN.bind(null,o),AN(r,o))));break;case 22:if(u=o.memoizedState!==null||Dr,!u){i=i!==null&&i.memoizedState!==null||Tt,g=Dr;var v=Tt;Dr=u,(Tt=i)&&!v?Lr(r,o,(o.subtreeFlags&8772)!==0):Ur(r,o),Dr=g,Tt=v}break;case 30:break;default:Ur(r,o)}}function $v(r){var i=r.alternate;i!==null&&(r.alternate=null,$v(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&ao(i)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var ht=null,an=!1;function Br(r,i,o){for(o=o.child;o!==null;)zv(r,i,o),o=o.sibling}function zv(r,i,o){if($t&&typeof $t.onCommitFiberUnmount=="function")try{$t.onCommitFiberUnmount(Qn,o)}catch{}switch(o.tag){case 26:Tt||ur(o,i),Br(r,i,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Tt||ur(o,i);var u=ht,g=an;Ss(o.type)&&(ht=o.stateNode,an=!1),Br(r,i,o),Qo(o.stateNode),ht=u,an=g;break;case 5:Tt||ur(o,i);case 6:if(u=ht,g=an,ht=null,Br(r,i,o),ht=u,an=g,ht!==null)if(an)try{(ht.nodeType===9?ht.body:ht.nodeName==="HTML"?ht.ownerDocument.body:ht).removeChild(o.stateNode)}catch(v){tt(o,i,v)}else try{ht.removeChild(o.stateNode)}catch(v){tt(o,i,v)}break;case 18:ht!==null&&(an?(r=ht,I_(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,o.stateNode),_a(r)):I_(ht,o.stateNode));break;case 4:u=ht,g=an,ht=o.stateNode.containerInfo,an=!0,Br(r,i,o),ht=u,an=g;break;case 0:case 11:case 14:case 15:vs(2,o,i),Tt||vs(4,o,i),Br(r,i,o);break;case 1:Tt||(ur(o,i),u=o.stateNode,typeof u.componentWillUnmount=="function"&&kv(o,i,u)),Br(r,i,o);break;case 21:Br(r,i,o);break;case 22:Tt=(u=Tt)||o.memoizedState!==null,Br(r,i,o),Tt=u;break;default:Br(r,i,o)}}function Pv(r,i){if(i.memoizedState===null&&(r=i.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{_a(r)}catch(o){tt(i,i.return,o)}}}function Hv(r,i){if(i.memoizedState===null&&(r=i.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{_a(r)}catch(o){tt(i,i.return,o)}}function XT(r){switch(r.tag){case 31:case 13:case 19:var i=r.stateNode;return i===null&&(i=r.stateNode=new Uv),i;case 22:return r=r.stateNode,i=r._retryCache,i===null&&(i=r._retryCache=new Uv),i;default:throw Error(s(435,r.tag))}}function au(r,i){var o=XT(r);i.forEach(function(u){if(!o.has(u)){o.add(u);var g=sN.bind(null,r,u);u.then(g,g)}})}function on(r,i){var o=i.deletions;if(o!==null)for(var u=0;u<o.length;u++){var g=o[u],v=r,R=i,L=R;e:for(;L!==null;){switch(L.tag){case 27:if(Ss(L.type)){ht=L.stateNode,an=!1;break e}break;case 5:ht=L.stateNode,an=!1;break e;case 3:case 4:ht=L.stateNode.containerInfo,an=!0;break e}L=L.return}if(ht===null)throw Error(s(160));zv(v,R,g),ht=null,an=!1,v=g.alternate,v!==null&&(v.return=null),g.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)qv(i,r),i=i.sibling}var Gn=null;function qv(r,i){var o=r.alternate,u=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:on(i,r),ln(r),u&4&&(vs(3,r,r.return),Mo(3,r),vs(5,r,r.return));break;case 1:on(i,r),ln(r),u&512&&(Tt||o===null||ur(o,o.return)),u&64&&Dr&&(r=r.updateQueue,r!==null&&(u=r.callbacks,u!==null&&(o=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var g=Gn;if(on(i,r),ln(r),u&512&&(Tt||o===null||ur(o,o.return)),u&4){var v=o!==null?o.memoizedState:null;if(u=r.memoizedState,o===null)if(u===null)if(r.stateNode===null){e:{u=r.type,o=r.memoizedProps,g=g.ownerDocument||g;t:switch(u){case"title":v=g.getElementsByTagName("title")[0],(!v||v[Fs]||v[jt]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=g.createElement(u),g.head.insertBefore(v,g.querySelector("head > title"))),qt(v,u,o),v[jt]=r,At(v),u=v;break e;case"link":var R=q_("link","href",g).get(u+(o.href||""));if(R){for(var L=0;L<R.length;L++)if(v=R[L],v.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&v.getAttribute("rel")===(o.rel==null?null:o.rel)&&v.getAttribute("title")===(o.title==null?null:o.title)&&v.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){R.splice(L,1);break t}}v=g.createElement(u),qt(v,u,o),g.head.appendChild(v);break;case"meta":if(R=q_("meta","content",g).get(u+(o.content||""))){for(L=0;L<R.length;L++)if(v=R[L],v.getAttribute("content")===(o.content==null?null:""+o.content)&&v.getAttribute("name")===(o.name==null?null:o.name)&&v.getAttribute("property")===(o.property==null?null:o.property)&&v.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&v.getAttribute("charset")===(o.charSet==null?null:o.charSet)){R.splice(L,1);break t}}v=g.createElement(u),qt(v,u,o),g.head.appendChild(v);break;default:throw Error(s(468,u))}v[jt]=r,At(v),u=v}r.stateNode=u}else Q_(g,r.type,r.stateNode);else r.stateNode=H_(g,u,r.memoizedProps);else v!==u?(v===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):v.count--,u===null?Q_(g,r.type,r.stateNode):H_(g,u,r.memoizedProps)):u===null&&r.stateNode!==null&&Jh(r,r.memoizedProps,o.memoizedProps)}break;case 27:on(i,r),ln(r),u&512&&(Tt||o===null||ur(o,o.return)),o!==null&&u&4&&Jh(r,r.memoizedProps,o.memoizedProps);break;case 5:if(on(i,r),ln(r),u&512&&(Tt||o===null||ur(o,o.return)),r.flags&32){g=r.stateNode;try{Hi(g,"")}catch(xe){tt(r,r.return,xe)}}u&4&&r.stateNode!=null&&(g=r.memoizedProps,Jh(r,g,o!==null?o.memoizedProps:g)),u&1024&&(tm=!0);break;case 6:if(on(i,r),ln(r),u&4){if(r.stateNode===null)throw Error(s(162));u=r.memoizedProps,o=r.stateNode;try{o.nodeValue=u}catch(xe){tt(r,r.return,xe)}}break;case 3:if(xu=null,g=Gn,Gn=bu(i.containerInfo),on(i,r),Gn=g,ln(r),u&4&&o!==null&&o.memoizedState.isDehydrated)try{_a(i.containerInfo)}catch(xe){tt(r,r.return,xe)}tm&&(tm=!1,Qv(r));break;case 4:u=Gn,Gn=bu(r.stateNode.containerInfo),on(i,r),ln(r),Gn=u;break;case 12:on(i,r),ln(r);break;case 31:on(i,r),ln(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,au(r,u)));break;case 13:on(i,r),ln(r),r.child.flags&8192&&r.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(lu=dt()),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,au(r,u)));break;case 22:g=r.memoizedState!==null;var K=o!==null&&o.memoizedState!==null,ne=Dr,ue=Tt;if(Dr=ne||g,Tt=ue||K,on(i,r),Tt=ue,Dr=ne,ln(r),u&8192)e:for(i=r.stateNode,i._visibility=g?i._visibility&-2:i._visibility|1,g&&(o===null||K||Dr||Tt||oi(r)),o=null,i=r;;){if(i.tag===5||i.tag===26){if(o===null){K=o=i;try{if(v=K.stateNode,g)R=v.style,typeof R.setProperty=="function"?R.setProperty("display","none","important"):R.display="none";else{L=K.stateNode;var me=K.memoizedProps.style,se=me!=null&&me.hasOwnProperty("display")?me.display:null;L.style.display=se==null||typeof se=="boolean"?"":(""+se).trim()}}catch(xe){tt(K,K.return,xe)}}}else if(i.tag===6){if(o===null){K=i;try{K.stateNode.nodeValue=g?"":K.memoizedProps}catch(xe){tt(K,K.return,xe)}}}else if(i.tag===18){if(o===null){K=i;try{var le=K.stateNode;g?k_(le,!0):k_(K.stateNode,!1)}catch(xe){tt(K,K.return,xe)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===r)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break e;for(;i.sibling===null;){if(i.return===null||i.return===r)break e;o===i&&(o=null),i=i.return}o===i&&(o=null),i.sibling.return=i.return,i=i.sibling}u&4&&(u=r.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,au(r,o))));break;case 19:on(i,r),ln(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,au(r,u)));break;case 30:break;case 21:break;default:on(i,r),ln(r)}}function ln(r){var i=r.flags;if(i&2){try{for(var o,u=r.return;u!==null;){if(Dv(u)){o=u;break}u=u.return}if(o==null)throw Error(s(160));switch(o.tag){case 27:var g=o.stateNode,v=Zh(r);iu(r,v,g);break;case 5:var R=o.stateNode;o.flags&32&&(Hi(R,""),o.flags&=-33);var L=Zh(r);iu(r,L,R);break;case 3:case 4:var K=o.stateNode.containerInfo,ne=Zh(r);em(r,ne,K);break;default:throw Error(s(161))}}catch(ue){tt(r,r.return,ue)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function Qv(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var i=r;Qv(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),r=r.sibling}}function Ur(r,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)Lv(r,i.alternate,i),i=i.sibling}function oi(r){for(r=r.child;r!==null;){var i=r;switch(i.tag){case 0:case 11:case 14:case 15:vs(4,i,i.return),oi(i);break;case 1:ur(i,i.return);var o=i.stateNode;typeof o.componentWillUnmount=="function"&&kv(i,i.return,o),oi(i);break;case 27:Qo(i.stateNode);case 26:case 5:ur(i,i.return),oi(i);break;case 22:i.memoizedState===null&&oi(i);break;case 30:oi(i);break;default:oi(i)}r=r.sibling}}function Lr(r,i,o){for(o=o&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var u=i.alternate,g=r,v=i,R=v.flags;switch(v.tag){case 0:case 11:case 15:Lr(g,v,o),Mo(4,v);break;case 1:if(Lr(g,v,o),u=v,g=u.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(ne){tt(u,u.return,ne)}if(u=v,g=u.updateQueue,g!==null){var L=u.stateNode;try{var K=g.shared.hiddenCallbacks;if(K!==null)for(g.shared.hiddenCallbacks=null,g=0;g<K.length;g++)w0(K[g],L)}catch(ne){tt(u,u.return,ne)}}o&&R&64&&Iv(v),Do(v,v.return);break;case 27:Bv(v);case 26:case 5:Lr(g,v,o),o&&u===null&&R&4&&Mv(v),Do(v,v.return);break;case 12:Lr(g,v,o);break;case 31:Lr(g,v,o),o&&R&4&&Pv(g,v);break;case 13:Lr(g,v,o),o&&R&4&&Hv(g,v);break;case 22:v.memoizedState===null&&Lr(g,v,o),Do(v,v.return);break;case 30:break;default:Lr(g,v,o)}i=i.sibling}}function nm(r,i){var o=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),r=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(r=i.memoizedState.cachePool.pool),r!==o&&(r!=null&&r.refCount++,o!=null&&wo(o))}function rm(r,i){r=null,i.alternate!==null&&(r=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==r&&(i.refCount++,r!=null&&wo(r))}function Yn(r,i,o,u){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Vv(r,i,o,u),i=i.sibling}function Vv(r,i,o,u){var g=i.flags;switch(i.tag){case 0:case 11:case 15:Yn(r,i,o,u),g&2048&&Mo(9,i);break;case 1:Yn(r,i,o,u);break;case 3:Yn(r,i,o,u),g&2048&&(r=null,i.alternate!==null&&(r=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==r&&(i.refCount++,r!=null&&wo(r)));break;case 12:if(g&2048){Yn(r,i,o,u),r=i.stateNode;try{var v=i.memoizedProps,R=v.id,L=v.onPostCommit;typeof L=="function"&&L(R,i.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(K){tt(i,i.return,K)}}else Yn(r,i,o,u);break;case 31:Yn(r,i,o,u);break;case 13:Yn(r,i,o,u);break;case 23:break;case 22:v=i.stateNode,R=i.alternate,i.memoizedState!==null?v._visibility&2?Yn(r,i,o,u):Bo(r,i):v._visibility&2?Yn(r,i,o,u):(v._visibility|=2,la(r,i,o,u,(i.subtreeFlags&10256)!==0||!1)),g&2048&&nm(R,i);break;case 24:Yn(r,i,o,u),g&2048&&rm(i.alternate,i);break;default:Yn(r,i,o,u)}}function la(r,i,o,u,g){for(g=g&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var v=r,R=i,L=o,K=u,ne=R.flags;switch(R.tag){case 0:case 11:case 15:la(v,R,L,K,g),Mo(8,R);break;case 23:break;case 22:var ue=R.stateNode;R.memoizedState!==null?ue._visibility&2?la(v,R,L,K,g):Bo(v,R):(ue._visibility|=2,la(v,R,L,K,g)),g&&ne&2048&&nm(R.alternate,R);break;case 24:la(v,R,L,K,g),g&&ne&2048&&rm(R.alternate,R);break;default:la(v,R,L,K,g)}i=i.sibling}}function Bo(r,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var o=r,u=i,g=u.flags;switch(u.tag){case 22:Bo(o,u),g&2048&&nm(u.alternate,u);break;case 24:Bo(o,u),g&2048&&rm(u.alternate,u);break;default:Bo(o,u)}i=i.sibling}}var Uo=8192;function ca(r,i,o){if(r.subtreeFlags&Uo)for(r=r.child;r!==null;)Fv(r,i,o),r=r.sibling}function Fv(r,i,o){switch(r.tag){case 26:ca(r,i,o),r.flags&Uo&&r.memoizedState!==null&&DN(o,Gn,r.memoizedState,r.memoizedProps);break;case 5:ca(r,i,o);break;case 3:case 4:var u=Gn;Gn=bu(r.stateNode.containerInfo),ca(r,i,o),Gn=u;break;case 22:r.memoizedState===null&&(u=r.alternate,u!==null&&u.memoizedState!==null?(u=Uo,Uo=16777216,ca(r,i,o),Uo=u):ca(r,i,o));break;default:ca(r,i,o)}}function Gv(r){var i=r.alternate;if(i!==null&&(r=i.child,r!==null)){i.child=null;do i=r.sibling,r.sibling=null,r=i;while(r!==null)}}function Lo(r){var i=r.deletions;if((r.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var u=i[o];Bt=u,Xv(u,r)}Gv(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Yv(r),r=r.sibling}function Yv(r){switch(r.tag){case 0:case 11:case 15:Lo(r),r.flags&2048&&vs(9,r,r.return);break;case 3:Lo(r);break;case 12:Lo(r);break;case 22:var i=r.stateNode;r.memoizedState!==null&&i._visibility&2&&(r.return===null||r.return.tag!==13)?(i._visibility&=-3,ou(r)):Lo(r);break;default:Lo(r)}}function ou(r){var i=r.deletions;if((r.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var u=i[o];Bt=u,Xv(u,r)}Gv(r)}for(r=r.child;r!==null;){switch(i=r,i.tag){case 0:case 11:case 15:vs(8,i,i.return),ou(i);break;case 22:o=i.stateNode,o._visibility&2&&(o._visibility&=-3,ou(i));break;default:ou(i)}r=r.sibling}}function Xv(r,i){for(;Bt!==null;){var o=Bt;switch(o.tag){case 0:case 11:case 15:vs(8,o,i);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:wo(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,Bt=u;else e:for(o=r;Bt!==null;){u=Bt;var g=u.sibling,v=u.return;if($v(u),u===o){Bt=null;break e}if(g!==null){g.return=v,Bt=g;break e}Bt=v}}}var KT={getCacheForType:function(r){var i=Pt(Et),o=i.data.get(r);return o===void 0&&(o=r(),i.data.set(r,o)),o},cacheSignal:function(){return Pt(Et).controller.signal}},WT=typeof WeakMap=="function"?WeakMap:Map,Ze=0,at=null,He=null,Qe=0,et=0,wn=null,_s=!1,ua=!1,sm=!1,$r=0,bt=0,bs=0,li=0,im=0,xn=0,da=0,$o=null,cn=null,am=!1,lu=0,Kv=0,cu=1/0,uu=null,ws=null,It=0,xs=null,fa=null,zr=0,om=0,lm=null,Wv=null,zo=0,cm=null;function An(){return(Ze&2)!==0&&Qe!==0?Qe&-Qe:N.T!==null?pm():mc()}function Jv(){if(xn===0)if((Qe&536870912)===0||Ge){var r=ns;ns<<=1,(ns&3932160)===0&&(ns=262144),xn=r}else xn=536870912;return r=_n.current,r!==null&&(r.flags|=32),xn}function un(r,i,o){(r===at&&(et===2||et===9)||r.cancelPendingCommit!==null)&&(ha(r,0),As(r,Qe,xn,!1)),Vs(r,o),((Ze&2)===0||r!==at)&&(r===at&&((Ze&2)===0&&(li|=o),bt===4&&As(r,Qe,xn,!1)),dr(r))}function Zv(r,i,o){if((Ze&6)!==0)throw Error(s(327));var u=!o&&(i&127)===0&&(i&r.expiredLanes)===0||Qs(r,i),g=u?eN(r,i):dm(r,i,!0),v=u;do{if(g===0){ua&&!u&&As(r,i,0,!1);break}else{if(o=r.current.alternate,v&&!JT(o)){g=dm(r,i,!1),v=!1;continue}if(g===2){if(v=i,r.errorRecoveryDisabledLanes&v)var R=0;else R=r.pendingLanes&-536870913,R=R!==0?R:R&536870912?536870912:0;if(R!==0){i=R;e:{var L=r;g=$o;var K=L.current.memoizedState.isDehydrated;if(K&&(ha(L,R).flags|=256),R=dm(L,R,!1),R!==2){if(sm&&!K){L.errorRecoveryDisabledLanes|=v,li|=v,g=4;break e}v=cn,cn=g,v!==null&&(cn===null?cn=v:cn.push.apply(cn,v))}g=R}if(v=!1,g!==2)continue}}if(g===1){ha(r,0),As(r,i,0,!0);break}e:{switch(u=r,v=g,v){case 0:case 1:throw Error(s(345));case 4:if((i&4194048)!==i)break;case 6:As(u,i,xn,!_s);break e;case 2:cn=null;break;case 3:case 5:break;default:throw Error(s(329))}if((i&62914560)===i&&(g=lu+300-dt(),10<g)){if(As(u,i,xn,!_s),Mi(u,0,!0)!==0)break e;zr=i,u.timeoutHandle=O_(e_.bind(null,u,o,cn,uu,am,i,xn,li,da,_s,v,"Throttled",-0,0),g);break e}e_(u,o,cn,uu,am,i,xn,li,da,_s,v,null,-0,0)}}break}while(!0);dr(r)}function e_(r,i,o,u,g,v,R,L,K,ne,ue,me,se,le){if(r.timeoutHandle=-1,me=i.subtreeFlags,me&8192||(me&16785408)===16785408){me={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Sr},Fv(i,v,me);var xe=(v&62914560)===v?lu-dt():(v&4194048)===v?Kv-dt():0;if(xe=BN(me,xe),xe!==null){zr=v,r.cancelPendingCommit=xe(l_.bind(null,r,i,v,o,u,g,R,L,K,ue,me,null,se,le)),As(r,v,R,!ne);return}}l_(r,i,v,o,u,g,R,L,K)}function JT(r){for(var i=r;;){var o=i.tag;if((o===0||o===11||o===15)&&i.flags&16384&&(o=i.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var g=o[u],v=g.getSnapshot;g=g.value;try{if(!yn(v(),g))return!1}catch{return!1}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function As(r,i,o,u){i&=~im,i&=~li,r.suspendedLanes|=i,r.pingedLanes&=~i,u&&(r.warmLanes|=i),u=r.expirationTimes;for(var g=i;0<g;){var v=31-Ee(g),R=1<<v;u[v]=-1,g&=~R}o!==0&&dc(r,o,i)}function du(){return(Ze&6)===0?(Po(0),!1):!0}function um(){if(He!==null){if(et===0)var r=He.return;else r=He,Rr=Zs=null,Ch(r),ra=null,Ao=0,r=He;for(;r!==null;)jv(r.alternate,r),r=r.return;He=null}}function ha(r,i){var o=r.timeoutHandle;o!==-1&&(r.timeoutHandle=-1,vN(o)),o=r.cancelPendingCommit,o!==null&&(r.cancelPendingCommit=null,o()),zr=0,um(),at=r,He=o=Tr(r.current,null),Qe=i,et=0,wn=null,_s=!1,ua=Qs(r,i),sm=!1,da=xn=im=li=bs=bt=0,cn=$o=null,am=!1,(i&8)!==0&&(i|=i&32);var u=r.entangledLanes;if(u!==0)for(r=r.entanglements,u&=i;0<u;){var g=31-Ee(u),v=1<<g;i|=r[g],u&=~v}return $r=i,Ic(),o}function t_(r,i){$e=null,N.H=jo,i===na||i===zc?(i=y0(),et=3):i===mh?(i=y0(),et=4):et=i===Hh?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,wn=i,He===null&&(bt=1,eu(r,Mn(i,r.current)))}function n_(){var r=_n.current;return r===null?!0:(Qe&4194048)===Qe?Ln===null:(Qe&62914560)===Qe||(Qe&536870912)!==0?r===Ln:!1}function r_(){var r=N.H;return N.H=jo,r===null?jo:r}function s_(){var r=N.A;return N.A=KT,r}function fu(){bt=4,_s||(Qe&4194048)!==Qe&&_n.current!==null||(ua=!0),(bs&134217727)===0&&(li&134217727)===0||at===null||As(at,Qe,xn,!1)}function dm(r,i,o){var u=Ze;Ze|=2;var g=r_(),v=s_();(at!==r||Qe!==i)&&(uu=null,ha(r,i)),i=!1;var R=bt;e:do try{if(et!==0&&He!==null){var L=He,K=wn;switch(et){case 8:um(),R=6;break e;case 3:case 2:case 9:case 6:_n.current===null&&(i=!0);var ne=et;if(et=0,wn=null,ma(r,L,K,ne),o&&ua){R=0;break e}break;default:ne=et,et=0,wn=null,ma(r,L,K,ne)}}ZT(),R=bt;break}catch(ue){t_(r,ue)}while(!0);return i&&r.shellSuspendCounter++,Rr=Zs=null,Ze=u,N.H=g,N.A=v,He===null&&(at=null,Qe=0,Ic()),R}function ZT(){for(;He!==null;)i_(He)}function eN(r,i){var o=Ze;Ze|=2;var u=r_(),g=s_();at!==r||Qe!==i?(uu=null,cu=dt()+500,ha(r,i)):ua=Qs(r,i);e:do try{if(et!==0&&He!==null){i=He;var v=wn;t:switch(et){case 1:et=0,wn=null,ma(r,i,v,1);break;case 2:case 9:if(p0(v)){et=0,wn=null,a_(i);break}i=function(){et!==2&&et!==9||at!==r||(et=7),dr(r)},v.then(i,i);break e;case 3:et=7;break e;case 4:et=5;break e;case 7:p0(v)?(et=0,wn=null,a_(i)):(et=0,wn=null,ma(r,i,v,7));break;case 5:var R=null;switch(He.tag){case 26:R=He.memoizedState;case 5:case 27:var L=He;if(R?V_(R):L.stateNode.complete){et=0,wn=null;var K=L.sibling;if(K!==null)He=K;else{var ne=L.return;ne!==null?(He=ne,hu(ne)):He=null}break t}}et=0,wn=null,ma(r,i,v,5);break;case 6:et=0,wn=null,ma(r,i,v,6);break;case 8:um(),bt=6;break e;default:throw Error(s(462))}}tN();break}catch(ue){t_(r,ue)}while(!0);return Rr=Zs=null,N.H=u,N.A=g,Ze=o,He!==null?0:(at=null,Qe=0,Ic(),bt)}function tN(){for(;He!==null&&!mn();)i_(He)}function i_(r){var i=Rv(r.alternate,r,$r);r.memoizedProps=r.pendingProps,i===null?hu(r):He=i}function a_(r){var i=r,o=i.alternate;switch(i.tag){case 15:case 0:i=Av(o,i,i.pendingProps,i.type,void 0,Qe);break;case 11:i=Av(o,i,i.pendingProps,i.type.render,i.ref,Qe);break;case 5:Ch(i);default:jv(o,i),i=He=s0(i,$r),i=Rv(o,i,$r)}r.memoizedProps=r.pendingProps,i===null?hu(r):He=i}function ma(r,i,o,u){Rr=Zs=null,Ch(i),ra=null,Ao=0;var g=i.return;try{if(qT(r,g,i,o,Qe)){bt=1,eu(r,Mn(o,r.current)),He=null;return}}catch(v){if(g!==null)throw He=g,v;bt=1,eu(r,Mn(o,r.current)),He=null;return}i.flags&32768?(Ge||u===1?r=!0:ua||(Qe&536870912)!==0?r=!1:(_s=r=!0,(u===2||u===9||u===3||u===6)&&(u=_n.current,u!==null&&u.tag===13&&(u.flags|=16384))),o_(i,r)):hu(i)}function hu(r){var i=r;do{if((i.flags&32768)!==0){o_(i,_s);return}r=i.return;var o=FT(i.alternate,i,$r);if(o!==null){He=o;return}if(i=i.sibling,i!==null){He=i;return}He=i=r}while(i!==null);bt===0&&(bt=5)}function o_(r,i){do{var o=GT(r.alternate,r);if(o!==null){o.flags&=32767,He=o;return}if(o=r.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!i&&(r=r.sibling,r!==null)){He=r;return}He=r=o}while(r!==null);bt=6,He=null}function l_(r,i,o,u,g,v,R,L,K){r.cancelPendingCommit=null;do mu();while(It!==0);if((Ze&6)!==0)throw Error(s(327));if(i!==null){if(i===r.current)throw Error(s(177));if(v=i.lanes|i.childLanes,v|=Zf,Rf(r,o,v,R,L,K),r===at&&(He=at=null,Qe=0),fa=i,xs=r,zr=o,om=v,lm=g,Wv=u,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,iN(gn,function(){return h_(),null})):(r.callbackNode=null,r.callbackPriority=0),u=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||u){u=N.T,N.T=null,g=B.p,B.p=2,R=Ze,Ze|=4;try{YT(r,i,o)}finally{Ze=R,B.p=g,N.T=u}}It=1,c_(),u_(),d_()}}function c_(){if(It===1){It=0;var r=xs,i=fa,o=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||o){o=N.T,N.T=null;var u=B.p;B.p=2;var g=Ze;Ze|=4;try{qv(i,r);var v=Am,R=Xy(r.containerInfo),L=v.focusedElem,K=v.selectionRange;if(R!==L&&L&&L.ownerDocument&&Yy(L.ownerDocument.documentElement,L)){if(K!==null&&Yf(L)){var ne=K.start,ue=K.end;if(ue===void 0&&(ue=ne),"selectionStart"in L)L.selectionStart=ne,L.selectionEnd=Math.min(ue,L.value.length);else{var me=L.ownerDocument||document,se=me&&me.defaultView||window;if(se.getSelection){var le=se.getSelection(),xe=L.textContent.length,De=Math.min(K.start,xe),st=K.end===void 0?De:Math.min(K.end,xe);!le.extend&&De>st&&(R=st,st=De,De=R);var ee=Gy(L,De),W=Gy(L,st);if(ee&&W&&(le.rangeCount!==1||le.anchorNode!==ee.node||le.anchorOffset!==ee.offset||le.focusNode!==W.node||le.focusOffset!==W.offset)){var te=me.createRange();te.setStart(ee.node,ee.offset),le.removeAllRanges(),De>st?(le.addRange(te),le.extend(W.node,W.offset)):(te.setEnd(W.node,W.offset),le.addRange(te))}}}}for(me=[],le=L;le=le.parentNode;)le.nodeType===1&&me.push({element:le,left:le.scrollLeft,top:le.scrollTop});for(typeof L.focus=="function"&&L.focus(),L=0;L<me.length;L++){var he=me[L];he.element.scrollLeft=he.left,he.element.scrollTop=he.top}}Cu=!!xm,Am=xm=null}finally{Ze=g,B.p=u,N.T=o}}r.current=i,It=2}}function u_(){if(It===2){It=0;var r=xs,i=fa,o=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||o){o=N.T,N.T=null;var u=B.p;B.p=2;var g=Ze;Ze|=4;try{Lv(r,i.alternate,i)}finally{Ze=g,B.p=u,N.T=o}}It=3}}function d_(){if(It===4||It===3){It=0,Zt();var r=xs,i=fa,o=zr,u=Wv;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?It=5:(It=0,fa=xs=null,f_(r,r.pendingLanes));var g=r.pendingLanes;if(g===0&&(ws=null),io(o),i=i.stateNode,$t&&typeof $t.onCommitFiberRoot=="function")try{$t.onCommitFiberRoot(Qn,i,void 0,(i.current.flags&128)===128)}catch{}if(u!==null){i=N.T,g=B.p,B.p=2,N.T=null;try{for(var v=r.onRecoverableError,R=0;R<u.length;R++){var L=u[R];v(L.value,{componentStack:L.stack})}}finally{N.T=i,B.p=g}}(zr&3)!==0&&mu(),dr(r),g=r.pendingLanes,(o&261930)!==0&&(g&42)!==0?r===cm?zo++:(zo=0,cm=r):zo=0,Po(0)}}function f_(r,i){(r.pooledCacheLanes&=i)===0&&(i=r.pooledCache,i!=null&&(r.pooledCache=null,wo(i)))}function mu(){return c_(),u_(),d_(),h_()}function h_(){if(It!==5)return!1;var r=xs,i=om;om=0;var o=io(zr),u=N.T,g=B.p;try{B.p=32>o?32:o,N.T=null,o=lm,lm=null;var v=xs,R=zr;if(It=0,fa=xs=null,zr=0,(Ze&6)!==0)throw Error(s(331));var L=Ze;if(Ze|=4,Yv(v.current),Vv(v,v.current,R,o),Ze=L,Po(0,!1),$t&&typeof $t.onPostCommitFiberRoot=="function")try{$t.onPostCommitFiberRoot(Qn,v)}catch{}return!0}finally{B.p=g,N.T=u,f_(r,i)}}function m_(r,i,o){i=Mn(o,i),i=Ph(r.stateNode,i,2),r=ps(r,i,2),r!==null&&(Vs(r,2),dr(r))}function tt(r,i,o){if(r.tag===3)m_(r,r,o);else for(;i!==null;){if(i.tag===3){m_(i,r,o);break}else if(i.tag===1){var u=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(ws===null||!ws.has(u))){r=Mn(o,r),o=pv(2),u=ps(i,o,2),u!==null&&(gv(o,u,i,r),Vs(u,2),dr(u));break}}i=i.return}}function fm(r,i,o){var u=r.pingCache;if(u===null){u=r.pingCache=new WT;var g=new Set;u.set(i,g)}else g=u.get(i),g===void 0&&(g=new Set,u.set(i,g));g.has(o)||(sm=!0,g.add(o),r=nN.bind(null,r,i,o),i.then(r,r))}function nN(r,i,o){var u=r.pingCache;u!==null&&u.delete(i),r.pingedLanes|=r.suspendedLanes&o,r.warmLanes&=~o,at===r&&(Qe&o)===o&&(bt===4||bt===3&&(Qe&62914560)===Qe&&300>dt()-lu?(Ze&2)===0&&ha(r,0):im|=o,da===Qe&&(da=0)),dr(r)}function p_(r,i){i===0&&(i=uc()),r=Ks(r,i),r!==null&&(Vs(r,i),dr(r))}function rN(r){var i=r.memoizedState,o=0;i!==null&&(o=i.retryLane),p_(r,o)}function sN(r,i){var o=0;switch(r.tag){case 31:case 13:var u=r.stateNode,g=r.memoizedState;g!==null&&(o=g.retryLane);break;case 19:u=r.stateNode;break;case 22:u=r.stateNode._retryCache;break;default:throw Error(s(314))}u!==null&&u.delete(i),p_(r,o)}function iN(r,i){return pt(r,i)}var pu=null,pa=null,hm=!1,gu=!1,mm=!1,Es=0;function dr(r){r!==pa&&r.next===null&&(pa===null?pu=pa=r:pa=pa.next=r),gu=!0,hm||(hm=!0,oN())}function Po(r,i){if(!mm&&gu){mm=!0;do for(var o=!1,u=pu;u!==null;){if(r!==0){var g=u.pendingLanes;if(g===0)var v=0;else{var R=u.suspendedLanes,L=u.pingedLanes;v=(1<<31-Ee(42|r)+1)-1,v&=g&~(R&~L),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(o=!0,__(u,v))}else v=Qe,v=Mi(u,u===at?v:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(v&3)===0||Qs(u,v)||(o=!0,__(u,v));u=u.next}while(o);mm=!1}}function aN(){g_()}function g_(){gu=hm=!1;var r=0;Es!==0&&yN()&&(r=Es);for(var i=dt(),o=null,u=pu;u!==null;){var g=u.next,v=y_(u,i);v===0?(u.next=null,o===null?pu=g:o.next=g,g===null&&(pa=o)):(o=u,(r!==0||(v&3)!==0)&&(gu=!0)),u=g}It!==0&&It!==5||Po(r),Es!==0&&(Es=0)}function y_(r,i){for(var o=r.suspendedLanes,u=r.pingedLanes,g=r.expirationTimes,v=r.pendingLanes&-62914561;0<v;){var R=31-Ee(v),L=1<<R,K=g[R];K===-1?((L&o)===0||(L&u)!==0)&&(g[R]=Nf(L,i)):K<=i&&(r.expiredLanes|=L),v&=~L}if(i=at,o=Qe,o=Mi(r,r===i?o:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u=r.callbackNode,o===0||r===i&&(et===2||et===9)||r.cancelPendingCommit!==null)return u!==null&&u!==null&&it(u),r.callbackNode=null,r.callbackPriority=0;if((o&3)===0||Qs(r,o)){if(i=o&-o,i===r.callbackPriority)return i;switch(u!==null&&it(u),io(o)){case 2:case 8:o=nn;break;case 32:o=gn;break;case 268435456:o=ts;break;default:o=gn}return u=v_.bind(null,r),o=pt(o,u),r.callbackPriority=i,r.callbackNode=o,i}return u!==null&&u!==null&&it(u),r.callbackPriority=2,r.callbackNode=null,2}function v_(r,i){if(It!==0&&It!==5)return r.callbackNode=null,r.callbackPriority=0,null;var o=r.callbackNode;if(mu()&&r.callbackNode!==o)return null;var u=Qe;return u=Mi(r,r===at?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u===0?null:(Zv(r,u,i),y_(r,dt()),r.callbackNode!=null&&r.callbackNode===o?v_.bind(null,r):null)}function __(r,i){if(mu())return null;Zv(r,i,!0)}function oN(){_N(function(){(Ze&6)!==0?pt(In,aN):g_()})}function pm(){if(Es===0){var r=ea;r===0&&(r=ft,ft<<=1,(ft&261888)===0&&(ft=256)),Es=r}return Es}function b_(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Ec(""+r)}function w_(r,i){var o=i.ownerDocument.createElement("input");return o.name=i.name,o.value=i.value,r.id&&o.setAttribute("form",r.id),i.parentNode.insertBefore(o,i),r=new FormData(r),o.parentNode.removeChild(o),r}function lN(r,i,o,u,g){if(i==="submit"&&o&&o.stateNode===g){var v=b_((g[Yt]||null).action),R=u.submitter;R&&(i=(i=R[Yt]||null)?b_(i.formAction):R.getAttribute("formAction"),i!==null&&(v=i,R=null));var L=new Nc("action","action",null,u,g);r.push({event:L,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Es!==0){var K=R?w_(g,R):new FormData(g);Dh(o,{pending:!0,data:K,method:g.method,action:v},null,K)}}else typeof v=="function"&&(L.preventDefault(),K=R?w_(g,R):new FormData(g),Dh(o,{pending:!0,data:K,method:g.method,action:v},v,K))},currentTarget:g}]})}}for(var gm=0;gm<Jf.length;gm++){var ym=Jf[gm],cN=ym.toLowerCase(),uN=ym[0].toUpperCase()+ym.slice(1);Fn(cN,"on"+uN)}Fn(Jy,"onAnimationEnd"),Fn(Zy,"onAnimationIteration"),Fn(e0,"onAnimationStart"),Fn("dblclick","onDoubleClick"),Fn("focusin","onFocus"),Fn("focusout","onBlur"),Fn(CT,"onTransitionRun"),Fn(TT,"onTransitionStart"),Fn(NT,"onTransitionCancel"),Fn(t0,"onTransitionEnd"),os("onMouseEnter",["mouseout","mouseover"]),os("onMouseLeave",["mouseout","mouseover"]),os("onPointerEnter",["pointerout","pointerover"]),os("onPointerLeave",["pointerout","pointerover"]),Er("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Er("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Er("onBeforeInput",["compositionend","keypress","textInput","paste"]),Er("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Er("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Er("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ho="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dN=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ho));function x_(r,i){i=(i&4)!==0;for(var o=0;o<r.length;o++){var u=r[o],g=u.event;u=u.listeners;e:{var v=void 0;if(i)for(var R=u.length-1;0<=R;R--){var L=u[R],K=L.instance,ne=L.currentTarget;if(L=L.listener,K!==v&&g.isPropagationStopped())break e;v=L,g.currentTarget=ne;try{v(g)}catch(ue){jc(ue)}g.currentTarget=null,v=K}else for(R=0;R<u.length;R++){if(L=u[R],K=L.instance,ne=L.currentTarget,L=L.listener,K!==v&&g.isPropagationStopped())break e;v=L,g.currentTarget=ne;try{v(g)}catch(ue){jc(ue)}g.currentTarget=null,v=K}}}}function qe(r,i){var o=i[Di];o===void 0&&(o=i[Di]=new Set);var u=r+"__bubble";o.has(u)||(A_(i,r,2,!1),o.add(u))}function vm(r,i,o){var u=0;i&&(u|=4),A_(o,r,u,i)}var yu="_reactListening"+Math.random().toString(36).slice(2);function _m(r){if(!r[yu]){r[yu]=!0,vc.forEach(function(o){o!=="selectionchange"&&(dN.has(o)||vm(o,!1,r),vm(o,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[yu]||(i[yu]=!0,vm("selectionchange",!1,i))}}function A_(r,i,o,u){switch(J_(i)){case 2:var g=$N;break;case 8:g=zN;break;default:g=Mm}o=g.bind(null,i,o,r),g=void 0,!$f||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(g=!0),u?g!==void 0?r.addEventListener(i,o,{capture:!0,passive:g}):r.addEventListener(i,o,!0):g!==void 0?r.addEventListener(i,o,{passive:g}):r.addEventListener(i,o,!1)}function bm(r,i,o,u,g){var v=u;if((i&1)===0&&(i&2)===0&&u!==null)e:for(;;){if(u===null)return;var R=u.tag;if(R===3||R===4){var L=u.stateNode.containerInfo;if(L===g)break;if(R===4)for(R=u.return;R!==null;){var K=R.tag;if((K===3||K===4)&&R.stateNode.containerInfo===g)return;R=R.return}for(;L!==null;){if(R=rs(L),R===null)return;if(K=R.tag,K===5||K===6||K===26||K===27){u=v=R;continue e}L=L.parentNode}}u=u.return}Ny(function(){var ne=v,ue=Uf(o),me=[];e:{var se=n0.get(r);if(se!==void 0){var le=Nc,xe=r;switch(r){case"keypress":if(Cc(o)===0)break e;case"keydown":case"keyup":le=sT;break;case"focusin":xe="focus",le=qf;break;case"focusout":xe="blur",le=qf;break;case"beforeblur":case"afterblur":le=qf;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":le=jy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":le=FC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":le=oT;break;case Jy:case Zy:case e0:le=XC;break;case t0:le=cT;break;case"scroll":case"scrollend":le=QC;break;case"wheel":le=dT;break;case"copy":case"cut":case"paste":le=WC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":le=ky;break;case"toggle":case"beforetoggle":le=hT}var De=(i&4)!==0,st=!De&&(r==="scroll"||r==="scrollend"),ee=De?se!==null?se+"Capture":null:se;De=[];for(var W=ne,te;W!==null;){var he=W;if(te=he.stateNode,he=he.tag,he!==5&&he!==26&&he!==27||te===null||ee===null||(he=co(W,ee),he!=null&&De.push(qo(W,he,te))),st)break;W=W.return}0<De.length&&(se=new le(se,xe,null,o,ue),me.push({event:se,listeners:De}))}}if((i&7)===0){e:{if(se=r==="mouseover"||r==="pointerover",le=r==="mouseout"||r==="pointerout",se&&o!==Bf&&(xe=o.relatedTarget||o.fromElement)&&(rs(xe)||xe[Ar]))break e;if((le||se)&&(se=ue.window===ue?ue:(se=ue.ownerDocument)?se.defaultView||se.parentWindow:window,le?(xe=o.relatedTarget||o.toElement,le=ne,xe=xe?rs(xe):null,xe!==null&&(st=l(xe),De=xe.tag,xe!==st||De!==5&&De!==27&&De!==6)&&(xe=null)):(le=null,xe=ne),le!==xe)){if(De=jy,he="onMouseLeave",ee="onMouseEnter",W="mouse",(r==="pointerout"||r==="pointerover")&&(De=ky,he="onPointerLeave",ee="onPointerEnter",W="pointer"),st=le==null?se:is(le),te=xe==null?se:is(xe),se=new De(he,W+"leave",le,o,ue),se.target=st,se.relatedTarget=te,he=null,rs(ue)===ne&&(De=new De(ee,W+"enter",xe,o,ue),De.target=te,De.relatedTarget=st,he=De),st=he,le&&xe)t:{for(De=fN,ee=le,W=xe,te=0,he=ee;he;he=De(he))te++;he=0;for(var Oe=W;Oe;Oe=De(Oe))he++;for(;0<te-he;)ee=De(ee),te--;for(;0<he-te;)W=De(W),he--;for(;te--;){if(ee===W||W!==null&&ee===W.alternate){De=ee;break t}ee=De(ee),W=De(W)}De=null}else De=null;le!==null&&E_(me,se,le,De,!1),xe!==null&&st!==null&&E_(me,st,xe,De,!0)}}e:{if(se=ne?is(ne):window,le=se.nodeName&&se.nodeName.toLowerCase(),le==="select"||le==="input"&&se.type==="file")var Ke=Py;else if($y(se))if(Hy)Ke=AT;else{Ke=wT;var Se=bT}else le=se.nodeName,!le||le.toLowerCase()!=="input"||se.type!=="checkbox"&&se.type!=="radio"?ne&&Df(ne.elementType)&&(Ke=Py):Ke=xT;if(Ke&&(Ke=Ke(r,ne))){zy(me,Ke,o,ue);break e}Se&&Se(r,se,ne),r==="focusout"&&ne&&se.type==="number"&&ne.memoizedProps.value!=null&&zi(se,"number",se.value)}switch(Se=ne?is(ne):window,r){case"focusin":($y(Se)||Se.contentEditable==="true")&&(Fi=Se,Xf=ne,vo=null);break;case"focusout":vo=Xf=Fi=null;break;case"mousedown":Kf=!0;break;case"contextmenu":case"mouseup":case"dragend":Kf=!1,Ky(me,o,ue);break;case"selectionchange":if(ST)break;case"keydown":case"keyup":Ky(me,o,ue)}var ze;if(Vf)e:{switch(r){case"compositionstart":var Ve="onCompositionStart";break e;case"compositionend":Ve="onCompositionEnd";break e;case"compositionupdate":Ve="onCompositionUpdate";break e}Ve=void 0}else Vi?Uy(r,o)&&(Ve="onCompositionEnd"):r==="keydown"&&o.keyCode===229&&(Ve="onCompositionStart");Ve&&(My&&o.locale!=="ko"&&(Vi||Ve!=="onCompositionStart"?Ve==="onCompositionEnd"&&Vi&&(ze=Ry()):(ls=ue,zf="value"in ls?ls.value:ls.textContent,Vi=!0)),Se=vu(ne,Ve),0<Se.length&&(Ve=new Iy(Ve,r,null,o,ue),me.push({event:Ve,listeners:Se}),ze?Ve.data=ze:(ze=Ly(o),ze!==null&&(Ve.data=ze)))),(ze=pT?gT(r,o):yT(r,o))&&(Ve=vu(ne,"onBeforeInput"),0<Ve.length&&(Se=new Iy("onBeforeInput","beforeinput",null,o,ue),me.push({event:Se,listeners:Ve}),Se.data=ze)),lN(me,r,ne,o,ue)}x_(me,i)})}function qo(r,i,o){return{instance:r,listener:i,currentTarget:o}}function vu(r,i){for(var o=i+"Capture",u=[];r!==null;){var g=r,v=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||v===null||(g=co(r,o),g!=null&&u.unshift(qo(r,g,v)),g=co(r,i),g!=null&&u.push(qo(r,g,v))),r.tag===3)return u;r=r.return}return[]}function fN(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function E_(r,i,o,u,g){for(var v=i._reactName,R=[];o!==null&&o!==u;){var L=o,K=L.alternate,ne=L.stateNode;if(L=L.tag,K!==null&&K===u)break;L!==5&&L!==26&&L!==27||ne===null||(K=ne,g?(ne=co(o,v),ne!=null&&R.unshift(qo(o,ne,K))):g||(ne=co(o,v),ne!=null&&R.push(qo(o,ne,K)))),o=o.return}R.length!==0&&r.push({event:i,listeners:R})}var hN=/\r\n?/g,mN=/\u0000|\uFFFD/g;function S_(r){return(typeof r=="string"?r:""+r).replace(hN,`
`).replace(mN,"")}function C_(r,i){return i=S_(i),S_(r)===i}function rt(r,i,o,u,g,v){switch(o){case"children":typeof u=="string"?i==="body"||i==="textarea"&&u===""||Hi(r,u):(typeof u=="number"||typeof u=="bigint")&&i!=="body"&&Hi(r,""+u);break;case"className":Ui(r,"class",u);break;case"tabIndex":Ui(r,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Ui(r,o,u);break;case"style":Cy(r,u,v);break;case"data":if(i!=="object"){Ui(r,"data",u);break}case"src":case"href":if(u===""&&(i!=="a"||o!=="href")){r.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(o);break}u=Ec(""+u),r.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){r.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(o==="formAction"?(i!=="input"&&rt(r,i,"name",g.name,g,null),rt(r,i,"formEncType",g.formEncType,g,null),rt(r,i,"formMethod",g.formMethod,g,null),rt(r,i,"formTarget",g.formTarget,g,null)):(rt(r,i,"encType",g.encType,g,null),rt(r,i,"method",g.method,g,null),rt(r,i,"target",g.target,g,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(o);break}u=Ec(""+u),r.setAttribute(o,u);break;case"onClick":u!=null&&(r.onclick=Sr);break;case"onScroll":u!=null&&qe("scroll",r);break;case"onScrollEnd":u!=null&&qe("scrollend",r);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(o=u.__html,o!=null){if(g.children!=null)throw Error(s(60));r.innerHTML=o}}break;case"multiple":r.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":r.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){r.removeAttribute("xlink:href");break}o=Ec(""+u),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,""+u):r.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,""):r.removeAttribute(o);break;case"capture":case"download":u===!0?r.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,u):r.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?r.setAttribute(o,u):r.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?r.removeAttribute(o):r.setAttribute(o,u);break;case"popover":qe("beforetoggle",r),qe("toggle",r),Bi(r,"popover",u);break;case"xlinkActuate":Vn(r,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Vn(r,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Vn(r,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Vn(r,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Vn(r,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Vn(r,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Vn(r,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Vn(r,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Vn(r,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Bi(r,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=HC.get(o)||o,Bi(r,o,u))}}function wm(r,i,o,u,g,v){switch(o){case"style":Cy(r,u,v);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(o=u.__html,o!=null){if(g.children!=null)throw Error(s(60));r.innerHTML=o}}break;case"children":typeof u=="string"?Hi(r,u):(typeof u=="number"||typeof u=="bigint")&&Hi(r,""+u);break;case"onScroll":u!=null&&qe("scroll",r);break;case"onScrollEnd":u!=null&&qe("scrollend",r);break;case"onClick":u!=null&&(r.onclick=Sr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!_c.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(g=o.endsWith("Capture"),i=o.slice(2,g?o.length-7:void 0),v=r[Yt]||null,v=v!=null?v[o]:null,typeof v=="function"&&r.removeEventListener(i,v,g),typeof u=="function")){typeof v!="function"&&v!==null&&(o in r?r[o]=null:r.hasAttribute(o)&&r.removeAttribute(o)),r.addEventListener(i,u,g);break e}o in r?r[o]=u:u===!0?r.setAttribute(o,""):Bi(r,o,u)}}}function qt(r,i,o){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":qe("error",r),qe("load",r);var u=!1,g=!1,v;for(v in o)if(o.hasOwnProperty(v)){var R=o[v];if(R!=null)switch(v){case"src":u=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,i));default:rt(r,i,v,R,o,null)}}g&&rt(r,i,"srcSet",o.srcSet,o,null),u&&rt(r,i,"src",o.src,o,null);return;case"input":qe("invalid",r);var L=v=R=g=null,K=null,ne=null;for(u in o)if(o.hasOwnProperty(u)){var ue=o[u];if(ue!=null)switch(u){case"name":g=ue;break;case"type":R=ue;break;case"checked":K=ue;break;case"defaultChecked":ne=ue;break;case"value":v=ue;break;case"defaultValue":L=ue;break;case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(s(137,i));break;default:rt(r,i,u,ue,o,null)}}Ac(r,v,L,K,ne,R,g,!1);return;case"select":qe("invalid",r),u=R=v=null;for(g in o)if(o.hasOwnProperty(g)&&(L=o[g],L!=null))switch(g){case"value":v=L;break;case"defaultValue":R=L;break;case"multiple":u=L;default:rt(r,i,g,L,o,null)}i=v,o=R,r.multiple=!!u,i!=null?Pi(r,!!u,i,!1):o!=null&&Pi(r,!!u,o,!0);return;case"textarea":qe("invalid",r),v=g=u=null;for(R in o)if(o.hasOwnProperty(R)&&(L=o[R],L!=null))switch(R){case"value":u=L;break;case"defaultValue":g=L;break;case"children":v=L;break;case"dangerouslySetInnerHTML":if(L!=null)throw Error(s(91));break;default:rt(r,i,R,L,o,null)}Ey(r,u,g,v);return;case"option":for(K in o)if(o.hasOwnProperty(K)&&(u=o[K],u!=null))switch(K){case"selected":r.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:rt(r,i,K,u,o,null)}return;case"dialog":qe("beforetoggle",r),qe("toggle",r),qe("cancel",r),qe("close",r);break;case"iframe":case"object":qe("load",r);break;case"video":case"audio":for(u=0;u<Ho.length;u++)qe(Ho[u],r);break;case"image":qe("error",r),qe("load",r);break;case"details":qe("toggle",r);break;case"embed":case"source":case"link":qe("error",r),qe("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ne in o)if(o.hasOwnProperty(ne)&&(u=o[ne],u!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,i));default:rt(r,i,ne,u,o,null)}return;default:if(Df(i)){for(ue in o)o.hasOwnProperty(ue)&&(u=o[ue],u!==void 0&&wm(r,i,ue,u,o,void 0));return}}for(L in o)o.hasOwnProperty(L)&&(u=o[L],u!=null&&rt(r,i,L,u,o,null))}function pN(r,i,o,u){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,v=null,R=null,L=null,K=null,ne=null,ue=null;for(le in o){var me=o[le];if(o.hasOwnProperty(le)&&me!=null)switch(le){case"checked":break;case"value":break;case"defaultValue":K=me;default:u.hasOwnProperty(le)||rt(r,i,le,null,u,me)}}for(var se in u){var le=u[se];if(me=o[se],u.hasOwnProperty(se)&&(le!=null||me!=null))switch(se){case"type":v=le;break;case"name":g=le;break;case"checked":ne=le;break;case"defaultChecked":ue=le;break;case"value":R=le;break;case"defaultValue":L=le;break;case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(s(137,i));break;default:le!==me&&rt(r,i,se,le,u,me)}}lo(r,R,L,K,ne,ue,v,g);return;case"select":le=R=L=se=null;for(v in o)if(K=o[v],o.hasOwnProperty(v)&&K!=null)switch(v){case"value":break;case"multiple":le=K;default:u.hasOwnProperty(v)||rt(r,i,v,null,u,K)}for(g in u)if(v=u[g],K=o[g],u.hasOwnProperty(g)&&(v!=null||K!=null))switch(g){case"value":se=v;break;case"defaultValue":L=v;break;case"multiple":R=v;default:v!==K&&rt(r,i,g,v,u,K)}i=L,o=R,u=le,se!=null?Pi(r,!!o,se,!1):!!u!=!!o&&(i!=null?Pi(r,!!o,i,!0):Pi(r,!!o,o?[]:"",!1));return;case"textarea":le=se=null;for(L in o)if(g=o[L],o.hasOwnProperty(L)&&g!=null&&!u.hasOwnProperty(L))switch(L){case"value":break;case"children":break;default:rt(r,i,L,null,u,g)}for(R in u)if(g=u[R],v=o[R],u.hasOwnProperty(R)&&(g!=null||v!=null))switch(R){case"value":se=g;break;case"defaultValue":le=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(s(91));break;default:g!==v&&rt(r,i,R,g,u,v)}Ay(r,se,le);return;case"option":for(var xe in o)if(se=o[xe],o.hasOwnProperty(xe)&&se!=null&&!u.hasOwnProperty(xe))switch(xe){case"selected":r.selected=!1;break;default:rt(r,i,xe,null,u,se)}for(K in u)if(se=u[K],le=o[K],u.hasOwnProperty(K)&&se!==le&&(se!=null||le!=null))switch(K){case"selected":r.selected=se&&typeof se!="function"&&typeof se!="symbol";break;default:rt(r,i,K,se,u,le)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var De in o)se=o[De],o.hasOwnProperty(De)&&se!=null&&!u.hasOwnProperty(De)&&rt(r,i,De,null,u,se);for(ne in u)if(se=u[ne],le=o[ne],u.hasOwnProperty(ne)&&se!==le&&(se!=null||le!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(s(137,i));break;default:rt(r,i,ne,se,u,le)}return;default:if(Df(i)){for(var st in o)se=o[st],o.hasOwnProperty(st)&&se!==void 0&&!u.hasOwnProperty(st)&&wm(r,i,st,void 0,u,se);for(ue in u)se=u[ue],le=o[ue],!u.hasOwnProperty(ue)||se===le||se===void 0&&le===void 0||wm(r,i,ue,se,u,le);return}}for(var ee in o)se=o[ee],o.hasOwnProperty(ee)&&se!=null&&!u.hasOwnProperty(ee)&&rt(r,i,ee,null,u,se);for(me in u)se=u[me],le=o[me],!u.hasOwnProperty(me)||se===le||se==null&&le==null||rt(r,i,me,se,u,le)}function T_(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function gN(){if(typeof performance.getEntriesByType=="function"){for(var r=0,i=0,o=performance.getEntriesByType("resource"),u=0;u<o.length;u++){var g=o[u],v=g.transferSize,R=g.initiatorType,L=g.duration;if(v&&L&&T_(R)){for(R=0,L=g.responseEnd,u+=1;u<o.length;u++){var K=o[u],ne=K.startTime;if(ne>L)break;var ue=K.transferSize,me=K.initiatorType;ue&&T_(me)&&(K=K.responseEnd,R+=ue*(K<L?1:(L-ne)/(K-ne)))}if(--u,i+=8*(v+R)/(g.duration/1e3),r++,10<r)break}}if(0<r)return i/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var xm=null,Am=null;function _u(r){return r.nodeType===9?r:r.ownerDocument}function N_(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function R_(r,i){if(r===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&i==="foreignObject"?0:r}function Em(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Sm=null;function yN(){var r=window.event;return r&&r.type==="popstate"?r===Sm?!1:(Sm=r,!0):(Sm=null,!1)}var O_=typeof setTimeout=="function"?setTimeout:void 0,vN=typeof clearTimeout=="function"?clearTimeout:void 0,j_=typeof Promise=="function"?Promise:void 0,_N=typeof queueMicrotask=="function"?queueMicrotask:typeof j_<"u"?function(r){return j_.resolve(null).then(r).catch(bN)}:O_;function bN(r){setTimeout(function(){throw r})}function Ss(r){return r==="head"}function I_(r,i){var o=i,u=0;do{var g=o.nextSibling;if(r.removeChild(o),g&&g.nodeType===8)if(o=g.data,o==="/$"||o==="/&"){if(u===0){r.removeChild(g),_a(i);return}u--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")u++;else if(o==="html")Qo(r.ownerDocument.documentElement);else if(o==="head"){o=r.ownerDocument.head,Qo(o);for(var v=o.firstChild;v;){var R=v.nextSibling,L=v.nodeName;v[Fs]||L==="SCRIPT"||L==="STYLE"||L==="LINK"&&v.rel.toLowerCase()==="stylesheet"||o.removeChild(v),v=R}}else o==="body"&&Qo(r.ownerDocument.body);o=g}while(o);_a(i)}function k_(r,i){var o=r;r=0;do{var u=o.nextSibling;if(o.nodeType===1?i?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(i?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),u&&u.nodeType===8)if(o=u.data,o==="/$"){if(r===0)break;r--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||r++;o=u}while(o)}function Cm(r){var i=r.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var o=i;switch(i=i.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Cm(o),ao(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}r.removeChild(o)}}function wN(r,i,o,u){for(;r.nodeType===1;){var g=o;if(r.nodeName.toLowerCase()!==i.toLowerCase()){if(!u&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(u){if(!r[Fs])switch(i){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(v=r.getAttribute("rel"),v==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(v!==g.rel||r.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||r.getAttribute("title")!==(g.title==null?null:g.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(v=r.getAttribute("src"),(v!==(g.src==null?null:g.src)||r.getAttribute("type")!==(g.type==null?null:g.type)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&v&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(i==="input"&&r.type==="hidden"){var v=g.name==null?null:""+g.name;if(g.type==="hidden"&&r.getAttribute("name")===v)return r}else return r;if(r=$n(r.nextSibling),r===null)break}return null}function xN(r,i,o){if(i==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=$n(r.nextSibling),r===null))return null;return r}function M_(r,i){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!i||(r=$n(r.nextSibling),r===null))return null;return r}function Tm(r){return r.data==="$?"||r.data==="$~"}function Nm(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function AN(r,i){var o=r.ownerDocument;if(r.data==="$~")r._reactRetry=i;else if(r.data!=="$?"||o.readyState!=="loading")i();else{var u=function(){i(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),r._reactRetry=u}}function $n(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return r}var Rm=null;function D_(r){r=r.nextSibling;for(var i=0;r;){if(r.nodeType===8){var o=r.data;if(o==="/$"||o==="/&"){if(i===0)return $n(r.nextSibling);i--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||i++}r=r.nextSibling}return null}function B_(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var o=r.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(i===0)return r;i--}else o!=="/$"&&o!=="/&"||i++}r=r.previousSibling}return null}function U_(r,i,o){switch(i=_u(o),r){case"html":if(r=i.documentElement,!r)throw Error(s(452));return r;case"head":if(r=i.head,!r)throw Error(s(453));return r;case"body":if(r=i.body,!r)throw Error(s(454));return r;default:throw Error(s(451))}}function Qo(r){for(var i=r.attributes;i.length;)r.removeAttributeNode(i[0]);ao(r)}var zn=new Map,L_=new Set;function bu(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Pr=B.d;B.d={f:EN,r:SN,D:CN,C:TN,L:NN,m:RN,X:jN,S:ON,M:IN};function EN(){var r=Pr.f(),i=du();return r||i}function SN(r){var i=ss(r);i!==null&&i.tag===5&&i.type==="form"?tv(i):Pr.r(r)}var ga=typeof document>"u"?null:document;function $_(r,i,o){var u=ga;if(u&&typeof i=="string"&&i){var g=Xt(i);g='link[rel="'+r+'"][href="'+g+'"]',typeof o=="string"&&(g+='[crossorigin="'+o+'"]'),L_.has(g)||(L_.add(g),r={rel:r,crossOrigin:o,href:i},u.querySelector(g)===null&&(i=u.createElement("link"),qt(i,"link",r),At(i),u.head.appendChild(i)))}}function CN(r){Pr.D(r),$_("dns-prefetch",r,null)}function TN(r,i){Pr.C(r,i),$_("preconnect",r,i)}function NN(r,i,o){Pr.L(r,i,o);var u=ga;if(u&&r&&i){var g='link[rel="preload"][as="'+Xt(i)+'"]';i==="image"&&o&&o.imageSrcSet?(g+='[imagesrcset="'+Xt(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(g+='[imagesizes="'+Xt(o.imageSizes)+'"]')):g+='[href="'+Xt(r)+'"]';var v=g;switch(i){case"style":v=ya(r);break;case"script":v=va(r)}zn.has(v)||(r=m({rel:"preload",href:i==="image"&&o&&o.imageSrcSet?void 0:r,as:i},o),zn.set(v,r),u.querySelector(g)!==null||i==="style"&&u.querySelector(Vo(v))||i==="script"&&u.querySelector(Fo(v))||(i=u.createElement("link"),qt(i,"link",r),At(i),u.head.appendChild(i)))}}function RN(r,i){Pr.m(r,i);var o=ga;if(o&&r){var u=i&&typeof i.as=="string"?i.as:"script",g='link[rel="modulepreload"][as="'+Xt(u)+'"][href="'+Xt(r)+'"]',v=g;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=va(r)}if(!zn.has(v)&&(r=m({rel:"modulepreload",href:r},i),zn.set(v,r),o.querySelector(g)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Fo(v)))return}u=o.createElement("link"),qt(u,"link",r),At(u),o.head.appendChild(u)}}}function ON(r,i,o){Pr.S(r,i,o);var u=ga;if(u&&r){var g=as(u).hoistableStyles,v=ya(r);i=i||"default";var R=g.get(v);if(!R){var L={loading:0,preload:null};if(R=u.querySelector(Vo(v)))L.loading=5;else{r=m({rel:"stylesheet",href:r,"data-precedence":i},o),(o=zn.get(v))&&Om(r,o);var K=R=u.createElement("link");At(K),qt(K,"link",r),K._p=new Promise(function(ne,ue){K.onload=ne,K.onerror=ue}),K.addEventListener("load",function(){L.loading|=1}),K.addEventListener("error",function(){L.loading|=2}),L.loading|=4,wu(R,i,u)}R={type:"stylesheet",instance:R,count:1,state:L},g.set(v,R)}}}function jN(r,i){Pr.X(r,i);var o=ga;if(o&&r){var u=as(o).hoistableScripts,g=va(r),v=u.get(g);v||(v=o.querySelector(Fo(g)),v||(r=m({src:r,async:!0},i),(i=zn.get(g))&&jm(r,i),v=o.createElement("script"),At(v),qt(v,"link",r),o.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},u.set(g,v))}}function IN(r,i){Pr.M(r,i);var o=ga;if(o&&r){var u=as(o).hoistableScripts,g=va(r),v=u.get(g);v||(v=o.querySelector(Fo(g)),v||(r=m({src:r,async:!0,type:"module"},i),(i=zn.get(g))&&jm(r,i),v=o.createElement("script"),At(v),qt(v,"link",r),o.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},u.set(g,v))}}function z_(r,i,o,u){var g=(g=ae.current)?bu(g):null;if(!g)throw Error(s(446));switch(r){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(i=ya(o.href),o=as(g).hoistableStyles,u=o.get(i),u||(u={type:"style",instance:null,count:0,state:null},o.set(i,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){r=ya(o.href);var v=as(g).hoistableStyles,R=v.get(r);if(R||(g=g.ownerDocument||g,R={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(r,R),(v=g.querySelector(Vo(r)))&&!v._p&&(R.instance=v,R.state.loading=5),zn.has(r)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},zn.set(r,o),v||kN(g,r,o,R.state))),i&&u===null)throw Error(s(528,""));return R}if(i&&u!==null)throw Error(s(529,""));return null;case"script":return i=o.async,o=o.src,typeof o=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=va(o),o=as(g).hoistableScripts,u=o.get(i),u||(u={type:"script",instance:null,count:0,state:null},o.set(i,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,r))}}function ya(r){return'href="'+Xt(r)+'"'}function Vo(r){return'link[rel="stylesheet"]['+r+"]"}function P_(r){return m({},r,{"data-precedence":r.precedence,precedence:null})}function kN(r,i,o,u){r.querySelector('link[rel="preload"][as="style"]['+i+"]")?u.loading=1:(i=r.createElement("link"),u.preload=i,i.addEventListener("load",function(){return u.loading|=1}),i.addEventListener("error",function(){return u.loading|=2}),qt(i,"link",o),At(i),r.head.appendChild(i))}function va(r){return'[src="'+Xt(r)+'"]'}function Fo(r){return"script[async]"+r}function H_(r,i,o){if(i.count++,i.instance===null)switch(i.type){case"style":var u=r.querySelector('style[data-href~="'+Xt(o.href)+'"]');if(u)return i.instance=u,At(u),u;var g=m({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(r.ownerDocument||r).createElement("style"),At(u),qt(u,"style",g),wu(u,o.precedence,r),i.instance=u;case"stylesheet":g=ya(o.href);var v=r.querySelector(Vo(g));if(v)return i.state.loading|=4,i.instance=v,At(v),v;u=P_(o),(g=zn.get(g))&&Om(u,g),v=(r.ownerDocument||r).createElement("link"),At(v);var R=v;return R._p=new Promise(function(L,K){R.onload=L,R.onerror=K}),qt(v,"link",u),i.state.loading|=4,wu(v,o.precedence,r),i.instance=v;case"script":return v=va(o.src),(g=r.querySelector(Fo(v)))?(i.instance=g,At(g),g):(u=o,(g=zn.get(v))&&(u=m({},o),jm(u,g)),r=r.ownerDocument||r,g=r.createElement("script"),At(g),qt(g,"link",u),r.head.appendChild(g),i.instance=g);case"void":return null;default:throw Error(s(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(u=i.instance,i.state.loading|=4,wu(u,o.precedence,r));return i.instance}function wu(r,i,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=u.length?u[u.length-1]:null,v=g,R=0;R<u.length;R++){var L=u[R];if(L.dataset.precedence===i)v=L;else if(v!==g)break}v?v.parentNode.insertBefore(r,v.nextSibling):(i=o.nodeType===9?o.head:o,i.insertBefore(r,i.firstChild))}function Om(r,i){r.crossOrigin==null&&(r.crossOrigin=i.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=i.referrerPolicy),r.title==null&&(r.title=i.title)}function jm(r,i){r.crossOrigin==null&&(r.crossOrigin=i.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=i.referrerPolicy),r.integrity==null&&(r.integrity=i.integrity)}var xu=null;function q_(r,i,o){if(xu===null){var u=new Map,g=xu=new Map;g.set(o,u)}else g=xu,u=g.get(o),u||(u=new Map,g.set(o,u));if(u.has(r))return u;for(u.set(r,null),o=o.getElementsByTagName(r),g=0;g<o.length;g++){var v=o[g];if(!(v[Fs]||v[jt]||r==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var R=v.getAttribute(i)||"";R=r+R;var L=u.get(R);L?L.push(v):u.set(R,[v])}}return u}function Q_(r,i,o){r=r.ownerDocument||r,r.head.insertBefore(o,i==="title"?r.querySelector("head > title"):null)}function MN(r,i,o){if(o===1||i.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return r=i.disabled,typeof i.precedence=="string"&&r==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function V_(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function DN(r,i,o,u){if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=ya(u.href),v=i.querySelector(Vo(g));if(v){i=v._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(r.count++,r=Au.bind(r),i.then(r,r)),o.state.loading|=4,o.instance=v,At(v);return}v=i.ownerDocument||i,u=P_(u),(g=zn.get(g))&&Om(u,g),v=v.createElement("link"),At(v);var R=v;R._p=new Promise(function(L,K){R.onload=L,R.onerror=K}),qt(v,"link",u),o.instance=v}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(r.count++,o=Au.bind(r),i.addEventListener("load",o),i.addEventListener("error",o))}}var Im=0;function BN(r,i){return r.stylesheets&&r.count===0&&Su(r,r.stylesheets),0<r.count||0<r.imgCount?function(o){var u=setTimeout(function(){if(r.stylesheets&&Su(r,r.stylesheets),r.unsuspend){var v=r.unsuspend;r.unsuspend=null,v()}},6e4+i);0<r.imgBytes&&Im===0&&(Im=62500*gN());var g=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Su(r,r.stylesheets),r.unsuspend)){var v=r.unsuspend;r.unsuspend=null,v()}},(r.imgBytes>Im?50:800)+i);return r.unsuspend=o,function(){r.unsuspend=null,clearTimeout(u),clearTimeout(g)}}:null}function Au(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Su(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Eu=null;function Su(r,i){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Eu=new Map,i.forEach(UN,r),Eu=null,Au.call(r))}function UN(r,i){if(!(i.state.loading&4)){var o=Eu.get(r);if(o)var u=o.get(null);else{o=new Map,Eu.set(r,o);for(var g=r.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<g.length;v++){var R=g[v];(R.nodeName==="LINK"||R.getAttribute("media")!=="not all")&&(o.set(R.dataset.precedence,R),u=R)}u&&o.set(null,u)}g=i.instance,R=g.getAttribute("data-precedence"),v=o.get(R)||u,v===u&&o.set(null,g),o.set(R,g),this.count++,u=Au.bind(this),g.addEventListener("load",u),g.addEventListener("error",u),v?v.parentNode.insertBefore(g,v.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(g,r.firstChild)),i.state.loading|=4}}var Go={$$typeof:E,Provider:null,Consumer:null,_currentValue:U,_currentValue2:U,_threadCount:0};function LN(r,i,o,u,g,v,R,L,K){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ro(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ro(0),this.hiddenUpdates=ro(null),this.identifierPrefix=u,this.onUncaughtError=g,this.onCaughtError=v,this.onRecoverableError=R,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=K,this.incompleteTransitions=new Map}function F_(r,i,o,u,g,v,R,L,K,ne,ue,me){return r=new LN(r,i,o,R,K,ne,ue,me,L),i=1,v===!0&&(i|=24),v=vn(3,null,null,i),r.current=v,v.stateNode=r,i=dh(),i.refCount++,r.pooledCache=i,i.refCount++,v.memoizedState={element:u,isDehydrated:o,cache:i},ph(v),r}function G_(r){return r?(r=Xi,r):Xi}function Y_(r,i,o,u,g,v){g=G_(g),u.context===null?u.context=g:u.pendingContext=g,u=ms(i),u.payload={element:o},v=v===void 0?null:v,v!==null&&(u.callback=v),o=ps(r,u,i),o!==null&&(un(o,r,i),So(o,r,i))}function X_(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var o=r.retryLane;r.retryLane=o!==0&&o<i?o:i}}function km(r,i){X_(r,i),(r=r.alternate)&&X_(r,i)}function K_(r){if(r.tag===13||r.tag===31){var i=Ks(r,67108864);i!==null&&un(i,r,67108864),km(r,67108864)}}function W_(r){if(r.tag===13||r.tag===31){var i=An();i=so(i);var o=Ks(r,i);o!==null&&un(o,r,i),km(r,i)}}var Cu=!0;function $N(r,i,o,u){var g=N.T;N.T=null;var v=B.p;try{B.p=2,Mm(r,i,o,u)}finally{B.p=v,N.T=g}}function zN(r,i,o,u){var g=N.T;N.T=null;var v=B.p;try{B.p=8,Mm(r,i,o,u)}finally{B.p=v,N.T=g}}function Mm(r,i,o,u){if(Cu){var g=Dm(u);if(g===null)bm(r,i,u,Tu,o),Z_(r,u);else if(HN(g,r,i,o,u))u.stopPropagation();else if(Z_(r,u),i&4&&-1<PN.indexOf(r)){for(;g!==null;){var v=ss(g);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var R=xr(v.pendingLanes);if(R!==0){var L=v;for(L.pendingLanes|=2,L.entangledLanes|=2;R;){var K=1<<31-Ee(R);L.entanglements[1]|=K,R&=~K}dr(v),(Ze&6)===0&&(cu=dt()+500,Po(0))}}break;case 31:case 13:L=Ks(v,2),L!==null&&un(L,v,2),du(),km(v,2)}if(v=Dm(u),v===null&&bm(r,i,u,Tu,o),v===g)break;g=v}g!==null&&u.stopPropagation()}else bm(r,i,u,null,o)}}function Dm(r){return r=Uf(r),Bm(r)}var Tu=null;function Bm(r){if(Tu=null,r=rs(r),r!==null){var i=l(r);if(i===null)r=null;else{var o=i.tag;if(o===13){if(r=c(i),r!==null)return r;r=null}else if(o===31){if(r=d(i),r!==null)return r;r=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null)}}return Tu=r,null}function J_(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(pn()){case In:return 2;case nn:return 8;case gn:case wr:return 32;case ts:return 268435456;default:return 32}default:return 32}}var Um=!1,Cs=null,Ts=null,Ns=null,Yo=new Map,Xo=new Map,Rs=[],PN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Z_(r,i){switch(r){case"focusin":case"focusout":Cs=null;break;case"dragenter":case"dragleave":Ts=null;break;case"mouseover":case"mouseout":Ns=null;break;case"pointerover":case"pointerout":Yo.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xo.delete(i.pointerId)}}function Ko(r,i,o,u,g,v){return r===null||r.nativeEvent!==v?(r={blockedOn:i,domEventName:o,eventSystemFlags:u,nativeEvent:v,targetContainers:[g]},i!==null&&(i=ss(i),i!==null&&K_(i)),r):(r.eventSystemFlags|=u,i=r.targetContainers,g!==null&&i.indexOf(g)===-1&&i.push(g),r)}function HN(r,i,o,u,g){switch(i){case"focusin":return Cs=Ko(Cs,r,i,o,u,g),!0;case"dragenter":return Ts=Ko(Ts,r,i,o,u,g),!0;case"mouseover":return Ns=Ko(Ns,r,i,o,u,g),!0;case"pointerover":var v=g.pointerId;return Yo.set(v,Ko(Yo.get(v)||null,r,i,o,u,g)),!0;case"gotpointercapture":return v=g.pointerId,Xo.set(v,Ko(Xo.get(v)||null,r,i,o,u,g)),!0}return!1}function eb(r){var i=rs(r.target);if(i!==null){var o=l(i);if(o!==null){if(i=o.tag,i===13){if(i=c(o),i!==null){r.blockedOn=i,pc(r.priority,function(){W_(o)});return}}else if(i===31){if(i=d(o),i!==null){r.blockedOn=i,pc(r.priority,function(){W_(o)});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){r.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Nu(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var o=Dm(r.nativeEvent);if(o===null){o=r.nativeEvent;var u=new o.constructor(o.type,o);Bf=u,o.target.dispatchEvent(u),Bf=null}else return i=ss(o),i!==null&&K_(i),r.blockedOn=o,!1;i.shift()}return!0}function tb(r,i,o){Nu(r)&&o.delete(i)}function qN(){Um=!1,Cs!==null&&Nu(Cs)&&(Cs=null),Ts!==null&&Nu(Ts)&&(Ts=null),Ns!==null&&Nu(Ns)&&(Ns=null),Yo.forEach(tb),Xo.forEach(tb)}function Ru(r,i){r.blockedOn===i&&(r.blockedOn=null,Um||(Um=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,qN)))}var Ou=null;function nb(r){Ou!==r&&(Ou=r,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Ou===r&&(Ou=null);for(var i=0;i<r.length;i+=3){var o=r[i],u=r[i+1],g=r[i+2];if(typeof u!="function"){if(Bm(u||o)===null)continue;break}var v=ss(o);v!==null&&(r.splice(i,3),i-=3,Dh(v,{pending:!0,data:g,method:o.method,action:u},u,g))}}))}function _a(r){function i(K){return Ru(K,r)}Cs!==null&&Ru(Cs,r),Ts!==null&&Ru(Ts,r),Ns!==null&&Ru(Ns,r),Yo.forEach(i),Xo.forEach(i);for(var o=0;o<Rs.length;o++){var u=Rs[o];u.blockedOn===r&&(u.blockedOn=null)}for(;0<Rs.length&&(o=Rs[0],o.blockedOn===null);)eb(o),o.blockedOn===null&&Rs.shift();if(o=(r.ownerDocument||r).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var g=o[u],v=o[u+1],R=g[Yt]||null;if(typeof v=="function")R||nb(o);else if(R){var L=null;if(v&&v.hasAttribute("formAction")){if(g=v,R=v[Yt]||null)L=R.formAction;else if(Bm(g)!==null)continue}else L=R.action;typeof L=="function"?o[u+1]=L:(o.splice(u,3),u-=3),nb(o)}}}function rb(){function r(v){v.canIntercept&&v.info==="react-transition"&&v.intercept({handler:function(){return new Promise(function(R){return g=R})},focusReset:"manual",scroll:"manual"})}function i(){g!==null&&(g(),g=null),u||setTimeout(o,20)}function o(){if(!u&&!navigation.transition){var v=navigation.currentEntry;v&&v.url!=null&&navigation.navigate(v.url,{state:v.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,g=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(o,100),function(){u=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),g!==null&&(g(),g=null)}}}function Lm(r){this._internalRoot=r}ju.prototype.render=Lm.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(s(409));var o=i.current,u=An();Y_(o,u,r,i,null,null)},ju.prototype.unmount=Lm.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;Y_(r.current,2,null,r,null,null),du(),i[Ar]=null}};function ju(r){this._internalRoot=r}ju.prototype.unstable_scheduleHydration=function(r){if(r){var i=mc();r={blockedOn:null,target:r,priority:i};for(var o=0;o<Rs.length&&i!==0&&i<Rs[o].priority;o++);Rs.splice(o,0,r),o===0&&eb(r)}};var sb=e.version;if(sb!=="19.2.0")throw Error(s(527,sb,"19.2.0"));B.findDOMNode=function(r){var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(s(188)):(r=Object.keys(r).join(","),Error(s(268,r)));return r=h(i),r=r!==null?p(r):null,r=r===null?null:r.stateNode,r};var QN={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:N,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Iu.isDisabled&&Iu.supportsFiber)try{Qn=Iu.inject(QN),$t=Iu}catch{}}return Jo.createRoot=function(r,i){if(!a(r))throw Error(s(299));var o=!1,u="",g=dv,v=fv,R=hv;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(u=i.identifierPrefix),i.onUncaughtError!==void 0&&(g=i.onUncaughtError),i.onCaughtError!==void 0&&(v=i.onCaughtError),i.onRecoverableError!==void 0&&(R=i.onRecoverableError)),i=F_(r,1,!1,null,null,o,u,null,g,v,R,rb),r[Ar]=i.current,_m(r),new Lm(i)},Jo.hydrateRoot=function(r,i,o){if(!a(r))throw Error(s(299));var u=!1,g="",v=dv,R=fv,L=hv,K=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onUncaughtError!==void 0&&(v=o.onUncaughtError),o.onCaughtError!==void 0&&(R=o.onCaughtError),o.onRecoverableError!==void 0&&(L=o.onRecoverableError),o.formState!==void 0&&(K=o.formState)),i=F_(r,1,!0,i,o??null,u,g,K,v,R,L,rb),i.context=G_(null),o=i.current,u=An(),u=so(u),g=ms(u),g.callback=null,ps(o,g,u),o=u,i.current.lanes=o,Vs(i,o),dr(i),r[Ar]=i.current,_m(r),new ju(i)},Jo.version="19.2.0",Jo}var mb;function tR(){if(mb)return Pm.exports;mb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Pm.exports=eR(),Pm.exports}var nR=tR();var pb="popstate";function rR(t={}){function e(s,a){let{pathname:l,search:c,hash:d}=s.location;return Cp("",{pathname:l,search:c,hash:d},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(s,a){return typeof a=="string"?a:Il(a)}return iR(e,n,null,t)}function yt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function yr(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function sR(){return Math.random().toString(36).substring(2,10)}function gb(t,e){return{usr:t.state,key:t.key,idx:e}}function Cp(t,e,n=null,s){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Xa(e):e,state:n,key:e&&e.key||s||sR()}}function Il({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Xa(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substring(s),t=t.substring(0,s)),t&&(e.pathname=t)}return e}function iR(t,e,n,s={}){let{window:a=document.defaultView,v5Compat:l=!1}=s,c=a.history,d="POP",f=null,h=p();h==null&&(h=0,c.replaceState({...c.state,idx:h},""));function p(){return(c.state||{idx:null}).idx}function m(){d="POP";let A=p(),S=A==null?null:A-h;h=A,f&&f({action:d,location:w.location,delta:S})}function y(A,S){d="PUSH";let T=Cp(w.location,A,S);h=p()+1;let E=gb(T,h),C=w.createHref(T);try{c.pushState(E,"",C)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;a.location.assign(C)}l&&f&&f({action:d,location:w.location,delta:1})}function _(A,S){d="REPLACE";let T=Cp(w.location,A,S);h=p();let E=gb(T,h),C=w.createHref(T);c.replaceState(E,"",C),l&&f&&f({action:d,location:w.location,delta:0})}function x(A){return aR(A)}let w={get action(){return d},get location(){return t(a,c)},listen(A){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(pb,m),f=A,()=>{a.removeEventListener(pb,m),f=null}},createHref(A){return e(a,A)},createURL:x,encodeLocation(A){let S=x(A);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:y,replace:_,go(A){return c.go(A)}};return w}function aR(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),yt(n,"No window.location.(origin|href) available to create URL");let s=typeof t=="string"?t:Il(t);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=n+s),new URL(s,n)}function Jx(t,e,n="/"){return oR(t,e,n,!1)}function oR(t,e,n,s){let a=typeof e=="string"?Xa(e):e,l=Kr(a.pathname||"/",n);if(l==null)return null;let c=Zx(t);lR(c);let d=null;for(let f=0;d==null&&f<c.length;++f){let h=_R(l);d=yR(c[f],h,s)}return d}function Zx(t,e=[],n=[],s="",a=!1){let l=(c,d,f=a,h)=>{let p={relativePath:h===void 0?c.path||"":h,caseSensitive:c.caseSensitive===!0,childrenIndex:d,route:c};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(s)&&f)return;yt(p.relativePath.startsWith(s),`Absolute route path "${p.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(s.length)}let m=Xr([s,p.relativePath]),y=n.concat(p);c.children&&c.children.length>0&&(yt(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),Zx(c.children,e,y,m,f)),!(c.path==null&&!c.index)&&e.push({path:m,score:pR(m,c.index),routesMeta:y})};return t.forEach((c,d)=>{if(c.path===""||!c.path?.includes("?"))l(c,d);else for(let f of eA(c.path))l(c,d,!0,f)}),e}function eA(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,a=n.endsWith("?"),l=n.replace(/\?$/,"");if(s.length===0)return a?[l,""]:[l];let c=eA(s.join("/")),d=[];return d.push(...c.map(f=>f===""?l:[l,f].join("/"))),a&&d.push(...c),d.map(f=>t.startsWith("/")&&f===""?"/":f)}function lR(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:gR(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}var cR=/^:[\w-]+$/,uR=3,dR=2,fR=1,hR=10,mR=-2,yb=t=>t==="*";function pR(t,e){let n=t.split("/"),s=n.length;return n.some(yb)&&(s+=mR),e&&(s+=dR),n.filter(a=>!yb(a)).reduce((a,l)=>a+(cR.test(l)?uR:l===""?fR:hR),s)}function gR(t,e){return t.length===e.length&&t.slice(0,-1).every((s,a)=>s===e[a])?t[t.length-1]-e[e.length-1]:0}function yR(t,e,n=!1){let{routesMeta:s}=t,a={},l="/",c=[];for(let d=0;d<s.length;++d){let f=s[d],h=d===s.length-1,p=l==="/"?e:e.slice(l.length)||"/",m=Cd({path:f.relativePath,caseSensitive:f.caseSensitive,end:h},p),y=f.route;if(!m&&h&&n&&!s[s.length-1].route.index&&(m=Cd({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},p)),!m)return null;Object.assign(a,m.params),c.push({params:a,pathname:Xr([l,m.pathname]),pathnameBase:AR(Xr([l,m.pathnameBase])),route:y}),m.pathnameBase!=="/"&&(l=Xr([l,m.pathnameBase]))}return c}function Cd(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=vR(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let l=a[0],c=l.replace(/(.)\/+$/,"$1"),d=a.slice(1);return{params:s.reduce((h,{paramName:p,isOptional:m},y)=>{if(p==="*"){let x=d[y]||"";c=l.slice(0,l.length-x.length).replace(/(.)\/+$/,"$1")}const _=d[y];return m&&!_?h[p]=void 0:h[p]=(_||"").replace(/%2F/g,"/"),h},{}),pathname:l,pathnameBase:c,pattern:t}}function vR(t,e=!1,n=!0){yr(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let s=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,d,f)=>(s.push({paramName:d,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(s.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),s]}function _R(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return yr(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Kr(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function bR(t,e="/"){let{pathname:n,search:s="",hash:a=""}=typeof t=="string"?Xa(t):t;return{pathname:n?n.startsWith("/")?n:wR(n,e):e,search:ER(s),hash:SR(a)}}function wR(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function Vm(t,e,n,s){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function xR(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function tA(t){let e=xR(t);return e.map((n,s)=>s===e.length-1?n.pathname:n.pathnameBase)}function nA(t,e,n,s=!1){let a;typeof t=="string"?a=Xa(t):(a={...t},yt(!a.pathname||!a.pathname.includes("?"),Vm("?","pathname","search",a)),yt(!a.pathname||!a.pathname.includes("#"),Vm("#","pathname","hash",a)),yt(!a.search||!a.search.includes("#"),Vm("#","search","hash",a)));let l=t===""||a.pathname==="",c=l?"/":a.pathname,d;if(c==null)d=n;else{let m=e.length-1;if(!s&&c.startsWith("..")){let y=c.split("/");for(;y[0]==="..";)y.shift(),m-=1;a.pathname=y.join("/")}d=m>=0?e[m]:"/"}let f=bR(a,d),h=c&&c!=="/"&&c.endsWith("/"),p=(l||c===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(h||p)&&(f.pathname+="/"),f}var Xr=t=>t.join("/").replace(/\/\/+/g,"/"),AR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),ER=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,SR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function CR(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var rA=["POST","PUT","PATCH","DELETE"];new Set(rA);var TR=["GET",...rA];new Set(TR);var Ka=k.createContext(null);Ka.displayName="DataRouter";var Zd=k.createContext(null);Zd.displayName="DataRouterState";k.createContext(!1);var sA=k.createContext({isTransitioning:!1});sA.displayName="ViewTransition";var NR=k.createContext(new Map);NR.displayName="Fetchers";var RR=k.createContext(null);RR.displayName="Await";var vr=k.createContext(null);vr.displayName="Navigation";var Kl=k.createContext(null);Kl.displayName="Location";var Zr=k.createContext({outlet:null,matches:[],isDataRoute:!1});Zr.displayName="Route";var yg=k.createContext(null);yg.displayName="RouteError";function OR(t,{relative:e}={}){yt(Wl(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:s}=k.useContext(vr),{hash:a,pathname:l,search:c}=Jl(t,{relative:e}),d=l;return n!=="/"&&(d=l==="/"?n:Xr([n,l])),s.createHref({pathname:d,search:c,hash:a})}function Wl(){return k.useContext(Kl)!=null}function Oi(){return yt(Wl(),"useLocation() may be used only in the context of a <Router> component."),k.useContext(Kl).location}var iA="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function aA(t){k.useContext(vr).static||k.useLayoutEffect(t)}function Ps(){let{isDataRoute:t}=k.useContext(Zr);return t?qR():jR()}function jR(){yt(Wl(),"useNavigate() may be used only in the context of a <Router> component.");let t=k.useContext(Ka),{basename:e,navigator:n}=k.useContext(vr),{matches:s}=k.useContext(Zr),{pathname:a}=Oi(),l=JSON.stringify(tA(s)),c=k.useRef(!1);return aA(()=>{c.current=!0}),k.useCallback((f,h={})=>{if(yr(c.current,iA),!c.current)return;if(typeof f=="number"){n.go(f);return}let p=nA(f,JSON.parse(l),a,h.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Xr([e,p.pathname])),(h.replace?n.replace:n.push)(p,h.state,h)},[e,n,l,a,t])}k.createContext(null);function Jl(t,{relative:e}={}){let{matches:n}=k.useContext(Zr),{pathname:s}=Oi(),a=JSON.stringify(tA(n));return k.useMemo(()=>nA(t,JSON.parse(a),s,e==="path"),[t,a,s,e])}function IR(t,e){return oA(t,e)}function oA(t,e,n,s,a){yt(Wl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=k.useContext(vr),{matches:c}=k.useContext(Zr),d=c[c.length-1],f=d?d.params:{},h=d?d.pathname:"/",p=d?d.pathnameBase:"/",m=d&&d.route;{let T=m&&m.path||"";lA(h,!m||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let y=Oi(),_;if(e){let T=typeof e=="string"?Xa(e):e;yt(p==="/"||T.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${T.pathname}" was given in the \`location\` prop.`),_=T}else _=y;let x=_.pathname||"/",w=x;if(p!=="/"){let T=p.replace(/^\//,"").split("/");w="/"+x.replace(/^\//,"").split("/").slice(T.length).join("/")}let A=Jx(t,{pathname:w});yr(m||A!=null,`No routes matched location "${_.pathname}${_.search}${_.hash}" `),yr(A==null||A[A.length-1].route.element!==void 0||A[A.length-1].route.Component!==void 0||A[A.length-1].route.lazy!==void 0,`Matched leaf route at location "${_.pathname}${_.search}${_.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let S=UR(A&&A.map(T=>Object.assign({},T,{params:Object.assign({},f,T.params),pathname:Xr([p,l.encodeLocation?l.encodeLocation(T.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?p:Xr([p,l.encodeLocation?l.encodeLocation(T.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathnameBase])})),c,n,s,a);return e&&S?k.createElement(Kl.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",..._},navigationType:"POP"}},S):S}function kR(){let t=HR(),e=CR(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:s},l={padding:"2px 4px",backgroundColor:s},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=k.createElement(k.Fragment,null,k.createElement("p",null," Hey developer "),k.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",k.createElement("code",{style:l},"ErrorBoundary")," or"," ",k.createElement("code",{style:l},"errorElement")," prop on your route.")),k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},e),n?k.createElement("pre",{style:a},n):null,c)}var MR=k.createElement(kR,null),DR=class extends k.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.unstable_onError?this.props.unstable_onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?k.createElement(Zr.Provider,{value:this.props.routeContext},k.createElement(yg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function BR({routeContext:t,match:e,children:n}){let s=k.useContext(Ka);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),k.createElement(Zr.Provider,{value:t},n)}function UR(t,e=[],n=null,s=null,a=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,c=n?.errors;if(c!=null){let h=l.findIndex(p=>p.route.id&&c?.[p.route.id]!==void 0);yt(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,h+1))}let d=!1,f=-1;if(n)for(let h=0;h<l.length;h++){let p=l[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(f=h),p.route.id){let{loaderData:m,errors:y}=n,_=p.route.loader&&!m.hasOwnProperty(p.route.id)&&(!y||y[p.route.id]===void 0);if(p.route.lazy||_){d=!0,f>=0?l=l.slice(0,f+1):l=[l[0]];break}}}return l.reduceRight((h,p,m)=>{let y,_=!1,x=null,w=null;n&&(y=c&&p.route.id?c[p.route.id]:void 0,x=p.route.errorElement||MR,d&&(f<0&&m===0?(lA("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,w=null):f===m&&(_=!0,w=p.route.hydrateFallbackElement||null)));let A=e.concat(l.slice(0,m+1)),S=()=>{let T;return y?T=x:_?T=w:p.route.Component?T=k.createElement(p.route.Component,null):p.route.element?T=p.route.element:T=h,k.createElement(BR,{match:p,routeContext:{outlet:h,matches:A,isDataRoute:n!=null},children:T})};return n&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?k.createElement(DR,{location:n.location,revalidation:n.revalidation,component:x,error:y,children:S(),routeContext:{outlet:null,matches:A,isDataRoute:!0},unstable_onError:s}):S()},null)}function vg(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function LR(t){let e=k.useContext(Ka);return yt(e,vg(t)),e}function $R(t){let e=k.useContext(Zd);return yt(e,vg(t)),e}function zR(t){let e=k.useContext(Zr);return yt(e,vg(t)),e}function _g(t){let e=zR(t),n=e.matches[e.matches.length-1];return yt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function PR(){return _g("useRouteId")}function HR(){let t=k.useContext(yg),e=$R("useRouteError"),n=_g("useRouteError");return t!==void 0?t:e.errors?.[n]}function qR(){let{router:t}=LR("useNavigate"),e=_g("useNavigate"),n=k.useRef(!1);return aA(()=>{n.current=!0}),k.useCallback(async(a,l={})=>{yr(n.current,iA),n.current&&(typeof a=="number"?t.navigate(a):await t.navigate(a,{fromRouteId:e,...l}))},[t,e])}var vb={};function lA(t,e,n){!e&&!vb[t]&&(vb[t]=!0,yr(!1,n))}k.memo(QR);function QR({routes:t,future:e,state:n,unstable_onError:s}){return oA(t,void 0,n,s,e)}function Us(t){yt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function VR({basename:t="/",children:e=null,location:n,navigationType:s="POP",navigator:a,static:l=!1}){yt(!Wl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),d=k.useMemo(()=>({basename:c,navigator:a,static:l,future:{}}),[c,a,l]);typeof n=="string"&&(n=Xa(n));let{pathname:f="/",search:h="",hash:p="",state:m=null,key:y="default"}=n,_=k.useMemo(()=>{let x=Kr(f,c);return x==null?null:{location:{pathname:x,search:h,hash:p,state:m,key:y},navigationType:s}},[c,f,h,p,m,y,s]);return yr(_!=null,`<Router basename="${c}"> is not able to match the URL "${f}${h}${p}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:k.createElement(vr.Provider,{value:d},k.createElement(Kl.Provider,{children:e,value:_}))}function FR({children:t,location:e}){return IR(Tp(t),e)}function Tp(t,e=[]){let n=[];return k.Children.forEach(t,(s,a)=>{if(!k.isValidElement(s))return;let l=[...e,a];if(s.type===k.Fragment){n.push.apply(n,Tp(s.props.children,l));return}yt(s.type===Us,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),yt(!s.props.index||!s.props.children,"An index route cannot have child routes.");let c={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(c.children=Tp(s.props.children,l)),n.push(c)}),n}var cd="get",ud="application/x-www-form-urlencoded";function ef(t){return t!=null&&typeof t.tagName=="string"}function GR(t){return ef(t)&&t.tagName.toLowerCase()==="button"}function YR(t){return ef(t)&&t.tagName.toLowerCase()==="form"}function XR(t){return ef(t)&&t.tagName.toLowerCase()==="input"}function KR(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function WR(t,e){return t.button===0&&(!e||e==="_self")&&!KR(t)}var ku=null;function JR(){if(ku===null)try{new FormData(document.createElement("form"),0),ku=!1}catch{ku=!0}return ku}var ZR=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Fm(t){return t!=null&&!ZR.has(t)?(yr(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ud}"`),null):t}function eO(t,e){let n,s,a,l,c;if(YR(t)){let d=t.getAttribute("action");s=d?Kr(d,e):null,n=t.getAttribute("method")||cd,a=Fm(t.getAttribute("enctype"))||ud,l=new FormData(t)}else if(GR(t)||XR(t)&&(t.type==="submit"||t.type==="image")){let d=t.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=t.getAttribute("formaction")||d.getAttribute("action");if(s=f?Kr(f,e):null,n=t.getAttribute("formmethod")||d.getAttribute("method")||cd,a=Fm(t.getAttribute("formenctype"))||Fm(d.getAttribute("enctype"))||ud,l=new FormData(d,t),!JR()){let{name:h,type:p,value:m}=t;if(p==="image"){let y=h?`${h}.`:"";l.append(`${y}x`,"0"),l.append(`${y}y`,"0")}else h&&l.append(h,m)}}else{if(ef(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=cd,s=null,a=ud,c=t}return l&&a==="text/plain"&&(c=l,l=void 0),{action:s,method:n.toLowerCase(),encType:a,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function bg(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function tO(t,e,n){let s=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return s.pathname==="/"?s.pathname=`_root.${n}`:e&&Kr(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${n}`,s}async function nO(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function rO(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function sO(t,e,n){let s=await Promise.all(t.map(async a=>{let l=e.routes[a.route.id];if(l){let c=await nO(l,n);return c.links?c.links():[]}return[]}));return lO(s.flat(1).filter(rO).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function _b(t,e,n,s,a,l){let c=(f,h)=>n[h]?f.route.id!==n[h].route.id:!0,d=(f,h)=>n[h].pathname!==f.pathname||n[h].route.path?.endsWith("*")&&n[h].params["*"]!==f.params["*"];return l==="assets"?e.filter((f,h)=>c(f,h)||d(f,h)):l==="data"?e.filter((f,h)=>{let p=s.routes[f.route.id];if(!p||!p.hasLoader)return!1;if(c(f,h)||d(f,h))return!0;if(f.route.shouldRevalidate){let m=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function iO(t,e,{includeHydrateFallback:n}={}){return aO(t.map(s=>{let a=e.routes[s.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function aO(t){return[...new Set(t)]}function oO(t){let e={},n=Object.keys(t).sort();for(let s of n)e[s]=t[s];return e}function lO(t,e){let n=new Set;return new Set(e),t.reduce((s,a)=>{let l=JSON.stringify(oO(a));return n.has(l)||(n.add(l),s.push({key:l,link:a})),s},[])}function cA(){let t=k.useContext(Ka);return bg(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function cO(){let t=k.useContext(Zd);return bg(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var wg=k.createContext(void 0);wg.displayName="FrameworkContext";function uA(){let t=k.useContext(wg);return bg(t,"You must render this element inside a <HydratedRouter> element"),t}function uO(t,e){let n=k.useContext(wg),[s,a]=k.useState(!1),[l,c]=k.useState(!1),{onFocus:d,onBlur:f,onMouseEnter:h,onMouseLeave:p,onTouchStart:m}=e,y=k.useRef(null);k.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let w=S=>{S.forEach(T=>{c(T.isIntersecting)})},A=new IntersectionObserver(w,{threshold:.5});return y.current&&A.observe(y.current),()=>{A.disconnect()}}},[t]),k.useEffect(()=>{if(s){let w=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(w)}}},[s]);let _=()=>{a(!0)},x=()=>{a(!1),c(!1)};return n?t!=="intent"?[l,y,{}]:[l,y,{onFocus:Zo(d,_),onBlur:Zo(f,x),onMouseEnter:Zo(h,_),onMouseLeave:Zo(p,x),onTouchStart:Zo(m,_)}]:[!1,y,{}]}function Zo(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function dO({page:t,...e}){let{router:n}=cA(),s=k.useMemo(()=>Jx(n.routes,t,n.basename),[n.routes,t,n.basename]);return s?k.createElement(hO,{page:t,matches:s,...e}):null}function fO(t){let{manifest:e,routeModules:n}=uA(),[s,a]=k.useState([]);return k.useEffect(()=>{let l=!1;return sO(t,e,n).then(c=>{l||a(c)}),()=>{l=!0}},[t,e,n]),s}function hO({page:t,matches:e,...n}){let s=Oi(),{manifest:a,routeModules:l}=uA(),{basename:c}=cA(),{loaderData:d,matches:f}=cO(),h=k.useMemo(()=>_b(t,e,f,a,s,"data"),[t,e,f,a,s]),p=k.useMemo(()=>_b(t,e,f,a,s,"assets"),[t,e,f,a,s]),m=k.useMemo(()=>{if(t===s.pathname+s.search+s.hash)return[];let x=new Set,w=!1;if(e.forEach(S=>{let T=a.routes[S.route.id];!T||!T.hasLoader||(!h.some(E=>E.route.id===S.route.id)&&S.route.id in d&&l[S.route.id]?.shouldRevalidate||T.hasClientLoader?w=!0:x.add(S.route.id))}),x.size===0)return[];let A=tO(t,c,"data");return w&&x.size>0&&A.searchParams.set("_routes",e.filter(S=>x.has(S.route.id)).map(S=>S.route.id).join(",")),[A.pathname+A.search]},[c,d,s,a,h,e,t,l]),y=k.useMemo(()=>iO(p,a),[p,a]),_=fO(p);return k.createElement(k.Fragment,null,m.map(x=>k.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...n})),y.map(x=>k.createElement("link",{key:x,rel:"modulepreload",href:x,...n})),_.map(({key:x,link:w})=>k.createElement("link",{key:x,nonce:n.nonce,...w})))}function mO(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var dA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{dA&&(window.__reactRouterVersion="7.9.5")}catch{}function pO({basename:t,children:e,window:n}){let s=k.useRef();s.current==null&&(s.current=rR({window:n,v5Compat:!0}));let a=s.current,[l,c]=k.useState({action:a.action,location:a.location}),d=k.useCallback(f=>{k.startTransition(()=>c(f))},[c]);return k.useLayoutEffect(()=>a.listen(d),[a,d]),k.createElement(VR,{basename:t,children:e,location:l.location,navigationType:l.action,navigator:a})}var fA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ai=k.forwardRef(function({onClick:e,discover:n="render",prefetch:s="none",relative:a,reloadDocument:l,replace:c,state:d,target:f,to:h,preventScrollReset:p,viewTransition:m,...y},_){let{basename:x}=k.useContext(vr),w=typeof h=="string"&&fA.test(h),A,S=!1;if(typeof h=="string"&&w&&(A=h,dA))try{let P=new URL(window.location.href),G=h.startsWith("//")?new URL(P.protocol+h):new URL(h),V=Kr(G.pathname,x);G.origin===P.origin&&V!=null?h=V+G.search+G.hash:S=!0}catch{yr(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let T=OR(h,{relative:a}),[E,C,O]=uO(s,y),j=_O(h,{replace:c,state:d,target:f,preventScrollReset:p,relative:a,viewTransition:m});function I(P){e&&e(P),P.defaultPrevented||j(P)}let D=k.createElement("a",{...y,...O,href:A||T,onClick:S||l?e:I,ref:mO(_,C),target:f,"data-discover":!w&&n==="render"?"true":void 0});return E&&!w?k.createElement(k.Fragment,null,D,k.createElement(dO,{page:T})):D});Ai.displayName="Link";var gO=k.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:s="",end:a=!1,style:l,to:c,viewTransition:d,children:f,...h},p){let m=Jl(c,{relative:h.relative}),y=Oi(),_=k.useContext(Zd),{navigator:x,basename:w}=k.useContext(vr),A=_!=null&&EO(m)&&d===!0,S=x.encodeLocation?x.encodeLocation(m).pathname:m.pathname,T=y.pathname,E=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;n||(T=T.toLowerCase(),E=E?E.toLowerCase():null,S=S.toLowerCase()),E&&w&&(E=Kr(E,w)||E);const C=S!=="/"&&S.endsWith("/")?S.length-1:S.length;let O=T===S||!a&&T.startsWith(S)&&T.charAt(C)==="/",j=E!=null&&(E===S||!a&&E.startsWith(S)&&E.charAt(S.length)==="/"),I={isActive:O,isPending:j,isTransitioning:A},D=O?e:void 0,P;typeof s=="function"?P=s(I):P=[s,O?"active":null,j?"pending":null,A?"transitioning":null].filter(Boolean).join(" ");let G=typeof l=="function"?l(I):l;return k.createElement(Ai,{...h,"aria-current":D,className:P,ref:p,style:G,to:c,viewTransition:d},typeof f=="function"?f(I):f)});gO.displayName="NavLink";var yO=k.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:s,replace:a,state:l,method:c=cd,action:d,onSubmit:f,relative:h,preventScrollReset:p,viewTransition:m,...y},_)=>{let x=xO(),w=AO(d,{relative:h}),A=c.toLowerCase()==="get"?"get":"post",S=typeof d=="string"&&fA.test(d),T=E=>{if(f&&f(E),E.defaultPrevented)return;E.preventDefault();let C=E.nativeEvent.submitter,O=C?.getAttribute("formmethod")||c;x(C||E.currentTarget,{fetcherKey:e,method:O,navigate:n,replace:a,state:l,relative:h,preventScrollReset:p,viewTransition:m})};return k.createElement("form",{ref:_,method:A,action:w,onSubmit:s?f:T,...y,"data-discover":!S&&t==="render"?"true":void 0})});yO.displayName="Form";function vO(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function hA(t){let e=k.useContext(Ka);return yt(e,vO(t)),e}function _O(t,{target:e,replace:n,state:s,preventScrollReset:a,relative:l,viewTransition:c}={}){let d=Ps(),f=Oi(),h=Jl(t,{relative:l});return k.useCallback(p=>{if(WR(p,e)){p.preventDefault();let m=n!==void 0?n:Il(f)===Il(h);d(t,{replace:m,state:s,preventScrollReset:a,relative:l,viewTransition:c})}},[f,d,h,n,s,e,t,a,l,c])}var bO=0,wO=()=>`__${String(++bO)}__`;function xO(){let{router:t}=hA("useSubmit"),{basename:e}=k.useContext(vr),n=PR();return k.useCallback(async(s,a={})=>{let{action:l,method:c,encType:d,formData:f,body:h}=eO(s,e);if(a.navigate===!1){let p=a.fetcherKey||wO();await t.fetch(p,n,a.action||l,{preventScrollReset:a.preventScrollReset,formData:f,body:h,formMethod:a.method||c,formEncType:a.encType||d,flushSync:a.flushSync})}else await t.navigate(a.action||l,{preventScrollReset:a.preventScrollReset,formData:f,body:h,formMethod:a.method||c,formEncType:a.encType||d,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,e,n])}function AO(t,{relative:e}={}){let{basename:n}=k.useContext(vr),s=k.useContext(Zr);yt(s,"useFormAction must be used inside a RouteContext");let[a]=s.matches.slice(-1),l={...Jl(t||".",{relative:e})},c=Oi();if(t==null){l.search=c.search;let d=new URLSearchParams(l.search),f=d.getAll("index");if(f.some(p=>p==="")){d.delete("index"),f.filter(m=>m).forEach(m=>d.append("index",m));let p=d.toString();l.search=p?`?${p}`:""}}return(!t||t===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(l.pathname=l.pathname==="/"?n:Xr([n,l.pathname])),Il(l)}function EO(t,{relative:e}={}){let n=k.useContext(sA);yt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=hA("useViewTransitionState"),a=Jl(t,{relative:e});if(!n.isTransitioning)return!1;let l=Kr(n.currentLocation.pathname,s)||n.currentLocation.pathname,c=Kr(n.nextLocation.pathname,s)||n.nextLocation.pathname;return Cd(a.pathname,c)!=null||Cd(a.pathname,l)!=null}Wx();var Np=function(t,e){return Np=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(n[a]=s[a])},Np(t,e)};function mA(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Np(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Td=function(){return Td=Object.assign||function(e){for(var n,s=1,a=arguments.length;s<a;s++){n=arguments[s];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},Td.apply(this,arguments)};function Wa(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a])&&(n[s[a]]=t[s[a]]);return n}function pA(t,e,n,s){var a=arguments.length,l=a<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,n):s,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(t,e,n,s);else for(var d=t.length-1;d>=0;d--)(c=t[d])&&(l=(a<3?c(l):a>3?c(e,n,l):c(e,n))||l);return a>3&&l&&Object.defineProperty(e,n,l),l}function gA(t,e){return function(n,s){e(n,s,t)}}function yA(t,e,n,s,a,l){function c(S){if(S!==void 0&&typeof S!="function")throw new TypeError("Function expected");return S}for(var d=s.kind,f=d==="getter"?"get":d==="setter"?"set":"value",h=!e&&t?s.static?t:t.prototype:null,p=e||(h?Object.getOwnPropertyDescriptor(h,s.name):{}),m,y=!1,_=n.length-1;_>=0;_--){var x={};for(var w in s)x[w]=w==="access"?{}:s[w];for(var w in s.access)x.access[w]=s.access[w];x.addInitializer=function(S){if(y)throw new TypeError("Cannot add initializers after decoration has completed");l.push(c(S||null))};var A=(0,n[_])(d==="accessor"?{get:p.get,set:p.set}:p[f],x);if(d==="accessor"){if(A===void 0)continue;if(A===null||typeof A!="object")throw new TypeError("Object expected");(m=c(A.get))&&(p.get=m),(m=c(A.set))&&(p.set=m),(m=c(A.init))&&a.unshift(m)}else(m=c(A))&&(d==="field"?a.unshift(m):p[f]=m)}h&&Object.defineProperty(h,s.name,p),y=!0}function vA(t,e,n){for(var s=arguments.length>2,a=0;a<e.length;a++)n=s?e[a].call(t,n):e[a].call(t);return s?n:void 0}function _A(t){return typeof t=="symbol"?t:"".concat(t)}function bA(t,e,n){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:n?"".concat(n," ",e):e})}function wA(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Ce(t,e,n,s){function a(l){return l instanceof n?l:new n(function(c){c(l)})}return new(n||(n=Promise))(function(l,c){function d(p){try{h(s.next(p))}catch(m){c(m)}}function f(p){try{h(s.throw(p))}catch(m){c(m)}}function h(p){p.done?l(p.value):a(p.value).then(d,f)}h((s=s.apply(t,e||[])).next())})}function xA(t,e){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},s,a,l,c=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return c.next=d(0),c.throw=d(1),c.return=d(2),typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function d(h){return function(p){return f([h,p])}}function f(h){if(s)throw new TypeError("Generator is already executing.");for(;c&&(c=0,h[0]&&(n=0)),n;)try{if(s=1,a&&(l=h[0]&2?a.return:h[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,h[1])).done)return l;switch(a=0,l&&(h=[h[0]&2,l.value]),h[0]){case 0:case 1:l=h;break;case 4:return n.label++,{value:h[1],done:!1};case 5:n.label++,a=h[1],h=[0];continue;case 7:h=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(h[0]===6||h[0]===2)){n=0;continue}if(h[0]===3&&(!l||h[1]>l[0]&&h[1]<l[3])){n.label=h[1];break}if(h[0]===6&&n.label<l[1]){n.label=l[1],l=h;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(h);break}l[2]&&n.ops.pop(),n.trys.pop();continue}h=e.call(t,n)}catch(p){h=[6,p],a=0}finally{s=l=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}var tf=Object.create?(function(t,e,n,s){s===void 0&&(s=n);var a=Object.getOwnPropertyDescriptor(e,n);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,s,a)}):(function(t,e,n,s){s===void 0&&(s=n),t[s]=e[n]});function AA(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&tf(e,t,n)}function Nd(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],s=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&s>=t.length&&(t=void 0),{value:t&&t[s++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function xg(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var s=n.call(t),a,l=[],c;try{for(;(e===void 0||e-- >0)&&!(a=s.next()).done;)l.push(a.value)}catch(d){c={error:d}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(c)throw c.error}}return l}function EA(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(xg(arguments[e]));return t}function SA(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var s=Array(t),a=0,e=0;e<n;e++)for(var l=arguments[e],c=0,d=l.length;c<d;c++,a++)s[a]=l[c];return s}function CA(t,e,n){if(n||arguments.length===2)for(var s=0,a=e.length,l;s<a;s++)(l||!(s in e))&&(l||(l=Array.prototype.slice.call(e,0,s)),l[s]=e[s]);return t.concat(l||Array.prototype.slice.call(e))}function Pa(t){return this instanceof Pa?(this.v=t,this):new Pa(t)}function TA(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=n.apply(t,e||[]),a,l=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",c),a[Symbol.asyncIterator]=function(){return this},a;function c(_){return function(x){return Promise.resolve(x).then(_,m)}}function d(_,x){s[_]&&(a[_]=function(w){return new Promise(function(A,S){l.push([_,w,A,S])>1||f(_,w)})},x&&(a[_]=x(a[_])))}function f(_,x){try{h(s[_](x))}catch(w){y(l[0][3],w)}}function h(_){_.value instanceof Pa?Promise.resolve(_.value.v).then(p,m):y(l[0][2],_)}function p(_){f("next",_)}function m(_){f("throw",_)}function y(_,x){_(x),l.shift(),l.length&&f(l[0][0],l[0][1])}}function NA(t){var e,n;return e={},s("next"),s("throw",function(a){throw a}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(a,l){e[a]=t[a]?function(c){return(n=!n)?{value:Pa(t[a](c)),done:!1}:l?l(c):c}:l}}function RA(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Nd=="function"?Nd(t):t[Symbol.iterator](),n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n);function s(l){n[l]=t[l]&&function(c){return new Promise(function(d,f){c=t[l](c),a(d,f,c.done,c.value)})}}function a(l,c,d,f){Promise.resolve(f).then(function(h){l({value:h,done:d})},c)}}function OA(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var SO=Object.create?(function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}):function(t,e){t.default=e},Rp=function(t){return Rp=Object.getOwnPropertyNames||function(e){var n=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(n[n.length]=s);return n},Rp(t)};function jA(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n=Rp(t),s=0;s<n.length;s++)n[s]!=="default"&&tf(e,t,n[s]);return SO(e,t),e}function IA(t){return t&&t.__esModule?t:{default:t}}function kA(t,e,n,s){if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?s:n==="a"?s.call(t):s?s.value:e.get(t)}function MA(t,e,n,s,a){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?a.call(t,n):a?a.value=n:e.set(t,n),n}function DA(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function BA(t,e,n){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var s,a;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=e[Symbol.asyncDispose]}if(s===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=e[Symbol.dispose],n&&(a=s)}if(typeof s!="function")throw new TypeError("Object not disposable.");a&&(s=function(){try{a.call(this)}catch(l){return Promise.reject(l)}}),t.stack.push({value:e,dispose:s,async:n})}else n&&t.stack.push({async:!0});return e}var CO=typeof SuppressedError=="function"?SuppressedError:function(t,e,n){var s=new Error(n);return s.name="SuppressedError",s.error=t,s.suppressed=e,s};function UA(t){function e(l){t.error=t.hasError?new CO(l,t.error,"An error was suppressed during disposal."):l,t.hasError=!0}var n,s=0;function a(){for(;n=t.stack.pop();)try{if(!n.async&&s===1)return s=0,t.stack.push(n),Promise.resolve().then(a);if(n.dispose){var l=n.dispose.call(n.value);if(n.async)return s|=2,Promise.resolve(l).then(a,function(c){return e(c),a()})}else s|=1}catch(c){e(c)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return a()}function LA(t,e){return typeof t=="string"&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(n,s,a,l,c){return s?e?".jsx":".js":a&&(!l||!c)?n:a+l+"."+c.toLowerCase()+"js"}):t}const TO={__extends:mA,__assign:Td,__rest:Wa,__decorate:pA,__param:gA,__esDecorate:yA,__runInitializers:vA,__propKey:_A,__setFunctionName:bA,__metadata:wA,__awaiter:Ce,__generator:xA,__createBinding:tf,__exportStar:AA,__values:Nd,__read:xg,__spread:EA,__spreadArrays:SA,__spreadArray:CA,__await:Pa,__asyncGenerator:TA,__asyncDelegator:NA,__asyncValues:RA,__makeTemplateObject:OA,__importStar:jA,__importDefault:IA,__classPrivateFieldGet:kA,__classPrivateFieldSet:MA,__classPrivateFieldIn:DA,__addDisposableResource:BA,__disposeResources:UA,__rewriteRelativeImportExtension:LA},NO=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:BA,get __assign(){return Td},__asyncDelegator:NA,__asyncGenerator:TA,__asyncValues:RA,__await:Pa,__awaiter:Ce,__classPrivateFieldGet:kA,__classPrivateFieldIn:DA,__classPrivateFieldSet:MA,__createBinding:tf,__decorate:pA,__disposeResources:UA,__esDecorate:yA,__exportStar:AA,__extends:mA,__generator:xA,__importDefault:IA,__importStar:jA,__makeTemplateObject:OA,__metadata:wA,__param:gA,__propKey:_A,__read:xg,__rest:Wa,__rewriteRelativeImportExtension:LA,__runInitializers:vA,__setFunctionName:bA,__spread:EA,__spreadArray:CA,__spreadArrays:SA,__values:Nd,default:TO},Symbol.toStringTag,{value:"Module"})),RO=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Ag extends Error{constructor(e,n="FunctionsError",s){super(e),this.name=n,this.context=s}}class bb extends Ag{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class wb extends Ag{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class xb extends Ag{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Op;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Op||(Op={}));class OO{constructor(e,{headers:n={},customFetch:s,region:a=Op.Any}={}){this.url=e,this.headers=n,this.region=a,this.fetch=RO(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Ce(this,arguments,void 0,function*(n,s={}){var a;try{const{headers:l,method:c,body:d,signal:f}=s;let h={},{region:p}=s;p||(p=this.region);const m=new URL(`${this.url}/${n}`);p&&p!=="any"&&(h["x-region"]=p,m.searchParams.set("forceFunctionRegion",p));let y;d&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",y=d):typeof d=="string"?(h["Content-Type"]="text/plain",y=d):typeof FormData<"u"&&d instanceof FormData?y=d:(h["Content-Type"]="application/json",y=JSON.stringify(d)):y=d;const _=yield this.fetch(m.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),l),body:y,signal:f}).catch(S=>{throw S.name==="AbortError"?S:new bb(S)}),x=_.headers.get("x-relay-error");if(x&&x==="true")throw new wb(_);if(!_.ok)throw new xb(_);let w=((a=_.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),A;return w==="application/json"?A=yield _.json():w==="application/octet-stream"||w==="application/pdf"?A=yield _.blob():w==="text/event-stream"?A=_:w==="multipart/form-data"?A=yield _.formData():A=yield _.text(),{data:A,error:null,response:_}}catch(l){return l instanceof Error&&l.name==="AbortError"?{data:null,error:new bb(l)}:{data:null,error:l,response:l instanceof xb||l instanceof wb?l.context:void 0}}})}}var Wt={};const Ja=Kx(NO);var Mu={},Du={},Bu={},Uu={},Lu={},$u={},Ab;function $A(){if(Ab)return $u;Ab=1,Object.defineProperty($u,"__esModule",{value:!0});class t extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return $u.default=t,$u}var Eb;function zA(){if(Eb)return Lu;Eb=1,Object.defineProperty(Lu,"__esModule",{value:!0});const e=Ja.__importDefault($A());class n{constructor(a){var l,c;this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=new Headers(a.headers),this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=(l=a.shouldThrowOnError)!==null&&l!==void 0?l:!1,this.signal=a.signal,this.isMaybeSingle=(c=a.isMaybeSingle)!==null&&c!==void 0?c:!1,a.fetch?this.fetch=a.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,l){return this.headers=new Headers(this.headers),this.headers.set(a,l),this}then(a,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const c=this.fetch;let d=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async f=>{var h,p,m,y;let _=null,x=null,w=null,A=f.status,S=f.statusText;if(f.ok){if(this.method!=="HEAD"){const O=await f.text();O===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((h=this.headers.get("Accept"))===null||h===void 0)&&h.includes("application/vnd.pgrst.plan+text"))?x=O:x=JSON.parse(O))}const E=(p=this.headers.get("Prefer"))===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),C=(m=f.headers.get("content-range"))===null||m===void 0?void 0:m.split("/");E&&C&&C.length>1&&(w=parseInt(C[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(x)&&(x.length>1?(_={code:"PGRST116",details:`Results contain ${x.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},x=null,w=null,A=406,S="Not Acceptable"):x.length===1?x=x[0]:x=null)}else{const E=await f.text();try{_=JSON.parse(E),Array.isArray(_)&&f.status===404&&(x=[],_=null,A=200,S="OK")}catch{f.status===404&&E===""?(A=204,S="No Content"):_={message:E}}if(_&&this.isMaybeSingle&&(!((y=_?.details)===null||y===void 0)&&y.includes("0 rows"))&&(_=null,A=200,S="OK"),_&&this.shouldThrowOnError)throw new e.default(_)}return{error:_,data:x,count:w,status:A,statusText:S}});return this.shouldThrowOnError||(d=d.catch(f=>{var h,p,m;return{error:{message:`${(h=f?.name)!==null&&h!==void 0?h:"FetchError"}: ${f?.message}`,details:`${(p=f?.stack)!==null&&p!==void 0?p:""}`,hint:"",code:`${(m=f?.code)!==null&&m!==void 0?m:""}`},data:null,count:null,status:0,statusText:""}})),d.then(a,l)}returns(){return this}overrideTypes(){return this}}return Lu.default=n,Lu}var Sb;function PA(){if(Sb)return Uu;Sb=1,Object.defineProperty(Uu,"__esModule",{value:!0});const e=Ja.__importDefault(zA());class n extends e.default{select(a){let l=!1;const c=(a??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:l=!0,nullsFirst:c,foreignTable:d,referencedTable:f=d}={}){const h=f?`${f}.order`:"order",p=this.url.searchParams.get(h);return this.url.searchParams.set(h,`${p?`${p},`:""}${a}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:l,referencedTable:c=l}={}){const d=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${a}`),this}range(a,l,{foreignTable:c,referencedTable:d=c}={}){const f=typeof d>"u"?"offset":`${d}.offset`,h=typeof d>"u"?"limit":`${d}.limit`;return this.url.searchParams.set(f,`${a}`),this.url.searchParams.set(h,`${l-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:l=!1,settings:c=!1,buffers:d=!1,wal:f=!1,format:h="text"}={}){var p;const m=[a?"analyze":null,l?"verbose":null,c?"settings":null,d?"buffers":null,f?"wal":null].filter(Boolean).join("|"),y=(p=this.headers.get("Accept"))!==null&&p!==void 0?p:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${h}; for="${y}"; options=${m};`),h==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}}return Uu.default=n,Uu}var Cb;function Eg(){if(Cb)return Bu;Cb=1,Object.defineProperty(Bu,"__esModule",{value:!0});const e=Ja.__importDefault(PA()),n=new RegExp("[,()]");class s extends e.default{eq(l,c){return this.url.searchParams.append(l,`eq.${c}`),this}neq(l,c){return this.url.searchParams.append(l,`neq.${c}`),this}gt(l,c){return this.url.searchParams.append(l,`gt.${c}`),this}gte(l,c){return this.url.searchParams.append(l,`gte.${c}`),this}lt(l,c){return this.url.searchParams.append(l,`lt.${c}`),this}lte(l,c){return this.url.searchParams.append(l,`lte.${c}`),this}like(l,c){return this.url.searchParams.append(l,`like.${c}`),this}likeAllOf(l,c){return this.url.searchParams.append(l,`like(all).{${c.join(",")}}`),this}likeAnyOf(l,c){return this.url.searchParams.append(l,`like(any).{${c.join(",")}}`),this}ilike(l,c){return this.url.searchParams.append(l,`ilike.${c}`),this}ilikeAllOf(l,c){return this.url.searchParams.append(l,`ilike(all).{${c.join(",")}}`),this}ilikeAnyOf(l,c){return this.url.searchParams.append(l,`ilike(any).{${c.join(",")}}`),this}is(l,c){return this.url.searchParams.append(l,`is.${c}`),this}in(l,c){const d=Array.from(new Set(c)).map(f=>typeof f=="string"&&n.test(f)?`"${f}"`:`${f}`).join(",");return this.url.searchParams.append(l,`in.(${d})`),this}contains(l,c){return typeof c=="string"?this.url.searchParams.append(l,`cs.${c}`):Array.isArray(c)?this.url.searchParams.append(l,`cs.{${c.join(",")}}`):this.url.searchParams.append(l,`cs.${JSON.stringify(c)}`),this}containedBy(l,c){return typeof c=="string"?this.url.searchParams.append(l,`cd.${c}`):Array.isArray(c)?this.url.searchParams.append(l,`cd.{${c.join(",")}}`):this.url.searchParams.append(l,`cd.${JSON.stringify(c)}`),this}rangeGt(l,c){return this.url.searchParams.append(l,`sr.${c}`),this}rangeGte(l,c){return this.url.searchParams.append(l,`nxl.${c}`),this}rangeLt(l,c){return this.url.searchParams.append(l,`sl.${c}`),this}rangeLte(l,c){return this.url.searchParams.append(l,`nxr.${c}`),this}rangeAdjacent(l,c){return this.url.searchParams.append(l,`adj.${c}`),this}overlaps(l,c){return typeof c=="string"?this.url.searchParams.append(l,`ov.${c}`):this.url.searchParams.append(l,`ov.{${c.join(",")}}`),this}textSearch(l,c,{config:d,type:f}={}){let h="";f==="plain"?h="pl":f==="phrase"?h="ph":f==="websearch"&&(h="w");const p=d===void 0?"":`(${d})`;return this.url.searchParams.append(l,`${h}fts${p}.${c}`),this}match(l){return Object.entries(l).forEach(([c,d])=>{this.url.searchParams.append(c,`eq.${d}`)}),this}not(l,c,d){return this.url.searchParams.append(l,`not.${c}.${d}`),this}or(l,{foreignTable:c,referencedTable:d=c}={}){const f=d?`${d}.or`:"or";return this.url.searchParams.append(f,`(${l})`),this}filter(l,c,d){return this.url.searchParams.append(l,`${c}.${d}`),this}}return Bu.default=s,Bu}var Tb;function HA(){if(Tb)return Du;Tb=1,Object.defineProperty(Du,"__esModule",{value:!0});const e=Ja.__importDefault(Eg());class n{constructor(a,{headers:l={},schema:c,fetch:d}){this.url=a,this.headers=new Headers(l),this.schema=c,this.fetch=d}select(a,l){const{head:c=!1,count:d}=l??{},f=c?"HEAD":"GET";let h=!1;const p=(a??"*").split("").map(m=>/\s/.test(m)&&!h?"":(m==='"'&&(h=!h),m)).join("");return this.url.searchParams.set("select",p),d&&this.headers.append("Prefer",`count=${d}`),new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:l,defaultToNull:c=!0}={}){var d;const f="POST";if(l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const h=a.reduce((p,m)=>p.concat(Object.keys(m)),[]);if(h.length>0){const p=[...new Set(h)].map(m=>`"${m}"`);this.url.searchParams.set("columns",p.join(","))}}return new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}upsert(a,{onConflict:l,ignoreDuplicates:c=!1,count:d,defaultToNull:f=!0}={}){var h;const p="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),d&&this.headers.append("Prefer",`count=${d}`),f||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const m=a.reduce((y,_)=>y.concat(Object.keys(_)),[]);if(m.length>0){const y=[...new Set(m)].map(_=>`"${_}"`);this.url.searchParams.set("columns",y.join(","))}}return new e.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}update(a,{count:l}={}){var c;const d="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:a}={}){var l;const c="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return Du.default=n,Du}var Nb;function jO(){if(Nb)return Mu;Nb=1,Object.defineProperty(Mu,"__esModule",{value:!0});const t=Ja,e=t.__importDefault(HA()),n=t.__importDefault(Eg());class s{constructor(l,{headers:c={},schema:d,fetch:f}={}){this.url=l,this.headers=new Headers(c),this.schemaName=d,this.fetch=f}from(l){const c=new URL(`${this.url}/${l}`);return new e.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new s(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:d=!1,get:f=!1,count:h}={}){var p;let m;const y=new URL(`${this.url}/rpc/${l}`);let _;d||f?(m=d?"HEAD":"GET",Object.entries(c).filter(([w,A])=>A!==void 0).map(([w,A])=>[w,Array.isArray(A)?`{${A.join(",")}}`:`${A}`]).forEach(([w,A])=>{y.searchParams.append(w,A)})):(m="POST",_=c);const x=new Headers(this.headers);return h&&x.set("Prefer",`count=${h}`),new n.default({method:m,url:y,headers:x,schema:this.schemaName,body:_,fetch:(p=this.fetch)!==null&&p!==void 0?p:fetch})}}return Mu.default=s,Mu}var Rb;function IO(){if(Rb)return Wt;Rb=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.PostgrestError=Wt.PostgrestBuilder=Wt.PostgrestTransformBuilder=Wt.PostgrestFilterBuilder=Wt.PostgrestQueryBuilder=Wt.PostgrestClient=void 0;const t=Ja,e=t.__importDefault(jO());Wt.PostgrestClient=e.default;const n=t.__importDefault(HA());Wt.PostgrestQueryBuilder=n.default;const s=t.__importDefault(Eg());Wt.PostgrestFilterBuilder=s.default;const a=t.__importDefault(PA());Wt.PostgrestTransformBuilder=a.default;const l=t.__importDefault(zA());Wt.PostgrestBuilder=l.default;const c=t.__importDefault($A());return Wt.PostgrestError=c.default,Wt.default={PostgrestClient:e.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:l.default,PostgrestError:c.default},Wt}var qA=IO();const QA=Yl(qA),kO=FN({__proto__:null,default:QA},[qA]),{PostgrestClient:MO,PostgrestQueryBuilder:Ez,PostgrestFilterBuilder:Sz,PostgrestTransformBuilder:Cz,PostgrestBuilder:Tz,PostgrestError:Nz}=QA||kO;class DO{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const s=n.node,a=parseInt(s.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const s=this.getWebSocketConstructor();return new s(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const BO="2.79.0",UO=`realtime-js/${BO}`,LO="1.0.0",jp=1e4,$O=1e3,zO=100;var Al;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Al||(Al={}));var Mt;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Mt||(Mt={}));var er;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(er||(er={}));var Ip;(function(t){t.websocket="websocket"})(Ip||(Ip={}));var pi;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(pi||(pi={}));class PO{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,n,s)}_decodeBroadcast(e,n,s){const a=n.getUint8(1),l=n.getUint8(2);let c=this.HEADER_LENGTH+2;const d=s.decode(e.slice(c,c+a));c=c+a;const f=s.decode(e.slice(c,c+l));c=c+l;const h=JSON.parse(s.decode(e.slice(c,e.byteLength)));return{ref:null,topic:d,event:f,payload:h}}}let VA=class{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var ot;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(ot||(ot={}));const Ob=(t,e,n={})=>{var s;const a=(s=n.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((l,c)=>(l[c]=HO(c,t,e,a),l),{}):{}},HO=(t,e,n,s)=>{const a=e.find(d=>d.name===t),l=a?.type,c=n[t];return l&&!s.includes(l)?FA(l,c):kp(c)},FA=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return FO(e,n)}switch(t){case ot.bool:return qO(e);case ot.float4:case ot.float8:case ot.int2:case ot.int4:case ot.int8:case ot.numeric:case ot.oid:return QO(e);case ot.json:case ot.jsonb:return VO(e);case ot.timestamp:return GO(e);case ot.abstime:case ot.date:case ot.daterange:case ot.int4range:case ot.int8range:case ot.money:case ot.reltime:case ot.text:case ot.time:case ot.timestamptz:case ot.timetz:case ot.tsrange:case ot.tstzrange:return kp(e);default:return kp(e)}},kp=t=>t,qO=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},QO=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},VO=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},FO=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,s=t[n];if(t[0]==="{"&&s==="}"){let l;const c=t.slice(1,n);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(d=>FA(e,d))}return t},GO=t=>typeof t=="string"?t.replace(" ","T"):t,GA=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Gm{constructor(e,n,s={},a=jp){this.channel=e,this.event=n,this.payload=s,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var s;return this._hasReceived(e)&&n((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var jb;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(jb||(jb={}));class El{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=n?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},a=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=El.syncState(this.state,a,l,c),this.pendingDiffs.forEach(f=>{this.state=El.syncDiff(this.state,f,l,c)}),this.pendingDiffs=[],d()}),this.channel._on(s.diff,{},a=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=El.syncDiff(this.state,a,l,c),d())}),this.onJoin((a,l,c)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:l,newPresences:c})}),this.onLeave((a,l,c)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,s,a){const l=this.cloneDeep(e),c=this.transformState(n),d={},f={};return this.map(l,(h,p)=>{c[h]||(f[h]=p)}),this.map(c,(h,p)=>{const m=l[h];if(m){const y=p.map(A=>A.presence_ref),_=m.map(A=>A.presence_ref),x=p.filter(A=>_.indexOf(A.presence_ref)<0),w=m.filter(A=>y.indexOf(A.presence_ref)<0);x.length>0&&(d[h]=x),w.length>0&&(f[h]=w)}else d[h]=p}),this.syncDiff(l,{joins:d,leaves:f},s,a)}static syncDiff(e,n,s,a){const{joins:l,leaves:c}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return s||(s=()=>{}),a||(a=()=>{}),this.map(l,(d,f)=>{var h;const p=(h=e[d])!==null&&h!==void 0?h:[];if(e[d]=this.cloneDeep(f),p.length>0){const m=e[d].map(_=>_.presence_ref),y=p.filter(_=>m.indexOf(_.presence_ref)<0);e[d].unshift(...y)}s(d,p,f)}),this.map(c,(d,f)=>{let h=e[d];if(!h)return;const p=f.map(m=>m.presence_ref);h=h.filter(m=>p.indexOf(m.presence_ref)<0),e[d]=h,a(d,h,f),h.length===0&&delete e[d]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(s=>n(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,s)=>{const a=e[s];return"metas"in a?n[s]=a.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):n[s]=a,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ib;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Ib||(Ib={}));var Sl;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Sl||(Sl={}));var Gr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Gr||(Gr={}));class Sg{constructor(e,n={config:{}},s){var a,l;if(this.topic=e,this.params=n,this.socket=s,this.bindings={},this.state=Mt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Gm(this,er.join,this.params,this.timeout),this.rejoinTimer=new VA(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Mt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Mt.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=Mt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Mt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=Mt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(er.reply,{},(c,d)=>{this._trigger(this._replyEventName(d),c)}),this.presence=new El(this),this.broadcastEndpointURL=GA(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,n=this.timeout){var s,a,l;if(this.socket.isConnected()||this.socket.connect(),this.state==Mt.closed){const{config:{broadcast:c,presence:d,private:f}}=this.params,h=(a=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(_=>_.filter))!==null&&a!==void 0?a:[],p=!!this.bindings[Sl.PRESENCE]&&this.bindings[Sl.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,m={},y={broadcast:c,presence:Object.assign(Object.assign({},d),{enabled:p}),postgres_changes:h,private:f};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(_=>e?.(Gr.CHANNEL_ERROR,_)),this._onClose(()=>e?.(Gr.CLOSED)),this.updateJoinPayload(Object.assign({config:y},m)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:_})=>{var x;if(this.socket.setAuth(),_===void 0){e?.(Gr.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,A=(x=w?.length)!==null&&x!==void 0?x:0,S=[];for(let T=0;T<A;T++){const E=w[T],{filter:{event:C,schema:O,table:j,filter:I}}=E,D=_&&_[T];if(D&&D.event===C&&D.schema===O&&D.table===j&&D.filter===I)S.push(Object.assign(Object.assign({},E),{id:D.id}));else{this.unsubscribe(),this.state=Mt.errored,e?.(Gr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=S,e&&e(Gr.SUBSCRIBED);return}}).receive("error",_=>{this.state=Mt.errored,e?.(Gr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(_).join(", ")||"error")))}).receive("timeout",()=>{e?.(Gr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,s){return this.state===Mt.joined&&e===Sl.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,n,s)}async httpSend(e,n,s={}){var a;const l=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(n==null)return Promise.reject("Payload is required for httpSend()");const c={method:"POST",headers:{Authorization:l,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:n,private:this.private}]})},d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(a=s.timeout)!==null&&a!==void 0?a:this.timeout);if(d.status===202)return{success:!0};let f=d.statusText;try{const h=await d.json();f=h.error||h.message||f}catch{}return Promise.reject(new Error(f))}async send(e,n={}){var s,a;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:c}=e,f={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);return await((a=h.body)===null||a===void 0?void 0:a.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,d,f;const h=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((f=(d=(c=this.params)===null||c===void 0?void 0:c.config)===null||d===void 0?void 0:d.broadcast)===null||f===void 0)&&f.ack)&&l("ok"),h.receive("ok",()=>l("ok")),h.receive("error",()=>l("error")),h.receive("timeout",()=>l("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Mt.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(er.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(a=>{s=new Gm(this,er.leave,{},e),s.receive("ok",()=>{n(),a("ok")}).receive("timeout",()=>{n(),a("timed out")}).receive("error",()=>{a("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Mt.closed,this.bindings={}}async _fetchWithTimeout(e,n,s){const a=new AbortController,l=setTimeout(()=>a.abort(),s),c=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:a.signal}));return clearTimeout(l),c}_push(e,n,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Gm(this,e,n,s);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>zO){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,s){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,s){var a,l;const c=e.toLocaleLowerCase(),{close:d,error:f,leave:h,join:p}=er;if(s&&[d,f,h,p].indexOf(c)>=0&&s!==this._joinRef())return;let y=this._onMessage(c,n,s);if(n&&!y)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(_=>{var x,w,A;return((x=_.filter)===null||x===void 0?void 0:x.event)==="*"||((A=(w=_.filter)===null||w===void 0?void 0:w.event)===null||A===void 0?void 0:A.toLocaleLowerCase())===c}).map(_=>_.callback(y,s)):(l=this.bindings[c])===null||l===void 0||l.filter(_=>{var x,w,A,S,T,E;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in _){const C=_.id,O=(x=_.filter)===null||x===void 0?void 0:x.event;return C&&((w=n.ids)===null||w===void 0?void 0:w.includes(C))&&(O==="*"||O?.toLocaleLowerCase()===((A=n.data)===null||A===void 0?void 0:A.type.toLocaleLowerCase()))}else{const C=(T=(S=_?.filter)===null||S===void 0?void 0:S.event)===null||T===void 0?void 0:T.toLocaleLowerCase();return C==="*"||C===((E=n?.event)===null||E===void 0?void 0:E.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===c}).map(_=>{if(typeof y=="object"&&"ids"in y){const x=y.data,{schema:w,table:A,commit_timestamp:S,type:T,errors:E}=x;y=Object.assign(Object.assign({},{schema:w,table:A,commit_timestamp:S,eventType:T,new:{},old:{},errors:E}),this._getPayloadRecords(x))}_.callback(y,s)})}_isClosed(){return this.state===Mt.closed}_isJoined(){return this.state===Mt.joined}_isJoining(){return this.state===Mt.joining}_isLeaving(){return this.state===Mt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,s){const a=e.toLocaleLowerCase(),l={type:a,filter:n,callback:s};return this.bindings[a]?this.bindings[a].push(l):this.bindings[a]=[l],this}_off(e,n){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(a=>{var l;return!(((l=a.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===s&&Sg.isEqual(a.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const s in e)if(e[s]!==n[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(er.close,{},e)}_onError(e){this._on(er.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Mt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Ob(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Ob(e.columns,e.old_record)),n}}const Ym=()=>{},zu={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},YO=[1e3,2e3,5e3,1e4],XO=1e4,KO=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class WO{constructor(e,n){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=jp,this.transport=null,this.heartbeatIntervalMs=zu.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ym,this.ref=0,this.reconnectTimer=null,this.logger=Ym,this.conn=null,this.sendBuffer=[],this.serializer=new PO,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>a?(...l)=>a(...l):(...l)=>fetch(...l),!(!((s=n?.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${Ip.websocket}`,this.httpEndpoint=GA(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=DO.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:LO}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},e?this.conn.close(e,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,s){this.logger(e,n,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Al.connecting:return pi.Connecting;case Al.open:return pi.Open;case Al.closing:return pi.Closing;default:return pi.Closed}}isConnected(){return this.connectionState()===pi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const s=`realtime:${e}`,a=this.getChannels().find(l=>l.topic===s);if(a)return a;{const l=new Sg(`realtime:${e}`,n,this);return this.channels.push(l),l}}push(e){const{topic:n,event:s,payload:a,ref:l}=e,c=()=>{this.encode(e,d=>{var f;(f=this.conn)===null||f===void 0||f.send(d)})};this.log("push",`${n} ${s} (${l})`,a),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close($O,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},zu.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(h){this.log("error","error in heartbeat callback",h)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:a,payload:l,ref:c}=n,d=c?`(${c})`:"",f=l.status||"";this.log("receive",`${f} ${s} ${a} ${d}`.trim(),l),this.channels.filter(h=>h._isMember(s)).forEach(h=>h._trigger(a,l,c)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(er.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const s=e.match(/\?/)?"&":"?",a=new URLSearchParams(n);return`${e}${s}${a}`}_workerObjectUrl(e){let n;if(e)n=e;else{const s=new Blob([KO],{type:"application/javascript"});n=URL.createObjectURL(s)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n;e?n=e:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(s=>{const a={access_token:n,version:UO};n&&s.updateJoinPayload(a),s.joinedOnce&&s._isJoined()&&s._push(er.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(n)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new VA(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},zu.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,s,a,l,c,d,f,h,p;if(this.transport=(n=e?.transport)!==null&&n!==void 0?n:null,this.timeout=(s=e?.timeout)!==null&&s!==void 0?s:jp,this.heartbeatIntervalMs=(a=e?.heartbeatIntervalMs)!==null&&a!==void 0?a:zu.HEARTBEAT_INTERVAL,this.worker=(l=e?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=e?.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(d=e?.heartbeatCallback)!==null&&d!==void 0?d:Ym,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=e?.reconnectAfterMs)!==null&&f!==void 0?f:(m=>YO[m-1]||XO),this.encode=(h=e?.encode)!==null&&h!==void 0?h:((m,y)=>y(JSON.stringify(m))),this.decode=(p=e?.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class Cg extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function gt(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class JO extends Cg{constructor(e,n,s){super(e),this.name="StorageApiError",this.status=n,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Mp extends Cg{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}const Tg=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),ZO=()=>Response,Dp=t=>{if(Array.isArray(t))return t.map(n=>Dp(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,s])=>{const a=n.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));e[a]=Dp(s)}),e},ej=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Xm=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},tj=(t,e,n)=>Ce(void 0,void 0,void 0,function*(){const s=yield ZO();t instanceof s&&!n?.noResolveJson?t.json().then(a=>{const l=t.status||500,c=a?.statusCode||l+"";e(new JO(Xm(a),l,c))}).catch(a=>{e(new Mp(Xm(a),a))}):e(new Mp(Xm(t),t))}),nj=(t,e,n,s)=>{const a={method:t,headers:e?.headers||{}};return t==="GET"||!s?a:(ej(s)?(a.headers=Object.assign({"Content-Type":"application/json"},e?.headers),a.body=JSON.stringify(s)):a.body=s,e?.duplex&&(a.duplex=e.duplex),Object.assign(Object.assign({},a),n))};function Zl(t,e,n,s,a,l){return Ce(this,void 0,void 0,function*(){return new Promise((c,d)=>{t(n,nj(e,s,a,l)).then(f=>{if(!f.ok)throw f;return s?.noResolveJson?f:f.json()}).then(f=>c(f)).catch(f=>tj(f,d,s))})})}function kl(t,e,n,s){return Ce(this,void 0,void 0,function*(){return Zl(t,"GET",e,n,s)})}function Jn(t,e,n,s,a){return Ce(this,void 0,void 0,function*(){return Zl(t,"POST",e,s,a,n)})}function Bp(t,e,n,s,a){return Ce(this,void 0,void 0,function*(){return Zl(t,"PUT",e,s,a,n)})}function rj(t,e,n,s){return Ce(this,void 0,void 0,function*(){return Zl(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),s)})}function Ng(t,e,n,s,a){return Ce(this,void 0,void 0,function*(){return Zl(t,"DELETE",e,s,a,n)})}class sj{constructor(e,n){this.downloadFn=e,this.shouldThrowOnError=n}then(e,n){return this.execute().then(e,n)}execute(){return Ce(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(gt(e))return{data:null,error:e};throw e}})}}var YA;class ij{constructor(e,n){this.downloadFn=e,this.shouldThrowOnError=n,this[YA]="BlobDownloadBuilder",this.promise=null}asStream(){return new sj(this.downloadFn,this.shouldThrowOnError)}then(e,n){return this.getPromise().then(e,n)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Ce(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(gt(e))return{data:null,error:e};throw e}})}}YA=Symbol.toStringTag;const aj={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},kb={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class oj{constructor(e,n={},s,a){this.shouldThrowOnError=!1,this.url=e,this.headers=n,this.bucketId=s,this.fetch=Tg(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,n,s,a){return Ce(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},kb),a);let d=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const f=c.metadata;typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),f&&l.append("metadata",this.encodeMetadata(f)),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.has("cacheControl")||l.append("cacheControl",c.cacheControl),f&&!l.has("metadata")&&l.append("metadata",this.encodeMetadata(f))):(l=s,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType,f&&(d["x-metadata"]=this.toBase64(this.encodeMetadata(f))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!c.duplex&&(c.duplex="half")),a?.headers&&(d=Object.assign(Object.assign({},d),a.headers));const h=this._removeEmptyFolders(n),p=this._getFinalPath(h),m=yield(e=="PUT"?Bp:Jn)(this.fetch,`${this.url}/object/${p}`,l,Object.assign({headers:d},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:h,id:m.Id,fullPath:m.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(gt(l))return{data:null,error:l};throw l}})}upload(e,n,s){return Ce(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,s)})}uploadToSignedUrl(e,n,s,a){return Ce(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(e),c=this._getFinalPath(l),d=new URL(this.url+`/object/upload/sign/${c}`);d.searchParams.set("token",n);try{let f;const h=Object.assign({upsert:kb.upsert},a),p=Object.assign(Object.assign({},this.headers),{"x-upsert":String(h.upsert)});typeof Blob<"u"&&s instanceof Blob?(f=new FormData,f.append("cacheControl",h.cacheControl),f.append("",s)):typeof FormData<"u"&&s instanceof FormData?(f=s,f.append("cacheControl",h.cacheControl)):(f=s,p["cache-control"]=`max-age=${h.cacheControl}`,p["content-type"]=h.contentType);const m=yield Bp(this.fetch,d.toString(),f,{headers:p});return{data:{path:l,fullPath:m.Key},error:null}}catch(f){if(this.shouldThrowOnError)throw f;if(gt(f))return{data:null,error:f};throw f}})}createSignedUploadUrl(e,n){return Ce(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const a=Object.assign({},this.headers);n?.upsert&&(a["x-upsert"]="true");const l=yield Jn(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:a}),c=new URL(this.url+l.url),d=c.searchParams.get("token");if(!d)throw new Cg("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:d},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(gt(s))return{data:null,error:s};throw s}})}update(e,n,s){return Ce(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,s)})}move(e,n,s){return Ce(this,void 0,void 0,function*(){try{return{data:yield Jn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:s?.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(gt(a))return{data:null,error:a};throw a}})}copy(e,n,s){return Ce(this,void 0,void 0,function*(){try{return{data:{path:(yield Jn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:s?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(gt(a))return{data:null,error:a};throw a}})}createSignedUrl(e,n,s){return Ce(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),l=yield Jn(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:n},s?.transform?{transform:s.transform}:{}),{headers:this.headers});const c=s?.download?`&download=${s.download===!0?"":s.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(gt(a))return{data:null,error:a};throw a}})}createSignedUrls(e,n,s){return Ce(this,void 0,void 0,function*(){try{const a=yield Jn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),l=s?.download?`&download=${s.download===!0?"":s.download}`:"";return{data:a.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(gt(a))return{data:null,error:a};throw a}})}download(e,n){const a=typeof n?.transform<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString(n?.transform||{}),c=l?`?${l}`:"",d=this._getFinalPath(e),f=()=>kl(this.fetch,`${this.url}/${a}/${d}${c}`,{headers:this.headers,noResolveJson:!0});return new ij(f,this.shouldThrowOnError)}info(e){return Ce(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const s=yield kl(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Dp(s),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(gt(s))return{data:null,error:s};throw s}})}exists(e){return Ce(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield rj(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(gt(s)&&s instanceof Mp){const a=s.originalError;if([400,404].includes(a?.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,n){const s=this._getFinalPath(e),a=[],l=n?.download?`download=${n.download===!0?"":n.download}`:"";l!==""&&a.push(l);const d=typeof n?.transform<"u"?"render/image":"object",f=this.transformOptsToQueryString(n?.transform||{});f!==""&&a.push(f);let h=a.join("&");return h!==""&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${s}${h}`)}}}remove(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield Ng(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}})}list(e,n,s){return Ce(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},aj),n),{prefix:e||""});return{data:yield Jn(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},s),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(gt(a))return{data:null,error:a};throw a}})}listV2(e,n){return Ce(this,void 0,void 0,function*(){try{const s=Object.assign({},e);return{data:yield Jn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(gt(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const XA="2.79.0",KA={"X-Client-Info":`storage-js/${XA}`};class lj{constructor(e,n={},s,a){this.shouldThrowOnError=!1;const l=new URL(e);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},KA),n),this.fetch=Tg(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return Ce(this,void 0,void 0,function*(){try{const n=this.listBucketOptionsToQueryString(e);return{data:yield kl(this.fetch,`${this.url}/bucket${n}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}})}getBucket(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield kl(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}})}createBucket(e){return Ce(this,arguments,void 0,function*(n,s={public:!1}){try{return{data:yield Jn(this.fetch,`${this.url}/bucket`,{id:n,name:n,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(gt(a))return{data:null,error:a};throw a}})}updateBucket(e,n){return Ce(this,void 0,void 0,function*(){try{return{data:yield Bp(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(gt(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield Jn(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield Ng(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}})}listBucketOptionsToQueryString(e){const n={};return e&&("limit"in e&&(n.limit=String(e.limit)),"offset"in e&&(n.offset=String(e.offset)),e.search&&(n.search=e.search),e.sortColumn&&(n.sortColumn=e.sortColumn),e.sortOrder&&(n.sortOrder=e.sortOrder)),Object.keys(n).length>0?"?"+new URLSearchParams(n).toString():""}}class cj{constructor(e,n={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},KA),n),this.fetch=Tg(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield Jn(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}})}listBuckets(e){return Ce(this,void 0,void 0,function*(){try{const n=new URLSearchParams;e?.limit!==void 0&&n.set("limit",e.limit.toString()),e?.offset!==void 0&&n.set("offset",e.offset.toString()),e?.sortColumn&&n.set("sortColumn",e.sortColumn),e?.sortOrder&&n.set("sortOrder",e.sortOrder),e?.search&&n.set("search",e.search);const s=n.toString(),a=s?`${this.url}/bucket?${s}`:`${this.url}/bucket`;return{data:yield kl(this.fetch,a,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield Ng(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}})}}const Rg={"X-Client-Info":`storage-js/${XA}`,"Content-Type":"application/json"};class WA extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Nn(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}class Km extends WA{constructor(e,n,s){super(e),this.name="StorageVectorsApiError",this.status=n,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class uj extends WA{constructor(e,n){super(e),this.name="StorageVectorsUnknownError",this.originalError=n}}var Mb;(function(t){t.InternalError="InternalError",t.S3VectorConflictException="S3VectorConflictException",t.S3VectorNotFoundException="S3VectorNotFoundException",t.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",t.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",t.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Mb||(Mb={}));const Og=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),dj=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Db=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),fj=(t,e,n)=>Ce(void 0,void 0,void 0,function*(){if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!n?.noResolveJson){const a=t.status||500,l=t;if(typeof l.json=="function")l.json().then(c=>{const d=c?.statusCode||c?.code||a+"";e(new Km(Db(c),a,d))}).catch(()=>{const c=a+"",d=l.statusText||`HTTP ${a} error`;e(new Km(d,a,c))});else{const c=a+"",d=l.statusText||`HTTP ${a} error`;e(new Km(d,a,c))}}else e(new uj(Db(t),t))}),hj=(t,e,n,s)=>{const a={method:t,headers:e?.headers||{}};return s?(dj(s)?(a.headers=Object.assign({"Content-Type":"application/json"},e?.headers),a.body=JSON.stringify(s)):a.body=s,Object.assign(Object.assign({},a),n)):a};function mj(t,e,n,s,a,l){return Ce(this,void 0,void 0,function*(){return new Promise((c,d)=>{t(n,hj(e,s,a,l)).then(f=>{if(!f.ok)throw f;if(s?.noResolveJson)return f;const h=f.headers.get("content-type");return!h||!h.includes("application/json")?{}:f.json()}).then(f=>c(f)).catch(f=>fj(f,d,s))})})}function Rn(t,e,n,s,a){return Ce(this,void 0,void 0,function*(){return mj(t,"POST",e,s,a,n)})}class pj{constructor(e,n={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Rg),n),this.fetch=Og(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return Ce(this,void 0,void 0,function*(){try{return{data:(yield Rn(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}getIndex(e,n){return Ce(this,void 0,void 0,function*(){try{return{data:yield Rn(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:n},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Nn(s))return{data:null,error:s};throw s}})}listIndexes(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield Rn(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}deleteIndex(e,n){return Ce(this,void 0,void 0,function*(){try{return{data:(yield Rn(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:n},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Nn(s))return{data:null,error:s};throw s}})}}class gj{constructor(e,n={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Rg),n),this.fetch=Og(s)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return Ce(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Rn(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}getVectors(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield Rn(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}listVectors(e){return Ce(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield Rn(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}queryVectors(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield Rn(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}deleteVectors(e){return Ce(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Rn(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}}class yj{constructor(e,n={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Rg),n),this.fetch=Og(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return Ce(this,void 0,void 0,function*(){try{return{data:(yield Rn(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}getBucket(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield Rn(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}listBuckets(){return Ce(this,arguments,void 0,function*(e={}){try{return{data:yield Rn(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Ce(this,void 0,void 0,function*(){try{return{data:(yield Rn(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nn(n))return{data:null,error:n};throw n}})}}class vj extends yj{constructor(e,n={}){super(e,n.headers||{},n.fetch)}from(e){return new _j(this.url,this.headers,e,this.fetch)}}class _j extends pj{constructor(e,n,s,a){super(e,n,a),this.vectorBucketName=s}createIndex(e){const n=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Ce(this,void 0,void 0,function*(){return n.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Ce(this,arguments,void 0,function*(n={}){return e.listIndexes.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const n=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Ce(this,void 0,void 0,function*(){return n.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const n=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Ce(this,void 0,void 0,function*(){return n.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new bj(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class bj extends gj{constructor(e,n,s,a,l){super(e,n,l),this.vectorBucketName=s,this.indexName=a}putVectors(e){const n=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Ce(this,void 0,void 0,function*(){return n.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const n=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Ce(this,void 0,void 0,function*(){return n.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Ce(this,arguments,void 0,function*(n={}){return e.listVectors.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const n=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Ce(this,void 0,void 0,function*(){return n.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const n=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Ce(this,void 0,void 0,function*(){return n.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class wj extends lj{constructor(e,n={},s,a){super(e,n,s,a)}from(e){return new oj(this.url,this.headers,e,this.fetch)}get vectors(){return new vj(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new cj(this.url+"/iceberg",this.headers,this.fetch)}}const xj="2.79.0";let ul="";typeof Deno<"u"?ul="deno":typeof document<"u"?ul="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ul="react-native":ul="node";const Aj={"X-Client-Info":`supabase-js-${ul}/${xj}`},Ej={headers:Aj},Sj={schema:"public"},Cj={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Tj={},Nj=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Rj=()=>Headers,Oj=(t,e,n)=>{const s=Nj(n),a=Rj();return async(l,c)=>{var d;const f=(d=await e())!==null&&d!==void 0?d:t;let h=new a(c?.headers);return h.has("apikey")||h.set("apikey",t),h.has("Authorization")||h.set("Authorization",`Bearer ${f}`),s(l,Object.assign(Object.assign({},c),{headers:h}))}};function jj(t){return t.endsWith("/")?t:t+"/"}function Ij(t,e){var n,s;const{db:a,auth:l,realtime:c,global:d}=t,{db:f,auth:h,realtime:p,global:m}=e,y={db:Object.assign(Object.assign({},f),a),auth:Object.assign(Object.assign({},h),l),realtime:Object.assign(Object.assign({},p),c),storage:{},global:Object.assign(Object.assign(Object.assign({},m),d),{headers:Object.assign(Object.assign({},(n=m?.headers)!==null&&n!==void 0?n:{}),(s=d?.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return t.accessToken?y.accessToken=t.accessToken:delete y.accessToken,y}function kj(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(jj(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const JA="2.79.0",Oa=30*1e3,Up=3,Wm=Up*Oa,Mj="http://localhost:9999",Dj="supabase.auth.token",Bj={"X-Client-Info":`gotrue-js/${JA}`},Lp="X-Supabase-Api-Version",ZA={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Uj=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Lj=600*1e3;class Ml extends Error{constructor(e,n,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=s}}function Re(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class $j extends Ml{constructor(e,n,s){super(e,n,s),this.name="AuthApiError",this.status=n,this.code=s}}function zj(t){return Re(t)&&t.name==="AuthApiError"}class gi extends Ml{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Hs extends Ml{constructor(e,n,s,a){super(e,s,a),this.name=n,this.status=s}}class Kn extends Hs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Pj(t){return Re(t)&&t.name==="AuthSessionMissingError"}class ba extends Hs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Pu extends Hs{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Hu extends Hs{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Hj(t){return Re(t)&&t.name==="AuthImplicitGrantRedirectError"}class Bb extends Hs{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class $p extends Hs{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Jm(t){return Re(t)&&t.name==="AuthRetryableFetchError"}class Ub extends Hs{constructor(e,n,s){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=s}}class zp extends Hs{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Rd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Lb=` 	
\r=`.split(""),qj=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Lb.length;e+=1)t[Lb[e].charCodeAt(0)]=-2;for(let e=0;e<Rd.length;e+=1)t[Rd[e].charCodeAt(0)]=e;return t})();function $b(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(Rd[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(Rd[s]),e.queuedBits-=6}}function eE(t,e,n){const s=qj[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function zb(t){const e=[],n=c=>{e.push(String.fromCodePoint(c))},s={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},l=c=>{Fj(c,s,n)};for(let c=0;c<t.length;c+=1)eE(t.charCodeAt(c),a,l);return e.join("")}function Qj(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Vj(t,e){for(let n=0;n<t.length;n+=1){let s=t.charCodeAt(n);if(s>55295&&s<=56319){const a=(s-55296)*1024&65535;s=(t.charCodeAt(n+1)-56320&65535|a)+65536,n+=1}Qj(s,e)}}function Fj(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let s=1;s<6;s+=1)if((t>>7-s&1)===0){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function La(t){const e=[],n={queue:0,queuedBits:0},s=a=>{e.push(a)};for(let a=0;a<t.length;a+=1)eE(t.charCodeAt(a),n,s);return new Uint8Array(e)}function Gj(t){const e=[];return Vj(t,n=>e.push(n)),new Uint8Array(e)}function vi(t){const e=[],n={queue:0,queuedBits:0},s=a=>{e.push(a)};return t.forEach(a=>$b(a,n,s)),$b(null,n,s),e.join("")}function Yj(t){return Math.round(Date.now()/1e3)+t}function Xj(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Jt=()=>typeof window<"u"&&typeof document<"u",ci={tested:!1,writable:!1},tE=()=>{if(!Jt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ci.tested)return ci.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),ci.tested=!0,ci.writable=!0}catch{ci.tested=!0,ci.writable=!1}return ci.writable};function Kj(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((a,l)=>{e[l]=a})}catch{}return n.searchParams.forEach((s,a)=>{e[a]=s}),e}const nE=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Wj=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",ja=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},ui=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},js=async(t,e)=>{await t.removeItem(e)};class nf{constructor(){this.promise=new nf.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}nf.promiseConstructor=Promise;function Zm(t){const e=t.split(".");if(e.length!==3)throw new zp("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!Uj.test(e[s]))throw new zp("JWT not in base64url format");return{header:JSON.parse(zb(e[0])),payload:JSON.parse(zb(e[1])),signature:La(e[2]),raw:{header:e[0],payload:e[1]}}}async function Jj(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Zj(t,e){return new Promise((s,a)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await t(l);if(!e(l,null,c)){s(c);return}}catch(c){if(!e(l,c)){a(c);return}}})()})}function e2(t){return("0"+t.toString(16)).substr(-2)}function t2(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=n.length;let a="";for(let l=0;l<56;l++)a+=n.charAt(Math.floor(Math.random()*s));return a}return crypto.getRandomValues(e),Array.from(e,e2).join("")}async function n2(t){const n=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",n),a=new Uint8Array(s);return Array.from(a).map(l=>String.fromCharCode(l)).join("")}async function r2(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await n2(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function wa(t,e,n=!1){const s=t2();let a=s;n&&(a+="/PASSWORD_RECOVERY"),await ja(t,`${e}-code-verifier`,a);const l=await r2(s);return[l,s===l?"plain":"s256"]}const s2=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function i2(t){const e=t.headers.get(Lp);if(!e||!e.match(s2))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function a2(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function o2(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const l2=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function xa(t){if(!l2.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function ep(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function c2(t,e){return new Proxy(t,{get:(n,s,a)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const l=s.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,s,a)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(n,s,a)}})}function Pb(t){return JSON.parse(JSON.stringify(t))}const fi=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),u2=[502,503,504];async function Hb(t){var e;if(!Wj(t))throw new $p(fi(t),0);if(u2.includes(t.status))throw new $p(fi(t),t.status);let n;try{n=await t.json()}catch(l){throw new gi(fi(l),l)}let s;const a=i2(t);if(a&&a.getTime()>=ZA["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?s=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(s=n.error_code),s){if(s==="weak_password")throw new Ub(fi(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Kn}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new Ub(fi(n),t.status,n.weak_password.reasons);throw new $j(fi(n),t.status||500,s)}const d2=(t,e,n,s)=>{const a={method:t,headers:e?.headers||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),a.body=JSON.stringify(s),Object.assign(Object.assign({},a),n))};async function Be(t,e,n,s){var a;const l=Object.assign({},s?.headers);l[Lp]||(l[Lp]=ZA["2024-01-01"].name),s?.jwt&&(l.Authorization=`Bearer ${s.jwt}`);const c=(a=s?.query)!==null&&a!==void 0?a:{};s?.redirectTo&&(c.redirect_to=s.redirectTo);const d=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",f=await f2(t,e,n+d,{headers:l,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(f):{data:Object.assign({},f),error:null}}async function f2(t,e,n,s,a,l){const c=d2(e,s,a,l);let d;try{d=await t(n,Object.assign({},c))}catch(f){throw console.error(f),new $p(fi(f),0)}if(d.ok||await Hb(d),s?.noResolveJson)return d;try{return await d.json()}catch(f){await Hb(f)}}function Wn(t){var e;let n=null;p2(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=Yj(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:s},error:null}}function qb(t){const e=Wn(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,s)=>n&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Ls(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function h2(t){return{data:t,error:null}}function m2(t){const{action_link:e,email_otp:n,hashed_token:s,redirect_to:a,verification_type:l}=t,c=Wa(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:e,email_otp:n,hashed_token:s,redirect_to:a,verification_type:l},f=Object.assign({},c);return{data:{properties:d,user:f},error:null}}function Qb(t){return t}function p2(t){return t.access_token&&t.refresh_token&&t.expires_in}const tp=["global","local","others"];class g2{constructor({url:e="",headers:n={},fetch:s}){this.url=e,this.headers=n,this.fetch=nE(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,n=tp[0]){if(tp.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${tp.join(", ")}`);try{return await Be(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Re(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,n={}){try{return await Be(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Ls})}catch(s){if(Re(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:n}=e,s=Wa(e,["options"]),a=Object.assign(Object.assign({},s),n);return"newEmail"in s&&(a.new_email=s?.newEmail,delete a.newEmail),await Be(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:m2,redirectTo:n?.redirectTo})}catch(n){if(Re(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await Be(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ls})}catch(n){if(Re(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,s,a,l,c,d,f;try{const h={nextPage:null,lastPage:0,total:0},p=await Be(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e?.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(l=(a=e?.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:Qb});if(p.error)throw p.error;const m=await p.json(),y=(c=p.headers.get("x-total-count"))!==null&&c!==void 0?c:0,_=(f=(d=p.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&f!==void 0?f:[];return _.length>0&&(_.forEach(x=>{const w=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),A=JSON.parse(x.split(";")[1].split("=")[1]);h[`${A}Page`]=w}),h.total=parseInt(y)),{data:Object.assign(Object.assign({},m),h),error:null}}catch(h){if(Re(h))return{data:{users:[]},error:h};throw h}}async getUserById(e){xa(e);try{return await Be(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ls})}catch(n){if(Re(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){xa(e);try{return await Be(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Ls})}catch(s){if(Re(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,n=!1){xa(e);try{return await Be(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Ls})}catch(s){if(Re(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){xa(e.userId);try{const{data:n,error:s}=await Be(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:n,error:s}}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _deleteFactor(e){xa(e.userId),xa(e.id);try{return{data:await Be(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _listOAuthClients(e){var n,s,a,l,c,d,f;try{const h={nextPage:null,lastPage:0,total:0},p=await Be(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e?.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(l=(a=e?.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:Qb});if(p.error)throw p.error;const m=await p.json(),y=(c=p.headers.get("x-total-count"))!==null&&c!==void 0?c:0,_=(f=(d=p.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&f!==void 0?f:[];return _.length>0&&(_.forEach(x=>{const w=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),A=JSON.parse(x.split(";")[1].split("=")[1]);h[`${A}Page`]=w}),h.total=parseInt(y)),{data:Object.assign(Object.assign({},m),h),error:null}}catch(h){if(Re(h))return{data:{clients:[]},error:h};throw h}}async _createOAuthClient(e){try{return await Be(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _getOAuthClient(e){try{return await Be(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _updateOAuthClient(e,n){try{return await Be(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:n,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Re(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await Be(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(e){try{return await Be(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Re(n))return{data:null,error:n};throw n}}}function Vb(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}const Aa={debug:!!(globalThis&&tE()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class rE extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class y2 extends rE{}async function v2(t,e,n){Aa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Aa.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async a=>{if(a){Aa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await n()}finally{Aa.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(e===0)throw Aa.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new y2(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Aa.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function _2(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function sE(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function b2(t){return parseInt(t,16)}function w2(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function x2(t){var e;const{chainId:n,domain:s,expirationTime:a,issuedAt:l=new Date,nonce:c,notBefore:d,requestId:f,resources:h,scheme:p,uri:m,version:y}=t;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!m)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(y!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${y}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const _=sE(t.address),x=p?`${p}://${s}`:s,w=t.statement?`${t.statement}
`:"",A=`${x} wants you to sign in with your Ethereum account:
${_}

${w}`;let S=`URI: ${m}
Version: ${y}
Chain ID: ${n}${c?`
Nonce: ${c}`:""}
Issued At: ${l.toISOString()}`;if(a&&(S+=`
Expiration Time: ${a.toISOString()}`),d&&(S+=`
Not Before: ${d.toISOString()}`),f&&(S+=`
Request ID: ${f}`),h){let T=`
Resources:`;for(const E of h){if(!E||typeof E!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${E}`);T+=`
- ${E}`}S+=T}return`${A}
${S}`}class Nt extends Error{constructor({message:e,code:n,cause:s,name:a}){var l;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(l=a??(s instanceof Error?s.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=n}}class Od extends Nt{constructor(e,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:e}),this.name="WebAuthnUnknownError",this.originalError=n}}function A2({error:t,options:e}){var n,s,a;const{publicKey:l}=e;if(!l)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Nt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((n=l.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new Nt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((s=l.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Nt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((a=l.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Nt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Nt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Nt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return l.pubKeyCredParams.filter(d=>d.type==="public-key").length===0?new Nt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Nt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const c=window.location.hostname;if(iE(c)){if(l.rp.id!==c)return new Nt({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Nt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new Nt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Nt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Nt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function E2({error:t,options:e}){const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Nt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Nt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(iE(s)){if(n.rpId!==s)return new Nt({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Nt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Nt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Nt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class S2{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const C2=new S2;function T2(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:n,excludeCredentials:s}=t,a=Wa(t,["challenge","user","excludeCredentials"]),l=La(e).buffer,c=Object.assign(Object.assign({},n),{id:La(n.id).buffer}),d=Object.assign(Object.assign({},a),{challenge:l,user:c});if(s&&s.length>0){d.excludeCredentials=new Array(s.length);for(let f=0;f<s.length;f++){const h=s[f];d.excludeCredentials[f]=Object.assign(Object.assign({},h),{id:La(h.id).buffer,type:h.type||"public-key",transports:h.transports})}}return d}function N2(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:n}=t,s=Wa(t,["challenge","allowCredentials"]),a=La(e).buffer,l=Object.assign(Object.assign({},s),{challenge:a});if(n&&n.length>0){l.allowCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const d=n[c];l.allowCredentials[c]=Object.assign(Object.assign({},d),{id:La(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function R2(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t;return{id:t.id,rawId:t.id,response:{attestationObject:vi(new Uint8Array(t.response.attestationObject)),clientDataJSON:vi(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function O2(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t,s=t.getClientExtensionResults(),a=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:vi(new Uint8Array(a.authenticatorData)),clientDataJSON:vi(new Uint8Array(a.clientDataJSON)),signature:vi(new Uint8Array(a.signature)),userHandle:a.userHandle?vi(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function iE(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function Fb(){var t,e;return!!(Jt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function j2(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Od("Browser returned unexpected credential type",e)}:{data:null,error:new Od("Empty credential response",e)}}catch(e){return{data:null,error:A2({error:e,options:t})}}}async function I2(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Od("Browser returned unexpected credential type",e)}:{data:null,error:new Od("Empty credential response",e)}}catch(e){return{data:null,error:E2({error:e,options:t})}}}const k2={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},M2={userVerification:"preferred",hints:["security-key"]};function jd(...t){const e=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),n=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),s={};for(const a of t)if(a)for(const l in a){const c=a[l];if(c!==void 0)if(Array.isArray(c))s[l]=c;else if(n(c))s[l]=c;else if(e(c)){const d=s[l];e(d)?s[l]=jd(d,c):s[l]=jd(c)}else s[l]=c}return s}function D2(t,e){return jd(k2,t,e||{})}function B2(t,e){return jd(M2,t,e||{})}class U2{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:n,friendlyName:s,signal:a},l){try{const{data:c,error:d}=await this.client.mfa.challenge({factorId:e,webauthn:n});if(!c)return{data:null,error:d};const f=a??C2.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:h}=c.webauthn.credential_options.publicKey;h.name||(h.name=`${h.id}:${s}`),h.displayName||(h.displayName=h.name)}switch(c.webauthn.type){case"create":{const h=D2(c.webauthn.credential_options.publicKey,l?.create),{data:p,error:m}=await j2({publicKey:h,signal:f});return p?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:p}},error:null}:{data:null,error:m}}case"request":{const h=B2(c.webauthn.credential_options.publicKey,l?.request),{data:p,error:m}=await I2(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:h,signal:f}));return p?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:p}},error:null}:{data:null,error:m}}}}catch(c){return Re(c)?{data:null,error:c}:{data:null,error:new gi("Unexpected error in challenge",c)}}}async _verify({challengeId:e,factorId:n,webauthn:s}){return this.client.mfa.verify({factorId:n,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:a}},l){if(!n)return{data:null,error:new Ml("rpId is required for WebAuthn authentication")};try{if(!Fb())return{data:null,error:new gi("Browser does not support WebAuthn",null)};const{data:c,error:d}=await this.challenge({factorId:e,webauthn:{rpId:n,rpOrigins:s},signal:a},{request:l});if(!c)return{data:null,error:d};const{webauthn:f}=c;return this._verify({factorId:e,challengeId:c.challengeId,webauthn:{type:f.type,rpId:n,rpOrigins:s,credential_response:f.credential_response}})}catch(c){return Re(c)?{data:null,error:c}:{data:null,error:new gi("Unexpected error in authenticate",c)}}}async _register({friendlyName:e,rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:a},l){if(!n)return{data:null,error:new Ml("rpId is required for WebAuthn registration")};try{if(!Fb())return{data:null,error:new gi("Browser does not support WebAuthn",null)};const{data:c,error:d}=await this._enroll({friendlyName:e});if(!c)return await this.client.mfa.listFactors().then(p=>{var m;return(m=p.data)===null||m===void 0?void 0:m.all.find(y=>y.factor_type==="webauthn"&&y.friendly_name===e&&y.status!=="unverified")}).then(p=>p?this.client.mfa.unenroll({factorId:p?.id}):void 0),{data:null,error:d};const{data:f,error:h}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:n,rpOrigins:s},signal:a},{create:l});return f?this._verify({factorId:c.id,challengeId:f.challengeId,webauthn:{rpId:n,rpOrigins:s,type:f.webauthn.type,credential_response:f.webauthn.credential_response}}):{data:null,error:h}}catch(c){return Re(c)?{data:null,error:c}:{data:null,error:new gi("Unexpected error in register",c)}}}}_2();const L2={url:Mj,storageKey:Dj,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Bj,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Gb(t,e,n){return await n()}const Ea={};class Dl{get jwks(){var e,n;return(n=(e=Ea[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){Ea[this.storageKey]=Object.assign(Object.assign({},Ea[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=Ea[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Ea[this.storageKey]=Object.assign(Object.assign({},Ea[this.storageKey]),{cachedAt:e})}constructor(e){var n,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Dl.nextInstanceID,Dl.nextInstanceID+=1,this.instanceID>0&&Jt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},L2),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new g2({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=nE(a.fetch),this.lock=a.lock||Gb,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:Jt()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=v2:this.lock=Gb,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new U2(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:tE()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Vb(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Vb(this.memoryStorage)),Jt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${JA}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let n={},s="none";if(Jt()&&(n=Kj(window.location.href),this._isImplicitGrantCallback(n)?s="implicit":await this._isPKCECallback(n)&&(s="pkce")),Jt()&&this.detectSessionInUrl&&s!=="none"){const{data:a,error:l}=await this._getSessionFromURL(n,s);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),Hj(l)){const f=(e=l.details)===null||e===void 0?void 0:e.code;if(f==="identity_already_exists"||f==="identity_not_found"||f==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:d}=a;return this._debug("#_initialize()","detected session in URL",c,"redirect type",d),await this._saveSession(c),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Re(n)?this._returnResult({error:n}):this._returnResult({error:new gi("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,s,a;try{const l=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(n=e?.options)===null||n===void 0?void 0:n.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(a=e?.options)===null||a===void 0?void 0:a.captchaToken}},xform:Wn}),{data:c,error:d}=l;if(d||!c)return this._returnResult({data:{user:null,session:null},error:d});const f=c.session,h=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",f)),this._returnResult({data:{user:h,session:f},error:null})}catch(l){if(Re(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(e){var n,s,a;try{let l;if("email"in e){const{email:p,password:m,options:y}=e;let _=null,x=null;this.flowType==="pkce"&&([_,x]=await wa(this.storage,this.storageKey)),l=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:y?.emailRedirectTo,body:{email:p,password:m,data:(n=y?.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:y?.captchaToken},code_challenge:_,code_challenge_method:x},xform:Wn})}else if("phone"in e){const{phone:p,password:m,options:y}=e;l=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:m,data:(s=y?.data)!==null&&s!==void 0?s:{},channel:(a=y?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:y?.captchaToken}},xform:Wn})}else throw new Pu("You must provide either an email or phone number and a password");const{data:c,error:d}=l;if(d||!c)return this._returnResult({data:{user:null,session:null},error:d});const f=c.session,h=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",f)),this._returnResult({data:{user:h,session:f},error:null})}catch(l){if(Re(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(e){try{let n;if("email"in e){const{email:l,password:c,options:d}=e;n=await Be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:qb})}else if("phone"in e){const{phone:l,password:c,options:d}=e;n=await Be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:qb})}else throw new Pu("You must provide either an email or phone number and a password");const{data:s,error:a}=n;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!s||!s.session||!s.user){const l=new ba;return this._returnResult({data:{user:null,session:null},error:l})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:a})}catch(n){if(Re(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(e){var n,s,a,l;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(l=e.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;switch(n){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(e){var n,s,a,l,c,d,f,h,p,m,y;let _,x;if("message"in e)_=e.message,x=e.signature;else{const{chain:w,wallet:A,statement:S,options:T}=e;let E;if(Jt())if(typeof A=="object")E=A;else{const P=window;if("ethereum"in P&&typeof P.ethereum=="object"&&"request"in P.ethereum&&typeof P.ethereum.request=="function")E=P.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof A!="object"||!T?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=A}const C=new URL((n=T?.url)!==null&&n!==void 0?n:window.location.href),O=await E.request({method:"eth_requestAccounts"}).then(P=>P).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!O||O.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const j=sE(O[0]);let I=(s=T?.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!I){const P=await E.request({method:"eth_chainId"});I=b2(P)}const D={domain:C.host,address:j,statement:S,uri:C.href,version:"1",chainId:I,nonce:(a=T?.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(c=(l=T?.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(d=T?.signInWithEthereum)===null||d===void 0?void 0:d.expirationTime,notBefore:(f=T?.signInWithEthereum)===null||f===void 0?void 0:f.notBefore,requestId:(h=T?.signInWithEthereum)===null||h===void 0?void 0:h.requestId,resources:(p=T?.signInWithEthereum)===null||p===void 0?void 0:p.resources};_=x2(D),x=await E.request({method:"personal_sign",params:[w2(_),j]})}try{const{data:w,error:A}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:_,signature:x},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:Wn});if(A)throw A;if(!w||!w.session||!w.user){const S=new ba;return this._returnResult({data:{user:null,session:null},error:S})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:A})}catch(w){if(Re(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async signInWithSolana(e){var n,s,a,l,c,d,f,h,p,m,y,_;let x,w;if("message"in e)x=e.message,w=e.signature;else{const{chain:A,wallet:S,statement:T,options:E}=e;let C;if(Jt())if(typeof S=="object")C=S;else{const j=window;if("solana"in j&&typeof j.solana=="object"&&("signIn"in j.solana&&typeof j.solana.signIn=="function"||"signMessage"in j.solana&&typeof j.solana.signMessage=="function"))C=j.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!E?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=S}const O=new URL((n=E?.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in C&&C.signIn){const j=await C.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},E?.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),T?{statement:T}:null));let I;if(Array.isArray(j)&&j[0]&&typeof j[0]=="object")I=j[0];else if(j&&typeof j=="object"&&"signedMessage"in j&&"signature"in j)I=j;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in I&&"signature"in I&&(typeof I.signedMessage=="string"||I.signedMessage instanceof Uint8Array)&&I.signature instanceof Uint8Array)x=typeof I.signedMessage=="string"?I.signedMessage:new TextDecoder().decode(I.signedMessage),w=I.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in C)||typeof C.signMessage!="function"||!("publicKey"in C)||typeof C!="object"||!C.publicKey||!("toBase58"in C.publicKey)||typeof C.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${O.host} wants you to sign in with your Solana account:`,C.publicKey.toBase58(),...T?["",T,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(a=(s=E?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((l=E?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${E.signInWithSolana.notBefore}`]:[],...!((c=E?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${E.signInWithSolana.expirationTime}`]:[],...!((d=E?.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${E.signInWithSolana.chainId}`]:[],...!((f=E?.signInWithSolana)===null||f===void 0)&&f.nonce?[`Nonce: ${E.signInWithSolana.nonce}`]:[],...!((h=E?.signInWithSolana)===null||h===void 0)&&h.requestId?[`Request ID: ${E.signInWithSolana.requestId}`]:[],...!((m=(p=E?.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||m===void 0)&&m.length?["Resources",...E.signInWithSolana.resources.map(I=>`- ${I}`)]:[]].join(`
`);const j=await C.signMessage(new TextEncoder().encode(x),"utf8");if(!j||!(j instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=j}}try{const{data:A,error:S}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:vi(w)},!((y=e.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(_=e.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:Wn});if(S)throw S;if(!A||!A.session||!A.user){const T=new ba;return this._returnResult({data:{user:null,session:null},error:T})}return A.session&&(await this._saveSession(A.session),await this._notifyAllSubscribers("SIGNED_IN",A.session)),this._returnResult({data:Object.assign({},A),error:S})}catch(A){if(Re(A))return this._returnResult({data:{user:null,session:null},error:A});throw A}}async _exchangeCodeForSession(e){const n=await ui(this.storage,`${this.storageKey}-code-verifier`),[s,a]=(n??"").split("/");try{const{data:l,error:c}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Wn});if(await js(this.storage,`${this.storageKey}-code-verifier`),c)throw c;if(!l||!l.session||!l.user){const d=new ba;return this._returnResult({data:{user:null,session:null,redirectType:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:a??null}),error:c})}catch(l){if(Re(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(e){try{const{options:n,provider:s,token:a,access_token:l,nonce:c}=e,d=await Be(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:a,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:n?.captchaToken}},xform:Wn}),{data:f,error:h}=d;if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!f||!f.session||!f.user){const p=new ba;return this._returnResult({data:{user:null,session:null},error:p})}return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),this._returnResult({data:f,error:h})}catch(n){if(Re(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(e){var n,s,a,l,c;try{if("email"in e){const{email:d,options:f}=e;let h=null,p=null;this.flowType==="pkce"&&([h,p]=await wa(this.storage,this.storageKey));const{error:m}=await Be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(n=f?.data)!==null&&n!==void 0?n:{},create_user:(s=f?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:h,code_challenge_method:p},redirectTo:f?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:m})}if("phone"in e){const{phone:d,options:f}=e,{data:h,error:p}=await Be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(a=f?.data)!==null&&a!==void 0?a:{},create_user:(l=f?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},channel:(c=f?.channel)!==null&&c!==void 0?c:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:h?.message_id},error:p})}throw new Pu("You must provide either an email or phone number.")}catch(d){if(Re(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async verifyOtp(e){var n,s;try{let a,l;"options"in e&&(a=(n=e.options)===null||n===void 0?void 0:n.redirectTo,l=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:c,error:d}=await Be(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:l}}),redirectTo:a,xform:Wn});if(d)throw d;if(!c)throw new Error("An error occurred on token verification.");const f=c.session,h=c.user;return f?.access_token&&(await this._saveSession(f),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",f)),this._returnResult({data:{user:h,session:f},error:null})}catch(a){if(Re(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(e){var n,s,a;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await wa(this.storage,this.storageKey));const d=await Be(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&s!==void 0?s:void 0}),!((a=e?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:h2});return this._returnResult(d)}catch(l){if(Re(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;if(s)throw s;if(!n)throw new Kn;const{error:a}=await Be(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(e){if(Re(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:s,type:a,options:l}=e,{error:c}=await Be(this.fetch,"POST",n,{headers:this.headers,body:{email:s,type:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:c})}else if("phone"in e){const{phone:s,type:a,options:l}=e,{data:c,error:d}=await Be(this.fetch,"POST",n,{headers:this.headers,body:{phone:s,type:a,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:c?.message_id},error:d})}throw new Pu("You must provide either an email or phone number and a type")}catch(n){if(Re(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await s,await n()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=n();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await ui(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<Wm:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const c=await ui(this.userStorage,this.storageKey+"-user");c?.user?e.user=c.user:e.user=ep()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const c={value:this.suppressGetSessionWarning};e.user=c2(e.user,c),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ls}):await this._useSession(async n=>{var s,a,l;const{data:c,error:d}=n;if(d)throw d;return!(!((s=c.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Kn}:await Be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(a=c.session)===null||a===void 0?void 0:a.access_token)!==null&&l!==void 0?l:void 0,xform:Ls})})}catch(n){if(Re(n))return Pj(n)&&(await this._removeSession(),await js(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async s=>{const{data:a,error:l}=s;if(l)throw l;if(!a.session)throw new Kn;const c=a.session;let d=null,f=null;this.flowType==="pkce"&&e.email!=null&&([d,f]=await wa(this.storage,this.storageKey));const{data:h,error:p}=await Be(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:d,code_challenge_method:f}),jwt:c.access_token,xform:Ls});if(p)throw p;return c.user=h.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),this._returnResult({data:{user:c.user},error:null})})}catch(s){if(Re(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Kn;const n=Date.now()/1e3;let s=n,a=!0,l=null;const{payload:c}=Zm(e.access_token);if(c.exp&&(s=c.exp,a=s<=n),a){const{data:d,error:f}=await this._callRefreshToken(e.refresh_token);if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!d)return{data:{user:null,session:null},error:null};l=d}else{const{data:d,error:f}=await this._getUser(e.access_token);if(f)throw f;l={access_token:e.access_token,refresh_token:e.refresh_token,user:d.user,token_type:"bearer",expires_in:s-n,expires_at:s},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(n){if(Re(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var s;if(!e){const{data:c,error:d}=n;if(d)throw d;e=(s=c.session)!==null&&s!==void 0?s:void 0}if(!e?.refresh_token)throw new Kn;const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(Re(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(e,n){try{if(!Jt())throw new Hu("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Hu(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Bb("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Hu("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Bb("No code detected.");const{data:T,error:E}=await this._exchangeCodeForSession(e.code);if(E)throw E;const C=new URL(window.location.href);return C.searchParams.delete("code"),window.history.replaceState(window.history.state,"",C.toString()),{data:{session:T.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:a,access_token:l,refresh_token:c,expires_in:d,expires_at:f,token_type:h}=e;if(!l||!d||!c||!h)throw new Hu("No session defined in URL");const p=Math.round(Date.now()/1e3),m=parseInt(d);let y=p+m;f&&(y=parseInt(f));const _=y-p;_*1e3<=Oa&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${m}s`);const x=y-m;p-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,y,p):p-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,y,p);const{data:w,error:A}=await this._getUser(l);if(A)throw A;const S={provider_token:s,provider_refresh_token:a,access_token:l,expires_in:m,expires_at:y,refresh_token:c,token_type:h,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:S,redirectType:e.type},error:null})}catch(s){if(Re(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await ui(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var s;const{data:a,error:l}=n;if(l)return this._returnResult({error:l});const c=(s=a.session)===null||s===void 0?void 0:s.access_token;if(c){const{error:d}=await this.admin.signOut(c,e);if(d&&!(zj(d)&&(d.status===404||d.status===401||d.status===403)))return this._returnResult({error:d})}return e!=="others"&&(await this._removeSession(),await js(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const n=Xj(),s={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async n=>{var s,a;try{const{data:{session:l},error:c}=n;if(c)throw c;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",e,"session",l)}catch(l){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",l),console.error(l)}})}async resetPasswordForEmail(e,n={}){let s=null,a=null;this.flowType==="pkce"&&([s,a]=await wa(this.storage,this.storageKey,!0));try{return await Be(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:a,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(l){if(Re(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var e;try{const{data:n,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var n;try{const{data:s,error:a}=await this._useSession(async l=>{var c,d,f,h,p;const{data:m,error:y}=l;if(y)throw y;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(d=e.options)===null||d===void 0?void 0:d.scopes,queryParams:(f=e.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:!0});return await Be(this.fetch,"GET",_,{headers:this.headers,jwt:(p=(h=m.session)===null||h===void 0?void 0:h.access_token)!==null&&p!==void 0?p:void 0})});if(a)throw a;return Jt()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(s?.url),this._returnResult({data:{provider:e.provider,url:s?.url},error:null})}catch(s){if(Re(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async n=>{var s;try{const{error:a,data:{session:l}}=n;if(a)throw a;const{options:c,provider:d,token:f,access_token:h,nonce:p}=e,m=await Be(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=l?.access_token)!==null&&s!==void 0?s:void 0,body:{provider:d,id_token:f,access_token:h,nonce:p,link_identity:!0,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Wn}),{data:y,error:_}=m;return _?this._returnResult({data:{user:null,session:null},error:_}):!y||!y.session||!y.user?this._returnResult({data:{user:null,session:null},error:new ba}):(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("USER_UPDATED",y.session)),this._returnResult({data:y,error:_}))}catch(a){if(Re(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(e){try{return await this._useSession(async n=>{var s,a;const{data:l,error:c}=n;if(c)throw c;return await Be(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(s=l.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0})})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const s=Date.now();return await Zj(async a=>(a>0&&await Jj(200*Math.pow(2,a-1)),this._debug(n,"refreshing attempt",a),await Be(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Wn})),(a,l)=>{const c=200*Math.pow(2,a);return l&&Jm(l)&&Date.now()+c-s<Oa})}catch(s){if(this._debug(n,"error",s),Re(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",s),Jt()&&!n.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,n;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const a=await ui(this.storage,this.storageKey);if(a&&this.userStorage){let c=await ui(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:a.user},await ja(this.userStorage,this.storageKey+"-user",c)),a.user=(e=c?.user)!==null&&e!==void 0?e:ep()}else if(a&&!a.user&&!a.user){const c=await ui(this.storage,this.storageKey+"-user");c&&c?.user?(a.user=c.user,await js(this.storage,this.storageKey+"-user"),await ja(this.storage,this.storageKey,a)):a.user=ep()}if(this._debug(s,"session from storage",a),!this._isValidSession(a)){this._debug(s,"session is not valid"),a!==null&&await this._removeSession();return}const l=((n=a.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Wm;if(this._debug(s,`session has${l?"":" not"} expired with margin of ${Wm}s`),l){if(this.autoRefreshToken&&a.refresh_token){const{error:c}=await this._callRefreshToken(a.refresh_token);c&&(console.error(c),Jm(c)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:d}=await this._getUser(a.access_token);!d&&c?.user?(a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(s,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(s,"error",a),console.error(a);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var n,s;if(!e)throw new Kn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new nf;const{data:l,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!l.session)throw new Kn;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const d={data:l.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(l){if(this._debug(a,"error",l),Re(l)){const c={data:null,error:l};return Jm(l)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(c),c}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(l),l}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,n,s=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",n,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:n});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(e,n)}catch(f){l.push(f)}});if(await Promise.all(c),l.length>0){for(let d=0;d<l.length;d+=1)console.error(l[d]);throw l[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),s=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&n.user&&await ja(this.userStorage,this.storageKey+"-user",{user:n.user});const a=Object.assign({},n);delete a.user;const l=Pb(a);await ja(this.storage,this.storageKey,l)}else{const a=Pb(n);await ja(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await js(this.storage,this.storageKey),await js(this.storage,this.storageKey+"-code-verifier"),await js(this.storage,this.storageKey+"-user"),this.userStorage&&await js(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Jt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Oa);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:s}}=n;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((s.expires_at*1e3-e)/Oa);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Oa}ms, refresh threshold is ${Up} ticks`),a<=Up&&await this._callRefreshToken(s.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof rE)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Jt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,s){const a=[`provider=${encodeURIComponent(n)}`];if(s?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&a.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[l,c]=await wa(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});a.push(d.toString())}if(s?.queryParams){const l=new URLSearchParams(s.queryParams);a.push(l.toString())}return s?.skipBrowserRedirect&&a.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var s;const{data:a,error:l}=n;return l?this._returnResult({data:null,error:l}):await Be(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token})})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(e){try{return await this._useSession(async n=>{var s,a;const{data:l,error:c}=n;if(c)return this._returnResult({data:null,error:c});const d=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:f,error:h}=await Be(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(s=l?.session)===null||s===void 0?void 0:s.access_token});return h?this._returnResult({data:null,error:h}):(e.factorType==="totp"&&f.type==="totp"&&(!((a=f?.totp)===null||a===void 0)&&a.qr_code)&&(f.totp.qr_code=`data:image/svg+xml;utf-8,${f.totp.qr_code}`),this._returnResult({data:f,error:null}))})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:a,error:l}=n;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?R2(e.webauthn.credential_response):O2(e.webauthn.credential_response)})}:{code:e.code}),{data:d,error:f}=await Be(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:c,headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token});return f?this._returnResult({data:null,error:f}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),this._returnResult({data:d,error:f}))})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:a,error:l}=n;if(l)return this._returnResult({data:null,error:l});const c=await Be(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token});if(c.error)return c;const{data:d}=c;if(d.type!=="webauthn")return{data:d,error:null};switch(d.webauthn.type){case"create":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:T2(d.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:N2(d.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(e){const{data:n,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){var e;const{data:{user:n},error:s}=await this.getUser();if(s)return{data:null,error:s};const a={all:[],phone:[],totp:[],webauthn:[]};for(const l of(e=n?.factors)!==null&&e!==void 0?e:[])a.all.push(l),l.status==="verified"&&a[l.factor_type].push(l);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var e,n;const{data:{session:s},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=Zm(s.access_token);let c=null;l.aal&&(c=l.aal);let d=c;((n=(e=s.user.factors)===null||e===void 0?void 0:e.filter(p=>p.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(d="aal2");const h=l.amr||[];return{data:{currentLevel:c,nextLevel:d,currentAuthenticationMethods:h},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async n=>{const{data:{session:s},error:a}=n;return a?this._returnResult({data:null,error:a}):s?await Be(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new Kn})})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(e,n){try{return await this._useSession(async s=>{const{data:{session:a},error:l}=s;if(l)return this._returnResult({data:null,error:l});if(!a)return this._returnResult({data:null,error:new Kn});const c=await Be(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:d=>({data:d,error:null})});return c.data&&c.data.redirect_url&&Jt()&&!n?.skipBrowserRedirect&&window.location.assign(c.data.redirect_url),c})}catch(s){if(Re(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,n){try{return await this._useSession(async s=>{const{data:{session:a},error:l}=s;if(l)return this._returnResult({data:null,error:l});if(!a)return this._returnResult({data:null,error:new Kn});const c=await Be(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:d=>({data:d,error:null})});return c.data&&c.data.redirect_url&&Jt()&&!n?.skipBrowserRedirect&&window.location.assign(c.data.redirect_url),c})}catch(s){if(Re(s))return this._returnResult({data:null,error:s});throw s}}async fetchJwk(e,n={keys:[]}){let s=n.keys.find(d=>d.kid===e);if(s)return s;const a=Date.now();if(s=this.jwks.keys.find(d=>d.kid===e),s&&this.jwks_cached_at+Lj>a)return s;const{data:l,error:c}=await Be(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=a,s=l.keys.find(d=>d.kid===e),!s)?null:s}async getClaims(e,n={}){try{let s=e;if(!s){const{data:_,error:x}=await this.getSession();if(x||!_.session)return this._returnResult({data:null,error:x});s=_.session.access_token}const{header:a,payload:l,signature:c,raw:{header:d,payload:f}}=Zm(s);n?.allowExpired||a2(l.exp);const h=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,n?.keys?{keys:n.keys}:n?.jwks);if(!h){const{error:_}=await this.getUser(s);if(_)throw _;return{data:{claims:l,header:a,signature:c},error:null}}const p=o2(a.alg),m=await crypto.subtle.importKey("jwk",h,p,!0,["verify"]);if(!await crypto.subtle.verify(p,m,c,Gj(`${d}.${f}`)))throw new zp("Invalid JWT signature");return{data:{claims:l,header:a,signature:c},error:null}}catch(s){if(Re(s))return this._returnResult({data:null,error:s});throw s}}}Dl.nextInstanceID=0;const $2=Dl;class z2 extends $2{constructor(e){super(e)}}class P2{constructor(e,n,s){var a,l,c;this.supabaseUrl=e,this.supabaseKey=n;const d=kj(e);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const f=`sb-${d.hostname.split(".")[0]}-auth-token`,h={db:Sj,realtime:Tj,auth:Object.assign(Object.assign({},Cj),{storageKey:f}),global:Ej},p=Ij(s??{},h);this.storageKey=(a=p.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(l=p.global.headers)!==null&&l!==void 0?l:{},p.accessToken?(this.accessToken=p.accessToken,this.auth=new Proxy({},{get:(m,y)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(y)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=p.auth)!==null&&c!==void 0?c:{},this.headers,p.global.fetch),this.fetch=Oj(n,this._getAccessToken.bind(this),p.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},p.realtime)),this.rest=new MO(new URL("rest/v1",d).href,{headers:this.headers,schema:p.db.schema,fetch:this.fetch}),this.storage=new wj(this.storageUrl.href,this.headers,this.fetch,s?.storage),p.accessToken||this._listenForAuthEvents()}get functions(){return new OO(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,n,s)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,n;if(this.accessToken)return await this.accessToken();const{data:s}=await this.auth.getSession();return(n=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:s,storage:a,userStorage:l,storageKey:c,flowType:d,lock:f,debug:h,throwOnError:p},m,y){const _={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new z2({url:this.authUrl.href,headers:Object.assign(Object.assign({},_),m),storageKey:c,autoRefreshToken:e,persistSession:n,detectSessionInUrl:s,storage:a,userStorage:l,flowType:d,lock:f,debug:h,throwOnError:p,fetch:y,hasCustomAuthorizationHeader:Object.keys(this.headers).some(x=>x.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new WO(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,s)=>{this._handleTokenChanged(n,"CLIENT",s?.access_token)})}_handleTokenChanged(e,n,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const H2=(t,e,n)=>new P2(t,e,n);function q2(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}q2()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");var qu={exports:{}},Yb;function Q2(){if(Yb)return qu.exports;Yb=1;var t=typeof Reflect=="object"?Reflect:null,e=t&&typeof t.apply=="function"?t.apply:function(O,j,I){return Function.prototype.apply.call(O,j,I)},n;t&&typeof t.ownKeys=="function"?n=t.ownKeys:Object.getOwnPropertySymbols?n=function(O){return Object.getOwnPropertyNames(O).concat(Object.getOwnPropertySymbols(O))}:n=function(O){return Object.getOwnPropertyNames(O)};function s(C){console&&console.warn&&console.warn(C)}var a=Number.isNaN||function(O){return O!==O};function l(){l.init.call(this)}qu.exports=l,qu.exports.once=S,l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var c=10;function d(C){if(typeof C!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof C)}Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(C){if(typeof C!="number"||C<0||a(C))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+C+".");c=C}}),l.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(O){if(typeof O!="number"||O<0||a(O))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+O+".");return this._maxListeners=O,this};function f(C){return C._maxListeners===void 0?l.defaultMaxListeners:C._maxListeners}l.prototype.getMaxListeners=function(){return f(this)},l.prototype.emit=function(O){for(var j=[],I=1;I<arguments.length;I++)j.push(arguments[I]);var D=O==="error",P=this._events;if(P!==void 0)D=D&&P.error===void 0;else if(!D)return!1;if(D){var G;if(j.length>0&&(G=j[0]),G instanceof Error)throw G;var V=new Error("Unhandled error."+(G?" ("+G.message+")":""));throw V.context=G,V}var z=P[O];if(z===void 0)return!1;if(typeof z=="function")e(z,this,j);else for(var Y=z.length,H=x(z,Y),I=0;I<Y;++I)e(H[I],this,j);return!0};function h(C,O,j,I){var D,P,G;if(d(j),P=C._events,P===void 0?(P=C._events=Object.create(null),C._eventsCount=0):(P.newListener!==void 0&&(C.emit("newListener",O,j.listener?j.listener:j),P=C._events),G=P[O]),G===void 0)G=P[O]=j,++C._eventsCount;else if(typeof G=="function"?G=P[O]=I?[j,G]:[G,j]:I?G.unshift(j):G.push(j),D=f(C),D>0&&G.length>D&&!G.warned){G.warned=!0;var V=new Error("Possible EventEmitter memory leak detected. "+G.length+" "+String(O)+" listeners added. Use emitter.setMaxListeners() to increase limit");V.name="MaxListenersExceededWarning",V.emitter=C,V.type=O,V.count=G.length,s(V)}return C}l.prototype.addListener=function(O,j){return h(this,O,j,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(O,j){return h(this,O,j,!0)};function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function m(C,O,j){var I={fired:!1,wrapFn:void 0,target:C,type:O,listener:j},D=p.bind(I);return D.listener=j,I.wrapFn=D,D}l.prototype.once=function(O,j){return d(j),this.on(O,m(this,O,j)),this},l.prototype.prependOnceListener=function(O,j){return d(j),this.prependListener(O,m(this,O,j)),this},l.prototype.removeListener=function(O,j){var I,D,P,G,V;if(d(j),D=this._events,D===void 0)return this;if(I=D[O],I===void 0)return this;if(I===j||I.listener===j)--this._eventsCount===0?this._events=Object.create(null):(delete D[O],D.removeListener&&this.emit("removeListener",O,I.listener||j));else if(typeof I!="function"){for(P=-1,G=I.length-1;G>=0;G--)if(I[G]===j||I[G].listener===j){V=I[G].listener,P=G;break}if(P<0)return this;P===0?I.shift():w(I,P),I.length===1&&(D[O]=I[0]),D.removeListener!==void 0&&this.emit("removeListener",O,V||j)}return this},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(O){var j,I,D;if(I=this._events,I===void 0)return this;if(I.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):I[O]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete I[O]),this;if(arguments.length===0){var P=Object.keys(I),G;for(D=0;D<P.length;++D)G=P[D],G!=="removeListener"&&this.removeAllListeners(G);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(j=I[O],typeof j=="function")this.removeListener(O,j);else if(j!==void 0)for(D=j.length-1;D>=0;D--)this.removeListener(O,j[D]);return this};function y(C,O,j){var I=C._events;if(I===void 0)return[];var D=I[O];return D===void 0?[]:typeof D=="function"?j?[D.listener||D]:[D]:j?A(D):x(D,D.length)}l.prototype.listeners=function(O){return y(this,O,!0)},l.prototype.rawListeners=function(O){return y(this,O,!1)},l.listenerCount=function(C,O){return typeof C.listenerCount=="function"?C.listenerCount(O):_.call(C,O)},l.prototype.listenerCount=_;function _(C){var O=this._events;if(O!==void 0){var j=O[C];if(typeof j=="function")return 1;if(j!==void 0)return j.length}return 0}l.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function x(C,O){for(var j=new Array(O),I=0;I<O;++I)j[I]=C[I];return j}function w(C,O){for(;O+1<C.length;O++)C[O]=C[O+1];C.pop()}function A(C){for(var O=new Array(C.length),j=0;j<O.length;++j)O[j]=C[j].listener||C[j];return O}function S(C,O){return new Promise(function(j,I){function D(G){C.removeListener(O,P),I(G)}function P(){typeof C.removeListener=="function"&&C.removeListener("error",D),j([].slice.call(arguments))}E(C,O,P,{once:!0}),O!=="error"&&T(C,D,{once:!0})})}function T(C,O,j){typeof C.on=="function"&&E(C,"error",O,j)}function E(C,O,j,I){if(typeof C.on=="function")I.once?C.once(O,j):C.on(O,j);else if(typeof C.addEventListener=="function")C.addEventListener(O,function D(P){I.once&&C.removeEventListener(O,D),j(P)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof C)}return qu.exports}var V2=Q2();const F2=Yl(V2),Ft=new F2,aE="https://gsyznlwsezhwerypyzbe.supabase.co",G2="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdzeXpubHdzZXpod2VyeXB5emJlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ2MTYwMzYsImV4cCI6MjA4MDE5MjAzNn0.vLLiGKSTADkaOsUX8386m2MFIJl1Gx-EB4gQLLOAZGA",_i=aE+"/storage/v1/object/public/embodys/",Te=H2(aE,G2);var di={},Sa={},np={},el={},Xb;function oE(){return Xb||(Xb=1,(function(t){var e=el&&el.__awaiter||function(a,l,c,d){function f(h){return h instanceof c?h:new c(function(p){p(h)})}return new(c||(c=Promise))(function(h,p){function m(x){try{_(d.next(x))}catch(w){p(w)}}function y(x){try{_(d.throw(x))}catch(w){p(w)}}function _(x){x.done?h(x.value):f(x.value).then(m,y)}_((d=d.apply(a,l||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.TARGET_URL_HEADER=void 0,t.withMiddleware=n,t.withProxy=s;function n(...a){const l=c=>typeof c=="function";return c=>e(this,void 0,void 0,function*(){let d=Object.assign({},c);for(const f of a.filter(l))d=yield f(d);return d})}t.TARGET_URL_HEADER="x-fal-target-url";function s(a){const l=c=>Promise.resolve(c);return typeof window>"u"?l:c=>c.headers&&t.TARGET_URL_HEADER in c?l(c):Promise.resolve(Object.assign(Object.assign({},c),{url:a.targetUrl,headers:Object.assign(Object.assign({},c.headers||{}),{[t.TARGET_URL_HEADER]:c.url})}))}})(el)),el}var Xn={},Kb;function ji(){if(Kb)return Xn;Kb=1;var t=Xn&&Xn.__awaiter||function(c,d,f,h){function p(m){return m instanceof f?m:new f(function(y){y(m)})}return new(f||(f=Promise))(function(m,y){function _(A){try{w(h.next(A))}catch(S){y(S)}}function x(A){try{w(h.throw(A))}catch(S){y(S)}}function w(A){A.done?m(A.value):p(A.value).then(_,x)}w((h=h.apply(c,d||[])).next())})};Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.ValidationError=Xn.ApiError=void 0,Xn.defaultResponseHandler=a,Xn.resultResponseHandler=l;const e="x-fal-request-id";class n extends Error{constructor({message:d,status:f,body:h,requestId:p}){super(d),this.name="ApiError",this.status=f,this.body=h,this.requestId=p||""}}Xn.ApiError=n;class s extends n{constructor(d){super(d),this.name="ValidationError"}get fieldErrors(){return typeof this.body.detail=="string"?[{loc:["body"],msg:this.body.detail,type:"value_error"}]:this.body.detail||[]}getFieldErrors(d){return this.fieldErrors.filter(f=>f.loc[f.loc.length-1]===d)}}Xn.ValidationError=s;function a(c){return t(this,void 0,void 0,function*(){var d;const{status:f,statusText:h}=c,p=(d=c.headers.get("Content-Type"))!==null&&d!==void 0?d:"",m=c.headers.get(e)||void 0;if(!c.ok){if(p.includes("application/json")){const y=yield c.json(),_=f===422?s:n;throw new _({message:y.message||h,status:f,body:y,requestId:m})}throw new n({message:`HTTP ${f}: ${h}`,status:f,requestId:m})}return p.includes("application/json")?c.json():p.includes("text/html")?c.text():p.includes("application/octet-stream")?c.arrayBuffer():c.text()})}function l(c){return t(this,void 0,void 0,function*(){return{data:yield a(c),requestId:c.headers.get(e)||""}})}return Xn}var tl={},Pn={},Wb;function Ii(){if(Wb)return Pn;Wb=1;var t=Pn&&Pn.__awaiter||function(p,m,y,_){function x(w){return w instanceof y?w:new y(function(A){A(w)})}return new(y||(y=Promise))(function(w,A){function S(C){try{E(_.next(C))}catch(O){A(O)}}function T(C){try{E(_.throw(C))}catch(O){A(O)}}function E(C){C.done?w(C.value):x(C.value).then(S,T)}E((_=_.apply(p,m||[])).next())})};Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.ensureEndpointIdFormat=e,Pn.parseEndpointId=s,Pn.isValidUrl=a,Pn.throttle=l,Pn.isReact=d,Pn.isPlainObject=f,Pn.sleep=h;function e(p){if(p.split("/").length>1)return p;const[,y,_]=/^([0-9]+)-([a-zA-Z0-9-]+)$/.exec(p)||[];if(y&&_)return`${y}/${_}`;throw new Error(`Invalid app id: ${p}. Must be in the format <appOwner>/<appId>`)}const n=["workflows","comfy"];function s(p){const y=e(p).split("/");return n.includes(y[0])?{owner:y[1],alias:y[2],path:y.slice(3).join("/")||void 0,namespace:y[0]}:{owner:y[0],alias:y[1],path:y.slice(2).join("/")||void 0}}function a(p){try{const{host:m}=new URL(p);return/(fal\.(ai|run))$/.test(m)}catch{return!1}}function l(p,m,y=!1){let _,x;return(...w)=>{!x&&y?(p(...w),x=Date.now()):(_&&clearTimeout(_),_=setTimeout(()=>{Date.now()-x>=m&&(p(...w),x=Date.now())},m-(Date.now()-x)))}}let c;function d(){if(c===void 0){const p=new Error().stack;c=!!p&&(p.includes("node_modules/react-dom/")||p.includes("node_modules/next/"))}return c}function f(p){return!!p&&Object.getPrototypeOf(p)===Object.prototype}function h(p){return t(this,void 0,void 0,function*(){return new Promise(m=>setTimeout(m,p))})}return Pn}var Jb;function rf(){return Jb||(Jb=1,(function(t){var e=tl&&tl.__awaiter||function(d,f,h,p){function m(y){return y instanceof h?y:new h(function(_){_(y)})}return new(h||(h=Promise))(function(y,_){function x(S){try{A(p.next(S))}catch(T){_(T)}}function w(S){try{A(p.throw(S))}catch(T){_(T)}}function A(S){S.done?y(S.value):m(S.value).then(x,w)}A((p=p.apply(d,f||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_RETRY_OPTIONS=t.DEFAULT_RETRYABLE_STATUS_CODES=void 0,t.isRetryableError=a,t.calculateBackoffDelay=l,t.executeWithRetry=c;const n=ji(),s=Ii();t.DEFAULT_RETRYABLE_STATUS_CODES=[429,502,503,504],t.DEFAULT_RETRY_OPTIONS={maxRetries:3,baseDelay:1e3,maxDelay:3e4,backoffMultiplier:2,retryableStatusCodes:t.DEFAULT_RETRYABLE_STATUS_CODES,enableJitter:!0};function a(d,f){return d instanceof n.ApiError&&f.includes(d.status)}function l(d,f,h,p,m){const y=Math.min(f*Math.pow(p,d),h);if(m){const _=.25*y*(Math.random()*2-1);return Math.max(0,y+_)}return y}function c(d,f,h){return e(this,void 0,void 0,function*(){const p={totalAttempts:0,totalDelay:0};let m;for(let y=0;y<=f.maxRetries;y++){p.totalAttempts++;try{return{result:yield d(),metrics:p}}catch(_){if(m=_,p.lastError=_,y===f.maxRetries||!a(_,f.retryableStatusCodes))throw _;const x=l(y,f.baseDelay,f.maxDelay,f.backoffMultiplier,f.enableJitter);p.totalDelay+=x,h&&h(y+1,_,x),yield(0,s.sleep)(x)}}throw m})}})(tl)),tl}var nl={};const Y2="@fal-ai/client",X2="1.7.2",K2={name:Y2,version:X2};var Zb;function jg(){if(Zb)return nl;Zb=1,Object.defineProperty(nl,"__esModule",{value:!0}),nl.isBrowser=t,nl.getUserAgent=n;function t(){return typeof window<"u"&&typeof window.document<"u"}let e=null;function n(){if(e!==null)return e;const s=K2;return e=`${s.name}/${s.version}`,e}return nl}var ew;function Ig(){return ew||(ew=1,(function(t){var e={};Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsFromEnv=void 0,t.resolveDefaultFetch=c,t.createConfig=p,t.getRestApiUrl=m;const n=oE(),s=ji(),a=rf(),l=jg();function c(){if(typeof fetch>"u")throw new Error("Your environment does not support fetch. Please provide your own fetch implementation.");return fetch}function d(){return typeof process<"u"&&e&&(typeof e.FAL_KEY<"u"||typeof e.FAL_KEY_ID<"u"&&typeof e.FAL_KEY_SECRET<"u")}const f=()=>{if(d())return typeof e.FAL_KEY<"u"?e.FAL_KEY:e.FAL_KEY_ID?`${e.FAL_KEY_ID}:${e.FAL_KEY_SECRET}`:void 0};t.credentialsFromEnv=f;const h={credentials:t.credentialsFromEnv,suppressLocalCredentialsWarning:!1,requestMiddleware:y=>Promise.resolve(y),responseHandler:s.defaultResponseHandler,retry:a.DEFAULT_RETRY_OPTIONS};function p(y){var _;let x=Object.assign(Object.assign(Object.assign({},h),y),{fetch:(_=y.fetch)!==null&&_!==void 0?_:c(),retry:Object.assign(Object.assign({},a.DEFAULT_RETRY_OPTIONS),y.retry||{})});y.proxyUrl&&(x=Object.assign(Object.assign({},x),{requestMiddleware:(0,n.withMiddleware)(x.requestMiddleware,(0,n.withProxy)({targetUrl:y.proxyUrl}))}));const{credentials:w,suppressLocalCredentialsWarning:A}=x,S=typeof w=="function"?w():w;return(0,l.isBrowser)()&&S&&!A&&console.warn("The fal credentials are exposed in the browser's environment. That's not recommended for production use cases."),x}function m(){return"https://rest.alpha.fal.ai"}})(np)),np}var Hr={},qr={},tw;function ec(){if(tw)return qr;tw=1;var t=qr&&qr.__awaiter||function(f,h,p,m){function y(_){return _ instanceof p?_:new p(function(x){x(_)})}return new(p||(p=Promise))(function(_,x){function w(T){try{S(m.next(T))}catch(E){x(E)}}function A(T){try{S(m.throw(T))}catch(E){x(E)}}function S(T){T.done?_(T.value):y(T.value).then(w,A)}S((m=m.apply(f,h||[])).next())})},e=qr&&qr.__rest||function(f,h){var p={};for(var m in f)Object.prototype.hasOwnProperty.call(f,m)&&h.indexOf(m)<0&&(p[m]=f[m]);if(f!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,m=Object.getOwnPropertySymbols(f);y<m.length;y++)h.indexOf(m[y])<0&&Object.prototype.propertyIsEnumerable.call(f,m[y])&&(p[m[y]]=f[m[y]]);return p};Object.defineProperty(qr,"__esModule",{value:!0}),qr.dispatchRequest=c,qr.buildUrl=d;const n=rf(),s=jg(),a=Ii(),l=typeof navigator<"u"&&navigator?.userAgent==="Cloudflare-Workers";function c(f){return t(this,void 0,void 0,function*(){var h;const{targetUrl:p,input:m,config:y,options:_={}}=f,{credentials:x,requestMiddleware:w,responseHandler:A,fetch:S}=y,T=Object.assign(Object.assign({},y.retry),_.retry||{}),E=()=>t(this,void 0,void 0,function*(){var O,j,I;const D=(0,s.isBrowser)()?{}:{"User-Agent":(0,s.getUserAgent)()},P=typeof x=="function"?x():x,{method:G,url:V,headers:z}=yield w({method:((j=(O=f.method)!==null&&O!==void 0?O:_.method)!==null&&j!==void 0?j:"post").toUpperCase(),url:p,headers:f.headers}),Y=P?{Authorization:`Key ${P}`}:{},H=Object.assign(Object.assign(Object.assign(Object.assign({},Y),{Accept:"application/json","Content-Type":"application/json"}),D),z??{}),{responseHandler:F,retry:N}=_,B=e(_,["responseHandler","retry"]),U=yield S(V,Object.assign(Object.assign(Object.assign(Object.assign({},B),{method:G,headers:Object.assign(Object.assign({},H),(I=B.headers)!==null&&I!==void 0?I:{})}),!l&&{mode:"cors"}),{signal:_.signal,body:G.toLowerCase()!=="get"&&m?JSON.stringify(m):void 0}));return yield(F??A)(U)});let C;for(let O=0;O<=T.maxRetries;O++)try{return yield E()}catch(j){if(C=j,O===T.maxRetries||!(0,n.isRetryableError)(j,T.retryableStatusCodes)||((h=_.signal)===null||h===void 0?void 0:h.aborted))throw j;const D=(0,n.calculateBackoffDelay)(O,T.baseDelay,T.maxDelay,T.backoffMultiplier,T.enableJitter);yield(0,a.sleep)(D)}throw C})}function d(f,h={}){var p,m;const y=((p=h.method)!==null&&p!==void 0?p:"post").toLowerCase(),_=((m=h.path)!==null&&m!==void 0?m:"").replace(/^\//,"").replace(/\/{2,}/,"/"),x=h.input,w=Object.assign(Object.assign({},h.query||{}),y==="get"?x:{}),A=Object.keys(w).length>0?`?${new URLSearchParams(w).toString()}`:"";if((0,a.isValidUrl)(f))return`${f.endsWith("/")?f:`${f}/`}${_}${A}`;const S=(0,a.ensureEndpointIdFormat)(f);return`${`https://${h.subdomain?`${h.subdomain}.`:""}fal.run/${S}/${_}`.replace(/\/$/,"")}${A}`}return qr}var Hn={},Qu={},nw;function W2(){if(nw)return Qu;nw=1,Object.defineProperty(Qu,"__esModule",{value:!0});function t(s){let a,l,c,d,f,h,p;return m(),{feed:y,reset:m};function m(){a=!0,l="",c=0,d=-1,f=void 0,h=void 0,p=""}function y(x){l=l?l+x:x,a&&n(l)&&(l=l.slice(e.length)),a=!1;const w=l.length;let A=0,S=!1;for(;A<w;){S&&(l[A]===`
`&&++A,S=!1);let T=-1,E=d,C;for(let O=c;T<0&&O<w;++O)C=l[O],C===":"&&E<0?E=O-A:C==="\r"?(S=!0,T=O-A):C===`
`&&(T=O-A);if(T<0){c=w-A,d=E;break}else c=0,d=-1;_(l,A,E,T),A+=T+1}A===w?l="":A>0&&(l=l.slice(A))}function _(x,w,A,S){if(S===0){p.length>0&&(s({type:"event",id:f,event:h||void 0,data:p.slice(0,-1)}),p="",f=void 0),h=void 0;return}const T=A<0,E=x.slice(w,w+(T?S:A));let C=0;T?C=S:x[w+A+1]===" "?C=A+2:C=A+1;const O=w+C,j=S-C,I=x.slice(O,O+j).toString();if(E==="data")p+=I?"".concat(I,`
`):`
`;else if(E==="event")h=I;else if(E==="id"&&!I.includes("\0"))f=I;else if(E==="retry"){const D=parseInt(I,10);Number.isNaN(D)||s({type:"reconnect-interval",value:D})}}}const e=[239,187,191];function n(s){return e.every((a,l)=>s.charCodeAt(l)===a)}return Qu.createParser=t,Qu}var rl={},rw;function lE(){return rw||(rw=1,(function(t){var e=rl&&rl.__awaiter||function(c,d,f,h){function p(m){return m instanceof f?m:new f(function(y){y(m)})}return new(f||(f=Promise))(function(m,y){function _(A){try{w(h.next(A))}catch(S){y(S)}}function x(A){try{w(h.throw(A))}catch(S){y(S)}}function w(A){A.done?m(A.value):p(A.value).then(_,x)}w((h=h.apply(c,d||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.TOKEN_EXPIRATION_SECONDS=void 0,t.getTemporaryAuthToken=l;const n=Ig(),s=ec(),a=Ii();t.TOKEN_EXPIRATION_SECONDS=120;function l(c,d){return e(this,void 0,void 0,function*(){const f=(0,a.parseEndpointId)(c),h=yield(0,s.dispatchRequest)({method:"POST",targetUrl:`${(0,n.getRestApiUrl)()}/tokens/`,config:d,input:{allowed_apps:[f.alias],token_expiration:t.TOKEN_EXPIRATION_SECONDS}});return typeof h!="string"&&h.detail?h.detail:h})}})(rl)),rl}var sw;function cE(){if(sw)return Hn;sw=1;var t=Hn&&Hn.__awaiter||function(m,y,_,x){function w(A){return A instanceof _?A:new _(function(S){S(A)})}return new(_||(_=Promise))(function(A,S){function T(O){try{C(x.next(O))}catch(j){S(j)}}function E(O){try{C(x.throw(O))}catch(j){S(j)}}function C(O){O.done?A(O.value):w(O.value).then(T,E)}C((x=x.apply(m,y||[])).next())})},e=Hn&&Hn.__await||function(m){return this instanceof e?(this.v=m,this):new e(m)},n=Hn&&Hn.__asyncGenerator||function(m,y,_){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var x=_.apply(m,y||[]),w,A=[];return w={},T("next"),T("throw"),T("return",S),w[Symbol.asyncIterator]=function(){return this},w;function S(D){return function(P){return Promise.resolve(P).then(D,j)}}function T(D,P){x[D]&&(w[D]=function(G){return new Promise(function(V,z){A.push([D,G,V,z])>1||E(D,G)})},P&&(w[D]=P(w[D])))}function E(D,P){try{C(x[D](P))}catch(G){I(A[0][3],G)}}function C(D){D.value instanceof e?Promise.resolve(D.value.v).then(O,j):I(A[0][2],D)}function O(D){E("next",D)}function j(D){E("throw",D)}function I(D,P){D(P),A.shift(),A.length&&E(A[0][0],A[0][1])}};Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.FalStream=void 0,Hn.createStreamingClient=p;const s=W2(),a=lE(),l=ec(),c=ji(),d="text/event-stream",f=15*1e3;class h{constructor(y,_,x){var w;this.listeners=new Map,this.buffer=[],this.currentData=void 0,this.lastEventTimestamp=0,this.streamClosed=!1,this._requestId=null,this.abortController=new AbortController,this.start=()=>t(this,void 0,void 0,function*(){var A,S;const{endpointId:T,options:E}=this,{input:C,method:O="post",connectionMode:j="server"}=E;try{if(j==="client"){const I=yield(0,a.getTemporaryAuthToken)(T,this.config),{fetch:D}=this.config,P=new URL(this.url);P.searchParams.set("fal_jwt_token",I);const G=yield D(P.toString(),{method:O.toUpperCase(),headers:{accept:(A=E.accept)!==null&&A!==void 0?A:d,"content-type":"application/json"},body:C&&O!=="get"?JSON.stringify(C):void 0,signal:this.abortController.signal});return this._requestId=G.headers.get("x-fal-request-id"),yield this.handleResponse(G)}return yield(0,l.dispatchRequest)({method:O.toUpperCase(),targetUrl:this.url,input:C,config:this.config,options:{headers:{accept:(S=E.accept)!==null&&S!==void 0?S:d},responseHandler:I=>t(this,void 0,void 0,function*(){return this._requestId=I.headers.get("x-fal-request-id"),yield this.handleResponse(I)}),signal:this.abortController.signal}})}catch(I){this.handleError(I)}}),this.handleResponse=A=>t(this,void 0,void 0,function*(){var S,T;if(!A.ok){try{yield(0,c.defaultResponseHandler)(A)}catch(G){this.emit("error",G)}return}const E=A.body;if(!E){this.emit("error",new c.ApiError({message:"Response body is empty.",status:400,body:void 0,requestId:this._requestId||void 0}));return}if(!((S=A.headers.get("content-type"))!==null&&S!==void 0?S:"").startsWith(d)){const G=E.getReader(),V=()=>{G.read().then(({done:z,value:Y})=>{if(z){this.emit("done",this.currentData);return}this.currentData=Y,this.emit("data",Y),V()})};V();return}const O=new TextDecoder("utf-8"),j=A.body.getReader(),I=(0,s.createParser)(G=>{if(G.type==="event"){const V=G.data;try{const z=JSON.parse(V);this.buffer.push(z),this.currentData=z,this.emit("data",z),this.emit("message",z)}catch(z){this.emit("error",z)}}}),D=(T=this.options.timeout)!==null&&T!==void 0?T:f,P=()=>t(this,void 0,void 0,function*(){const{value:G,done:V}=yield j.read();this.lastEventTimestamp=Date.now(),I.feed(O.decode(G)),Date.now()-this.lastEventTimestamp>D&&this.emit("error",new c.ApiError({message:`Event stream timed out after ${(D/1e3).toFixed(0)} seconds with no messages.`,status:408,requestId:this._requestId||void 0})),V?this.emit("done",this.currentData):P().catch(this.handleError)});P().catch(this.handleError)}),this.handleError=A=>{var S;if(A.name==="AbortError"||this.signal.aborted)return;const T=A instanceof c.ApiError?A:new c.ApiError({message:(S=A.message)!==null&&S!==void 0?S:"An unknown error occurred",status:500,requestId:this._requestId||void 0});this.emit("error",T)},this.on=(A,S)=>{var T;this.listeners.has(A)||this.listeners.set(A,[]),(T=this.listeners.get(A))===null||T===void 0||T.push(S)},this.emit=(A,S)=>{const T=this.listeners.get(A)||[];for(const E of T)E(S)},this.done=()=>t(this,void 0,void 0,function*(){return this.donePromise}),this.abort=A=>{this.streamClosed||this.abortController.abort(A)},this.endpointId=y,this.config=_,this.url=(w=x.url)!==null&&w!==void 0?w:(0,l.buildUrl)(y,{path:"/stream",query:x.queryParams}),this.options=x,this.donePromise=new Promise((A,S)=>{this.streamClosed&&S(new c.ApiError({message:"Streaming connection is already closed.",status:400,body:void 0,requestId:this._requestId||void 0})),this.signal.addEventListener("abort",()=>{var T;A((T=this.currentData)!==null&&T!==void 0?T:{})}),this.on("done",T=>{this.streamClosed=!0,A(T)}),this.on("error",T=>{this.streamClosed=!0,S(T)})}),x.signal&&x.signal.addEventListener("abort",()=>{this.abortController.abort()}),this.start().catch(this.handleError)}[Symbol.asyncIterator](){return n(this,arguments,function*(){let _=!0;const x=()=>_=!1;for(this.on("error",x),this.on("done",x);_||this.buffer.length>0;){const w=this.buffer.shift();w&&(yield yield e(w)),yield e(new Promise(A=>setTimeout(A,16)))}})}get signal(){return this.abortController.signal}get requestId(){return this._requestId}}Hn.FalStream=h;function p({config:m,storage:y}){return{stream(_,x){return t(this,void 0,void 0,function*(){const w=x.input?yield y.transformInput(x.input):void 0;return new h(_,m,Object.assign(Object.assign({},x),{input:w}))})}}}return Hn}var iw;function J2(){if(iw)return Hr;iw=1;var t=Hr&&Hr.__awaiter||function(m,y,_,x){function w(A){return A instanceof _?A:new _(function(S){S(A)})}return new(_||(_=Promise))(function(A,S){function T(O){try{C(x.next(O))}catch(j){S(j)}}function E(O){try{C(x.throw(O))}catch(j){S(j)}}function C(O){O.done?A(O.value):w(O.value).then(T,E)}C((x=x.apply(m,y||[])).next())})},e=Hr&&Hr.__rest||function(m,y){var _={};for(var x in m)Object.prototype.hasOwnProperty.call(m,x)&&y.indexOf(x)<0&&(_[x]=m[x]);if(m!=null&&typeof Object.getOwnPropertySymbols=="function")for(var w=0,x=Object.getOwnPropertySymbols(m);w<x.length;w++)y.indexOf(x[w])<0&&Object.prototype.propertyIsEnumerable.call(m,x[w])&&(_[x[w]]=m[x[w]]);return _};Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.createQueueClient=void 0;const n=ec(),s=ji(),a=rf(),l=cE(),c=Ii(),d=500,f={maxRetries:3,baseDelay:1e3,maxDelay:6e4,retryableStatusCodes:a.DEFAULT_RETRYABLE_STATUS_CODES},h={maxRetries:5,baseDelay:1e3,maxDelay:3e4,retryableStatusCodes:[...a.DEFAULT_RETRYABLE_STATUS_CODES,500]},p=({config:m,storage:y})=>{const _={submit(x,w){return t(this,void 0,void 0,function*(){const{webhookUrl:A,priority:S,hint:T}=w,E=e(w,["webhookUrl","priority","hint"]),C=w.input?yield y.transformInput(w.input):void 0;return(0,n.dispatchRequest)({method:w.method,targetUrl:(0,n.buildUrl)(x,Object.assign(Object.assign({},E),{subdomain:"queue",query:A?{fal_webhook:A}:void 0})),headers:Object.assign({"x-fal-queue-priority":S??"normal"},T&&{"x-fal-runner-hint":T}),input:C,config:m,options:{signal:w.abortSignal,retry:f}})})},status(x,w){return t(this,arguments,void 0,function*(A,{requestId:S,logs:T=!1,abortSignal:E}){const C=(0,c.parseEndpointId)(A),O=C.namespace?`${C.namespace}/`:"";return(0,n.dispatchRequest)({method:"get",targetUrl:(0,n.buildUrl)(`${O}${C.owner}/${C.alias}`,{subdomain:"queue",query:{logs:T?"1":"0"},path:`/requests/${S}/status`}),config:m,options:{signal:E,retry:h}})})},streamStatus(x,w){return t(this,arguments,void 0,function*(A,{requestId:S,logs:T=!1,connectionMode:E}){const C=(0,c.parseEndpointId)(A),O=C.namespace?`${C.namespace}/`:"",j={logs:T?"1":"0"},I=(0,n.buildUrl)(`${O}${C.owner}/${C.alias}`,{subdomain:"queue",path:`/requests/${S}/status/stream`,query:j});return new l.FalStream(A,m,{url:I,method:"get",connectionMode:E,queryParams:j})})},subscribeToStatus(x,w){return t(this,void 0,void 0,function*(){const A=w.requestId,S=w.timeout;let T;const E=()=>{};if(w.mode==="streaming"){const C=yield _.streamStatus(x,{requestId:A,logs:w.logs,connectionMode:"connectionMode"in w?w.connectionMode:void 0}),O=[];S&&(T=setTimeout(()=>{throw C.abort(),_.cancel(x,{requestId:A}).catch(E),new Error(`Client timed out waiting for the request to complete after ${S}ms`)},S)),C.on("data",I=>{w.onQueueUpdate&&("logs"in I&&Array.isArray(I.logs)&&I.logs.length>0&&O.push(...I.logs),w.onQueueUpdate("logs"in I?Object.assign(Object.assign({},I),{logs:O}):I))});const j=yield C.done();return T&&clearTimeout(T),j}return new Promise((C,O)=>{var j;let I;const D="pollInterval"in w&&typeof w.pollInterval=="number"&&(j=w.pollInterval)!==null&&j!==void 0?j:d,P=()=>{T&&clearTimeout(T),I&&clearTimeout(I)};S&&(T=setTimeout(()=>{P(),_.cancel(x,{requestId:A}).catch(E),O(new Error(`Client timed out waiting for the request to complete after ${S}ms`))},S));const G=()=>t(this,void 0,void 0,function*(){var V;try{const z=yield _.status(x,{requestId:A,logs:(V=w.logs)!==null&&V!==void 0?V:!1,abortSignal:w.abortSignal});if(w.onQueueUpdate&&w.onQueueUpdate(z),z.status==="COMPLETED"){P(),C(z);return}I=setTimeout(G,D)}catch(z){P(),O(z)}});G().catch(O)})})},result(x,w){return t(this,arguments,void 0,function*(A,{requestId:S,abortSignal:T}){const E=(0,c.parseEndpointId)(A),C=E.namespace?`${E.namespace}/`:"";return(0,n.dispatchRequest)({method:"get",targetUrl:(0,n.buildUrl)(`${C}${E.owner}/${E.alias}`,{subdomain:"queue",path:`/requests/${S}`}),config:Object.assign(Object.assign({},m),{responseHandler:s.resultResponseHandler}),options:{signal:T,retry:f}})})},cancel(x,w){return t(this,arguments,void 0,function*(A,{requestId:S,abortSignal:T}){const E=(0,c.parseEndpointId)(A),C=E.namespace?`${E.namespace}/`:"";yield(0,n.dispatchRequest)({method:"put",targetUrl:(0,n.buildUrl)(`${C}${E.owner}/${E.alias}`,{subdomain:"queue",path:`/requests/${S}/cancel`}),config:m,options:{signal:T}})})}};return _};return Hr.createQueueClient=p,Hr}var Vu={};function Z2(t){const e=t.length;let n=0,s=0;for(;s<e;){let a=t.charCodeAt(s++);if((a&4294967168)===0){n++;continue}else if((a&4294965248)===0)n+=2;else{if(a>=55296&&a<=56319&&s<e){const l=t.charCodeAt(s);(l&64512)===56320&&(++s,a=((a&1023)<<10)+(l&1023)+65536)}(a&4294901760)===0?n+=3:n+=4}}return n}function eI(t,e,n){const s=t.length;let a=n,l=0;for(;l<s;){let c=t.charCodeAt(l++);if((c&4294967168)===0){e[a++]=c;continue}else if((c&4294965248)===0)e[a++]=c>>6&31|192;else{if(c>=55296&&c<=56319&&l<s){const d=t.charCodeAt(l);(d&64512)===56320&&(++l,c=((c&1023)<<10)+(d&1023)+65536)}(c&4294901760)===0?(e[a++]=c>>12&15|224,e[a++]=c>>6&63|128):(e[a++]=c>>18&7|240,e[a++]=c>>12&63|128,e[a++]=c>>6&63|128)}e[a++]=c&63|128}}const tI=new TextEncoder,nI=50;function rI(t,e,n){tI.encodeInto(t,e.subarray(n))}function sI(t,e,n){t.length>nI?rI(t,e,n):eI(t,e,n)}const iI=4096;function uE(t,e,n){let s=e;const a=s+n,l=[];let c="";for(;s<a;){const d=t[s++];if((d&128)===0)l.push(d);else if((d&224)===192){const f=t[s++]&63;l.push((d&31)<<6|f)}else if((d&240)===224){const f=t[s++]&63,h=t[s++]&63;l.push((d&31)<<12|f<<6|h)}else if((d&248)===240){const f=t[s++]&63,h=t[s++]&63,p=t[s++]&63;let m=(d&7)<<18|f<<12|h<<6|p;m>65535&&(m-=65536,l.push(m>>>10&1023|55296),m=56320|m&1023),l.push(m)}else l.push(d);l.length>=iI&&(c+=String.fromCharCode(...l),l.length=0)}return l.length>0&&(c+=String.fromCharCode(...l)),c}const aI=new TextDecoder,oI=200;function lI(t,e,n){const s=t.subarray(e,e+n);return aI.decode(s)}function cI(t,e,n){return n>oI?lI(t,e,n):uE(t,e,n)}class dl{constructor(e,n){this.type=e,this.data=n}}class dn extends Error{constructor(e){super(e);const n=Object.create(dn.prototype);Object.setPrototypeOf(this,n),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:dn.name})}}const sl=4294967295;function uI(t,e,n){const s=n/4294967296,a=n;t.setUint32(e,s),t.setUint32(e+4,a)}function dE(t,e,n){const s=Math.floor(n/4294967296),a=n;t.setUint32(e,s),t.setUint32(e+4,a)}function fE(t,e){const n=t.getInt32(e),s=t.getUint32(e+4);return n*4294967296+s}function dI(t,e){const n=t.getUint32(e),s=t.getUint32(e+4);return n*4294967296+s}const hE=-1,fI=4294967296-1,hI=17179869184-1;function mE({sec:t,nsec:e}){if(t>=0&&e>=0&&t<=hI)if(e===0&&t<=fI){const n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t),n}else{const n=t/4294967296,s=t&4294967295,a=new Uint8Array(8),l=new DataView(a.buffer);return l.setUint32(0,e<<2|n&3),l.setUint32(4,s),a}else{const n=new Uint8Array(12),s=new DataView(n.buffer);return s.setUint32(0,e),dE(s,4,t),n}}function pE(t){const e=t.getTime(),n=Math.floor(e/1e3),s=(e-n*1e3)*1e6,a=Math.floor(s/1e9);return{sec:n+a,nsec:s-a*1e9}}function gE(t){if(t instanceof Date){const e=pE(t);return mE(e)}else return null}function yE(t){const e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const n=e.getUint32(0),s=e.getUint32(4),a=(n&3)*4294967296+s,l=n>>>2;return{sec:a,nsec:l}}case 12:{const n=fE(e,4),s=e.getUint32(0);return{sec:n,nsec:s}}default:throw new dn(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${t.length}`)}}function vE(t){const e=yE(t);return new Date(e.sec*1e3+e.nsec/1e6)}const mI={type:hE,encode:gE,decode:vE};class Bl{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(mI)}register({type:e,encode:n,decode:s}){if(e>=0)this.encoders[e]=n,this.decoders[e]=s;else{const a=-1-e;this.builtInEncoders[a]=n,this.builtInDecoders[a]=s}}tryToEncode(e,n){for(let s=0;s<this.builtInEncoders.length;s++){const a=this.builtInEncoders[s];if(a!=null){const l=a(e,n);if(l!=null){const c=-1-s;return new dl(c,l)}}}for(let s=0;s<this.encoders.length;s++){const a=this.encoders[s];if(a!=null){const l=a(e,n);if(l!=null){const c=s;return new dl(c,l)}}}return e instanceof dl?e:null}decode(e,n,s){const a=n<0?this.builtInDecoders[-1-n]:this.decoders[n];return a?a(e,n,s):new dl(n,e)}}Bl.defaultCodec=new Bl;function pI(t){return t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer}function Pp(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):pI(t)?new Uint8Array(t):Uint8Array.from(t)}const gI=100,yI=2048;class sf{constructor(e){this.entered=!1,this.extensionCodec=e?.extensionCodec??Bl.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.maxDepth=e?.maxDepth??gI,this.initialBufferSize=e?.initialBufferSize??yI,this.sortKeys=e?.sortKeys??!1,this.forceFloat32=e?.forceFloat32??!1,this.ignoreUndefined=e?.ignoreUndefined??!1,this.forceIntegerToFloat=e?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new sf({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,n){if(n>this.maxDepth)throw new Error(`Too deep objects in depth ${n}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,n)}ensureBufferSizeToWrite(e){const n=this.pos+e;this.view.byteLength<n&&this.resizeBuffer(n*2)}resizeBuffer(e){const n=new ArrayBuffer(e),s=new Uint8Array(n),a=new DataView(n);s.set(this.bytes),this.view=a,this.bytes=s}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const s=Z2(e);this.ensureBufferSizeToWrite(5+s),this.writeStringHeader(s),sI(e,this.bytes,this.pos),this.pos+=s}encodeObject(e,n){const s=this.extensionCodec.tryToEncode(e,this.context);if(s!=null)this.encodeExtension(s);else if(Array.isArray(e))this.encodeArray(e,n);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,n);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const n=e.byteLength;if(n<256)this.writeU8(196),this.writeU8(n);else if(n<65536)this.writeU8(197),this.writeU16(n);else if(n<4294967296)this.writeU8(198),this.writeU32(n);else throw new Error(`Too large binary: ${n}`);const s=Pp(e);this.writeU8a(s)}encodeArray(e,n){const s=e.length;if(s<16)this.writeU8(144+s);else if(s<65536)this.writeU8(220),this.writeU16(s);else if(s<4294967296)this.writeU8(221),this.writeU32(s);else throw new Error(`Too large array: ${s}`);for(const a of e)this.doEncode(a,n+1)}countWithoutUndefined(e,n){let s=0;for(const a of n)e[a]!==void 0&&s++;return s}encodeMap(e,n){const s=Object.keys(e);this.sortKeys&&s.sort();const a=this.ignoreUndefined?this.countWithoutUndefined(e,s):s.length;if(a<16)this.writeU8(128+a);else if(a<65536)this.writeU8(222),this.writeU16(a);else if(a<4294967296)this.writeU8(223),this.writeU32(a);else throw new Error(`Too large map object: ${a}`);for(const l of s){const c=e[l];this.ignoreUndefined&&c===void 0||(this.encodeString(l),this.doEncode(c,n+1))}}encodeExtension(e){if(typeof e.data=="function"){const s=e.data(this.pos+6),a=s.length;if(a>=4294967296)throw new Error(`Too large extension object: ${a}`);this.writeU8(201),this.writeU32(a),this.writeI8(e.type),this.writeU8a(s);return}const n=e.data.length;if(n===1)this.writeU8(212);else if(n===2)this.writeU8(213);else if(n===4)this.writeU8(214);else if(n===8)this.writeU8(215);else if(n===16)this.writeU8(216);else if(n<256)this.writeU8(199),this.writeU8(n);else if(n<65536)this.writeU8(200),this.writeU16(n);else if(n<4294967296)this.writeU8(201),this.writeU32(n);else throw new Error(`Too large extension object: ${n}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const n=e.length;this.ensureBufferSizeToWrite(n),this.bytes.set(e,this.pos),this.pos+=n}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),uI(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),dE(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}}function vI(t,e){return new sf(e).encodeSharedRef(t)}function rp(t){return`${t<0?"-":""}0x${Math.abs(t).toString(16).padStart(2,"0")}`}const _I=16,bI=16;class wI{constructor(e=_I,n=bI){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=n,this.caches=[];for(let s=0;s<this.maxKeyLength;s++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,n,s){const a=this.caches[s-1];e:for(const l of a){const c=l.bytes;for(let d=0;d<s;d++)if(c[d]!==e[n+d])continue e;return l.str}return null}store(e,n){const s=this.caches[e.length-1],a={bytes:e,str:n};s.length>=this.maxLengthPerKey?s[Math.random()*s.length|0]=a:s.push(a)}decode(e,n,s){const a=this.find(e,n,s);if(a!=null)return this.hit++,a;this.miss++;const l=uE(e,n,s),c=Uint8Array.prototype.slice.call(e,n,n+s);return this.store(c,l),l}}const Hp="array",Cl="map_key",_E="map_value",xI=t=>{if(typeof t=="string"||typeof t=="number")return t;throw new dn("The type of key must be string or number but "+typeof t)};class AI{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const n=this.getUninitializedStateFromPool();n.type=Hp,n.position=0,n.size=e,n.array=new Array(e)}pushMapState(e){const n=this.getUninitializedStateFromPool();n.type=Cl,n.readCount=0,n.size=e,n.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===Hp){const s=e;s.size=0,s.array=void 0,s.position=0,s.type=void 0}if(e.type===Cl||e.type===_E){const s=e;s.size=0,s.map=void 0,s.readCount=0,s.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const il=-1,kg=new DataView(new ArrayBuffer(0)),EI=new Uint8Array(kg.buffer);try{kg.getInt8(0)}catch(t){if(!(t instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const aw=new RangeError("Insufficient data"),SI=new wI;class qs{constructor(e){this.totalPos=0,this.pos=0,this.view=kg,this.bytes=EI,this.headByte=il,this.stack=new AI,this.entered=!1,this.extensionCodec=e?.extensionCodec??Bl.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??sl,this.maxBinLength=e?.maxBinLength??sl,this.maxArrayLength=e?.maxArrayLength??sl,this.maxMapLength=e?.maxMapLength??sl,this.maxExtLength=e?.maxExtLength??sl,this.keyDecoder=e?.keyDecoder!==void 0?e.keyDecoder:SI,this.mapKeyConverter=e?.mapKeyConverter??xI}clone(){return new qs({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=il,this.stack.reset()}setBuffer(e){const n=Pp(e);this.bytes=n,this.view=new DataView(n.buffer,n.byteOffset,n.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===il&&!this.hasRemaining(1))this.setBuffer(e);else{const n=this.bytes.subarray(this.pos),s=Pp(e),a=new Uint8Array(n.length+s.length);a.set(n),a.set(s,n.length),this.setBuffer(a)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:n,pos:s}=this;return new RangeError(`Extra ${n.byteLength-s} of ${n.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const n=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return n}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let n=!1,s;for await(const d of e){if(n)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(d);try{s=this.doDecodeSync(),n=!0}catch(f){if(!(f instanceof RangeError))throw f}this.totalPos+=this.pos}if(n){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return s}const{headByte:a,pos:l,totalPos:c}=this;throw new RangeError(`Insufficient data in parsing ${rp(a)} at ${c} (${l} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,n){if(this.entered){yield*this.clone().decodeMultiAsync(e,n);return}try{this.entered=!0;let s=n,a=-1;for await(const l of e){if(n&&a===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(l),s&&(a=this.readArraySize(),s=!1,this.complete());try{for(;yield this.doDecodeSync(),--a!==0;);}catch(c){if(!(c instanceof RangeError))throw c}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let n;if(e>=224)n=e-256;else if(e<192)if(e<128)n=e;else if(e<144){const a=e-128;if(a!==0){this.pushMapState(a),this.complete();continue e}else n={}}else if(e<160){const a=e-144;if(a!==0){this.pushArrayState(a),this.complete();continue e}else n=[]}else{const a=e-160;n=this.decodeString(a,0)}else if(e===192)n=null;else if(e===194)n=!1;else if(e===195)n=!0;else if(e===202)n=this.readF32();else if(e===203)n=this.readF64();else if(e===204)n=this.readU8();else if(e===205)n=this.readU16();else if(e===206)n=this.readU32();else if(e===207)this.useBigInt64?n=this.readU64AsBigInt():n=this.readU64();else if(e===208)n=this.readI8();else if(e===209)n=this.readI16();else if(e===210)n=this.readI32();else if(e===211)this.useBigInt64?n=this.readI64AsBigInt():n=this.readI64();else if(e===217){const a=this.lookU8();n=this.decodeString(a,1)}else if(e===218){const a=this.lookU16();n=this.decodeString(a,2)}else if(e===219){const a=this.lookU32();n=this.decodeString(a,4)}else if(e===220){const a=this.readU16();if(a!==0){this.pushArrayState(a),this.complete();continue e}else n=[]}else if(e===221){const a=this.readU32();if(a!==0){this.pushArrayState(a),this.complete();continue e}else n=[]}else if(e===222){const a=this.readU16();if(a!==0){this.pushMapState(a),this.complete();continue e}else n={}}else if(e===223){const a=this.readU32();if(a!==0){this.pushMapState(a),this.complete();continue e}else n={}}else if(e===196){const a=this.lookU8();n=this.decodeBinary(a,1)}else if(e===197){const a=this.lookU16();n=this.decodeBinary(a,2)}else if(e===198){const a=this.lookU32();n=this.decodeBinary(a,4)}else if(e===212)n=this.decodeExtension(1,0);else if(e===213)n=this.decodeExtension(2,0);else if(e===214)n=this.decodeExtension(4,0);else if(e===215)n=this.decodeExtension(8,0);else if(e===216)n=this.decodeExtension(16,0);else if(e===199){const a=this.lookU8();n=this.decodeExtension(a,1)}else if(e===200){const a=this.lookU16();n=this.decodeExtension(a,2)}else if(e===201){const a=this.lookU32();n=this.decodeExtension(a,4)}else throw new dn(`Unrecognized type byte: ${rp(e)}`);this.complete();const s=this.stack;for(;s.length>0;){const a=s.top();if(a.type===Hp)if(a.array[a.position]=n,a.position++,a.position===a.size)n=a.array,s.release(a);else continue e;else if(a.type===Cl){if(n==="__proto__")throw new dn("The key __proto__ is not allowed");a.key=this.mapKeyConverter(n),a.type=_E;continue e}else if(a.map[a.key]=n,a.readCount++,a.readCount===a.size)n=a.map,s.release(a);else{a.key=null,a.type=Cl;continue e}}return n}}readHeadByte(){return this.headByte===il&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=il}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new dn(`Unrecognized array type byte: ${rp(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new dn(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new dn(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,n){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,n):this.decodeBinary(e,n)}decodeUtf8String(e,n){if(e>this.maxStrLength)throw new dn(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+n+e)throw aw;const s=this.pos+n;let a;return this.stateIsMapKey()&&this.keyDecoder?.canBeCached(e)?a=this.keyDecoder.decode(this.bytes,s,e):a=cI(this.bytes,s,e),this.pos+=n+e,a}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===Cl:!1}decodeBinary(e,n){if(e>this.maxBinLength)throw new dn(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+n))throw aw;const s=this.pos+n,a=this.bytes.subarray(s,s+e);return this.pos+=n+e,a}decodeExtension(e,n){if(e>this.maxExtLength)throw new dn(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const s=this.view.getInt8(this.pos+n),a=this.decodeBinary(e,n+1);return this.extensionCodec.decode(a,s,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=dI(this.view,this.pos);return this.pos+=8,e}readI64(){const e=fE(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}}function CI(t,e){return new qs(e).decode(t)}function TI(t,e){return new qs(e).decodeMulti(t)}function NI(t){return t[Symbol.asyncIterator]!=null}async function*RI(t){const e=t.getReader();try{for(;;){const{done:n,value:s}=await e.read();if(n)return;yield s}}finally{e.releaseLock()}}function Mg(t){return NI(t)?t:RI(t)}async function OI(t,e){const n=Mg(t);return new qs(e).decodeAsync(n)}function jI(t,e){const n=Mg(t);return new qs(e).decodeArrayStream(n)}function II(t,e){const n=Mg(t);return new qs(e).decodeStream(n)}const kI=Object.freeze(Object.defineProperty({__proto__:null,DecodeError:dn,Decoder:qs,EXT_TIMESTAMP:hE,Encoder:sf,ExtData:dl,ExtensionCodec:Bl,decode:CI,decodeArrayStream:jI,decodeAsync:OI,decodeMulti:TI,decodeMultiStream:II,decodeTimestampExtension:vE,decodeTimestampToTimeSpec:yE,encode:vI,encodeDateToTimeSpec:pE,encodeTimeSpecToTimestamp:mE,encodeTimestampExtension:gE},Symbol.toStringTag,{value:"Module"})),MI=Kx(kI);var En={},ow;function DI(){if(ow)return En;ow=1,Object.defineProperty(En,"__esModule",{value:!0});function t($){return{enumerable:!0,value:$}}function e($){return{enumerable:!0,writable:!0,value:$}}let n={},s=()=>!0,a=()=>({}),l=$=>$,c=($,Q,M,q)=>$.apply(M,q)&&Q.apply(M,q),d=($,Q,M,[q,X])=>Q.call(M,$.call(M,q,X),X),f=($,Q)=>Object.freeze(Object.create($,Q));function h($,Q,M){return $.reduce((q,X)=>function(...Z){return M(q,X,this,Z)},Q)}function p($){return f(this,{fn:t($)})}let m={},y=p.bind(m),_=$=>y((Q,M)=>!!~$(Q,M)&&Q),x={},w=p.bind(x);function A($,Q){return Q.filter(M=>$.isPrototypeOf(M))}function S($,Q,...M){let q=h(A(x,M).map(Z=>Z.fn),s,c),X=h(A(m,M).map(Z=>Z.fn),l,d);return f(this,{from:t($),to:t(Q),guards:t(q),reducers:t(X)})}let T={},E={},C=S.bind(T),O=S.bind(E,null);function j($,Q,M){return F(Q,$,M,this.immediates)||$}function I($){let Q=new Map;for(let M of $)Q.has(M.from)||Q.set(M.from,[]),Q.get(M.from).push(M);return Q}let D={enter:l};function P(...$){let Q=A(T,$),M=A(E,$),q={final:t($.length===0),transitions:t(I(Q))};return M.length&&(q.immediates=t(M),q.enter=t(j)),f(D,q)}let G={enter($,Q,M){let q=this.fn.call(Q,Q.context,M);return Y.isPrototypeOf(q)?f(V,{machine:t(q),transitions:t(this.transitions)}).enter($,Q,M):(q.then(X=>Q.send({type:"done",data:X})).catch(X=>Q.send({type:"error",error:X})),$)}},V={enter($,Q,M){if(Q.child=U(this.machine,q=>{Q.onChange(q),Q.child==q&&q.machine.state.value.final&&(delete Q.child,Q.send({type:"done",data:q.context}))},Q.context,M),Q.child.machine.state.value.final){let q=Q.child.context;return delete Q.child,F(Q,$,{type:"done",data:q},this.transitions.get("done"))}return $}};function z($,...Q){let M=t(I(Q));return Y.isPrototypeOf($)?f(V,{machine:t($),transitions:M}):f(G,{fn:t($),transitions:M})}let Y={get state(){return{name:this.current,value:this.states[this.current]}}};function H($,Q,M=a){return typeof $!="string"&&(M=Q||a,Q=$,$=Object.keys(Q)[0]),n._create&&n._create($,Q),f(Y,{context:t(M),current:t($),states:t(Q)})}function F($,Q,M,q){let{context:X}=$;for(let{to:Z,guards:J,reducers:ae}of q)if(J(X,M)){$.context=ae.call($,X,M);let ce=Q.original||Q,de=f(ce,{current:t(Z),original:{value:ce}});return n._onEnter&&n._onEnter(Q,Z,$.context,X,M),de.state.value.enter(de,$,M)}}function N($,Q){let M=Q.type||Q,{machine:q}=$,{value:X,name:Z}=q.state;return X.transitions.has(M)?F($,q,Q,X.transitions.get(M))||q:(n._send&&n._send(M,Z),q)}let B={send($){this.machine=N(this,$),this.onChange(this)}};function U($,Q,M,q){let X=Object.create(B,{machine:e($),context:e($.context(M,q)),onChange:t(Q)});return X.send=X.send.bind(X),X.machine=X.machine.state.value.enter(X.machine,X,q),X}return En.action=_,En.createMachine=H,En.d=n,En.guard=w,En.immediate=O,En.interpret=U,En.invoke=z,En.reduce=y,En.state=P,En.transition=C,En}var lw;function BI(){if(lw)return Vu;lw=1,Object.defineProperty(Vu,"__esModule",{value:!0}),Vu.createRealtimeClient=V;const t=MI,e=DI(),n=lE(),s=ji(),a=jg(),l=Ii(),c=()=>({enqueuedMessage:void 0});function d(z){return z.token!==void 0}function f(z){return!d(z)}function h(z,Y){return Object.assign(Object.assign({},z),{enqueuedMessage:Y.message})}function p(z){return z.websocket&&z.websocket.readyState===WebSocket.OPEN&&z.websocket.close(),Object.assign(Object.assign({},z),{websocket:void 0})}function m(z,Y){return z.websocket&&z.websocket.readyState===WebSocket.OPEN?(Y.message instanceof Uint8Array?z.websocket.send(Y.message):z.websocket.send((0,t.encode)(Y.message)),Object.assign(Object.assign({},z),{enqueuedMessage:void 0})):Object.assign(Object.assign({},z),{enqueuedMessage:Y.message})}function y(z){return Object.assign(Object.assign({},z),{token:void 0})}function _(z,Y){return Object.assign(Object.assign({},z),{token:Y.token})}function x(z,Y){return Object.assign(Object.assign({},z),{websocket:Y.websocket})}const w=(0,e.createMachine)("idle",{idle:(0,e.state)((0,e.transition)("send","connecting",(0,e.reduce)(h)),(0,e.transition)("expireToken","idle",(0,e.reduce)(y)),(0,e.transition)("close","idle",(0,e.reduce)(p))),connecting:(0,e.state)((0,e.transition)("connecting","connecting"),(0,e.transition)("connected","active",(0,e.reduce)(x)),(0,e.transition)("connectionClosed","idle",(0,e.reduce)(p)),(0,e.transition)("send","connecting",(0,e.reduce)(h)),(0,e.transition)("close","idle",(0,e.reduce)(p)),(0,e.immediate)("authRequired",(0,e.guard)(f))),authRequired:(0,e.state)((0,e.transition)("initiateAuth","authInProgress"),(0,e.transition)("send","authRequired",(0,e.reduce)(h)),(0,e.transition)("close","idle",(0,e.reduce)(p))),authInProgress:(0,e.state)((0,e.transition)("authenticated","connecting",(0,e.reduce)(_)),(0,e.transition)("unauthorized","idle",(0,e.reduce)(y),(0,e.reduce)(p)),(0,e.transition)("send","authInProgress",(0,e.reduce)(h)),(0,e.transition)("close","idle",(0,e.reduce)(p))),active:(0,e.state)((0,e.transition)("send","active",(0,e.reduce)(m)),(0,e.transition)("unauthorized","idle",(0,e.reduce)(y)),(0,e.transition)("connectionClosed","idle",(0,e.reduce)(p)),(0,e.transition)("close","idle",(0,e.reduce)(p))),failed:(0,e.state)((0,e.transition)("send","failed"),(0,e.transition)("close","idle",(0,e.reduce)(p)))},c);function A(z,{token:Y,maxBuffering:H}){if(H!==void 0&&(H<1||H>60))throw new Error("The `maxBuffering` must be between 1 and 60 (inclusive)");const F=new URLSearchParams({fal_jwt_token:Y});return H!==void 0&&F.set("max_buffering",H.toFixed(0)),`wss://fal.run/${(0,l.ensureEndpointIdFormat)(z)}/realtime?${F.toString()}`}const S=128;function T(z){return z.status==="error"&&z.error==="Unauthorized"}const E={NORMAL_CLOSURE:1e3},C=new Map,O=new Map;function j(z,Y,H){if(!C.has(z)){const F=(0,e.interpret)(w,H);C.set(z,Object.assign(Object.assign({},F),{throttledSend:Y>0?(0,l.throttle)(F.send,Y,!0):F.send}))}return C.get(z)}const I=()=>{},D={send:I,close:I};function P(z){return z.status!=="error"&&z.type!=="x-fal-message"&&!G(z)}function G(z){return z.type==="x-fal-error"}function V({config:z}){return{connect(Y,H){const{clientOnly:F=(0,l.isReact)()&&!(0,a.isBrowser)(),connectionKey:N=crypto.randomUUID(),maxBuffering:B,throttleInterval:U=S}=H;if(F&&!(0,a.isBrowser)())return D;let $;O.set(N,{onError:H.onError,onResult:H.onResult});const Q=()=>O.get(N),M=j(N,U,({context:Z,machine:J,send:ae})=>{const{enqueuedMessage:ce,token:de}=Z;if(J.current==="active"&&ce&&ae({type:"send",message:ce}),J.current==="authRequired"&&de===void 0&&$!==J.current&&(ae({type:"initiateAuth"}),(0,n.getTemporaryAuthToken)(Y,z).then(ie=>{ae({type:"authenticated",token:ie});const oe=Math.round(n.TOKEN_EXPIRATION_SECONDS*.9*1e3);setTimeout(()=>{ae({type:"expireToken"})},oe)}).catch(ie=>{ae({type:"unauthorized",error:ie})})),J.current==="connecting"&&$!==J.current&&de!==void 0){const ie=new WebSocket(A(Y,{token:de,maxBuffering:B}));ie.onopen=()=>{ae({type:"connected",websocket:ie})},ie.onclose=oe=>{if(oe.code!==E.NORMAL_CLOSURE){const{onError:pe=I}=Q();pe(new s.ApiError({message:`Error closing the connection: ${oe.reason}`,status:oe.code}))}ae({type:"connectionClosed",code:oe.code})},ie.onerror=oe=>{const{onError:pe=I}=Q();pe(new s.ApiError({message:"Unknown error",status:500}))},ie.onmessage=oe=>{const{onResult:pe}=Q();if(oe.data instanceof ArrayBuffer){const _e=(0,t.decode)(new Uint8Array(oe.data));pe(_e);return}if(oe.data instanceof Uint8Array){const _e=(0,t.decode)(oe.data);pe(_e);return}if(oe.data instanceof Blob){oe.data.arrayBuffer().then(_e=>{const Me=(0,t.decode)(new Uint8Array(_e));pe(Me)});return}const be=JSON.parse(oe.data);if(T(be)){ae({type:"unauthorized",error:new Error("Unauthorized")});return}if(P(be)){pe(be);return}if(G(be)){if(be.error==="TIMEOUT")return;const{onError:_e=I}=Q();_e(new s.ApiError({message:`${be.error}: ${be.reason}`,status:400,body:be}));return}}}$=J.current});return{send:Z=>{M.throttledSend({type:"send",message:Z})},close:()=>{M.send({type:"close"})}}}}}return Vu}var Is={},cw;function UI(){if(cw)return Is;cw=1;var t=Is&&Is.__awaiter||function(p,m,y,_){function x(w){return w instanceof y?w:new y(function(A){A(w)})}return new(y||(y=Promise))(function(w,A){function S(C){try{E(_.next(C))}catch(O){A(O)}}function T(C){try{E(_.throw(C))}catch(O){A(O)}}function E(C){C.done?w(C.value):x(C.value).then(S,T)}E((_=_.apply(p,m||[])).next())})};Object.defineProperty(Is,"__esModule",{value:!0}),Is.LIFECYCLE_DURATIONS=void 0,Is.createStorageClient=h;const e=Ig(),n=ec(),s=Ii();Is.LIFECYCLE_DURATIONS={ONE_DAY:86400,ONE_WEEK:604800,ONE_MONTH:2592e3,ONE_YEAR:31536e3,UNLIMITED:31536e6};function a(p){var m;const[,y]=p.split("/");return(m=y.split(/[-;]/)[0])!==null&&m!==void 0?m:"bin"}function l(p,m,y,_){return t(this,void 0,void 0,function*(){const x=p.name||`${Date.now()}.${a(y)}`,w={};return _&&(w["X-Fal-Object-Lifecycle"]=JSON.stringify(_)),yield(0,n.dispatchRequest)({method:"POST",targetUrl:`${(0,e.getRestApiUrl)()}/storage/upload/initiate?storage_type=fal-cdn-v3`,input:{content_type:y,file_name:x},config:m,headers:w})})}function c(p,m,y,_){return t(this,void 0,void 0,function*(){const x=p.name||`${Date.now()}.${a(y)}`,w={};return _&&(w["X-Fal-Object-Lifecycle"]=JSON.stringify(_)),yield(0,n.dispatchRequest)({method:"POST",targetUrl:`${(0,e.getRestApiUrl)()}/storage/upload/initiate-multipart?storage_type=fal-cdn-v3`,input:{content_type:y,file_name:x},config:m,headers:w})})}function d(p,m,y){return t(this,arguments,void 0,function*(_,x,w,A=3){if(A===0)throw new Error("Part upload failed, retries exhausted");const{fetch:S,responseHandler:T}=w;try{const E=yield S(_,{method:"PUT",body:x});return yield T(E)}catch{return yield d(_,x,w,A-1)}})}function f(p,m,y){return t(this,void 0,void 0,function*(){const{fetch:_,responseHandler:x}=m,w=p.type||"application/octet-stream",{upload_url:A,file_url:S}=yield c(p,m,w,y),T=10*1024*1024,E=Math.ceil(p.size/T),C=new URL(A),O=[];for(let D=0;D<E;D++){const P=D*T,G=Math.min(P+T,p.size),V=p.slice(P,G),z=D+1,Y=`${C.origin}${C.pathname}/${z}${C.search}`;O.push(yield d(Y,V,m))}const j=`${C.origin}${C.pathname}/complete${C.search}`,I=yield _(j,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({parts:O.map(D=>({partNumber:D.partNumber,etag:D.etag}))})});return yield x(I),S})}function h({config:p}){const m={upload:(y,_)=>t(this,void 0,void 0,function*(){const x=_?.lifecycle;if(y.size>94371840)return yield f(y,p,x);const w=y.type||"application/octet-stream",{fetch:A,responseHandler:S}=p,{upload_url:T,file_url:E}=yield l(y,p,w,x),C=yield A(T,{method:"PUT",body:y,headers:{"Content-Type":y.type||"application/octet-stream"}});return yield S(C),E}),transformInput:y=>t(this,void 0,void 0,function*(){if(Array.isArray(y))return Promise.all(y.map(_=>m.transformInput(_)));if(y instanceof Blob)return yield m.upload(y);if((0,s.isPlainObject)(y)){const x=Object.entries(y).map(A=>t(this,[A],void 0,function*([S,T]){return[S,yield m.transformInput(T)]})),w=yield Promise.all(x);return Object.fromEntries(w)}return y})};return m}return Is}var uw;function dw(){if(uw)return Sa;uw=1;var t=Sa&&Sa.__awaiter||function(h,p,m,y){function _(x){return x instanceof m?x:new m(function(w){w(x)})}return new(m||(m=Promise))(function(x,w){function A(E){try{T(y.next(E))}catch(C){w(C)}}function S(E){try{T(y.throw(E))}catch(C){w(C)}}function T(E){E.done?x(E.value):_(E.value).then(A,S)}T((y=y.apply(h,p||[])).next())})};Object.defineProperty(Sa,"__esModule",{value:!0}),Sa.createFalClient=f;const e=Ig(),n=J2(),s=BI(),a=ec(),l=ji(),c=UI(),d=cE();function f(h={}){const p=(0,e.createConfig)(h),m=(0,c.createStorageClient)({config:p}),y=(0,n.createQueueClient)({config:p,storage:m}),_=(0,d.createStreamingClient)({config:p,storage:m}),x=(0,s.createRealtimeClient)({config:p});return{queue:y,realtime:x,storage:m,streaming:_,stream:_.stream,run(w){return t(this,arguments,void 0,function*(A,S={}){const T=S.input?yield m.transformInput(S.input):void 0;return(0,a.dispatchRequest)({method:S.method,targetUrl:(0,a.buildUrl)(A,S),input:T,config:Object.assign(Object.assign({},p),{responseHandler:l.resultResponseHandler}),options:{signal:S.abortSignal,retry:{maxRetries:3,baseDelay:500,maxDelay:15e3}}})})},subscribe:(w,A)=>t(this,void 0,void 0,function*(){const{request_id:S}=yield y.submit(w,A);return A.onEnqueue&&A.onEnqueue(S),yield y.subscribeToStatus(w,Object.assign({requestId:S},A)),y.result(w,{requestId:S})})}}return Sa}var al={},fw;function LI(){if(fw)return al;fw=1,Object.defineProperty(al,"__esModule",{value:!0}),al.isQueueStatus=t,al.isCompletedQueueStatus=e;function t(n){return n&&n.status&&n.response_url}function e(n){return t(n)&&n.status==="COMPLETED"}return al}var hw;function $I(){return hw||(hw=1,(function(t){var e=di&&di.__createBinding||(Object.create?(function(h,p,m,y){y===void 0&&(y=m);var _=Object.getOwnPropertyDescriptor(p,m);(!_||("get"in _?!p.__esModule:_.writable||_.configurable))&&(_={enumerable:!0,get:function(){return p[m]}}),Object.defineProperty(h,y,_)}):(function(h,p,m,y){y===void 0&&(y=m),h[y]=p[m]})),n=di&&di.__exportStar||function(h,p){for(var m in h)m!=="default"&&!Object.prototype.hasOwnProperty.call(p,m)&&e(p,h,m)};Object.defineProperty(t,"__esModule",{value:!0}),t.fal=t.parseEndpointId=t.isRetryableError=t.ValidationError=t.ApiError=t.withProxy=t.withMiddleware=t.createFalClient=void 0;const s=dw();var a=dw();Object.defineProperty(t,"createFalClient",{enumerable:!0,get:function(){return a.createFalClient}});var l=oE();Object.defineProperty(t,"withMiddleware",{enumerable:!0,get:function(){return l.withMiddleware}}),Object.defineProperty(t,"withProxy",{enumerable:!0,get:function(){return l.withProxy}});var c=ji();Object.defineProperty(t,"ApiError",{enumerable:!0,get:function(){return c.ApiError}}),Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return c.ValidationError}});var d=rf();Object.defineProperty(t,"isRetryableError",{enumerable:!0,get:function(){return d.isRetryableError}}),n(LI(),t);var f=Ii();Object.defineProperty(t,"parseEndpointId",{enumerable:!0,get:function(){return f.parseEndpointId}}),t.fal=(function(){let p=(0,s.createFalClient)();return{config(m){p=(0,s.createFalClient)(m)},get queue(){return p.queue},get realtime(){return p.realtime},get storage(){return p.storage},get streaming(){return p.streaming},run(m,y){return p.run(m,y)},subscribe(m,y){return p.subscribe(m,y)},stream(m,y){return p.stream(m,y)}}})()})(di)),di}var Id=$I();const bE=k.createContext({}),zI=({children:t})=>{const[e,n]=k.useState(null),[s,a]=k.useState(null),[l,c]=k.useState(!1),[d,f]=k.useState(!1),[h,p]=k.useState(""),[m,y]=k.useState(""),[_,x]=k.useState(""),[w,A]=k.useState({}),[S,T]=k.useState({});k.useEffect(()=>{console.log("projectId :",h),h&&E()},[h]);const E=async()=>{if(console.log(" updateEmbodyCache:",h),!h){console.error("Project ID is not set");return}const{data:j,error:I}=await Te.from("embodys").select("name,type,id,prompt").eq("project_id",parseInt(h));if(I){console.error("Error fetching embody data:",I.message);return}A(j.reduce((D,P)=>({...D,[P.id]:P}),{}))},O={user:e,setUser:n,userProfile:s,setUserProfile:a,isCollapsed:l,isProfileLoading:d,projectId:h,setProjectId:p,ep_id:m,setEpId:y,editShotId:_,setEditShotId:x,embodyCache:w,setEmbodyCache:A,deepseekProvider:S,setDeepseekProvider:T,fetchUserProfile:async()=>{if(s){console.log("");return}console.log(""),f(!0);const{data:{user:j}}=await Te.auth.getUser();if(!j)return console.error("User not authenticated"),f(!1),null;n(j);const{data:I,error:D}=await Te.from("profiles").select("*").eq("id",j.id).single();if(D)return console.error("Error fetching user profile:",D.message),f(!1),null;a(I),f(!1)},updateEmbodyCache:E};return b.jsx(bE.Provider,{value:O,children:t})};function _r(){const t=k.useContext(bE);if(!t)throw new Error("useGlobal must be used within a GlobalProvider");return t}function PI(){const{user:t,userProfile:e,fetchUserProfile:n,projectId:s,setProjectId:a,setEpId:l,updateEmbodyCache:c}=_r(),d=Ps();k.useEffect(()=>{n(),Ft.on("StartEditorMode",()=>{f(!0)}),Ft.on("EndEditorMode",()=>{f(!1)}),console.log("LocalStorage:",localStorage.getItem("projectId")),localStorage.getItem("projectId")&&a(localStorage.getItem("projectId")),localStorage.getItem("epId")&&l(localStorage.getItem("epId"))},[]),f(!0);function f(p){const m=document.documentElement;p?(m.style.setProperty("--avatar-size","30px"),m.style.setProperty("--avatar-bacground-color","transparent"),m.style.setProperty("--avatar-bacground-border","none"),m.style.setProperty("--user-text-display","none")):(m.style.setProperty("--avatar-size","50px"),m.style.setProperty("--avatar-bacground-color","#2a2a2a"),m.style.setProperty("--avatar-bacground-border","1px solid #333"),m.style.setProperty("--user-text-display","block"))}function h(){e?.id?d("/profile"):d("/login")}return b.jsxs("div",{className:"user-info-container",onClick:h,children:[b.jsx("img",{src:e?.avatar_url||"./default_avatar.png",alt:"",className:"avatar"}),b.jsxs("div",{className:"user-info-text",children:[b.jsx("p",{children:e?.display_name||""}),b.jsx("p",{children:" : "+e?.gold_coins||"0"})]})]})}function HI(){const[t,e]=k.useState(""),[n,s]=k.useState(""),[a,l]=k.useState(""),[c,d]=k.useState(!1),f=Ps(),h=async p=>{p.preventDefault(),l(""),d(!0);try{const{error:m}=await Te.auth.signInWithPassword({email:t,password:n});if(m){l(m.message);return}f("/profile")}catch{l("")}finally{d(!1)}};return b.jsx("div",{className:"login-container",children:b.jsxs("div",{className:"login-form",children:[b.jsx("h2",{children:""}),a&&b.jsx("p",{className:"error-message",children:a}),b.jsxs("form",{onSubmit:h,children:[b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"email",children:""}),b.jsx("input",{type:"email",id:"email",value:t,onChange:p=>e(p.target.value),required:!0,placeholder:""})]}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"password",children:""}),b.jsx("input",{type:"password",id:"password",value:n,onChange:p=>s(p.target.value),required:!0,placeholder:""})]}),b.jsx("button",{type:"submit",disabled:c,children:c?"...":""}),b.jsx("div",{className:"register-link",children:b.jsxs("p",{children:["",b.jsx(Ai,{to:"/register",children:""})]})})]})]})})}function qI(){const[t,e]=k.useState(""),[n,s]=k.useState(""),[a,l]=k.useState(""),[c,d]=k.useState(""),[f,h]=k.useState(""),[p,m]=k.useState(!1);Ps();const y=async _=>{if(_.preventDefault(),d(""),h(""),!t||!n||!a){d("");return}if(n!==a){d("");return}if(n.length<6){d("6");return}m(!0);try{const{error:x}=await Te.auth.signUp({email:t,password:n});if(x){d(x.message);return}h(""),e(""),s(""),l("")}catch{d("")}finally{m(!1)}};return b.jsx("div",{className:"register-container",children:b.jsxs("div",{className:"register-form",children:[b.jsx("h2",{children:""}),c&&b.jsx("p",{className:"error-message",children:c}),f&&b.jsx("p",{className:"success-message",children:f}),b.jsxs("form",{onSubmit:y,children:[b.jsxs("div",{className:"form-group",children:[b.jsxs("label",{htmlFor:"email",children:[" ",b.jsx("span",{className:"required",children:"*"})]}),b.jsx("input",{type:"email",id:"email",value:t,onChange:_=>e(_.target.value),required:!0,placeholder:""})]}),b.jsxs("div",{className:"form-group",children:[b.jsxs("label",{htmlFor:"password",children:[" ",b.jsx("span",{className:"required",children:"*"})]}),b.jsx("input",{type:"password",id:"password",value:n,onChange:_=>s(_.target.value),required:!0,placeholder:"6"})]}),b.jsxs("div",{className:"form-group",children:[b.jsxs("label",{htmlFor:"confirmPassword",children:[" ",b.jsx("span",{className:"required",children:"*"})]}),b.jsx("input",{type:"password",id:"confirmPassword",value:a,onChange:_=>l(_.target.value),required:!0,placeholder:""})]}),b.jsx("button",{type:"submit",disabled:p,children:p?"...":""}),b.jsx("div",{className:"login-link",children:b.jsxs("p",{children:["",b.jsx(Ai,{to:"/login",children:""})]})})]})]})})}function QI({children:t}){return b.jsx("div",{className:"main-panel-header",children:t})}function VI(){const{user:t,userProfile:e,fetchUserProfile:n,projectId:s,setProjectId:a}=_r(),[l,c]=k.useState(!1),[d,f]=k.useState(""),[h,p]=k.useState(""),[m,y]=k.useState(!1),[_,x]=k.useState(""),[w,A]=k.useState(""),[S,T]=k.useState([]),[E,C]=k.useState(!0),O=Ps(),j=()=>{D(),c(!0)},I=()=>{D(),c(!1)},D=()=>{f(""),p(""),x(""),A("")},P=()=>d.trim()?d.trim().length>50?(x("50"),!1):h.trim().length>200?(x("200"),!1):!0:(x(""),!1),G=()=>{e&&(C(!0),Te.from("projects").select("*").eq("team_id",e?.team_id||null).then(({data:N,error:B})=>{if(C(!1),B){console.error(":",B),x("");return}console.log("projects ",N),T(N)}))},V=async()=>{if(x(""),!!P())try{y(!0);const{error:N}=await Te.from("projects").insert({name:d.trim(),description:h.trim(),user_id:t?.id,team_id:e?.team_id||null});if(N){console.error(":",N),x(""+N.message);return}await G(),A(""),I()}catch(N){x(""+N.message),console.error(":",N.message)}finally{y(!1)}};k.useEffect(()=>{G()},[e]),k.useEffect(()=>{s&&O("/editor")},[]);const z=N=>{N.key==="Enter"&&!N.shiftKey&&(N.preventDefault(),V())},Y=N=>{console.log("set project id ",N.id),a(N.id),Ft.emit("StartEditorMode"),localStorage.setItem("projectId",N.id),O("/editor")},H=(N,B)=>{N.stopPropagation(),globalData.projectId=B.id,localStorage.setItem("projectId",B.id),O("/editor"),Ft.emit("StartEditorMode")},F=(N,B)=>{N.stopPropagation(),window.confirm(`"${B.project_name}"`)&&(console.log(":",B.project_name),Te.from("projects").delete().eq("id",B.id).then(({error:U})=>{if(U){console.error(":",U),x("");return}G(),A("")}))};return b.jsxs("div",{children:[b.jsx(QI,{children:b.jsx("h2",{children:""})}),b.jsx("div",{className:"main-panel-buttons",children:b.jsx("button",{onClick:j,children:""})}),b.jsx("div",{className:`main-panel-content ${S.length===0?"empty":""}`,children:S.length>0?S.map(N=>b.jsxs("div",{className:"project-item",onClick:()=>Y(N),children:[b.jsxs("div",{className:"project-item-content",children:[b.jsx("h4",{children:N.name}),b.jsx("p",{children:N.description})]}),b.jsxs("div",{className:"project-actions",children:[b.jsx("button",{className:"edit-button",onClick:B=>H(B,N),title:"",children:""}),b.jsx("button",{className:"delete-button",onClick:B=>F(B,N),title:"",children:""})]})]},N.id)):E&&b.jsx("div",{className:"loading",children:"..."})}),l&&b.jsx("div",{className:"create-panel-overlay",onClick:I,children:b.jsxs("div",{className:"create-panel",onClick:N=>N.stopPropagation(),children:[b.jsxs("div",{className:"create-panel-header",children:[b.jsx("h3",{children:""}),b.jsx("button",{className:"close-button",onClick:I,disabled:m,children:""})]}),b.jsxs("div",{className:"create-panel-content",children:[_&&b.jsx("div",{className:"error-message",children:_}),w&&b.jsx("div",{className:"success-message",children:w}),b.jsx("input",{type:"text",placeholder:"",className:"story-name-input",value:d,onChange:N=>f(N.target.value),onKeyPress:z,disabled:m||!!w}),b.jsx("textarea",{placeholder:"",className:"story-description-input",value:h,onChange:N=>p(N.target.value),onKeyPress:z,disabled:m||!!w}),b.jsxs("div",{className:"char-count",children:[b.jsxs("span",{children:[": ",d.length,"/50"]}),b.jsxs("span",{children:[": ",h.length,"/200"]})]})]}),b.jsxs("div",{className:"create-panel-footer",children:[b.jsx("button",{className:"cancel-button",onClick:I,disabled:m,children:""}),b.jsxs("button",{className:"confirm-button",onClick:V,disabled:m||!!w,children:[m&&b.jsx("span",{className:"loading-spinner"}),m?"...":""]})]})]})})]})}function FI(){const{user:t,userProfile:e,setProjectId:n,setUserProfile:s,setUser:a,isProfileLoading:l,fetchUserProfile:c}=_r(),[d,f]=k.useState(!1),[h,p]=k.useState(!1),[m,y]=k.useState(""),[_,x]=k.useState(!1),[w,A]=k.useState(""),[S,T]=k.useState("./default_avatar.png"),[E,C]=k.useState(!1),[O,j]=k.useState([]),[I,D]=k.useState(""),[P,G]=k.useState(""),[V,z]=k.useState(""),[Y,H]=k.useState(!1),[F,N]=k.useState("list"),B=Ps();k.useEffect(()=>{e||c()},[]),k.useEffect(()=>{U(),e?.avatar_url&&T(e.avatar_url)},[e]);const U=async()=>{if(!e?.team_id){D("");return}try{const{data:oe,error:pe}=await Te.from("teams").select("name").eq("id",e.team_id).single();pe?(console.error("Error fetching team name:",pe.message),D("")):D(oe.name)}catch(oe){console.error("Error in fetchTeamName:",oe),D("")}},$=async()=>{try{await Te.auth.signOut(),a(null),s(null),n(null),B("/")}catch(oe){console.error(":",oe)}},Q=async()=>{try{const{data:oe,error:pe}=await Te.from("teams").select("id, name").contains("members",[t.id]);if(pe)throw pe;j(oe||[])}catch(oe){console.error(":",oe),z("")}},M=()=>{Q(),z(""),D(""),G(""),N("list"),p(!0)},q=()=>{p(!1),z("")},X=async()=>{if(!I.trim()){z("");return}if(I.length>20){z("20");return}H(!0),z("");try{const{data:oe,error:pe}=await Te.from("teams").insert({name:I.trim(),create_by:t.id,members:[t.id]}).select("id, name");if(pe)throw pe;console.log("newTeam",oe),j(be=>[...be,oe[0]]),D(""),z("","success"),N("list")}catch(oe){console.error(":",oe),z("")}finally{H(!1)}},Z=async()=>{if(!P.trim()){z("");return}H(!0),z("");try{if(await new Promise(oe=>setTimeout(oe,1e3)),P==="INVITE1"){const oe={id:Date.now().toString(),name:"",code:P};j(pe=>[...pe,oe]),G(""),z("","success"),N("list")}else z("")}catch(oe){console.error(":",oe),z("")}finally{H(!1)}},J=async oe=>{H(!0);try{const{error:pe}=await Te.from("profiles").update({team_id:oe.id}).eq("id",t.id);if(pe)throw pe;q(),Ft.emit("updateProfile")}catch(pe){console.error(":",pe),z("")}finally{H(!1)}},ae=()=>{y(profile?.display_name||""),A(""),f(!0)},ce=()=>{f(!1),A("")},de=async oe=>{const pe=oe.target.files[0];if(!pe)return;if(!["image/jpeg","image/png","image/gif","image/webp"].includes(pe.type)){alert("JPG, PNG, GIF, WebP");return}if(pe.size>5*1024*1024){alert("5MB");return}C(!0);try{const _e=`${Date.now()}${pe.name.slice(pe.name.lastIndexOf("."))}`;console.log("avatar filename = ",_e);const{error:Me}=await Te.storage.from("avatars").upload(`${t.id}/${_e}`,pe,{cacheControl:"3600",upsert:!1});if(Me)throw Me;const{data:fe}=Te.storage.from("avatars").getPublicUrl(`${t.id}/${_e}`);console.log("avatar url = ",fe.publicUrl),T(fe.publicUrl);const{error:ve}=await Te.from("profiles").update({avatar_url:fe.publicUrl}).eq("id",t.id);ve&&console.log("update error = ",ve)}catch(_e){console.error(":",_e),alert("")}finally{C(!1),oe.target.value=""}},ie=async()=>{if(!m.trim()){A("");return}if(m.length>10){A("10");return}x(!0),A("");try{const{error:oe}=await Te.from("profiles").update({display_name:m.trim()}).eq("id",t.id);if(oe){console.error(":",oe),A("");return}Ft.emit("updateProfile"),ce()}catch(oe){console.error(":",oe),A("")}finally{x(!1)}};return l?b.jsx("div",{className:"loading",children:"..."}):b.jsxs("div",{className:"profile-container",children:[b.jsxs("div",{className:"profile-header",children:[b.jsx("h1",{children:""}),b.jsx("button",{className:"logout-button",onClick:$,children:""})]}),b.jsx("div",{className:"profile-info",children:b.jsxs("div",{className:"info-section",children:[b.jsx("h2",{children:""}),b.jsxs("div",{className:"avatar-container",onClick:()=>document.getElementById("avatar-upload").click(),children:[E&&b.jsx("div",{className:"avatar-upload-overlay",children:b.jsx("span",{children:"..."})}),b.jsx("img",{src:S||"./default_avatar.png",alt:"",className:"avatar"}),b.jsx("div",{className:"avatar-hint",children:""}),b.jsx("input",{type:"file",id:"avatar-upload",accept:"image/*",style:{display:"none"},onChange:de})]}),b.jsxs("div",{className:"info-item",children:[b.jsx("span",{className:"label",children:""}),b.jsx("span",{className:"value",children:e?.display_name||""}),b.jsx("button",{className:"",onClick:ae,children:""})]}),b.jsxs("div",{className:"info-item",children:[b.jsx("span",{className:"label",children:""}),b.jsx("span",{className:"value",children:e?.gold_coins||"0"}),b.jsx("button",{className:"",children:""})]}),b.jsxs("div",{className:"info-item",children:[b.jsx("span",{className:"label",children:""}),b.jsx("span",{className:"value",children:t?.email||""})]}),b.jsxs("div",{className:"info-item",children:[b.jsx("span",{className:"label",children:""}),b.jsx("span",{className:"value",children:I}),b.jsx("button",{className:"team-switch-button",onClick:M,children:""})]}),b.jsxs("div",{className:"info-item",children:[b.jsx("span",{className:"label",children:""}),b.jsx("span",{className:"value",children:t?.created_at?new Date(t.created_at).toLocaleString():""})]})]})}),d&&b.jsx("div",{className:"modal-overlay",onClick:ce,children:b.jsxs("div",{className:"modal-content",onClick:oe=>oe.stopPropagation(),children:[b.jsxs("div",{className:"modal-header",children:[b.jsx("h3",{children:""}),b.jsx("button",{className:"close-button",onClick:ce,children:""})]}),b.jsxs("div",{className:"modal-body",children:[w&&b.jsx("p",{className:"error-message",children:w}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"displayName",children:""}),b.jsx("input",{type:"text",id:"displayName",value:m,onChange:oe=>y(oe.target.value),placeholder:"",maxLength:50})]})]}),b.jsxs("div",{className:"modal-footer",children:[b.jsx("button",{className:"cancel-button",onClick:ce,children:""}),b.jsx("button",{className:"save-button",onClick:ie,disabled:_,children:_?"...":""})]})]})}),h&&b.jsx("div",{className:"modal-overlay",onClick:q,children:b.jsxs("div",{className:"team-modal-content",onClick:oe=>oe.stopPropagation(),children:[b.jsxs("div",{className:"modal-header",children:[b.jsx("h3",{children:""}),b.jsx("button",{className:"close-button",onClick:q,children:""})]}),b.jsxs("div",{className:"team-modal-tabs",children:[b.jsx("button",{className:`team-tab-button ${F==="list"?"active":""}`,onClick:()=>N("list"),children:""}),b.jsx("button",{className:`team-tab-button ${F==="create"?"active":""}`,onClick:()=>N("create"),children:""}),b.jsx("button",{className:`team-tab-button ${F==="join"?"active":""}`,onClick:()=>N("join"),children:""})]}),b.jsxs("div",{className:"modal-body",children:[V&&b.jsx("p",{className:`${V.includes("")?"success-message":"error-message"}`,children:V}),F==="list"&&b.jsx("div",{className:"team-list",children:O.length===0?b.jsx("p",{className:"empty-message",children:""}):O.map(oe=>b.jsxs("div",{className:"team-item",children:[b.jsx("div",{className:"team-info",children:b.jsx("h4",{children:oe.name})}),b.jsx("button",{className:"switch-team-button",onClick:()=>J(oe),disabled:Y,children:Y?"...":""})]},oe.id))}),F==="create"&&b.jsxs("div",{className:"create-team-form",children:[b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"teamName",children:""}),b.jsx("input",{type:"text",id:"teamName",value:I,onChange:oe=>D(oe.target.value),placeholder:"",maxLength:20,disabled:Y})]}),b.jsx("p",{className:"form-hint",children:""})]}),F==="join"&&b.jsxs("div",{className:"join-team-form",children:[b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"teamCode",children:"ID"}),b.jsx("input",{type:"text",id:"teamCode",value:P,onChange:oe=>G(oe.target.value.toUpperCase()),placeholder:"ID",disabled:Y})]}),b.jsx("p",{className:"form-hint",children:""})]})]}),b.jsxs("div",{className:"modal-footer",children:[F!=="list"&&b.jsx("button",{className:"action-button",onClick:F==="create"?X:Z,disabled:Y,children:Y?"...":F==="create"?"":""}),b.jsx("button",{className:"cancel-button",onClick:q,children:""})]})]})})]})}function GI(){const{user:t,userProfile:e}=_r();return b.jsxs("div",{className:"home-page",children:[b.jsx("h1",{children:""}),b.jsx("p",{children:t?`: ${t.email}`:""})]})}function dd({id:t,type:e,name:n,pic:s,description:a,onEdit:l,onDelete:c}){const[d,f]=k.useState("./no_pic.png");return k.useEffect(()=>{s&&s.length>0?f(_i+s[0].path):f("https://gsyznlwsezhwerypyzbe.supabase.co/storage/v1/object/public/embodys/public/Common/no_pic.png")},[s]),b.jsx(b.Fragment,{children:b.jsxs("div",{className:"embody-card",onClick:()=>l&&l(t),children:[b.jsx("div",{className:"embody-card-image",children:b.jsx("img",{src:d,alt:n})}),b.jsx("p",{className:"embody-card-title",children:n}),b.jsx("button",{className:"embody-delete-btn card-action-btn delete-btn",onClick:()=>c&&c(t),title:"",children:"x"})]})})}function YI(){const{projectId:t,ep_id:e,embodyCache:n,editShotId:s,setEditShotId:a}=_r(),[l,c]=k.useState([]),[d,f]=k.useState({}),[h,p]=k.useState({}),[m,y]=k.useState({}),[_,x]=k.useState({}),[w,A]=k.useState(null),[S,T]=k.useState(null),[E,C]=k.useState(""),[O,j]=k.useState(null),[I,D]=k.useState([]);k.useRef(null);const[P,G]=k.useState([]),[V,z]=k.useState(""),[Y,H]=k.useState(""),[F,N]=k.useState(!1),[B,U]=k.useState([]),[$,Q]=k.useState(""),[M,q]=k.useState([]),[X,Z]=k.useState({}),[J,ae]=k.useState(!1),[ce,de]=k.useState(null),[ie,oe]=k.useState(null),[pe,be]=k.useState(""),[_e,Me]=k.useState(""),[fe,ve]=k.useState(!1),Ie=async ge=>{ve(!0),Te.from("movie_eps").select("title,index").eq("id",e).single().abortSignal(ge.signal).then(({data:Ye,error:lt})=>{if(lt){lt.name==="AbortError"?(console.log(":",lt),ve(!1)):console.log("EP:",lt),ve(!1);return}z(Ye.title||`EP ${Ye.index||""}`),H(Ye.index||"")});const{data:Ee,error:ke}=await Te.from("movie_scs").select(`
        *,
        movie_seqs(
          *,
          movie_shots(
            *
          )
        ).order(index, ascending) 
      `).order("index",{ascending:!0}).abortSignal(ge.signal).eq("ep_id",e);if(ke){console.log(":",ke),ve(!1);return}console.log(":",Ee),Ee.forEach(Ye=>{Ye.movie_seqs.forEach(lt=>{lt.movie_shots.sort((ft,ns)=>ft.index-ns.index),lt.movie_shots.forEach(ft=>{d[ft.id]=ft})})}),G(Ee),ve(!1)};k.useEffect(()=>{if(!e)return;const ge=new AbortController;return Ie(ge),()=>{ge.abort()}},[e]);const Xe=ge=>{alert("")},Je=ge=>{a(ge),console.log(":",ge),Ft.emit("changeEditorMode","edit")},pt=ge=>{window.confirm(""+ge)&&Te.from("movie_seqs").delete().eq("id",ge).then(({data:Ee,error:ke})=>{if(ke){console.error(":",ke);return}console.log(":",Ee),Ie(new AbortController)})};function it(ge,Ee){console.log(":",ge,Ee),T(ge),C(Ee);const ke=d[ge][Ee]||"";if(console.log(ke),j(ke),Ee==="embodys"){var Ye=[];ke.forEach(lt=>{n[lt]?Ye.push(n[lt]):console.error("ID:",lt)}),console.log("emlist",Ye),D(Ye)}}const mn=ge=>({character:"#3498db",item:"#2ecc71",scene:"#e74c3c",:"#f39c12",:"#9b59b6"})[ge]||"#95a5a6",Zt=ge=>!ge||ge===""||ge===""||!Array.isArray(ge)||ge.length===0?"":ge.map((ke,Ye)=>{if(n&&n[ke]){const lt=n[ke],ft=mn(lt.type);return b.jsxs("span",{style:{marginRight:"8px"},children:[b.jsx("span",{style:{color:ft,fontWeight:"bold",marginRight:"2px"},children:lt.name}),Ye<ge.length-1&&", "]},ke)}else return console.log("ID:",ke),b.jsxs("span",{style:{marginRight:"8px",color:"#999"},children:["",Ye<ge.length-1&&", "]},ke)}),dt=ge=>{q(Ee=>Ee.includes(ge)?Ee.filter(ke=>ke!==ge):[...Ee,ge])},pn=()=>{const ge=B.filter(Ye=>M.includes(Ye.id)),Ee=new Set(I.map(Ye=>Ye.name)),ke=ge.filter(Ye=>!Ee.has(Ye.name)).map(Ye=>({id:Ye.id,name:Ye.name,type:Ye.type}));console.log(":",ke),D(Ye=>[...Ye,...ke]),N(!1),q([]),Q("")},In=async ge=>{if(ge.preventDefault(),n){const Ee=Object.values(n);U(Ee),console.log("embodyCache:",Ee.length)}else console.warn("embodyCache"),U([]);N(!0)},nn=ge=>{const Ee=[...I];Ee.splice(ge,1),D(Ee)},gn=()=>{},wr=ge=>{window.confirm(""+ge)&&Te.from("movie_shots").delete().eq("id",ge).then(({data:Ee,error:ke})=>{if(ke){console.error(":",ke);return}console.log(":",Ee),Ie(new AbortController)})},ts=ge=>{window.confirm(""+ge)&&Te.from("movie_scs").delete().eq("id",ge).then(({data:Ee,error:ke})=>{if(ke){console.error(":",ke);return}console.log(":",Ee),Ie(new AbortController)})},to=(ge,Ee)=>{de(ge),oe(Ee),be(""),Me(""),ae(!0)},no=async()=>{if(!pe.trim()){alert("");return}try{const{data:ge,error:Ee}=await Te.from("movie_seqs").select("index").eq("sc_id",ce).order("index",{ascending:!1}).limit(1);let ke=1;!Ee&&ge&&ge.length>0&&(ke=ge[0].index+1);const Ye={sc_id:ce,name:pe.trim(),index:ke},{data:lt,error:ft}=await Te.from("movie_seqs").insert(Ye);if(ft){console.error(":",ft),alert("");return}console.log(":",lt),Ie(new AbortController),ae(!1)}catch(ge){console.error(":",ge),alert("")}},Qn=async()=>{if(!S||!E){console.error("");return}try{let ge=O;if(console.log(O),E==="embodys"){const lt=(Array.isArray(I)?I:[]).filter(ft=>ft&&ft.id);ge=lt.map(ft=>ft.id),console.log(":",lt)}const{data:Ee,error:ke}=await Te.from("movie_shots").update({[E]:ge}).eq("id",S);if(ke){console.error(":",ke),alert("");return}d[S]&&(d[S][E]=ge,f({...d})),await Ie(new AbortController)}catch(ge){console.error(":",ge),alert("")}finally{T(null),C(null),j(""),D([])}},$t=async()=>{try{const{data:ge,error:Ee}=await Te.from("movie_scs").select("index").eq("ep_id",e).order("index",{ascending:!1}).limit(1);let ke=1;!Ee&&ge&&ge.length>0&&(ke=ge[0].index+1);const Ye={ep_id:e,name:"",index:ke},{data:lt,error:ft}=await Te.from("movie_scs").insert(Ye);if(ft){console.error(":",ft),alert("");return}console.log(":",lt),Ie(new AbortController)}catch(ge){console.error(":",ge),alert("")}};return b.jsxs("div",{className:"editor-shots-content",children:[b.jsxs("div",{className:"editor-shots-header",children:[b.jsxs("h3",{className:"ep-number",children:[" ",Y,"   -  ",V]}),b.jsx("button",{className:"add-sc-button",onClick:$t,children:""})]}),b.jsx("div",{className:"editor-shots-container-left",children:P.map(ge=>b.jsxs("div",{className:"sc-card",children:[b.jsxs("div",{className:"sc-card-header",children:[b.jsxs("h3",{className:"sc-name",children:["",ge.index,"-",ge.name]}),b.jsx("button",{className:"add-seq-button",title:"",onClick:()=>ts(ge.id),children:"-"}),b.jsx("button",{className:"add-seq-button",title:"",onClick:()=>to(ge.id,ge.index),children:"+"})]}),b.jsx("div",{className:"sc-seqs",children:ge.movie_seqs.map(Ee=>b.jsxs("div",{className:"seq-item",children:[b.jsxs("div",{className:"seq-item-header",children:[b.jsx("p",{className:"seq-item-name",children:Ee.name}),b.jsx("button",{className:"add-shot-button",title:"",onClick:()=>pt(Ee.id),children:"-"}),b.jsx("button",{className:"add-shot-button",title:"",onClick:()=>Xe(Ee.id),children:"+"})]}),b.jsx("div",{className:"seq-shots",children:b.jsxs("table",{className:"shot-table",children:[b.jsx("thead",{children:b.jsxs("tr",{children:[b.jsx("th",{children:""}),b.jsx("th",{children:""}),b.jsx("th",{children:""}),b.jsx("th",{children:""}),b.jsx("th",{children:""}),b.jsx("th",{children:""})]})}),b.jsx("tbody",{children:Ee.movie_shots.map((ke,Ye)=>b.jsxs("tr",{className:"shot-item",children:[b.jsx("td",{children:ke.index}),b.jsx("td",{children:ke.pic?b.jsx("img",{src:ke.pic,alt:ke.descript||"./shot_thumb_default.png",style:{width:"120px",height:"60px",objectFit:"cover",objectPosition:"center"}}):b.jsx("img",{src:"./shot_thumb_default.png",alt:"",style:{width:"60px",height:"50px",objectFit:"cover",objectPosition:"center"}})}),b.jsx("td",{onClick:()=>it(ke.id,"description"),style:{cursor:"pointer"},children:ke.description||""}),b.jsx("td",{onClick:()=>it(ke.id,"prompt"),style:{cursor:"pointer"},children:ke.prompt||""}),b.jsx("td",{onClick:()=>it(ke.id,"embodys"),style:{cursor:"pointer"},children:Zt(ke.embodys)}),b.jsxs("td",{className:"shot-action-buttons",children:[b.jsx("button",{onClick:()=>Je(ke.id),title:"",className:"op-button op-edit-button",children:""}),b.jsx("button",{onClick:()=>wr(ke.id),title:"",className:"op-button op-delete-button",children:""})]})]},ke.id))})]})})]},Ee.id))})]},ge.index))}),b.jsxs("div",{className:"editor-shots-container-right",style:{display:S?"block":"none"},children:[E==="description"&&b.jsxs("div",{className:"right-edit-field",children:[b.jsx("label",{children:":"}),b.jsx("textarea",{className:"edit-field-textarea",value:O,onChange:ge=>j(ge.target.value)}),b.jsxs("div",{className:"edit-button-container",children:[b.jsx("button",{className:"expand-button",onClick:gn,children:""}),b.jsx("button",{className:"save-button",onClick:Qn,children:""})]})]}),E==="prompt"&&b.jsxs("div",{className:"right-edit-field",children:[b.jsx("label",{children:":"}),b.jsx("textarea",{className:"edit-field-textarea",value:O,onChange:ge=>j(ge.target.value)}),b.jsxs("div",{className:"edit-button-container",children:[b.jsx("button",{className:"expand-button",onClick:gn,children:""}),b.jsx("button",{className:"save-button",onClick:Qn,children:""})]})]}),E==="embodys"&&b.jsxs("div",{className:"right-edit-field",children:[b.jsx("label",{children:":"}),b.jsx("div",{className:"embodys-list-container",children:b.jsx("div",{className:"embodys-list",children:I.map((ge,Ee)=>b.jsxs("div",{className:"embodys-item",children:[b.jsx("span",{className:"embodys-name",children:ge.name}),b.jsx("span",{className:"embodys-type",children:ge.type}),b.jsx("button",{className:"delete-embodys-item",onClick:()=>nn(Ee),children:""})]},Ee))})}),b.jsxs("div",{className:"edit-button-container",children:[b.jsx("button",{className:"add-embodys-button",onClick:In,children:""}),b.jsx("button",{className:"save-button",onClick:Qn,children:""})]})]})]}),J&&b.jsx("div",{className:"modal-overlay",children:b.jsxs("div",{className:"modal-content",children:[b.jsxs("div",{className:"modal-header",children:[b.jsx("h3",{children:""}),b.jsx("button",{className:"modal-close",onClick:()=>ae(!1),children:""})]}),b.jsx("div",{className:"modal-body",children:b.jsxs("div",{className:"form-group",children:[b.jsx("label",{children:":"}),b.jsx("input",{type:"text",value:pe,onChange:ge=>be(ge.target.value),placeholder:"",className:"modal-input"})]})}),b.jsxs("div",{className:"modal-footer",children:[b.jsx("button",{className:"modal-cancel",onClick:()=>ae(!1),children:""}),b.jsx("button",{className:"modal-confirm",onClick:no,children:""})]})]})}),F&&b.jsx("div",{className:"modal-overlay",children:b.jsxs("div",{className:"modal-content embody-select-modal",children:[b.jsxs("div",{className:"modal-header",children:[b.jsx("h3",{children:""}),b.jsx("button",{className:"modal-close",onClick:()=>{N(!1),q([]),Q("")},children:""})]}),b.jsxs("div",{className:"modal-body",children:[b.jsxs("div",{className:"form-group",children:[b.jsx("label",{children:":"}),b.jsx("input",{type:"text",value:$,onChange:ge=>Q(ge.target.value),placeholder:"",className:"modal-input"})]}),b.jsxs("div",{className:"embodys-select-list card-view",children:[B.filter(ge=>ge.name.toLowerCase().includes($.toLowerCase())||ge.description?.toLowerCase().includes($.toLowerCase())).map(ge=>b.jsxs("div",{className:`embody-card-wrapper ${M.includes(ge.id)?"selected":""}`,onClick:Ee=>{Ee.stopPropagation(),dt(ge.id)},children:[b.jsx(dd,{id:ge.id,type:ge.type,name:ge.name,pic:ge.pic,description:ge.description,onEdit:()=>{},onDelete:()=>{}}),M.includes(ge.id)&&b.jsx("div",{className:"card-select-indicator",children:""})]},ge.id)),B.filter(ge=>ge.name.toLowerCase().includes($.toLowerCase())||ge.description?.toLowerCase().includes($.toLowerCase())).length===0&&b.jsx("p",{className:"no-results",children:""})]})]}),b.jsxs("div",{className:"modal-footer",children:[b.jsx("button",{className:"modal-cancel",onClick:()=>{N(!1),q([]),Q("")},children:""}),b.jsxs("button",{className:"modal-confirm",onClick:pn,disabled:M.length===0,children:[" (",M.length,")"]})]})]})})]})}function Ot(t){if(typeof t=="string"||typeof t=="number")return""+t;let e="";if(Array.isArray(t))for(let n=0,s;n<t.length;n++)(s=Ot(t[n]))!==""&&(e+=(e&&" ")+s);else for(let n in t)t[n]&&(e+=(e&&" ")+n);return e}var XI={value:()=>{}};function af(){for(var t=0,e=arguments.length,n={},s;t<e;++t){if(!(s=arguments[t]+"")||s in n||/[\s.]/.test(s))throw new Error("illegal type: "+s);n[s]=[]}return new fd(n)}function fd(t){this._=t}function KI(t,e){return t.trim().split(/^|\s+/).map(function(n){var s="",a=n.indexOf(".");if(a>=0&&(s=n.slice(a+1),n=n.slice(0,a)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:s}})}fd.prototype=af.prototype={constructor:fd,on:function(t,e){var n=this._,s=KI(t+"",n),a,l=-1,c=s.length;if(arguments.length<2){for(;++l<c;)if((a=(t=s[l]).type)&&(a=WI(n[a],t.name)))return a;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++l<c;)if(a=(t=s[l]).type)n[a]=mw(n[a],t.name,e);else if(e==null)for(a in n)n[a]=mw(n[a],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new fd(t)},call:function(t,e){if((a=arguments.length-2)>0)for(var n=new Array(a),s=0,a,l;s<a;++s)n[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(l=this._[t],s=0,a=l.length;s<a;++s)l[s].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var s=this._[t],a=0,l=s.length;a<l;++a)s[a].value.apply(e,n)}};function WI(t,e){for(var n=0,s=t.length,a;n<s;++n)if((a=t[n]).name===e)return a.value}function mw(t,e,n){for(var s=0,a=t.length;s<a;++s)if(t[s].name===e){t[s]=XI,t=t.slice(0,s).concat(t.slice(s+1));break}return n!=null&&t.push({name:e,value:n}),t}var qp="http://www.w3.org/1999/xhtml";const pw={svg:"http://www.w3.org/2000/svg",xhtml:qp,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function of(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),pw.hasOwnProperty(e)?{space:pw[e],local:t}:t}function JI(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===qp&&e.documentElement.namespaceURI===qp?e.createElement(t):e.createElementNS(n,t)}}function ZI(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function wE(t){var e=of(t);return(e.local?ZI:JI)(e)}function ek(){}function Dg(t){return t==null?ek:function(){return this.querySelector(t)}}function tk(t){typeof t!="function"&&(t=Dg(t));for(var e=this._groups,n=e.length,s=new Array(n),a=0;a<n;++a)for(var l=e[a],c=l.length,d=s[a]=new Array(c),f,h,p=0;p<c;++p)(f=l[p])&&(h=t.call(f,f.__data__,p,l))&&("__data__"in f&&(h.__data__=f.__data__),d[p]=h);return new jn(s,this._parents)}function nk(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function rk(){return[]}function xE(t){return t==null?rk:function(){return this.querySelectorAll(t)}}function sk(t){return function(){return nk(t.apply(this,arguments))}}function ik(t){typeof t=="function"?t=sk(t):t=xE(t);for(var e=this._groups,n=e.length,s=[],a=[],l=0;l<n;++l)for(var c=e[l],d=c.length,f,h=0;h<d;++h)(f=c[h])&&(s.push(t.call(f,f.__data__,h,c)),a.push(f));return new jn(s,a)}function AE(t){return function(){return this.matches(t)}}function EE(t){return function(e){return e.matches(t)}}var ak=Array.prototype.find;function ok(t){return function(){return ak.call(this.children,t)}}function lk(){return this.firstElementChild}function ck(t){return this.select(t==null?lk:ok(typeof t=="function"?t:EE(t)))}var uk=Array.prototype.filter;function dk(){return Array.from(this.children)}function fk(t){return function(){return uk.call(this.children,t)}}function hk(t){return this.selectAll(t==null?dk:fk(typeof t=="function"?t:EE(t)))}function mk(t){typeof t!="function"&&(t=AE(t));for(var e=this._groups,n=e.length,s=new Array(n),a=0;a<n;++a)for(var l=e[a],c=l.length,d=s[a]=[],f,h=0;h<c;++h)(f=l[h])&&t.call(f,f.__data__,h,l)&&d.push(f);return new jn(s,this._parents)}function SE(t){return new Array(t.length)}function pk(){return new jn(this._enter||this._groups.map(SE),this._parents)}function kd(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}kd.prototype={constructor:kd,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function gk(t){return function(){return t}}function yk(t,e,n,s,a,l){for(var c=0,d,f=e.length,h=l.length;c<h;++c)(d=e[c])?(d.__data__=l[c],s[c]=d):n[c]=new kd(t,l[c]);for(;c<f;++c)(d=e[c])&&(a[c]=d)}function vk(t,e,n,s,a,l,c){var d,f,h=new Map,p=e.length,m=l.length,y=new Array(p),_;for(d=0;d<p;++d)(f=e[d])&&(y[d]=_=c.call(f,f.__data__,d,e)+"",h.has(_)?a[d]=f:h.set(_,f));for(d=0;d<m;++d)_=c.call(t,l[d],d,l)+"",(f=h.get(_))?(s[d]=f,f.__data__=l[d],h.delete(_)):n[d]=new kd(t,l[d]);for(d=0;d<p;++d)(f=e[d])&&h.get(y[d])===f&&(a[d]=f)}function _k(t){return t.__data__}function bk(t,e){if(!arguments.length)return Array.from(this,_k);var n=e?vk:yk,s=this._parents,a=this._groups;typeof t!="function"&&(t=gk(t));for(var l=a.length,c=new Array(l),d=new Array(l),f=new Array(l),h=0;h<l;++h){var p=s[h],m=a[h],y=m.length,_=wk(t.call(p,p&&p.__data__,h,s)),x=_.length,w=d[h]=new Array(x),A=c[h]=new Array(x),S=f[h]=new Array(y);n(p,m,w,A,S,_,e);for(var T=0,E=0,C,O;T<x;++T)if(C=w[T]){for(T>=E&&(E=T+1);!(O=A[E])&&++E<x;);C._next=O||null}}return c=new jn(c,s),c._enter=d,c._exit=f,c}function wk(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function xk(){return new jn(this._exit||this._groups.map(SE),this._parents)}function Ak(t,e,n){var s=this.enter(),a=this,l=this.exit();return typeof t=="function"?(s=t(s),s&&(s=s.selection())):s=s.append(t+""),e!=null&&(a=e(a),a&&(a=a.selection())),n==null?l.remove():n(l),s&&a?s.merge(a).order():a}function Ek(t){for(var e=t.selection?t.selection():t,n=this._groups,s=e._groups,a=n.length,l=s.length,c=Math.min(a,l),d=new Array(a),f=0;f<c;++f)for(var h=n[f],p=s[f],m=h.length,y=d[f]=new Array(m),_,x=0;x<m;++x)(_=h[x]||p[x])&&(y[x]=_);for(;f<a;++f)d[f]=n[f];return new jn(d,this._parents)}function Sk(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var s=t[e],a=s.length-1,l=s[a],c;--a>=0;)(c=s[a])&&(l&&c.compareDocumentPosition(l)^4&&l.parentNode.insertBefore(c,l),l=c);return this}function Ck(t){t||(t=Tk);function e(m,y){return m&&y?t(m.__data__,y.__data__):!m-!y}for(var n=this._groups,s=n.length,a=new Array(s),l=0;l<s;++l){for(var c=n[l],d=c.length,f=a[l]=new Array(d),h,p=0;p<d;++p)(h=c[p])&&(f[p]=h);f.sort(e)}return new jn(a,this._parents).order()}function Tk(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Nk(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Rk(){return Array.from(this)}function Ok(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var s=t[e],a=0,l=s.length;a<l;++a){var c=s[a];if(c)return c}return null}function jk(){let t=0;for(const e of this)++t;return t}function Ik(){return!this.node()}function kk(t){for(var e=this._groups,n=0,s=e.length;n<s;++n)for(var a=e[n],l=0,c=a.length,d;l<c;++l)(d=a[l])&&t.call(d,d.__data__,l,a);return this}function Mk(t){return function(){this.removeAttribute(t)}}function Dk(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Bk(t,e){return function(){this.setAttribute(t,e)}}function Uk(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Lk(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function $k(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function zk(t,e){var n=of(t);if(arguments.length<2){var s=this.node();return n.local?s.getAttributeNS(n.space,n.local):s.getAttribute(n)}return this.each((e==null?n.local?Dk:Mk:typeof e=="function"?n.local?$k:Lk:n.local?Uk:Bk)(n,e))}function CE(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Pk(t){return function(){this.style.removeProperty(t)}}function Hk(t,e,n){return function(){this.style.setProperty(t,e,n)}}function qk(t,e,n){return function(){var s=e.apply(this,arguments);s==null?this.style.removeProperty(t):this.style.setProperty(t,s,n)}}function Qk(t,e,n){return arguments.length>1?this.each((e==null?Pk:typeof e=="function"?qk:Hk)(t,e,n??"")):Ha(this.node(),t)}function Ha(t,e){return t.style.getPropertyValue(e)||CE(t).getComputedStyle(t,null).getPropertyValue(e)}function Vk(t){return function(){delete this[t]}}function Fk(t,e){return function(){this[t]=e}}function Gk(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Yk(t,e){return arguments.length>1?this.each((e==null?Vk:typeof e=="function"?Gk:Fk)(t,e)):this.node()[t]}function TE(t){return t.trim().split(/^|\s+/)}function Bg(t){return t.classList||new NE(t)}function NE(t){this._node=t,this._names=TE(t.getAttribute("class")||"")}NE.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function RE(t,e){for(var n=Bg(t),s=-1,a=e.length;++s<a;)n.add(e[s])}function OE(t,e){for(var n=Bg(t),s=-1,a=e.length;++s<a;)n.remove(e[s])}function Xk(t){return function(){RE(this,t)}}function Kk(t){return function(){OE(this,t)}}function Wk(t,e){return function(){(e.apply(this,arguments)?RE:OE)(this,t)}}function Jk(t,e){var n=TE(t+"");if(arguments.length<2){for(var s=Bg(this.node()),a=-1,l=n.length;++a<l;)if(!s.contains(n[a]))return!1;return!0}return this.each((typeof e=="function"?Wk:e?Xk:Kk)(n,e))}function Zk(){this.textContent=""}function eM(t){return function(){this.textContent=t}}function tM(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function nM(t){return arguments.length?this.each(t==null?Zk:(typeof t=="function"?tM:eM)(t)):this.node().textContent}function rM(){this.innerHTML=""}function sM(t){return function(){this.innerHTML=t}}function iM(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function aM(t){return arguments.length?this.each(t==null?rM:(typeof t=="function"?iM:sM)(t)):this.node().innerHTML}function oM(){this.nextSibling&&this.parentNode.appendChild(this)}function lM(){return this.each(oM)}function cM(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function uM(){return this.each(cM)}function dM(t){var e=typeof t=="function"?t:wE(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function fM(){return null}function hM(t,e){var n=typeof t=="function"?t:wE(t),s=e==null?fM:typeof e=="function"?e:Dg(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),s.apply(this,arguments)||null)})}function mM(){var t=this.parentNode;t&&t.removeChild(this)}function pM(){return this.each(mM)}function gM(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function yM(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function vM(t){return this.select(t?yM:gM)}function _M(t){return arguments.length?this.property("__data__",t):this.node().__data__}function bM(t){return function(e){t.call(this,e,this.__data__)}}function wM(t){return t.trim().split(/^|\s+/).map(function(e){var n="",s=e.indexOf(".");return s>=0&&(n=e.slice(s+1),e=e.slice(0,s)),{type:e,name:n}})}function xM(t){return function(){var e=this.__on;if(e){for(var n=0,s=-1,a=e.length,l;n<a;++n)l=e[n],(!t.type||l.type===t.type)&&l.name===t.name?this.removeEventListener(l.type,l.listener,l.options):e[++s]=l;++s?e.length=s:delete this.__on}}}function AM(t,e,n){return function(){var s=this.__on,a,l=bM(e);if(s){for(var c=0,d=s.length;c<d;++c)if((a=s[c]).type===t.type&&a.name===t.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=l,a.options=n),a.value=e;return}}this.addEventListener(t.type,l,n),a={type:t.type,name:t.name,value:e,listener:l,options:n},s?s.push(a):this.__on=[a]}}function EM(t,e,n){var s=wM(t+""),a,l=s.length,c;if(arguments.length<2){var d=this.node().__on;if(d){for(var f=0,h=d.length,p;f<h;++f)for(a=0,p=d[f];a<l;++a)if((c=s[a]).type===p.type&&c.name===p.name)return p.value}return}for(d=e?AM:xM,a=0;a<l;++a)this.each(d(s[a],e,n));return this}function jE(t,e,n){var s=CE(t),a=s.CustomEvent;typeof a=="function"?a=new a(e,n):(a=s.document.createEvent("Event"),n?(a.initEvent(e,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(e,!1,!1)),t.dispatchEvent(a)}function SM(t,e){return function(){return jE(this,t,e)}}function CM(t,e){return function(){return jE(this,t,e.apply(this,arguments))}}function TM(t,e){return this.each((typeof e=="function"?CM:SM)(t,e))}function*NM(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var s=t[e],a=0,l=s.length,c;a<l;++a)(c=s[a])&&(yield c)}var IE=[null];function jn(t,e){this._groups=t,this._parents=e}function tc(){return new jn([[document.documentElement]],IE)}function RM(){return this}jn.prototype=tc.prototype={constructor:jn,select:tk,selectAll:ik,selectChild:ck,selectChildren:hk,filter:mk,data:bk,enter:pk,exit:xk,join:Ak,merge:Ek,selection:RM,order:Sk,sort:Ck,call:Nk,nodes:Rk,node:Ok,size:jk,empty:Ik,each:kk,attr:zk,style:Qk,property:Yk,classed:Jk,text:nM,html:aM,raise:lM,lower:uM,append:dM,insert:hM,remove:pM,clone:vM,datum:_M,on:EM,dispatch:TM,[Symbol.iterator]:NM};function On(t){return typeof t=="string"?new jn([[document.querySelector(t)]],[document.documentElement]):new jn([[t]],IE)}function OM(t){let e;for(;e=t.sourceEvent;)t=e;return t}function tr(t,e){if(t=OM(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var s=n.createSVGPoint();return s.x=t.clientX,s.y=t.clientY,s=s.matrixTransform(e.getScreenCTM().inverse()),[s.x,s.y]}if(e.getBoundingClientRect){var a=e.getBoundingClientRect();return[t.clientX-a.left-e.clientLeft,t.clientY-a.top-e.clientTop]}}return[t.pageX,t.pageY]}const jM={passive:!1},Ul={capture:!0,passive:!1};function sp(t){t.stopImmediatePropagation()}function $a(t){t.preventDefault(),t.stopImmediatePropagation()}function kE(t){var e=t.document.documentElement,n=On(t).on("dragstart.drag",$a,Ul);"onselectstart"in e?n.on("selectstart.drag",$a,Ul):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function ME(t,e){var n=t.document.documentElement,s=On(t).on("dragstart.drag",null);e&&(s.on("click.drag",$a,Ul),setTimeout(function(){s.on("click.drag",null)},0)),"onselectstart"in n?s.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Fu=t=>()=>t;function Qp(t,{sourceEvent:e,subject:n,target:s,identifier:a,active:l,x:c,y:d,dx:f,dy:h,dispatch:p}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:s,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:l,enumerable:!0,configurable:!0},x:{value:c,enumerable:!0,configurable:!0},y:{value:d,enumerable:!0,configurable:!0},dx:{value:f,enumerable:!0,configurable:!0},dy:{value:h,enumerable:!0,configurable:!0},_:{value:p}})}Qp.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function IM(t){return!t.ctrlKey&&!t.button}function kM(){return this.parentNode}function MM(t,e){return e??{x:t.x,y:t.y}}function DM(){return navigator.maxTouchPoints||"ontouchstart"in this}function DE(){var t=IM,e=kM,n=MM,s=DM,a={},l=af("start","drag","end"),c=0,d,f,h,p,m=0;function y(C){C.on("mousedown.drag",_).filter(s).on("touchstart.drag",A).on("touchmove.drag",S,jM).on("touchend.drag touchcancel.drag",T).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function _(C,O){if(!(p||!t.call(this,C,O))){var j=E(this,e.call(this,C,O),C,O,"mouse");j&&(On(C.view).on("mousemove.drag",x,Ul).on("mouseup.drag",w,Ul),kE(C.view),sp(C),h=!1,d=C.clientX,f=C.clientY,j("start",C))}}function x(C){if($a(C),!h){var O=C.clientX-d,j=C.clientY-f;h=O*O+j*j>m}a.mouse("drag",C)}function w(C){On(C.view).on("mousemove.drag mouseup.drag",null),ME(C.view,h),$a(C),a.mouse("end",C)}function A(C,O){if(t.call(this,C,O)){var j=C.changedTouches,I=e.call(this,C,O),D=j.length,P,G;for(P=0;P<D;++P)(G=E(this,I,C,O,j[P].identifier,j[P]))&&(sp(C),G("start",C,j[P]))}}function S(C){var O=C.changedTouches,j=O.length,I,D;for(I=0;I<j;++I)(D=a[O[I].identifier])&&($a(C),D("drag",C,O[I]))}function T(C){var O=C.changedTouches,j=O.length,I,D;for(p&&clearTimeout(p),p=setTimeout(function(){p=null},500),I=0;I<j;++I)(D=a[O[I].identifier])&&(sp(C),D("end",C,O[I]))}function E(C,O,j,I,D,P){var G=l.copy(),V=tr(P||j,O),z,Y,H;if((H=n.call(C,new Qp("beforestart",{sourceEvent:j,target:y,identifier:D,active:c,x:V[0],y:V[1],dx:0,dy:0,dispatch:G}),I))!=null)return z=H.x-V[0]||0,Y=H.y-V[1]||0,function F(N,B,U){var $=V,Q;switch(N){case"start":a[D]=F,Q=c++;break;case"end":delete a[D],--c;case"drag":V=tr(U||B,O),Q=c;break}G.call(N,C,new Qp(N,{sourceEvent:B,subject:H,target:y,identifier:D,active:Q,x:V[0]+z,y:V[1]+Y,dx:V[0]-$[0],dy:V[1]-$[1],dispatch:G}),I)}}return y.filter=function(C){return arguments.length?(t=typeof C=="function"?C:Fu(!!C),y):t},y.container=function(C){return arguments.length?(e=typeof C=="function"?C:Fu(C),y):e},y.subject=function(C){return arguments.length?(n=typeof C=="function"?C:Fu(C),y):n},y.touchable=function(C){return arguments.length?(s=typeof C=="function"?C:Fu(!!C),y):s},y.on=function(){var C=l.on.apply(l,arguments);return C===l?y:C},y.clickDistance=function(C){return arguments.length?(m=(C=+C)*C,y):Math.sqrt(m)},y}function Ug(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function BE(t,e){var n=Object.create(t.prototype);for(var s in e)n[s]=e[s];return n}function nc(){}var Ll=.7,Md=1/Ll,za="\\s*([+-]?\\d+)\\s*",$l="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",gr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",BM=/^#([0-9a-f]{3,8})$/,UM=new RegExp(`^rgb\\(${za},${za},${za}\\)$`),LM=new RegExp(`^rgb\\(${gr},${gr},${gr}\\)$`),$M=new RegExp(`^rgba\\(${za},${za},${za},${$l}\\)$`),zM=new RegExp(`^rgba\\(${gr},${gr},${gr},${$l}\\)$`),PM=new RegExp(`^hsl\\(${$l},${gr},${gr}\\)$`),HM=new RegExp(`^hsla\\(${$l},${gr},${gr},${$l}\\)$`),gw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ug(nc,Ci,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:yw,formatHex:yw,formatHex8:qM,formatHsl:QM,formatRgb:vw,toString:vw});function yw(){return this.rgb().formatHex()}function qM(){return this.rgb().formatHex8()}function QM(){return UE(this).formatHsl()}function vw(){return this.rgb().formatRgb()}function Ci(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=BM.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?_w(e):n===3?new hn(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Gu(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Gu(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=UM.exec(t))?new hn(e[1],e[2],e[3],1):(e=LM.exec(t))?new hn(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=$M.exec(t))?Gu(e[1],e[2],e[3],e[4]):(e=zM.exec(t))?Gu(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=PM.exec(t))?xw(e[1],e[2]/100,e[3]/100,1):(e=HM.exec(t))?xw(e[1],e[2]/100,e[3]/100,e[4]):gw.hasOwnProperty(t)?_w(gw[t]):t==="transparent"?new hn(NaN,NaN,NaN,0):null}function _w(t){return new hn(t>>16&255,t>>8&255,t&255,1)}function Gu(t,e,n,s){return s<=0&&(t=e=n=NaN),new hn(t,e,n,s)}function VM(t){return t instanceof nc||(t=Ci(t)),t?(t=t.rgb(),new hn(t.r,t.g,t.b,t.opacity)):new hn}function Vp(t,e,n,s){return arguments.length===1?VM(t):new hn(t,e,n,s??1)}function hn(t,e,n,s){this.r=+t,this.g=+e,this.b=+n,this.opacity=+s}Ug(hn,Vp,BE(nc,{brighter(t){return t=t==null?Md:Math.pow(Md,t),new hn(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Ll:Math.pow(Ll,t),new hn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new hn(Ei(this.r),Ei(this.g),Ei(this.b),Dd(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:bw,formatHex:bw,formatHex8:FM,formatRgb:ww,toString:ww}));function bw(){return`#${bi(this.r)}${bi(this.g)}${bi(this.b)}`}function FM(){return`#${bi(this.r)}${bi(this.g)}${bi(this.b)}${bi((isNaN(this.opacity)?1:this.opacity)*255)}`}function ww(){const t=Dd(this.opacity);return`${t===1?"rgb(":"rgba("}${Ei(this.r)}, ${Ei(this.g)}, ${Ei(this.b)}${t===1?")":`, ${t})`}`}function Dd(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Ei(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function bi(t){return t=Ei(t),(t<16?"0":"")+t.toString(16)}function xw(t,e,n,s){return s<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new nr(t,e,n,s)}function UE(t){if(t instanceof nr)return new nr(t.h,t.s,t.l,t.opacity);if(t instanceof nc||(t=Ci(t)),!t)return new nr;if(t instanceof nr)return t;t=t.rgb();var e=t.r/255,n=t.g/255,s=t.b/255,a=Math.min(e,n,s),l=Math.max(e,n,s),c=NaN,d=l-a,f=(l+a)/2;return d?(e===l?c=(n-s)/d+(n<s)*6:n===l?c=(s-e)/d+2:c=(e-n)/d+4,d/=f<.5?l+a:2-l-a,c*=60):d=f>0&&f<1?0:c,new nr(c,d,f,t.opacity)}function GM(t,e,n,s){return arguments.length===1?UE(t):new nr(t,e,n,s??1)}function nr(t,e,n,s){this.h=+t,this.s=+e,this.l=+n,this.opacity=+s}Ug(nr,GM,BE(nc,{brighter(t){return t=t==null?Md:Math.pow(Md,t),new nr(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Ll:Math.pow(Ll,t),new nr(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,s=n+(n<.5?n:1-n)*e,a=2*n-s;return new hn(ip(t>=240?t-240:t+120,a,s),ip(t,a,s),ip(t<120?t+240:t-120,a,s),this.opacity)},clamp(){return new nr(Aw(this.h),Yu(this.s),Yu(this.l),Dd(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Dd(this.opacity);return`${t===1?"hsl(":"hsla("}${Aw(this.h)}, ${Yu(this.s)*100}%, ${Yu(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Aw(t){return t=(t||0)%360,t<0?t+360:t}function Yu(t){return Math.max(0,Math.min(1,t||0))}function ip(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Lg=t=>()=>t;function YM(t,e){return function(n){return t+n*e}}function XM(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(s){return Math.pow(t+s*e,n)}}function KM(t){return(t=+t)==1?LE:function(e,n){return n-e?XM(e,n,t):Lg(isNaN(e)?n:e)}}function LE(t,e){var n=e-t;return n?YM(t,n):Lg(isNaN(t)?e:t)}const Bd=(function t(e){var n=KM(e);function s(a,l){var c=n((a=Vp(a)).r,(l=Vp(l)).r),d=n(a.g,l.g),f=n(a.b,l.b),h=LE(a.opacity,l.opacity);return function(p){return a.r=c(p),a.g=d(p),a.b=f(p),a.opacity=h(p),a+""}}return s.gamma=t,s})(1);function WM(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,s=e.slice(),a;return function(l){for(a=0;a<n;++a)s[a]=t[a]*(1-l)+e[a]*l;return s}}function JM(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function ZM(t,e){var n=e?e.length:0,s=t?Math.min(n,t.length):0,a=new Array(s),l=new Array(n),c;for(c=0;c<s;++c)a[c]=Tl(t[c],e[c]);for(;c<n;++c)l[c]=e[c];return function(d){for(c=0;c<s;++c)l[c]=a[c](d);return l}}function eD(t,e){var n=new Date;return t=+t,e=+e,function(s){return n.setTime(t*(1-s)+e*s),n}}function mr(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function tD(t,e){var n={},s={},a;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(a in e)a in t?n[a]=Tl(t[a],e[a]):s[a]=e[a];return function(l){for(a in n)s[a]=n[a](l);return s}}var Fp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ap=new RegExp(Fp.source,"g");function nD(t){return function(){return t}}function rD(t){return function(e){return t(e)+""}}function $E(t,e){var n=Fp.lastIndex=ap.lastIndex=0,s,a,l,c=-1,d=[],f=[];for(t=t+"",e=e+"";(s=Fp.exec(t))&&(a=ap.exec(e));)(l=a.index)>n&&(l=e.slice(n,l),d[c]?d[c]+=l:d[++c]=l),(s=s[0])===(a=a[0])?d[c]?d[c]+=a:d[++c]=a:(d[++c]=null,f.push({i:c,x:mr(s,a)})),n=ap.lastIndex;return n<e.length&&(l=e.slice(n),d[c]?d[c]+=l:d[++c]=l),d.length<2?f[0]?rD(f[0].x):nD(e):(e=f.length,function(h){for(var p=0,m;p<e;++p)d[(m=f[p]).i]=m.x(h);return d.join("")})}function Tl(t,e){var n=typeof e,s;return e==null||n==="boolean"?Lg(e):(n==="number"?mr:n==="string"?(s=Ci(e))?(e=s,Bd):$E:e instanceof Ci?Bd:e instanceof Date?eD:JM(e)?WM:Array.isArray(e)?ZM:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?tD:mr)(t,e)}var Ew=180/Math.PI,Gp={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function zE(t,e,n,s,a,l){var c,d,f;return(c=Math.sqrt(t*t+e*e))&&(t/=c,e/=c),(f=t*n+e*s)&&(n-=t*f,s-=e*f),(d=Math.sqrt(n*n+s*s))&&(n/=d,s/=d,f/=d),t*s<e*n&&(t=-t,e=-e,f=-f,c=-c),{translateX:a,translateY:l,rotate:Math.atan2(e,t)*Ew,skewX:Math.atan(f)*Ew,scaleX:c,scaleY:d}}var Xu;function sD(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Gp:zE(e.a,e.b,e.c,e.d,e.e,e.f)}function iD(t){return t==null||(Xu||(Xu=document.createElementNS("http://www.w3.org/2000/svg","g")),Xu.setAttribute("transform",t),!(t=Xu.transform.baseVal.consolidate()))?Gp:(t=t.matrix,zE(t.a,t.b,t.c,t.d,t.e,t.f))}function PE(t,e,n,s){function a(h){return h.length?h.pop()+" ":""}function l(h,p,m,y,_,x){if(h!==m||p!==y){var w=_.push("translate(",null,e,null,n);x.push({i:w-4,x:mr(h,m)},{i:w-2,x:mr(p,y)})}else(m||y)&&_.push("translate("+m+e+y+n)}function c(h,p,m,y){h!==p?(h-p>180?p+=360:p-h>180&&(h+=360),y.push({i:m.push(a(m)+"rotate(",null,s)-2,x:mr(h,p)})):p&&m.push(a(m)+"rotate("+p+s)}function d(h,p,m,y){h!==p?y.push({i:m.push(a(m)+"skewX(",null,s)-2,x:mr(h,p)}):p&&m.push(a(m)+"skewX("+p+s)}function f(h,p,m,y,_,x){if(h!==m||p!==y){var w=_.push(a(_)+"scale(",null,",",null,")");x.push({i:w-4,x:mr(h,m)},{i:w-2,x:mr(p,y)})}else(m!==1||y!==1)&&_.push(a(_)+"scale("+m+","+y+")")}return function(h,p){var m=[],y=[];return h=t(h),p=t(p),l(h.translateX,h.translateY,p.translateX,p.translateY,m,y),c(h.rotate,p.rotate,m,y),d(h.skewX,p.skewX,m,y),f(h.scaleX,h.scaleY,p.scaleX,p.scaleY,m,y),h=p=null,function(_){for(var x=-1,w=y.length,A;++x<w;)m[(A=y[x]).i]=A.x(_);return m.join("")}}}var aD=PE(sD,"px, ","px)","deg)"),oD=PE(iD,", ",")",")"),lD=1e-12;function Sw(t){return((t=Math.exp(t))+1/t)/2}function cD(t){return((t=Math.exp(t))-1/t)/2}function uD(t){return((t=Math.exp(2*t))-1)/(t+1)}const hd=(function t(e,n,s){function a(l,c){var d=l[0],f=l[1],h=l[2],p=c[0],m=c[1],y=c[2],_=p-d,x=m-f,w=_*_+x*x,A,S;if(w<lD)S=Math.log(y/h)/e,A=function(I){return[d+I*_,f+I*x,h*Math.exp(e*I*S)]};else{var T=Math.sqrt(w),E=(y*y-h*h+s*w)/(2*h*n*T),C=(y*y-h*h-s*w)/(2*y*n*T),O=Math.log(Math.sqrt(E*E+1)-E),j=Math.log(Math.sqrt(C*C+1)-C);S=(j-O)/e,A=function(I){var D=I*S,P=Sw(O),G=h/(n*T)*(P*uD(e*D+O)-cD(O));return[d+G*_,f+G*x,h*P/Sw(e*D+O)]}}return A.duration=S*1e3*e/Math.SQRT2,A}return a.rho=function(l){var c=Math.max(.001,+l),d=c*c,f=d*d;return t(c,d,f)},a})(Math.SQRT2,2,4);var qa=0,fl=0,ol=0,HE=1e3,Ud,hl,Ld=0,Ti=0,lf=0,zl=typeof performance=="object"&&performance.now?performance:Date,qE=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function $g(){return Ti||(qE(dD),Ti=zl.now()+lf)}function dD(){Ti=0}function $d(){this._call=this._time=this._next=null}$d.prototype=QE.prototype={constructor:$d,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?$g():+n)+(e==null?0:+e),!this._next&&hl!==this&&(hl?hl._next=this:Ud=this,hl=this),this._call=t,this._time=n,Yp()},stop:function(){this._call&&(this._call=null,this._time=1/0,Yp())}};function QE(t,e,n){var s=new $d;return s.restart(t,e,n),s}function fD(){$g(),++qa;for(var t=Ud,e;t;)(e=Ti-t._time)>=0&&t._call.call(void 0,e),t=t._next;--qa}function Cw(){Ti=(Ld=zl.now())+lf,qa=fl=0;try{fD()}finally{qa=0,mD(),Ti=0}}function hD(){var t=zl.now(),e=t-Ld;e>HE&&(lf-=e,Ld=t)}function mD(){for(var t,e=Ud,n,s=1/0;e;)e._call?(s>e._time&&(s=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Ud=n);hl=t,Yp(s)}function Yp(t){if(!qa){fl&&(fl=clearTimeout(fl));var e=t-Ti;e>24?(t<1/0&&(fl=setTimeout(Cw,t-zl.now()-lf)),ol&&(ol=clearInterval(ol))):(ol||(Ld=zl.now(),ol=setInterval(hD,HE)),qa=1,qE(Cw))}}function Tw(t,e,n){var s=new $d;return e=e==null?0:+e,s.restart(a=>{s.stop(),t(a+e)},e,n),s}var pD=af("start","end","cancel","interrupt"),gD=[],VE=0,Nw=1,Xp=2,md=3,Rw=4,Kp=5,pd=6;function cf(t,e,n,s,a,l){var c=t.__transition;if(!c)t.__transition={};else if(n in c)return;yD(t,n,{name:e,index:s,group:a,on:pD,tween:gD,time:l.time,delay:l.delay,duration:l.duration,ease:l.ease,timer:null,state:VE})}function zg(t,e){var n=ar(t,e);if(n.state>VE)throw new Error("too late; already scheduled");return n}function br(t,e){var n=ar(t,e);if(n.state>md)throw new Error("too late; already running");return n}function ar(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function yD(t,e,n){var s=t.__transition,a;s[e]=n,n.timer=QE(l,0,n.time);function l(h){n.state=Nw,n.timer.restart(c,n.delay,n.time),n.delay<=h&&c(h-n.delay)}function c(h){var p,m,y,_;if(n.state!==Nw)return f();for(p in s)if(_=s[p],_.name===n.name){if(_.state===md)return Tw(c);_.state===Rw?(_.state=pd,_.timer.stop(),_.on.call("interrupt",t,t.__data__,_.index,_.group),delete s[p]):+p<e&&(_.state=pd,_.timer.stop(),_.on.call("cancel",t,t.__data__,_.index,_.group),delete s[p])}if(Tw(function(){n.state===md&&(n.state=Rw,n.timer.restart(d,n.delay,n.time),d(h))}),n.state=Xp,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Xp){for(n.state=md,a=new Array(y=n.tween.length),p=0,m=-1;p<y;++p)(_=n.tween[p].value.call(t,t.__data__,n.index,n.group))&&(a[++m]=_);a.length=m+1}}function d(h){for(var p=h<n.duration?n.ease.call(null,h/n.duration):(n.timer.restart(f),n.state=Kp,1),m=-1,y=a.length;++m<y;)a[m].call(t,p);n.state===Kp&&(n.on.call("end",t,t.__data__,n.index,n.group),f())}function f(){n.state=pd,n.timer.stop(),delete s[e];for(var h in s)return;delete t.__transition}}function gd(t,e){var n=t.__transition,s,a,l=!0,c;if(n){e=e==null?null:e+"";for(c in n){if((s=n[c]).name!==e){l=!1;continue}a=s.state>Xp&&s.state<Kp,s.state=pd,s.timer.stop(),s.on.call(a?"interrupt":"cancel",t,t.__data__,s.index,s.group),delete n[c]}l&&delete t.__transition}}function vD(t){return this.each(function(){gd(this,t)})}function _D(t,e){var n,s;return function(){var a=br(this,t),l=a.tween;if(l!==n){s=n=l;for(var c=0,d=s.length;c<d;++c)if(s[c].name===e){s=s.slice(),s.splice(c,1);break}}a.tween=s}}function bD(t,e,n){var s,a;if(typeof n!="function")throw new Error;return function(){var l=br(this,t),c=l.tween;if(c!==s){a=(s=c).slice();for(var d={name:e,value:n},f=0,h=a.length;f<h;++f)if(a[f].name===e){a[f]=d;break}f===h&&a.push(d)}l.tween=a}}function wD(t,e){var n=this._id;if(t+="",arguments.length<2){for(var s=ar(this.node(),n).tween,a=0,l=s.length,c;a<l;++a)if((c=s[a]).name===t)return c.value;return null}return this.each((e==null?_D:bD)(n,t,e))}function Pg(t,e,n){var s=t._id;return t.each(function(){var a=br(this,s);(a.value||(a.value={}))[e]=n.apply(this,arguments)}),function(a){return ar(a,s).value[e]}}function FE(t,e){var n;return(typeof e=="number"?mr:e instanceof Ci?Bd:(n=Ci(e))?(e=n,Bd):$E)(t,e)}function xD(t){return function(){this.removeAttribute(t)}}function AD(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ED(t,e,n){var s,a=n+"",l;return function(){var c=this.getAttribute(t);return c===a?null:c===s?l:l=e(s=c,n)}}function SD(t,e,n){var s,a=n+"",l;return function(){var c=this.getAttributeNS(t.space,t.local);return c===a?null:c===s?l:l=e(s=c,n)}}function CD(t,e,n){var s,a,l;return function(){var c,d=n(this),f;return d==null?void this.removeAttribute(t):(c=this.getAttribute(t),f=d+"",c===f?null:c===s&&f===a?l:(a=f,l=e(s=c,d)))}}function TD(t,e,n){var s,a,l;return function(){var c,d=n(this),f;return d==null?void this.removeAttributeNS(t.space,t.local):(c=this.getAttributeNS(t.space,t.local),f=d+"",c===f?null:c===s&&f===a?l:(a=f,l=e(s=c,d)))}}function ND(t,e){var n=of(t),s=n==="transform"?oD:FE;return this.attrTween(t,typeof e=="function"?(n.local?TD:CD)(n,s,Pg(this,"attr."+t,e)):e==null?(n.local?AD:xD)(n):(n.local?SD:ED)(n,s,e))}function RD(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function OD(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function jD(t,e){var n,s;function a(){var l=e.apply(this,arguments);return l!==s&&(n=(s=l)&&OD(t,l)),n}return a._value=e,a}function ID(t,e){var n,s;function a(){var l=e.apply(this,arguments);return l!==s&&(n=(s=l)&&RD(t,l)),n}return a._value=e,a}function kD(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var s=of(t);return this.tween(n,(s.local?jD:ID)(s,e))}function MD(t,e){return function(){zg(this,t).delay=+e.apply(this,arguments)}}function DD(t,e){return e=+e,function(){zg(this,t).delay=e}}function BD(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?MD:DD)(e,t)):ar(this.node(),e).delay}function UD(t,e){return function(){br(this,t).duration=+e.apply(this,arguments)}}function LD(t,e){return e=+e,function(){br(this,t).duration=e}}function $D(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?UD:LD)(e,t)):ar(this.node(),e).duration}function zD(t,e){if(typeof e!="function")throw new Error;return function(){br(this,t).ease=e}}function PD(t){var e=this._id;return arguments.length?this.each(zD(e,t)):ar(this.node(),e).ease}function HD(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;br(this,t).ease=n}}function qD(t){if(typeof t!="function")throw new Error;return this.each(HD(this._id,t))}function QD(t){typeof t!="function"&&(t=AE(t));for(var e=this._groups,n=e.length,s=new Array(n),a=0;a<n;++a)for(var l=e[a],c=l.length,d=s[a]=[],f,h=0;h<c;++h)(f=l[h])&&t.call(f,f.__data__,h,l)&&d.push(f);return new Wr(s,this._parents,this._name,this._id)}function VD(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,s=e.length,a=n.length,l=Math.min(s,a),c=new Array(s),d=0;d<l;++d)for(var f=e[d],h=n[d],p=f.length,m=c[d]=new Array(p),y,_=0;_<p;++_)(y=f[_]||h[_])&&(m[_]=y);for(;d<s;++d)c[d]=e[d];return new Wr(c,this._parents,this._name,this._id)}function FD(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function GD(t,e,n){var s,a,l=FD(e)?zg:br;return function(){var c=l(this,t),d=c.on;d!==s&&(a=(s=d).copy()).on(e,n),c.on=a}}function YD(t,e){var n=this._id;return arguments.length<2?ar(this.node(),n).on.on(t):this.each(GD(n,t,e))}function XD(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function KD(){return this.on("end.remove",XD(this._id))}function WD(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Dg(t));for(var s=this._groups,a=s.length,l=new Array(a),c=0;c<a;++c)for(var d=s[c],f=d.length,h=l[c]=new Array(f),p,m,y=0;y<f;++y)(p=d[y])&&(m=t.call(p,p.__data__,y,d))&&("__data__"in p&&(m.__data__=p.__data__),h[y]=m,cf(h[y],e,n,y,h,ar(p,n)));return new Wr(l,this._parents,e,n)}function JD(t){var e=this._name,n=this._id;typeof t!="function"&&(t=xE(t));for(var s=this._groups,a=s.length,l=[],c=[],d=0;d<a;++d)for(var f=s[d],h=f.length,p,m=0;m<h;++m)if(p=f[m]){for(var y=t.call(p,p.__data__,m,f),_,x=ar(p,n),w=0,A=y.length;w<A;++w)(_=y[w])&&cf(_,e,n,w,y,x);l.push(y),c.push(p)}return new Wr(l,c,e,n)}var ZD=tc.prototype.constructor;function eB(){return new ZD(this._groups,this._parents)}function tB(t,e){var n,s,a;return function(){var l=Ha(this,t),c=(this.style.removeProperty(t),Ha(this,t));return l===c?null:l===n&&c===s?a:a=e(n=l,s=c)}}function GE(t){return function(){this.style.removeProperty(t)}}function nB(t,e,n){var s,a=n+"",l;return function(){var c=Ha(this,t);return c===a?null:c===s?l:l=e(s=c,n)}}function rB(t,e,n){var s,a,l;return function(){var c=Ha(this,t),d=n(this),f=d+"";return d==null&&(f=d=(this.style.removeProperty(t),Ha(this,t))),c===f?null:c===s&&f===a?l:(a=f,l=e(s=c,d))}}function sB(t,e){var n,s,a,l="style."+e,c="end."+l,d;return function(){var f=br(this,t),h=f.on,p=f.value[l]==null?d||(d=GE(e)):void 0;(h!==n||a!==p)&&(s=(n=h).copy()).on(c,a=p),f.on=s}}function iB(t,e,n){var s=(t+="")=="transform"?aD:FE;return e==null?this.styleTween(t,tB(t,s)).on("end.style."+t,GE(t)):typeof e=="function"?this.styleTween(t,rB(t,s,Pg(this,"style."+t,e))).each(sB(this._id,t)):this.styleTween(t,nB(t,s,e),n).on("end.style."+t,null)}function aB(t,e,n){return function(s){this.style.setProperty(t,e.call(this,s),n)}}function oB(t,e,n){var s,a;function l(){var c=e.apply(this,arguments);return c!==a&&(s=(a=c)&&aB(t,c,n)),s}return l._value=e,l}function lB(t,e,n){var s="style."+(t+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(e==null)return this.tween(s,null);if(typeof e!="function")throw new Error;return this.tween(s,oB(t,e,n??""))}function cB(t){return function(){this.textContent=t}}function uB(t){return function(){var e=t(this);this.textContent=e??""}}function dB(t){return this.tween("text",typeof t=="function"?uB(Pg(this,"text",t)):cB(t==null?"":t+""))}function fB(t){return function(e){this.textContent=t.call(this,e)}}function hB(t){var e,n;function s(){var a=t.apply(this,arguments);return a!==n&&(e=(n=a)&&fB(a)),e}return s._value=t,s}function mB(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,hB(t))}function pB(){for(var t=this._name,e=this._id,n=YE(),s=this._groups,a=s.length,l=0;l<a;++l)for(var c=s[l],d=c.length,f,h=0;h<d;++h)if(f=c[h]){var p=ar(f,e);cf(f,t,n,h,c,{time:p.time+p.delay+p.duration,delay:0,duration:p.duration,ease:p.ease})}return new Wr(s,this._parents,t,n)}function gB(){var t,e,n=this,s=n._id,a=n.size();return new Promise(function(l,c){var d={value:c},f={value:function(){--a===0&&l()}};n.each(function(){var h=br(this,s),p=h.on;p!==t&&(e=(t=p).copy(),e._.cancel.push(d),e._.interrupt.push(d),e._.end.push(f)),h.on=e}),a===0&&l()})}var yB=0;function Wr(t,e,n,s){this._groups=t,this._parents=e,this._name=n,this._id=s}function YE(){return++yB}var Qr=tc.prototype;Wr.prototype={constructor:Wr,select:WD,selectAll:JD,selectChild:Qr.selectChild,selectChildren:Qr.selectChildren,filter:QD,merge:VD,selection:eB,transition:pB,call:Qr.call,nodes:Qr.nodes,node:Qr.node,size:Qr.size,empty:Qr.empty,each:Qr.each,on:YD,attr:ND,attrTween:kD,style:iB,styleTween:lB,text:dB,textTween:mB,remove:KD,tween:wD,delay:BD,duration:$D,ease:PD,easeVarying:qD,end:gB,[Symbol.iterator]:Qr[Symbol.iterator]};function vB(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var _B={time:null,delay:0,duration:250,ease:vB};function bB(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function wB(t){var e,n;t instanceof Wr?(e=t._id,t=t._name):(e=YE(),(n=_B).time=$g(),t=t==null?null:t+"");for(var s=this._groups,a=s.length,l=0;l<a;++l)for(var c=s[l],d=c.length,f,h=0;h<d;++h)(f=c[h])&&cf(f,t,e,h,c,n||bB(f,e));return new Wr(s,this._parents,t,e)}tc.prototype.interrupt=vD;tc.prototype.transition=wB;const Ku=t=>()=>t;function xB(t,{sourceEvent:e,target:n,transform:s,dispatch:a}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:s,enumerable:!0,configurable:!0},_:{value:a}})}function Yr(t,e,n){this.k=t,this.x=e,this.y=n}Yr.prototype={constructor:Yr,scale:function(t){return t===1?this:new Yr(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Yr(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var uf=new Yr(1,0,0);XE.prototype=Yr.prototype;function XE(t){for(;!t.__zoom;)if(!(t=t.parentNode))return uf;return t.__zoom}function op(t){t.stopImmediatePropagation()}function ll(t){t.preventDefault(),t.stopImmediatePropagation()}function AB(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function EB(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function Ow(){return this.__zoom||uf}function SB(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function CB(){return navigator.maxTouchPoints||"ontouchstart"in this}function TB(t,e,n){var s=t.invertX(e[0][0])-n[0][0],a=t.invertX(e[1][0])-n[1][0],l=t.invertY(e[0][1])-n[0][1],c=t.invertY(e[1][1])-n[1][1];return t.translate(a>s?(s+a)/2:Math.min(0,s)||Math.max(0,a),c>l?(l+c)/2:Math.min(0,l)||Math.max(0,c))}function KE(){var t=AB,e=EB,n=TB,s=SB,a=CB,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],d=250,f=hd,h=af("start","zoom","end"),p,m,y,_=500,x=150,w=0,A=10;function S(H){H.property("__zoom",Ow).on("wheel.zoom",D,{passive:!1}).on("mousedown.zoom",P).on("dblclick.zoom",G).filter(a).on("touchstart.zoom",V).on("touchmove.zoom",z).on("touchend.zoom touchcancel.zoom",Y).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}S.transform=function(H,F,N,B){var U=H.selection?H.selection():H;U.property("__zoom",Ow),H!==U?O(H,F,N,B):U.interrupt().each(function(){j(this,arguments).event(B).start().zoom(null,typeof F=="function"?F.apply(this,arguments):F).end()})},S.scaleBy=function(H,F,N,B){S.scaleTo(H,function(){var U=this.__zoom.k,$=typeof F=="function"?F.apply(this,arguments):F;return U*$},N,B)},S.scaleTo=function(H,F,N,B){S.transform(H,function(){var U=e.apply(this,arguments),$=this.__zoom,Q=N==null?C(U):typeof N=="function"?N.apply(this,arguments):N,M=$.invert(Q),q=typeof F=="function"?F.apply(this,arguments):F;return n(E(T($,q),Q,M),U,c)},N,B)},S.translateBy=function(H,F,N,B){S.transform(H,function(){return n(this.__zoom.translate(typeof F=="function"?F.apply(this,arguments):F,typeof N=="function"?N.apply(this,arguments):N),e.apply(this,arguments),c)},null,B)},S.translateTo=function(H,F,N,B,U){S.transform(H,function(){var $=e.apply(this,arguments),Q=this.__zoom,M=B==null?C($):typeof B=="function"?B.apply(this,arguments):B;return n(uf.translate(M[0],M[1]).scale(Q.k).translate(typeof F=="function"?-F.apply(this,arguments):-F,typeof N=="function"?-N.apply(this,arguments):-N),$,c)},B,U)};function T(H,F){return F=Math.max(l[0],Math.min(l[1],F)),F===H.k?H:new Yr(F,H.x,H.y)}function E(H,F,N){var B=F[0]-N[0]*H.k,U=F[1]-N[1]*H.k;return B===H.x&&U===H.y?H:new Yr(H.k,B,U)}function C(H){return[(+H[0][0]+ +H[1][0])/2,(+H[0][1]+ +H[1][1])/2]}function O(H,F,N,B){H.on("start.zoom",function(){j(this,arguments).event(B).start()}).on("interrupt.zoom end.zoom",function(){j(this,arguments).event(B).end()}).tween("zoom",function(){var U=this,$=arguments,Q=j(U,$).event(B),M=e.apply(U,$),q=N==null?C(M):typeof N=="function"?N.apply(U,$):N,X=Math.max(M[1][0]-M[0][0],M[1][1]-M[0][1]),Z=U.__zoom,J=typeof F=="function"?F.apply(U,$):F,ae=f(Z.invert(q).concat(X/Z.k),J.invert(q).concat(X/J.k));return function(ce){if(ce===1)ce=J;else{var de=ae(ce),ie=X/de[2];ce=new Yr(ie,q[0]-de[0]*ie,q[1]-de[1]*ie)}Q.zoom(null,ce)}})}function j(H,F,N){return!N&&H.__zooming||new I(H,F)}function I(H,F){this.that=H,this.args=F,this.active=0,this.sourceEvent=null,this.extent=e.apply(H,F),this.taps=0}I.prototype={event:function(H){return H&&(this.sourceEvent=H),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(H,F){return this.mouse&&H!=="mouse"&&(this.mouse[1]=F.invert(this.mouse[0])),this.touch0&&H!=="touch"&&(this.touch0[1]=F.invert(this.touch0[0])),this.touch1&&H!=="touch"&&(this.touch1[1]=F.invert(this.touch1[0])),this.that.__zoom=F,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(H){var F=On(this.that).datum();h.call(H,this.that,new xB(H,{sourceEvent:this.sourceEvent,target:S,transform:this.that.__zoom,dispatch:h}),F)}};function D(H,...F){if(!t.apply(this,arguments))return;var N=j(this,F).event(H),B=this.__zoom,U=Math.max(l[0],Math.min(l[1],B.k*Math.pow(2,s.apply(this,arguments)))),$=tr(H);if(N.wheel)(N.mouse[0][0]!==$[0]||N.mouse[0][1]!==$[1])&&(N.mouse[1]=B.invert(N.mouse[0]=$)),clearTimeout(N.wheel);else{if(B.k===U)return;N.mouse=[$,B.invert($)],gd(this),N.start()}ll(H),N.wheel=setTimeout(Q,x),N.zoom("mouse",n(E(T(B,U),N.mouse[0],N.mouse[1]),N.extent,c));function Q(){N.wheel=null,N.end()}}function P(H,...F){if(y||!t.apply(this,arguments))return;var N=H.currentTarget,B=j(this,F,!0).event(H),U=On(H.view).on("mousemove.zoom",q,!0).on("mouseup.zoom",X,!0),$=tr(H,N),Q=H.clientX,M=H.clientY;kE(H.view),op(H),B.mouse=[$,this.__zoom.invert($)],gd(this),B.start();function q(Z){if(ll(Z),!B.moved){var J=Z.clientX-Q,ae=Z.clientY-M;B.moved=J*J+ae*ae>w}B.event(Z).zoom("mouse",n(E(B.that.__zoom,B.mouse[0]=tr(Z,N),B.mouse[1]),B.extent,c))}function X(Z){U.on("mousemove.zoom mouseup.zoom",null),ME(Z.view,B.moved),ll(Z),B.event(Z).end()}}function G(H,...F){if(t.apply(this,arguments)){var N=this.__zoom,B=tr(H.changedTouches?H.changedTouches[0]:H,this),U=N.invert(B),$=N.k*(H.shiftKey?.5:2),Q=n(E(T(N,$),B,U),e.apply(this,F),c);ll(H),d>0?On(this).transition().duration(d).call(O,Q,B,H):On(this).call(S.transform,Q,B,H)}}function V(H,...F){if(t.apply(this,arguments)){var N=H.touches,B=N.length,U=j(this,F,H.changedTouches.length===B).event(H),$,Q,M,q;for(op(H),Q=0;Q<B;++Q)M=N[Q],q=tr(M,this),q=[q,this.__zoom.invert(q),M.identifier],U.touch0?!U.touch1&&U.touch0[2]!==q[2]&&(U.touch1=q,U.taps=0):(U.touch0=q,$=!0,U.taps=1+!!p);p&&(p=clearTimeout(p)),$&&(U.taps<2&&(m=q[0],p=setTimeout(function(){p=null},_)),gd(this),U.start())}}function z(H,...F){if(this.__zooming){var N=j(this,F).event(H),B=H.changedTouches,U=B.length,$,Q,M,q;for(ll(H),$=0;$<U;++$)Q=B[$],M=tr(Q,this),N.touch0&&N.touch0[2]===Q.identifier?N.touch0[0]=M:N.touch1&&N.touch1[2]===Q.identifier&&(N.touch1[0]=M);if(Q=N.that.__zoom,N.touch1){var X=N.touch0[0],Z=N.touch0[1],J=N.touch1[0],ae=N.touch1[1],ce=(ce=J[0]-X[0])*ce+(ce=J[1]-X[1])*ce,de=(de=ae[0]-Z[0])*de+(de=ae[1]-Z[1])*de;Q=T(Q,Math.sqrt(ce/de)),M=[(X[0]+J[0])/2,(X[1]+J[1])/2],q=[(Z[0]+ae[0])/2,(Z[1]+ae[1])/2]}else if(N.touch0)M=N.touch0[0],q=N.touch0[1];else return;N.zoom("touch",n(E(Q,M,q),N.extent,c))}}function Y(H,...F){if(this.__zooming){var N=j(this,F).event(H),B=H.changedTouches,U=B.length,$,Q;for(op(H),y&&clearTimeout(y),y=setTimeout(function(){y=null},_),$=0;$<U;++$)Q=B[$],N.touch0&&N.touch0[2]===Q.identifier?delete N.touch0:N.touch1&&N.touch1[2]===Q.identifier&&delete N.touch1;if(N.touch1&&!N.touch0&&(N.touch0=N.touch1,delete N.touch1),N.touch0)N.touch0[1]=this.__zoom.invert(N.touch0[0]);else if(N.end(),N.taps===2&&(Q=tr(Q,this),Math.hypot(m[0]-Q[0],m[1]-Q[1])<A)){var M=On(this).on("dblclick.zoom");M&&M.apply(this,arguments)}}}return S.wheelDelta=function(H){return arguments.length?(s=typeof H=="function"?H:Ku(+H),S):s},S.filter=function(H){return arguments.length?(t=typeof H=="function"?H:Ku(!!H),S):t},S.touchable=function(H){return arguments.length?(a=typeof H=="function"?H:Ku(!!H),S):a},S.extent=function(H){return arguments.length?(e=typeof H=="function"?H:Ku([[+H[0][0],+H[0][1]],[+H[1][0],+H[1][1]]]),S):e},S.scaleExtent=function(H){return arguments.length?(l[0]=+H[0],l[1]=+H[1],S):[l[0],l[1]]},S.translateExtent=function(H){return arguments.length?(c[0][0]=+H[0][0],c[1][0]=+H[1][0],c[0][1]=+H[0][1],c[1][1]=+H[1][1],S):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},S.constrain=function(H){return arguments.length?(n=H,S):n},S.duration=function(H){return arguments.length?(d=+H,S):d},S.interpolate=function(H){return arguments.length?(f=H,S):f},S.on=function(){var H=h.on.apply(h,arguments);return H===h?S:H},S.clickDistance=function(H){return arguments.length?(w=(H=+H)*H,S):Math.sqrt(w)},S.tapDistance=function(H){return arguments.length?(A=+H,S):A},S}const ir={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:t=>`Node type "${t}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:t=>`The old edge with id=${t} does not exist.`,error009:t=>`Marker type "${t}" doesn't exist.`,error008:(t,{id:e,sourceHandle:n,targetHandle:s})=>`Couldn't create edge for ${t} handle id: "${t==="source"?n:s}", edge id: ${e}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:t=>`Edge type "${t}" not found. Using fallback type "default".`,error012:t=>`Node with id "${t}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(t="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${t}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},Pl=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],WE=["Enter"," ","Escape"],JE={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:t,x:e,y:n})=>`Moved selected node ${t}. New position, x: ${e}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Qa;(function(t){t.Strict="strict",t.Loose="loose"})(Qa||(Qa={}));var Si;(function(t){t.Free="free",t.Vertical="vertical",t.Horizontal="horizontal"})(Si||(Si={}));var Hl;(function(t){t.Partial="partial",t.Full="full"})(Hl||(Hl={}));const ZE={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var $s;(function(t){t.Bezier="default",t.Straight="straight",t.Step="step",t.SmoothStep="smoothstep",t.SimpleBezier="simplebezier"})($s||($s={}));var zd;(function(t){t.Arrow="arrow",t.ArrowClosed="arrowclosed"})(zd||(zd={}));var we;(function(t){t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom"})(we||(we={}));const jw={[we.Left]:we.Right,[we.Right]:we.Left,[we.Top]:we.Bottom,[we.Bottom]:we.Top};function NB(t,e){if(!t&&!e)return!0;if(!t||!e||t.size!==e.size)return!1;if(!t.size&&!e.size)return!0;for(const n of t.keys())if(!e.has(n))return!1;return!0}function Iw(t,e,n){if(!n)return;const s=[];t.forEach((a,l)=>{e?.has(l)||s.push(a)}),s.length&&n(s)}function eS(t){return t===null?null:t?"valid":"invalid"}const tS=t=>"id"in t&&"source"in t&&"target"in t,RB=t=>"id"in t&&"position"in t&&!("source"in t)&&!("target"in t),Hg=t=>"id"in t&&"internals"in t&&!("source"in t)&&!("target"in t),rc=(t,e=[0,0])=>{const{width:n,height:s}=es(t),a=t.origin??e,l=n*a[0],c=s*a[1];return{x:t.position.x-l,y:t.position.y-c}},OB=(t,e={nodeOrigin:[0,0]})=>{if(t.length===0)return{x:0,y:0,width:0,height:0};const n=t.reduce((s,a)=>{const l=typeof a=="string";let c=!e.nodeLookup&&!l?a:void 0;e.nodeLookup&&(c=l?e.nodeLookup.get(a):Hg(a)?a:e.nodeLookup.get(a.id));const d=c?Pd(c,e.nodeOrigin):{x:0,y:0,x2:0,y2:0};return df(s,d)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return ff(n)},sc=(t,e={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},s=!1;return t.forEach(a=>{(e.filter===void 0||e.filter(a))&&(n=df(n,Pd(a)),s=!0)}),s?ff(n):{x:0,y:0,width:0,height:0}},qg=(t,e,[n,s,a]=[0,0,1],l=!1,c=!1)=>{const d={...ac(e,[n,s,a]),width:e.width/a,height:e.height/a},f=[];for(const h of t.values()){const{measured:p,selectable:m=!0,hidden:y=!1}=h;if(c&&!m||y)continue;const _=p.width??h.width??h.initialWidth??null,x=p.height??h.height??h.initialHeight??null,w=ql(d,Fa(h)),A=(_??0)*(x??0),S=l&&w>0;(!h.internals.handleBounds||S||w>=A||h.dragging)&&f.push(h)}return f},jB=(t,e)=>{const n=new Set;return t.forEach(s=>{n.add(s.id)}),e.filter(s=>n.has(s.source)||n.has(s.target))};function IB(t,e){const n=new Map,s=e?.nodes?new Set(e.nodes.map(a=>a.id)):null;return t.forEach(a=>{a.measured.width&&a.measured.height&&(e?.includeHiddenNodes||!a.hidden)&&(!s||s.has(a.id))&&n.set(a.id,a)}),n}async function kB({nodes:t,width:e,height:n,panZoom:s,minZoom:a,maxZoom:l},c){if(t.size===0)return Promise.resolve(!0);const d=IB(t,c),f=sc(d),h=Qg(f,e,n,c?.minZoom??a,c?.maxZoom??l,c?.padding??.1);return await s.setViewport(h,{duration:c?.duration,ease:c?.ease,interpolate:c?.interpolate}),Promise.resolve(!0)}function nS({nodeId:t,nextPosition:e,nodeLookup:n,nodeOrigin:s=[0,0],nodeExtent:a,onError:l}){const c=n.get(t),d=c.parentId?n.get(c.parentId):void 0,{x:f,y:h}=d?d.internals.positionAbsolute:{x:0,y:0},p=c.origin??s;let m=c.extent||a;if(c.extent==="parent"&&!c.expandParent)if(!d)l?.("005",ir.error005());else{const _=d.measured.width,x=d.measured.height;_&&x&&(m=[[f,h],[f+_,h+x]])}else d&&Ga(c.extent)&&(m=[[c.extent[0][0]+f,c.extent[0][1]+h],[c.extent[1][0]+f,c.extent[1][1]+h]]);const y=Ga(m)?Ni(e,m,c.measured):e;return(c.measured.width===void 0||c.measured.height===void 0)&&l?.("015",ir.error015()),{position:{x:y.x-f+(c.measured.width??0)*p[0],y:y.y-h+(c.measured.height??0)*p[1]},positionAbsolute:y}}async function MB({nodesToRemove:t=[],edgesToRemove:e=[],nodes:n,edges:s,onBeforeDelete:a}){const l=new Set(t.map(y=>y.id)),c=[];for(const y of n){if(y.deletable===!1)continue;const _=l.has(y.id),x=!_&&y.parentId&&c.find(w=>w.id===y.parentId);(_||x)&&c.push(y)}const d=new Set(e.map(y=>y.id)),f=s.filter(y=>y.deletable!==!1),p=jB(c,f);for(const y of f)d.has(y.id)&&!p.find(x=>x.id===y.id)&&p.push(y);if(!a)return{edges:p,nodes:c};const m=await a({nodes:c,edges:p});return typeof m=="boolean"?m?{edges:p,nodes:c}:{edges:[],nodes:[]}:m}const Va=(t,e=0,n=1)=>Math.min(Math.max(t,e),n),Ni=(t={x:0,y:0},e,n)=>({x:Va(t.x,e[0][0],e[1][0]-(n?.width??0)),y:Va(t.y,e[0][1],e[1][1]-(n?.height??0))});function rS(t,e,n){const{width:s,height:a}=es(n),{x:l,y:c}=n.internals.positionAbsolute;return Ni(t,[[l,c],[l+s,c+a]],e)}const kw=(t,e,n)=>t<e?Va(Math.abs(t-e),1,e)/e:t>n?-Va(Math.abs(t-n),1,e)/e:0,sS=(t,e,n=15,s=40)=>{const a=kw(t.x,s,e.width-s)*n,l=kw(t.y,s,e.height-s)*n;return[a,l]},df=(t,e)=>({x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x2,e.x2),y2:Math.max(t.y2,e.y2)}),Wp=({x:t,y:e,width:n,height:s})=>({x:t,y:e,x2:t+n,y2:e+s}),ff=({x:t,y:e,x2:n,y2:s})=>({x:t,y:e,width:n-t,height:s-e}),Fa=(t,e=[0,0])=>{const{x:n,y:s}=Hg(t)?t.internals.positionAbsolute:rc(t,e);return{x:n,y:s,width:t.measured?.width??t.width??t.initialWidth??0,height:t.measured?.height??t.height??t.initialHeight??0}},Pd=(t,e=[0,0])=>{const{x:n,y:s}=Hg(t)?t.internals.positionAbsolute:rc(t,e);return{x:n,y:s,x2:n+(t.measured?.width??t.width??t.initialWidth??0),y2:s+(t.measured?.height??t.height??t.initialHeight??0)}},iS=(t,e)=>ff(df(Wp(t),Wp(e))),ql=(t,e)=>{const n=Math.max(0,Math.min(t.x+t.width,e.x+e.width)-Math.max(t.x,e.x)),s=Math.max(0,Math.min(t.y+t.height,e.y+e.height)-Math.max(t.y,e.y));return Math.ceil(n*s)},Mw=t=>rr(t.width)&&rr(t.height)&&rr(t.x)&&rr(t.y),rr=t=>!isNaN(t)&&isFinite(t),DB=(t,e)=>{},ic=(t,e=[1,1])=>({x:e[0]*Math.round(t.x/e[0]),y:e[1]*Math.round(t.y/e[1])}),ac=({x:t,y:e},[n,s,a],l=!1,c=[1,1])=>{const d={x:(t-n)/a,y:(e-s)/a};return l?ic(d,c):d},Hd=({x:t,y:e},[n,s,a])=>({x:t*a+n,y:e*a+s});function Ca(t,e){if(typeof t=="number")return Math.floor((e-e/(1+t))*.5);if(typeof t=="string"&&t.endsWith("px")){const n=parseFloat(t);if(!Number.isNaN(n))return Math.floor(n)}if(typeof t=="string"&&t.endsWith("%")){const n=parseFloat(t);if(!Number.isNaN(n))return Math.floor(e*n*.01)}return console.error(`[React Flow] The padding value "${t}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function BB(t,e,n){if(typeof t=="string"||typeof t=="number"){const s=Ca(t,n),a=Ca(t,e);return{top:s,right:a,bottom:s,left:a,x:a*2,y:s*2}}if(typeof t=="object"){const s=Ca(t.top??t.y??0,n),a=Ca(t.bottom??t.y??0,n),l=Ca(t.left??t.x??0,e),c=Ca(t.right??t.x??0,e);return{top:s,right:c,bottom:a,left:l,x:l+c,y:s+a}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function UB(t,e,n,s,a,l){const{x:c,y:d}=Hd(t,[e,n,s]),{x:f,y:h}=Hd({x:t.x+t.width,y:t.y+t.height},[e,n,s]),p=a-f,m=l-h;return{left:Math.floor(c),top:Math.floor(d),right:Math.floor(p),bottom:Math.floor(m)}}const Qg=(t,e,n,s,a,l)=>{const c=BB(l,e,n),d=(e-c.x)/t.width,f=(n-c.y)/t.height,h=Math.min(d,f),p=Va(h,s,a),m=t.x+t.width/2,y=t.y+t.height/2,_=e/2-m*p,x=n/2-y*p,w=UB(t,_,x,p,e,n),A={left:Math.min(w.left-c.left,0),top:Math.min(w.top-c.top,0),right:Math.min(w.right-c.right,0),bottom:Math.min(w.bottom-c.bottom,0)};return{x:_-A.left+A.right,y:x-A.top+A.bottom,zoom:p}},Ql=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function Ga(t){return t!=null&&t!=="parent"}function es(t){return{width:t.measured?.width??t.width??t.initialWidth??0,height:t.measured?.height??t.height??t.initialHeight??0}}function aS(t){return(t.measured?.width??t.width??t.initialWidth)!==void 0&&(t.measured?.height??t.height??t.initialHeight)!==void 0}function oS(t,e={width:0,height:0},n,s,a){const l={...t},c=s.get(n);if(c){const d=c.origin||a;l.x+=c.internals.positionAbsolute.x-(e.width??0)*d[0],l.y+=c.internals.positionAbsolute.y-(e.height??0)*d[1]}return l}function Dw(t,e){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}function LB(){let t,e;return{promise:new Promise((s,a)=>{t=s,e=a}),resolve:t,reject:e}}function $B(t){return{...JE,...t||{}}}function Nl(t,{snapGrid:e=[0,0],snapToGrid:n=!1,transform:s,containerBounds:a}){const{x:l,y:c}=sr(t),d=ac({x:l-(a?.left??0),y:c-(a?.top??0)},s),{x:f,y:h}=n?ic(d,e):d;return{xSnapped:f,ySnapped:h,...d}}const Vg=t=>({width:t.offsetWidth,height:t.offsetHeight}),lS=t=>t?.getRootNode?.()||window?.document,zB=["INPUT","SELECT","TEXTAREA"];function cS(t){const e=t.composedPath?.()?.[0]||t.target;return e?.nodeType!==1?!1:zB.includes(e.nodeName)||e.hasAttribute("contenteditable")||!!e.closest(".nokey")}const uS=t=>"clientX"in t,sr=(t,e)=>{const n=uS(t),s=n?t.clientX:t.touches?.[0].clientX,a=n?t.clientY:t.touches?.[0].clientY;return{x:s-(e?.left??0),y:a-(e?.top??0)}},Bw=(t,e,n,s,a)=>{const l=e.querySelectorAll(`.${t}`);return!l||!l.length?null:Array.from(l).map(c=>{const d=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),type:t,nodeId:a,position:c.getAttribute("data-handlepos"),x:(d.left-n.left)/s,y:(d.top-n.top)/s,...Vg(c)}})};function dS({sourceX:t,sourceY:e,targetX:n,targetY:s,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:d}){const f=t*.125+a*.375+c*.375+n*.125,h=e*.125+l*.375+d*.375+s*.125,p=Math.abs(f-t),m=Math.abs(h-e);return[f,h,p,m]}function Wu(t,e){return t>=0?.5*t:e*25*Math.sqrt(-t)}function Uw({pos:t,x1:e,y1:n,x2:s,y2:a,c:l}){switch(t){case we.Left:return[e-Wu(e-s,l),n];case we.Right:return[e+Wu(s-e,l),n];case we.Top:return[e,n-Wu(n-a,l)];case we.Bottom:return[e,n+Wu(a-n,l)]}}function Fg({sourceX:t,sourceY:e,sourcePosition:n=we.Bottom,targetX:s,targetY:a,targetPosition:l=we.Top,curvature:c=.25}){const[d,f]=Uw({pos:n,x1:t,y1:e,x2:s,y2:a,c}),[h,p]=Uw({pos:l,x1:s,y1:a,x2:t,y2:e,c}),[m,y,_,x]=dS({sourceX:t,sourceY:e,targetX:s,targetY:a,sourceControlX:d,sourceControlY:f,targetControlX:h,targetControlY:p});return[`M${t},${e} C${d},${f} ${h},${p} ${s},${a}`,m,y,_,x]}function fS({sourceX:t,sourceY:e,targetX:n,targetY:s}){const a=Math.abs(n-t)/2,l=n<t?n+a:n-a,c=Math.abs(s-e)/2,d=s<e?s+c:s-c;return[l,d,a,c]}function PB({sourceNode:t,targetNode:e,selected:n=!1,zIndex:s,elevateOnSelect:a=!1}){if(s!==void 0)return s;const l=a&&n?1e3:0,c=Math.max(t.parentId||a&&t.selected?t.internals.z:0,e.parentId||a&&e.selected?e.internals.z:0);return l+c}function HB({sourceNode:t,targetNode:e,width:n,height:s,transform:a}){const l=df(Pd(t),Pd(e));l.x===l.x2&&(l.x2+=1),l.y===l.y2&&(l.y2+=1);const c={x:-a[0]/a[2],y:-a[1]/a[2],width:n/a[2],height:s/a[2]};return ql(c,ff(l))>0}const qB=({source:t,sourceHandle:e,target:n,targetHandle:s})=>`xy-edge__${t}${e||""}-${n}${s||""}`,QB=(t,e)=>e.some(n=>n.source===t.source&&n.target===t.target&&(n.sourceHandle===t.sourceHandle||!n.sourceHandle&&!t.sourceHandle)&&(n.targetHandle===t.targetHandle||!n.targetHandle&&!t.targetHandle)),hS=(t,e)=>{if(!t.source||!t.target)return e;let n;return tS(t)?n={...t}:n={...t,id:qB(t)},QB(n,e)?e:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,e.concat(n))};function mS({sourceX:t,sourceY:e,targetX:n,targetY:s}){const[a,l,c,d]=fS({sourceX:t,sourceY:e,targetX:n,targetY:s});return[`M ${t},${e}L ${n},${s}`,a,l,c,d]}const Lw={[we.Left]:{x:-1,y:0},[we.Right]:{x:1,y:0},[we.Top]:{x:0,y:-1},[we.Bottom]:{x:0,y:1}},VB=({source:t,sourcePosition:e=we.Bottom,target:n})=>e===we.Left||e===we.Right?t.x<n.x?{x:1,y:0}:{x:-1,y:0}:t.y<n.y?{x:0,y:1}:{x:0,y:-1},$w=(t,e)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));function FB({source:t,sourcePosition:e=we.Bottom,target:n,targetPosition:s=we.Top,center:a,offset:l,stepPosition:c}){const d=Lw[e],f=Lw[s],h={x:t.x+d.x*l,y:t.y+d.y*l},p={x:n.x+f.x*l,y:n.y+f.y*l},m=VB({source:h,sourcePosition:e,target:p}),y=m.x!==0?"x":"y",_=m[y];let x=[],w,A;const S={x:0,y:0},T={x:0,y:0},[,,E,C]=fS({sourceX:t.x,sourceY:t.y,targetX:n.x,targetY:n.y});if(d[y]*f[y]===-1){y==="x"?(w=a.x??h.x+(p.x-h.x)*c,A=a.y??(h.y+p.y)/2):(w=a.x??(h.x+p.x)/2,A=a.y??h.y+(p.y-h.y)*c);const j=[{x:w,y:h.y},{x:w,y:p.y}],I=[{x:h.x,y:A},{x:p.x,y:A}];d[y]===_?x=y==="x"?j:I:x=y==="x"?I:j}else{const j=[{x:h.x,y:p.y}],I=[{x:p.x,y:h.y}];if(y==="x"?x=d.x===_?I:j:x=d.y===_?j:I,e===s){const z=Math.abs(t[y]-n[y]);if(z<=l){const Y=Math.min(l-1,l-z);d[y]===_?S[y]=(h[y]>t[y]?-1:1)*Y:T[y]=(p[y]>n[y]?-1:1)*Y}}if(e!==s){const z=y==="x"?"y":"x",Y=d[y]===f[z],H=h[z]>p[z],F=h[z]<p[z];(d[y]===1&&(!Y&&H||Y&&F)||d[y]!==1&&(!Y&&F||Y&&H))&&(x=y==="x"?j:I)}const D={x:h.x+S.x,y:h.y+S.y},P={x:p.x+T.x,y:p.y+T.y},G=Math.max(Math.abs(D.x-x[0].x),Math.abs(P.x-x[0].x)),V=Math.max(Math.abs(D.y-x[0].y),Math.abs(P.y-x[0].y));G>=V?(w=(D.x+P.x)/2,A=x[0].y):(w=x[0].x,A=(D.y+P.y)/2)}return[[t,{x:h.x+S.x,y:h.y+S.y},...x,{x:p.x+T.x,y:p.y+T.y},n],w,A,E,C]}function GB(t,e,n,s){const a=Math.min($w(t,e)/2,$w(e,n)/2,s),{x:l,y:c}=e;if(t.x===l&&l===n.x||t.y===c&&c===n.y)return`L${l} ${c}`;if(t.y===c){const h=t.x<n.x?-1:1,p=t.y<n.y?1:-1;return`L ${l+a*h},${c}Q ${l},${c} ${l},${c+a*p}`}const d=t.x<n.x?1:-1,f=t.y<n.y?-1:1;return`L ${l},${c+a*f}Q ${l},${c} ${l+a*d},${c}`}function Jp({sourceX:t,sourceY:e,sourcePosition:n=we.Bottom,targetX:s,targetY:a,targetPosition:l=we.Top,borderRadius:c=5,centerX:d,centerY:f,offset:h=20,stepPosition:p=.5}){const[m,y,_,x,w]=FB({source:{x:t,y:e},sourcePosition:n,target:{x:s,y:a},targetPosition:l,center:{x:d,y:f},offset:h,stepPosition:p});return[m.reduce((S,T,E)=>{let C="";return E>0&&E<m.length-1?C=GB(m[E-1],T,m[E+1],c):C=`${E===0?"M":"L"}${T.x} ${T.y}`,S+=C,S},""),y,_,x,w]}function zw(t){return t&&!!(t.internals.handleBounds||t.handles?.length)&&!!(t.measured.width||t.width||t.initialWidth)}function YB(t){const{sourceNode:e,targetNode:n}=t;if(!zw(e)||!zw(n))return null;const s=e.internals.handleBounds||Pw(e.handles),a=n.internals.handleBounds||Pw(n.handles),l=Hw(s?.source??[],t.sourceHandle),c=Hw(t.connectionMode===Qa.Strict?a?.target??[]:(a?.target??[]).concat(a?.source??[]),t.targetHandle);if(!l||!c)return t.onError?.("008",ir.error008(l?"target":"source",{id:t.id,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle})),null;const d=l?.position||we.Bottom,f=c?.position||we.Top,h=Vl(e,l,d),p=Vl(n,c,f);return{sourceX:h.x,sourceY:h.y,targetX:p.x,targetY:p.y,sourcePosition:d,targetPosition:f}}function Pw(t){if(!t)return null;const e=[],n=[];for(const s of t)s.width=s.width??1,s.height=s.height??1,s.type==="source"?e.push(s):s.type==="target"&&n.push(s);return{source:e,target:n}}function Vl(t,e,n=we.Left,s=!1){const a=(e?.x??0)+t.internals.positionAbsolute.x,l=(e?.y??0)+t.internals.positionAbsolute.y,{width:c,height:d}=e??es(t);if(s)return{x:a+c/2,y:l+d/2};switch(e?.position??n){case we.Top:return{x:a+c/2,y:l};case we.Right:return{x:a+c,y:l+d/2};case we.Bottom:return{x:a+c/2,y:l+d};case we.Left:return{x:a,y:l+d/2}}}function Hw(t,e){return t&&(e?t.find(n=>n.id===e):t[0])||null}function Zp(t,e){return t?typeof t=="string"?t:`${e?`${e}__`:""}${Object.keys(t).sort().map(s=>`${s}=${t[s]}`).join("&")}`:""}function XB(t,{id:e,defaultColor:n,defaultMarkerStart:s,defaultMarkerEnd:a}){const l=new Set;return t.reduce((c,d)=>([d.markerStart||s,d.markerEnd||a].forEach(f=>{if(f&&typeof f=="object"){const h=Zp(f,e);l.has(h)||(c.push({id:h,color:f.color||n,...f}),l.add(h))}}),c),[]).sort((c,d)=>c.id.localeCompare(d.id))}const pS=1e3,KB=10,Gg={nodeOrigin:[0,0],nodeExtent:Pl,elevateNodesOnSelect:!0,defaults:{}},WB={...Gg,checkEquality:!0};function Yg(t,e){const n={...t};for(const s in e)e[s]!==void 0&&(n[s]=e[s]);return n}function JB(t,e,n){const s=Yg(Gg,n);for(const a of t.values())if(a.parentId)Xg(a,t,e,s);else{const l=rc(a,s.nodeOrigin),c=Ga(a.extent)?a.extent:s.nodeExtent,d=Ni(l,c,es(a));a.internals.positionAbsolute=d}}function ZB(t,e){if(!t.handles)return t.measured?e?.internals.handleBounds:void 0;const n=[],s=[];for(const a of t.handles){const l={id:a.id,width:a.width??1,height:a.height??1,nodeId:t.id,x:a.x,y:a.y,position:a.position,type:a.type};a.type==="source"?n.push(l):a.type==="target"&&s.push(l)}return{source:n,target:s}}function eg(t,e,n,s){const a=Yg(WB,s);let l={i:-1},c=t.length>0;const d=new Map(e),f=a?.elevateNodesOnSelect?pS:0;e.clear(),n.clear();for(const h of t){let p=d.get(h.id);if(a.checkEquality&&h===p?.internals.userNode)e.set(h.id,p);else{const m=rc(h,a.nodeOrigin),y=Ga(h.extent)?h.extent:a.nodeExtent,_=Ni(m,y,es(h));p={...a.defaults,...h,measured:{width:h.measured?.width,height:h.measured?.height},internals:{positionAbsolute:_,handleBounds:ZB(h,p),z:gS(h,f),userNode:h}},e.set(h.id,p)}(p.measured===void 0||p.measured.width===void 0||p.measured.height===void 0)&&!p.hidden&&(c=!1),h.parentId&&Xg(p,e,n,s,l)}return c}function eU(t,e){if(!t.parentId)return;const n=e.get(t.parentId);n?n.set(t.id,t):e.set(t.parentId,new Map([[t.id,t]]))}function Xg(t,e,n,s,a){const{elevateNodesOnSelect:l,nodeOrigin:c,nodeExtent:d}=Yg(Gg,s),f=t.parentId,h=e.get(f);if(!h){console.warn(`Parent node ${f} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}eU(t,n),a&&!h.parentId&&h.internals.rootParentIndex===void 0&&(h.internals.rootParentIndex=++a.i,h.internals.z=h.internals.z+a.i*KB),a&&h.internals.rootParentIndex!==void 0&&(a.i=h.internals.rootParentIndex);const p=l?pS:0,{x:m,y,z:_}=tU(t,h,c,d,p),{positionAbsolute:x}=t.internals,w=m!==x.x||y!==x.y;(w||_!==t.internals.z)&&e.set(t.id,{...t,internals:{...t.internals,positionAbsolute:w?{x:m,y}:x,z:_}})}function gS(t,e){return(rr(t.zIndex)?t.zIndex:0)+(t.selected?e:0)}function tU(t,e,n,s,a){const{x:l,y:c}=e.internals.positionAbsolute,d=es(t),f=rc(t,n),h=Ga(t.extent)?Ni(f,t.extent,d):f;let p=Ni({x:l+h.x,y:c+h.y},s,d);t.extent==="parent"&&(p=rS(p,d,e));const m=gS(t,a),y=e.internals.z??0;return{x:p.x,y:p.y,z:y>=m?y+1:m}}function Kg(t,e,n,s=[0,0]){const a=[],l=new Map;for(const c of t){const d=e.get(c.parentId);if(!d)continue;const f=l.get(c.parentId)?.expandedRect??Fa(d),h=iS(f,c.rect);l.set(c.parentId,{expandedRect:h,parent:d})}return l.size>0&&l.forEach(({expandedRect:c,parent:d},f)=>{const h=d.internals.positionAbsolute,p=es(d),m=d.origin??s,y=c.x<h.x?Math.round(Math.abs(h.x-c.x)):0,_=c.y<h.y?Math.round(Math.abs(h.y-c.y)):0,x=Math.max(p.width,Math.round(c.width)),w=Math.max(p.height,Math.round(c.height)),A=(x-p.width)*m[0],S=(w-p.height)*m[1];(y>0||_>0||A||S)&&(a.push({id:f,type:"position",position:{x:d.position.x-y+A,y:d.position.y-_+S}}),n.get(f)?.forEach(T=>{t.some(E=>E.id===T.id)||a.push({id:T.id,type:"position",position:{x:T.position.x+y,y:T.position.y+_}})})),(p.width<c.width||p.height<c.height||y||_)&&a.push({id:f,type:"dimensions",setAttributes:!0,dimensions:{width:x+(y?m[0]*y-A:0),height:w+(_?m[1]*_-S:0)}})}),a}function nU(t,e,n,s,a,l){const c=s?.querySelector(".xyflow__viewport");let d=!1;if(!c)return{changes:[],updatedInternals:d};const f=[],h=window.getComputedStyle(c),{m22:p}=new window.DOMMatrixReadOnly(h.transform),m=[];for(const y of t.values()){const _=e.get(y.id);if(!_)continue;if(_.hidden){e.set(_.id,{..._,internals:{..._.internals,handleBounds:void 0}}),d=!0;continue}const x=Vg(y.nodeElement),w=_.measured.width!==x.width||_.measured.height!==x.height;if(!!(x.width&&x.height&&(w||!_.internals.handleBounds||y.force))){const S=y.nodeElement.getBoundingClientRect(),T=Ga(_.extent)?_.extent:l;let{positionAbsolute:E}=_.internals;_.parentId&&_.extent==="parent"?E=rS(E,x,e.get(_.parentId)):T&&(E=Ni(E,T,x));const C={..._,measured:x,internals:{..._.internals,positionAbsolute:E,handleBounds:{source:Bw("source",y.nodeElement,S,p,_.id),target:Bw("target",y.nodeElement,S,p,_.id)}}};e.set(_.id,C),_.parentId&&Xg(C,e,n,{nodeOrigin:a}),d=!0,w&&(f.push({id:_.id,type:"dimensions",dimensions:x}),_.expandParent&&_.parentId&&m.push({id:_.id,parentId:_.parentId,rect:Fa(C,a)}))}}if(m.length>0){const y=Kg(m,e,n,a);f.push(...y)}return{changes:f,updatedInternals:d}}async function rU({delta:t,panZoom:e,transform:n,translateExtent:s,width:a,height:l}){if(!e||!t.x&&!t.y)return Promise.resolve(!1);const c=await e.setViewportConstrained({x:n[0]+t.x,y:n[1]+t.y,zoom:n[2]},[[0,0],[a,l]],s),d=!!c&&(c.x!==n[0]||c.y!==n[1]||c.k!==n[2]);return Promise.resolve(d)}function qw(t,e,n,s,a,l){let c=a;const d=s.get(c)||new Map;s.set(c,d.set(n,e)),c=`${a}-${t}`;const f=s.get(c)||new Map;if(s.set(c,f.set(n,e)),l){c=`${a}-${t}-${l}`;const h=s.get(c)||new Map;s.set(c,h.set(n,e))}}function yS(t,e,n){t.clear(),e.clear();for(const s of n){const{source:a,target:l,sourceHandle:c=null,targetHandle:d=null}=s,f={edgeId:s.id,source:a,target:l,sourceHandle:c,targetHandle:d},h=`${a}-${c}--${l}-${d}`,p=`${l}-${d}--${a}-${c}`;qw("source",f,p,t,a,c),qw("target",f,h,t,l,d),e.set(s.id,s)}}function sU(t,e){if(t===null||e===null)return!1;const n=Array.isArray(t)?t:[t],s=Array.isArray(e)?e:[e];if(n.length!==s.length)return!1;for(let a=0;a<n.length;a++)if(n[a].id!==s[a].id||n[a].type!==s[a].type||!Object.is(n[a].data,s[a].data))return!1;return!0}function vS(t,e){if(!t.parentId)return!1;const n=e.get(t.parentId);return n?n.selected?!0:vS(n,e):!1}function Qw(t,e,n){let s=t;do{if(s?.matches?.(e))return!0;if(s===n)return!1;s=s?.parentElement}while(s);return!1}function iU(t,e,n,s){const a=new Map;for(const[l,c]of t)if((c.selected||c.id===s)&&(!c.parentId||!vS(c,t))&&(c.draggable||e&&typeof c.draggable>"u")){const d=t.get(l);d&&a.set(l,{id:l,position:d.position||{x:0,y:0},distance:{x:n.x-d.internals.positionAbsolute.x,y:n.y-d.internals.positionAbsolute.y},extent:d.extent,parentId:d.parentId,origin:d.origin,expandParent:d.expandParent,internals:{positionAbsolute:d.internals.positionAbsolute||{x:0,y:0}},measured:{width:d.measured.width??0,height:d.measured.height??0}})}return a}function lp({nodeId:t,dragItems:e,nodeLookup:n,dragging:s=!0}){const a=[];for(const[c,d]of e){const f=n.get(c)?.internals.userNode;f&&a.push({...f,position:d.position,dragging:s})}if(!t)return[a[0],a];const l=n.get(t)?.internals.userNode;return[l?{...l,position:e.get(t)?.position||l.position,dragging:s}:a[0],a]}function aU({dragItems:t,snapGrid:e,x:n,y:s}){const a=t.values().next().value;if(!a)return null;const l={x:n-a.distance.x,y:s-a.distance.y},c=ic(l,e);return{x:c.x-l.x,y:c.y-l.y}}function oU({onNodeMouseDown:t,getStoreItems:e,onDragStart:n,onDrag:s,onDragStop:a}){let l={x:null,y:null},c=0,d=new Map,f=!1,h={x:0,y:0},p=null,m=!1,y=null,_=!1,x=!1,w=null;function A({noDragClassName:T,handleSelector:E,domNode:C,isSelectable:O,nodeId:j,nodeClickDistance:I=0}){y=On(C);function D({x:z,y:Y}){const{nodeLookup:H,nodeExtent:F,snapGrid:N,snapToGrid:B,nodeOrigin:U,onNodeDrag:$,onSelectionDrag:Q,onError:M,updateNodePositions:q}=e();l={x:z,y:Y};let X=!1;const Z=d.size>1,J=Z&&F?Wp(sc(d)):null,ae=Z&&B?aU({dragItems:d,snapGrid:N,x:z,y:Y}):null;for(const[ce,de]of d){if(!H.has(ce))continue;let ie={x:z-de.distance.x,y:Y-de.distance.y};B&&(ie=ae?{x:Math.round(ie.x+ae.x),y:Math.round(ie.y+ae.y)}:ic(ie,N));let oe=null;if(Z&&F&&!de.extent&&J){const{positionAbsolute:_e}=de.internals,Me=_e.x-J.x+F[0][0],fe=_e.x+de.measured.width-J.x2+F[1][0],ve=_e.y-J.y+F[0][1],Ie=_e.y+de.measured.height-J.y2+F[1][1];oe=[[Me,ve],[fe,Ie]]}const{position:pe,positionAbsolute:be}=nS({nodeId:ce,nextPosition:ie,nodeLookup:H,nodeExtent:oe||F,nodeOrigin:U,onError:M});X=X||de.position.x!==pe.x||de.position.y!==pe.y,de.position=pe,de.internals.positionAbsolute=be}if(x=x||X,!!X&&(q(d,!0),w&&(s||$||!j&&Q))){const[ce,de]=lp({nodeId:j,dragItems:d,nodeLookup:H});s?.(w,d,ce,de),$?.(w,ce,de),j||Q?.(w,de)}}async function P(){if(!p)return;const{transform:z,panBy:Y,autoPanSpeed:H,autoPanOnNodeDrag:F}=e();if(!F){f=!1,cancelAnimationFrame(c);return}const[N,B]=sS(h,p,H);(N!==0||B!==0)&&(l.x=(l.x??0)-N/z[2],l.y=(l.y??0)-B/z[2],await Y({x:N,y:B})&&D(l)),c=requestAnimationFrame(P)}function G(z){const{nodeLookup:Y,multiSelectionActive:H,nodesDraggable:F,transform:N,snapGrid:B,snapToGrid:U,selectNodesOnDrag:$,onNodeDragStart:Q,onSelectionDragStart:M,unselectNodesAndEdges:q}=e();m=!0,(!$||!O)&&!H&&j&&(Y.get(j)?.selected||q()),O&&$&&j&&t?.(j);const X=Nl(z.sourceEvent,{transform:N,snapGrid:B,snapToGrid:U,containerBounds:p});if(l=X,d=iU(Y,F,X,j),d.size>0&&(n||Q||!j&&M)){const[Z,J]=lp({nodeId:j,dragItems:d,nodeLookup:Y});n?.(z.sourceEvent,d,Z,J),Q?.(z.sourceEvent,Z,J),j||M?.(z.sourceEvent,J)}}const V=DE().clickDistance(I).on("start",z=>{const{domNode:Y,nodeDragThreshold:H,transform:F,snapGrid:N,snapToGrid:B}=e();p=Y?.getBoundingClientRect()||null,_=!1,x=!1,w=z.sourceEvent,H===0&&G(z),l=Nl(z.sourceEvent,{transform:F,snapGrid:N,snapToGrid:B,containerBounds:p}),h=sr(z.sourceEvent,p)}).on("drag",z=>{const{autoPanOnNodeDrag:Y,transform:H,snapGrid:F,snapToGrid:N,nodeDragThreshold:B,nodeLookup:U}=e(),$=Nl(z.sourceEvent,{transform:H,snapGrid:F,snapToGrid:N,containerBounds:p});if(w=z.sourceEvent,(z.sourceEvent.type==="touchmove"&&z.sourceEvent.touches.length>1||j&&!U.has(j))&&(_=!0),!_){if(!f&&Y&&m&&(f=!0,P()),!m){const Q=sr(z.sourceEvent,p),M=Q.x-h.x,q=Q.y-h.y;Math.sqrt(M*M+q*q)>B&&G(z)}(l.x!==$.xSnapped||l.y!==$.ySnapped)&&d&&m&&(h=sr(z.sourceEvent,p),D($))}}).on("end",z=>{if(!(!m||_)&&(f=!1,m=!1,cancelAnimationFrame(c),d.size>0)){const{nodeLookup:Y,updateNodePositions:H,onNodeDragStop:F,onSelectionDragStop:N}=e();if(x&&(H(d,!1),x=!1),a||F||!j&&N){const[B,U]=lp({nodeId:j,dragItems:d,nodeLookup:Y,dragging:!1});a?.(z.sourceEvent,d,B,U),F?.(z.sourceEvent,B,U),j||N?.(z.sourceEvent,U)}}}).filter(z=>{const Y=z.target;return!z.button&&(!T||!Qw(Y,`.${T}`,C))&&(!E||Qw(Y,E,C))});y.call(V)}function S(){y?.on(".drag",null)}return{update:A,destroy:S}}function lU(t,e,n){const s=[],a={x:t.x-n,y:t.y-n,width:n*2,height:n*2};for(const l of e.values())ql(a,Fa(l))>0&&s.push(l);return s}const cU=250;function uU(t,e,n,s){let a=[],l=1/0;const c=lU(t,n,e+cU);for(const d of c){const f=[...d.internals.handleBounds?.source??[],...d.internals.handleBounds?.target??[]];for(const h of f){if(s.nodeId===h.nodeId&&s.type===h.type&&s.id===h.id)continue;const{x:p,y:m}=Vl(d,h,h.position,!0),y=Math.sqrt(Math.pow(p-t.x,2)+Math.pow(m-t.y,2));y>e||(y<l?(a=[{...h,x:p,y:m}],l=y):y===l&&a.push({...h,x:p,y:m}))}}if(!a.length)return null;if(a.length>1){const d=s.type==="source"?"target":"source";return a.find(f=>f.type===d)??a[0]}return a[0]}function _S(t,e,n,s,a,l=!1){const c=s.get(t);if(!c)return null;const d=a==="strict"?c.internals.handleBounds?.[e]:[...c.internals.handleBounds?.source??[],...c.internals.handleBounds?.target??[]],f=(n?d?.find(h=>h.id===n):d?.[0])??null;return f&&l?{...f,...Vl(c,f,f.position,!0)}:f}function bS(t,e){return t||(e?.classList.contains("target")?"target":e?.classList.contains("source")?"source":null)}function dU(t,e){let n=null;return e?n=!0:t&&!e&&(n=!1),n}const wS=()=>!0;function fU(t,{connectionMode:e,connectionRadius:n,handleId:s,nodeId:a,edgeUpdaterType:l,isTarget:c,domNode:d,nodeLookup:f,lib:h,autoPanOnConnect:p,flowId:m,panBy:y,cancelConnection:_,onConnectStart:x,onConnect:w,onConnectEnd:A,isValidConnection:S=wS,onReconnectEnd:T,updateConnection:E,getTransform:C,getFromHandle:O,autoPanSpeed:j,dragThreshold:I=1,handleDomNode:D}){const P=lS(t.target);let G=0,V;const{x:z,y:Y}=sr(t),H=bS(l,D),F=d?.getBoundingClientRect();let N=!1;if(!F||!H)return;const B=_S(a,H,s,f,e);if(!B)return;let U=sr(t,F),$=!1,Q=null,M=!1,q=null;function X(){if(!p||!F)return;const[pe,be]=sS(U,F,j);y({x:pe,y:be}),G=requestAnimationFrame(X)}const Z={...B,nodeId:a,type:H,position:B.position},J=f.get(a);let ce={inProgress:!0,isValid:null,from:Vl(J,Z,we.Left,!0),fromHandle:Z,fromPosition:Z.position,fromNode:J,to:U,toHandle:null,toPosition:jw[Z.position],toNode:null,pointer:U};function de(){N=!0,E(ce),x?.(t,{nodeId:a,handleId:s,handleType:H})}I===0&&de();function ie(pe){if(!N){const{x:fe,y:ve}=sr(pe),Ie=fe-z,Xe=ve-Y;if(!(Ie*Ie+Xe*Xe>I*I))return;de()}if(!O()||!Z){oe(pe);return}const be=C();U=sr(pe,F),V=uU(ac(U,be,!1,[1,1]),n,f,Z),$||(X(),$=!0);const _e=xS(pe,{handle:V,connectionMode:e,fromNodeId:a,fromHandleId:s,fromType:c?"target":"source",isValidConnection:S,doc:P,lib:h,flowId:m,nodeLookup:f});q=_e.handleDomNode,Q=_e.connection,M=dU(!!V,_e.isValid);const Me={...ce,isValid:M,to:_e.toHandle&&M?Hd({x:_e.toHandle.x,y:_e.toHandle.y},be):U,toHandle:_e.toHandle,toPosition:M&&_e.toHandle?_e.toHandle.position:jw[Z.position],toNode:_e.toHandle?f.get(_e.toHandle.nodeId):null,pointer:U};E(Me),ce=Me}function oe(pe){if(!("touches"in pe&&pe.touches.length>0)){if(N){(V||q)&&Q&&M&&w?.(Q);const{inProgress:be,..._e}=ce,Me={..._e,toPosition:ce.toHandle?ce.toPosition:null};A?.(pe,Me),l&&T?.(pe,Me)}_(),cancelAnimationFrame(G),$=!1,M=!1,Q=null,q=null,P.removeEventListener("mousemove",ie),P.removeEventListener("mouseup",oe),P.removeEventListener("touchmove",ie),P.removeEventListener("touchend",oe)}}P.addEventListener("mousemove",ie),P.addEventListener("mouseup",oe),P.addEventListener("touchmove",ie),P.addEventListener("touchend",oe)}function xS(t,{handle:e,connectionMode:n,fromNodeId:s,fromHandleId:a,fromType:l,doc:c,lib:d,flowId:f,isValidConnection:h=wS,nodeLookup:p}){const m=l==="target",y=e?c.querySelector(`.${d}-flow__handle[data-id="${f}-${e?.nodeId}-${e?.id}-${e?.type}"]`):null,{x:_,y:x}=sr(t),w=c.elementFromPoint(_,x),A=w?.classList.contains(`${d}-flow__handle`)?w:y,S={handleDomNode:A,isValid:!1,connection:null,toHandle:null};if(A){const T=bS(void 0,A),E=A.getAttribute("data-nodeid"),C=A.getAttribute("data-handleid"),O=A.classList.contains("connectable"),j=A.classList.contains("connectableend");if(!E||!T)return S;const I={source:m?E:s,sourceHandle:m?C:a,target:m?s:E,targetHandle:m?a:C};S.connection=I;const P=O&&j&&(n===Qa.Strict?m&&T==="source"||!m&&T==="target":E!==s||C!==a);S.isValid=P&&h(I),S.toHandle=_S(E,T,C,p,n,!0)}return S}const tg={onPointerDown:fU,isValid:xS};function hU({domNode:t,panZoom:e,getTransform:n,getViewScale:s}){const a=On(t);function l({translateExtent:d,width:f,height:h,zoomStep:p=1,pannable:m=!0,zoomable:y=!0,inversePan:_=!1}){const x=E=>{if(E.sourceEvent.type!=="wheel"||!e)return;const C=n(),O=E.sourceEvent.ctrlKey&&Ql()?10:1,j=-E.sourceEvent.deltaY*(E.sourceEvent.deltaMode===1?.05:E.sourceEvent.deltaMode?1:.002)*p,I=C[2]*Math.pow(2,j*O);e.scaleTo(I)};let w=[0,0];const A=E=>{(E.sourceEvent.type==="mousedown"||E.sourceEvent.type==="touchstart")&&(w=[E.sourceEvent.clientX??E.sourceEvent.touches[0].clientX,E.sourceEvent.clientY??E.sourceEvent.touches[0].clientY])},S=E=>{const C=n();if(E.sourceEvent.type!=="mousemove"&&E.sourceEvent.type!=="touchmove"||!e)return;const O=[E.sourceEvent.clientX??E.sourceEvent.touches[0].clientX,E.sourceEvent.clientY??E.sourceEvent.touches[0].clientY],j=[O[0]-w[0],O[1]-w[1]];w=O;const I=s()*Math.max(C[2],Math.log(C[2]))*(_?-1:1),D={x:C[0]-j[0]*I,y:C[1]-j[1]*I},P=[[0,0],[f,h]];e.setViewportConstrained({x:D.x,y:D.y,zoom:C[2]},P,d)},T=KE().on("start",A).on("zoom",m?S:null).on("zoom.wheel",y?x:null);a.call(T,{})}function c(){a.on("zoom",null)}return{update:l,destroy:c,pointer:tr}}const hf=t=>({x:t.x,y:t.y,zoom:t.k}),cp=({x:t,y:e,zoom:n})=>uf.translate(t,e).scale(n),Da=(t,e)=>t.target.closest(`.${e}`),AS=(t,e)=>e===2&&Array.isArray(t)&&t.includes(2),mU=t=>((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2,up=(t,e=0,n=mU,s=()=>{})=>{const a=typeof e=="number"&&e>0;return a||s(),a?t.transition().duration(e).ease(n).on("end",s):t},ES=t=>{const e=t.ctrlKey&&Ql()?10:1;return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*e};function pU({zoomPanValues:t,noWheelClassName:e,d3Selection:n,d3Zoom:s,panOnScrollMode:a,panOnScrollSpeed:l,zoomOnPinch:c,onPanZoomStart:d,onPanZoom:f,onPanZoomEnd:h}){return p=>{if(Da(p,e))return p.ctrlKey&&p.preventDefault(),!1;p.preventDefault(),p.stopImmediatePropagation();const m=n.property("__zoom").k||1;if(p.ctrlKey&&c){const A=tr(p),S=ES(p),T=m*Math.pow(2,S);s.scaleTo(n,T,A,p);return}const y=p.deltaMode===1?20:1;let _=a===Si.Vertical?0:p.deltaX*y,x=a===Si.Horizontal?0:p.deltaY*y;!Ql()&&p.shiftKey&&a!==Si.Vertical&&(_=p.deltaY*y,x=0),s.translateBy(n,-(_/m)*l,-(x/m)*l,{internal:!0});const w=hf(n.property("__zoom"));clearTimeout(t.panScrollTimeout),t.isPanScrolling?(f?.(p,w),t.panScrollTimeout=setTimeout(()=>{h?.(p,w),t.isPanScrolling=!1},150)):(t.isPanScrolling=!0,d?.(p,w))}}function gU({noWheelClassName:t,preventScrolling:e,d3ZoomHandler:n}){return function(s,a){const l=s.type==="wheel",c=!e&&l&&!s.ctrlKey,d=Da(s,t);if(s.ctrlKey&&l&&d&&s.preventDefault(),c||d)return null;s.preventDefault(),n.call(this,s,a)}}function yU({zoomPanValues:t,onDraggingChange:e,onPanZoomStart:n}){return s=>{if(s.sourceEvent?.internal)return;const a=hf(s.transform);t.mouseButton=s.sourceEvent?.button||0,t.isZoomingOrPanning=!0,t.prevViewport=a,s.sourceEvent?.type==="mousedown"&&e(!0),n&&n?.(s.sourceEvent,a)}}function vU({zoomPanValues:t,panOnDrag:e,onPaneContextMenu:n,onTransformChange:s,onPanZoom:a}){return l=>{t.usedRightMouseButton=!!(n&&AS(e,t.mouseButton??0)),l.sourceEvent?.sync||s([l.transform.x,l.transform.y,l.transform.k]),a&&!l.sourceEvent?.internal&&a?.(l.sourceEvent,hf(l.transform))}}function _U({zoomPanValues:t,panOnDrag:e,panOnScroll:n,onDraggingChange:s,onPanZoomEnd:a,onPaneContextMenu:l}){return c=>{if(!c.sourceEvent?.internal&&(t.isZoomingOrPanning=!1,l&&AS(e,t.mouseButton??0)&&!t.usedRightMouseButton&&c.sourceEvent&&l(c.sourceEvent),t.usedRightMouseButton=!1,s(!1),a)){const d=hf(c.transform);t.prevViewport=d,clearTimeout(t.timerId),t.timerId=setTimeout(()=>{a?.(c.sourceEvent,d)},n?150:0)}}}function bU({zoomActivationKeyPressed:t,zoomOnScroll:e,zoomOnPinch:n,panOnDrag:s,panOnScroll:a,zoomOnDoubleClick:l,userSelectionActive:c,noWheelClassName:d,noPanClassName:f,lib:h,connectionInProgress:p}){return m=>{const y=t||e,_=n&&m.ctrlKey,x=m.type==="wheel";if(m.button===1&&m.type==="mousedown"&&(Da(m,`${h}-flow__node`)||Da(m,`${h}-flow__edge`)))return!0;if(!s&&!y&&!a&&!l&&!n||c||p&&!x||Da(m,d)&&x||Da(m,f)&&(!x||a&&x&&!t)||!n&&m.ctrlKey&&x)return!1;if(!n&&m.type==="touchstart"&&m.touches?.length>1)return m.preventDefault(),!1;if(!y&&!a&&!_&&x||!s&&(m.type==="mousedown"||m.type==="touchstart")||Array.isArray(s)&&!s.includes(m.button)&&m.type==="mousedown")return!1;const w=Array.isArray(s)&&s.includes(m.button)||!m.button||m.button<=1;return(!m.ctrlKey||x)&&w}}function wU({domNode:t,minZoom:e,maxZoom:n,translateExtent:s,viewport:a,onPanZoom:l,onPanZoomStart:c,onPanZoomEnd:d,onDraggingChange:f}){const h={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},p=t.getBoundingClientRect(),m=KE().scaleExtent([e,n]).translateExtent(s),y=On(t).call(m);T({x:a.x,y:a.y,zoom:Va(a.zoom,e,n)},[[0,0],[p.width,p.height]],s);const _=y.on("wheel.zoom"),x=y.on("dblclick.zoom");m.wheelDelta(ES);function w(V,z){return y?new Promise(Y=>{m?.interpolate(z?.interpolate==="linear"?Tl:hd).transform(up(y,z?.duration,z?.ease,()=>Y(!0)),V)}):Promise.resolve(!1)}function A({noWheelClassName:V,noPanClassName:z,onPaneContextMenu:Y,userSelectionActive:H,panOnScroll:F,panOnDrag:N,panOnScrollMode:B,panOnScrollSpeed:U,preventScrolling:$,zoomOnPinch:Q,zoomOnScroll:M,zoomOnDoubleClick:q,zoomActivationKeyPressed:X,lib:Z,onTransformChange:J,connectionInProgress:ae,paneClickDistance:ce,selectionOnDrag:de}){H&&!h.isZoomingOrPanning&&S();const ie=F&&!X&&!H;m.clickDistance(de?1/0:!rr(ce)||ce<0?0:ce);const oe=ie?pU({zoomPanValues:h,noWheelClassName:V,d3Selection:y,d3Zoom:m,panOnScrollMode:B,panOnScrollSpeed:U,zoomOnPinch:Q,onPanZoomStart:c,onPanZoom:l,onPanZoomEnd:d}):gU({noWheelClassName:V,preventScrolling:$,d3ZoomHandler:_});if(y.on("wheel.zoom",oe,{passive:!1}),!H){const be=yU({zoomPanValues:h,onDraggingChange:f,onPanZoomStart:c});m.on("start",be);const _e=vU({zoomPanValues:h,panOnDrag:N,onPaneContextMenu:!!Y,onPanZoom:l,onTransformChange:J});m.on("zoom",_e);const Me=_U({zoomPanValues:h,panOnDrag:N,panOnScroll:F,onPaneContextMenu:Y,onPanZoomEnd:d,onDraggingChange:f});m.on("end",Me)}const pe=bU({zoomActivationKeyPressed:X,panOnDrag:N,zoomOnScroll:M,panOnScroll:F,zoomOnDoubleClick:q,zoomOnPinch:Q,userSelectionActive:H,noPanClassName:z,noWheelClassName:V,lib:Z,connectionInProgress:ae});m.filter(pe),q?y.on("dblclick.zoom",x):y.on("dblclick.zoom",null)}function S(){m.on("zoom",null)}async function T(V,z,Y){const H=cp(V),F=m?.constrain()(H,z,Y);return F&&await w(F),new Promise(N=>N(F))}async function E(V,z){const Y=cp(V);return await w(Y,z),new Promise(H=>H(Y))}function C(V){if(y){const z=cp(V),Y=y.property("__zoom");(Y.k!==V.zoom||Y.x!==V.x||Y.y!==V.y)&&m?.transform(y,z,null,{sync:!0})}}function O(){const V=y?XE(y.node()):{x:0,y:0,k:1};return{x:V.x,y:V.y,zoom:V.k}}function j(V,z){return y?new Promise(Y=>{m?.interpolate(z?.interpolate==="linear"?Tl:hd).scaleTo(up(y,z?.duration,z?.ease,()=>Y(!0)),V)}):Promise.resolve(!1)}function I(V,z){return y?new Promise(Y=>{m?.interpolate(z?.interpolate==="linear"?Tl:hd).scaleBy(up(y,z?.duration,z?.ease,()=>Y(!0)),V)}):Promise.resolve(!1)}function D(V){m?.scaleExtent(V)}function P(V){m?.translateExtent(V)}function G(V){const z=!rr(V)||V<0?0:V;m?.clickDistance(z)}return{update:A,destroy:S,setViewport:E,setViewportConstrained:T,getViewport:O,scaleTo:j,scaleBy:I,setScaleExtent:D,setTranslateExtent:P,syncViewport:C,setClickDistance:G}}var Ya;(function(t){t.Line="line",t.Handle="handle"})(Ya||(Ya={}));function xU({width:t,prevWidth:e,height:n,prevHeight:s,affectsX:a,affectsY:l}){const c=t-e,d=n-s,f=[c>0?1:c<0?-1:0,d>0?1:d<0?-1:0];return c&&a&&(f[0]=f[0]*-1),d&&l&&(f[1]=f[1]*-1),f}function Vw(t){const e=t.includes("right")||t.includes("left"),n=t.includes("bottom")||t.includes("top"),s=t.includes("left"),a=t.includes("top");return{isHorizontal:e,isVertical:n,affectsX:s,affectsY:a}}function ks(t,e){return Math.max(0,e-t)}function Ms(t,e){return Math.max(0,t-e)}function Ju(t,e,n){return Math.max(0,e-t,t-n)}function Fw(t,e){return t?!e:e}function AU(t,e,n,s,a,l,c,d){let{affectsX:f,affectsY:h}=e;const{isHorizontal:p,isVertical:m}=e,y=p&&m,{xSnapped:_,ySnapped:x}=n,{minWidth:w,maxWidth:A,minHeight:S,maxHeight:T}=s,{x:E,y:C,width:O,height:j,aspectRatio:I}=t;let D=Math.floor(p?_-t.pointerX:0),P=Math.floor(m?x-t.pointerY:0);const G=O+(f?-D:D),V=j+(h?-P:P),z=-l[0]*O,Y=-l[1]*j;let H=Ju(G,w,A),F=Ju(V,S,T);if(c){let U=0,$=0;f&&D<0?U=ks(E+D+z,c[0][0]):!f&&D>0&&(U=Ms(E+G+z,c[1][0])),h&&P<0?$=ks(C+P+Y,c[0][1]):!h&&P>0&&($=Ms(C+V+Y,c[1][1])),H=Math.max(H,U),F=Math.max(F,$)}if(d){let U=0,$=0;f&&D>0?U=Ms(E+D,d[0][0]):!f&&D<0&&(U=ks(E+G,d[1][0])),h&&P>0?$=Ms(C+P,d[0][1]):!h&&P<0&&($=ks(C+V,d[1][1])),H=Math.max(H,U),F=Math.max(F,$)}if(a){if(p){const U=Ju(G/I,S,T)*I;if(H=Math.max(H,U),c){let $=0;!f&&!h||f&&!h&&y?$=Ms(C+Y+G/I,c[1][1])*I:$=ks(C+Y+(f?D:-D)/I,c[0][1])*I,H=Math.max(H,$)}if(d){let $=0;!f&&!h||f&&!h&&y?$=ks(C+G/I,d[1][1])*I:$=Ms(C+(f?D:-D)/I,d[0][1])*I,H=Math.max(H,$)}}if(m){const U=Ju(V*I,w,A)/I;if(F=Math.max(F,U),c){let $=0;!f&&!h||h&&!f&&y?$=Ms(E+V*I+z,c[1][0])/I:$=ks(E+(h?P:-P)*I+z,c[0][0])/I,F=Math.max(F,$)}if(d){let $=0;!f&&!h||h&&!f&&y?$=ks(E+V*I,d[1][0])/I:$=Ms(E+(h?P:-P)*I,d[0][0])/I,F=Math.max(F,$)}}}P=P+(P<0?F:-F),D=D+(D<0?H:-H),a&&(y?G>V*I?P=(Fw(f,h)?-D:D)/I:D=(Fw(f,h)?-P:P)*I:p?(P=D/I,h=f):(D=P*I,f=h));const N=f?E+D:E,B=h?C+P:C;return{width:O+(f?-D:D),height:j+(h?-P:P),x:l[0]*D*(f?-1:1)+N,y:l[1]*P*(h?-1:1)+B}}const SS={width:0,height:0,x:0,y:0},EU={...SS,pointerX:0,pointerY:0,aspectRatio:1};function SU(t){return[[0,0],[t.measured.width,t.measured.height]]}function CU(t,e,n){const s=e.position.x+t.position.x,a=e.position.y+t.position.y,l=t.measured.width??0,c=t.measured.height??0,d=n[0]*l,f=n[1]*c;return[[s-d,a-f],[s+l-d,a+c-f]]}function TU({domNode:t,nodeId:e,getStoreItems:n,onChange:s,onEnd:a}){const l=On(t);let c={controlDirection:Vw("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function d({controlPosition:h,boundaries:p,keepAspectRatio:m,resizeDirection:y,onResizeStart:_,onResize:x,onResizeEnd:w,shouldResize:A}){let S={...SS},T={...EU};c={boundaries:p,resizeDirection:y,keepAspectRatio:m,controlDirection:Vw(h)};let E,C=null,O=[],j,I,D,P=!1;const G=DE().on("start",V=>{const{nodeLookup:z,transform:Y,snapGrid:H,snapToGrid:F,nodeOrigin:N,paneDomNode:B}=n();if(E=z.get(e),!E)return;C=B?.getBoundingClientRect()??null;const{xSnapped:U,ySnapped:$}=Nl(V.sourceEvent,{transform:Y,snapGrid:H,snapToGrid:F,containerBounds:C});S={width:E.measured.width??0,height:E.measured.height??0,x:E.position.x??0,y:E.position.y??0},T={...S,pointerX:U,pointerY:$,aspectRatio:S.width/S.height},j=void 0,E.parentId&&(E.extent==="parent"||E.expandParent)&&(j=z.get(E.parentId),I=j&&E.extent==="parent"?SU(j):void 0),O=[],D=void 0;for(const[Q,M]of z)if(M.parentId===e&&(O.push({id:Q,position:{...M.position},extent:M.extent}),M.extent==="parent"||M.expandParent)){const q=CU(M,E,M.origin??N);D?D=[[Math.min(q[0][0],D[0][0]),Math.min(q[0][1],D[0][1])],[Math.max(q[1][0],D[1][0]),Math.max(q[1][1],D[1][1])]]:D=q}_?.(V,{...S})}).on("drag",V=>{const{transform:z,snapGrid:Y,snapToGrid:H,nodeOrigin:F}=n(),N=Nl(V.sourceEvent,{transform:z,snapGrid:Y,snapToGrid:H,containerBounds:C}),B=[];if(!E)return;const{x:U,y:$,width:Q,height:M}=S,q={},X=E.origin??F,{width:Z,height:J,x:ae,y:ce}=AU(T,c.controlDirection,N,c.boundaries,c.keepAspectRatio,X,I,D),de=Z!==Q,ie=J!==M,oe=ae!==U&&de,pe=ce!==$&&ie;if(!oe&&!pe&&!de&&!ie)return;if((oe||pe||X[0]===1||X[1]===1)&&(q.x=oe?ae:S.x,q.y=pe?ce:S.y,S.x=q.x,S.y=q.y,O.length>0)){const fe=ae-U,ve=ce-$;for(const Ie of O)Ie.position={x:Ie.position.x-fe+X[0]*(Z-Q),y:Ie.position.y-ve+X[1]*(J-M)},B.push(Ie)}if((de||ie)&&(q.width=de&&(!c.resizeDirection||c.resizeDirection==="horizontal")?Z:S.width,q.height=ie&&(!c.resizeDirection||c.resizeDirection==="vertical")?J:S.height,S.width=q.width,S.height=q.height),j&&E.expandParent){const fe=X[0]*(q.width??0);q.x&&q.x<fe&&(S.x=fe,T.x=T.x-(q.x-fe));const ve=X[1]*(q.height??0);q.y&&q.y<ve&&(S.y=ve,T.y=T.y-(q.y-ve))}const be=xU({width:S.width,prevWidth:Q,height:S.height,prevHeight:M,affectsX:c.controlDirection.affectsX,affectsY:c.controlDirection.affectsY}),_e={...S,direction:be};A?.(V,_e)!==!1&&(P=!0,x?.(V,_e),s(q,B))}).on("end",V=>{P&&(w?.(V,{...S}),a?.({...S}),P=!1)});l.call(G)}function f(){l.on(".drag",null)}return{update:d,destroy:f}}var dp={exports:{}},fp={},hp={exports:{}},mp={};var Gw;function NU(){if(Gw)return mp;Gw=1;var t=Xl();function e(m,y){return m===y&&(m!==0||1/m===1/y)||m!==m&&y!==y}var n=typeof Object.is=="function"?Object.is:e,s=t.useState,a=t.useEffect,l=t.useLayoutEffect,c=t.useDebugValue;function d(m,y){var _=y(),x=s({inst:{value:_,getSnapshot:y}}),w=x[0].inst,A=x[1];return l(function(){w.value=_,w.getSnapshot=y,f(w)&&A({inst:w})},[m,_,y]),a(function(){return f(w)&&A({inst:w}),m(function(){f(w)&&A({inst:w})})},[m]),c(_),_}function f(m){var y=m.getSnapshot;m=m.value;try{var _=y();return!n(m,_)}catch{return!0}}function h(m,y){return y()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:d;return mp.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:p,mp}var Yw;function RU(){return Yw||(Yw=1,hp.exports=NU()),hp.exports}var Xw;function OU(){if(Xw)return fp;Xw=1;var t=Xl(),e=RU();function n(h,p){return h===p&&(h!==0||1/h===1/p)||h!==h&&p!==p}var s=typeof Object.is=="function"?Object.is:n,a=e.useSyncExternalStore,l=t.useRef,c=t.useEffect,d=t.useMemo,f=t.useDebugValue;return fp.useSyncExternalStoreWithSelector=function(h,p,m,y,_){var x=l(null);if(x.current===null){var w={hasValue:!1,value:null};x.current=w}else w=x.current;x=d(function(){function S(j){if(!T){if(T=!0,E=j,j=y(j),_!==void 0&&w.hasValue){var I=w.value;if(_(I,j))return C=I}return C=j}if(I=C,s(E,j))return I;var D=y(j);return _!==void 0&&_(I,D)?(E=j,I):(E=j,C=D)}var T=!1,E,C,O=m===void 0?null:m;return[function(){return S(p())},O===null?void 0:function(){return S(O())}]},[p,m,y,_]);var A=a(h,x[0],x[1]);return c(function(){w.hasValue=!0,w.value=A},[A]),f(A),A},fp}var Kw;function jU(){return Kw||(Kw=1,dp.exports=OU()),dp.exports}var IU=jU();const kU=Yl(IU),MU={},Ww=t=>{let e;const n=new Set,s=(p,m)=>{const y=typeof p=="function"?p(e):p;if(!Object.is(y,e)){const _=e;e=m??(typeof y!="object"||y===null)?y:Object.assign({},e,y),n.forEach(x=>x(e,_))}},a=()=>e,f={setState:s,getState:a,getInitialState:()=>h,subscribe:p=>(n.add(p),()=>n.delete(p)),destroy:()=>{(MU?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},h=e=t(s,a,f);return f},DU=t=>t?Ww(t):Ww,{useDebugValue:BU}=KN,{useSyncExternalStoreWithSelector:UU}=kU,LU=t=>t;function CS(t,e=LU,n){const s=UU(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return BU(s),s}const Jw=(t,e)=>{const n=DU(t),s=(a,l=e)=>CS(n,a,l);return Object.assign(s,n),s},$U=(t,e)=>t?Jw(t,e):Jw;function vt(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(const[s,a]of t)if(!Object.is(a,e.get(s)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(const s of t)if(!e.has(s))return!1;return!0}const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!1;for(const s of n)if(!Object.prototype.hasOwnProperty.call(e,s)||!Object.is(t[s],e[s]))return!1;return!0}const mf=k.createContext(null),zU=mf.Provider,TS=ir.error001();function Fe(t,e){const n=k.useContext(mf);if(n===null)throw new Error(TS);return CS(n,t,e)}function mt(){const t=k.useContext(mf);if(t===null)throw new Error(TS);return k.useMemo(()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe}),[t])}const Zw={display:"none"},PU={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},NS="react-flow__node-desc",RS="react-flow__edge-desc",HU="react-flow__aria-live",qU=t=>t.ariaLiveMessage,QU=t=>t.ariaLabelConfig;function VU({rfId:t}){const e=Fe(qU);return b.jsx("div",{id:`${HU}-${t}`,"aria-live":"assertive","aria-atomic":"true",style:PU,children:e})}function FU({rfId:t,disableKeyboardA11y:e}){const n=Fe(QU);return b.jsxs(b.Fragment,{children:[b.jsx("div",{id:`${NS}-${t}`,style:Zw,children:e?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),b.jsx("div",{id:`${RS}-${t}`,style:Zw,children:n["edge.a11yDescription.default"]}),!e&&b.jsx(VU,{rfId:t})]})}const pf=k.forwardRef(({position:t="top-left",children:e,className:n,style:s,...a},l)=>{const c=`${t}`.split("-");return b.jsx("div",{className:Ot(["react-flow__panel",n,...c]),style:s,ref:l,...a,children:e})});pf.displayName="Panel";function GU({proOptions:t,position:e="bottom-right"}){return t?.hideAttribution?null:b.jsx(pf,{position:e,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:b.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const YU=t=>{const e=[],n=[];for(const[,s]of t.nodeLookup)s.selected&&e.push(s.internals.userNode);for(const[,s]of t.edgeLookup)s.selected&&n.push(s);return{selectedNodes:e,selectedEdges:n}},Zu=t=>t.id;function XU(t,e){return vt(t.selectedNodes.map(Zu),e.selectedNodes.map(Zu))&&vt(t.selectedEdges.map(Zu),e.selectedEdges.map(Zu))}function KU({onSelectionChange:t}){const e=mt(),{selectedNodes:n,selectedEdges:s}=Fe(YU,XU);return k.useEffect(()=>{const a={nodes:n,edges:s};t?.(a),e.getState().onSelectionChangeHandlers.forEach(l=>l(a))},[n,s,t]),null}const WU=t=>!!t.onSelectionChangeHandlers;function JU({onSelectionChange:t}){const e=Fe(WU);return t||e?b.jsx(KU,{onSelectionChange:t}):null}const OS=[0,0],ZU={x:0,y:0,zoom:1},e3=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig"],ex=[...e3,"rfId"],t3=t=>({setNodes:t.setNodes,setEdges:t.setEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges}),tx={translateExtent:Pl,nodeOrigin:OS,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function n3(t){const{setNodes:e,setEdges:n,setMinZoom:s,setMaxZoom:a,setTranslateExtent:l,setNodeExtent:c,reset:d,setDefaultNodesAndEdges:f}=Fe(t3,vt),h=mt();k.useEffect(()=>(f(t.defaultNodes,t.defaultEdges),()=>{p.current=tx,d()}),[]);const p=k.useRef(tx);return k.useEffect(()=>{for(const m of ex){const y=t[m],_=p.current[m];y!==_&&(typeof t[m]>"u"||(m==="nodes"?e(y):m==="edges"?n(y):m==="minZoom"?s(y):m==="maxZoom"?a(y):m==="translateExtent"?l(y):m==="nodeExtent"?c(y):m==="ariaLabelConfig"?h.setState({ariaLabelConfig:$B(y)}):m==="fitView"?h.setState({fitViewQueued:y}):m==="fitViewOptions"?h.setState({fitViewOptions:y}):h.setState({[m]:y})))}p.current=t},ex.map(m=>t[m])),null}function nx(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function r3(t){const[e,n]=k.useState(t==="system"?null:t);return k.useEffect(()=>{if(t!=="system"){n(t);return}const s=nx(),a=()=>n(s?.matches?"dark":"light");return a(),s?.addEventListener("change",a),()=>{s?.removeEventListener("change",a)}},[t]),e!==null?e:nx()?.matches?"dark":"light"}const rx=typeof document<"u"?document:null;function Fl(t=null,e={target:rx,actInsideInputWithModifier:!0}){const[n,s]=k.useState(!1),a=k.useRef(!1),l=k.useRef(new Set([])),[c,d]=k.useMemo(()=>{if(t!==null){const h=(Array.isArray(t)?t:[t]).filter(m=>typeof m=="string").map(m=>m.replace("+",`
`).replace(`

`,`
+`).split(`
`)),p=h.reduce((m,y)=>m.concat(...y),[]);return[h,p]}return[[],[]]},[t]);return k.useEffect(()=>{const f=e?.target??rx,h=e?.actInsideInputWithModifier??!0;if(t!==null){const p=_=>{if(a.current=_.ctrlKey||_.metaKey||_.shiftKey||_.altKey,(!a.current||a.current&&!h)&&cS(_))return!1;const w=ix(_.code,d);if(l.current.add(_[w]),sx(c,l.current,!1)){const A=_.composedPath?.()?.[0]||_.target,S=A?.nodeName==="BUTTON"||A?.nodeName==="A";e.preventDefault!==!1&&(a.current||!S)&&_.preventDefault(),s(!0)}},m=_=>{const x=ix(_.code,d);sx(c,l.current,!0)?(s(!1),l.current.clear()):l.current.delete(_[x]),_.key==="Meta"&&l.current.clear(),a.current=!1},y=()=>{l.current.clear(),s(!1)};return f?.addEventListener("keydown",p),f?.addEventListener("keyup",m),window.addEventListener("blur",y),window.addEventListener("contextmenu",y),()=>{f?.removeEventListener("keydown",p),f?.removeEventListener("keyup",m),window.removeEventListener("blur",y),window.removeEventListener("contextmenu",y)}}},[t,s]),n}function sx(t,e,n){return t.filter(s=>n||s.length===e.size).some(s=>s.every(a=>e.has(a)))}function ix(t,e){return e.includes(t)?"code":"key"}const s3=()=>{const t=mt();return k.useMemo(()=>({zoomIn:e=>{const{panZoom:n}=t.getState();return n?n.scaleBy(1.2,{duration:e?.duration}):Promise.resolve(!1)},zoomOut:e=>{const{panZoom:n}=t.getState();return n?n.scaleBy(1/1.2,{duration:e?.duration}):Promise.resolve(!1)},zoomTo:(e,n)=>{const{panZoom:s}=t.getState();return s?s.scaleTo(e,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>t.getState().transform[2],setViewport:async(e,n)=>{const{transform:[s,a,l],panZoom:c}=t.getState();return c?(await c.setViewport({x:e.x??s,y:e.y??a,zoom:e.zoom??l},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[e,n,s]=t.getState().transform;return{x:e,y:n,zoom:s}},setCenter:async(e,n,s)=>t.getState().setCenter(e,n,s),fitBounds:async(e,n)=>{const{width:s,height:a,minZoom:l,maxZoom:c,panZoom:d}=t.getState(),f=Qg(e,s,a,l,c,n?.padding??.1);return d?(await d.setViewport(f,{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(e,n={})=>{const{transform:s,snapGrid:a,snapToGrid:l,domNode:c}=t.getState();if(!c)return e;const{x:d,y:f}=c.getBoundingClientRect(),h={x:e.x-d,y:e.y-f},p=n.snapGrid??a,m=n.snapToGrid??l;return ac(h,s,m,p)},flowToScreenPosition:e=>{const{transform:n,domNode:s}=t.getState();if(!s)return e;const{x:a,y:l}=s.getBoundingClientRect(),c=Hd(e,n);return{x:c.x+a,y:c.y+l}}}),[])};function jS(t,e){const n=[],s=new Map,a=[];for(const l of t)if(l.type==="add"){a.push(l);continue}else if(l.type==="remove"||l.type==="replace")s.set(l.id,[l]);else{const c=s.get(l.id);c?c.push(l):s.set(l.id,[l])}for(const l of e){const c=s.get(l.id);if(!c){n.push(l);continue}if(c[0].type==="remove")continue;if(c[0].type==="replace"){n.push({...c[0].item});continue}const d={...l};for(const f of c)i3(f,d);n.push(d)}return a.length&&a.forEach(l=>{l.index!==void 0?n.splice(l.index,0,{...l.item}):n.push({...l.item})}),n}function i3(t,e){switch(t.type){case"select":{e.selected=t.selected;break}case"position":{typeof t.position<"u"&&(e.position=t.position),typeof t.dragging<"u"&&(e.dragging=t.dragging);break}case"dimensions":{typeof t.dimensions<"u"&&(e.measured??={},e.measured.width=t.dimensions.width,e.measured.height=t.dimensions.height,t.setAttributes&&((t.setAttributes===!0||t.setAttributes==="width")&&(e.width=t.dimensions.width),(t.setAttributes===!0||t.setAttributes==="height")&&(e.height=t.dimensions.height))),typeof t.resizing=="boolean"&&(e.resizing=t.resizing);break}}}function IS(t,e){return jS(t,e)}function kS(t,e){return jS(t,e)}function hi(t,e){return{id:t,type:"select",selected:e}}function Ba(t,e=new Set,n=!1){const s=[];for(const[a,l]of t){const c=e.has(a);!(l.selected===void 0&&!c)&&l.selected!==c&&(n&&(l.selected=c),s.push(hi(l.id,c)))}return s}function ax({items:t=[],lookup:e}){const n=[],s=new Map(t.map(a=>[a.id,a]));for(const[a,l]of t.entries()){const c=e.get(l.id),d=c?.internals?.userNode??c;d!==void 0&&d!==l&&n.push({id:l.id,item:l,type:"replace"}),d===void 0&&n.push({item:l,type:"add",index:a})}for(const[a]of e)s.get(a)===void 0&&n.push({id:a,type:"remove"});return n}function ox(t){return{id:t.id,type:"remove"}}const lx=t=>RB(t),a3=t=>tS(t);function MS(t){return k.forwardRef(t)}const o3=typeof window<"u"?k.useLayoutEffect:k.useEffect;function cx(t){const[e,n]=k.useState(BigInt(0)),[s]=k.useState(()=>l3(()=>n(a=>a+BigInt(1))));return o3(()=>{const a=s.get();a.length&&(t(a),s.reset())},[e]),s}function l3(t){let e=[];return{get:()=>e,reset:()=>{e=[]},push:n=>{e.push(n),t()}}}const DS=k.createContext(null);function c3({children:t}){const e=mt(),n=k.useCallback(d=>{const{nodes:f=[],setNodes:h,hasDefaultNodes:p,onNodesChange:m,nodeLookup:y,fitViewQueued:_}=e.getState();let x=f;for(const A of d)x=typeof A=="function"?A(x):A;const w=ax({items:x,lookup:y});p&&h(x),w.length>0?m?.(w):_&&window.requestAnimationFrame(()=>{const{fitViewQueued:A,nodes:S,setNodes:T}=e.getState();A&&T(S)})},[]),s=cx(n),a=k.useCallback(d=>{const{edges:f=[],setEdges:h,hasDefaultEdges:p,onEdgesChange:m,edgeLookup:y}=e.getState();let _=f;for(const x of d)_=typeof x=="function"?x(_):x;p?h(_):m&&m(ax({items:_,lookup:y}))},[]),l=cx(a),c=k.useMemo(()=>({nodeQueue:s,edgeQueue:l}),[]);return b.jsx(DS.Provider,{value:c,children:t})}function u3(){const t=k.useContext(DS);if(!t)throw new Error("useBatchContext must be used within a BatchProvider");return t}const d3=t=>!!t.panZoom;function Jr(){const t=s3(),e=mt(),n=u3(),s=Fe(d3),a=k.useMemo(()=>{const l=m=>e.getState().nodeLookup.get(m),c=m=>{n.nodeQueue.push(m)},d=m=>{n.edgeQueue.push(m)},f=m=>{const{nodeLookup:y,nodeOrigin:_}=e.getState(),x=lx(m)?m:y.get(m.id),w=x.parentId?oS(x.position,x.measured,x.parentId,y,_):x.position,A={...x,position:w,width:x.measured?.width??x.width,height:x.measured?.height??x.height};return Fa(A)},h=(m,y,_={replace:!1})=>{c(x=>x.map(w=>{if(w.id===m){const A=typeof y=="function"?y(w):y;return _.replace&&lx(A)?A:{...w,...A}}return w}))},p=(m,y,_={replace:!1})=>{d(x=>x.map(w=>{if(w.id===m){const A=typeof y=="function"?y(w):y;return _.replace&&a3(A)?A:{...w,...A}}return w}))};return{getNodes:()=>e.getState().nodes.map(m=>({...m})),getNode:m=>l(m)?.internals.userNode,getInternalNode:l,getEdges:()=>{const{edges:m=[]}=e.getState();return m.map(y=>({...y}))},getEdge:m=>e.getState().edgeLookup.get(m),setNodes:c,setEdges:d,addNodes:m=>{const y=Array.isArray(m)?m:[m];n.nodeQueue.push(_=>[..._,...y])},addEdges:m=>{const y=Array.isArray(m)?m:[m];n.edgeQueue.push(_=>[..._,...y])},toObject:()=>{const{nodes:m=[],edges:y=[],transform:_}=e.getState(),[x,w,A]=_;return{nodes:m.map(S=>({...S})),edges:y.map(S=>({...S})),viewport:{x,y:w,zoom:A}}},deleteElements:async({nodes:m=[],edges:y=[]})=>{const{nodes:_,edges:x,onNodesDelete:w,onEdgesDelete:A,triggerNodeChanges:S,triggerEdgeChanges:T,onDelete:E,onBeforeDelete:C}=e.getState(),{nodes:O,edges:j}=await MB({nodesToRemove:m,edgesToRemove:y,nodes:_,edges:x,onBeforeDelete:C}),I=j.length>0,D=O.length>0;if(I){const P=j.map(ox);A?.(j),T(P)}if(D){const P=O.map(ox);w?.(O),S(P)}return(D||I)&&E?.({nodes:O,edges:j}),{deletedNodes:O,deletedEdges:j}},getIntersectingNodes:(m,y=!0,_)=>{const x=Mw(m),w=x?m:f(m),A=_!==void 0;return w?(_||e.getState().nodes).filter(S=>{const T=e.getState().nodeLookup.get(S.id);if(T&&!x&&(S.id===m.id||!T.internals.positionAbsolute))return!1;const E=Fa(A?S:T),C=ql(E,w);return y&&C>0||C>=E.width*E.height||C>=w.width*w.height}):[]},isNodeIntersecting:(m,y,_=!0)=>{const w=Mw(m)?m:f(m);if(!w)return!1;const A=ql(w,y);return _&&A>0||A>=y.width*y.height||A>=w.width*w.height},updateNode:h,updateNodeData:(m,y,_={replace:!1})=>{h(m,x=>{const w=typeof y=="function"?y(x):y;return _.replace?{...x,data:w}:{...x,data:{...x.data,...w}}},_)},updateEdge:p,updateEdgeData:(m,y,_={replace:!1})=>{p(m,x=>{const w=typeof y=="function"?y(x):y;return _.replace?{...x,data:w}:{...x,data:{...x.data,...w}}},_)},getNodesBounds:m=>{const{nodeLookup:y,nodeOrigin:_}=e.getState();return OB(m,{nodeLookup:y,nodeOrigin:_})},getHandleConnections:({type:m,id:y,nodeId:_})=>Array.from(e.getState().connectionLookup.get(`${_}-${m}${y?`-${y}`:""}`)?.values()??[]),getNodeConnections:({type:m,handleId:y,nodeId:_})=>Array.from(e.getState().connectionLookup.get(`${_}${m?y?`-${m}-${y}`:`-${m}`:""}`)?.values()??[]),fitView:async m=>{const y=e.getState().fitViewResolver??LB();return e.setState({fitViewQueued:!0,fitViewOptions:m,fitViewResolver:y}),n.nodeQueue.push(_=>[..._]),y.promise}}},[]);return k.useMemo(()=>({...a,...t,viewportInitialized:s}),[s])}const ux=t=>t.selected,f3=typeof window<"u"?window:void 0;function h3({deleteKeyCode:t,multiSelectionKeyCode:e}){const n=mt(),{deleteElements:s}=Jr(),a=Fl(t,{actInsideInputWithModifier:!1}),l=Fl(e,{target:f3});k.useEffect(()=>{if(a){const{edges:c,nodes:d}=n.getState();s({nodes:d.filter(ux),edges:c.filter(ux)}),n.setState({nodesSelectionActive:!1})}},[a]),k.useEffect(()=>{n.setState({multiSelectionActive:l})},[l])}function m3(t){const e=mt();k.useEffect(()=>{const n=()=>{if(!t.current||!(t.current.checkVisibility?.()??!0))return!1;const s=Vg(t.current);(s.height===0||s.width===0)&&e.getState().onError?.("004",ir.error004()),e.setState({width:s.width||500,height:s.height||500})};if(t.current){n(),window.addEventListener("resize",n);const s=new ResizeObserver(()=>n());return s.observe(t.current),()=>{window.removeEventListener("resize",n),s&&t.current&&s.unobserve(t.current)}}},[])}const gf={position:"absolute",width:"100%",height:"100%",top:0,left:0},p3=t=>({userSelectionActive:t.userSelectionActive,lib:t.lib,connectionInProgress:t.connection.inProgress});function g3({onPaneContextMenu:t,zoomOnScroll:e=!0,zoomOnPinch:n=!0,panOnScroll:s=!1,panOnScrollSpeed:a=.5,panOnScrollMode:l=Si.Free,zoomOnDoubleClick:c=!0,panOnDrag:d=!0,defaultViewport:f,translateExtent:h,minZoom:p,maxZoom:m,zoomActivationKeyCode:y,preventScrolling:_=!0,children:x,noWheelClassName:w,noPanClassName:A,onViewportChange:S,isControlledViewport:T,paneClickDistance:E,selectionOnDrag:C}){const O=mt(),j=k.useRef(null),{userSelectionActive:I,lib:D,connectionInProgress:P}=Fe(p3,vt),G=Fl(y),V=k.useRef();m3(j);const z=k.useCallback(Y=>{S?.({x:Y[0],y:Y[1],zoom:Y[2]}),T||O.setState({transform:Y})},[S,T]);return k.useEffect(()=>{if(j.current){V.current=wU({domNode:j.current,minZoom:p,maxZoom:m,translateExtent:h,viewport:f,onDraggingChange:N=>O.setState({paneDragging:N}),onPanZoomStart:(N,B)=>{const{onViewportChangeStart:U,onMoveStart:$}=O.getState();$?.(N,B),U?.(B)},onPanZoom:(N,B)=>{const{onViewportChange:U,onMove:$}=O.getState();$?.(N,B),U?.(B)},onPanZoomEnd:(N,B)=>{const{onViewportChangeEnd:U,onMoveEnd:$}=O.getState();$?.(N,B),U?.(B)}});const{x:Y,y:H,zoom:F}=V.current.getViewport();return O.setState({panZoom:V.current,transform:[Y,H,F],domNode:j.current.closest(".react-flow")}),()=>{V.current?.destroy()}}},[]),k.useEffect(()=>{V.current?.update({onPaneContextMenu:t,zoomOnScroll:e,zoomOnPinch:n,panOnScroll:s,panOnScrollSpeed:a,panOnScrollMode:l,zoomOnDoubleClick:c,panOnDrag:d,zoomActivationKeyPressed:G,preventScrolling:_,noPanClassName:A,userSelectionActive:I,noWheelClassName:w,lib:D,onTransformChange:z,connectionInProgress:P,selectionOnDrag:C,paneClickDistance:E})},[t,e,n,s,a,l,c,d,G,_,A,I,w,D,z,P,C,E]),b.jsx("div",{className:"react-flow__renderer",ref:j,style:gf,children:x})}const y3=t=>({userSelectionActive:t.userSelectionActive,userSelectionRect:t.userSelectionRect});function v3(){const{userSelectionActive:t,userSelectionRect:e}=Fe(y3,vt);return t&&e?b.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:e.width,height:e.height,transform:`translate(${e.x}px, ${e.y}px)`}}):null}const pp=(t,e)=>n=>{n.target===e.current&&t?.(n)},_3=t=>({userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable,connectionInProgress:t.connection.inProgress,dragging:t.paneDragging});function b3({isSelecting:t,selectionKeyPressed:e,selectionMode:n=Hl.Full,panOnDrag:s,paneClickDistance:a,selectionOnDrag:l,onSelectionStart:c,onSelectionEnd:d,onPaneClick:f,onPaneContextMenu:h,onPaneScroll:p,onPaneMouseEnter:m,onPaneMouseMove:y,onPaneMouseLeave:_,children:x}){const w=mt(),{userSelectionActive:A,elementsSelectable:S,dragging:T,connectionInProgress:E}=Fe(_3,vt),C=S&&(t||A),O=k.useRef(null),j=k.useRef(),I=k.useRef(new Set),D=k.useRef(new Set),P=k.useRef(!1),G=U=>{if(P.current||E){P.current=!1;return}f?.(U),w.getState().resetSelectedElements(),w.setState({nodesSelectionActive:!1})},V=U=>{if(Array.isArray(s)&&s?.includes(2)){U.preventDefault();return}h?.(U)},z=p?U=>p(U):void 0,Y=U=>{P.current&&(U.stopPropagation(),P.current=!1)},H=U=>{const{domNode:$}=w.getState();if(j.current=$?.getBoundingClientRect(),!j.current)return;const Q=U.target===O.current;if(!Q&&!!U.target.closest(".nokey")||!t||!(l&&Q||e)||U.button!==0||!U.isPrimary)return;U.target?.setPointerCapture?.(U.pointerId),P.current=!1;const{x:X,y:Z}=sr(U.nativeEvent,j.current);w.setState({userSelectionRect:{width:0,height:0,startX:X,startY:Z,x:X,y:Z}}),Q||(U.stopPropagation(),U.preventDefault())},F=U=>{const{userSelectionRect:$,transform:Q,nodeLookup:M,edgeLookup:q,connectionLookup:X,triggerNodeChanges:Z,triggerEdgeChanges:J,defaultEdgeOptions:ae,resetSelectedElements:ce}=w.getState();if(!j.current||!$)return;const{x:de,y:ie}=sr(U.nativeEvent,j.current),{startX:oe,startY:pe}=$;if(!P.current){const ve=e?0:a;if(Math.hypot(de-oe,ie-pe)<=ve)return;ce(),c?.(U)}P.current=!0;const be={startX:oe,startY:pe,x:de<oe?de:oe,y:ie<pe?ie:pe,width:Math.abs(de-oe),height:Math.abs(ie-pe)},_e=I.current,Me=D.current;I.current=new Set(qg(M,be,Q,n===Hl.Partial,!0).map(ve=>ve.id)),D.current=new Set;const fe=ae?.selectable??!0;for(const ve of I.current){const Ie=X.get(ve);if(Ie)for(const{edgeId:Xe}of Ie.values()){const Je=q.get(Xe);Je&&(Je.selectable??fe)&&D.current.add(Xe)}}if(!Dw(_e,I.current)){const ve=Ba(M,I.current,!0);Z(ve)}if(!Dw(Me,D.current)){const ve=Ba(q,D.current);J(ve)}w.setState({userSelectionRect:be,userSelectionActive:!0,nodesSelectionActive:!1})},N=U=>{U.button===0&&(U.target?.releasePointerCapture?.(U.pointerId),!A&&U.target===O.current&&w.getState().userSelectionRect&&G?.(U),w.setState({userSelectionActive:!1,userSelectionRect:null}),P.current&&(d?.(U),w.setState({nodesSelectionActive:I.current.size>0})))},B=s===!0||Array.isArray(s)&&s.includes(0);return b.jsxs("div",{className:Ot(["react-flow__pane",{draggable:B,dragging:T,selection:t}]),onClick:C?void 0:pp(G,O),onContextMenu:pp(V,O),onWheel:pp(z,O),onPointerEnter:C?void 0:m,onPointerMove:C?F:y,onPointerUp:C?N:void 0,onPointerDownCapture:C?H:void 0,onClickCapture:C?Y:void 0,onPointerLeave:_,ref:O,style:gf,children:[x,b.jsx(v3,{})]})}function ng({id:t,store:e,unselect:n=!1,nodeRef:s}){const{addSelectedNodes:a,unselectNodesAndEdges:l,multiSelectionActive:c,nodeLookup:d,onError:f}=e.getState(),h=d.get(t);if(!h){f?.("012",ir.error012(t));return}e.setState({nodesSelectionActive:!1}),h.selected?(n||h.selected&&c)&&(l({nodes:[h],edges:[]}),requestAnimationFrame(()=>s?.current?.blur())):a([t])}function BS({nodeRef:t,disabled:e=!1,noDragClassName:n,handleSelector:s,nodeId:a,isSelectable:l,nodeClickDistance:c}){const d=mt(),[f,h]=k.useState(!1),p=k.useRef();return k.useEffect(()=>{p.current=oU({getStoreItems:()=>d.getState(),onNodeMouseDown:m=>{ng({id:m,store:d,nodeRef:t})},onDragStart:()=>{h(!0)},onDragStop:()=>{h(!1)}})},[]),k.useEffect(()=>{if(e)p.current?.destroy();else if(t.current)return p.current?.update({noDragClassName:n,handleSelector:s,domNode:t.current,isSelectable:l,nodeId:a,nodeClickDistance:c}),()=>{p.current?.destroy()}},[n,s,e,l,t,a]),f}const w3=t=>e=>e.selected&&(e.draggable||t&&typeof e.draggable>"u");function US(){const t=mt();return k.useCallback(n=>{const{nodeExtent:s,snapToGrid:a,snapGrid:l,nodesDraggable:c,onError:d,updateNodePositions:f,nodeLookup:h,nodeOrigin:p}=t.getState(),m=new Map,y=w3(c),_=a?l[0]:5,x=a?l[1]:5,w=n.direction.x*_*n.factor,A=n.direction.y*x*n.factor;for(const[,S]of h){if(!y(S))continue;let T={x:S.internals.positionAbsolute.x+w,y:S.internals.positionAbsolute.y+A};a&&(T=ic(T,l));const{position:E,positionAbsolute:C}=nS({nodeId:S.id,nextPosition:T,nodeLookup:h,nodeExtent:s,nodeOrigin:p,onError:d});S.position=E,S.internals.positionAbsolute=C,m.set(S.id,S)}f(m)},[])}const Wg=k.createContext(null),x3=Wg.Provider;Wg.Consumer;const Jg=()=>k.useContext(Wg),A3=t=>({connectOnClick:t.connectOnClick,noPanClassName:t.noPanClassName,rfId:t.rfId}),E3=(t,e,n)=>s=>{const{connectionClickStartHandle:a,connectionMode:l,connection:c}=s,{fromHandle:d,toHandle:f,isValid:h}=c,p=f?.nodeId===t&&f?.id===e&&f?.type===n;return{connectingFrom:d?.nodeId===t&&d?.id===e&&d?.type===n,connectingTo:p,clickConnecting:a?.nodeId===t&&a?.id===e&&a?.type===n,isPossibleEndHandle:l===Qa.Strict?d?.type!==n:t!==d?.nodeId||e!==d?.id,connectionInProcess:!!d,clickConnectionInProcess:!!a,valid:p&&h}};function S3({type:t="source",position:e=we.Top,isValidConnection:n,isConnectable:s=!0,isConnectableStart:a=!0,isConnectableEnd:l=!0,id:c,onConnect:d,children:f,className:h,onMouseDown:p,onTouchStart:m,...y},_){const x=c||null,w=t==="target",A=mt(),S=Jg(),{connectOnClick:T,noPanClassName:E,rfId:C}=Fe(A3,vt),{connectingFrom:O,connectingTo:j,clickConnecting:I,isPossibleEndHandle:D,connectionInProcess:P,clickConnectionInProcess:G,valid:V}=Fe(E3(S,x,t),vt);S||A.getState().onError?.("010",ir.error010());const z=F=>{const{defaultEdgeOptions:N,onConnect:B,hasDefaultEdges:U}=A.getState(),$={...N,...F};if(U){const{edges:Q,setEdges:M}=A.getState();M(hS($,Q))}B?.($),d?.($)},Y=F=>{if(!S)return;const N=uS(F.nativeEvent);if(a&&(N&&F.button===0||!N)){const B=A.getState();tg.onPointerDown(F.nativeEvent,{handleDomNode:F.currentTarget,autoPanOnConnect:B.autoPanOnConnect,connectionMode:B.connectionMode,connectionRadius:B.connectionRadius,domNode:B.domNode,nodeLookup:B.nodeLookup,lib:B.lib,isTarget:w,handleId:x,nodeId:S,flowId:B.rfId,panBy:B.panBy,cancelConnection:B.cancelConnection,onConnectStart:B.onConnectStart,onConnectEnd:B.onConnectEnd,updateConnection:B.updateConnection,onConnect:z,isValidConnection:n||B.isValidConnection,getTransform:()=>A.getState().transform,getFromHandle:()=>A.getState().connection.fromHandle,autoPanSpeed:B.autoPanSpeed,dragThreshold:B.connectionDragThreshold})}N?p?.(F):m?.(F)},H=F=>{const{onClickConnectStart:N,onClickConnectEnd:B,connectionClickStartHandle:U,connectionMode:$,isValidConnection:Q,lib:M,rfId:q,nodeLookup:X,connection:Z}=A.getState();if(!S||!U&&!a)return;if(!U){N?.(F.nativeEvent,{nodeId:S,handleId:x,handleType:t}),A.setState({connectionClickStartHandle:{nodeId:S,type:t,id:x}});return}const J=lS(F.target),ae=n||Q,{connection:ce,isValid:de}=tg.isValid(F.nativeEvent,{handle:{nodeId:S,id:x,type:t},connectionMode:$,fromNodeId:U.nodeId,fromHandleId:U.id||null,fromType:U.type,isValidConnection:ae,flowId:q,doc:J,lib:M,nodeLookup:X});de&&ce&&z(ce);const ie=structuredClone(Z);delete ie.inProgress,ie.toPosition=ie.toHandle?ie.toHandle.position:null,B?.(F,ie),A.setState({connectionClickStartHandle:null})};return b.jsx("div",{"data-handleid":x,"data-nodeid":S,"data-handlepos":e,"data-id":`${C}-${S}-${x}-${t}`,className:Ot(["react-flow__handle",`react-flow__handle-${e}`,"nodrag",E,h,{source:!w,target:w,connectable:s,connectablestart:a,connectableend:l,clickconnecting:I,connectingfrom:O,connectingto:j,valid:V,connectionindicator:s&&(!P||D)&&(P||G?l:a)}]),onMouseDown:Y,onTouchStart:Y,onClick:T?H:void 0,ref:_,...y,children:f})}const Lt=k.memo(MS(S3));function C3({data:t,isConnectable:e,sourcePosition:n=we.Bottom}){return b.jsxs(b.Fragment,{children:[t?.label,b.jsx(Lt,{type:"source",position:n,isConnectable:e})]})}function T3({data:t,isConnectable:e,targetPosition:n=we.Top,sourcePosition:s=we.Bottom}){return b.jsxs(b.Fragment,{children:[b.jsx(Lt,{type:"target",position:n,isConnectable:e}),t?.label,b.jsx(Lt,{type:"source",position:s,isConnectable:e})]})}function N3(){return null}function R3({data:t,isConnectable:e,targetPosition:n=we.Top}){return b.jsxs(b.Fragment,{children:[b.jsx(Lt,{type:"target",position:n,isConnectable:e}),t?.label]})}const qd={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},dx={input:C3,default:T3,output:R3,group:N3};function O3(t){return t.internals.handleBounds===void 0?{width:t.width??t.initialWidth??t.style?.width,height:t.height??t.initialHeight??t.style?.height}:{width:t.width??t.style?.width,height:t.height??t.style?.height}}const j3=t=>{const{width:e,height:n,x:s,y:a}=sc(t.nodeLookup,{filter:l=>!!l.selected});return{width:rr(e)?e:null,height:rr(n)?n:null,userSelectionActive:t.userSelectionActive,transformString:`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]}) translate(${s}px,${a}px)`}};function I3({onSelectionContextMenu:t,noPanClassName:e,disableKeyboardA11y:n}){const s=mt(),{width:a,height:l,transformString:c,userSelectionActive:d}=Fe(j3,vt),f=US(),h=k.useRef(null);if(k.useEffect(()=>{n||h.current?.focus({preventScroll:!0})},[n]),BS({nodeRef:h}),d||!a||!l)return null;const p=t?y=>{const _=s.getState().nodes.filter(x=>x.selected);t(y,_)}:void 0,m=y=>{Object.prototype.hasOwnProperty.call(qd,y.key)&&(y.preventDefault(),f({direction:qd[y.key],factor:y.shiftKey?4:1}))};return b.jsx("div",{className:Ot(["react-flow__nodesselection","react-flow__container",e]),style:{transform:c},children:b.jsx("div",{ref:h,className:"react-flow__nodesselection-rect",onContextMenu:p,tabIndex:n?void 0:-1,onKeyDown:n?void 0:m,style:{width:a,height:l}})})}const fx=typeof window<"u"?window:void 0,k3=t=>({nodesSelectionActive:t.nodesSelectionActive,userSelectionActive:t.userSelectionActive});function LS({children:t,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:s,onPaneMouseLeave:a,onPaneContextMenu:l,onPaneScroll:c,paneClickDistance:d,deleteKeyCode:f,selectionKeyCode:h,selectionOnDrag:p,selectionMode:m,onSelectionStart:y,onSelectionEnd:_,multiSelectionKeyCode:x,panActivationKeyCode:w,zoomActivationKeyCode:A,elementsSelectable:S,zoomOnScroll:T,zoomOnPinch:E,panOnScroll:C,panOnScrollSpeed:O,panOnScrollMode:j,zoomOnDoubleClick:I,panOnDrag:D,defaultViewport:P,translateExtent:G,minZoom:V,maxZoom:z,preventScrolling:Y,onSelectionContextMenu:H,noWheelClassName:F,noPanClassName:N,disableKeyboardA11y:B,onViewportChange:U,isControlledViewport:$}){const{nodesSelectionActive:Q,userSelectionActive:M}=Fe(k3),q=Fl(h,{target:fx}),X=Fl(w,{target:fx}),Z=X||D,J=X||C,ae=p&&Z!==!0,ce=q||M||ae;return h3({deleteKeyCode:f,multiSelectionKeyCode:x}),b.jsx(g3,{onPaneContextMenu:l,elementsSelectable:S,zoomOnScroll:T,zoomOnPinch:E,panOnScroll:J,panOnScrollSpeed:O,panOnScrollMode:j,zoomOnDoubleClick:I,panOnDrag:!q&&Z,defaultViewport:P,translateExtent:G,minZoom:V,maxZoom:z,zoomActivationKeyCode:A,preventScrolling:Y,noWheelClassName:F,noPanClassName:N,onViewportChange:U,isControlledViewport:$,paneClickDistance:d,selectionOnDrag:ae,children:b.jsxs(b3,{onSelectionStart:y,onSelectionEnd:_,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:s,onPaneMouseLeave:a,onPaneContextMenu:l,onPaneScroll:c,panOnDrag:Z,isSelecting:!!ce,selectionMode:m,selectionKeyPressed:q,paneClickDistance:d,selectionOnDrag:ae,children:[t,Q&&b.jsx(I3,{onSelectionContextMenu:H,noPanClassName:N,disableKeyboardA11y:B})]})})}LS.displayName="FlowRenderer";const M3=k.memo(LS),D3=t=>e=>t?qg(e.nodeLookup,{x:0,y:0,width:e.width,height:e.height},e.transform,!0).map(n=>n.id):Array.from(e.nodeLookup.keys());function B3(t){return Fe(k.useCallback(D3(t),[t]),vt)}const U3=t=>t.updateNodeInternals;function L3(){const t=Fe(U3),[e]=k.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const s=new Map;n.forEach(a=>{const l=a.target.getAttribute("data-id");s.set(l,{id:l,nodeElement:a.target,force:!0})}),t(s)}));return k.useEffect(()=>()=>{e?.disconnect()},[e]),e}function $3({node:t,nodeType:e,hasDimensions:n,resizeObserver:s}){const a=mt(),l=k.useRef(null),c=k.useRef(null),d=k.useRef(t.sourcePosition),f=k.useRef(t.targetPosition),h=k.useRef(e),p=n&&!!t.internals.handleBounds;return k.useEffect(()=>{l.current&&!t.hidden&&(!p||c.current!==l.current)&&(c.current&&s?.unobserve(c.current),s?.observe(l.current),c.current=l.current)},[p,t.hidden]),k.useEffect(()=>()=>{c.current&&(s?.unobserve(c.current),c.current=null)},[]),k.useEffect(()=>{if(l.current){const m=h.current!==e,y=d.current!==t.sourcePosition,_=f.current!==t.targetPosition;(m||y||_)&&(h.current=e,d.current=t.sourcePosition,f.current=t.targetPosition,a.getState().updateNodeInternals(new Map([[t.id,{id:t.id,nodeElement:l.current,force:!0}]])))}},[t.id,e,t.sourcePosition,t.targetPosition]),l}function z3({id:t,onClick:e,onMouseEnter:n,onMouseMove:s,onMouseLeave:a,onContextMenu:l,onDoubleClick:c,nodesDraggable:d,elementsSelectable:f,nodesConnectable:h,nodesFocusable:p,resizeObserver:m,noDragClassName:y,noPanClassName:_,disableKeyboardA11y:x,rfId:w,nodeTypes:A,nodeClickDistance:S,onError:T}){const{node:E,internals:C,isParent:O}=Fe(de=>{const ie=de.nodeLookup.get(t),oe=de.parentLookup.has(t);return{node:ie,internals:ie.internals,isParent:oe}},vt);let j=E.type||"default",I=A?.[j]||dx[j];I===void 0&&(T?.("003",ir.error003(j)),j="default",I=A?.default||dx.default);const D=!!(E.draggable||d&&typeof E.draggable>"u"),P=!!(E.selectable||f&&typeof E.selectable>"u"),G=!!(E.connectable||h&&typeof E.connectable>"u"),V=!!(E.focusable||p&&typeof E.focusable>"u"),z=mt(),Y=aS(E),H=$3({node:E,nodeType:j,hasDimensions:Y,resizeObserver:m}),F=BS({nodeRef:H,disabled:E.hidden||!D,noDragClassName:y,handleSelector:E.dragHandle,nodeId:t,isSelectable:P,nodeClickDistance:S}),N=US();if(E.hidden)return null;const B=es(E),U=O3(E),$=P||D||e||n||s||a,Q=n?de=>n(de,{...C.userNode}):void 0,M=s?de=>s(de,{...C.userNode}):void 0,q=a?de=>a(de,{...C.userNode}):void 0,X=l?de=>l(de,{...C.userNode}):void 0,Z=c?de=>c(de,{...C.userNode}):void 0,J=de=>{const{selectNodesOnDrag:ie,nodeDragThreshold:oe}=z.getState();P&&(!ie||!D||oe>0)&&ng({id:t,store:z,nodeRef:H}),e&&e(de,{...C.userNode})},ae=de=>{if(!(cS(de.nativeEvent)||x)){if(WE.includes(de.key)&&P){const ie=de.key==="Escape";ng({id:t,store:z,unselect:ie,nodeRef:H})}else if(D&&E.selected&&Object.prototype.hasOwnProperty.call(qd,de.key)){de.preventDefault();const{ariaLabelConfig:ie}=z.getState();z.setState({ariaLiveMessage:ie["node.a11yDescription.ariaLiveMessage"]({direction:de.key.replace("Arrow","").toLowerCase(),x:~~C.positionAbsolute.x,y:~~C.positionAbsolute.y})}),N({direction:qd[de.key],factor:de.shiftKey?4:1})}}},ce=()=>{if(x||!H.current?.matches(":focus-visible"))return;const{transform:de,width:ie,height:oe,autoPanOnNodeFocus:pe,setCenter:be}=z.getState();if(!pe)return;qg(new Map([[t,E]]),{x:0,y:0,width:ie,height:oe},de,!0).length>0||be(E.position.x+B.width/2,E.position.y+B.height/2,{zoom:de[2]})};return b.jsx("div",{className:Ot(["react-flow__node",`react-flow__node-${j}`,{[_]:D},E.className,{selected:E.selected,selectable:P,parent:O,draggable:D,dragging:F}]),ref:H,style:{zIndex:C.z,transform:`translate(${C.positionAbsolute.x}px,${C.positionAbsolute.y}px)`,pointerEvents:$?"all":"none",visibility:Y?"visible":"hidden",...E.style,...U},"data-id":t,"data-testid":`rf__node-${t}`,onMouseEnter:Q,onMouseMove:M,onMouseLeave:q,onContextMenu:X,onClick:J,onDoubleClick:Z,onKeyDown:V?ae:void 0,tabIndex:V?0:void 0,onFocus:V?ce:void 0,role:E.ariaRole??(V?"group":void 0),"aria-roledescription":"node","aria-describedby":x?void 0:`${NS}-${w}`,"aria-label":E.ariaLabel,...E.domAttributes,children:b.jsx(x3,{value:t,children:b.jsx(I,{id:t,data:E.data,type:j,positionAbsoluteX:C.positionAbsolute.x,positionAbsoluteY:C.positionAbsolute.y,selected:E.selected??!1,selectable:P,draggable:D,deletable:E.deletable??!0,isConnectable:G,sourcePosition:E.sourcePosition,targetPosition:E.targetPosition,dragging:F,dragHandle:E.dragHandle,zIndex:C.z,parentId:E.parentId,...B})})})}var P3=k.memo(z3);const H3=t=>({nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,nodesFocusable:t.nodesFocusable,elementsSelectable:t.elementsSelectable,onError:t.onError});function $S(t){const{nodesDraggable:e,nodesConnectable:n,nodesFocusable:s,elementsSelectable:a,onError:l}=Fe(H3,vt),c=B3(t.onlyRenderVisibleElements),d=L3();return b.jsx("div",{className:"react-flow__nodes",style:gf,children:c.map(f=>b.jsx(P3,{id:f,nodeTypes:t.nodeTypes,nodeExtent:t.nodeExtent,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,rfId:t.rfId,disableKeyboardA11y:t.disableKeyboardA11y,resizeObserver:d,nodesDraggable:e,nodesConnectable:n,nodesFocusable:s,elementsSelectable:a,nodeClickDistance:t.nodeClickDistance,onError:l},f))})}$S.displayName="NodeRenderer";const q3=k.memo($S);function Q3(t){return Fe(k.useCallback(n=>{if(!t)return n.edges.map(a=>a.id);const s=[];if(n.width&&n.height)for(const a of n.edges){const l=n.nodeLookup.get(a.source),c=n.nodeLookup.get(a.target);l&&c&&HB({sourceNode:l,targetNode:c,width:n.width,height:n.height,transform:n.transform})&&s.push(a.id)}return s},[t]),vt)}const V3=({color:t="none",strokeWidth:e=1})=>{const n={strokeWidth:e,...t&&{stroke:t}};return b.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},F3=({color:t="none",strokeWidth:e=1})=>{const n={strokeWidth:e,...t&&{stroke:t,fill:t}};return b.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},hx={[zd.Arrow]:V3,[zd.ArrowClosed]:F3};function G3(t){const e=mt();return k.useMemo(()=>Object.prototype.hasOwnProperty.call(hx,t)?hx[t]:(e.getState().onError?.("009",ir.error009(t)),null),[t])}const Y3=({id:t,type:e,color:n,width:s=12.5,height:a=12.5,markerUnits:l="strokeWidth",strokeWidth:c,orient:d="auto-start-reverse"})=>{const f=G3(e);return f?b.jsx("marker",{className:"react-flow__arrowhead",id:t,markerWidth:`${s}`,markerHeight:`${a}`,viewBox:"-10 -10 20 20",markerUnits:l,orient:d,refX:"0",refY:"0",children:b.jsx(f,{color:n,strokeWidth:c})}):null},zS=({defaultColor:t,rfId:e})=>{const n=Fe(l=>l.edges),s=Fe(l=>l.defaultEdgeOptions),a=k.useMemo(()=>XB(n,{id:e,defaultColor:t,defaultMarkerStart:s?.markerStart,defaultMarkerEnd:s?.markerEnd}),[n,s,e,t]);return a.length?b.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:b.jsx("defs",{children:a.map(l=>b.jsx(Y3,{id:l.id,type:l.type,color:l.color,width:l.width,height:l.height,markerUnits:l.markerUnits,strokeWidth:l.strokeWidth,orient:l.orient},l.id))})}):null};zS.displayName="MarkerDefinitions";var X3=k.memo(zS);function PS({x:t,y:e,label:n,labelStyle:s,labelShowBg:a=!0,labelBgStyle:l,labelBgPadding:c=[2,4],labelBgBorderRadius:d=2,children:f,className:h,...p}){const[m,y]=k.useState({x:1,y:0,width:0,height:0}),_=Ot(["react-flow__edge-textwrapper",h]),x=k.useRef(null);return k.useEffect(()=>{if(x.current){const w=x.current.getBBox();y({x:w.x,y:w.y,width:w.width,height:w.height})}},[n]),n?b.jsxs("g",{transform:`translate(${t-m.width/2} ${e-m.height/2})`,className:_,visibility:m.width?"visible":"hidden",...p,children:[a&&b.jsx("rect",{width:m.width+2*c[0],x:-c[0],y:-c[1],height:m.height+2*c[1],className:"react-flow__edge-textbg",style:l,rx:d,ry:d}),b.jsx("text",{className:"react-flow__edge-text",y:m.height/2,dy:"0.3em",ref:x,style:s,children:n}),f]}):null}PS.displayName="EdgeText";const K3=k.memo(PS);function yf({path:t,labelX:e,labelY:n,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:f,interactionWidth:h=20,...p}){return b.jsxs(b.Fragment,{children:[b.jsx("path",{...p,d:t,fill:"none",className:Ot(["react-flow__edge-path",p.className])}),h?b.jsx("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}):null,s&&rr(e)&&rr(n)?b.jsx(K3,{x:e,y:n,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:f}):null]})}function mx({pos:t,x1:e,y1:n,x2:s,y2:a}){return t===we.Left||t===we.Right?[.5*(e+s),n]:[e,.5*(n+a)]}function HS({sourceX:t,sourceY:e,sourcePosition:n=we.Bottom,targetX:s,targetY:a,targetPosition:l=we.Top}){const[c,d]=mx({pos:n,x1:t,y1:e,x2:s,y2:a}),[f,h]=mx({pos:l,x1:s,y1:a,x2:t,y2:e}),[p,m,y,_]=dS({sourceX:t,sourceY:e,targetX:s,targetY:a,sourceControlX:c,sourceControlY:d,targetControlX:f,targetControlY:h});return[`M${t},${e} C${c},${d} ${f},${h} ${s},${a}`,p,m,y,_]}function qS(t){return k.memo(({id:e,sourceX:n,sourceY:s,targetX:a,targetY:l,sourcePosition:c,targetPosition:d,label:f,labelStyle:h,labelShowBg:p,labelBgStyle:m,labelBgPadding:y,labelBgBorderRadius:_,style:x,markerEnd:w,markerStart:A,interactionWidth:S})=>{const[T,E,C]=HS({sourceX:n,sourceY:s,sourcePosition:c,targetX:a,targetY:l,targetPosition:d}),O=t.isInternal?void 0:e;return b.jsx(yf,{id:O,path:T,labelX:E,labelY:C,label:f,labelStyle:h,labelShowBg:p,labelBgStyle:m,labelBgPadding:y,labelBgBorderRadius:_,style:x,markerEnd:w,markerStart:A,interactionWidth:S})})}const W3=qS({isInternal:!1}),QS=qS({isInternal:!0});W3.displayName="SimpleBezierEdge";QS.displayName="SimpleBezierEdgeInternal";function VS(t){return k.memo(({id:e,sourceX:n,sourceY:s,targetX:a,targetY:l,label:c,labelStyle:d,labelShowBg:f,labelBgStyle:h,labelBgPadding:p,labelBgBorderRadius:m,style:y,sourcePosition:_=we.Bottom,targetPosition:x=we.Top,markerEnd:w,markerStart:A,pathOptions:S,interactionWidth:T})=>{const[E,C,O]=Jp({sourceX:n,sourceY:s,sourcePosition:_,targetX:a,targetY:l,targetPosition:x,borderRadius:S?.borderRadius,offset:S?.offset,stepPosition:S?.stepPosition}),j=t.isInternal?void 0:e;return b.jsx(yf,{id:j,path:E,labelX:C,labelY:O,label:c,labelStyle:d,labelShowBg:f,labelBgStyle:h,labelBgPadding:p,labelBgBorderRadius:m,style:y,markerEnd:w,markerStart:A,interactionWidth:T})})}const FS=VS({isInternal:!1}),GS=VS({isInternal:!0});FS.displayName="SmoothStepEdge";GS.displayName="SmoothStepEdgeInternal";function YS(t){return k.memo(({id:e,...n})=>{const s=t.isInternal?void 0:e;return b.jsx(FS,{...n,id:s,pathOptions:k.useMemo(()=>({borderRadius:0,offset:n.pathOptions?.offset}),[n.pathOptions?.offset])})})}const J3=YS({isInternal:!1}),XS=YS({isInternal:!0});J3.displayName="StepEdge";XS.displayName="StepEdgeInternal";function KS(t){return k.memo(({id:e,sourceX:n,sourceY:s,targetX:a,targetY:l,label:c,labelStyle:d,labelShowBg:f,labelBgStyle:h,labelBgPadding:p,labelBgBorderRadius:m,style:y,markerEnd:_,markerStart:x,interactionWidth:w})=>{const[A,S,T]=mS({sourceX:n,sourceY:s,targetX:a,targetY:l}),E=t.isInternal?void 0:e;return b.jsx(yf,{id:E,path:A,labelX:S,labelY:T,label:c,labelStyle:d,labelShowBg:f,labelBgStyle:h,labelBgPadding:p,labelBgBorderRadius:m,style:y,markerEnd:_,markerStart:x,interactionWidth:w})})}const Z3=KS({isInternal:!1}),WS=KS({isInternal:!0});Z3.displayName="StraightEdge";WS.displayName="StraightEdgeInternal";function JS(t){return k.memo(({id:e,sourceX:n,sourceY:s,targetX:a,targetY:l,sourcePosition:c=we.Bottom,targetPosition:d=we.Top,label:f,labelStyle:h,labelShowBg:p,labelBgStyle:m,labelBgPadding:y,labelBgBorderRadius:_,style:x,markerEnd:w,markerStart:A,pathOptions:S,interactionWidth:T})=>{const[E,C,O]=Fg({sourceX:n,sourceY:s,sourcePosition:c,targetX:a,targetY:l,targetPosition:d,curvature:S?.curvature}),j=t.isInternal?void 0:e;return b.jsx(yf,{id:j,path:E,labelX:C,labelY:O,label:f,labelStyle:h,labelShowBg:p,labelBgStyle:m,labelBgPadding:y,labelBgBorderRadius:_,style:x,markerEnd:w,markerStart:A,interactionWidth:T})})}const eL=JS({isInternal:!1}),ZS=JS({isInternal:!0});eL.displayName="BezierEdge";ZS.displayName="BezierEdgeInternal";const px={default:ZS,straight:WS,step:XS,smoothstep:GS,simplebezier:QS},gx={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},tL=(t,e,n)=>n===we.Left?t-e:n===we.Right?t+e:t,nL=(t,e,n)=>n===we.Top?t-e:n===we.Bottom?t+e:t,yx="react-flow__edgeupdater";function vx({position:t,centerX:e,centerY:n,radius:s=10,onMouseDown:a,onMouseEnter:l,onMouseOut:c,type:d}){return b.jsx("circle",{onMouseDown:a,onMouseEnter:l,onMouseOut:c,className:Ot([yx,`${yx}-${d}`]),cx:tL(e,s,t),cy:nL(n,s,t),r:s,stroke:"transparent",fill:"transparent"})}function rL({isReconnectable:t,reconnectRadius:e,edge:n,sourceX:s,sourceY:a,targetX:l,targetY:c,sourcePosition:d,targetPosition:f,onReconnect:h,onReconnectStart:p,onReconnectEnd:m,setReconnecting:y,setUpdateHover:_}){const x=mt(),w=(C,O)=>{if(C.button!==0)return;const{autoPanOnConnect:j,domNode:I,isValidConnection:D,connectionMode:P,connectionRadius:G,lib:V,onConnectStart:z,onConnectEnd:Y,cancelConnection:H,nodeLookup:F,rfId:N,panBy:B,updateConnection:U}=x.getState(),$=O.type==="target",Q=(X,Z)=>{y(!1),m?.(X,n,O.type,Z)},M=X=>h?.(n,X),q=(X,Z)=>{y(!0),p?.(C,n,O.type),z?.(X,Z)};tg.onPointerDown(C.nativeEvent,{autoPanOnConnect:j,connectionMode:P,connectionRadius:G,domNode:I,handleId:O.id,nodeId:O.nodeId,nodeLookup:F,isTarget:$,edgeUpdaterType:O.type,lib:V,flowId:N,cancelConnection:H,panBy:B,isValidConnection:D,onConnect:M,onConnectStart:q,onConnectEnd:Y,onReconnectEnd:Q,updateConnection:U,getTransform:()=>x.getState().transform,getFromHandle:()=>x.getState().connection.fromHandle,dragThreshold:x.getState().connectionDragThreshold,handleDomNode:C.currentTarget})},A=C=>w(C,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),S=C=>w(C,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),T=()=>_(!0),E=()=>_(!1);return b.jsxs(b.Fragment,{children:[(t===!0||t==="source")&&b.jsx(vx,{position:d,centerX:s,centerY:a,radius:e,onMouseDown:A,onMouseEnter:T,onMouseOut:E,type:"source"}),(t===!0||t==="target")&&b.jsx(vx,{position:f,centerX:l,centerY:c,radius:e,onMouseDown:S,onMouseEnter:T,onMouseOut:E,type:"target"})]})}function sL({id:t,edgesFocusable:e,edgesReconnectable:n,elementsSelectable:s,onClick:a,onDoubleClick:l,onContextMenu:c,onMouseEnter:d,onMouseMove:f,onMouseLeave:h,reconnectRadius:p,onReconnect:m,onReconnectStart:y,onReconnectEnd:_,rfId:x,edgeTypes:w,noPanClassName:A,onError:S,disableKeyboardA11y:T}){let E=Fe(be=>be.edgeLookup.get(t));const C=Fe(be=>be.defaultEdgeOptions);E=C?{...C,...E}:E;let O=E.type||"default",j=w?.[O]||px[O];j===void 0&&(S?.("011",ir.error011(O)),O="default",j=w?.default||px.default);const I=!!(E.focusable||e&&typeof E.focusable>"u"),D=typeof m<"u"&&(E.reconnectable||n&&typeof E.reconnectable>"u"),P=!!(E.selectable||s&&typeof E.selectable>"u"),G=k.useRef(null),[V,z]=k.useState(!1),[Y,H]=k.useState(!1),F=mt(),{zIndex:N,sourceX:B,sourceY:U,targetX:$,targetY:Q,sourcePosition:M,targetPosition:q}=Fe(k.useCallback(be=>{const _e=be.nodeLookup.get(E.source),Me=be.nodeLookup.get(E.target);if(!_e||!Me)return{zIndex:E.zIndex,...gx};const fe=YB({id:t,sourceNode:_e,targetNode:Me,sourceHandle:E.sourceHandle||null,targetHandle:E.targetHandle||null,connectionMode:be.connectionMode,onError:S});return{zIndex:PB({selected:E.selected,zIndex:E.zIndex,sourceNode:_e,targetNode:Me,elevateOnSelect:be.elevateEdgesOnSelect}),...fe||gx}},[E.source,E.target,E.sourceHandle,E.targetHandle,E.selected,E.zIndex]),vt),X=k.useMemo(()=>E.markerStart?`url('#${Zp(E.markerStart,x)}')`:void 0,[E.markerStart,x]),Z=k.useMemo(()=>E.markerEnd?`url('#${Zp(E.markerEnd,x)}')`:void 0,[E.markerEnd,x]);if(E.hidden||B===null||U===null||$===null||Q===null)return null;const J=be=>{const{addSelectedEdges:_e,unselectNodesAndEdges:Me,multiSelectionActive:fe}=F.getState();P&&(F.setState({nodesSelectionActive:!1}),E.selected&&fe?(Me({nodes:[],edges:[E]}),G.current?.blur()):_e([t])),a&&a(be,E)},ae=l?be=>{l(be,{...E})}:void 0,ce=c?be=>{c(be,{...E})}:void 0,de=d?be=>{d(be,{...E})}:void 0,ie=f?be=>{f(be,{...E})}:void 0,oe=h?be=>{h(be,{...E})}:void 0,pe=be=>{if(!T&&WE.includes(be.key)&&P){const{unselectNodesAndEdges:_e,addSelectedEdges:Me}=F.getState();be.key==="Escape"?(G.current?.blur(),_e({edges:[E]})):Me([t])}};return b.jsx("svg",{style:{zIndex:N},children:b.jsxs("g",{className:Ot(["react-flow__edge",`react-flow__edge-${O}`,E.className,A,{selected:E.selected,animated:E.animated,inactive:!P&&!a,updating:V,selectable:P}]),onClick:J,onDoubleClick:ae,onContextMenu:ce,onMouseEnter:de,onMouseMove:ie,onMouseLeave:oe,onKeyDown:I?pe:void 0,tabIndex:I?0:void 0,role:E.ariaRole??(I?"group":"img"),"aria-roledescription":"edge","data-id":t,"data-testid":`rf__edge-${t}`,"aria-label":E.ariaLabel===null?void 0:E.ariaLabel||`Edge from ${E.source} to ${E.target}`,"aria-describedby":I?`${RS}-${x}`:void 0,ref:G,...E.domAttributes,children:[!Y&&b.jsx(j,{id:t,source:E.source,target:E.target,type:E.type,selected:E.selected,animated:E.animated,selectable:P,deletable:E.deletable??!0,label:E.label,labelStyle:E.labelStyle,labelShowBg:E.labelShowBg,labelBgStyle:E.labelBgStyle,labelBgPadding:E.labelBgPadding,labelBgBorderRadius:E.labelBgBorderRadius,sourceX:B,sourceY:U,targetX:$,targetY:Q,sourcePosition:M,targetPosition:q,data:E.data,style:E.style,sourceHandleId:E.sourceHandle,targetHandleId:E.targetHandle,markerStart:X,markerEnd:Z,pathOptions:"pathOptions"in E?E.pathOptions:void 0,interactionWidth:E.interactionWidth}),D&&b.jsx(rL,{edge:E,isReconnectable:D,reconnectRadius:p,onReconnect:m,onReconnectStart:y,onReconnectEnd:_,sourceX:B,sourceY:U,targetX:$,targetY:Q,sourcePosition:M,targetPosition:q,setUpdateHover:z,setReconnecting:H})]})})}var iL=k.memo(sL);const aL=t=>({edgesFocusable:t.edgesFocusable,edgesReconnectable:t.edgesReconnectable,elementsSelectable:t.elementsSelectable,connectionMode:t.connectionMode,onError:t.onError});function e1({defaultMarkerColor:t,onlyRenderVisibleElements:e,rfId:n,edgeTypes:s,noPanClassName:a,onReconnect:l,onEdgeContextMenu:c,onEdgeMouseEnter:d,onEdgeMouseMove:f,onEdgeMouseLeave:h,onEdgeClick:p,reconnectRadius:m,onEdgeDoubleClick:y,onReconnectStart:_,onReconnectEnd:x,disableKeyboardA11y:w}){const{edgesFocusable:A,edgesReconnectable:S,elementsSelectable:T,onError:E}=Fe(aL,vt),C=Q3(e);return b.jsxs("div",{className:"react-flow__edges",children:[b.jsx(X3,{defaultColor:t,rfId:n}),C.map(O=>b.jsx(iL,{id:O,edgesFocusable:A,edgesReconnectable:S,elementsSelectable:T,noPanClassName:a,onReconnect:l,onContextMenu:c,onMouseEnter:d,onMouseMove:f,onMouseLeave:h,onClick:p,reconnectRadius:m,onDoubleClick:y,onReconnectStart:_,onReconnectEnd:x,rfId:n,onError:E,edgeTypes:s,disableKeyboardA11y:w},O))]})}e1.displayName="EdgeRenderer";const oL=k.memo(e1),lL=t=>`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`;function cL({children:t}){const e=Fe(lL);return b.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:e},children:t})}function uL(t){const e=Jr(),n=k.useRef(!1);k.useEffect(()=>{!n.current&&e.viewportInitialized&&t&&(setTimeout(()=>t(e),1),n.current=!0)},[t,e.viewportInitialized])}const dL=t=>t.panZoom?.syncViewport;function fL(t){const e=Fe(dL),n=mt();return k.useEffect(()=>{t&&(e?.(t),n.setState({transform:[t.x,t.y,t.zoom]}))},[t,e]),null}function hL(t){return t.connection.inProgress?{...t.connection,to:ac(t.connection.to,t.transform)}:{...t.connection}}function mL(t){return hL}function pL(t){const e=mL();return Fe(e,vt)}const gL=t=>({nodesConnectable:t.nodesConnectable,isValid:t.connection.isValid,inProgress:t.connection.inProgress,width:t.width,height:t.height});function yL({containerStyle:t,style:e,type:n,component:s}){const{nodesConnectable:a,width:l,height:c,isValid:d,inProgress:f}=Fe(gL,vt);return!(l&&a&&f)?null:b.jsx("svg",{style:t,width:l,height:c,className:"react-flow__connectionline react-flow__container",children:b.jsx("g",{className:Ot(["react-flow__connection",eS(d)]),children:b.jsx(t1,{style:e,type:n,CustomComponent:s,isValid:d})})})}const t1=({style:t,type:e=$s.Bezier,CustomComponent:n,isValid:s})=>{const{inProgress:a,from:l,fromNode:c,fromHandle:d,fromPosition:f,to:h,toNode:p,toHandle:m,toPosition:y,pointer:_}=pL();if(!a)return;if(n)return b.jsx(n,{connectionLineType:e,connectionLineStyle:t,fromNode:c,fromHandle:d,fromX:l.x,fromY:l.y,toX:h.x,toY:h.y,fromPosition:f,toPosition:y,connectionStatus:eS(s),toNode:p,toHandle:m,pointer:_});let x="";const w={sourceX:l.x,sourceY:l.y,sourcePosition:f,targetX:h.x,targetY:h.y,targetPosition:y};switch(e){case $s.Bezier:[x]=Fg(w);break;case $s.SimpleBezier:[x]=HS(w);break;case $s.Step:[x]=Jp({...w,borderRadius:0});break;case $s.SmoothStep:[x]=Jp(w);break;default:[x]=mS(w)}return b.jsx("path",{d:x,fill:"none",className:"react-flow__connection-path",style:t})};t1.displayName="ConnectionLine";const vL={};function _x(t=vL){k.useRef(t),mt(),k.useEffect(()=>{},[t])}function _L(){mt(),k.useRef(!1),k.useEffect(()=>{},[])}function n1({nodeTypes:t,edgeTypes:e,onInit:n,onNodeClick:s,onEdgeClick:a,onNodeDoubleClick:l,onEdgeDoubleClick:c,onNodeMouseEnter:d,onNodeMouseMove:f,onNodeMouseLeave:h,onNodeContextMenu:p,onSelectionContextMenu:m,onSelectionStart:y,onSelectionEnd:_,connectionLineType:x,connectionLineStyle:w,connectionLineComponent:A,connectionLineContainerStyle:S,selectionKeyCode:T,selectionOnDrag:E,selectionMode:C,multiSelectionKeyCode:O,panActivationKeyCode:j,zoomActivationKeyCode:I,deleteKeyCode:D,onlyRenderVisibleElements:P,elementsSelectable:G,defaultViewport:V,translateExtent:z,minZoom:Y,maxZoom:H,preventScrolling:F,defaultMarkerColor:N,zoomOnScroll:B,zoomOnPinch:U,panOnScroll:$,panOnScrollSpeed:Q,panOnScrollMode:M,zoomOnDoubleClick:q,panOnDrag:X,onPaneClick:Z,onPaneMouseEnter:J,onPaneMouseMove:ae,onPaneMouseLeave:ce,onPaneScroll:de,onPaneContextMenu:ie,paneClickDistance:oe,nodeClickDistance:pe,onEdgeContextMenu:be,onEdgeMouseEnter:_e,onEdgeMouseMove:Me,onEdgeMouseLeave:fe,reconnectRadius:ve,onReconnect:Ie,onReconnectStart:Xe,onReconnectEnd:Je,noDragClassName:pt,noWheelClassName:it,noPanClassName:mn,disableKeyboardA11y:Zt,nodeExtent:dt,rfId:pn,viewport:In,onViewportChange:nn}){return _x(t),_x(e),_L(),uL(n),fL(In),b.jsx(M3,{onPaneClick:Z,onPaneMouseEnter:J,onPaneMouseMove:ae,onPaneMouseLeave:ce,onPaneContextMenu:ie,onPaneScroll:de,paneClickDistance:oe,deleteKeyCode:D,selectionKeyCode:T,selectionOnDrag:E,selectionMode:C,onSelectionStart:y,onSelectionEnd:_,multiSelectionKeyCode:O,panActivationKeyCode:j,zoomActivationKeyCode:I,elementsSelectable:G,zoomOnScroll:B,zoomOnPinch:U,zoomOnDoubleClick:q,panOnScroll:$,panOnScrollSpeed:Q,panOnScrollMode:M,panOnDrag:X,defaultViewport:V,translateExtent:z,minZoom:Y,maxZoom:H,onSelectionContextMenu:m,preventScrolling:F,noDragClassName:pt,noWheelClassName:it,noPanClassName:mn,disableKeyboardA11y:Zt,onViewportChange:nn,isControlledViewport:!!In,children:b.jsxs(cL,{children:[b.jsx(oL,{edgeTypes:e,onEdgeClick:a,onEdgeDoubleClick:c,onReconnect:Ie,onReconnectStart:Xe,onReconnectEnd:Je,onlyRenderVisibleElements:P,onEdgeContextMenu:be,onEdgeMouseEnter:_e,onEdgeMouseMove:Me,onEdgeMouseLeave:fe,reconnectRadius:ve,defaultMarkerColor:N,noPanClassName:mn,disableKeyboardA11y:Zt,rfId:pn}),b.jsx(yL,{style:w,type:x,component:A,containerStyle:S}),b.jsx("div",{className:"react-flow__edgelabel-renderer"}),b.jsx(q3,{nodeTypes:t,onNodeClick:s,onNodeDoubleClick:l,onNodeMouseEnter:d,onNodeMouseMove:f,onNodeMouseLeave:h,onNodeContextMenu:p,nodeClickDistance:pe,onlyRenderVisibleElements:P,noPanClassName:mn,noDragClassName:pt,disableKeyboardA11y:Zt,nodeExtent:dt,rfId:pn}),b.jsx("div",{className:"react-flow__viewport-portal"})]})})}n1.displayName="GraphView";const bL=k.memo(n1),bx=({nodes:t,edges:e,defaultNodes:n,defaultEdges:s,width:a,height:l,fitView:c,fitViewOptions:d,minZoom:f=.5,maxZoom:h=2,nodeOrigin:p,nodeExtent:m}={})=>{const y=new Map,_=new Map,x=new Map,w=new Map,A=s??e??[],S=n??t??[],T=p??[0,0],E=m??Pl;yS(x,w,A);const C=eg(S,y,_,{nodeOrigin:T,nodeExtent:E,elevateNodesOnSelect:!1});let O=[0,0,1];if(c&&a&&l){const j=sc(y,{filter:G=>!!((G.width||G.initialWidth)&&(G.height||G.initialHeight))}),{x:I,y:D,zoom:P}=Qg(j,a,l,f,h,d?.padding??.1);O=[I,D,P]}return{rfId:"1",width:a??0,height:l??0,transform:O,nodes:S,nodesInitialized:C,nodeLookup:y,parentLookup:_,edges:A,edgeLookup:w,connectionLookup:x,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:s!==void 0,panZoom:null,minZoom:f,maxZoom:h,translateExtent:Pl,nodeExtent:E,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Qa.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:T,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:c??!1,fitViewOptions:d,fitViewResolver:null,connection:{...ZE},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:DB,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:JE}},wL=({nodes:t,edges:e,defaultNodes:n,defaultEdges:s,width:a,height:l,fitView:c,fitViewOptions:d,minZoom:f,maxZoom:h,nodeOrigin:p,nodeExtent:m})=>$U((y,_)=>{async function x(){const{nodeLookup:w,panZoom:A,fitViewOptions:S,fitViewResolver:T,width:E,height:C,minZoom:O,maxZoom:j}=_();A&&(await kB({nodes:w,width:E,height:C,panZoom:A,minZoom:O,maxZoom:j},S),T?.resolve(!0),y({fitViewResolver:null}))}return{...bx({nodes:t,edges:e,width:a,height:l,fitView:c,fitViewOptions:d,minZoom:f,maxZoom:h,nodeOrigin:p,nodeExtent:m,defaultNodes:n,defaultEdges:s}),setNodes:w=>{const{nodeLookup:A,parentLookup:S,nodeOrigin:T,elevateNodesOnSelect:E,fitViewQueued:C}=_(),O=eg(w,A,S,{nodeOrigin:T,nodeExtent:m,elevateNodesOnSelect:E,checkEquality:!0});C&&O?(x(),y({nodes:w,nodesInitialized:O,fitViewQueued:!1,fitViewOptions:void 0})):y({nodes:w,nodesInitialized:O})},setEdges:w=>{const{connectionLookup:A,edgeLookup:S}=_();yS(A,S,w),y({edges:w})},setDefaultNodesAndEdges:(w,A)=>{if(w){const{setNodes:S}=_();S(w),y({hasDefaultNodes:!0})}if(A){const{setEdges:S}=_();S(A),y({hasDefaultEdges:!0})}},updateNodeInternals:w=>{const{triggerNodeChanges:A,nodeLookup:S,parentLookup:T,domNode:E,nodeOrigin:C,nodeExtent:O,debug:j,fitViewQueued:I}=_(),{changes:D,updatedInternals:P}=nU(w,S,T,E,C,O);P&&(JB(S,T,{nodeOrigin:C,nodeExtent:O}),I?(x(),y({fitViewQueued:!1,fitViewOptions:void 0})):y({}),D?.length>0&&(j&&console.log("React Flow: trigger node changes",D),A?.(D)))},updateNodePositions:(w,A=!1)=>{const S=[],T=[],{nodeLookup:E,triggerNodeChanges:C}=_();for(const[O,j]of w){const I=E.get(O),D=!!(I?.expandParent&&I?.parentId&&j?.position),P={id:O,type:"position",position:D?{x:Math.max(0,j.position.x),y:Math.max(0,j.position.y)}:j.position,dragging:A};D&&I.parentId&&S.push({id:O,parentId:I.parentId,rect:{...j.internals.positionAbsolute,width:j.measured.width??0,height:j.measured.height??0}}),T.push(P)}if(S.length>0){const{parentLookup:O,nodeOrigin:j}=_(),I=Kg(S,E,O,j);T.push(...I)}C(T)},triggerNodeChanges:w=>{const{onNodesChange:A,setNodes:S,nodes:T,hasDefaultNodes:E,debug:C}=_();if(w?.length){if(E){const O=IS(w,T);S(O)}C&&console.log("React Flow: trigger node changes",w),A?.(w)}},triggerEdgeChanges:w=>{const{onEdgesChange:A,setEdges:S,edges:T,hasDefaultEdges:E,debug:C}=_();if(w?.length){if(E){const O=kS(w,T);S(O)}C&&console.log("React Flow: trigger edge changes",w),A?.(w)}},addSelectedNodes:w=>{const{multiSelectionActive:A,edgeLookup:S,nodeLookup:T,triggerNodeChanges:E,triggerEdgeChanges:C}=_();if(A){const O=w.map(j=>hi(j,!0));E(O);return}E(Ba(T,new Set([...w]),!0)),C(Ba(S))},addSelectedEdges:w=>{const{multiSelectionActive:A,edgeLookup:S,nodeLookup:T,triggerNodeChanges:E,triggerEdgeChanges:C}=_();if(A){const O=w.map(j=>hi(j,!0));C(O);return}C(Ba(S,new Set([...w]))),E(Ba(T,new Set,!0))},unselectNodesAndEdges:({nodes:w,edges:A}={})=>{const{edges:S,nodes:T,nodeLookup:E,triggerNodeChanges:C,triggerEdgeChanges:O}=_(),j=w||T,I=A||S,D=j.map(G=>{const V=E.get(G.id);return V&&(V.selected=!1),hi(G.id,!1)}),P=I.map(G=>hi(G.id,!1));C(D),O(P)},setMinZoom:w=>{const{panZoom:A,maxZoom:S}=_();A?.setScaleExtent([w,S]),y({minZoom:w})},setMaxZoom:w=>{const{panZoom:A,minZoom:S}=_();A?.setScaleExtent([S,w]),y({maxZoom:w})},setTranslateExtent:w=>{_().panZoom?.setTranslateExtent(w),y({translateExtent:w})},resetSelectedElements:()=>{const{edges:w,nodes:A,triggerNodeChanges:S,triggerEdgeChanges:T,elementsSelectable:E}=_();if(!E)return;const C=A.reduce((j,I)=>I.selected?[...j,hi(I.id,!1)]:j,[]),O=w.reduce((j,I)=>I.selected?[...j,hi(I.id,!1)]:j,[]);S(C),T(O)},setNodeExtent:w=>{const{nodes:A,nodeLookup:S,parentLookup:T,nodeOrigin:E,elevateNodesOnSelect:C,nodeExtent:O}=_();w[0][0]===O[0][0]&&w[0][1]===O[0][1]&&w[1][0]===O[1][0]&&w[1][1]===O[1][1]||(eg(A,S,T,{nodeOrigin:E,nodeExtent:w,elevateNodesOnSelect:C,checkEquality:!1}),y({nodeExtent:w}))},panBy:w=>{const{transform:A,width:S,height:T,panZoom:E,translateExtent:C}=_();return rU({delta:w,panZoom:E,transform:A,translateExtent:C,width:S,height:T})},setCenter:async(w,A,S)=>{const{width:T,height:E,maxZoom:C,panZoom:O}=_();if(!O)return Promise.resolve(!1);const j=typeof S?.zoom<"u"?S.zoom:C;return await O.setViewport({x:T/2-w*j,y:E/2-A*j,zoom:j},{duration:S?.duration,ease:S?.ease,interpolate:S?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{y({connection:{...ZE}})},updateConnection:w=>{y({connection:w})},reset:()=>y({...bx()})}},Object.is);function xL({initialNodes:t,initialEdges:e,defaultNodes:n,defaultEdges:s,initialWidth:a,initialHeight:l,initialMinZoom:c,initialMaxZoom:d,initialFitViewOptions:f,fitView:h,nodeOrigin:p,nodeExtent:m,children:y}){const[_]=k.useState(()=>wL({nodes:t,edges:e,defaultNodes:n,defaultEdges:s,width:a,height:l,fitView:h,minZoom:c,maxZoom:d,fitViewOptions:f,nodeOrigin:p,nodeExtent:m}));return b.jsx(zU,{value:_,children:b.jsx(c3,{children:y})})}function AL({children:t,nodes:e,edges:n,defaultNodes:s,defaultEdges:a,width:l,height:c,fitView:d,fitViewOptions:f,minZoom:h,maxZoom:p,nodeOrigin:m,nodeExtent:y}){return k.useContext(mf)?b.jsx(b.Fragment,{children:t}):b.jsx(xL,{initialNodes:e,initialEdges:n,defaultNodes:s,defaultEdges:a,initialWidth:l,initialHeight:c,fitView:d,initialFitViewOptions:f,initialMinZoom:h,initialMaxZoom:p,nodeOrigin:m,nodeExtent:y,children:t})}const EL={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function SL({nodes:t,edges:e,defaultNodes:n,defaultEdges:s,className:a,nodeTypes:l,edgeTypes:c,onNodeClick:d,onEdgeClick:f,onInit:h,onMove:p,onMoveStart:m,onMoveEnd:y,onConnect:_,onConnectStart:x,onConnectEnd:w,onClickConnectStart:A,onClickConnectEnd:S,onNodeMouseEnter:T,onNodeMouseMove:E,onNodeMouseLeave:C,onNodeContextMenu:O,onNodeDoubleClick:j,onNodeDragStart:I,onNodeDrag:D,onNodeDragStop:P,onNodesDelete:G,onEdgesDelete:V,onDelete:z,onSelectionChange:Y,onSelectionDragStart:H,onSelectionDrag:F,onSelectionDragStop:N,onSelectionContextMenu:B,onSelectionStart:U,onSelectionEnd:$,onBeforeDelete:Q,connectionMode:M,connectionLineType:q=$s.Bezier,connectionLineStyle:X,connectionLineComponent:Z,connectionLineContainerStyle:J,deleteKeyCode:ae="Backspace",selectionKeyCode:ce="Shift",selectionOnDrag:de=!1,selectionMode:ie=Hl.Full,panActivationKeyCode:oe="Space",multiSelectionKeyCode:pe=Ql()?"Meta":"Control",zoomActivationKeyCode:be=Ql()?"Meta":"Control",snapToGrid:_e,snapGrid:Me,onlyRenderVisibleElements:fe=!1,selectNodesOnDrag:ve,nodesDraggable:Ie,autoPanOnNodeFocus:Xe,nodesConnectable:Je,nodesFocusable:pt,nodeOrigin:it=OS,edgesFocusable:mn,edgesReconnectable:Zt,elementsSelectable:dt=!0,defaultViewport:pn=ZU,minZoom:In=.5,maxZoom:nn=2,translateExtent:gn=Pl,preventScrolling:wr=!0,nodeExtent:ts,defaultMarkerColor:to="#b1b1b7",zoomOnScroll:no=!0,zoomOnPinch:Qn=!0,panOnScroll:$t=!1,panOnScrollSpeed:ge=.5,panOnScrollMode:Ee=Si.Free,zoomOnDoubleClick:ke=!0,panOnDrag:Ye=!0,onPaneClick:lt,onPaneMouseEnter:ft,onPaneMouseMove:ns,onPaneMouseLeave:ki,onPaneScroll:xr,onPaneContextMenu:Mi,paneClickDistance:Qs=1,nodeClickDistance:Nf=0,children:uc,onReconnect:ro,onReconnectStart:Vs,onReconnectEnd:Rf,onEdgeContextMenu:dc,onEdgeDoubleClick:fc,onEdgeMouseEnter:hc,onEdgeMouseMove:so,onEdgeMouseLeave:io,reconnectRadius:mc=10,onNodesChange:pc,onEdgesChange:or,noDragClassName:jt="nodrag",noWheelClassName:Yt="nowheel",noPanClassName:Ar="nopan",fitView:Di,fitViewOptions:gc,connectOnClick:Of,attributionPosition:yc,proOptions:Fs,defaultEdgeOptions:ao,elevateNodesOnSelect:rs,elevateEdgesOnSelect:ss,disableKeyboardA11y:is=!1,autoPanOnConnect:as,autoPanOnNodeDrag:At,autoPanSpeed:vc,connectionRadius:_c,isValidConnection:Er,onError:os,style:jf,id:oo,nodeDragThreshold:bc,connectionDragThreshold:If,viewport:Bi,onViewportChange:Ui,width:Vn,height:rn,colorMode:wc="light",debug:kf,onScroll:Li,ariaLabelConfig:xc,...$i},Mf){const Xt=oo||"1",lo=r3(wc),Ac=k.useCallback(zi=>{zi.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Li?.(zi)},[Li]);return b.jsx("div",{"data-testid":"rf__wrapper",...$i,onScroll:Ac,style:{...jf,...EL},ref:Mf,className:Ot(["react-flow",a,lo]),id:oo,role:"application",children:b.jsxs(AL,{nodes:t,edges:e,width:Vn,height:rn,fitView:Di,fitViewOptions:gc,minZoom:In,maxZoom:nn,nodeOrigin:it,nodeExtent:ts,children:[b.jsx(bL,{onInit:h,onNodeClick:d,onEdgeClick:f,onNodeMouseEnter:T,onNodeMouseMove:E,onNodeMouseLeave:C,onNodeContextMenu:O,onNodeDoubleClick:j,nodeTypes:l,edgeTypes:c,connectionLineType:q,connectionLineStyle:X,connectionLineComponent:Z,connectionLineContainerStyle:J,selectionKeyCode:ce,selectionOnDrag:de,selectionMode:ie,deleteKeyCode:ae,multiSelectionKeyCode:pe,panActivationKeyCode:oe,zoomActivationKeyCode:be,onlyRenderVisibleElements:fe,defaultViewport:pn,translateExtent:gn,minZoom:In,maxZoom:nn,preventScrolling:wr,zoomOnScroll:no,zoomOnPinch:Qn,zoomOnDoubleClick:ke,panOnScroll:$t,panOnScrollSpeed:ge,panOnScrollMode:Ee,panOnDrag:Ye,onPaneClick:lt,onPaneMouseEnter:ft,onPaneMouseMove:ns,onPaneMouseLeave:ki,onPaneScroll:xr,onPaneContextMenu:Mi,paneClickDistance:Qs,nodeClickDistance:Nf,onSelectionContextMenu:B,onSelectionStart:U,onSelectionEnd:$,onReconnect:ro,onReconnectStart:Vs,onReconnectEnd:Rf,onEdgeContextMenu:dc,onEdgeDoubleClick:fc,onEdgeMouseEnter:hc,onEdgeMouseMove:so,onEdgeMouseLeave:io,reconnectRadius:mc,defaultMarkerColor:to,noDragClassName:jt,noWheelClassName:Yt,noPanClassName:Ar,rfId:Xt,disableKeyboardA11y:is,nodeExtent:ts,viewport:Bi,onViewportChange:Ui}),b.jsx(n3,{nodes:t,edges:e,defaultNodes:n,defaultEdges:s,onConnect:_,onConnectStart:x,onConnectEnd:w,onClickConnectStart:A,onClickConnectEnd:S,nodesDraggable:Ie,autoPanOnNodeFocus:Xe,nodesConnectable:Je,nodesFocusable:pt,edgesFocusable:mn,edgesReconnectable:Zt,elementsSelectable:dt,elevateNodesOnSelect:rs,elevateEdgesOnSelect:ss,minZoom:In,maxZoom:nn,nodeExtent:ts,onNodesChange:pc,onEdgesChange:or,snapToGrid:_e,snapGrid:Me,connectionMode:M,translateExtent:gn,connectOnClick:Of,defaultEdgeOptions:ao,fitView:Di,fitViewOptions:gc,onNodesDelete:G,onEdgesDelete:V,onDelete:z,onNodeDragStart:I,onNodeDrag:D,onNodeDragStop:P,onSelectionDrag:F,onSelectionDragStart:H,onSelectionDragStop:N,onMove:p,onMoveStart:m,onMoveEnd:y,noPanClassName:Ar,nodeOrigin:it,rfId:Xt,autoPanOnConnect:as,autoPanOnNodeDrag:At,autoPanSpeed:vc,onError:os,connectionRadius:_c,isValidConnection:Er,selectNodesOnDrag:ve,nodeDragThreshold:bc,connectionDragThreshold:If,onBeforeDelete:Q,debug:kf,ariaLabelConfig:xc}),b.jsx(JU,{onSelectionChange:Y}),uc,b.jsx(GU,{proOptions:Fs,position:yc}),b.jsx(FU,{rfId:Xt,disableKeyboardA11y:is})]})})}var CL=MS(SL);const TL=ir.error014();function Zg({id:t,handleType:e,handleId:n,onConnect:s,onDisconnect:a}={}){const l=Jg(),c=t??l;if(!c)throw new Error(TL);const d=k.useRef(null),f=Fe(h=>h.connectionLookup.get(`${c}${e?n?`-${e}-${n}`:`-${e}`:""}`),NB);return k.useEffect(()=>{if(d.current&&d.current!==f){const h=f??new Map;Iw(d.current,h,a),Iw(h,d.current,s)}d.current=f??new Map},[f,s,a]),k.useMemo(()=>Array.from(f?.values()??[]),[f])}function r1(t){return Fe(k.useCallback(n=>{const s=[],a=Array.isArray(t),l=a?t:[t];for(const c of l){const d=n.nodeLookup.get(c);d&&s.push({id:d.id,type:d.type,data:d.data})}return a?s:s[0]??null},[t]),sU)}function NL({dimensions:t,lineWidth:e,variant:n,className:s}){return b.jsx("path",{strokeWidth:e,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`,className:Ot(["react-flow__background-pattern",n,s])})}function RL({radius:t,className:e}){return b.jsx("circle",{cx:t,cy:t,r:t,className:Ot(["react-flow__background-pattern","dots",e])})}var zs;(function(t){t.Lines="lines",t.Dots="dots",t.Cross="cross"})(zs||(zs={}));const OL={[zs.Dots]:1,[zs.Lines]:1,[zs.Cross]:6},jL=t=>({transform:t.transform,patternId:`pattern-${t.rfId}`});function s1({id:t,variant:e=zs.Dots,gap:n=20,size:s,lineWidth:a=1,offset:l=0,color:c,bgColor:d,style:f,className:h,patternClassName:p}){const m=k.useRef(null),{transform:y,patternId:_}=Fe(jL,vt),x=s||OL[e],w=e===zs.Dots,A=e===zs.Cross,S=Array.isArray(n)?n:[n,n],T=[S[0]*y[2]||1,S[1]*y[2]||1],E=x*y[2],C=Array.isArray(l)?l:[l,l],O=A?[E,E]:T,j=[C[0]*y[2]||1+O[0]/2,C[1]*y[2]||1+O[1]/2],I=`${_}${t||""}`;return b.jsxs("svg",{className:Ot(["react-flow__background",h]),style:{...f,...gf,"--xy-background-color-props":d,"--xy-background-pattern-color-props":c},ref:m,"data-testid":"rf__background",children:[b.jsx("pattern",{id:I,x:y[0]%T[0],y:y[1]%T[1],width:T[0],height:T[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${j[0]},-${j[1]})`,children:w?b.jsx(RL,{radius:E/2,className:p}):b.jsx(NL,{dimensions:O,lineWidth:a,variant:e,className:p})}),b.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${I})`})]})}s1.displayName="Background";const IL=k.memo(s1);function kL(){return b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:b.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function ML(){return b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:b.jsx("path",{d:"M0 0h32v4.2H0z"})})}function DL(){return b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:b.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function BL(){return b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:b.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function UL(){return b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:b.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function ed({children:t,className:e,...n}){return b.jsx("button",{type:"button",className:Ot(["react-flow__controls-button",e]),...n,children:t})}const LL=t=>({isInteractive:t.nodesDraggable||t.nodesConnectable||t.elementsSelectable,minZoomReached:t.transform[2]<=t.minZoom,maxZoomReached:t.transform[2]>=t.maxZoom,ariaLabelConfig:t.ariaLabelConfig});function i1({style:t,showZoom:e=!0,showFitView:n=!0,showInteractive:s=!0,fitViewOptions:a,onZoomIn:l,onZoomOut:c,onFitView:d,onInteractiveChange:f,className:h,children:p,position:m="bottom-left",orientation:y="vertical","aria-label":_}){const x=mt(),{isInteractive:w,minZoomReached:A,maxZoomReached:S,ariaLabelConfig:T}=Fe(LL,vt),{zoomIn:E,zoomOut:C,fitView:O}=Jr(),j=()=>{E(),l?.()},I=()=>{C(),c?.()},D=()=>{O(a),d?.()},P=()=>{x.setState({nodesDraggable:!w,nodesConnectable:!w,elementsSelectable:!w}),f?.(!w)},G=y==="horizontal"?"horizontal":"vertical";return b.jsxs(pf,{className:Ot(["react-flow__controls",G,h]),position:m,style:t,"data-testid":"rf__controls","aria-label":_??T["controls.ariaLabel"],children:[e&&b.jsxs(b.Fragment,{children:[b.jsx(ed,{onClick:j,className:"react-flow__controls-zoomin",title:T["controls.zoomIn.ariaLabel"],"aria-label":T["controls.zoomIn.ariaLabel"],disabled:S,children:b.jsx(kL,{})}),b.jsx(ed,{onClick:I,className:"react-flow__controls-zoomout",title:T["controls.zoomOut.ariaLabel"],"aria-label":T["controls.zoomOut.ariaLabel"],disabled:A,children:b.jsx(ML,{})})]}),n&&b.jsx(ed,{className:"react-flow__controls-fitview",onClick:D,title:T["controls.fitView.ariaLabel"],"aria-label":T["controls.fitView.ariaLabel"],children:b.jsx(DL,{})}),s&&b.jsx(ed,{className:"react-flow__controls-interactive",onClick:P,title:T["controls.interactive.ariaLabel"],"aria-label":T["controls.interactive.ariaLabel"],children:w?b.jsx(UL,{}):b.jsx(BL,{})}),p]})}i1.displayName="Controls";const $L=k.memo(i1);function zL({id:t,x:e,y:n,width:s,height:a,style:l,color:c,strokeColor:d,strokeWidth:f,className:h,borderRadius:p,shapeRendering:m,selected:y,onClick:_}){const{background:x,backgroundColor:w}=l||{},A=c||x||w;return b.jsx("rect",{className:Ot(["react-flow__minimap-node",{selected:y},h]),x:e,y:n,rx:p,ry:p,width:s,height:a,style:{fill:A,stroke:d,strokeWidth:f},shapeRendering:m,onClick:_?S=>_(S,t):void 0})}const PL=k.memo(zL),HL=t=>t.nodes.map(e=>e.id),gp=t=>t instanceof Function?t:()=>t;function qL({nodeStrokeColor:t,nodeColor:e,nodeClassName:n="",nodeBorderRadius:s=5,nodeStrokeWidth:a,nodeComponent:l=PL,onClick:c}){const d=Fe(HL,vt),f=gp(e),h=gp(t),p=gp(n),m=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return b.jsx(b.Fragment,{children:d.map(y=>b.jsx(VL,{id:y,nodeColorFunc:f,nodeStrokeColorFunc:h,nodeClassNameFunc:p,nodeBorderRadius:s,nodeStrokeWidth:a,NodeComponent:l,onClick:c,shapeRendering:m},y))})}function QL({id:t,nodeColorFunc:e,nodeStrokeColorFunc:n,nodeClassNameFunc:s,nodeBorderRadius:a,nodeStrokeWidth:l,shapeRendering:c,NodeComponent:d,onClick:f}){const{node:h,x:p,y:m,width:y,height:_}=Fe(x=>{const{internals:w}=x.nodeLookup.get(t),A=w.userNode,{x:S,y:T}=w.positionAbsolute,{width:E,height:C}=es(A);return{node:A,x:S,y:T,width:E,height:C}},vt);return!h||h.hidden||!aS(h)?null:b.jsx(d,{x:p,y:m,width:y,height:_,style:h.style,selected:!!h.selected,className:s(h),color:e(h),borderRadius:a,strokeColor:n(h),strokeWidth:l,shapeRendering:c,onClick:f,id:h.id})}const VL=k.memo(QL);var FL=k.memo(qL);const GL=200,YL=150,XL=t=>!t.hidden,KL=t=>{const e={x:-t.transform[0]/t.transform[2],y:-t.transform[1]/t.transform[2],width:t.width/t.transform[2],height:t.height/t.transform[2]};return{viewBB:e,boundingRect:t.nodeLookup.size>0?iS(sc(t.nodeLookup,{filter:XL}),e):e,rfId:t.rfId,panZoom:t.panZoom,translateExtent:t.translateExtent,flowWidth:t.width,flowHeight:t.height,ariaLabelConfig:t.ariaLabelConfig}},WL="react-flow__minimap-desc";function a1({style:t,className:e,nodeStrokeColor:n,nodeColor:s,nodeClassName:a="",nodeBorderRadius:l=5,nodeStrokeWidth:c,nodeComponent:d,bgColor:f,maskColor:h,maskStrokeColor:p,maskStrokeWidth:m,position:y="bottom-right",onClick:_,onNodeClick:x,pannable:w=!1,zoomable:A=!1,ariaLabel:S,inversePan:T,zoomStep:E=1,offsetScale:C=5}){const O=mt(),j=k.useRef(null),{boundingRect:I,viewBB:D,rfId:P,panZoom:G,translateExtent:V,flowWidth:z,flowHeight:Y,ariaLabelConfig:H}=Fe(KL,vt),F=t?.width??GL,N=t?.height??YL,B=I.width/F,U=I.height/N,$=Math.max(B,U),Q=$*F,M=$*N,q=C*$,X=I.x-(Q-I.width)/2-q,Z=I.y-(M-I.height)/2-q,J=Q+q*2,ae=M+q*2,ce=`${WL}-${P}`,de=k.useRef(0),ie=k.useRef();de.current=$,k.useEffect(()=>{if(j.current&&G)return ie.current=hU({domNode:j.current,panZoom:G,getTransform:()=>O.getState().transform,getViewScale:()=>de.current}),()=>{ie.current?.destroy()}},[G]),k.useEffect(()=>{ie.current?.update({translateExtent:V,width:z,height:Y,inversePan:T,pannable:w,zoomStep:E,zoomable:A})},[w,A,T,E,V,z,Y]);const oe=_?_e=>{const[Me,fe]=ie.current?.pointer(_e)||[0,0];_(_e,{x:Me,y:fe})}:void 0,pe=x?k.useCallback((_e,Me)=>{const fe=O.getState().nodeLookup.get(Me).internals.userNode;x(_e,fe)},[]):void 0,be=S??H["minimap.ariaLabel"];return b.jsx(pf,{position:y,style:{...t,"--xy-minimap-background-color-props":typeof f=="string"?f:void 0,"--xy-minimap-mask-background-color-props":typeof h=="string"?h:void 0,"--xy-minimap-mask-stroke-color-props":typeof p=="string"?p:void 0,"--xy-minimap-mask-stroke-width-props":typeof m=="number"?m*$:void 0,"--xy-minimap-node-background-color-props":typeof s=="string"?s:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof c=="number"?c:void 0},className:Ot(["react-flow__minimap",e]),"data-testid":"rf__minimap",children:b.jsxs("svg",{width:F,height:N,viewBox:`${X} ${Z} ${J} ${ae}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":ce,ref:j,onClick:oe,children:[be&&b.jsx("title",{id:ce,children:be}),b.jsx(FL,{onClick:pe,nodeColor:s,nodeStrokeColor:n,nodeBorderRadius:l,nodeClassName:a,nodeStrokeWidth:c,nodeComponent:d}),b.jsx("path",{className:"react-flow__minimap-mask",d:`M${X-q},${Z-q}h${J+q*2}v${ae+q*2}h${-J-q*2}z
        M${D.x},${D.y}h${D.width}v${D.height}h${-D.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}a1.displayName="MiniMap";k.memo(a1);const JL=t=>e=>t?`${Math.max(1/e.transform[2],1)}`:void 0,ZL={[Ya.Line]:"right",[Ya.Handle]:"bottom-right"};function e$({nodeId:t,position:e,variant:n=Ya.Handle,className:s,style:a=void 0,children:l,color:c,minWidth:d=10,minHeight:f=10,maxWidth:h=Number.MAX_VALUE,maxHeight:p=Number.MAX_VALUE,keepAspectRatio:m=!1,resizeDirection:y,autoScale:_=!0,shouldResize:x,onResizeStart:w,onResize:A,onResizeEnd:S}){const T=Jg(),E=typeof t=="string"?t:T,C=mt(),O=k.useRef(null),j=n===Ya.Handle,I=Fe(k.useCallback(JL(j&&_),[j,_]),vt),D=k.useRef(null),P=e??ZL[n];k.useEffect(()=>{if(!(!O.current||!E))return D.current||(D.current=TU({domNode:O.current,nodeId:E,getStoreItems:()=>{const{nodeLookup:V,transform:z,snapGrid:Y,snapToGrid:H,nodeOrigin:F,domNode:N}=C.getState();return{nodeLookup:V,transform:z,snapGrid:Y,snapToGrid:H,nodeOrigin:F,paneDomNode:N}},onChange:(V,z)=>{const{triggerNodeChanges:Y,nodeLookup:H,parentLookup:F,nodeOrigin:N}=C.getState(),B=[],U={x:V.x,y:V.y},$=H.get(E);if($&&$.expandParent&&$.parentId){const Q=$.origin??N,M=V.width??$.measured.width??0,q=V.height??$.measured.height??0,X={id:$.id,parentId:$.parentId,rect:{width:M,height:q,...oS({x:V.x??$.position.x,y:V.y??$.position.y},{width:M,height:q},$.parentId,H,Q)}},Z=Kg([X],H,F,N);B.push(...Z),U.x=V.x?Math.max(Q[0]*M,V.x):void 0,U.y=V.y?Math.max(Q[1]*q,V.y):void 0}if(U.x!==void 0&&U.y!==void 0){const Q={id:E,type:"position",position:{...U}};B.push(Q)}if(V.width!==void 0&&V.height!==void 0){const M={id:E,type:"dimensions",resizing:!0,setAttributes:y?y==="horizontal"?"width":"height":!0,dimensions:{width:V.width,height:V.height}};B.push(M)}for(const Q of z){const M={...Q,type:"position"};B.push(M)}Y(B)},onEnd:({width:V,height:z})=>{const Y={id:E,type:"dimensions",resizing:!1,dimensions:{width:V,height:z}};C.getState().triggerNodeChanges([Y])}})),D.current.update({controlPosition:P,boundaries:{minWidth:d,minHeight:f,maxWidth:h,maxHeight:p},keepAspectRatio:m,resizeDirection:y,onResizeStart:w,onResize:A,onResizeEnd:S,shouldResize:x}),()=>{D.current?.destroy()}},[P,d,f,h,p,m,w,A,S,x]);const G=P.split("-");return b.jsx("div",{className:Ot(["react-flow__resize-control","nodrag",...G,n,s]),ref:O,style:{...a,scale:I,...c&&{[j?"backgroundColor":"borderColor"]:c}},children:l})}k.memo(e$);const o1=t=>b.jsx(Lt,{...t,type:"target",position:we.Left,id:"exec-in",acceptHandle:"exec-out",style:{...t.style,width:8,height:8,borderRadius:"2px",backgroundColor:"#ff0072"}}),l1=t=>b.jsx(Lt,{...t,type:"source",position:we.Right,id:"exec-out",acceptHandle:"exec-in",acceptConnection:({connection:e})=>e.targetHandle==="exec-in",style:{width:8,height:8,borderRadius:"2px",backgroundColor:"#ff0072"}}),t$=({data:t})=>{const{updateNodeData:e}=Jr(),{shot:n={}}=t,{description:s="",prompt:a="",embodys:l=[]}=n;k.useEffect(()=>{},[]);const c=d=>[];return b.jsxs("div",{className:"common-node-area",children:[b.jsx("h4",{className:"shot-node-input-title common-node-title",children:""}),b.jsx("div",{className:"shot-node-input-handle",children:b.jsx(l1,{id:"exec-out"})}),b.jsxs("div",{className:"shot-node-input-handle",children:[b.jsx(Lt,{type:"source",position:we.Right,id:"description"}),b.jsx("span",{className:"handle-label",children:""})]}),b.jsxs("div",{className:"shot-node-input-handle",children:[b.jsx(Lt,{type:"source",position:we.Right,id:"prompt"}),b.jsx("span",{className:"handle-label",children:""})]}),l.map((d,f)=>{const h=c();return b.jsxs("div",{className:"shot-node-input-handle",children:[b.jsx(Lt,{type:"source",position:we.Right,id:`embody-${d}`}),b.jsx("span",{className:"handle-label",children:h.name})]},`embody-${d}`)})]})},n$=t=>(Zg({handleType:t.type}),b.jsx(Lt,{...t}));function r$({data:t}){return b.jsxs("div",{className:"common-node-area",children:[b.jsx("h4",{className:"common-node-title console-node-title",children:""}),b.jsxs("div",{className:"common-exec-handle-area",children:[b.jsx(o1,{id:"exec-in"}),b.jsx(l1,{id:"exec-out"})]}),b.jsxs("div",{className:"shot-node-input-handle",children:[b.jsx(n$,{type:"target",position:we.Left,id:"input"}),b.jsx("span",{className:"handle-label",children:""})]})]})}const s$=({data:t})=>{const{output:e={}}=t;return b.jsxs("div",{className:"common-node-area",children:[b.jsx("h4",{className:"shot-node-output-title common-node-title",children:""}),b.jsx("div",{className:"shot-node-output-handle",children:b.jsx(o1,{id:"exec-in"})}),b.jsxs("div",{className:"shot-node-output-handle",children:[b.jsx(Lt,{type:"target",position:we.Left,id:"image"}),b.jsx("span",{className:"handle-label",children:""})]}),b.jsxs("div",{className:"shot-node-output-handle",children:[b.jsx(Lt,{type:"target",position:we.Left,id:"video"}),b.jsx("span",{className:"handle-label",children:""})]}),b.jsxs("div",{className:"shot-node-output-handle",children:[b.jsx(Lt,{type:"target",position:we.Left,id:"audio"}),b.jsx("span",{className:"handle-label",children:""})]})]})};function td(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var yp={exports:{}};var wx;function i$(){return wx||(wx=1,(function(t,e){(function(n){t.exports=n()})(function(){return(function(){function n(s,a,l){function c(h,p){if(!a[h]){if(!s[h]){var m=typeof td=="function"&&td;if(!p&&m)return m(h,!0);if(d)return d(h,!0);var y=new Error("Cannot find module '"+h+"'");throw y.code="MODULE_NOT_FOUND",y}var _=a[h]={exports:{}};s[h][0].call(_.exports,function(x){var w=s[h][1][x];return c(w||x)},_,_.exports,n,s,a,l)}return a[h].exports}for(var d=typeof td=="function"&&td,f=0;f<l.length;f++)c(l[f]);return c}return n})()({1:[function(n,s,a){var l=n("multimath"),c=n("./mm_unsharp_mask"),d=n("./mm_resize");function f(h){var p=h||[],m={js:p.indexOf("js")>=0,wasm:p.indexOf("wasm")>=0};l.call(this,m),this.features={js:m.js,wasm:m.wasm&&this.has_wasm()},this.use(c),this.use(d)}f.prototype=Object.create(l.prototype),f.prototype.constructor=f,f.prototype.resizeAndUnsharp=function(p,m){var y=this.resize(p,m);return p.unsharpAmount&&this.unsharp_mask(y,p.toWidth,p.toHeight,p.unsharpAmount,p.unsharpRadius,p.unsharpThreshold),y},s.exports=f},{"./mm_resize":4,"./mm_unsharp_mask":9,multimath:19}],2:[function(n,s,a){function l(m){return m<0?0:m>255?255:m}function c(m){return m>=0?m:0}function d(m,y,_,x,w,A){var S,T,E,C,O,j,I,D,P,G,V,z=0,Y=0;for(P=0;P<x;P++){for(O=0,G=0;G<w;G++){for(j=A[O++],I=A[O++],D=z+j*4|0,S=T=E=C=0;I>0;I--)V=A[O++],C=C+V*m[D+3]|0,E=E+V*m[D+2]|0,T=T+V*m[D+1]|0,S=S+V*m[D]|0,D=D+4|0;y[Y+3]=c(C>>7),y[Y+2]=c(E>>7),y[Y+1]=c(T>>7),y[Y]=c(S>>7),Y=Y+x*4|0}Y=(P+1)*4|0,z=(P+1)*_*4|0}}function f(m,y,_,x,w,A){var S,T,E,C,O,j,I,D,P,G,V,z=0,Y=0;for(P=0;P<x;P++){for(O=0,G=0;G<w;G++){for(j=A[O++],I=A[O++],D=z+j*4|0,S=T=E=C=0;I>0;I--)V=A[O++],C=C+V*m[D+3]|0,E=E+V*m[D+2]|0,T=T+V*m[D+1]|0,S=S+V*m[D]|0,D=D+4|0;S>>=7,T>>=7,E>>=7,C>>=7,y[Y+3]=l(C+8192>>14),y[Y+2]=l(E+8192>>14),y[Y+1]=l(T+8192>>14),y[Y]=l(S+8192>>14),Y=Y+x*4|0}Y=(P+1)*4|0,z=(P+1)*_*4|0}}function h(m,y,_,x,w,A){var S,T,E,C,O,j,I,D,P,G,V,z,Y=0,H=0;for(G=0;G<x;G++){for(j=0,V=0;V<w;V++){for(I=A[j++],D=A[j++],P=Y+I*4|0,S=T=E=C=0;D>0;D--)z=A[j++],O=m[P+3],C=C+z*O|0,E=E+z*m[P+2]*O|0,T=T+z*m[P+1]*O|0,S=S+z*m[P]*O|0,P=P+4|0;E=E/255|0,T=T/255|0,S=S/255|0,y[H+3]=c(C>>7),y[H+2]=c(E>>7),y[H+1]=c(T>>7),y[H]=c(S>>7),H=H+x*4|0}H=(G+1)*4|0,Y=(G+1)*_*4|0}}function p(m,y,_,x,w,A){var S,T,E,C,O,j,I,D,P,G,V,z=0,Y=0;for(P=0;P<x;P++){for(O=0,G=0;G<w;G++){for(j=A[O++],I=A[O++],D=z+j*4|0,S=T=E=C=0;I>0;I--)V=A[O++],C=C+V*m[D+3]|0,E=E+V*m[D+2]|0,T=T+V*m[D+1]|0,S=S+V*m[D]|0,D=D+4|0;S>>=7,T>>=7,E>>=7,C>>=7,C=l(C+8192>>14),C>0&&(S=S*255/C|0,T=T*255/C|0,E=E*255/C|0),y[Y+3]=C,y[Y+2]=l(E+8192>>14),y[Y+1]=l(T+8192>>14),y[Y]=l(S+8192>>14),Y=Y+x*4|0}Y=(P+1)*4|0,z=(P+1)*_*4|0}}s.exports={convolveHor:d,convolveVert:f,convolveHorWithPre:h,convolveVertWithPre:p}},{}],3:[function(n,s,a){s.exports="AGFzbQEAAAAADAZkeWxpbmsAAAAAAAEYA2AGf39/f39/AGAAAGAIf39/f39/f38AAg8BA2VudgZtZW1vcnkCAAADBwYBAAAAAAIGBgF/AEEACweUAQgRX193YXNtX2NhbGxfY3RvcnMAAAtjb252b2x2ZUhvcgABDGNvbnZvbHZlVmVydAACEmNvbnZvbHZlSG9yV2l0aFByZQADE2NvbnZvbHZlVmVydFdpdGhQcmUABApjb252b2x2ZUhWAAUMX19kc29faGFuZGxlAwAYX193YXNtX2FwcGx5X2RhdGFfcmVsb2NzAAAKyA4GAwABC4wDARB/AkAgA0UNACAERQ0AIANBAnQhFQNAQQAhE0EAIQsDQCALQQJqIQcCfyALQQF0IAVqIgYuAQIiC0UEQEEAIQhBACEGQQAhCUEAIQogBwwBCyASIAYuAQBqIQhBACEJQQAhCiALIRRBACEOIAchBkEAIQ8DQCAFIAZBAXRqLgEAIhAgACAIQQJ0aigCACIRQRh2bCAPaiEPIBFB/wFxIBBsIAlqIQkgEUEQdkH/AXEgEGwgDmohDiARQQh2Qf8BcSAQbCAKaiEKIAhBAWohCCAGQQFqIQYgFEEBayIUDQALIAlBB3UhCCAKQQd1IQYgDkEHdSEJIA9BB3UhCiAHIAtqCyELIAEgDEEBdCIHaiAIQQAgCEEAShs7AQAgASAHQQJyaiAGQQAgBkEAShs7AQAgASAHQQRyaiAJQQAgCUEAShs7AQAgASAHQQZyaiAKQQAgCkEAShs7AQAgDCAVaiEMIBNBAWoiEyAERw0ACyANQQFqIg0gAmwhEiANQQJ0IQwgAyANRw0ACwsL2gMBD38CQCADRQ0AIARFDQAgAkECdCEUA0AgCyEMQQAhE0EAIQIDQCACQQJqIQYCfyACQQF0IAVqIgcuAQIiAkUEQEEAIQhBACEHQQAhCkEAIQkgBgwBCyAHLgEAQQJ0IBJqIQhBACEJIAIhCkEAIQ0gBiEHQQAhDkEAIQ8DQCAFIAdBAXRqLgEAIhAgACAIQQF0IhFqLwEAbCAJaiEJIAAgEUEGcmovAQAgEGwgDmohDiAAIBFBBHJqLwEAIBBsIA9qIQ8gACARQQJyai8BACAQbCANaiENIAhBBGohCCAHQQFqIQcgCkEBayIKDQALIAlBB3UhCCANQQd1IQcgDkEHdSEKIA9BB3UhCSACIAZqCyECIAEgDEECdGogB0GAQGtBDnUiBkH/ASAGQf8BSBsiBkEAIAZBAEobQQh0QYD+A3EgCUGAQGtBDnUiBkH/ASAGQf8BSBsiBkEAIAZBAEobQRB0QYCA/AdxIApBgEBrQQ51IgZB/wEgBkH/AUgbIgZBACAGQQBKG0EYdHJyIAhBgEBrQQ51IgZB/wEgBkH/AUgbIgZBACAGQQBKG3I2AgAgAyAMaiEMIBNBAWoiEyAERw0ACyAUIAtBAWoiC2whEiADIAtHDQALCwuSAwEQfwJAIANFDQAgBEUNACADQQJ0IRUDQEEAIRNBACEGA0AgBkECaiEIAn8gBkEBdCAFaiIGLgECIgdFBEBBACEJQQAhDEEAIQ1BACEOIAgMAQsgEiAGLgEAaiEJQQAhDkEAIQ1BACEMIAchFEEAIQ8gCCEGA0AgBSAGQQF0ai4BACAAIAlBAnRqKAIAIhBBGHZsIhEgD2ohDyARIBBBEHZB/wFxbCAMaiEMIBEgEEEIdkH/AXFsIA1qIQ0gESAQQf8BcWwgDmohDiAJQQFqIQkgBkEBaiEGIBRBAWsiFA0ACyAPQQd1IQkgByAIagshBiABIApBAXQiCGogDkH/AW1BB3UiB0EAIAdBAEobOwEAIAEgCEECcmogDUH/AW1BB3UiB0EAIAdBAEobOwEAIAEgCEEEcmogDEH/AW1BB3UiB0EAIAdBAEobOwEAIAEgCEEGcmogCUEAIAlBAEobOwEAIAogFWohCiATQQFqIhMgBEcNAAsgC0EBaiILIAJsIRIgC0ECdCEKIAMgC0cNAAsLC4IEAQ9/AkAgA0UNACAERQ0AIAJBAnQhFANAIAshDEEAIRJBACEHA0AgB0ECaiEKAn8gB0EBdCAFaiICLgECIhNFBEBBACEIQQAhCUEAIQYgCiEHQQAMAQsgAi4BAEECdCARaiEJQQAhByATIQJBACENIAohBkEAIQ5BACEPA0AgBSAGQQF0ai4BACIIIAAgCUEBdCIQai8BAGwgB2ohByAAIBBBBnJqLwEAIAhsIA5qIQ4gACAQQQRyai8BACAIbCAPaiEPIAAgEEECcmovAQAgCGwgDWohDSAJQQRqIQkgBkEBaiEGIAJBAWsiAg0ACyAHQQd1IQggDUEHdSEJIA9BB3UhBiAKIBNqIQcgDkEHdQtBgEBrQQ51IgJB/wEgAkH/AUgbIgJBACACQQBKGyIKQf8BcQRAIAlB/wFsIAJtIQkgCEH/AWwgAm0hCCAGQf8BbCACbSEGCyABIAxBAnRqIAlBgEBrQQ51IgJB/wEgAkH/AUgbIgJBACACQQBKG0EIdEGA/gNxIAZBgEBrQQ51IgJB/wEgAkH/AUgbIgJBACACQQBKG0EQdEGAgPwHcSAKQRh0ciAIQYBAa0EOdSICQf8BIAJB/wFIGyICQQAgAkEAShtycjYCACADIAxqIQwgEkEBaiISIARHDQALIBQgC0EBaiILbCERIAMgC0cNAAsLC0AAIAcEQEEAIAIgAyAEIAUgABADIAJBACAEIAUgBiABEAQPC0EAIAIgAyAEIAUgABABIAJBACAEIAUgBiABEAIL"},{}],4:[function(n,s,a){s.exports={name:"resize",fn:n("./resize"),wasm_fn:n("./resize_wasm"),wasm_src:n("./convolve_wasm_base64")}},{"./convolve_wasm_base64":3,"./resize":5,"./resize_wasm":8}],5:[function(n,s,a){var l=n("./resize_filter_gen"),c=n("./convolve"),d=c.convolveHor,f=c.convolveVert,h=c.convolveHorWithPre,p=c.convolveVertWithPre;function m(_,x,w){for(var A=3,S=x*w*4|0;A<S;){if(_[A]!==255)return!0;A=A+4|0}return!1}function y(_,x,w){for(var A=3,S=x*w*4|0;A<S;)_[A]=255,A=A+4|0}s.exports=function(x){var w=x.src,A=x.width,S=x.height,T=x.toWidth,E=x.toHeight,C=x.scaleX||x.toWidth/x.width,O=x.scaleY||x.toHeight/x.height,j=x.offsetX||0,I=x.offsetY||0,D=x.dest||new Uint8Array(T*E*4),P=typeof x.filter>"u"?"mks2013":x.filter,G=l(P,A,T,C,j),V=l(P,S,E,O,I),z=new Uint16Array(T*S*4);return m(w,A,S)?(h(w,z,A,S,T,G),p(z,D,S,T,E,V)):(d(w,z,A,S,T,G),f(z,D,S,T,E,V),y(D,T,E)),D}},{"./convolve":2,"./resize_filter_gen":6}],6:[function(n,s,a){var l=n("./resize_filter_info"),c=14;function d(f){return Math.round(f*((1<<c)-1))}s.exports=function(h,p,m,y,_){var x=l.filter[h].fn,w=1/y,A=Math.min(1,y),S=l.filter[h].win/A,T,E,C,O,j,I,D,P,G,V,z,Y,H,F,N,B,U,$=Math.floor((S+1)*2),Q=new Int16Array(($+2)*m),M=0,q=!Q.subarray||!Q.set;for(T=0;T<m;T++){for(E=(T+.5)*w+_,C=Math.max(0,Math.floor(E-S)),O=Math.min(p-1,Math.ceil(E+S)),j=O-C+1,I=new Float32Array(j),D=new Int16Array(j),P=0,G=C,V=0;G<=O;G++,V++)z=x((G+.5-E)*A),P+=z,I[V]=z;for(Y=0,V=0;V<I.length;V++)H=I[V]/P,Y+=H,D[V]=d(H);for(D[m>>1]+=d(1-Y),F=0;F<D.length&&D[F]===0;)F++;if(F<D.length){for(N=D.length-1;N>0&&D[N]===0;)N--;if(B=C+F,U=N-F+1,Q[M++]=B,Q[M++]=U,!q)Q.set(D.subarray(F,N+1),M),M+=U;else for(V=F;V<=N;V++)Q[M++]=D[V]}else Q[M++]=0,Q[M++]=0}return Q}},{"./resize_filter_info":7}],7:[function(n,s,a){var l={box:{win:.5,fn:function(d){return d<0&&(d=-d),d<.5?1:0}},hamming:{win:1,fn:function(d){if(d<0&&(d=-d),d>=1)return 0;if(d<11920929e-14)return 1;var f=d*Math.PI;return Math.sin(f)/f*(.54+.46*Math.cos(f/1))}},lanczos2:{win:2,fn:function(d){if(d<0&&(d=-d),d>=2)return 0;if(d<11920929e-14)return 1;var f=d*Math.PI;return Math.sin(f)/f*Math.sin(f/2)/(f/2)}},lanczos3:{win:3,fn:function(d){if(d<0&&(d=-d),d>=3)return 0;if(d<11920929e-14)return 1;var f=d*Math.PI;return Math.sin(f)/f*Math.sin(f/3)/(f/3)}},mks2013:{win:2.5,fn:function(d){return d<0&&(d=-d),d>=2.5?0:d>=1.5?-.125*(d-2.5)*(d-2.5):d>=.5?.25*(4*d*d-11*d+7):1.0625-1.75*d*d}}};s.exports={filter:l,f2q:{box:0,hamming:1,lanczos2:2,lanczos3:3},q2f:["box","hamming","lanczos2","lanczos3"]}},{}],8:[function(n,s,a){var l=n("./resize_filter_gen");function c(m,y,_){for(var x=3,w=y*_*4|0;x<w;){if(m[x]!==255)return!0;x=x+4|0}return!1}function d(m,y,_){for(var x=3,w=y*_*4|0;x<w;)m[x]=255,x=x+4|0}function f(m){return new Uint8Array(m.buffer,0,m.byteLength)}var h=!0;try{h=new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0]===1}catch{}function p(m,y,_){if(h){y.set(f(m),_);return}for(var x=_,w=0;w<m.length;w++){var A=m[w];y[x++]=A&255,y[x++]=A>>8&255}}s.exports=function(y){var _=y.src,x=y.width,w=y.height,A=y.toWidth,S=y.toHeight,T=y.scaleX||y.toWidth/y.width,E=y.scaleY||y.toHeight/y.height,C=y.offsetX||0,O=y.offsetY||0,j=y.dest||new Uint8Array(A*S*4),I=typeof y.filter>"u"?"mks2013":y.filter,D=l(I,x,A,T,C),P=l(I,w,S,E,O),G=0,V=Math.max(_.byteLength,j.byteLength),z=this.__align(G+V),Y=w*A*4*2,H=this.__align(z+Y),F=this.__align(H+D.byteLength),N=F+P.byteLength,B=this.__instance("resize",N),U=new Uint8Array(this.__memory.buffer),$=new Uint32Array(this.__memory.buffer),Q=new Uint32Array(_.buffer);$.set(Q),p(D,U,H),p(P,U,F);var M=B.exports.convolveHV||B.exports._convolveHV;c(_,x,w)?M(H,F,z,x,w,A,S,1):(M(H,F,z,x,w,A,S,0),d(j,A,S));var q=new Uint32Array(j.buffer);return q.set(new Uint32Array(this.__memory.buffer,0,S*A)),j}},{"./resize_filter_gen":6}],9:[function(n,s,a){s.exports={name:"unsharp_mask",fn:n("./unsharp_mask"),wasm_fn:n("./unsharp_mask_wasm"),wasm_src:n("./unsharp_mask_wasm_base64")}},{"./unsharp_mask":10,"./unsharp_mask_wasm":11,"./unsharp_mask_wasm_base64":12}],10:[function(n,s,a){var l=n("glur/mono16");function c(d,f,h){for(var p=f*h,m=new Uint16Array(p),y,_,x,w,A=0;A<p;A++)y=d[4*A],_=d[4*A+1],x=d[4*A+2],w=y>=_&&y>=x?y:_>=x&&_>=y?_:x,m[A]=w<<8;return m}s.exports=function(f,h,p,m,y,_){var x,w,A,S,T;if(!(m===0||y<.5)){y>2&&(y=2);var E=c(f,h,p),C=new Uint16Array(E);l(C,h,p,y);for(var O=m/100*4096+.5|0,j=_<<8,I=h*p,D=0;D<I;D++)x=E[D],S=x-C[D],Math.abs(S)>=j&&(w=x+(O*S+2048>>12),w=w>65280?65280:w,w=w<0?0:w,x=x!==0?x:1,A=(w<<12)/x|0,T=D*4,f[T]=f[T]*A+2048>>12,f[T+1]=f[T+1]*A+2048>>12,f[T+2]=f[T+2]*A+2048>>12)}}},{"glur/mono16":18}],11:[function(n,s,a){s.exports=function(c,d,f,h,p,m){if(!(h===0||p<.5)){p>2&&(p=2);var y=d*f,_=y*4,x=y*2,w=y*2,A=Math.max(d,f)*4,S=32,T=0,E=_,C=E+x,O=C+w,j=O+w,I=j+A,D=this.__instance("unsharp_mask",_+x+w*2+A+S,{exp:Math.exp}),P=new Uint32Array(c.buffer),G=new Uint32Array(this.__memory.buffer);G.set(P);var V=D.exports.hsv_v16||D.exports._hsv_v16;V(T,E,d,f),V=D.exports.blurMono16||D.exports._blurMono16,V(E,C,O,j,I,d,f,p),V=D.exports.unsharp||D.exports._unsharp,V(T,T,E,C,d,f,h,m),P.set(new Uint32Array(this.__memory.buffer,0,y))}}},{}],12:[function(n,s,a){s.exports="AGFzbQEAAAAADAZkeWxpbmsAAAAAAAE0B2AAAGAEf39/fwBgBn9/f39/fwBgCH9/f39/f39/AGAIf39/f39/f30AYAJ9fwBgAXwBfAIZAgNlbnYDZXhwAAYDZW52Bm1lbW9yeQIAAAMHBgAFAgQBAwYGAX8AQQALB4oBCBFfX3dhc21fY2FsbF9jdG9ycwABFl9fYnVpbGRfZ2F1c3NpYW5fY29lZnMAAg5fX2dhdXNzMTZfbGluZQADCmJsdXJNb25vMTYABAdoc3ZfdjE2AAUHdW5zaGFycAAGDF9fZHNvX2hhbmRsZQMAGF9fd2FzbV9hcHBseV9kYXRhX3JlbG9jcwABCsUMBgMAAQvWAQEHfCABRNuGukOCGvs/IAC7oyICRAAAAAAAAADAohAAIgW2jDgCFCABIAKaEAAiAyADoCIGtjgCECABRAAAAAAAAPA/IAOhIgQgBKIgAyACIAKgokQAAAAAAADwP6AgBaGjIgS2OAIAIAEgBSAEmqIiB7Y4AgwgASADIAJEAAAAAAAA8D+gIASioiIItjgCCCABIAMgAkQAAAAAAADwv6AgBKKiIgK2OAIEIAEgByAIoCAFRAAAAAAAAPA/IAahoCIDo7Y4AhwgASAEIAKgIAOjtjgCGAuGBQMGfwl8An0gAyoCDCEVIAMqAgghFiADKgIUuyERIAMqAhC7IRACQCAEQQFrIghBAEgiCQRAIAIhByAAIQYMAQsgAiAALwEAuCIPIAMqAhi7oiIMIBGiIg0gDCAQoiAPIAMqAgS7IhOiIhQgAyoCALsiEiAPoqCgoCIOtjgCACACQQRqIQcgAEECaiEGIAhFDQAgCEEBIAhBAUgbIgpBf3MhCwJ/IAQgCmtBAXFFBEAgDiENIAgMAQsgAiANIA4gEKIgFCASIAAvAQK4Ig+ioKCgIg22OAIEIAJBCGohByAAQQRqIQYgDiEMIARBAmsLIQIgC0EAIARrRg0AA0AgByAMIBGiIA0gEKIgDyAToiASIAYvAQC4Ig6ioKCgIgy2OAIAIAcgDSARoiAMIBCiIA4gE6IgEiAGLwECuCIPoqCgoCINtjgCBCAHQQhqIQcgBkEEaiEGIAJBAkohACACQQJrIQIgAA0ACwsCQCAJDQAgASAFIAhsQQF0aiIAAn8gBkECay8BACICuCINIBW7IhKiIA0gFrsiE6KgIA0gAyoCHLuiIgwgEKKgIAwgEaKgIg8gB0EEayIHKgIAu6AiDkQAAAAAAADwQWMgDkQAAAAAAAAAAGZxBEAgDqsMAQtBAAs7AQAgCEUNACAGQQRrIQZBACAFa0EBdCEBA0ACfyANIBKiIAJB//8DcbgiDSAToqAgDyIOIBCioCAMIBGioCIPIAdBBGsiByoCALugIgxEAAAAAAAA8EFjIAxEAAAAAAAAAABmcQRAIAyrDAELQQALIQMgBi8BACECIAAgAWoiACADOwEAIAZBAmshBiAIQQFKIQMgDiEMIAhBAWshCCADDQALCwvRAgIBfwd8AkAgB0MAAAAAWw0AIARE24a6Q4Ia+z8gB0MAAAA/l7ujIglEAAAAAAAAAMCiEAAiDLaMOAIUIAQgCZoQACIKIAqgIg22OAIQIAREAAAAAAAA8D8gCqEiCyALoiAKIAkgCaCiRAAAAAAAAPA/oCAMoaMiC7Y4AgAgBCAMIAuaoiIOtjgCDCAEIAogCUQAAAAAAADwP6AgC6KiIg+2OAIIIAQgCiAJRAAAAAAAAPC/oCALoqIiCbY4AgQgBCAOIA+gIAxEAAAAAAAA8D8gDaGgIgqjtjgCHCAEIAsgCaAgCqO2OAIYIAYEQANAIAAgBSAIbEEBdGogAiAIQQF0aiADIAQgBSAGEAMgCEEBaiIIIAZHDQALCyAFRQ0AQQAhCANAIAIgBiAIbEEBdGogASAIQQF0aiADIAQgBiAFEAMgCEEBaiIIIAVHDQALCwtxAQN/IAIgA2wiBQRAA0AgASAAKAIAIgRBEHZB/wFxIgIgAiAEQQh2Qf8BcSIDIAMgBEH/AXEiBEkbIAIgA0sbIgYgBiAEIAIgBEsbIAMgBEsbQQh0OwEAIAFBAmohASAAQQRqIQAgBUEBayIFDQALCwuZAgIDfwF8IAQgBWwhBAJ/IAazQwAAgEWUQwAAyEKVu0QAAAAAAADgP6AiC5lEAAAAAAAA4EFjBEAgC6oMAQtBgICAgHgLIQUgBARAIAdBCHQhCUEAIQYDQCAJIAIgBkEBdCIHai8BACIBIAMgB2ovAQBrIgcgB0EfdSIIaiAIc00EQCAAIAZBAnQiCGoiCiAFIAdsQYAQakEMdSABaiIHQYD+AyAHQYD+A0gbIgdBACAHQQBKG0EMdCABQQEgARtuIgEgCi0AAGxBgBBqQQx2OgAAIAAgCEEBcmoiByABIActAABsQYAQakEMdjoAACAAIAhBAnJqIgcgASAHLQAAbEGAEGpBDHY6AAALIAZBAWoiBiAERw0ACwsL"},{}],13:[function(n,s,a){var l=100;function c(d,f){this.create=d,this.available=[],this.acquired={},this.lastId=1,this.timeoutId=0,this.idle=f||2e3}c.prototype.acquire=function(){var d=this,f;return this.available.length!==0?f=this.available.pop():(f=this.create(),f.id=this.lastId++,f.release=function(){return d.release(f)}),this.acquired[f.id]=f,f},c.prototype.release=function(d){var f=this;delete this.acquired[d.id],d.lastUsed=Date.now(),this.available.push(d),this.timeoutId===0&&(this.timeoutId=setTimeout(function(){return f.gc()},l))},c.prototype.gc=function(){var d=this,f=Date.now();this.available=this.available.filter(function(h){return f-h.lastUsed>d.idle?(h.destroy(),!1):!0}),this.available.length!==0?this.timeoutId=setTimeout(function(){return d.gc()},l):this.timeoutId=0},s.exports=c},{}],14:[function(n,s,a){var l=2;s.exports=function(d,f,h,p,m,y){var _=h/d,x=p/f,w=(2*y+l+1)/m;if(w>.5)return[[h,p]];var A=Math.ceil(Math.log(Math.min(_,x))/Math.log(w));if(A<=1)return[[h,p]];for(var S=[],T=0;T<A;T++){var E=Math.round(Math.pow(Math.pow(d,A-T-1)*Math.pow(h,T+1),1/A)),C=Math.round(Math.pow(Math.pow(f,A-T-1)*Math.pow(p,T+1),1/A));S.push([E,C])}return S}},{}],15:[function(n,s,a){var l=1e-5;function c(f){var h=Math.round(f);return Math.abs(f-h)<l?h:Math.floor(f)}function d(f){var h=Math.round(f);return Math.abs(f-h)<l?h:Math.ceil(f)}s.exports=function(h){var p=h.toWidth/h.width,m=h.toHeight/h.height,y=c(h.srcTileSize*p)-2*h.destTileBorder,_=c(h.srcTileSize*m)-2*h.destTileBorder;if(y<1||_<1)throw new Error("Internal error in pica: target tile width/height is too small.");var x,w,A,S,T,E,C=[],O;for(S=0;S<h.toHeight;S+=_)for(A=0;A<h.toWidth;A+=y)x=A-h.destTileBorder,x<0&&(x=0),T=A+y+h.destTileBorder-x,x+T>=h.toWidth&&(T=h.toWidth-x),w=S-h.destTileBorder,w<0&&(w=0),E=S+_+h.destTileBorder-w,w+E>=h.toHeight&&(E=h.toHeight-w),O={toX:x,toY:w,toWidth:T,toHeight:E,toInnerX:A,toInnerY:S,toInnerWidth:y,toInnerHeight:_,offsetX:x/p-c(x/p),offsetY:w/m-c(w/m),scaleX:p,scaleY:m,x:c(x/p),y:c(w/m),width:d(T/p),height:d(E/m)},C.push(O);return C}},{}],16:[function(n,s,a){function l(c){return Object.prototype.toString.call(c)}s.exports.isCanvas=function(d){var f=l(d);return f==="[object HTMLCanvasElement]"||f==="[object OffscreenCanvas]"||f==="[object Canvas]"},s.exports.isImage=function(d){return l(d)==="[object HTMLImageElement]"},s.exports.isImageBitmap=function(d){return l(d)==="[object ImageBitmap]"},s.exports.limiter=function(d){var f=0,h=[];function p(){f<d&&h.length&&(f++,h.shift()())}return function(y){return new Promise(function(_,x){h.push(function(){y().then(function(w){_(w),f--,p()},function(w){x(w),f--,p()})}),p()})}},s.exports.cib_quality_name=function(d){switch(d){case 0:return"pixelated";case 1:return"low";case 2:return"medium"}return"high"},s.exports.cib_support=function(d){return Promise.resolve().then(function(){if(typeof createImageBitmap>"u")return!1;var f=d(100,100);return createImageBitmap(f,0,0,100,100,{resizeWidth:10,resizeHeight:10,resizeQuality:"high"}).then(function(h){var p=h.width===10;return h.close(),f=null,p})}).catch(function(){return!1})},s.exports.worker_offscreen_canvas_support=function(){return new Promise(function(d,f){if(typeof OffscreenCanvas>"u"){d(!1);return}function h(y){if(typeof createImageBitmap>"u"){y.postMessage(!1);return}Promise.resolve().then(function(){var _=new OffscreenCanvas(10,10),x=_.getContext("2d");return x.rect(0,0,1,1),createImageBitmap(_,0,0,1,1)}).then(function(){return y.postMessage(!0)},function(){return y.postMessage(!1)})}var p=btoa("(".concat(h.toString(),")(self);")),m=new Worker("data:text/javascript;base64,".concat(p));m.onmessage=function(y){return d(y.data)},m.onerror=f}).then(function(d){return d},function(){return!1})},s.exports.can_use_canvas=function(d){var f=!1;try{var h=d(2,1),p=h.getContext("2d"),m=p.createImageData(2,1);m.data[0]=12,m.data[1]=23,m.data[2]=34,m.data[3]=255,m.data[4]=45,m.data[5]=56,m.data[6]=67,m.data[7]=255,p.putImageData(m,0,0),m=null,m=p.getImageData(0,0,2,1),m.data[0]===12&&m.data[1]===23&&m.data[2]===34&&m.data[3]===255&&m.data[4]===45&&m.data[5]===56&&m.data[6]===67&&m.data[7]===255&&(f=!0)}catch{}return f},s.exports.cib_can_use_region=function(){return new Promise(function(d){if(typeof Image>"u"||typeof createImageBitmap>"u"){d(!1);return}var f=new Image;f.src="data:image/jpeg;base64,/9j/4QBiRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAYAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAAAAABIAAAAAQAAAEgAAAAB/9sAQwAEAwMEAwMEBAMEBQQEBQYKBwYGBgYNCQoICg8NEBAPDQ8OERMYFBESFxIODxUcFRcZGRsbGxAUHR8dGh8YGhsa/9sAQwEEBQUGBQYMBwcMGhEPERoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoa/8IAEQgAAQACAwERAAIRAQMRAf/EABQAAQAAAAAAAAAAAAAAAAAAAAf/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAF/P//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAQUCf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Bf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Bf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEABj8Cf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8hf//aAAwDAQACAAMAAAAQH//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Qf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Qf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8Qf//Z",f.onload=function(){createImageBitmap(f,0,0,f.width,f.height).then(function(h){h.width===f.width&&h.height===f.height?d(!0):d(!1)},function(){return d(!1)})},f.onerror=function(){return d(!1)}})}},{}],17:[function(n,s,a){s.exports=function(){var l=n("./mathlib"),c;onmessage=function(f){var h=f.data.opts;if(!h.src&&h.srcBitmap){var p=new OffscreenCanvas(h.width,h.height),m=p.getContext("2d");m.drawImage(h.srcBitmap,0,0),h.src=m.getImageData(0,0,h.width,h.height).data,p.width=p.height=0,p=null,h.srcBitmap.close(),h.srcBitmap=null}c||(c=new l(f.data.features));var y=c.resizeAndUnsharp(h);postMessage({data:y},[y.buffer])}}},{"./mathlib":1}],18:[function(n,s,a){var l,c,d,f,h,p,m,y;function _(A){A<.5&&(A=.5);var S=Math.exp(.726*.726)/A,T=Math.exp(-S),E=Math.exp(-2*S),C=(1-T)*(1-T)/(1+2*S*T-E);return l=C,c=C*(S-1)*T,d=C*(S+1)*T,f=-C*E,h=2*T,p=-E,m=(l+c)/(1-h-p),y=(d+f)/(1-h-p),new Float32Array([l,c,d,f,h,p,m,y])}function x(A,S,T,E,C,O){var j,I,D,P,G,V,z,Y,H,F,N,B,U,$;for(H=0;H<O;H++){for(V=H*C,z=H,Y=0,j=A[V],G=j*E[6],P=G,N=E[0],B=E[1],U=E[4],$=E[5],F=0;F<C;F++)I=A[V],D=I*N+j*B+P*U+G*$,G=P,P=D,j=I,T[Y]=P,Y++,V++;for(V--,Y--,z+=O*(C-1),j=A[V],G=j*E[7],P=G,I=j,N=E[2],B=E[3],F=C-1;F>=0;F--)D=I*N+j*B+P*U+G*$,G=P,P=D,j=I,I=A[V],S[z]=T[Y]+P,V--,Y--,z-=O}}function w(A,S,T,E){if(E){var C=new Uint16Array(A.length),O=new Float32Array(Math.max(S,T)),j=_(E);x(A,C,O,j,S,T),x(C,A,O,j,T,S)}}s.exports=w},{}],19:[function(n,s,a){var l=n("object-assign"),c=n("./lib/base64decode"),d=n("./lib/wa_detect"),f={js:!0,wasm:!0};function h(p){if(!(this instanceof h))return new h(p);var m=l({},f,p||{});if(this.options=m,this.__cache={},this.__init_promise=null,this.__modules=m.modules||{},this.__memory=null,this.__wasm={},this.__isLE=new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0]===1,!this.options.js&&!this.options.wasm)throw new Error('mathlib: at least "js" or "wasm" should be enabled')}h.prototype.has_wasm=d,h.prototype.use=function(p){return this.__modules[p.name]=p,this.options.wasm&&this.has_wasm()&&p.wasm_fn?this[p.name]=p.wasm_fn:this[p.name]=p.fn,this},h.prototype.init=function(){if(this.__init_promise)return this.__init_promise;if(!this.options.js&&this.options.wasm&&!this.has_wasm())return Promise.reject(new Error(`mathlib: only "wasm" was enabled, but it's not supported`));var p=this;return this.__init_promise=Promise.all(Object.keys(p.__modules).map(function(m){var y=p.__modules[m];return!p.options.wasm||!p.has_wasm()||!y.wasm_fn||p.__wasm[m]?null:WebAssembly.compile(p.__base64decode(y.wasm_src)).then(function(_){p.__wasm[m]=_})})).then(function(){return p}),this.__init_promise},h.prototype.__base64decode=c,h.prototype.__reallocate=function(m){if(!this.__memory)return this.__memory=new WebAssembly.Memory({initial:Math.ceil(m/(64*1024))}),this.__memory;var y=this.__memory.buffer.byteLength;return y<m&&this.__memory.grow(Math.ceil((m-y)/(64*1024))),this.__memory},h.prototype.__instance=function(m,y,_){if(y&&this.__reallocate(y),!this.__wasm[m]){var x=this.__modules[m];this.__wasm[m]=new WebAssembly.Module(this.__base64decode(x.wasm_src))}if(!this.__cache[m]){var w={memoryBase:0,memory:this.__memory,tableBase:0,table:new WebAssembly.Table({initial:0,element:"anyfunc"})};this.__cache[m]=new WebAssembly.Instance(this.__wasm[m],{env:l(w,_||{})})}return this.__cache[m]},h.prototype.__align=function(m,y){y=y||8;var _=m%y;return m+(_?y-_:0)},s.exports=h},{"./lib/base64decode":20,"./lib/wa_detect":21,"object-assign":22}],20:[function(n,s,a){var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";s.exports=function(d){for(var f=d.replace(/[\r\n=]/g,""),h=f.length,p=new Uint8Array(h*3>>2),m=0,y=0,_=0;_<h;_++)_%4===0&&_&&(p[y++]=m>>16&255,p[y++]=m>>8&255,p[y++]=m&255),m=m<<6|l.indexOf(f.charAt(_));var x=h%4*6;return x===0?(p[y++]=m>>16&255,p[y++]=m>>8&255,p[y++]=m&255):x===18?(p[y++]=m>>10&255,p[y++]=m>>2&255):x===12&&(p[y++]=m>>4&255),p}},{}],21:[function(n,s,a){var l;s.exports=function(){if(typeof l<"u"||(l=!1,typeof WebAssembly>"u"))return l;try{var d=new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11]),f=new WebAssembly.Module(d),h=new WebAssembly.Instance(f,{});return h.exports.test(4)!==0&&(l=!0),l}catch{}return l}},{}],22:[function(n,s,a){var l=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable;function f(p){if(p==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(p)}function h(){try{if(!Object.assign)return!1;var p=new String("abc");if(p[5]="de",Object.getOwnPropertyNames(p)[0]==="5")return!1;for(var m={},y=0;y<10;y++)m["_"+String.fromCharCode(y)]=y;var _=Object.getOwnPropertyNames(m).map(function(w){return m[w]});if(_.join("")!=="0123456789")return!1;var x={};return"abcdefghijklmnopqrst".split("").forEach(function(w){x[w]=w}),Object.keys(Object.assign({},x)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}s.exports=h()?Object.assign:function(p,m){for(var y,_=f(p),x,w=1;w<arguments.length;w++){y=Object(arguments[w]);for(var A in y)c.call(y,A)&&(_[A]=y[A]);if(l){x=l(y);for(var S=0;S<x.length;S++)d.call(y,x[S])&&(_[x[S]]=y[x[S]])}}return _}},{}],23:[function(n,s,a){var l=arguments[3],c=arguments[4],d=arguments[5],f=JSON.stringify;s.exports=function(h,p){for(var m,y=Object.keys(d),_=0,x=y.length;_<x;_++){var w=y[_],A=d[w].exports;if(A===h||A&&A.default===h){m=w;break}}if(!m){m=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var S={},_=0,x=y.length;_<x;_++){var w=y[_];S[w]=w}c[m]=["function(require,module,exports){"+h+"(self); }",S]}var T=Math.floor(Math.pow(16,8)*Math.random()).toString(16),E={};E[m]=m,c[T]=["function(require,module,exports){var f = require("+f(m)+");(f.default ? f.default : f)(self);}",E];var C={};O(T);function O(V){C[V]=!0;for(var z in c[V][1]){var Y=c[V][1][z];C[Y]||O(Y)}}var j="("+l+")({"+Object.keys(C).map(function(V){return f(V)+":["+c[V][0]+","+f(c[V][1])+"]"}).join(",")+"},{},["+f(T)+"])",I=window.URL||window.webkitURL||window.mozURL||window.msURL,D=new Blob([j],{type:"text/javascript"});if(p&&p.bare)return D;var P=I.createObjectURL(D),G=new Worker(P);return G.objectURL=P,G}},{}],"/index.js":[function(n,s,a){function l(N,B){return p(N)||h(N,B)||d(N,B)||c()}function c(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d(N,B){if(N){if(typeof N=="string")return f(N,B);var U=Object.prototype.toString.call(N).slice(8,-1);if(U==="Object"&&N.constructor&&(U=N.constructor.name),U==="Map"||U==="Set")return Array.from(N);if(U==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(U))return f(N,B)}}function f(N,B){(B==null||B>N.length)&&(B=N.length);for(var U=0,$=new Array(B);U<B;U++)$[U]=N[U];return $}function h(N,B){var U=N==null?null:typeof Symbol<"u"&&N[Symbol.iterator]||N["@@iterator"];if(U!=null){var $=[],Q=!0,M=!1,q,X;try{for(U=U.call(N);!(Q=(q=U.next()).done)&&($.push(q.value),!(B&&$.length===B));Q=!0);}catch(Z){M=!0,X=Z}finally{try{!Q&&U.return!=null&&U.return()}finally{if(M)throw X}}return $}}function p(N){if(Array.isArray(N))return N}var m=n("object-assign"),y=n("webworkify"),_=n("./lib/mathlib"),x=n("./lib/pool"),w=n("./lib/utils"),A=n("./lib/worker"),S=n("./lib/stepper"),T=n("./lib/tiler"),E=n("./lib/mm_resize/resize_filter_info"),C={},O=!1;try{typeof navigator<"u"&&navigator.userAgent&&(O=navigator.userAgent.indexOf("Safari")>=0)}catch{}var j=1;typeof navigator<"u"&&(j=Math.min(navigator.hardwareConcurrency||1,4));var I={tile:1024,concurrency:j,features:["js","wasm","ww"],idle:2e3,createCanvas:function(B,U){var $=document.createElement("canvas");return $.width=B,$.height=U,$}},D={filter:"mks2013",unsharpAmount:0,unsharpRadius:0,unsharpThreshold:0},P=!1,G=!1,V=!1,z=!1,Y=!1;function H(){return{value:y(A),destroy:function(){if(this.value.terminate(),typeof window<"u"){var B=window.URL||window.webkitURL||window.mozURL||window.msURL;B&&B.revokeObjectURL&&this.value.objectURL&&B.revokeObjectURL(this.value.objectURL)}}}}function F(N){if(!(this instanceof F))return new F(N);this.options=m({},I,N||{});var B="lk_".concat(this.options.concurrency);this.__limit=C[B]||w.limiter(this.options.concurrency),C[B]||(C[B]=this.__limit),this.features={js:!1,wasm:!1,cib:!1,ww:!1},this.__workersPool=null,this.__requested_features=[],this.__mathlib=null}F.prototype.init=function(){var N=this;if(this.__initPromise)return this.__initPromise;if(typeof ImageData<"u"&&typeof Uint8ClampedArray<"u")try{new ImageData(new Uint8ClampedArray(400),10,10),P=!0}catch{}typeof ImageBitmap<"u"&&(ImageBitmap.prototype&&ImageBitmap.prototype.close?G=!0:this.debug("ImageBitmap does not support .close(), disabled"));var B=this.options.features.slice();if(B.indexOf("all")>=0&&(B=["cib","wasm","js","ww"]),this.__requested_features=B,this.__mathlib=new _(B),B.indexOf("ww")>=0&&typeof window<"u"&&"Worker"in window)try{var U=n("webworkify")(function(){});U.terminate(),this.features.ww=!0;var $="wp_".concat(JSON.stringify(this.options));C[$]?this.__workersPool=C[$]:(this.__workersPool=new x(H,this.options.idle),C[$]=this.__workersPool)}catch{}var Q=this.__mathlib.init().then(function(Z){m(N.features,Z.features)}),M;G?M=w.cib_support(this.options.createCanvas).then(function(Z){if(N.features.cib&&B.indexOf("cib")<0){N.debug("createImageBitmap() resize supported, but disabled by config");return}B.indexOf("cib")>=0&&(N.features.cib=Z)}):M=Promise.resolve(!1),V=w.can_use_canvas(this.options.createCanvas);var q;G&&P&&B.indexOf("ww")!==-1?q=w.worker_offscreen_canvas_support():q=Promise.resolve(!1),q=q.then(function(Z){z=Z});var X=w.cib_can_use_region().then(function(Z){Y=Z});return this.__initPromise=Promise.all([Q,M,q,X]).then(function(){return N}),this.__initPromise},F.prototype.__invokeResize=function(N,B){var U=this;return B.__mathCache=B.__mathCache||{},Promise.resolve().then(function(){return U.features.ww?new Promise(function($,Q){var M=U.__workersPool.acquire();B.cancelToken&&B.cancelToken.catch(function(X){return Q(X)}),M.value.onmessage=function(X){M.release(),X.data.err?Q(X.data.err):$(X.data)};var q=[];N.src&&q.push(N.src.buffer),N.srcBitmap&&q.push(N.srcBitmap),M.value.postMessage({opts:N,features:U.__requested_features,preload:{wasm_nodule:U.__mathlib.__}},q)}):{data:U.__mathlib.resizeAndUnsharp(N,B.__mathCache)}})},F.prototype.__extractTileData=function(N,B,U,$,Q){if(this.features.ww&&z&&(w.isCanvas(B)||Y))return this.debug("Create tile for OffscreenCanvas"),createImageBitmap($.srcImageBitmap||B,N.x,N.y,N.width,N.height).then(function(X){return Q.srcBitmap=X,Q});if(w.isCanvas(B))return $.srcCtx||($.srcCtx=B.getContext("2d")),this.debug("Get tile pixel data"),Q.src=$.srcCtx.getImageData(N.x,N.y,N.width,N.height).data,Q;this.debug("Draw tile imageBitmap/image to temporary canvas");var M=this.options.createCanvas(N.width,N.height),q=M.getContext("2d");return q.globalCompositeOperation="copy",q.drawImage($.srcImageBitmap||B,N.x,N.y,N.width,N.height,0,0,N.width,N.height),this.debug("Get tile pixel data"),Q.src=q.getImageData(0,0,N.width,N.height).data,M.width=M.height=0,Q},F.prototype.__landTileData=function(N,B,U){var $;if(this.debug("Convert raw rgba tile result to ImageData"),B.bitmap)return U.toCtx.drawImage(B.bitmap,N.toX,N.toY),null;if(P)$=new ImageData(new Uint8ClampedArray(B.data),N.toWidth,N.toHeight);else if($=U.toCtx.createImageData(N.toWidth,N.toHeight),$.data.set)$.data.set(B.data);else for(var Q=$.data.length-1;Q>=0;Q--)$.data[Q]=B.data[Q];return this.debug("Draw tile"),O?U.toCtx.putImageData($,N.toX,N.toY,N.toInnerX-N.toX,N.toInnerY-N.toY,N.toInnerWidth+1e-5,N.toInnerHeight+1e-5):U.toCtx.putImageData($,N.toX,N.toY,N.toInnerX-N.toX,N.toInnerY-N.toY,N.toInnerWidth,N.toInnerHeight),null},F.prototype.__tileAndResize=function(N,B,U){var $=this,Q={srcCtx:null,srcImageBitmap:null,isImageBitmapReused:!1,toCtx:null},M=function(X){return $.__limit(function(){if(U.canceled)return U.cancelToken;var Z={width:X.width,height:X.height,toWidth:X.toWidth,toHeight:X.toHeight,scaleX:X.scaleX,scaleY:X.scaleY,offsetX:X.offsetX,offsetY:X.offsetY,filter:U.filter,unsharpAmount:U.unsharpAmount,unsharpRadius:U.unsharpRadius,unsharpThreshold:U.unsharpThreshold};return $.debug("Invoke resize math"),Promise.resolve(Z).then(function(J){return $.__extractTileData(X,N,U,Q,J)}).then(function(J){return $.debug("Invoke resize math"),$.__invokeResize(J,U)}).then(function(J){return U.canceled?U.cancelToken:(Q.srcImageData=null,$.__landTileData(X,J,Q))})})};return Promise.resolve().then(function(){if(Q.toCtx=B.getContext("2d"),w.isCanvas(N))return null;if(w.isImageBitmap(N))return Q.srcImageBitmap=N,Q.isImageBitmapReused=!0,null;if(w.isImage(N))return G?($.debug("Decode image via createImageBitmap"),createImageBitmap(N).then(function(q){Q.srcImageBitmap=q}).catch(function(q){return null})):null;throw new Error('Pica: ".from" should be Image, Canvas or ImageBitmap')}).then(function(){if(U.canceled)return U.cancelToken;$.debug("Calculate tiles");var q=T({width:U.width,height:U.height,srcTileSize:$.options.tile,toWidth:U.toWidth,toHeight:U.toHeight,destTileBorder:U.__destTileBorder}),X=q.map(function(J){return M(J)});function Z(J){J.srcImageBitmap&&(J.isImageBitmapReused||J.srcImageBitmap.close(),J.srcImageBitmap=null)}return $.debug("Process tiles"),Promise.all(X).then(function(){return $.debug("Finished!"),Z(Q),B},function(J){throw Z(Q),J})})},F.prototype.__processStages=function(N,B,U,$){var Q=this;if($.canceled)return $.cancelToken;var M=N.shift(),q=l(M,2),X=q[0],Z=q[1],J=N.length===0,ae;J||E.q2f.indexOf($.filter)<0?ae=$.filter:$.filter==="box"?ae="box":ae="hamming",$=m({},$,{toWidth:X,toHeight:Z,filter:ae});var ce;return J||(ce=this.options.createCanvas(X,Z)),this.__tileAndResize(B,J?U:ce,$).then(function(){return J?U:($.width=X,$.height=Z,Q.__processStages(N,ce,U,$))}).then(function(de){return ce&&(ce.width=ce.height=0),de})},F.prototype.__resizeViaCreateImageBitmap=function(N,B,U){var $=this,Q=B.getContext("2d");return this.debug("Resize via createImageBitmap()"),createImageBitmap(N,{resizeWidth:U.toWidth,resizeHeight:U.toHeight,resizeQuality:w.cib_quality_name(E.f2q[U.filter])}).then(function(M){if(U.canceled)return U.cancelToken;if(!U.unsharpAmount)return Q.drawImage(M,0,0),M.close(),Q=null,$.debug("Finished!"),B;$.debug("Unsharp result");var q=$.options.createCanvas(U.toWidth,U.toHeight),X=q.getContext("2d");X.drawImage(M,0,0),M.close();var Z=X.getImageData(0,0,U.toWidth,U.toHeight);return $.__mathlib.unsharp_mask(Z.data,U.toWidth,U.toHeight,U.unsharpAmount,U.unsharpRadius,U.unsharpThreshold),Q.putImageData(Z,0,0),q.width=q.height=0,Z=X=q=Q=null,$.debug("Finished!"),B})},F.prototype.resize=function(N,B,U){var $=this;this.debug("Start resize...");var Q=m({},D);if(isNaN(U)?U&&(Q=m(Q,U)):Q=m(Q,{quality:U}),Q.toWidth=B.width,Q.toHeight=B.height,Q.width=N.naturalWidth||N.width,Q.height=N.naturalHeight||N.height,Object.prototype.hasOwnProperty.call(Q,"quality")){if(Q.quality<0||Q.quality>3)throw new Error("Pica: .quality should be [0..3], got ".concat(Q.quality));Q.filter=E.q2f[Q.quality]}if(B.width===0||B.height===0)return Promise.reject(new Error("Invalid output size: ".concat(B.width,"x").concat(B.height)));Q.unsharpRadius>2&&(Q.unsharpRadius=2),Q.canceled=!1,Q.cancelToken&&(Q.cancelToken=Q.cancelToken.then(function(q){throw Q.canceled=!0,q},function(q){throw Q.canceled=!0,q}));var M=3;return Q.__destTileBorder=Math.ceil(Math.max(M,2.5*Q.unsharpRadius|0)),this.init().then(function(){if(Q.canceled)return Q.cancelToken;if($.features.cib){if(E.q2f.indexOf(Q.filter)>=0)return $.__resizeViaCreateImageBitmap(N,B,Q);$.debug("cib is enabled, but not supports provided filter, fallback to manual math")}if(!V){var q=new Error("Pica: cannot use getImageData on canvas, make sure fingerprinting protection isn't enabled");throw q.code="ERR_GET_IMAGE_DATA",q}var X=S(Q.width,Q.height,Q.toWidth,Q.toHeight,$.options.tile,Q.__destTileBorder);return $.__processStages(X,N,B,Q)})},F.prototype.resizeBuffer=function(N){var B=this,U=m({},D,N);if(Object.prototype.hasOwnProperty.call(U,"quality")){if(U.quality<0||U.quality>3)throw new Error("Pica: .quality should be [0..3], got ".concat(U.quality));U.filter=E.q2f[U.quality]}return this.init().then(function(){return B.__mathlib.resizeAndUnsharp(U)})},F.prototype.toBlob=function(N,B,U){return B=B||"image/png",new Promise(function($){if(N.toBlob){N.toBlob(function(Z){return $(Z)},B,U);return}if(N.convertToBlob){$(N.convertToBlob({type:B,quality:U}));return}for(var Q=atob(N.toDataURL(B,U).split(",")[1]),M=Q.length,q=new Uint8Array(M),X=0;X<M;X++)q[X]=Q.charCodeAt(X);$(new Blob([q],{type:B}))})},F.prototype.debug=function(){},s.exports=F},{"./lib/mathlib":1,"./lib/mm_resize/resize_filter_info":7,"./lib/pool":13,"./lib/stepper":14,"./lib/tiler":15,"./lib/utils":16,"./lib/worker":17,"object-assign":22,webworkify:23}]},{},[])("/index.js")})})(yp)),yp.exports}var a$=i$();const o$=Yl(a$);function l$({id:t,data:e,selected:n}){const{editShotId:s}=_r(),{updateNodeData:a}=Jr(),[l,c]=k.useState(null),[d,f]=k.useState(!1),[h,p]=k.useState(!1),[m,y]=k.useState([]),[_,x]=k.useState([]),[w,A]=k.useState([]),[S,T]=k.useState({}),[E,C]=k.useState(""),[O,j]=k.useState("16:9"),[I,D]=k.useState(1),[P,G]=k.useState("fal-ai/nano-banana/edit"),[V,z]=k.useState(0),[Y,H]=k.useState(0);Jr();const F=o$(),N=()=>{switch(O){case"16:9":return{paddingBottom:"56.25%",width:"100%",position:"relative",height:0,overflow:"hidden"};case"9:16":return{paddingBottom:"177.78%",width:"100%",position:"relative",height:0,overflow:"hidden"};case"4:3":return{paddingBottom:"75%",width:"100%",position:"relative",height:0,overflow:"hidden"};default:return{paddingBottom:"56.25%",width:"100%",position:"relative",height:0,overflow:"hidden"}}},B=()=>({position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"contain"}),$=Zg({handleType:"target",handleId:"ref_images"}).map(ie=>ie.source),Q=r1($),M=()=>Q?(Array.isArray(Q)?Q:[Q]).flatMap(pe=>pe&&pe.data&&Array.isArray(pe.data.outputImages)?pe.data.outputImages:[]):[];k.useEffect(()=>{A(M())},[Q]),k.useEffect(()=>{z(m.length),m.length>0&&c(m[Y].url)},[m,Y]),k.useEffect(()=>{C(e.prompt),j(e.aspect_ratio),D(e.num_images),G(e.model),y(e.images||[]),x(e.images_small||[])},[]),k.useEffect(()=>{a(t,{images:m,aspect_ratio:O,num_images:I,model:P,prompt:E,outputImages:m,images_small:_})},[m,O,I,P,E,_]);const q=300,X=200,[Z,J]=k.useState(""),ae=async ie=>{const oe=Math.min(q/ie.width,X/ie.height),pe=ie.width*oe,be=ie.height*oe,_e=document.createElement("canvas");_e.width=pe,_e.height=be;const Me=await F.resize(ie,_e,{unsharpAmount:80,unsharpRadius:.6,unsharpThreshold:2});return F.toBlob(Me,"image/jpeg",.85)},ce=async()=>{if(console.log("images:",m),m.length>0){const ie=await fetch(m[0].url,{mode:"cors"});if(!ie.ok)throw new Error(`Failed to fetch image: ${ie.status} ${ie.statusText}`);const oe=await ie.blob(),pe=URL.createObjectURL(oe),be=new Image;await new Promise((Je,pt)=>{be.onload=Je,be.onerror=pt,be.src=pe});const _e=await ae(be),Me=URL.createObjectURL(_e);J(Me),console.log(Me),console.log("Resized Blob size:",(_e.size/1024).toFixed(2),"KB"),URL.revokeObjectURL(pe);const fe=`public/small_images/resized_${Date.now()}.jpeg`,ve="shot_images",{data:Ie,error:Xe}=await Te.storage.from(ve).upload(fe,_e,{contentType:"image/jpeg",cacheControl:"3600",upsert:!1});if(Xe)return console.log("Upload Error:",Xe),Xe;{const{data:Je}=Te.storage.from(ve).getPublicUrl(fe);console.log("Upload successful:",Je.publicUrl),x(pt=>[...pt,{url:Je.publicUrl,path:fe}]),Te.from("movie_shots").update({pic:Je.publicUrl}).eq("id",s).then(({data:pt,error:it})=>{if(it){console.error(":",it);return}console.log(":",pt)})}}},de=async()=>{let ie={};console.log("referenceImages:",w),P==="fal-ai/nano-banana/edit"&&(ie={prompt:E,num_images:Number(I),aspect_ratio:O,output_format:"png",image_urls:w.map(oe=>oe!=null?oe.url:"")}),P==="fal-ai/nano-banana-pro/edit"&&(ie={prompt:e.prompt}),P==="fal-ai/bytedance/seedream/v4/edit"&&(ie={prompt:e.prompt}),console.log(ie);try{Id.fal.config({credentials:"d0f5c4fd-29b2-4024-bc64-a4719276c027:5b06c17b429cc06d2f5e044e95ca5164"});const oe=await Id.fal.subscribe(P,{input:ie,logs:!0,onQueueUpdate:pe=>{pe.status==="IN_PROGRESS"&&f(!0),pe.status==="SUCCEEDED"&&f(!1)},onResult:pe=>{console.log(pe)},onError:pe=>{console.error("Error:",pe),f(!1)}});c(null),console.log(oe.data),y(oe.data.images),H(0),f(!1),ce(oe.data.images)}catch(oe){console.error("Error:",oe),f(!1)}};return b.jsxs("div",{className:"txt-image-node-area",children:[b.jsxs("div",{className:"txt2img-handles-container",children:[b.jsx(Lt,{type:"target",position:we.Left,id:"ref_images"}),b.jsx(Lt,{type:"source",position:we.Right,id:"out_image"})]}),b.jsxs("div",{className:"txt2img-preview-container",children:[b.jsxs("div",{className:"txt2img-preview-header",children:[b.jsxs("div",{className:"txt2img-preview-title",children:["Image-",Y]}),b.jsx("div",{className:"txt2img-preview-controls",children:b.jsx("span",{className:"",children:P})})]}),b.jsxs("div",{className:"txt2img-preview-image",children:[b.jsx("div",{className:"txt2img-placeholder-image",style:N(),children:l?b.jsxs(b.Fragment,{children:[b.jsx("img",{src:l,alt:"Generated",style:B()}),b.jsx("button",{className:"embody-view-large-btn",onClick:()=>{console.log("currentImageUrl",l),Ft.emit("showLargeImageModal",l)},style:{position:"absolute",top:"8px",right:"8px",zIndex:10},children:""})]}):b.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",padding:"20px"},className:"txt2img-placeholder-text",children:""})}),m.length>1&&b.jsxs("div",{className:"txt2img-pagination",children:[b.jsx("button",{className:"txt2img-pagination-btn",onClick:()=>H(ie=>Math.max(ie-1,0)),children:""}),b.jsxs("span",{className:"txt2img-pagination-text",children:[Y+1," / ",V]}),b.jsx("button",{className:"txt2img-pagination-btn",onClick:()=>H(ie=>Math.min(ie+1,V-1)),children:""})]}),d&&b.jsxs("div",{className:"txt2img-loading-overlay",children:[b.jsx("div",{className:"txt2img-loading-spinner"}),b.jsx("span",{className:"txt2img-loading-text",children:"..."})]})]})]}),n&&b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"txt2img-prompt-container",children:b.jsx("textarea",{className:"txt2img-prompt-textarea",value:E,onChange:ie=>{const oe=ie.target.value;C(oe)},placeholder:"..."})}),b.jsxs("div",{className:"txt2img-reference-container",children:[b.jsxs("div",{className:"txt2img-reference-title",children:[" (",w.length,"/10)"]}),b.jsx("div",{className:"txt2img-reference-grid",children:w&&w.map((ie,oe)=>b.jsx("div",{className:"txt2img-reference-item",children:b.jsx("img",{src:ie.url||"",alt:`Reference ${oe+1}`})},oe))})]}),b.jsxs("div",{className:"txt2img-bottom-controls",children:[b.jsxs("div",{className:"txt2img-controls-left",children:[b.jsx("div",{className:"txt2img-control-group",children:b.jsxs("select",{value:P,onChange:ie=>{const oe=ie.target.value;G(oe)},className:"txt2img-control-select",children:[b.jsx("option",{value:"fal-ai/nano-banana/edit",children:"Nano Banana"}),b.jsx("option",{value:"fal-ai/nano-banana-pro/edit",children:"Nano Banana Pro"}),b.jsx("option",{value:"fal-ai/bytedance/seedream/v4/edit",children:"v4"})]})}),b.jsx("div",{className:"txt2img-control-group",children:b.jsxs("select",{value:O,onChange:ie=>{const oe=ie.target.value;j(oe)},className:"txt2img-control-select",children:[b.jsx("option",{value:"16:9",children:"16:9 "}),b.jsx("option",{value:"9:16",children:"9:16 "}),b.jsx("option",{value:"4:3",children:"4:3 "})]})}),b.jsx("div",{className:"txt2img-control-group",children:b.jsxs("select",{value:I,onChange:ie=>{const oe=ie.target.value;D(oe)},className:"txt2img-control-select",children:[b.jsx("option",{value:"1",children:"1"}),b.jsx("option",{value:"2",children:"2"}),b.jsx("option",{value:"3",children:"3"}),b.jsx("option",{value:"4",children:"4"})]})})]}),b.jsxs("div",{className:"txt2img-controls-right",children:[b.jsx("button",{onClick:ce,className:"txt2img-control-button",children:""}),b.jsx("button",{onClick:de,className:"txt2img-generate-button",children:""})]})]})]})]})}function c$({id:t,data:e,selected:n}){const{updateNodeData:s}=Jr(),[a,l]=k.useState(null),[c,d]=k.useState(!1),[f,h]=k.useState({}),[p,m]=k.useState(""),[y,_]=k.useState(""),[x,w]=k.useState([]),[A,S]=k.useState([0]),[T,E]=k.useState([]),[C,O]=k.useState(""),[j,I]=k.useState(""),[D,P]=k.useState(1),G={character:"",scene:"",item:""},z={...{characterName:"",characterDescription:"",imageUrl:"/default_avatar.png"},...e};k.useEffect(()=>{O(z.characterName),I(z.characterDescription)},[z]),k.useEffect(()=>{e.id&&Te.from("embodys").select(`
          *,
          embody_images(
            path
          )
        `).eq("id",e.id).single().then(N=>{h(N.data),m(N.data.name),_(G[N.data.type]||"");const B=N.data.embody_images.map($=>({path:$.path,url:_i+$.path}));B.length==0&&B.push({path:"/public/Common/default_charactar_big.png",url:"https://gsyznlwsezhwerypyzbe.supabase.co/storage/v1/object/public/embodys/public/Common/no_pic.png"}),w(B),S([0]),l(B[0].url),N.data.embody_images&&N.data.embody_images.length>0&&_i+N.data.embody_images[0].path;let U=[];e.outputImages&&e.outputImages.forEach($=>{for(let Q=0;Q<B.length;Q++)$.path==B[Q].path&&U.push(Q)}),U.length==0&&U.push(0),S(U)})},[t]),k.useEffect(()=>{x.length>0&&s(t,{outputImages:A.map(N=>x[N])})},[A]);const Y=()=>{console.log("")},H=N=>{S(B=>B.includes(N)?B.filter(U=>U!==N):[...B,N]),console.log(":",A)},F=N=>{if(N>=1&&N<=A.length&&(P(N),A.length>0)){let B=_i+x[A[N-1]].path;l(B)}};return b.jsxs("div",{className:"embody-node-area",children:[b.jsx("div",{className:"embody-handles-container",children:b.jsx(Lt,{type:"source",position:we.Right,id:"embody_out"})}),b.jsxs("div",{className:"embody-preview-container",children:[b.jsxs("div",{className:"embody-preview-header",children:[b.jsx("div",{className:"embody-preview-title",children:p||""}),b.jsx("span",{children:y||""}),b.jsx("div",{className:"embody-preview-controls",children:n&&b.jsx("button",{className:"embody-control-btn",onClick:Y,children:""})})]}),b.jsxs("div",{className:"embody-preview-image",children:[b.jsx("div",{className:"embody-placeholder-image",children:a?b.jsxs(b.Fragment,{children:[b.jsx("img",{src:a,alt:"Character Preview"}),b.jsx("button",{className:"embody-view-large-btn",onClick:()=>{console.log("currentImageUrl",a),Ft.emit("showLargeImageModal",a)},children:""})]}):b.jsx("div",{className:"embody-placeholder-text",children:""})}),c&&b.jsxs("div",{className:"embody-loading-overlay",children:[b.jsx("div",{className:"embody-loading-spinner"}),b.jsx("span",{className:"embody-loading-text",children:"..."})]}),A.length>1&&b.jsxs("div",{className:"embody-pagination",children:[b.jsx("button",{className:"embody-pagination-btn",onClick:()=>F(D-1),disabled:D===1,children:""}),b.jsxs("span",{className:"embody-pagination-text",children:[D," / ",A.length]}),b.jsx("button",{className:"embody-pagination-btn",onClick:()=>F(D+1),disabled:D===A.length,children:""})]})]})]}),n&&b.jsx(b.Fragment,{children:b.jsx("div",{className:"embody-info-container",children:b.jsxs("div",{className:"embody-info-item",children:[b.jsx("label",{className:"embody-info-label",children:""}),b.jsx("div",{className:"embody-info-images",children:x.map((N,B)=>b.jsxs("div",{className:`embody-info-image-item ${A.includes(B)?"selected":""}`,onClick:()=>H(B),children:[b.jsx("img",{src:_i+N.path,alt:`${B}`}),A.includes(B)&&b.jsx("div",{className:"embody-image-checkmark",children:""})]},B))})]})})})]})}function u$({id:t,data:e,selected:n}){const{updateNodeData:s}=Jr(),[a,l]=k.useState(null),[c,d]=k.useState(!1),[f,h]=k.useState([]),[p,m]=k.useState([]),[y,_]=k.useState(""),[x,w]=k.useState("blur, distort, and low quality"),[A,S]=k.useState(.5),[T,E]=k.useState(5),[C,O]=k.useState(24),[j,I]=k.useState("fal-ai/kling-video/v2.1/master/image-to-video"),[D,P]=k.useState(0),[G,V]=k.useState(0),[z,Y]=k.useState("");Jr();const H=()=>({paddingBottom:"56.25%",width:"100%",position:"relative",height:0,overflow:"hidden"}),F=()=>({position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"contain"}),B=Zg({handleType:"target",handleId:"ref_images"}).map(M=>M.source),U=r1(B),$=()=>U?(Array.isArray(U)?U:[U]).flatMap(X=>X&&X.data&&Array.isArray(X.data.outputImages)?X.data.outputImages:[]):[];k.useEffect(()=>{m($())},[U]),k.useEffect(()=>{P(f.length),f.length>0&&l(f[G].url)},[f,G]),k.useEffect(()=>{_(e.prompt||""),E(e.duration||5),I(e.model||"fal-ai/kling-video/v2.1/master/image-to-video"),h(e.videos||[]),w(e.negative_prompt||"blur, distort, and low quality"),S(e.cfg_scale||.5)},[]),k.useEffect(()=>{s(t,{videos:f,duration:T,fps:C,model:j,prompt:y,negative_prompt:x,cfg_scale:A})},[f,T,j,y,x,A]);const Q=async()=>{Y("");let M={};if(console.log("referenceImages:",p),!y.trim()){Y("");return}if(p.length===0){Y("");return}j==="fal-ai/kling-video/v2.5-turbo/pro/image-to-video"&&(M={prompt:y,negative_prompt:x,duration:T,cfg_scale:A,image_url:p[0].url}),console.log("model:",j),console.log("inputData:",M);try{Id.fal.config({credentials:"d0f5c4fd-29b2-4024-bc64-a4719276c027:5b06c17b429cc06d2f5e044e95ca5164"});const q=await Id.fal.subscribe(j,{input:M,logs:!0,onQueueUpdate:X=>{X.status==="IN_PROGRESS"&&d(!0),X.status==="SUCCEEDED"&&d(!1)},onResult:X=>{console.log(X)},onError:X=>{console.error("Error:",X),Y(": "+(X.message||"")),d(!1)}});l(null),console.log(q.data),h([q.data.video]),V(0),d(!1)}catch(q){console.error("Error:",q),Y(": "+(q.message||"")),d(!1)}};return b.jsxs("div",{className:"image2video-node-area",children:[b.jsxs("div",{className:"image2video-handles-container",children:[b.jsx(Lt,{type:"target",position:we.Left,id:"ref_images"}),b.jsx(Lt,{type:"source",position:we.Right,id:"video"})]}),b.jsxs("div",{className:"image2video-preview-container",children:[b.jsxs("div",{className:"image2video-preview-header",children:[b.jsxs("div",{className:"image2video-preview-title",children:["ref-",p.length]}),b.jsx("div",{className:"image2video-preview-controls",children:b.jsx("span",{className:"",children:j})})]}),z&&b.jsxs("div",{className:"image2video-error-message",children:[b.jsx("span",{className:"image2video-error-icon",children:""}),b.jsx("span",{className:"image2video-error-text",children:z}),b.jsx("button",{className:"image2video-error-close",onClick:()=>Y(""),children:""})]}),b.jsxs("div",{className:"image2video-preview-video",children:[b.jsx("div",{className:"image2video-placeholder-video",style:H(),children:a?b.jsxs(b.Fragment,{children:[b.jsx("video",{src:a,alt:"Generated Video",style:F(),controls:!0,autoPlay:!0,muted:!0}),b.jsx("button",{className:"embody-view-large-btn",onClick:()=>{console.log("currentVideoUrl",a),Ft.emit("showLargeVideoModal",a)},style:{position:"absolute",top:"8px",right:"8px",zIndex:10},children:""})]}):b.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",padding:"20px"},className:"image2video-placeholder-text",children:""})}),f.length>1&&b.jsxs("div",{className:"image2video-pagination",children:[b.jsx("button",{className:"image2video-pagination-btn",onClick:()=>V(M=>Math.max(M-1,0)),children:""}),b.jsxs("span",{className:"image2video-pagination-text",children:[G+1," / ",D]}),b.jsx("button",{className:"image2video-pagination-btn",onClick:()=>V(M=>Math.min(M+1,D-1)),children:""})]}),c&&b.jsxs("div",{className:"image2video-loading-overlay",children:[b.jsx("div",{className:"image2video-loading-spinner"}),b.jsx("span",{className:"image2video-loading-text",children:"..."})]})]})]}),n&&b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"image2video-prompt-container",children:b.jsx("textarea",{className:"image2video-prompt-textarea",value:y,onChange:M=>{const q=M.target.value;_(q)},placeholder:"..."})}),b.jsx("div",{className:"image2video-prompt-container",children:b.jsx("textarea",{className:"image2video-prompt-textarea",value:x,onChange:M=>{const q=M.target.value;w(q)},placeholder:"..."})}),b.jsxs("div",{className:"image2video-bottom-controls",children:[b.jsxs("div",{className:"image2video-controls-left",children:[b.jsx("div",{className:"image2video-control-group",children:b.jsxs("select",{value:j,onChange:M=>{const q=M.target.value;I(q)},className:"image2video-control-select",children:[b.jsx("option",{value:"fal-ai/kling-video/v2.5-turbo/pro/image-to-video",children:"kling-video/v2.5-turbo"}),b.jsx("option",{value:"fal-ai/kling-video/v2.1/master/image-to-video",children:"kling-video/v2.1/master"})]})}),b.jsx("div",{className:"image2video-control-group",children:b.jsx("input",{type:"number",value:T,onChange:M=>{const q=parseFloat(M.target.value);E(`${q}`)},className:"image2video-control-input",min:"5",max:"30",placeholder:" ()"})}),b.jsx("div",{className:"image2video-control-group",children:b.jsx("input",{type:"number",value:A,onChange:M=>{const q=parseFloat(M.target.value);S(isNaN(q)?.5:q)},className:"image2video-control-input",min:"0",max:"1",placeholder:" (CFG Scale)"})})]}),b.jsxs("div",{className:"image2video-controls-right",children:[b.jsx("button",{className:"image2video-control-button",children:""}),b.jsx("button",{disabled:c,onClick:Q,className:"image2video-generate-button",children:""})]})]})]})]})}const d$=({id:t,source:e,target:n,sourceX:s,sourceY:a,targetX:l,targetY:c,sourcePosition:d,targetPosition:f,selected:h,data:p})=>{const[m,y]=k.useMemo(()=>{const C=Fg({sourceX:s,sourceY:a,targetX:l,targetY:c,sourcePosition:d,targetPosition:f}),O=document.createElementNS("http://www.w3.org/2000/svg","path");O.setAttribute("d",C[0]),document.body.appendChild(O);const j=O.getTotalLength();return document.body.removeChild(O),[C[0],j]},[s,a,l,c,d,f]),[_,x]=k.useState(`${t}-animate`),[w,A]=k.useState(!0),S=Math.max(3,Math.min(8,y/5));k.useEffect(()=>{x(`${t}-animate-${Date.now()}`)},[t]);const T={stroke:h?"#ff4088":"#ff0072",strokeWidth:h?3:2,fill:"none",cursor:"pointer",transition:"stroke 0.2s, stroke-width 0.2s"},E={stroke:"white",strokeWidth:"3",fill:"none",strokeDasharray:"12, 8",strokeLinecap:"round",pointerEvents:"none"};return b.jsxs(b.Fragment,{children:[b.jsx("path",{id:t,d:m,className:`exec-edge ${h?"selected":""}`,style:T,onMouseEnter:C=>{C.currentTarget.style.stroke="#ff4088",C.currentTarget.style.strokeWidth="3"},onMouseLeave:C=>{C.currentTarget.style.stroke=h?"#ff4088":"#ff0072",C.currentTarget.style.strokeWidth=h?"3":"2"}}),w&&b.jsx("path",{id:_,d:m,className:"exec-edge-flow",style:{...E,animation:w?`flowAnimation ${S}s linear infinite`:"none",visibility:y>0?"visible":"hidden"}}),b.jsxs("defs",{children:[b.jsx("marker",{id:"exec-arrow",markerWidth:"10",markerHeight:"10",refX:"9",refY:"3",orient:"auto",markerUnits:"strokeWidth",children:b.jsx("path",{d:"M0,0 L0,6 L9,3 z",fill:"#ff0072"})}),b.jsx("style",{type:"text/css",children:`
            @keyframes flowAnimation {
              0% {
                stroke-dashoffset: 200; /*  */
              }
              100% {
                stroke-dashoffset: 0;
              }
            }
            
            .exec-edge-flow {
              /*  */
              filter: drop-shadow(0 0 2px rgba(255, 255, 255, 0.7));
              /*  */
              will-change: stroke-dashoffset;
            }
            
            /*  */
            .exec-edge.selected + .exec-edge-flow {
              stroke-width: 4; /*  */
              filter: drop-shadow(0 0 4px rgba(255, 255, 255, 0.9));
              animation-duration: 3s; /*  */
            }
          `})]})]})},f$=({position:t,visible:e,onClose:n,onAddTxt2ImgNode:s,onAddImage2VideoNode:a,onAddEmbodyNode:l})=>{const c=k.useRef(null);return k.useEffect(()=>{const d=h=>{c.current&&!c.current.contains(h.target)&&n()},f=h=>{h.key==="Escape"&&n()};return e&&(document.addEventListener("mousedown",d),document.addEventListener("keydown",f)),()=>{document.removeEventListener("mousedown",d),document.removeEventListener("keydown",f)}},[e,n]),e?b.jsx("div",{ref:c,className:"context-menu",style:{position:"fixed",left:`${t.x}px`,top:`${t.y}px`,zIndex:1e3},children:b.jsxs("ul",{children:[b.jsx("li",{onClick:s,children:""}),b.jsx("li",{onClick:a,children:""}),b.jsx("li",{onClick:l,children:""})]})}):null};function h$(){const{projectId:t,ep_id:e,editShotId:n,setEditShotId:s}=_r(),[a,l]=k.useState(!1),[c,d]=k.useState(!1),[f,h]=k.useState([]),[p,m]=k.useState({}),[y,_]=k.useState([]),[x,w]=k.useState(null),[A,S]=k.useState(!1),[T,E]=k.useState({x:0,y:0}),[C,O]=k.useState(null),j=async()=>{const{data:J,error:ae}=await Te.from("movie_scs").select(`
          *,
          movie_seqs(
            *,
            movie_shots(
              *,
              flows(
                *
              )
            )
          ).order('index', { ascending: true })
        `).order("index",{ascending:!0}).eq("ep_id",e);if(ae){console.error(":",ae);return}console.log(":",J),J.forEach(ce=>{ce.movie_seqs.forEach(de=>{de.movie_shots.sort((ie,oe)=>ie.index-oe.index),de.movie_shots.forEach(ie=>{p[ie.id]=ie})})}),h(J)},I=J=>{s(J.id)},D=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(J){var ae=Math.random()*16|0,ce=J==="x"?ae:ae&3|8;return ce.toString(16)}),P=J=>{console.log("setupInitNodes:",J);const ae=D();let ce=[],de=[];ce.push({id:ae,type:"txt2imgNode",position:{x:900,y:100},data:{prompt:J.prompt,num_images:1,aspect_ratio:"16:9",model:"fal-ai/nano-banana/edit",images:[]},selected:x==="0",style:{border:x==="0"?"2px solid #3b82f6":"none"}});for(let ie=0;ie<J.embodys.length;ie++){const oe=J.embodys[ie],pe=D();ce.push({id:pe,type:"embodyNode",position:{x:100,y:500*ie},data:{id:oe,selected:x===pe},selected:x===pe,style:{border:x===pe?"2px solid #3b82f6":"none"}}),de.push({id:D(),source:pe,sourceHandle:"embody_out",target:ae,targetHandle:"ref_images",type:"default",data:{}})}_(ce),V(de)};k.useEffect(()=>{console.log("editShotId:",n),n||console.log("editShotId "),j(),console.log(p[n]),n?Te.from("movie_shots").select(`
      *,
      flows(
        *
      )
    `).eq("id",n).single().then(J=>{console.log("shot:",J.data),_(null),V(null),p[n]=J.data,J.data.flows||d(J.data.flows.length>0),J.data.flows.length>0?(_(JSON.parse(J.data.flows[0].nodes)),V(JSON.parse(J.data.flows[0].edges))):P(J.data)}):console.log("editShotId  ReactFLow")},[n]),k.useEffect(()=>{},[y]);const[G,V]=k.useState([]),z={shotNodeInput:t$,consoleNode:r$,shotNodeOutput:s$,txt2imgNode:l$,embodyNode:c$,image2videoNode:u$},Y={execEdge:d$},H=J=>{l(!0),V(ae=>{if(J.target==="2"&&ae.some(ie=>ie.target==="2"))return console.warn("ConsoleNode"),ae;const ce={...J,type:J.sourceHandle==="exec-out"&&J.targetHandle==="exec-in"?"execEdge":"default"};return hS(ce,ae)})},F=()=>{a&&(c?(console.log("flow"),Te.from("flows").update({nodes:JSON.stringify(y),edges:JSON.stringify(G)}).eq("shot_id",n).select("*").then(J=>{J.error?console.error(":",J.error.message):(l(!1),d(!0))})):(d(!0),Te.from("flows").insert({shot_id:n,nodes:JSON.stringify(y),edges:JSON.stringify(G)}).then(J=>{J.error?console.error(":",J.error.message):l(!1)})))};k.useEffect(()=>{const J=setInterval(()=>{F()},1e3);return()=>clearInterval(J)},[y,G,a]),k.useEffect(()=>{const J=ae=>{if(ae.key==="Delete"){const ce=y.filter(oe=>oe.selected),de=G.filter(oe=>oe.selected);let ie=!1;if(ce.length>0){const oe=y.filter(_e=>!_e.selected);_(oe),ie=!0;const pe=ce.map(_e=>_e.id),be=G.filter(_e=>!pe.includes(_e.source)&&!pe.includes(_e.target));V(be)}else if(de.length>0){const oe=G.filter(pe=>!pe.selected);V(oe),ie=!0}ie&&l(!0)}};return window.addEventListener("keydown",J),()=>window.removeEventListener("keydown",J)},[y,G]);const N=(J,ae)=>{J.stopPropagation();const ce=ae.id;w(ce),_(de=>de.map(ie=>({...ie,selected:ie.id===ce,style:{...ie.style,border:ie.id===ce?"2px solid #3b82f6":"none"}}))),console.log(":",ce)},B=(J,ae)=>{J.preventDefault(),ae||(E({x:J.clientX,y:J.clientY}),S(!0))},U=()=>{S(!1)},$=()=>(y.reduce((ae,ce)=>{const de=parseInt(ce.id);return isNaN(de)?ae:Math.max(ae,de)},0)+1).toString(),Q=()=>{if(C){const J=C.screenToFlowPosition(T),ae={id:$(),type:"txt2imgNode",position:{x:J.x-40,y:J.y-50},data:{prompt:"",imageUrl:null},selected:!1,style:{border:"none"}};_(ce=>[...ce,ae]),console.log(":",ae.id)}U()},M=()=>{if(C){const J=C.screenToFlowPosition(T),ae={id:$(),type:"image2videoNode",position:{x:J.x-40,y:J.y-50},data:{prompt:"",imageUrl:null},selected:!1,style:{border:"none"}};_(ce=>[...ce,ae]),console.log(":",ae.id)}U()},q=()=>{if(C){const J=C.screenToFlowPosition(T),ae={id:$(),type:"embodyNode",position:{x:J.x-40,y:J.y-50},data:{characterName:"",characterDescription:"",imageUrl:null},selected:!1,style:{border:"none"}};_(ce=>[...ce,ae]),console.log(":",ae.id)}U()},X=k.useCallback(J=>{V(ae=>kS(J,ae)),l(!0)},[]),Z=k.useCallback(J=>{_(ae=>IS(J,ae)),l(!0)},[]);return b.jsxs("div",{className:"editor-flow-container",children:[b.jsx("div",{className:"story-nav",children:b.jsx("div",{className:"flow-nav-info",children:f.map(J=>b.jsxs("div",{className:"flow-nav-sc-card",children:[b.jsx("div",{className:"flow-nav-sc-name",children:b.jsx("p",{children:J.name})}),b.jsx("div",{className:"flow-nav-sc-content",children:J.movie_seqs.map(ae=>b.jsxs("div",{className:"flow-nav-seq-card",children:[b.jsx("div",{className:"flow-nav-seq-name",children:b.jsx("p",{children:ae.name})}),b.jsx("div",{className:"flow-nav-seq-content",children:ae.movie_shots.map(ce=>b.jsx("div",{className:`flow-nav-shot-card ${n===ce.id?"nav-selected-shot":""}`,onClick:()=>I(ce),children:b.jsx("div",{className:"flow-nav-shot-thumb",children:b.jsx("img",{src:ce.pic?ce.pic:"./shot_thumb_default.png"})})},ce.id))})]},ae.id))})]},J.id))})}),b.jsxs("div",{className:"flow-editor",children:[b.jsxs(CL,{nodes:y,edges:G,nodeTypes:z,edgeTypes:Y,onConnect:H,onEdgesChange:X,onNodesChange:Z,onNodeClick:N,defaultViewport:{x:0,y:0,zoom:.6},onPaneClick:()=>{w(null),U(),_(J=>J.map(ae=>({...ae,selected:!1,style:{...ae.style,border:"none"}})))},onContextMenu:B,onInit:O,attributionPosition:"bottom-right",children:[b.jsx($L,{}),b.jsx(IL,{variant:"dots",gap:20,size:1,strokeColor:"#333"})]}),b.jsx(f$,{position:T,visible:A,onClose:U,onAddTxt2ImgNode:Q,onAddImage2VideoNode:M,onAddEmbodyNode:q})]})]})}function Ue(t,e,n,s,a){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}function re(t,e,n,s){if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?s:n==="a"?s.call(t):s?s.value:e.get(t)}let c1=function(){const{crypto:t}=globalThis;if(t?.randomUUID)return c1=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,s=>(+s^n()&15>>+s/4).toString(16))};function rg(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const sg=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};class je extends Error{}class Gt extends je{constructor(e,n,s,a){super(`${Gt.makeMessage(e,n,s)}`),this.status=e,this.headers=a,this.requestID=a?.get("x-request-id"),this.error=n;const l=n;this.code=l?.code,this.param=l?.param,this.type=l?.type}static makeMessage(e,n,s){const a=n?.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):s;return e&&a?`${e} ${a}`:e?`${e} status code (no body)`:a||"(no status code or body)"}static generate(e,n,s,a){if(!e||!a)return new vf({message:s,cause:sg(n)});const l=n?.error;return e===400?new u1(e,l,s,a):e===401?new d1(e,l,s,a):e===403?new f1(e,l,s,a):e===404?new h1(e,l,s,a):e===409?new m1(e,l,s,a):e===422?new p1(e,l,s,a):e===429?new g1(e,l,s,a):e>=500?new y1(e,l,s,a):new Gt(e,l,s,a)}}class qn extends Gt{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class vf extends Gt{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class ey extends vf{constructor({message:e}={}){super({message:e??"Request timed out."})}}class u1 extends Gt{}class d1 extends Gt{}class f1 extends Gt{}class h1 extends Gt{}class m1 extends Gt{}class p1 extends Gt{}class g1 extends Gt{}class y1 extends Gt{}class v1 extends je{constructor(){super("Could not parse response content as the length limit was reached")}}class _1 extends je{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class ml extends Error{constructor(e){super(e)}}const m$=/^[a-z][a-z0-9+.-]*:/i,p$=t=>m$.test(t);let fn=t=>(fn=Array.isArray,fn(t)),xx=fn;function b1(t){return typeof t!="object"?{}:t??{}}function g$(t){if(!t)return!0;for(const e in t)return!1;return!0}function y$(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function vp(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}const v$=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new je(`${t} must be an integer`);if(e<0)throw new je(`${t} must be a positive integer`);return e},_$=t=>{try{return JSON.parse(t)}catch{return}},oc=t=>new Promise(e=>setTimeout(e,t)),Ia="6.9.1",b$=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function w$(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const x$=()=>{const t=w$();if(t==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ia,"X-Stainless-OS":Ex(Deno.build.os),"X-Stainless-Arch":Ax(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ia,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(t==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ia,"X-Stainless-OS":Ex(globalThis.process.platform??"unknown"),"X-Stainless-Arch":Ax(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const e=A$();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ia,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ia,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function A$(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const s=n.exec(navigator.userAgent);if(s){const a=s[1]||0,l=s[2]||0,c=s[3]||0;return{browser:e,version:`${a}.${l}.${c}`}}}return null}const Ax=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",Ex=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let Sx;const E$=()=>Sx??(Sx=x$());function S$(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function w1(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function x1(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return w1({start(){},async pull(n){const{done:s,value:a}=await e.next();s?n.close():n.enqueue(a)},async cancel(){await e.return?.()}})}function A1(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n?.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function C$(t){if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await t[Symbol.asyncIterator]().return?.();return}const e=t.getReader(),n=e.cancel();e.releaseLock(),await n}const T$=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)}),E1="RFC3986",S1=t=>String(t),Cx={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:S1},N$="RFC1738";let ig=(t,e)=>(ig=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),ig(t,e));const fr=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),_p=1024,R$=(t,e,n,s,a)=>{if(t.length===0)return t;let l=t;if(typeof t=="symbol"?l=Symbol.prototype.toString.call(t):typeof t!="string"&&(l=String(t)),n==="iso-8859-1")return escape(l).replace(/%u[0-9a-f]{4}/gi,function(d){return"%26%23"+parseInt(d.slice(2),16)+"%3B"});let c="";for(let d=0;d<l.length;d+=_p){const f=l.length>=_p?l.slice(d,d+_p):l,h=[];for(let p=0;p<f.length;++p){let m=f.charCodeAt(p);if(m===45||m===46||m===95||m===126||m>=48&&m<=57||m>=65&&m<=90||m>=97&&m<=122||a===N$&&(m===40||m===41)){h[h.length]=f.charAt(p);continue}if(m<128){h[h.length]=fr[m];continue}if(m<2048){h[h.length]=fr[192|m>>6]+fr[128|m&63];continue}if(m<55296||m>=57344){h[h.length]=fr[224|m>>12]+fr[128|m>>6&63]+fr[128|m&63];continue}p+=1,m=65536+((m&1023)<<10|f.charCodeAt(p)&1023),h[h.length]=fr[240|m>>18]+fr[128|m>>12&63]+fr[128|m>>6&63]+fr[128|m&63]}c+=h.join("")}return c};function O$(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function Tx(t,e){if(fn(t)){const n=[];for(let s=0;s<t.length;s+=1)n.push(e(t[s]));return n}return e(t)}const C1={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},T1=function(t,e){Array.prototype.push.apply(t,fn(e)?e:[e])};let Nx;const Dt={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:R$,encodeValuesOnly:!1,format:E1,formatter:S1,indices:!1,serializeDate(t){return(Nx??(Nx=Function.prototype.call.bind(Date.prototype.toISOString)))(t)},skipNulls:!1,strictNullHandling:!1};function j$(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const bp={};function N1(t,e,n,s,a,l,c,d,f,h,p,m,y,_,x,w,A,S){let T=t,E=S,C=0,O=!1;for(;(E=E.get(bp))!==void 0&&!O;){const G=E.get(t);if(C+=1,typeof G<"u"){if(G===C)throw new RangeError("Cyclic object value");O=!0}typeof E.get(bp)>"u"&&(C=0)}if(typeof h=="function"?T=h(e,T):T instanceof Date?T=y?.(T):n==="comma"&&fn(T)&&(T=Tx(T,function(G){return G instanceof Date?y?.(G):G})),T===null){if(l)return f&&!w?f(e,Dt.encoder,A,"key",_):e;T=""}if(j$(T)||O$(T)){if(f){const G=w?e:f(e,Dt.encoder,A,"key",_);return[x?.(G)+"="+x?.(f(T,Dt.encoder,A,"value",_))]}return[x?.(e)+"="+x?.(String(T))]}const j=[];if(typeof T>"u")return j;let I;if(n==="comma"&&fn(T))w&&f&&(T=Tx(T,f)),I=[{value:T.length>0?T.join(",")||null:void 0}];else if(fn(h))I=h;else{const G=Object.keys(T);I=p?G.sort(p):G}const D=d?String(e).replace(/\./g,"%2E"):String(e),P=s&&fn(T)&&T.length===1?D+"[]":D;if(a&&fn(T)&&T.length===0)return P+"[]";for(let G=0;G<I.length;++G){const V=I[G],z=typeof V=="object"&&typeof V.value<"u"?V.value:T[V];if(c&&z===null)continue;const Y=m&&d?V.replace(/\./g,"%2E"):V,H=fn(T)?typeof n=="function"?n(P,Y):P:P+(m?"."+Y:"["+Y+"]");S.set(t,C);const F=new WeakMap;F.set(bp,S),T1(j,N1(z,H,n,s,a,l,c,d,n==="comma"&&w&&fn(T)?null:f,h,p,m,y,_,x,w,A,F))}return j}function I$(t=Dt){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||Dt.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=E1;if(typeof t.format<"u"){if(!ig(Cx,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const s=Cx[n];let a=Dt.filter;(typeof t.filter=="function"||fn(t.filter))&&(a=t.filter);let l;if(t.arrayFormat&&t.arrayFormat in C1?l=t.arrayFormat:"indices"in t?l=t.indices?"indices":"repeat":l=Dt.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const c=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:Dt.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:Dt.addQueryPrefix,allowDots:c,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:Dt.allowEmptyArrays,arrayFormat:l,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Dt.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?Dt.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:Dt.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:Dt.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:Dt.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:Dt.encodeValuesOnly,filter:a,format:n,formatter:s,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:Dt.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:Dt.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Dt.strictNullHandling}}function k$(t,e={}){let n=t;const s=I$(e);let a,l;typeof s.filter=="function"?(l=s.filter,n=l("",n)):fn(s.filter)&&(l=s.filter,a=l);const c=[];if(typeof n!="object"||n===null)return"";const d=C1[s.arrayFormat],f=d==="comma"&&s.commaRoundTrip;a||(a=Object.keys(n)),s.sort&&a.sort(s.sort);const h=new WeakMap;for(let y=0;y<a.length;++y){const _=a[y];s.skipNulls&&n[_]===null||T1(c,N1(n[_],_,d,f,s.allowEmptyArrays,s.strictNullHandling,s.skipNulls,s.encodeDotInKeys,s.encode?s.encoder:null,s.filter,s.sort,s.allowDots,s.serializeDate,s.format,s.formatter,s.encodeValuesOnly,s.charset,h))}const p=c.join(s.delimiter);let m=s.addQueryPrefix===!0?"?":"";return s.charsetSentinel&&(s.charset==="iso-8859-1"?m+="utf8=%26%2310003%3B&":m+="utf8=%E2%9C%93&"),p.length>0?m+p:""}function M$(t){let e=0;for(const a of t)e+=a.length;const n=new Uint8Array(e);let s=0;for(const a of t)n.set(a,s),s+=a.length;return n}let Rx;function ty(t){let e;return(Rx??(e=new globalThis.TextEncoder,Rx=e.encode.bind(e)))(t)}let Ox;function jx(t){let e;return(Ox??(e=new globalThis.TextDecoder,Ox=e.decode.bind(e)))(t)}var Sn,Cn;class _f{constructor(){Sn.set(this,void 0),Cn.set(this,void 0),Ue(this,Sn,new Uint8Array),Ue(this,Cn,null)}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?ty(e):e;Ue(this,Sn,M$([re(this,Sn,"f"),n]));const s=[];let a;for(;(a=D$(re(this,Sn,"f"),re(this,Cn,"f")))!=null;){if(a.carriage&&re(this,Cn,"f")==null){Ue(this,Cn,a.index);continue}if(re(this,Cn,"f")!=null&&(a.index!==re(this,Cn,"f")+1||a.carriage)){s.push(jx(re(this,Sn,"f").subarray(0,re(this,Cn,"f")-1))),Ue(this,Sn,re(this,Sn,"f").subarray(re(this,Cn,"f"))),Ue(this,Cn,null);continue}const l=re(this,Cn,"f")!==null?a.preceding-1:a.preceding,c=jx(re(this,Sn,"f").subarray(0,l));s.push(c),Ue(this,Sn,re(this,Sn,"f").subarray(a.index)),Ue(this,Cn,null)}return s}flush(){return re(this,Sn,"f").length?this.decode(`
`):[]}}Sn=new WeakMap,Cn=new WeakMap;_f.NEWLINE_CHARS=new Set([`
`,"\r"]);_f.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function D$(t,e){for(let a=e??0;a<t.length;a++){if(t[a]===10)return{preceding:a,index:a+1,carriage:!1};if(t[a]===13)return{preceding:a,index:a+1,carriage:!0}}return null}function B$(t){for(let s=0;s<t.length-1;s++){if(t[s]===10&&t[s+1]===10||t[s]===13&&t[s+1]===13)return s+2;if(t[s]===13&&t[s+1]===10&&s+3<t.length&&t[s+2]===13&&t[s+3]===10)return s+4}return-1}const Qd={off:0,error:200,warn:300,info:400,debug:500},Ix=(t,e,n)=>{if(t){if(y$(Qd,t))return t;Qt(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(Qd))}`)}};function pl(){}function nd(t,e,n){return!e||Qd[t]>Qd[n]?pl:e[t].bind(e)}const U$={error:pl,warn:pl,info:pl,debug:pl};let kx=new WeakMap;function Qt(t){const e=t.logger,n=t.logLevel??"off";if(!e)return U$;const s=kx.get(e);if(s&&s[0]===n)return s[1];const a={error:nd("error",e,n),warn:nd("warn",e,n),info:nd("info",e,n),debug:nd("debug",e,n)};return kx.set(e,[n,a]),a}const mi=t=>(t.options&&(t.options={...t.options},delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);var cl;class pr{constructor(e,n,s){this.iterator=e,cl.set(this,void 0),this.controller=n,Ue(this,cl,s)}static fromSSEResponse(e,n,s){let a=!1;const l=s?Qt(s):console;async function*c(){if(a)throw new je("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let d=!1;try{for await(const f of L$(e,n))if(!d){if(f.data.startsWith("[DONE]")){d=!0;continue}if(f.event===null||!f.event.startsWith("thread.")){let h;try{h=JSON.parse(f.data)}catch(p){throw l.error("Could not parse message into JSON:",f.data),l.error("From chunk:",f.raw),p}if(h&&h.error)throw new Gt(void 0,h.error,void 0,e.headers);yield h}else{let h;try{h=JSON.parse(f.data)}catch(p){throw console.error("Could not parse message into JSON:",f.data),console.error("From chunk:",f.raw),p}if(f.event=="error")throw new Gt(void 0,h.error,h.message,void 0);yield{event:f.event,data:h}}}d=!0}catch(f){if(rg(f))return;throw f}finally{d||n.abort()}}return new pr(c,n,s)}static fromReadableStream(e,n,s){let a=!1;async function*l(){const d=new _f,f=A1(e);for await(const h of f)for(const p of d.decode(h))yield p;for(const h of d.flush())yield h}async function*c(){if(a)throw new je("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let d=!1;try{for await(const f of l())d||f&&(yield JSON.parse(f));d=!0}catch(f){if(rg(f))return;throw f}finally{d||n.abort()}}return new pr(c,n,s)}[(cl=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const e=[],n=[],s=this.iterator(),a=l=>({next:()=>{if(l.length===0){const c=s.next();e.push(c),n.push(c)}return l.shift()}});return[new pr(()=>a(e),this.controller,re(this,cl,"f")),new pr(()=>a(n),this.controller,re(this,cl,"f"))]}toReadableStream(){const e=this;let n;return w1({async start(){n=e[Symbol.asyncIterator]()},async pull(s){try{const{value:a,done:l}=await n.next();if(l)return s.close();const c=ty(JSON.stringify(a)+`
`);s.enqueue(c)}catch(a){s.error(a)}},async cancel(){await n.return?.()}})}}async function*L$(t,e){if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new je("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new je("Attempted to iterate over a response with no body");const n=new z$,s=new _f,a=A1(t.body);for await(const l of $$(a))for(const c of s.decode(l)){const d=n.decode(c);d&&(yield d)}for(const l of s.flush()){const c=n.decode(l);c&&(yield c)}}async function*$$(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const s=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?ty(n):n;let a=new Uint8Array(e.length+s.length);a.set(e),a.set(s,e.length),e=a;let l;for(;(l=B$(e))!==-1;)yield e.slice(0,l),e=e.slice(l)}e.length>0&&(yield e)}class z${constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const l={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],l}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,s,a]=P$(e,":");return a.startsWith(" ")&&(a=a.substring(1)),n==="event"?this.event=a:n==="data"&&this.data.push(a),null}}function P$(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}async function R1(t,e){const{response:n,requestLogID:s,retryOfRequestLogID:a,startTime:l}=e,c=await(async()=>{if(e.options.stream)return Qt(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):pr.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const f=n.headers.get("content-type")?.split(";")[0]?.trim();if(f?.includes("application/json")||f?.endsWith("+json")){const m=await n.json();return O1(m,n)}return await n.text()})();return Qt(t).debug(`[${s}] response parsed`,mi({retryOfRequestLogID:a,url:n.url,status:n.status,body:c,durationMs:Date.now()-l})),c}function O1(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}var gl;class bf extends Promise{constructor(e,n,s=R1){super(a=>{a(null)}),this.responsePromise=n,this.parseResponse=s,gl.set(this,void 0),Ue(this,gl,e)}_thenUnwrap(e){return new bf(re(this,gl,"f"),this.responsePromise,async(n,s)=>O1(e(await this.parseResponse(n,s),s),s.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(re(this,gl,"f"),e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}gl=new WeakMap;var rd;class ny{constructor(e,n,s,a){rd.set(this,void 0),Ue(this,rd,e),this.options=a,this.response=n,this.body=s}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const e=this.nextPageRequestOptions();if(!e)throw new je("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await re(this,rd,"f").requestAPIList(this.constructor,e)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(rd=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class H$ extends bf{constructor(e,n,s){super(e,n,async(a,l)=>new s(a,l.response,await R1(a,l),l.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}class wf extends ny{constructor(e,n,s,a){super(e,n,s,a),this.data=s.data||[],this.object=s.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class Rt extends ny{constructor(e,n,s,a){super(e,n,s,a),this.data=s.data||[],this.has_more=s.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const e=this.getPaginatedItems(),n=e[e.length-1]?.id;return n?{...this.options,query:{...b1(this.options.query),after:n}}:null}}class Vd extends ny{constructor(e,n,s,a){super(e,n,s,a),this.data=s.data||[],this.has_more=s.has_more||!1,this.last_id=s.last_id||""}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const e=this.last_id;return e?{...this.options,query:{...b1(this.options.query),after:e}}:null}}const j1=()=>{if(typeof File>"u"){const{process:t}=globalThis,e=typeof t?.versions?.node=="string"&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(e?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Rl(t,e,n){return j1(),new File(t,e??"unknown_file",n)}function yd(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const ry=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",Mx=async(t,e)=>ag(t.body)?{...t,body:await I1(t.body,e)}:t,Ri=async(t,e)=>({...t,body:await I1(t.body,e)}),Dx=new WeakMap;function q$(t){const e=typeof t=="function"?t:t.fetch,n=Dx.get(e);if(n)return n;const s=(async()=>{try{const a="Response"in e?e.Response:(await e("data:,")).constructor,l=new FormData;return l.toString()!==await new a(l).text()}catch{return!0}})();return Dx.set(e,s),s}const I1=async(t,e)=>{if(!await q$(e))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const n=new FormData;return await Promise.all(Object.entries(t||{}).map(([s,a])=>og(n,s,a))),n},k1=t=>t instanceof Blob&&"name"in t,Q$=t=>typeof t=="object"&&t!==null&&(t instanceof Response||ry(t)||k1(t)),ag=t=>{if(Q$(t))return!0;if(Array.isArray(t))return t.some(ag);if(t&&typeof t=="object"){for(const e in t)if(ag(t[e]))return!0}return!1},og=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(n instanceof Response)t.append(e,Rl([await n.blob()],yd(n)));else if(ry(n))t.append(e,Rl([await new Response(x1(n)).blob()],yd(n)));else if(k1(n))t.append(e,n,yd(n));else if(Array.isArray(n))await Promise.all(n.map(s=>og(t,e+"[]",s)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([s,a])=>og(t,`${e}[${s}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}},M1=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",V$=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&M1(t),F$=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function G$(t,e,n){if(j1(),t=await t,V$(t))return t instanceof File?t:Rl([await t.arrayBuffer()],t.name);if(F$(t)){const a=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),Rl(await lg(a),e,n)}const s=await lg(t);if(e||(e=yd(t)),!n?.type){const a=s.find(l=>typeof l=="object"&&"type"in l&&l.type);typeof a=="string"&&(n={...n,type:a})}return Rl(s,e,n)}async function lg(t){let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(M1(t))e.push(t instanceof Blob?t:await t.arrayBuffer());else if(ry(t))for await(const n of t)e.push(...await lg(n));else{const n=t?.constructor?.name;throw new Error(`Unexpected data type: ${typeof t}${n?`; constructor: ${n}`:""}${Y$(t)}`)}return e}function Y$(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}class Ne{constructor(e){this._client=e}}function D1(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Bx=Object.freeze(Object.create(null)),X$=(t=D1)=>function(n,...s){if(n.length===1)return n[0];let a=!1;const l=[],c=n.reduce((p,m,y)=>{/[?#]/.test(m)&&(a=!0);const _=s[y];let x=(a?encodeURIComponent:t)(""+_);return y!==s.length&&(_==null||typeof _=="object"&&_.toString===Object.getPrototypeOf(Object.getPrototypeOf(_.hasOwnProperty??Bx)??Bx)?.toString)&&(x=_+"",l.push({start:p.length+m.length,length:x.length,error:`Value of type ${Object.prototype.toString.call(_).slice(8,-1)} is not a valid path parameter`})),p+m+(y===s.length?"":x)},""),d=c.split(/[?#]/,1)[0],f=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let h;for(;(h=f.exec(d))!==null;)l.push({start:h.index,length:h[0].length,error:`Value "${h[0]}" can't be safely passed as a path parameter`});if(l.sort((p,m)=>p.start-m.start),l.length>0){let p=0;const m=l.reduce((y,_)=>{const x=" ".repeat(_.start-p),w="^".repeat(_.length);return p=_.start+_.length,y+x+w},"");throw new je(`Path parameters result in path with invalid segments:
${l.map(y=>y.error).join(`
`)}
${c}
${m}`)}return c},ye=X$(D1);let B1=class extends Ne{list(e,n={},s){return this._client.getAPIList(ye`/chat/completions/${e}/messages`,Rt,{query:n,...s})}};function Fd(t){return t!==void 0&&"function"in t&&t.function!==void 0}function sy(t){return t?.$brand==="auto-parseable-response-format"}function lc(t){return t?.$brand==="auto-parseable-tool"}function K$(t,e){return!e||!U1(e)?{...t,choices:t.choices.map(n=>(L1(n.message.tool_calls),{...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:iy(t,e)}function iy(t,e){const n=t.choices.map(s=>{if(s.finish_reason==="length")throw new v1;if(s.finish_reason==="content_filter")throw new _1;return L1(s.message.tool_calls),{...s,message:{...s.message,...s.message.tool_calls?{tool_calls:s.message.tool_calls?.map(a=>J$(e,a))??void 0}:void 0,parsed:s.message.content&&!s.message.refusal?W$(e,s.message.content):null}}});return{...t,choices:n}}function W$(t,e){return t.response_format?.type!=="json_schema"?null:t.response_format?.type==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function J$(t,e){const n=t.tools?.find(s=>Fd(s)&&s.function?.name===e.function.name);return{...e,function:{...e.function,parsed_arguments:lc(n)?n.$parseRaw(e.function.arguments):n?.function.strict?JSON.parse(e.function.arguments):null}}}function Z$(t,e){if(!t||!("tools"in t)||!t.tools)return!1;const n=t.tools?.find(s=>Fd(s)&&s.function?.name===e.function.name);return Fd(n)&&(lc(n)||n?.function.strict||!1)}function U1(t){return sy(t.response_format)?!0:t.tools?.some(e=>lc(e)||e.type==="function"&&e.function.strict===!0)??!1}function L1(t){for(const e of t||[])if(e.type!=="function")throw new je(`Currently only \`function\` tool calls are supported; Received \`${e.type}\``)}function ez(t){for(const e of t??[]){if(e.type!=="function")throw new je(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new je(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}const Gd=t=>t?.role==="assistant",$1=t=>t?.role==="tool";var cg,vd,_d,yl,vl,bd,_l,Fr,bl,Yd,Xd,ka,z1;class ay{constructor(){cg.add(this),this.controller=new AbortController,vd.set(this,void 0),_d.set(this,()=>{}),yl.set(this,()=>{}),vl.set(this,void 0),bd.set(this,()=>{}),_l.set(this,()=>{}),Fr.set(this,{}),bl.set(this,!1),Yd.set(this,!1),Xd.set(this,!1),ka.set(this,!1),Ue(this,vd,new Promise((e,n)=>{Ue(this,_d,e,"f"),Ue(this,yl,n,"f")})),Ue(this,vl,new Promise((e,n)=>{Ue(this,bd,e,"f"),Ue(this,_l,n,"f")})),re(this,vd,"f").catch(()=>{}),re(this,vl,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},re(this,cg,"m",z1).bind(this))},0)}_connected(){this.ended||(re(this,_d,"f").call(this),this._emit("connect"))}get ended(){return re(this,bl,"f")}get errored(){return re(this,Yd,"f")}get aborted(){return re(this,Xd,"f")}abort(){this.controller.abort()}on(e,n){return(re(this,Fr,"f")[e]||(re(this,Fr,"f")[e]=[])).push({listener:n}),this}off(e,n){const s=re(this,Fr,"f")[e];if(!s)return this;const a=s.findIndex(l=>l.listener===n);return a>=0&&s.splice(a,1),this}once(e,n){return(re(this,Fr,"f")[e]||(re(this,Fr,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,s)=>{Ue(this,ka,!0),e!=="error"&&this.once("error",s),this.once(e,n)})}async done(){Ue(this,ka,!0),await re(this,vl,"f")}_emit(e,...n){if(re(this,bl,"f"))return;e==="end"&&(Ue(this,bl,!0),re(this,bd,"f").call(this));const s=re(this,Fr,"f")[e];if(s&&(re(this,Fr,"f")[e]=s.filter(a=>!a.once),s.forEach(({listener:a})=>a(...n))),e==="abort"){const a=n[0];!re(this,ka,"f")&&!s?.length&&Promise.reject(a),re(this,yl,"f").call(this,a),re(this,_l,"f").call(this,a),this._emit("end");return}if(e==="error"){const a=n[0];!re(this,ka,"f")&&!s?.length&&Promise.reject(a),re(this,yl,"f").call(this,a),re(this,_l,"f").call(this,a),this._emit("end")}}_emitFinal(){}}vd=new WeakMap,_d=new WeakMap,yl=new WeakMap,vl=new WeakMap,bd=new WeakMap,_l=new WeakMap,Fr=new WeakMap,bl=new WeakMap,Yd=new WeakMap,Xd=new WeakMap,ka=new WeakMap,cg=new WeakSet,z1=function(e){if(Ue(this,Yd,!0),e instanceof Error&&e.name==="AbortError"&&(e=new qn),e instanceof qn)return Ue(this,Xd,!0),this._emit("abort",e);if(e instanceof je)return this._emit("error",e);if(e instanceof Error){const n=new je(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new je(String(e)))};function tz(t){return typeof t.parse=="function"}var tn,ug,Kd,dg,fg,hg,P1,H1;const nz=10;class q1 extends ay{constructor(){super(...arguments),tn.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=e.choices[0]?.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),$1(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(Gd(e)&&e.tool_calls)for(const s of e.tool_calls)s.type==="function"&&this._emit("functionToolCall",s.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new je("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),re(this,tn,"m",ug).call(this)}async finalMessage(){return await this.done(),re(this,tn,"m",Kd).call(this)}async finalFunctionToolCall(){return await this.done(),re(this,tn,"m",dg).call(this)}async finalFunctionToolCallResult(){return await this.done(),re(this,tn,"m",fg).call(this)}async totalUsage(){return await this.done(),re(this,tn,"m",hg).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=re(this,tn,"m",Kd).call(this);n&&this._emit("finalMessage",n);const s=re(this,tn,"m",ug).call(this);s&&this._emit("finalContent",s);const a=re(this,tn,"m",dg).call(this);a&&this._emit("finalFunctionToolCall",a);const l=re(this,tn,"m",fg).call(this);l!=null&&this._emit("finalFunctionToolCallResult",l),this._chatCompletions.some(c=>c.usage)&&this._emit("totalUsage",re(this,tn,"m",hg).call(this))}async _createChatCompletion(e,n,s){const a=s?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),re(this,tn,"m",P1).call(this,n);const l=await e.chat.completions.create({...n,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addChatCompletion(iy(l,n))}async _runChatCompletion(e,n,s){for(const a of n.messages)this._addMessage(a,!1);return await this._createChatCompletion(e,n,s)}async _runTools(e,n,s){const a="tool",{tool_choice:l="auto",stream:c,...d}=n,f=typeof l!="string"&&l.type==="function"&&l?.function?.name,{maxChatCompletions:h=nz}=s||{},p=n.tools.map(_=>{if(lc(_)){if(!_.$callback)throw new je("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:_.$callback,name:_.function.name,description:_.function.description||"",parameters:_.function.parameters,parse:_.$parseRaw,strict:!0}}}return _}),m={};for(const _ of p)_.type==="function"&&(m[_.function.name||_.function.function.name]=_.function);const y="tools"in n?p.map(_=>_.type==="function"?{type:"function",function:{name:_.function.name||_.function.function.name,parameters:_.function.parameters,description:_.function.description,strict:_.function.strict}}:_):void 0;for(const _ of n.messages)this._addMessage(_,!1);for(let _=0;_<h;++_){const w=(await this._createChatCompletion(e,{...d,tool_choice:l,tools:y,messages:[...this.messages]},s)).choices[0]?.message;if(!w)throw new je("missing message in ChatCompletion response");if(!w.tool_calls?.length)return;for(const A of w.tool_calls){if(A.type!=="function")continue;const S=A.id,{name:T,arguments:E}=A.function,C=m[T];if(C){if(f&&f!==T){const D=`Invalid tool_call: ${JSON.stringify(T)}. ${JSON.stringify(f)} requested. Please try again`;this._addMessage({role:a,tool_call_id:S,content:D});continue}}else{const D=`Invalid tool_call: ${JSON.stringify(T)}. Available options are: ${Object.keys(m).map(P=>JSON.stringify(P)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:S,content:D});continue}let O;try{O=tz(C)?await C.parse(E):E}catch(D){const P=D instanceof Error?D.message:String(D);this._addMessage({role:a,tool_call_id:S,content:P});continue}const j=await C.function(O,this),I=re(this,tn,"m",H1).call(this,j);if(this._addMessage({role:a,tool_call_id:S,content:I}),f)return}}}}tn=new WeakSet,ug=function(){return re(this,tn,"m",Kd).call(this).content??null},Kd=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(Gd(n))return{...n,content:n.content??null,refusal:n.refusal??null}}throw new je("stream ended without producing a ChatCompletionMessage with role=assistant")},dg=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(Gd(n)&&n?.tool_calls?.length)return n.tool_calls.filter(s=>s.type==="function").at(-1)?.function}},fg=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if($1(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(s=>s.role==="assistant"&&s.tool_calls?.some(a=>a.type==="function"&&a.id===n.tool_call_id)))return n.content}},hg=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},P1=function(e){if(e.n!=null&&e.n>1)throw new je("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},H1=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class oy extends q1{static runTools(e,n,s){const a=new oy,l={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(e,n,l)),a}_addMessage(e,n=!0){super._addMessage(e,n),Gd(e)&&e.content&&this._emit("content",e.content)}}const Q1=1,V1=2,F1=4,G1=8,Y1=16,X1=32,K1=64,W1=128,J1=256,Z1=W1|J1,eC=Y1|X1|Z1|K1,tC=Q1|V1|eC,nC=F1|G1,rz=tC|nC,Ut={STR:Q1,NUM:V1,ARR:F1,OBJ:G1,NULL:Y1,BOOL:X1,NAN:K1,INFINITY:W1,MINUS_INFINITY:J1,INF:Z1,SPECIAL:eC,ATOM:tC,COLLECTION:nC,ALL:rz};class sz extends Error{}class iz extends Error{}function az(t,e=Ut.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return oz(t.trim(),e)}const oz=(t,e)=>{const n=t.length;let s=0;const a=y=>{throw new sz(`${y} at position ${s}`)},l=y=>{throw new iz(`${y} at position ${s}`)},c=()=>(m(),s>=n&&a("Unexpected end of input"),t[s]==='"'?d():t[s]==="{"?f():t[s]==="["?h():t.substring(s,s+4)==="null"||Ut.NULL&e&&n-s<4&&"null".startsWith(t.substring(s))?(s+=4,null):t.substring(s,s+4)==="true"||Ut.BOOL&e&&n-s<4&&"true".startsWith(t.substring(s))?(s+=4,!0):t.substring(s,s+5)==="false"||Ut.BOOL&e&&n-s<5&&"false".startsWith(t.substring(s))?(s+=5,!1):t.substring(s,s+8)==="Infinity"||Ut.INFINITY&e&&n-s<8&&"Infinity".startsWith(t.substring(s))?(s+=8,1/0):t.substring(s,s+9)==="-Infinity"||Ut.MINUS_INFINITY&e&&1<n-s&&n-s<9&&"-Infinity".startsWith(t.substring(s))?(s+=9,-1/0):t.substring(s,s+3)==="NaN"||Ut.NAN&e&&n-s<3&&"NaN".startsWith(t.substring(s))?(s+=3,NaN):p()),d=()=>{const y=s;let _=!1;for(s++;s<n&&(t[s]!=='"'||_&&t[s-1]==="\\");)_=t[s]==="\\"?!_:!1,s++;if(t.charAt(s)=='"')try{return JSON.parse(t.substring(y,++s-Number(_)))}catch(x){l(String(x))}else if(Ut.STR&e)try{return JSON.parse(t.substring(y,s-Number(_))+'"')}catch{return JSON.parse(t.substring(y,t.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},f=()=>{s++,m();const y={};try{for(;t[s]!=="}";){if(m(),s>=n&&Ut.OBJ&e)return y;const _=d();m(),s++;try{const x=c();Object.defineProperty(y,_,{value:x,writable:!0,enumerable:!0,configurable:!0})}catch(x){if(Ut.OBJ&e)return y;throw x}m(),t[s]===","&&s++}}catch{if(Ut.OBJ&e)return y;a("Expected '}' at end of object")}return s++,y},h=()=>{s++;const y=[];try{for(;t[s]!=="]";)y.push(c()),m(),t[s]===","&&s++}catch{if(Ut.ARR&e)return y;a("Expected ']' at end of array")}return s++,y},p=()=>{if(s===0){t==="-"&&Ut.NUM&e&&a("Not sure what '-' is");try{return JSON.parse(t)}catch(_){if(Ut.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}l(String(_))}}const y=s;for(t[s]==="-"&&s++;t[s]&&!",]}".includes(t[s]);)s++;s==n&&!(Ut.NUM&e)&&a("Unterminated number literal");try{return JSON.parse(t.substring(y,s))}catch{t.substring(y,s)==="-"&&Ut.NUM&e&&a("Not sure what '-' is");try{return JSON.parse(t.substring(y,t.lastIndexOf("e")))}catch(x){l(String(x))}}},m=()=>{for(;s<n&&` 
\r	`.includes(t[s]);)s++};return c()},Ux=t=>az(t,Ut.ALL^Ut.NUM);var kt,Vr,Ta,Ds,wp,sd,xp,Ap,Ep,id,Sp,Lx;class Gl extends q1{constructor(e){super(),kt.add(this),Vr.set(this,void 0),Ta.set(this,void 0),Ds.set(this,void 0),Ue(this,Vr,e),Ue(this,Ta,[])}get currentChatCompletionSnapshot(){return re(this,Ds,"f")}static fromReadableStream(e){const n=new Gl(null);return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,s){const a=new Gl(n);return a._run(()=>a._runChatCompletion(e,{...n,stream:!0},{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(e,n,s){super._createChatCompletion;const a=s?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),re(this,kt,"m",wp).call(this);const l=await e.chat.completions.create({...n,stream:!0},{...s,signal:this.controller.signal});this._connected();for await(const c of l)re(this,kt,"m",xp).call(this,c);if(l.controller.signal?.aborted)throw new qn;return this._addChatCompletion(re(this,kt,"m",id).call(this))}async _fromReadableStream(e,n){const s=n?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),re(this,kt,"m",wp).call(this),this._connected();const a=pr.fromReadableStream(e,this.controller);let l;for await(const c of a)l&&l!==c.id&&this._addChatCompletion(re(this,kt,"m",id).call(this)),re(this,kt,"m",xp).call(this,c),l=c.id;if(a.controller.signal?.aborted)throw new qn;return this._addChatCompletion(re(this,kt,"m",id).call(this))}[(Vr=new WeakMap,Ta=new WeakMap,Ds=new WeakMap,kt=new WeakSet,wp=function(){this.ended||Ue(this,Ds,void 0)},sd=function(n){let s=re(this,Ta,"f")[n.index];return s||(s={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},re(this,Ta,"f")[n.index]=s,s)},xp=function(n){if(this.ended)return;const s=re(this,kt,"m",Lx).call(this,n);this._emit("chunk",n,s);for(const a of n.choices){const l=s.choices[a.index];a.delta.content!=null&&l.message?.role==="assistant"&&l.message?.content&&(this._emit("content",a.delta.content,l.message.content),this._emit("content.delta",{delta:a.delta.content,snapshot:l.message.content,parsed:l.message.parsed})),a.delta.refusal!=null&&l.message?.role==="assistant"&&l.message?.refusal&&this._emit("refusal.delta",{delta:a.delta.refusal,snapshot:l.message.refusal}),a.logprobs?.content!=null&&l.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:a.logprobs?.content,snapshot:l.logprobs?.content??[]}),a.logprobs?.refusal!=null&&l.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:a.logprobs?.refusal,snapshot:l.logprobs?.refusal??[]});const c=re(this,kt,"m",sd).call(this,l);l.finish_reason&&(re(this,kt,"m",Ep).call(this,l),c.current_tool_call_index!=null&&re(this,kt,"m",Ap).call(this,l,c.current_tool_call_index));for(const d of a.delta.tool_calls??[])c.current_tool_call_index!==d.index&&(re(this,kt,"m",Ep).call(this,l),c.current_tool_call_index!=null&&re(this,kt,"m",Ap).call(this,l,c.current_tool_call_index)),c.current_tool_call_index=d.index;for(const d of a.delta.tool_calls??[]){const f=l.message.tool_calls?.[d.index];f?.type&&(f?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:f.function?.name,index:d.index,arguments:f.function.arguments,parsed_arguments:f.function.parsed_arguments,arguments_delta:d.function?.arguments??""}):(f?.type,void 0))}}},Ap=function(n,s){if(re(this,kt,"m",sd).call(this,n).done_tool_calls.has(s))return;const l=n.message.tool_calls?.[s];if(!l)throw new Error("no tool call snapshot");if(!l.type)throw new Error("tool call snapshot missing `type`");if(l.type==="function"){const c=re(this,Vr,"f")?.tools?.find(d=>Fd(d)&&d.function.name===l.function.name);this._emit("tool_calls.function.arguments.done",{name:l.function.name,index:s,arguments:l.function.arguments,parsed_arguments:lc(c)?c.$parseRaw(l.function.arguments):c?.function.strict?JSON.parse(l.function.arguments):null})}else l.type},Ep=function(n){const s=re(this,kt,"m",sd).call(this,n);if(n.message.content&&!s.content_done){s.content_done=!0;const a=re(this,kt,"m",Sp).call(this);this._emit("content.done",{content:n.message.content,parsed:a?a.$parseRaw(n.message.content):null})}n.message.refusal&&!s.refusal_done&&(s.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),n.logprobs?.content&&!s.logprobs_content_done&&(s.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),n.logprobs?.refusal&&!s.logprobs_refusal_done&&(s.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},id=function(){if(this.ended)throw new je("stream has ended, this shouldn't happen");const n=re(this,Ds,"f");if(!n)throw new je("request ended without sending any chunks");return Ue(this,Ds,void 0),Ue(this,Ta,[]),lz(n,re(this,Vr,"f"))},Sp=function(){const n=re(this,Vr,"f")?.response_format;return sy(n)?n:null},Lx=function(n){var s,a,l,c;let d=re(this,Ds,"f");const{choices:f,...h}=n;d?Object.assign(d,h):d=Ue(this,Ds,{...h,choices:[]});for(const{delta:p,finish_reason:m,index:y,logprobs:_=null,...x}of n.choices){let w=d.choices[y];if(w||(w=d.choices[y]={finish_reason:m,index:y,message:{},logprobs:_,...x}),_)if(!w.logprobs)w.logprobs=Object.assign({},_);else{const{content:j,refusal:I,...D}=_;Object.assign(w.logprobs,D),j&&((s=w.logprobs).content??(s.content=[]),w.logprobs.content.push(...j)),I&&((a=w.logprobs).refusal??(a.refusal=[]),w.logprobs.refusal.push(...I))}if(m&&(w.finish_reason=m,re(this,Vr,"f")&&U1(re(this,Vr,"f")))){if(m==="length")throw new v1;if(m==="content_filter")throw new _1}if(Object.assign(w,x),!p)continue;const{content:A,refusal:S,function_call:T,role:E,tool_calls:C,...O}=p;if(Object.assign(w.message,O),S&&(w.message.refusal=(w.message.refusal||"")+S),E&&(w.message.role=E),T&&(w.message.function_call?(T.name&&(w.message.function_call.name=T.name),T.arguments&&((l=w.message.function_call).arguments??(l.arguments=""),w.message.function_call.arguments+=T.arguments)):w.message.function_call=T),A&&(w.message.content=(w.message.content||"")+A,!w.message.refusal&&re(this,kt,"m",Sp).call(this)&&(w.message.parsed=Ux(w.message.content))),C){w.message.tool_calls||(w.message.tool_calls=[]);for(const{index:j,id:I,type:D,function:P,...G}of C){const V=(c=w.message.tool_calls)[j]??(c[j]={});Object.assign(V,G),I&&(V.id=I),D&&(V.type=D),P&&(V.function??(V.function={name:P.name??"",arguments:""})),P?.name&&(V.function.name=P.name),P?.arguments&&(V.function.arguments+=P.arguments,Z$(re(this,Vr,"f"),V)&&(V.function.parsed_arguments=Ux(V.function.arguments)))}}}return d},Symbol.asyncIterator)](){const e=[],n=[];let s=!1;return this.on("chunk",a=>{const l=n.shift();l?l.resolve(a):e.push(a)}),this.on("end",()=>{s=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{s=!0;for(const l of n)l.reject(a);n.length=0}),this.on("error",a=>{s=!0;for(const l of n)l.reject(a);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((l,c)=>n.push({resolve:l,reject:c})).then(l=>l?{value:l,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new pr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function lz(t,e){const{id:n,choices:s,created:a,model:l,system_fingerprint:c,...d}=t,f={...d,id:n,choices:s.map(({message:h,finish_reason:p,index:m,logprobs:y,..._})=>{if(!p)throw new je(`missing finish_reason for choice ${m}`);const{content:x=null,function_call:w,tool_calls:A,...S}=h,T=h.role;if(!T)throw new je(`missing role for choice ${m}`);if(w){const{arguments:E,name:C}=w;if(E==null)throw new je(`missing function_call.arguments for choice ${m}`);if(!C)throw new je(`missing function_call.name for choice ${m}`);return{..._,message:{content:x,function_call:{arguments:E,name:C},role:T,refusal:h.refusal??null},finish_reason:p,index:m,logprobs:y}}return A?{..._,index:m,finish_reason:p,logprobs:y,message:{...S,role:T,content:x,refusal:h.refusal??null,tool_calls:A.map((E,C)=>{const{function:O,type:j,id:I,...D}=E,{arguments:P,name:G,...V}=O||{};if(I==null)throw new je(`missing choices[${m}].tool_calls[${C}].id
${ad(t)}`);if(j==null)throw new je(`missing choices[${m}].tool_calls[${C}].type
${ad(t)}`);if(G==null)throw new je(`missing choices[${m}].tool_calls[${C}].function.name
${ad(t)}`);if(P==null)throw new je(`missing choices[${m}].tool_calls[${C}].function.arguments
${ad(t)}`);return{...D,id:I,type:j,function:{...V,name:G,arguments:P}}})}}:{..._,message:{...S,content:x,role:T,refusal:h.refusal??null},finish_reason:p,index:m,logprobs:y}}),created:a,model:l,object:"chat.completion",...c?{system_fingerprint:c}:{}};return K$(f,e)}function ad(t){return JSON.stringify(t)}class Wd extends Gl{static fromReadableStream(e){const n=new Wd(null);return n._run(()=>n._fromReadableStream(e)),n}static runTools(e,n,s){const a=new Wd(n),l={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(e,n,l)),a}}let ly=class extends Ne{constructor(){super(...arguments),this.messages=new B1(this._client)}create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}retrieve(e,n){return this._client.get(ye`/chat/completions/${e}`,n)}update(e,n,s){return this._client.post(ye`/chat/completions/${e}`,{body:n,...s})}list(e={},n){return this._client.getAPIList("/chat/completions",Rt,{query:e,...n})}delete(e,n){return this._client.delete(ye`/chat/completions/${e}`,n)}parse(e,n){return ez(e.tools),this._client.chat.completions.create(e,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(s=>iy(s,e))}runTools(e,n){return e.stream?Wd.runTools(this._client,e,n):oy.runTools(this._client,e,n)}stream(e,n){return Gl.createChatCompletion(this._client,e,n)}};ly.Messages=B1;class cy extends Ne{constructor(){super(...arguments),this.completions=new ly(this._client)}}cy.Completions=ly;const rC=Symbol("brand.privateNullableHeaders");function*cz(t){if(!t)return;if(rC in t){const{values:s,nulls:a}=t;yield*s.entries();for(const l of a)yield[l,null];return}let e=!1,n;t instanceof Headers?n=t.entries():xx(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let s of n){const a=s[0];if(typeof a!="string")throw new TypeError("expected header name to be a string");const l=xx(s[1])?s[1]:[s[1]];let c=!1;for(const d of l)d!==void 0&&(e&&!c&&(c=!0,yield[a,null]),yield[a,d])}}const Ae=t=>{const e=new Headers,n=new Set;for(const s of t){const a=new Set;for(const[l,c]of cz(s)){const d=l.toLowerCase();a.has(d)||(e.delete(l),a.add(d)),c===null?(e.delete(l),n.add(d)):(e.append(l,c),n.delete(d))}}return{[rC]:!0,values:e,nulls:n}};class sC extends Ne{create(e,n){return this._client.post("/audio/speech",{body:e,...n,headers:Ae([{Accept:"application/octet-stream"},n?.headers]),__binaryResponse:!0})}}class iC extends Ne{create(e,n){return this._client.post("/audio/transcriptions",Ri({body:e,...n,stream:e.stream??!1,__metadata:{model:e.model}},this._client))}}class aC extends Ne{create(e,n){return this._client.post("/audio/translations",Ri({body:e,...n,__metadata:{model:e.model}},this._client))}}class cc extends Ne{constructor(){super(...arguments),this.transcriptions=new iC(this._client),this.translations=new aC(this._client),this.speech=new sC(this._client)}}cc.Transcriptions=iC;cc.Translations=aC;cc.Speech=sC;class oC extends Ne{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(ye`/batches/${e}`,n)}list(e={},n){return this._client.getAPIList("/batches",Rt,{query:e,...n})}cancel(e,n){return this._client.post(ye`/batches/${e}/cancel`,n)}}class lC extends Ne{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:Ae([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(e,n){return this._client.get(ye`/assistants/${e}`,{...n,headers:Ae([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(e,n,s){return this._client.post(ye`/assistants/${e}`,{body:n,...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e={},n){return this._client.getAPIList("/assistants",Rt,{query:e,...n,headers:Ae([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}delete(e,n){return this._client.delete(ye`/assistants/${e}`,{...n,headers:Ae([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}}let cC=class extends Ne{create(e,n){return this._client.post("/realtime/sessions",{body:e,...n,headers:Ae([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}};class uC extends Ne{create(e,n){return this._client.post("/realtime/transcription_sessions",{body:e,...n,headers:Ae([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}}let xf=class extends Ne{constructor(){super(...arguments),this.sessions=new cC(this._client),this.transcriptionSessions=new uC(this._client)}};xf.Sessions=cC;xf.TranscriptionSessions=uC;class dC extends Ne{create(e,n){return this._client.post("/chatkit/sessions",{body:e,...n,headers:Ae([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}cancel(e,n){return this._client.post(ye`/chatkit/sessions/${e}/cancel`,{...n,headers:Ae([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}}let fC=class extends Ne{retrieve(e,n){return this._client.get(ye`/chatkit/threads/${e}`,{...n,headers:Ae([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}list(e={},n){return this._client.getAPIList("/chatkit/threads",Vd,{query:e,...n,headers:Ae([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}delete(e,n){return this._client.delete(ye`/chatkit/threads/${e}`,{...n,headers:Ae([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}listItems(e,n={},s){return this._client.getAPIList(ye`/chatkit/threads/${e}/items`,Vd,{query:n,...s,headers:Ae([{"OpenAI-Beta":"chatkit_beta=v1"},s?.headers])})}};class Af extends Ne{constructor(){super(...arguments),this.sessions=new dC(this._client),this.threads=new fC(this._client)}}Af.Sessions=dC;Af.Threads=fC;class hC extends Ne{create(e,n,s){return this._client.post(ye`/threads/${e}/messages`,{body:n,...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}retrieve(e,n,s){const{thread_id:a}=n;return this._client.get(ye`/threads/${a}/messages/${e}`,{...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}update(e,n,s){const{thread_id:a,...l}=n;return this._client.post(ye`/threads/${a}/messages/${e}`,{body:l,...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e,n={},s){return this._client.getAPIList(ye`/threads/${e}/messages`,Rt,{query:n,...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}delete(e,n,s){const{thread_id:a}=n;return this._client.delete(ye`/threads/${a}/messages/${e}`,{...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}class mC extends Ne{retrieve(e,n,s){const{thread_id:a,run_id:l,...c}=n;return this._client.get(ye`/threads/${a}/runs/${l}/steps/${e}`,{query:c,...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e,n,s){const{thread_id:a,...l}=n;return this._client.getAPIList(ye`/threads/${a}/runs/${e}/steps`,Rt,{query:l,...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}const uz=t=>{if(typeof Buffer<"u"){const e=Buffer.from(t,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(t),n=e.length,s=new Uint8Array(n);for(let a=0;a<n;a++)s[a]=e.charCodeAt(a);return Array.from(new Float32Array(s.buffer))}};var dz={};const Na=t=>{if(typeof globalThis.process<"u")return dz?.[t]?.trim()??void 0;if(typeof globalThis.Deno<"u")return globalThis.Deno.env?.get?.(t)?.trim()};var Vt,wi,mg,hr,wd,Zn,xi,Ua,yi,Jd,Tn,xd,Ad,Ol,wl,xl,$x,zx,Px,Hx,qx,Qx,Vx;class jl extends ay{constructor(){super(...arguments),Vt.add(this),mg.set(this,[]),hr.set(this,{}),wd.set(this,{}),Zn.set(this,void 0),xi.set(this,void 0),Ua.set(this,void 0),yi.set(this,void 0),Jd.set(this,void 0),Tn.set(this,void 0),xd.set(this,void 0),Ad.set(this,void 0),Ol.set(this,void 0)}[(mg=new WeakMap,hr=new WeakMap,wd=new WeakMap,Zn=new WeakMap,xi=new WeakMap,Ua=new WeakMap,yi=new WeakMap,Jd=new WeakMap,Tn=new WeakMap,xd=new WeakMap,Ad=new WeakMap,Ol=new WeakMap,Vt=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let s=!1;return this.on("event",a=>{const l=n.shift();l?l.resolve(a):e.push(a)}),this.on("end",()=>{s=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{s=!0;for(const l of n)l.reject(a);n.length=0}),this.on("error",a=>{s=!0;for(const l of n)l.reject(a);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((l,c)=>n.push({resolve:l,reject:c})).then(l=>l?{value:l,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new wi;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){const s=n?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=pr.fromReadableStream(e,this.controller);for await(const l of a)re(this,Vt,"m",wl).call(this,l);if(a.controller.signal?.aborted)throw new qn;return this._addRun(re(this,Vt,"m",xl).call(this))}toReadableStream(){return new pr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,s,a){const l=new wi;return l._run(()=>l._runToolAssistantStream(e,n,s,{...a,headers:{...a?.headers,"X-Stainless-Helper-Method":"stream"}})),l}async _createToolAssistantStream(e,n,s,a){const l=a?.signal;l&&(l.aborted&&this.controller.abort(),l.addEventListener("abort",()=>this.controller.abort()));const c={...s,stream:!0},d=await e.submitToolOutputs(n,c,{...a,signal:this.controller.signal});this._connected();for await(const f of d)re(this,Vt,"m",wl).call(this,f);if(d.controller.signal?.aborted)throw new qn;return this._addRun(re(this,Vt,"m",xl).call(this))}static createThreadAssistantStream(e,n,s){const a=new wi;return a._run(()=>a._threadAssistantStream(e,n,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(e,n,s,a){const l=new wi;return l._run(()=>l._runAssistantStream(e,n,s,{...a,headers:{...a?.headers,"X-Stainless-Helper-Method":"stream"}})),l}currentEvent(){return re(this,xd,"f")}currentRun(){return re(this,Ad,"f")}currentMessageSnapshot(){return re(this,Zn,"f")}currentRunStepSnapshot(){return re(this,Ol,"f")}async finalRunSteps(){return await this.done(),Object.values(re(this,hr,"f"))}async finalMessages(){return await this.done(),Object.values(re(this,wd,"f"))}async finalRun(){if(await this.done(),!re(this,xi,"f"))throw Error("Final run was not received.");return re(this,xi,"f")}async _createThreadAssistantStream(e,n,s){const a=s?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const l={...n,stream:!0},c=await e.createAndRun(l,{...s,signal:this.controller.signal});this._connected();for await(const d of c)re(this,Vt,"m",wl).call(this,d);if(c.controller.signal?.aborted)throw new qn;return this._addRun(re(this,Vt,"m",xl).call(this))}async _createAssistantStream(e,n,s,a){const l=a?.signal;l&&(l.aborted&&this.controller.abort(),l.addEventListener("abort",()=>this.controller.abort()));const c={...s,stream:!0},d=await e.create(n,c,{...a,signal:this.controller.signal});this._connected();for await(const f of d)re(this,Vt,"m",wl).call(this,f);if(d.controller.signal?.aborted)throw new qn;return this._addRun(re(this,Vt,"m",xl).call(this))}static accumulateDelta(e,n){for(const[s,a]of Object.entries(n)){if(!e.hasOwnProperty(s)){e[s]=a;continue}let l=e[s];if(l==null){e[s]=a;continue}if(s==="index"||s==="type"){e[s]=a;continue}if(typeof l=="string"&&typeof a=="string")l+=a;else if(typeof l=="number"&&typeof a=="number")l+=a;else if(vp(l)&&vp(a))l=this.accumulateDelta(l,a);else if(Array.isArray(l)&&Array.isArray(a)){if(l.every(c=>typeof c=="string"||typeof c=="number")){l.push(...a);continue}for(const c of a){if(!vp(c))throw new Error(`Expected array delta entry to be an object but got: ${c}`);const d=c.index;if(d==null)throw console.error(c),new Error("Expected array delta entry to have an `index` property");if(typeof d!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${d}`);const f=l[d];f==null?l.push(c):l[d]=this.accumulateDelta(f,c)}continue}else throw Error(`Unhandled record type: ${s}, deltaValue: ${a}, accValue: ${l}`);e[s]=l}return e}_addRun(e){return e}async _threadAssistantStream(e,n,s){return await this._createThreadAssistantStream(n,e,s)}async _runAssistantStream(e,n,s,a){return await this._createAssistantStream(n,e,s,a)}async _runToolAssistantStream(e,n,s,a){return await this._createToolAssistantStream(n,e,s,a)}}wi=jl,wl=function(e){if(!this.ended)switch(Ue(this,xd,e),re(this,Vt,"m",Px).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":re(this,Vt,"m",Vx).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":re(this,Vt,"m",zx).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":re(this,Vt,"m",$x).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},xl=function(){if(this.ended)throw new je("stream has ended, this shouldn't happen");if(!re(this,xi,"f"))throw Error("Final run has not been received");return re(this,xi,"f")},$x=function(e){const[n,s]=re(this,Vt,"m",qx).call(this,e,re(this,Zn,"f"));Ue(this,Zn,n),re(this,wd,"f")[n.id]=n;for(const a of s){const l=n.content[a.index];l?.type=="text"&&this._emit("textCreated",l.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const a of e.data.delta.content){if(a.type=="text"&&a.text){let l=a.text,c=n.content[a.index];if(c&&c.type=="text")this._emit("textDelta",l,c.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(a.index!=re(this,Ua,"f")){if(re(this,yi,"f"))switch(re(this,yi,"f").type){case"text":this._emit("textDone",re(this,yi,"f").text,re(this,Zn,"f"));break;case"image_file":this._emit("imageFileDone",re(this,yi,"f").image_file,re(this,Zn,"f"));break}Ue(this,Ua,a.index)}Ue(this,yi,n.content[a.index])}break;case"thread.message.completed":case"thread.message.incomplete":if(re(this,Ua,"f")!==void 0){const a=e.data.content[re(this,Ua,"f")];if(a)switch(a.type){case"image_file":this._emit("imageFileDone",a.image_file,re(this,Zn,"f"));break;case"text":this._emit("textDone",a.text,re(this,Zn,"f"));break}}re(this,Zn,"f")&&this._emit("messageDone",e.data),Ue(this,Zn,void 0)}},zx=function(e){const n=re(this,Vt,"m",Hx).call(this,e);switch(Ue(this,Ol,n),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const s=e.data.delta;if(s.step_details&&s.step_details.type=="tool_calls"&&s.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const l of s.step_details.tool_calls)l.index==re(this,Jd,"f")?this._emit("toolCallDelta",l,n.step_details.tool_calls[l.index]):(re(this,Tn,"f")&&this._emit("toolCallDone",re(this,Tn,"f")),Ue(this,Jd,l.index),Ue(this,Tn,n.step_details.tool_calls[l.index]),re(this,Tn,"f")&&this._emit("toolCallCreated",re(this,Tn,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Ue(this,Ol,void 0),e.data.step_details.type=="tool_calls"&&re(this,Tn,"f")&&(this._emit("toolCallDone",re(this,Tn,"f")),Ue(this,Tn,void 0)),this._emit("runStepDone",e.data,n);break}},Px=function(e){re(this,mg,"f").push(e),this._emit("event",e)},Hx=function(e){switch(e.event){case"thread.run.step.created":return re(this,hr,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=re(this,hr,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let s=e.data;if(s.delta){const a=wi.accumulateDelta(n,s.delta);re(this,hr,"f")[e.data.id]=a}return re(this,hr,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":re(this,hr,"f")[e.data.id]=e.data;break}if(re(this,hr,"f")[e.data.id])return re(this,hr,"f")[e.data.id];throw new Error("No snapshot available")},qx=function(e,n){let s=[];switch(e.event){case"thread.message.created":return[e.data,s];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let a=e.data;if(a.delta.content)for(const l of a.delta.content)if(l.index in n.content){let c=n.content[l.index];n.content[l.index]=re(this,Vt,"m",Qx).call(this,l,c)}else n.content[l.index]=l,s.push(l);return[n,s];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,s];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Qx=function(e,n){return wi.accumulateDelta(n,e)},Vx=function(e){switch(Ue(this,Ad,e.data),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":Ue(this,xi,e.data),re(this,Tn,"f")&&(this._emit("toolCallDone",re(this,Tn,"f")),Ue(this,Tn,void 0));break}};let uy=class extends Ne{constructor(){super(...arguments),this.steps=new mC(this._client)}create(e,n,s){const{include:a,...l}=n;return this._client.post(ye`/threads/${e}/runs`,{query:{include:a},body:l,...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers]),stream:n.stream??!1})}retrieve(e,n,s){const{thread_id:a}=n;return this._client.get(ye`/threads/${a}/runs/${e}`,{...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}update(e,n,s){const{thread_id:a,...l}=n;return this._client.post(ye`/threads/${a}/runs/${e}`,{body:l,...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e,n={},s){return this._client.getAPIList(ye`/threads/${e}/runs`,Rt,{query:n,...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}cancel(e,n,s){const{thread_id:a}=n;return this._client.post(ye`/threads/${a}/runs/${e}/cancel`,{...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async createAndPoll(e,n,s){const a=await this.create(e,n,s);return await this.poll(a.id,{thread_id:e},s)}createAndStream(e,n,s){return jl.createAssistantStream(e,this._client.beta.threads.runs,n,s)}async poll(e,n,s){const a=Ae([s?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":s?.pollIntervalMs?.toString()??void 0}]);for(;;){const{data:l,response:c}=await this.retrieve(e,n,{...s,headers:{...s?.headers,...a}}).withResponse();switch(l.status){case"queued":case"in_progress":case"cancelling":let d=5e3;if(s?.pollIntervalMs)d=s.pollIntervalMs;else{const f=c.headers.get("openai-poll-after-ms");if(f){const h=parseInt(f);isNaN(h)||(d=h)}}await oc(d);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return l}}}stream(e,n,s){return jl.createAssistantStream(e,this._client.beta.threads.runs,n,s)}submitToolOutputs(e,n,s){const{thread_id:a,...l}=n;return this._client.post(ye`/threads/${a}/runs/${e}/submit_tool_outputs`,{body:l,...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers]),stream:n.stream??!1})}async submitToolOutputsAndPoll(e,n,s){const a=await this.submitToolOutputs(e,n,s);return await this.poll(a.id,n,s)}submitToolOutputsStream(e,n,s){return jl.createToolAssistantStream(e,this._client.beta.threads.runs,n,s)}};uy.Steps=mC;class Ef extends Ne{constructor(){super(...arguments),this.runs=new uy(this._client),this.messages=new hC(this._client)}create(e={},n){return this._client.post("/threads",{body:e,...n,headers:Ae([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(e,n){return this._client.get(ye`/threads/${e}`,{...n,headers:Ae([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(e,n,s){return this._client.post(ye`/threads/${e}`,{body:n,...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}delete(e,n){return this._client.delete(ye`/threads/${e}`,{...n,headers:Ae([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:Ae([{"OpenAI-Beta":"assistants=v2"},n?.headers]),stream:e.stream??!1})}async createAndRunPoll(e,n){const s=await this.createAndRun(e,n);return await this.runs.poll(s.id,{thread_id:s.thread_id},n)}createAndRunStream(e,n){return jl.createThreadAssistantStream(e,this._client.beta.threads,n)}}Ef.Runs=uy;Ef.Messages=hC;class Za extends Ne{constructor(){super(...arguments),this.realtime=new xf(this._client),this.chatkit=new Af(this._client),this.assistants=new lC(this._client),this.threads=new Ef(this._client)}}Za.Realtime=xf;Za.ChatKit=Af;Za.Assistants=lC;Za.Threads=Ef;class pC extends Ne{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}class gC extends Ne{retrieve(e,n,s){const{container_id:a}=n;return this._client.get(ye`/containers/${a}/files/${e}/content`,{...s,headers:Ae([{Accept:"application/binary"},s?.headers]),__binaryResponse:!0})}}let dy=class extends Ne{constructor(){super(...arguments),this.content=new gC(this._client)}create(e,n,s){return this._client.post(ye`/containers/${e}/files`,Ri({body:n,...s},this._client))}retrieve(e,n,s){const{container_id:a}=n;return this._client.get(ye`/containers/${a}/files/${e}`,s)}list(e,n={},s){return this._client.getAPIList(ye`/containers/${e}/files`,Rt,{query:n,...s})}delete(e,n,s){const{container_id:a}=n;return this._client.delete(ye`/containers/${a}/files/${e}`,{...s,headers:Ae([{Accept:"*/*"},s?.headers])})}};dy.Content=gC;class fy extends Ne{constructor(){super(...arguments),this.files=new dy(this._client)}create(e,n){return this._client.post("/containers",{body:e,...n})}retrieve(e,n){return this._client.get(ye`/containers/${e}`,n)}list(e={},n){return this._client.getAPIList("/containers",Rt,{query:e,...n})}delete(e,n){return this._client.delete(ye`/containers/${e}`,{...n,headers:Ae([{Accept:"*/*"},n?.headers])})}}fy.Files=dy;class yC extends Ne{create(e,n,s){const{include:a,...l}=n;return this._client.post(ye`/conversations/${e}/items`,{query:{include:a},body:l,...s})}retrieve(e,n,s){const{conversation_id:a,...l}=n;return this._client.get(ye`/conversations/${a}/items/${e}`,{query:l,...s})}list(e,n={},s){return this._client.getAPIList(ye`/conversations/${e}/items`,Vd,{query:n,...s})}delete(e,n,s){const{conversation_id:a}=n;return this._client.delete(ye`/conversations/${a}/items/${e}`,s)}}class hy extends Ne{constructor(){super(...arguments),this.items=new yC(this._client)}create(e={},n){return this._client.post("/conversations",{body:e,...n})}retrieve(e,n){return this._client.get(ye`/conversations/${e}`,n)}update(e,n,s){return this._client.post(ye`/conversations/${e}`,{body:n,...s})}delete(e,n){return this._client.delete(ye`/conversations/${e}`,n)}}hy.Items=yC;class vC extends Ne{create(e,n){const s=!!e.encoding_format;let a=s?e.encoding_format:"base64";s&&Qt(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);const l=this._client.post("/embeddings",{body:{...e,encoding_format:a},...n});return s?l:(Qt(this._client).debug("embeddings/decoding base64 embeddings from base64"),l._thenUnwrap(c=>(c&&c.data&&c.data.forEach(d=>{const f=d.embedding;d.embedding=uz(f)}),c)))}}class _C extends Ne{retrieve(e,n,s){const{eval_id:a,run_id:l}=n;return this._client.get(ye`/evals/${a}/runs/${l}/output_items/${e}`,s)}list(e,n,s){const{eval_id:a,...l}=n;return this._client.getAPIList(ye`/evals/${a}/runs/${e}/output_items`,Rt,{query:l,...s})}}class my extends Ne{constructor(){super(...arguments),this.outputItems=new _C(this._client)}create(e,n,s){return this._client.post(ye`/evals/${e}/runs`,{body:n,...s})}retrieve(e,n,s){const{eval_id:a}=n;return this._client.get(ye`/evals/${a}/runs/${e}`,s)}list(e,n={},s){return this._client.getAPIList(ye`/evals/${e}/runs`,Rt,{query:n,...s})}delete(e,n,s){const{eval_id:a}=n;return this._client.delete(ye`/evals/${a}/runs/${e}`,s)}cancel(e,n,s){const{eval_id:a}=n;return this._client.post(ye`/evals/${a}/runs/${e}`,s)}}my.OutputItems=_C;class py extends Ne{constructor(){super(...arguments),this.runs=new my(this._client)}create(e,n){return this._client.post("/evals",{body:e,...n})}retrieve(e,n){return this._client.get(ye`/evals/${e}`,n)}update(e,n,s){return this._client.post(ye`/evals/${e}`,{body:n,...s})}list(e={},n){return this._client.getAPIList("/evals",Rt,{query:e,...n})}delete(e,n){return this._client.delete(ye`/evals/${e}`,n)}}py.Runs=my;let bC=class extends Ne{create(e,n){return this._client.post("/files",Ri({body:e,...n},this._client))}retrieve(e,n){return this._client.get(ye`/files/${e}`,n)}list(e={},n){return this._client.getAPIList("/files",Rt,{query:e,...n})}delete(e,n){return this._client.delete(ye`/files/${e}`,n)}content(e,n){return this._client.get(ye`/files/${e}/content`,{...n,headers:Ae([{Accept:"application/binary"},n?.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:s=1800*1e3}={}){const a=new Set(["processed","error","deleted"]),l=Date.now();let c=await this.retrieve(e);for(;!c.status||!a.has(c.status);)if(await oc(n),c=await this.retrieve(e),Date.now()-l>s)throw new ey({message:`Giving up on waiting for file ${e} to finish processing after ${s} milliseconds.`});return c}};class wC extends Ne{}let xC=class extends Ne{run(e,n){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...n})}validate(e,n){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...n})}};class gy extends Ne{constructor(){super(...arguments),this.graders=new xC(this._client)}}gy.Graders=xC;class AC extends Ne{create(e,n,s){return this._client.getAPIList(ye`/fine_tuning/checkpoints/${e}/permissions`,wf,{body:n,method:"post",...s})}retrieve(e,n={},s){return this._client.get(ye`/fine_tuning/checkpoints/${e}/permissions`,{query:n,...s})}delete(e,n,s){const{fine_tuned_model_checkpoint:a}=n;return this._client.delete(ye`/fine_tuning/checkpoints/${a}/permissions/${e}`,s)}}let yy=class extends Ne{constructor(){super(...arguments),this.permissions=new AC(this._client)}};yy.Permissions=AC;class EC extends Ne{list(e,n={},s){return this._client.getAPIList(ye`/fine_tuning/jobs/${e}/checkpoints`,Rt,{query:n,...s})}}class vy extends Ne{constructor(){super(...arguments),this.checkpoints=new EC(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(ye`/fine_tuning/jobs/${e}`,n)}list(e={},n){return this._client.getAPIList("/fine_tuning/jobs",Rt,{query:e,...n})}cancel(e,n){return this._client.post(ye`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},s){return this._client.getAPIList(ye`/fine_tuning/jobs/${e}/events`,Rt,{query:n,...s})}pause(e,n){return this._client.post(ye`/fine_tuning/jobs/${e}/pause`,n)}resume(e,n){return this._client.post(ye`/fine_tuning/jobs/${e}/resume`,n)}}vy.Checkpoints=EC;class eo extends Ne{constructor(){super(...arguments),this.methods=new wC(this._client),this.jobs=new vy(this._client),this.checkpoints=new yy(this._client),this.alpha=new gy(this._client)}}eo.Methods=wC;eo.Jobs=vy;eo.Checkpoints=yy;eo.Alpha=gy;class SC extends Ne{}class _y extends Ne{constructor(){super(...arguments),this.graderModels=new SC(this._client)}}_y.GraderModels=SC;class CC extends Ne{createVariation(e,n){return this._client.post("/images/variations",Ri({body:e,...n},this._client))}edit(e,n){return this._client.post("/images/edits",Ri({body:e,...n,stream:e.stream??!1},this._client))}generate(e,n){return this._client.post("/images/generations",{body:e,...n,stream:e.stream??!1})}}class TC extends Ne{retrieve(e,n){return this._client.get(ye`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",wf,e)}delete(e,n){return this._client.delete(ye`/models/${e}`,n)}}class NC extends Ne{create(e,n){return this._client.post("/moderations",{body:e,...n})}}class RC extends Ne{accept(e,n,s){return this._client.post(ye`/realtime/calls/${e}/accept`,{body:n,...s,headers:Ae([{Accept:"*/*"},s?.headers])})}hangup(e,n){return this._client.post(ye`/realtime/calls/${e}/hangup`,{...n,headers:Ae([{Accept:"*/*"},n?.headers])})}refer(e,n,s){return this._client.post(ye`/realtime/calls/${e}/refer`,{body:n,...s,headers:Ae([{Accept:"*/*"},s?.headers])})}reject(e,n={},s){return this._client.post(ye`/realtime/calls/${e}/reject`,{body:n,...s,headers:Ae([{Accept:"*/*"},s?.headers])})}}class OC extends Ne{create(e,n){return this._client.post("/realtime/client_secrets",{body:e,...n})}}class Sf extends Ne{constructor(){super(...arguments),this.clientSecrets=new OC(this._client),this.calls=new RC(this._client)}}Sf.ClientSecrets=OC;Sf.Calls=RC;function fz(t,e){return!e||!mz(e)?{...t,output_parsed:null,output:t.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(s=>({...s,parsed:null}))}:n)}:jC(t,e)}function jC(t,e){const n=t.output.map(a=>{if(a.type==="function_call")return{...a,parsed_arguments:yz(e,a)};if(a.type==="message"){const l=a.content.map(c=>c.type==="output_text"?{...c,parsed:hz(e,c.text)}:c);return{...a,content:l}}return a}),s=Object.assign({},t,{output:n});return Object.getOwnPropertyDescriptor(t,"output_text")||pg(s),Object.defineProperty(s,"output_parsed",{enumerable:!0,get(){for(const a of s.output)if(a.type==="message"){for(const l of a.content)if(l.type==="output_text"&&l.parsed!==null)return l.parsed}return null}}),s}function hz(t,e){return t.text?.format?.type!=="json_schema"?null:"$parseRaw"in t.text?.format?(t.text?.format).$parseRaw(e):JSON.parse(e)}function mz(t){return!!sy(t.text?.format)}function pz(t){return t?.$brand==="auto-parseable-tool"}function gz(t,e){return t.find(n=>n.type==="function"&&n.name===e)}function yz(t,e){const n=gz(t.tools??[],e.name);return{...e,...e,parsed_arguments:pz(n)?n.$parseRaw(e.arguments):n?.strict?JSON.parse(e.arguments):null}}function pg(t){const e=[];for(const n of t.output)if(n.type==="message")for(const s of n.content)s.type==="output_text"&&e.push(s.text);t.output_text=e.join("")}var Ra,od,Bs,ld,Fx,Gx,Yx,Xx;class by extends ay{constructor(e){super(),Ra.add(this),od.set(this,void 0),Bs.set(this,void 0),ld.set(this,void 0),Ue(this,od,e)}static createResponse(e,n,s){const a=new by(n);return a._run(()=>a._createOrRetrieveResponse(e,n,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createOrRetrieveResponse(e,n,s){const a=s?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),re(this,Ra,"m",Fx).call(this);let l,c=null;"response_id"in n?(l=await e.responses.retrieve(n.response_id,{stream:!0},{...s,signal:this.controller.signal,stream:!0}),c=n.starting_after??null):l=await e.responses.create({...n,stream:!0},{...s,signal:this.controller.signal}),this._connected();for await(const d of l)re(this,Ra,"m",Gx).call(this,d,c);if(l.controller.signal?.aborted)throw new qn;return re(this,Ra,"m",Yx).call(this)}[(od=new WeakMap,Bs=new WeakMap,ld=new WeakMap,Ra=new WeakSet,Fx=function(){this.ended||Ue(this,Bs,void 0)},Gx=function(n,s){if(this.ended)return;const a=(c,d)=>{(s==null||d.sequence_number>s)&&this._emit(c,d)},l=re(this,Ra,"m",Xx).call(this,n);switch(a("event",n),n.type){case"response.output_text.delta":{const c=l.output[n.output_index];if(!c)throw new je(`missing output at index ${n.output_index}`);if(c.type==="message"){const d=c.content[n.content_index];if(!d)throw new je(`missing content at index ${n.content_index}`);if(d.type!=="output_text")throw new je(`expected content to be 'output_text', got ${d.type}`);a("response.output_text.delta",{...n,snapshot:d.text})}break}case"response.function_call_arguments.delta":{const c=l.output[n.output_index];if(!c)throw new je(`missing output at index ${n.output_index}`);c.type==="function_call"&&a("response.function_call_arguments.delta",{...n,snapshot:c.arguments});break}default:a(n.type,n);break}},Yx=function(){if(this.ended)throw new je("stream has ended, this shouldn't happen");const n=re(this,Bs,"f");if(!n)throw new je("request ended without sending any events");Ue(this,Bs,void 0);const s=vz(n,re(this,od,"f"));return Ue(this,ld,s),s},Xx=function(n){let s=re(this,Bs,"f");if(!s){if(n.type!=="response.created")throw new je(`When snapshot hasn't been set yet, expected 'response.created' event, got ${n.type}`);return s=Ue(this,Bs,n.response),s}switch(n.type){case"response.output_item.added":{s.output.push(n.item);break}case"response.content_part.added":{const a=s.output[n.output_index];if(!a)throw new je(`missing output at index ${n.output_index}`);const l=a.type,c=n.part;l==="message"&&c.type!=="reasoning_text"?a.content.push(c):l==="reasoning"&&c.type==="reasoning_text"&&(a.content||(a.content=[]),a.content.push(c));break}case"response.output_text.delta":{const a=s.output[n.output_index];if(!a)throw new je(`missing output at index ${n.output_index}`);if(a.type==="message"){const l=a.content[n.content_index];if(!l)throw new je(`missing content at index ${n.content_index}`);if(l.type!=="output_text")throw new je(`expected content to be 'output_text', got ${l.type}`);l.text+=n.delta}break}case"response.function_call_arguments.delta":{const a=s.output[n.output_index];if(!a)throw new je(`missing output at index ${n.output_index}`);a.type==="function_call"&&(a.arguments+=n.delta);break}case"response.reasoning_text.delta":{const a=s.output[n.output_index];if(!a)throw new je(`missing output at index ${n.output_index}`);if(a.type==="reasoning"){const l=a.content?.[n.content_index];if(!l)throw new je(`missing content at index ${n.content_index}`);if(l.type!=="reasoning_text")throw new je(`expected content to be 'reasoning_text', got ${l.type}`);l.text+=n.delta}break}case"response.completed":{Ue(this,Bs,n.response);break}}return s},Symbol.asyncIterator)](){const e=[],n=[];let s=!1;return this.on("event",a=>{const l=n.shift();l?l.resolve(a):e.push(a)}),this.on("end",()=>{s=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{s=!0;for(const l of n)l.reject(a);n.length=0}),this.on("error",a=>{s=!0;for(const l of n)l.reject(a);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((l,c)=>n.push({resolve:l,reject:c})).then(l=>l?{value:l,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=re(this,ld,"f");if(!e)throw new je("stream ended without producing a ChatCompletion");return e}}function vz(t,e){return fz(t,e)}class IC extends Ne{list(e,n={},s){return this._client.getAPIList(ye`/responses/${e}/input_items`,Rt,{query:n,...s})}}class kC extends Ne{count(e={},n){return this._client.post("/responses/input_tokens",{body:e,...n})}}class Cf extends Ne{constructor(){super(...arguments),this.inputItems=new IC(this._client),this.inputTokens=new kC(this._client)}create(e,n){return this._client.post("/responses",{body:e,...n,stream:e.stream??!1})._thenUnwrap(s=>("object"in s&&s.object==="response"&&pg(s),s))}retrieve(e,n={},s){return this._client.get(ye`/responses/${e}`,{query:n,...s,stream:n?.stream??!1})._thenUnwrap(a=>("object"in a&&a.object==="response"&&pg(a),a))}delete(e,n){return this._client.delete(ye`/responses/${e}`,{...n,headers:Ae([{Accept:"*/*"},n?.headers])})}parse(e,n){return this._client.responses.create(e,n)._thenUnwrap(s=>jC(s,e))}stream(e,n){return by.createResponse(this._client,e,n)}cancel(e,n){return this._client.post(ye`/responses/${e}/cancel`,n)}}Cf.InputItems=IC;Cf.InputTokens=kC;class MC extends Ne{create(e,n,s){return this._client.post(ye`/uploads/${e}/parts`,Ri({body:n,...s},this._client))}}class wy extends Ne{constructor(){super(...arguments),this.parts=new MC(this._client)}create(e,n){return this._client.post("/uploads",{body:e,...n})}cancel(e,n){return this._client.post(ye`/uploads/${e}/cancel`,n)}complete(e,n,s){return this._client.post(ye`/uploads/${e}/complete`,{body:n,...s})}}wy.Parts=MC;const _z=async t=>{const e=await Promise.allSettled(t),n=e.filter(a=>a.status==="rejected");if(n.length){for(const a of n)console.error(a.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const s=[];for(const a of e)a.status==="fulfilled"&&s.push(a.value);return s};class DC extends Ne{create(e,n,s){return this._client.post(ye`/vector_stores/${e}/file_batches`,{body:n,...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}retrieve(e,n,s){const{vector_store_id:a}=n;return this._client.get(ye`/vector_stores/${a}/file_batches/${e}`,{...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}cancel(e,n,s){const{vector_store_id:a}=n;return this._client.post(ye`/vector_stores/${a}/file_batches/${e}/cancel`,{...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async createAndPoll(e,n,s){const a=await this.create(e,n);return await this.poll(e,a.id,s)}listFiles(e,n,s){const{vector_store_id:a,...l}=n;return this._client.getAPIList(ye`/vector_stores/${a}/file_batches/${e}/files`,Rt,{query:l,...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async poll(e,n,s){const a=Ae([s?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":s?.pollIntervalMs?.toString()??void 0}]);for(;;){const{data:l,response:c}=await this.retrieve(n,{vector_store_id:e},{...s,headers:a}).withResponse();switch(l.status){case"in_progress":let d=5e3;if(s?.pollIntervalMs)d=s.pollIntervalMs;else{const f=c.headers.get("openai-poll-after-ms");if(f){const h=parseInt(f);isNaN(h)||(d=h)}}await oc(d);break;case"failed":case"cancelled":case"completed":return l}}}async uploadAndPoll(e,{files:n,fileIds:s=[]},a){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const l=a?.maxConcurrency??5,c=Math.min(l,n.length),d=this._client,f=n.values(),h=[...s];async function p(y){for(let _ of y){const x=await d.files.create({file:_,purpose:"assistants"},a);h.push(x.id)}}const m=Array(c).fill(f).map(p);return await _z(m),await this.createAndPoll(e,{file_ids:h})}}class BC extends Ne{create(e,n,s){return this._client.post(ye`/vector_stores/${e}/files`,{body:n,...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}retrieve(e,n,s){const{vector_store_id:a}=n;return this._client.get(ye`/vector_stores/${a}/files/${e}`,{...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}update(e,n,s){const{vector_store_id:a,...l}=n;return this._client.post(ye`/vector_stores/${a}/files/${e}`,{body:l,...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e,n={},s){return this._client.getAPIList(ye`/vector_stores/${e}/files`,Rt,{query:n,...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}delete(e,n,s){const{vector_store_id:a}=n;return this._client.delete(ye`/vector_stores/${a}/files/${e}`,{...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async createAndPoll(e,n,s){const a=await this.create(e,n,s);return await this.poll(e,a.id,s)}async poll(e,n,s){const a=Ae([s?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":s?.pollIntervalMs?.toString()??void 0}]);for(;;){const l=await this.retrieve(n,{vector_store_id:e},{...s,headers:a}).withResponse(),c=l.data;switch(c.status){case"in_progress":let d=5e3;if(s?.pollIntervalMs)d=s.pollIntervalMs;else{const f=l.response.headers.get("openai-poll-after-ms");if(f){const h=parseInt(f);isNaN(h)||(d=h)}}await oc(d);break;case"failed":case"completed":return c}}}async upload(e,n,s){const a=await this._client.files.create({file:n,purpose:"assistants"},s);return this.create(e,{file_id:a.id},s)}async uploadAndPoll(e,n,s){const a=await this.upload(e,n,s);return await this.poll(e,a.id,s)}content(e,n,s){const{vector_store_id:a}=n;return this._client.getAPIList(ye`/vector_stores/${a}/files/${e}/content`,wf,{...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}class Tf extends Ne{constructor(){super(...arguments),this.files=new BC(this._client),this.fileBatches=new DC(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:Ae([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(e,n){return this._client.get(ye`/vector_stores/${e}`,{...n,headers:Ae([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(e,n,s){return this._client.post(ye`/vector_stores/${e}`,{body:n,...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e={},n){return this._client.getAPIList("/vector_stores",Rt,{query:e,...n,headers:Ae([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}delete(e,n){return this._client.delete(ye`/vector_stores/${e}`,{...n,headers:Ae([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}search(e,n,s){return this._client.getAPIList(ye`/vector_stores/${e}/search`,wf,{body:n,method:"post",...s,headers:Ae([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}Tf.Files=BC;Tf.FileBatches=DC;class UC extends Ne{create(e,n){return this._client.post("/videos",Mx({body:e,...n},this._client))}retrieve(e,n){return this._client.get(ye`/videos/${e}`,n)}list(e={},n){return this._client.getAPIList("/videos",Vd,{query:e,...n})}delete(e,n){return this._client.delete(ye`/videos/${e}`,n)}downloadContent(e,n={},s){return this._client.get(ye`/videos/${e}/content`,{query:n,...s,headers:Ae([{Accept:"application/binary"},s?.headers]),__binaryResponse:!0})}remix(e,n,s){return this._client.post(ye`/videos/${e}/remix`,Mx({body:n,...s},this._client))}}var Ma,LC,Ed;class $C extends Ne{constructor(){super(...arguments),Ma.add(this)}async unwrap(e,n,s=this._client.webhookSecret,a=300){return await this.verifySignature(e,n,s,a),JSON.parse(e)}async verifySignature(e,n,s=this._client.webhookSecret,a=300){if(typeof crypto>"u"||typeof crypto.subtle.importKey!="function"||typeof crypto.subtle.verify!="function")throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");re(this,Ma,"m",LC).call(this,s);const l=Ae([n]).values,c=re(this,Ma,"m",Ed).call(this,l,"webhook-signature"),d=re(this,Ma,"m",Ed).call(this,l,"webhook-timestamp"),f=re(this,Ma,"m",Ed).call(this,l,"webhook-id"),h=parseInt(d,10);if(isNaN(h))throw new ml("Invalid webhook timestamp format");const p=Math.floor(Date.now()/1e3);if(p-h>a)throw new ml("Webhook timestamp is too old");if(h>p+a)throw new ml("Webhook timestamp is too new");const m=c.split(" ").map(w=>w.startsWith("v1,")?w.substring(3):w),y=s.startsWith("whsec_")?Buffer.from(s.replace("whsec_",""),"base64"):Buffer.from(s,"utf-8"),_=f?`${f}.${d}.${e}`:`${d}.${e}`,x=await crypto.subtle.importKey("raw",y,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(const w of m)try{const A=Buffer.from(w,"base64");if(await crypto.subtle.verify("HMAC",x,A,new TextEncoder().encode(_)))return}catch{continue}throw new ml("The given webhook signature does not match the expected signature")}}Ma=new WeakSet,LC=function(e){if(typeof e!="string"||e.length===0)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},Ed=function(e,n){if(!e)throw new Error("Headers are required");const s=e.get(n);if(s==null)throw new Error(`Missing required header: ${n}`);return s};var gg,xy,Sd,zC;class Pe{constructor({baseURL:e=Na("OPENAI_BASE_URL"),apiKey:n=Na("OPENAI_API_KEY"),organization:s=Na("OPENAI_ORG_ID")??null,project:a=Na("OPENAI_PROJECT_ID")??null,webhookSecret:l=Na("OPENAI_WEBHOOK_SECRET")??null,...c}={}){if(gg.add(this),Sd.set(this,void 0),this.completions=new pC(this),this.chat=new cy(this),this.embeddings=new vC(this),this.files=new bC(this),this.images=new CC(this),this.audio=new cc(this),this.moderations=new NC(this),this.models=new TC(this),this.fineTuning=new eo(this),this.graders=new _y(this),this.vectorStores=new Tf(this),this.webhooks=new $C(this),this.beta=new Za(this),this.batches=new oC(this),this.uploads=new wy(this),this.responses=new Cf(this),this.realtime=new Sf(this),this.conversations=new hy(this),this.evals=new py(this),this.containers=new fy(this),this.videos=new UC(this),n===void 0)throw new je("Missing credentials. Please pass an `apiKey`, or set the `OPENAI_API_KEY` environment variable.");const d={apiKey:n,organization:s,project:a,webhookSecret:l,...c,baseURL:e||"https://api.openai.com/v1"};if(!d.dangerouslyAllowBrowser&&b$())throw new je(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=d.baseURL,this.timeout=d.timeout??xy.DEFAULT_TIMEOUT,this.logger=d.logger??console;const f="warn";this.logLevel=f,this.logLevel=Ix(d.logLevel,"ClientOptions.logLevel",this)??Ix(Na("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??f,this.fetchOptions=d.fetchOptions,this.maxRetries=d.maxRetries??2,this.fetch=d.fetch??S$(),Ue(this,Sd,T$),this._options=d,this.apiKey=typeof n=="string"?n:"Missing Key",this.organization=s,this.project=a,this.webhookSecret=l}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){}async authHeaders(e){return Ae([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(e){return k$(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${Ia}`}defaultIdempotencyKey(){return`stainless-node-retry-${c1()}`}makeStatusError(e,n,s,a){return Gt.generate(e,n,s,a)}async _callApiKey(){const e=this._options.apiKey;if(typeof e!="function")return!1;let n;try{n=await e()}catch(s){throw s instanceof je?s:new je(`Failed to get token from 'apiKey' function: ${s.message}`,{cause:s})}if(typeof n!="string"||!n)throw new je(`Expected 'apiKey' function argument to return a string but it returned ${n}`);return this.apiKey=n,!0}buildURL(e,n,s){const a=!re(this,gg,"m",zC).call(this)&&s||this.baseURL,l=p$(e)?new URL(e):new URL(a+(a.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),c=this.defaultQuery();return g$(c)||(n={...c,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(l.search=this.stringifyQuery(n)),l.toString()}async prepareOptions(e){await this._callApiKey()}async prepareRequest(e,{url:n,options:s}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,s){return this.request(Promise.resolve(s).then(a=>({method:e,path:n,...a})))}request(e,n=null){return new bf(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,s){const a=await e,l=a.maxRetries??this.maxRetries;n==null&&(n=l),await this.prepareOptions(a);const{req:c,url:d,timeout:f}=await this.buildRequest(a,{retryCount:l-n});await this.prepareRequest(c,{url:d,options:a});const h="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),p=s===void 0?"":`, retryOf: ${s}`,m=Date.now();if(Qt(this).debug(`[${h}] sending request`,mi({retryOfRequestLogID:s,method:a.method,url:d,options:a,headers:c.headers})),a.signal?.aborted)throw new qn;const y=new AbortController,_=await this.fetchWithTimeout(d,c,f,y).catch(sg),x=Date.now();if(_ instanceof globalThis.Error){const S=`retrying, ${n} attempts remaining`;if(a.signal?.aborted)throw new qn;const T=rg(_)||/timed? ?out/i.test(String(_)+("cause"in _?String(_.cause):""));if(n)return Qt(this).info(`[${h}] connection ${T?"timed out":"failed"} - ${S}`),Qt(this).debug(`[${h}] connection ${T?"timed out":"failed"} (${S})`,mi({retryOfRequestLogID:s,url:d,durationMs:x-m,message:_.message})),this.retryRequest(a,n,s??h);throw Qt(this).info(`[${h}] connection ${T?"timed out":"failed"} - error; no more retries left`),Qt(this).debug(`[${h}] connection ${T?"timed out":"failed"} (error; no more retries left)`,mi({retryOfRequestLogID:s,url:d,durationMs:x-m,message:_.message})),T?new ey:new vf({cause:_})}const w=[..._.headers.entries()].filter(([S])=>S==="x-request-id").map(([S,T])=>", "+S+": "+JSON.stringify(T)).join(""),A=`[${h}${p}${w}] ${c.method} ${d} ${_.ok?"succeeded":"failed"} with status ${_.status} in ${x-m}ms`;if(!_.ok){const S=await this.shouldRetry(_);if(n&&S){const I=`retrying, ${n} attempts remaining`;return await C$(_.body),Qt(this).info(`${A} - ${I}`),Qt(this).debug(`[${h}] response error (${I})`,mi({retryOfRequestLogID:s,url:_.url,status:_.status,headers:_.headers,durationMs:x-m})),this.retryRequest(a,n,s??h,_.headers)}const T=S?"error; no more retries left":"error; not retryable";Qt(this).info(`${A} - ${T}`);const E=await _.text().catch(I=>sg(I).message),C=_$(E),O=C?void 0:E;throw Qt(this).debug(`[${h}] response error (${T})`,mi({retryOfRequestLogID:s,url:_.url,status:_.status,headers:_.headers,message:O,durationMs:Date.now()-m})),this.makeStatusError(_.status,C,O,_.headers)}return Qt(this).info(A),Qt(this).debug(`[${h}] response start`,mi({retryOfRequestLogID:s,url:_.url,status:_.status,headers:_.headers,durationMs:x-m})),{response:_,options:a,controller:y,requestLogID:h,retryOfRequestLogID:s,startTime:m}}getAPIList(e,n,s){return this.requestAPIList(n,{method:"get",path:e,...s})}requestAPIList(e,n){const s=this.makeRequest(n,null,void 0);return new H$(this,s,e)}async fetchWithTimeout(e,n,s,a){const{signal:l,method:c,...d}=n||{};l&&l.addEventListener("abort",()=>a.abort());const f=setTimeout(()=>a.abort(),s),h=globalThis.ReadableStream&&d.body instanceof globalThis.ReadableStream||typeof d.body=="object"&&d.body!==null&&Symbol.asyncIterator in d.body,p={signal:a.signal,...h?{duplex:"half"}:{},method:"GET",...d};c&&(p.method=c.toUpperCase());try{return await this.fetch.call(void 0,e,p)}finally{clearTimeout(f)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,s,a){let l;const c=a?.get("retry-after-ms");if(c){const f=parseFloat(c);Number.isNaN(f)||(l=f)}const d=a?.get("retry-after");if(d&&!l){const f=parseFloat(d);Number.isNaN(f)?l=Date.parse(d)-Date.now():l=f*1e3}if(!(l&&0<=l&&l<60*1e3)){const f=e.maxRetries??this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(n,f)}return await oc(l),this.makeRequest(e,n-1,s)}calculateDefaultRetryTimeoutMillis(e,n){const l=n-e,c=Math.min(.5*Math.pow(2,l),8),d=1-Math.random()*.25;return c*d*1e3}async buildRequest(e,{retryCount:n=0}={}){const s={...e},{method:a,path:l,query:c,defaultBaseURL:d}=s,f=this.buildURL(l,c,d);"timeout"in s&&v$("timeout",s.timeout),s.timeout=s.timeout??this.timeout;const{bodyHeaders:h,body:p}=this.buildBody({options:s}),m=await this.buildHeaders({options:e,method:a,bodyHeaders:h,retryCount:n});return{req:{method:a,headers:m,...s.signal&&{signal:s.signal},...globalThis.ReadableStream&&p instanceof globalThis.ReadableStream&&{duplex:"half"},...p&&{body:p},...this.fetchOptions??{},...s.fetchOptions??{}},url:f,timeout:s.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:s,retryCount:a}){let l={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=e.idempotencyKey);const c=Ae([l,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(a),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...E$(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(e),this._options.defaultHeaders,s,e.headers]);return this.validateHeaders(c),c.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const s=Ae([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&s.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:x1(e)}:re(this,Sd,"f").call(this,{body:e,headers:s})}}xy=Pe,Sd=new WeakMap,gg=new WeakSet,zC=function(){return this.baseURL!=="https://api.openai.com/v1"};Pe.OpenAI=xy;Pe.DEFAULT_TIMEOUT=6e5;Pe.OpenAIError=je;Pe.APIError=Gt;Pe.APIConnectionError=vf;Pe.APIConnectionTimeoutError=ey;Pe.APIUserAbortError=qn;Pe.NotFoundError=h1;Pe.ConflictError=m1;Pe.RateLimitError=g1;Pe.BadRequestError=u1;Pe.AuthenticationError=d1;Pe.InternalServerError=y1;Pe.PermissionDeniedError=f1;Pe.UnprocessableEntityError=p1;Pe.InvalidWebhookSignatureError=ml;Pe.toFile=G$;Pe.Completions=pC;Pe.Chat=cy;Pe.Embeddings=vC;Pe.Files=bC;Pe.Images=CC;Pe.Audio=cc;Pe.Moderations=NC;Pe.Models=TC;Pe.FineTuning=eo;Pe.Graders=_y;Pe.VectorStores=Tf;Pe.Webhooks=$C;Pe.Beta=Za;Pe.Batches=oC;Pe.Uploads=wy;Pe.Responses=Cf;Pe.Realtime=Sf;Pe.Conversations=hy;Pe.Evals=py;Pe.Containers=fy;Pe.Videos=UC;function bz(){const{projectId:t,ep_id:e,setEpId:n,setDeepseekProvider:s,updateEmbodyCache:a,embodyCache:l}=_r(),[c,d]=k.useState(null),[f,h]=k.useState([]),[p,m]=k.useState(!1),[y,_]=k.useState(""),[x,w]=k.useState("");Ps();let A=[];k.useEffect(()=>{t&&(d(""),Te.from("movie_eps").select("*").eq("project_id",t).order("index",{ascending:!0}).then(({data:z,error:Y})=>{if(Y){d(Y.message);return}h(z),console.log(z)}),Te.from("LLM").select("*").eq("provider_name","deepseek").single().then(({data:z,error:Y})=>{if(Y){d(Y.message);return}s(z)}))},[t]);const S=()=>{m(!0)},T=()=>{if(!x.trim()){d("");return}const z=document.createElement("input");z.type="file",z.accept=".json",z.onchange=E,z.click()},E=z=>{const Y=z.target.files[0];if(Y){const H=new FileReader;H.readAsText(Y,"utf-8"),H.onload=F=>{const N=F.target.result;try{const B=JSON.parse(N);console.log(B),P(B)}catch(B){console.error("JSON :",B)}}}},C=z=>{n(z),localStorage.setItem("epId",z),Ft.emit("changeEditorMode","shot")},O=()=>{m(!1),_(""),w(""),d(null)},[j,I]=k.useState(!1),D=async(z,Y,H)=>{let F=[];console.log(A);for(let N of Y){let B=A.find(U=>U.name===N);if(B)F.push(B.id);else{const{data:U,error:$}=await Te.from("embodys").insert([{project_id:t,name:N,type:"character"}]).select("id, name,type").single();if($){d($.message);return}F.push(U.id),A.push(U)}}{let N=A.find(B=>B.name===z);if(N)F.push(N.id);else{const{data:B,error:U}=await Te.from("embodys").insert([{project_id:t,name:z,type:"scene"}]).select("id, name,type").single();if(U){d(U.message);return}F.push(B.id),A.push(B)}}for(let N of H){let B=A.find(U=>U.name===N);if(B)F.push(B.id);else{const{data:U,error:$}=await Te.from("embodys").insert([{project_id:t,name:N,type:"item"}]).select("id, name,type").single();if($){d($.message);return}F.push(U.id),A.push(U)}}return F},P=async z=>{I(!0),await a(),A=Object.values(l);try{const{data:Y,error:H}=await Te.from("movie_eps").insert([{project_id:t,title:z.episode_name,description:z.description,index:parseInt(x)}]).select("*").single();if(H)throw H;if(z.sc&&Array.isArray(z.sc))for(let F=0;F<z.sc.length;F++){const N=z.sc[F],{data:B,error:U}=await Te.from("movie_scs").insert([{ep_id:Y.id,name:N.scene_name,description:N.description,index:F+1}]).select("*").single();if(U){console.error(":",U),I(!1);continue}if(console.log(` ${N.scene_name} `),N.seq)for(let $=0;$<N.seq.length;$++){const Q=N.seq[$],{data:M,error:q}=await Te.from("movie_seqs").insert([{sc_id:B.id,name:Q.sequence_name,index:$+1}]).select("*").single();if(q){console.error(":",q),I(!1);continue}console.log(` ${Q.sequence_name} ${Q.shots.length}  ${M.id}`);for(let X=0;X<Q.shots.length;X++){const Z=Q.shots[X],{data:J,error:ae}=await Te.from("movie_shots").insert([{seq_id:M.id,description:Z.description,index:X+1,prompt:Z.prompt,duration:parseFloat(Z.duration),dialogue:Z.dialogue,embodys:await D(Z.scene,Z.Character,Z.Prop)}]).select("*").single()}}}h([...f,Y]),O(),await a()}catch(Y){d(": "+Y.message)}finally{I(!1)}},G=async()=>{if(!x.trim()){d("");return}const z=parseInt(x);if(f.find(H=>H.index===z)){d(`${z}`);return}I(!0),d(null);try{let H=!1,F={};if(!H){const B=await(await fetch("./test_story.json",{})).json();console.log("testData:",B),F=B}return}catch(H){d(": "+H.message)}finally{I(!1)}},V=async z=>{try{const{error:Y}=await Te.from("movie_eps").delete().eq("id",z.id);if(Y)throw Y;h(f.filter(H=>H.id!==z.id))}catch(Y){d(": "+Y.message)}finally{}};return b.jsxs("div",{className:"ep-editor-container",children:[b.jsx("div",{className:"ep-editor-header",children:b.jsx("button",{className:"add-ep-button",onClick:S,children:"+ "})}),c&&b.jsx("div",{className:"error-message",children:b.jsx("p",{children:c})}),b.jsx("div",{className:"ep-list",children:f.length>0?f.map(z=>b.jsxs("div",{className:"ep-card",onClick:()=>C(z.id),children:[b.jsx("div",{className:"ep-thumbnail",children:z.pic?b.jsx("img",{src:z.pic,alt:z.title}):b.jsx("span",{children:""})}),b.jsxs("div",{className:"ep-content",children:[b.jsx("h3",{className:"ep-title",children:z.title||`EP ${z.index||""}`}),b.jsx("p",{className:"ep-description",children:z.description||""}),b.jsxs("div",{className:"ep-info",children:[b.jsxs("span",{children:["",z.index||"?",""]}),b.jsx("span",{children:z.created_at?new Date(z.created_at).toLocaleDateString():""})]})]}),b.jsx("div",{className:"delete-ep-button",children:b.jsx("button",{onClick:Y=>{Y.stopPropagation(),V(z)},children:""})})]},z.id)):b.jsxs("div",{className:"empty-state",children:[b.jsx("h3",{children:""}),b.jsx("p",{children:'""'})]})}),p&&b.jsx("div",{className:"modal-overlay",onClick:O,children:b.jsxs("div",{className:"modal-content",onClick:z=>z.stopPropagation(),children:[b.jsxs("div",{className:"modal-header",children:[b.jsx("h3",{children:""}),b.jsx("button",{className:"close-button",onClick:O,children:""})]}),c&&b.jsx("div",{className:"error-message",children:b.jsx("p",{children:c})}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"ep-number",children:" *"}),b.jsx("input",{id:"ep-number",type:"number",value:x,onChange:z=>{const Y=parseInt(z.target.value),H=f.find(F=>F.index===Y);console.log(H),H!=null?d(`${Y}`):d(null),w(z.target.value)},placeholder:"",min:"1",required:!0})]}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"ep-description",children:" *"}),b.jsx("textarea",{id:"ep-description",value:y,onChange:z=>_(z.target.value),placeholder:"",rows:"18"})]}),b.jsxs("div",{className:"modal-actions",children:[b.jsx("button",{className:"cancel-button",onClick:T,disabled:j,children:""}),b.jsx("button",{className:"cancel-button",onClick:O,children:""}),b.jsx("button",{className:"save-button",onClick:G,disabled:j,children:j?"...":""})]})]})})]})}function wz(){const{projectId:t,setProjectId:e}=_r(),[n,s]=k.useState(""),[a,l]=k.useState("script"),[c,d]=k.useState(""),[f,h]=k.useState(null),p=Ps();return k.useEffect(()=>{t&&(Ft.emit("StartEditorMode"),Te.from("projects").select("*").eq("id",t).single().then(({data:m,error:y})=>{y?(console.error(":",y),h(""),d("// : ")):s(m.name||"")}),Ft.on("changeEditorMode",m=>{l(m)}),Te.from("embodys").select("*").eq("project_id",t).then(({data:m,error:y})=>{y&&(console.error(":",y),h(""),d("// : "))}))},[t]),b.jsxs("div",{className:"editor-container",children:[f&&b.jsx("div",{className:"error-message",children:b.jsx("p",{children:f})}),b.jsxs("div",{className:"editor-header",children:[b.jsx("div",{className:"project_name",onClick:()=>{p("/dashboard"),Ft.emit("EndEditorMode"),e(null)},children:b.jsxs("h3",{children:["< ",n]})}),b.jsxs("div",{className:"editor-nav",children:[b.jsx("div",{className:`editor-nav-item ${a==="script"?"editor-nav-item-selected":""}`,onClick:()=>l("script"),children:""}),b.jsx("div",{className:`editor-nav-item ${a==="shot"?"editor-nav-item-selected":""}`,onClick:()=>l("shot"),children:""}),b.jsx("div",{className:`editor-nav-item ${a==="edit"?"editor-nav-item-selected":""}`,onClick:()=>l("edit"),children:""})]})]}),b.jsxs("div",{className:"editor-content",children:[a==="script"&&b.jsx(bz,{}),a==="shot"&&b.jsx(YI,{}),a==="edit"&&b.jsx(h$,{})]})]})}function xz(){const{projectId:t}=_r(),[e,n]=k.useState(!1),[s,a]=k.useState([]),[l,c]=k.useState([]),[d,f]=k.useState([]),[h,p]=k.useState(""),[m,y]=k.useState("all"),[_,x]=k.useState(!0),[w,A]=k.useState(""),[S,T]=k.useState([]),[E,C]=k.useState(""),O=k.useRef(null),[j,I]=k.useState(null),[D,P]=k.useState({type:"",name:"",pic:"",description:"",embody_images:[]}),[G,V]=k.useState(!1),[z,Y]=k.useState(!1),[H,F]=k.useState({project_id:t,type:"scene",name:"",prompt:"",description:"",pic:""}),[N,B]=k.useState(null),[U,$]=k.useState("");k.useEffect(()=>{if(!t){A("ID Embody"),x(!1);return}const fe=new AbortController;return M(fe),()=>{console.log("FetchEmboody:",fe.signal),fe.abort()}},[t]),k.useEffect(()=>{},[G]);const Q=(fe,ve)=>{const Ie=S.filter(Je=>Je.type===ve);if(h.trim()==="")return Ie;const Xe=h.toLowerCase();return Ie.filter(Je=>Je.name.toLowerCase().includes(Xe)||Je.description&&Je.description.toLowerCase().includes(Xe))},M=async fe=>{if(!t)return A("ID Embody"),alert("ID Embody"),x(!1),null;x(!0),A("");try{console.log(" ID:",t);const{data:ve}=await Te.from("embodys").select(`
                    *,
                    embody_images (
                        *
                    )
                `).abortSignal(fe.signal).eq("project_id",t);T(ve||[]),console.log(":",ve||[])}catch(ve){ve.name==="AbortError"?console.log("FetchEmboody:",ve):(console.error(":",ve),A(""))}finally{x(!1)}},q=fe=>{const ve=S.find(Ie=>Ie.id===fe);ve&&(console.log(":",ve),I(fe),P({id:ve.id,type:ve.type,name:ve.name||"",pic:ve.pic||"",description:ve.description||"",prompt:ve.prompt||"",embody_images:ve.embody_images||[]}))},X=async()=>{if(j)try{console.log(":",j,D);const{error:fe}=await Te.from("embodys").update({name:D.name,type:D.type,description:D.description,prompt:D.prompt}).eq("id",j);if(fe){console.error(":",fe),alert("");return}M(new AbortController),I(null)}catch(fe){console.error(":",fe),alert("")}},Z=async()=>{try{const fe=D.type==="scene"?"":D.type==="character"?"":"",ve=D.name||`${fe}`;alert("..."),await new Promise(Xe=>setTimeout(Xe,1e3));let Ie="";D.type==="scene"?Ie=`${ve}8K`:D.type==="character"?Ie=`${ve}8K`:Ie=`${ve}3D8K`,P({...D,prompt:Ie}),alert("")}catch(fe){console.error(":",fe),alert("")}},J=()=>{O.current.click()},ae=async fe=>{const ve=Array.from(fe.target.files);if(ve.length>0){n(!0),console.log("Selected file:",ve),ve.forEach((it,mn)=>{console.log(":",it)}),console.log(D);let Ie=ve.map(async(it,mn)=>{const Zt=Date.now(),dt=it.name.split(".").pop()||"",pn=`public/${t}/${D.type}/${Zt}_${mn}${dt?"."+dt:""}`;console.log(":",pn);const{data:In,error:nn}=await Te.storage.from("embodys").upload(pn,it,{cacheControl:"3600",upsert:!1});if(nn)throw console.error(":",nn),new Error(": "+nn.message);const{data:gn,error:wr}=await Te.from("embody_images").insert({description:H.description,path:pn,ref_id:D.id}).select("id, path").single();if(wr)throw console.error("embody-images:",wr),new Error("images: "+wr.message);return console.log(":",gn),{insertedDataId:gn.id,fileName:pn}});const Xe=await Promise.all(Ie);let Je=Xe.map(it=>it.insertedDataId),pt=Xe.map(it=>({path:it.fileName}));console.log("IDs:",Je),console.log(":",pt),P({...D,images:pt}),n(!1),M(new AbortController)}},ce=async()=>{try{if(!D.prompt){alert("");return}alert("..."),await new Promise(fe=>setTimeout(fe,2e3)),alert(`
AI`)}catch(fe){console.error(":",fe),alert("")}},de=async()=>{if(!H.name.trim()){alert("");return}if(!H.prompt.trim()){alert("");return}if(!H.description.trim()){alert("");return}if(!H.project_id&&(H.project_id=globalData.projectId||localStorage.getItem("projectId"),!H.project_id)){alert("ID"),Y(!1);return}try{let fe=H.pic,ve="";if(N){const pt=Date.now(),it=N.name.split(".").pop()||"";ve=`${H.project_id}/${H.type}s/${pt}${it?"."+it:""}`,console.log(":",ve);const{data:mn,error:Zt}=await Te.storage.from("embodys").upload(ve,N,{cacheControl:"3600",upsert:!1});if(Zt)throw console.error(":",Zt),new Error(": "+Zt.message);const{data:{publicUrl:dt}}=await Te.storage.from("embodys").getPublicUrl(ve);fe=dt,console.log("URL:",fe)}const Ie={...H,pic:ve};console.log(":",Ie);const{data:Xe,error:Je}=await Te.from("embodys").insert([Ie]);if(Je)throw console.error(":",Je),Je;V(pt=>!pt),Y(!1),F({project_id:globalData.projectId||localStorage.getItem("projectId"),type:"scene",name:"",prompt:"",description:"",pic:""}),B(null),$(""),document.getElementById("embody-file")&&(document.getElementById("embody-file").value=""),alert("")}catch(fe){console.error(":",fe),alert(""+(fe.message||""))}},ie=async(fe,ve)=>{if(window.confirm(`${ve==="scene"?"":ve==="character"?"":""}`))try{const{error:Ie}=await Te.from("embodys").delete().eq("id",fe);if(Ie)throw Ie;console.log(":",fe),M(new AbortController)}catch(Ie){console.error(":",Ie)}},pe=(()=>{const fe=S.filter(Xe=>Xe.type==="scene").length,ve=S.filter(Xe=>Xe.type==="character").length,Ie=S.filter(Xe=>Xe.type==="item").length;return{scene:fe,character:ve,item:Ie,all:fe+ve+Ie}})(),be=Q(s,"scene"),_e=Q(l,"character"),Me=Q(d,"item");return b.jsxs("div",{className:"embody-container",children:[b.jsxs("div",{className:"embody-left-panel",children:[b.jsxs("div",{className:"embody-header",children:[b.jsxs("div",{className:"header-left",children:[b.jsx("h2",{children:""}),b.jsxs("p",{className:"total-count",children:[E," -  ",pe.all," "]})]}),b.jsxs("div",{className:"header-right",children:[b.jsx("input",{type:"file",multiple:!0,ref:O,style:{display:"none"},onChange:ae}),b.jsx("div",{className:"search-bar",children:b.jsx("input",{type:"text",placeholder:"...",value:h,onChange:fe=>p(fe.target.value)})})]})]}),b.jsxs("div",{className:"category-filter",children:[b.jsxs("button",{className:`filter-btn ${m==="all"?"active":""}`,onClick:()=>y("all"),children:[" (",pe.all,")"]}),b.jsxs("button",{className:`filter-btn ${m==="scene"?"active":""}`,onClick:()=>y("scene"),children:[" (",pe.scene,")"]}),b.jsxs("button",{className:`filter-btn ${m==="character"?"active":""}`,onClick:()=>y("character"),children:[" (",pe.character,")"]}),b.jsxs("button",{className:`filter-btn ${m==="item"?"active":""}`,onClick:()=>y("item"),children:[" (",pe.item,")"]}),b.jsx("button",{onClick:()=>Y(!0),className:"add-embody-btn",children:""})]}),b.jsx("div",{className:"embody-content",children:_?b.jsxs("div",{className:"loading-container",children:[b.jsx("div",{className:"loading-spinner"}),b.jsx("p",{children:"..."})]}):w?b.jsxs("div",{className:"error-container",children:[b.jsx("p",{className:"error-message",children:w}),b.jsx("button",{className:"retry-btn",onClick:()=>M(new AbortController),children:""})]}):b.jsxs(b.Fragment,{children:[(m==="all"||m==="scene")&&be.length>0&&b.jsxs("div",{className:"category-section",children:[b.jsx("h3",{className:"section-title",children:""}),b.jsx("div",{className:"card-grid",children:be.map(fe=>b.jsx(dd,{id:fe.id,type:"scene",name:fe.name,pic:fe.embody_images,description:fe.description,onEdit:()=>q(fe.id),onDelete:()=>ie(fe.id,"scene")},fe.id))})]}),(m==="all"||m==="character")&&_e.length>0&&b.jsxs("div",{className:"category-section",children:[b.jsx("h3",{className:"section-title",children:""}),b.jsx("div",{className:"card-grid",children:_e.map(fe=>b.jsx(dd,{id:fe.id,type:"character",name:fe.name,pic:fe.embody_images,description:fe.description,onEdit:()=>q(fe.id),onDelete:()=>ie(fe.id,"character")},fe.id))})]}),(m==="all"||m==="item")&&Me.length>0&&b.jsxs("div",{className:"category-section",children:[b.jsx("h3",{className:"section-title",children:""}),b.jsx("div",{className:"card-grid",children:Me.map(fe=>b.jsx(dd,{id:fe.id,type:"item",name:fe.name,pic:fe.embody_images,description:fe.description,onEdit:()=>q(fe.id),onDelete:()=>ie(fe.id,"item")},fe.id))})]}),(m==="all"&&pe.all===0||m==="scene"&&be.length===0||m==="character"&&_e.length===0||m==="item"&&Me.length===0)&&b.jsx("div",{className:"empty-container",children:b.jsx("p",{children:""})})]})})]}),b.jsx("div",{className:"embody-right-panel",children:j?b.jsxs("div",{className:"edit-panel",children:[b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"edit-name",children:""}),b.jsx("input",{id:"edit-name",type:"text",value:D.name,onChange:fe=>P({...D,name:fe.target.value}),placeholder:""})]}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"edit-type",children:""}),b.jsxs("select",{id:"edit-type",value:D.type,onChange:fe=>P({...D,type:fe.target.value}),children:[b.jsx("option",{value:"scene",children:""}),b.jsx("option",{value:"character",children:""}),b.jsx("option",{value:"item",children:""})]})]}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"edit-description",children:""}),b.jsx("textarea",{id:"edit-description",value:D.description,onChange:fe=>P({...D,description:fe.target.value}),placeholder:"",rows:"3"})]}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"edit-prompt",children:""}),b.jsx("textarea",{id:"edit-prompt",value:D.prompt,onChange:fe=>P({...D,prompt:fe.target.value}),placeholder:"AI",rows:"4"}),b.jsx("button",{className:"prompt-generate-btn",onClick:Z,children:""})]}),b.jsx("div",{className:"form-group",children:b.jsx("div",{className:"preview-images-container",children:D.embody_images.map((fe,ve)=>b.jsx("div",{className:"small-preview-image",children:b.jsx("img",{src:_i+fe.path,alt:D.name})},ve))})}),D.pic&&b.jsx("div",{className:"preview-image",children:b.jsx("img",{src:_i+D.pic,alt:D.name})}),b.jsxs("button",{className:"",onClick:J,disabled:e,children:[" ",e?"...":""]}),b.jsx("button",{className:"generate-image-btn",onClick:ce,children:"AI"}),b.jsx("button",{className:"save-btn",onClick:X,children:""}),b.jsx("button",{className:"cancel-btn",onClick:()=>I(null),children:""})]}):b.jsx("div",{className:"empty-edit-panel",children:b.jsx("p",{children:""})})}),z&&b.jsx("div",{className:"modal-overlay",onClick:()=>Y(!1),children:b.jsxs("div",{className:"modal-content",onClick:fe=>fe.stopPropagation(),children:[b.jsxs("div",{className:"modal-header",children:[b.jsx("h3",{children:""}),b.jsx("button",{className:"close-btn",onClick:()=>Y(!1),children:""})]}),b.jsxs("div",{className:"modal-body",children:[b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"embody-type",children:""}),b.jsxs("select",{id:"embody-type",value:H.type,onChange:fe=>F({...H,type:fe.target.value}),children:[b.jsx("option",{value:"scene",children:""}),b.jsx("option",{value:"character",children:""}),b.jsx("option",{value:"item",children:""})]})]}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"embody-name",children:""}),b.jsx("input",{type:"text",id:"embody-name",value:H.name,onChange:fe=>F({...H,name:fe.target.value}),placeholder:""})]}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"embody-prompt",children:""}),b.jsx("textarea",{id:"embody-prompt",value:H.prompt,onChange:fe=>F({...H,prompt:fe.target.value}),placeholder:"",rows:"3"})]}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"embody-description",children:""}),b.jsx("textarea",{id:"embody-description",value:H.description,onChange:fe=>F({...H,description:fe.target.value}),placeholder:"",rows:"4"})]}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{children:""}),b.jsxs("div",{className:"file-upload-container",children:[b.jsx("input",{type:"file",multiple:!0,id:"embody-file",accept:"image/*",onChange:fe=>{const ve=fe.target.files[0];if(B(ve),ve){const Ie=URL.createObjectURL(ve);$(Ie)}else $("")},style:{display:"none"}}),b.jsx("button",{type:"button",className:"file-upload-btn",onClick:()=>document.getElementById("embody-file").click(),children:N?N.name:""}),U&&b.jsxs("div",{className:"image-preview",children:[b.jsx("img",{src:U,alt:""}),b.jsx("button",{type:"button",className:"remove-image-btn",onClick:()=>{B(null),$(""),document.getElementById("embody-file").value=""},children:""})]})]})]})]}),b.jsxs("div",{className:"modal-footer",children:[b.jsx("button",{className:"cancel-btn",onClick:()=>Y(!1),children:""}),b.jsx("button",{className:"save-btn",onClick:()=>de(),children:""})]})]})})]})}function Az(){const[t,e]=k.useState(null),[n,s]=k.useState(!1),[a,l]=k.useState("");k.useEffect(()=>{const d=async()=>{const{data:{user:h}}=await Te.auth.getUser();e(h)},{data:f}=Te.auth.onAuthStateChange((h,p)=>{e(p?.user||null)});return d(),Ft.on("StartEditorMode",()=>{console.log(":"),c(!0)}),Ft.on("EndEditorMode",()=>{console.log(""),c(!1)}),Ft.on("showLargeImageModal",h=>{s(!0),l(h)}),()=>{}},[]);function c(d){const f=document.documentElement;d?(f.style.setProperty("--left-panel-width","40px"),f.style.setProperty("--logo-text-display","none")):(f.style.setProperty("--left-panel-width","200px"),f.style.setProperty("--logo-text-display","block"))}return c(!0),b.jsx(zI,{children:b.jsxs(pO,{children:[b.jsxs("div",{className:"layout-container",children:[b.jsxs("div",{className:"left-panel",children:[b.jsxs(Ai,{to:"/",className:"home-logo",children:[b.jsx("img",{className:"home-logo-img",src:"./vite.svg",alt:"home"}),b.jsx("p",{className:"home-logo-text",children:"AI"})]}),b.jsxs("div",{className:"nav-items",children:[b.jsxs(Ai,{to:"/dashboard",className:"nav-item",title:"",children:[b.jsx("img",{className:"nav-item-icon",src:"./home.png",alt:""}),b.jsx("span",{children:""})]}),b.jsxs(Ai,{to:"/embody",className:"nav-item",title:"",children:[b.jsx("img",{className:"nav-item-icon",src:"./layers.png",alt:""}),b.jsx("span",{children:"  "})]})]}),b.jsx(PI,{})]}),b.jsx("div",{className:"right-panel",children:b.jsxs(FR,{children:[b.jsx(Us,{path:"/",element:b.jsx(GI,{})}),b.jsx(Us,{path:"/editor",element:b.jsx(wz,{})}),b.jsx(Us,{path:"/embody",element:b.jsx(xz,{})}),b.jsx(Us,{path:"/login",element:b.jsx(HI,{})}),b.jsx(Us,{path:"/register",element:b.jsx(qI,{})}),b.jsx(Us,{path:"/dashboard",element:b.jsx(VI,{})}),b.jsx(Us,{path:"/profile",element:b.jsx(FI,{})})]})})]}),n&&b.jsxs("div",{className:"large-image-modal",children:[b.jsx("img",{src:a,alt:"Large Character Preview"}),b.jsx("button",{onClick:()=>s(!1),children:""})]})]})})}nR.createRoot(document.getElementById("root")).render(b.jsx(k.StrictMode,{children:b.jsx(Az,{})}));
