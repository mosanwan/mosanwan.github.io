function qN(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in t)){const l=Object.getOwnPropertyDescriptor(s,a);l&&Object.defineProperty(t,a,l.get?l:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();function Kd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Yx(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function s(){var a=!1;try{a=this instanceof s}catch{}return a?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var a=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,a.get?a:{enumerable:!0,get:function(){return t[s]}})}),n}var Im={exports:{}},Qo={};var t_;function HN(){if(t_)return Qo;t_=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(s,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var d in a)d!=="key"&&(l[d]=a[d])}else l=a;return a=l.ref,{$$typeof:t,type:s,key:c,ref:a!==void 0?a:null,props:l}}return Qo.Fragment=e,Qo.jsx=n,Qo.jsxs=n,Qo}var n_;function VN(){return n_||(n_=1,Im.exports=HN()),Im.exports}var _=VN(),Lm={exports:{}},Le={};var r_;function FN(){if(r_)return Le;r_=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),v=Symbol.iterator;function b(D){return D===null||typeof D!="object"?null:(D=v&&D[v]||D["@@iterator"],typeof D=="function"?D:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function A(D,z,J){this.props=D,this.context=z,this.refs=S,this.updater=J||x}A.prototype.isReactComponent={},A.prototype.setState=function(D,z){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,z,"setState")},A.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function N(){}N.prototype=A.prototype;function E(D,z,J){this.props=D,this.context=z,this.refs=S,this.updater=J||x}var C=E.prototype=new N;C.constructor=E,w(C,A.prototype),C.isPureReactComponent=!0;var O=Array.isArray;function R(){}var M={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function q(D,z,J){var ee=J.ref;return{$$typeof:t,type:D,key:z,ref:ee!==void 0?ee:null,props:J}}function K(D,z){return q(D.type,z,D.props)}function Y(D){return typeof D=="object"&&D!==null&&D.$$typeof===t}function $(D){var z={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(J){return z[J]})}var Q=/\/+/g;function B(D,z){return typeof D=="object"&&D!==null&&D.key!=null?$(""+D.key):z.toString(36)}function G(D){switch(D.status){case"fulfilled":return D.value;case"rejected":throw D.reason;default:switch(typeof D.status=="string"?D.then(R,R):(D.status="pending",D.then(function(z){D.status==="pending"&&(D.status="fulfilled",D.value=z)},function(z){D.status==="pending"&&(D.status="rejected",D.reason=z)})),D.status){case"fulfilled":return D.value;case"rejected":throw D.reason}}throw D}function k(D,z,J,ee,he){var pe=typeof D;(pe==="undefined"||pe==="boolean")&&(D=null);var ae=!1;if(D===null)ae=!0;else switch(pe){case"bigint":case"string":case"number":ae=!0;break;case"object":switch(D.$$typeof){case t:case e:ae=!0;break;case g:return ae=D._init,k(ae(D._payload),z,J,ee,he)}}if(ae)return he=he(D),ae=ee===""?"."+B(D,0):ee,O(he)?(J="",ae!=null&&(J=ae.replace(Q,"$&/")+"/"),k(he,z,J,"",function(de){return de})):he!=null&&(Y(he)&&(he=K(he,J+(he.key==null||D&&D.key===he.key?"":(""+he.key).replace(Q,"$&/")+"/")+ae)),z.push(he)),1;ae=0;var le=ee===""?".":ee+":";if(O(D))for(var Z=0;Z<D.length;Z++)ee=D[Z],pe=le+B(ee,Z),ae+=k(ee,z,J,pe,he);else if(Z=b(D),typeof Z=="function")for(D=Z.call(D),Z=0;!(ee=D.next()).done;)ee=ee.value,pe=le+B(ee,Z++),ae+=k(ee,z,J,pe,he);else if(pe==="object"){if(typeof D.then=="function")return k(G(D),z,J,ee,he);throw z=String(D),Error("Objects are not valid as a React child (found: "+(z==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":z)+"). If you meant to render a collection of children, use an array instead.")}return ae}function L(D,z,J){if(D==null)return D;var ee=[],he=0;return k(D,ee,"","",function(pe){return z.call(J,pe,he++)}),ee}function V(D){if(D._status===-1){var z=D._result;z=z(),z.then(function(J){(D._status===0||D._status===-1)&&(D._status=1,D._result=J)},function(J){(D._status===0||D._status===-1)&&(D._status=2,D._result=J)}),D._status===-1&&(D._status=0,D._result=z)}if(D._status===1)return D._result.default;throw D._result}var P=typeof reportError=="function"?reportError:function(D){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof D=="object"&&D!==null&&typeof D.message=="string"?String(D.message):String(D),error:D});if(!window.dispatchEvent(z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",D);return}console.error(D)},H={map:L,forEach:function(D,z,J){L(D,function(){z.apply(this,arguments)},J)},count:function(D){var z=0;return L(D,function(){z++}),z},toArray:function(D){return L(D,function(z){return z})||[]},only:function(D){if(!Y(D))throw Error("React.Children.only expected to receive a single React element child.");return D}};return Le.Activity=p,Le.Children=H,Le.Component=A,Le.Fragment=n,Le.Profiler=a,Le.PureComponent=E,Le.StrictMode=s,Le.Suspense=h,Le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=M,Le.__COMPILER_RUNTIME={__proto__:null,c:function(D){return M.H.useMemoCache(D)}},Le.cache=function(D){return function(){return D.apply(null,arguments)}},Le.cacheSignal=function(){return null},Le.cloneElement=function(D,z,J){if(D==null)throw Error("The argument must be a React element, but you passed "+D+".");var ee=w({},D.props),he=D.key;if(z!=null)for(pe in z.key!==void 0&&(he=""+z.key),z)!I.call(z,pe)||pe==="key"||pe==="__self"||pe==="__source"||pe==="ref"&&z.ref===void 0||(ee[pe]=z[pe]);var pe=arguments.length-2;if(pe===1)ee.children=J;else if(1<pe){for(var ae=Array(pe),le=0;le<pe;le++)ae[le]=arguments[le+2];ee.children=ae}return q(D.type,he,ee)},Le.createContext=function(D){return D={$$typeof:c,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null},D.Provider=D,D.Consumer={$$typeof:l,_context:D},D},Le.createElement=function(D,z,J){var ee,he={},pe=null;if(z!=null)for(ee in z.key!==void 0&&(pe=""+z.key),z)I.call(z,ee)&&ee!=="key"&&ee!=="__self"&&ee!=="__source"&&(he[ee]=z[ee]);var ae=arguments.length-2;if(ae===1)he.children=J;else if(1<ae){for(var le=Array(ae),Z=0;Z<ae;Z++)le[Z]=arguments[Z+2];he.children=le}if(D&&D.defaultProps)for(ee in ae=D.defaultProps,ae)he[ee]===void 0&&(he[ee]=ae[ee]);return q(D,pe,he)},Le.createRef=function(){return{current:null}},Le.forwardRef=function(D){return{$$typeof:d,render:D}},Le.isValidElement=Y,Le.lazy=function(D){return{$$typeof:g,_payload:{_status:-1,_result:D},_init:V}},Le.memo=function(D,z){return{$$typeof:f,type:D,compare:z===void 0?null:z}},Le.startTransition=function(D){var z=M.T,J={};M.T=J;try{var ee=D(),he=M.S;he!==null&&he(J,ee),typeof ee=="object"&&ee!==null&&typeof ee.then=="function"&&ee.then(R,P)}catch(pe){P(pe)}finally{z!==null&&J.types!==null&&(z.types=J.types),M.T=z}},Le.unstable_useCacheRefresh=function(){return M.H.useCacheRefresh()},Le.use=function(D){return M.H.use(D)},Le.useActionState=function(D,z,J){return M.H.useActionState(D,z,J)},Le.useCallback=function(D,z){return M.H.useCallback(D,z)},Le.useContext=function(D){return M.H.useContext(D)},Le.useDebugValue=function(){},Le.useDeferredValue=function(D,z){return M.H.useDeferredValue(D,z)},Le.useEffect=function(D,z){return M.H.useEffect(D,z)},Le.useEffectEvent=function(D){return M.H.useEffectEvent(D)},Le.useId=function(){return M.H.useId()},Le.useImperativeHandle=function(D,z,J){return M.H.useImperativeHandle(D,z,J)},Le.useInsertionEffect=function(D,z){return M.H.useInsertionEffect(D,z)},Le.useLayoutEffect=function(D,z){return M.H.useLayoutEffect(D,z)},Le.useMemo=function(D,z){return M.H.useMemo(D,z)},Le.useOptimistic=function(D,z){return M.H.useOptimistic(D,z)},Le.useReducer=function(D,z,J){return M.H.useReducer(D,z,J)},Le.useRef=function(D){return M.H.useRef(D)},Le.useState=function(D){return M.H.useState(D)},Le.useSyncExternalStore=function(D,z,J){return M.H.useSyncExternalStore(D,z,J)},Le.useTransition=function(){return M.H.useTransition()},Le.version="19.2.0",Le}var s_;function Gl(){return s_||(s_=1,Lm.exports=FN()),Lm.exports}var j=Gl();const YN=Kd(j);var zm={exports:{}},Wo={},Bm={exports:{}},Pm={};var i_;function GN(){return i_||(i_=1,(function(t){function e(k,L){var V=k.length;k.push(L);e:for(;0<V;){var P=V-1>>>1,H=k[P];if(0<a(H,L))k[P]=L,k[V]=H,V=P;else break e}}function n(k){return k.length===0?null:k[0]}function s(k){if(k.length===0)return null;var L=k[0],V=k.pop();if(V!==L){k[0]=V;e:for(var P=0,H=k.length,D=H>>>1;P<D;){var z=2*(P+1)-1,J=k[z],ee=z+1,he=k[ee];if(0>a(J,V))ee<H&&0>a(he,J)?(k[P]=he,k[ee]=V,P=ee):(k[P]=J,k[z]=V,P=z);else if(ee<H&&0>a(he,V))k[P]=he,k[ee]=V,P=ee;else break e}}return L}function a(k,L){var V=k.sortIndex-L.sortIndex;return V!==0?V:k.id-L.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();t.unstable_now=function(){return c.now()-d}}var h=[],f=[],g=1,p=null,v=3,b=!1,x=!1,w=!1,S=!1,A=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function C(k){for(var L=n(f);L!==null;){if(L.callback===null)s(f);else if(L.startTime<=k)s(f),L.sortIndex=L.expirationTime,e(h,L);else break;L=n(f)}}function O(k){if(w=!1,C(k),!x)if(n(h)!==null)x=!0,R||(R=!0,$());else{var L=n(f);L!==null&&G(O,L.startTime-k)}}var R=!1,M=-1,I=5,q=-1;function K(){return S?!0:!(t.unstable_now()-q<I)}function Y(){if(S=!1,R){var k=t.unstable_now();q=k;var L=!0;try{e:{x=!1,w&&(w=!1,N(M),M=-1),b=!0;var V=v;try{t:{for(C(k),p=n(h);p!==null&&!(p.expirationTime>k&&K());){var P=p.callback;if(typeof P=="function"){p.callback=null,v=p.priorityLevel;var H=P(p.expirationTime<=k);if(k=t.unstable_now(),typeof H=="function"){p.callback=H,C(k),L=!0;break t}p===n(h)&&s(h),C(k)}else s(h);p=n(h)}if(p!==null)L=!0;else{var D=n(f);D!==null&&G(O,D.startTime-k),L=!1}}break e}finally{p=null,v=V,b=!1}L=void 0}}finally{L?$():R=!1}}}var $;if(typeof E=="function")$=function(){E(Y)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,B=Q.port2;Q.port1.onmessage=Y,$=function(){B.postMessage(null)}}else $=function(){A(Y,0)};function G(k,L){M=A(function(){k(t.unstable_now())},L)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(k){k.callback=null},t.unstable_forceFrameRate=function(k){0>k||125<k?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<k?Math.floor(1e3/k):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_next=function(k){switch(v){case 1:case 2:case 3:var L=3;break;default:L=v}var V=v;v=L;try{return k()}finally{v=V}},t.unstable_requestPaint=function(){S=!0},t.unstable_runWithPriority=function(k,L){switch(k){case 1:case 2:case 3:case 4:case 5:break;default:k=3}var V=v;v=k;try{return L()}finally{v=V}},t.unstable_scheduleCallback=function(k,L,V){var P=t.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?P+V:P):V=P,k){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=V+H,k={id:g++,callback:L,priorityLevel:k,startTime:V,expirationTime:H,sortIndex:-1},V>P?(k.sortIndex=V,e(f,k),n(h)===null&&k===n(f)&&(w?(N(M),M=-1):w=!0,G(O,V-P))):(k.sortIndex=H,e(h,k),x||b||(x=!0,R||(R=!0,$()))),k},t.unstable_shouldYield=K,t.unstable_wrapCallback=function(k){var L=v;return function(){var V=v;v=L;try{return k.apply(this,arguments)}finally{v=V}}}})(Pm)),Pm}var a_;function XN(){return a_||(a_=1,Bm.exports=GN()),Bm.exports}var qm={exports:{}},Ft={};var o_;function KN(){if(o_)return Ft;o_=1;var t=Gl();function e(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var s={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(h,f,g){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:p==null?null:""+p,children:h,containerInfo:f,implementation:g}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Ft.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Ft.createPortal=function(h,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return l(h,f,null,g)},Ft.flushSync=function(h){var f=c.T,g=s.p;try{if(c.T=null,s.p=2,h)return h()}finally{c.T=f,s.p=g,s.d.f()}},Ft.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,s.d.C(h,f))},Ft.prefetchDNS=function(h){typeof h=="string"&&s.d.D(h)},Ft.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var g=f.as,p=d(g,f.crossOrigin),v=typeof f.integrity=="string"?f.integrity:void 0,b=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;g==="style"?s.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:p,integrity:v,fetchPriority:b}):g==="script"&&s.d.X(h,{crossOrigin:p,integrity:v,fetchPriority:b,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Ft.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var g=d(f.as,f.crossOrigin);s.d.M(h,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&s.d.M(h)},Ft.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var g=f.as,p=d(g,f.crossOrigin);s.d.L(h,g,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Ft.preloadModule=function(h,f){if(typeof h=="string")if(f){var g=d(f.as,f.crossOrigin);s.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else s.d.m(h)},Ft.requestFormReset=function(h){s.d.r(h)},Ft.unstable_batchedUpdates=function(h,f){return h(f)},Ft.useFormState=function(h,f,g){return c.H.useFormState(h,f,g)},Ft.useFormStatus=function(){return c.H.useHostTransitionStatus()},Ft.version="19.2.0",Ft}var l_;function Gx(){if(l_)return qm.exports;l_=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),qm.exports=KN(),qm.exports}var c_;function QN(){if(c_)return Wo;c_=1;var t=XN(),e=Gl(),n=Gx();function s(r){var i="https://react.dev/errors/"+r;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function l(r){var i=r,o=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(o=i.return),r=i.return;while(r)}return i.tag===3?o:null}function c(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function d(r){if(r.tag===31){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function h(r){if(l(r)!==r)throw Error(s(188))}function f(r){var i=r.alternate;if(!i){if(i=l(r),i===null)throw Error(s(188));return i!==r?null:r}for(var o=r,u=i;;){var m=o.return;if(m===null)break;var y=m.alternate;if(y===null){if(u=m.return,u!==null){o=u;continue}break}if(m.child===y.child){for(y=m.child;y;){if(y===o)return h(m),r;if(y===u)return h(m),i;y=y.sibling}throw Error(s(188))}if(o.return!==u.return)o=m,u=y;else{for(var T=!1,U=m.child;U;){if(U===o){T=!0,o=m,u=y;break}if(U===u){T=!0,u=m,o=y;break}U=U.sibling}if(!T){for(U=y.child;U;){if(U===o){T=!0,o=y,u=m;break}if(U===u){T=!0,u=y,o=m;break}U=U.sibling}if(!T)throw Error(s(189))}}if(o.alternate!==u)throw Error(s(190))}if(o.tag!==3)throw Error(s(188));return o.stateNode.current===o?r:i}function g(r){var i=r.tag;if(i===5||i===26||i===27||i===6)return r;for(r=r.child;r!==null;){if(i=g(r),i!==null)return i;r=r.sibling}return null}var p=Object.assign,v=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),N=Symbol.for("react.consumer"),E=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),q=Symbol.for("react.activity"),K=Symbol.for("react.memo_cache_sentinel"),Y=Symbol.iterator;function $(r){return r===null||typeof r!="object"?null:(r=Y&&r[Y]||r["@@iterator"],typeof r=="function"?r:null)}var Q=Symbol.for("react.client.reference");function B(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===Q?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case w:return"Fragment";case A:return"Profiler";case S:return"StrictMode";case O:return"Suspense";case R:return"SuspenseList";case q:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case x:return"Portal";case E:return r.displayName||"Context";case N:return(r._context.displayName||"Context")+".Consumer";case C:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case M:return i=r.displayName||null,i!==null?i:B(r.type)||"Memo";case I:i=r._payload,r=r._init;try{return B(r(i))}catch{}}return null}var G=Array.isArray,k=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V={pending:!1,data:null,method:null,action:null},P=[],H=-1;function D(r){return{current:r}}function z(r){0>H||(r.current=P[H],P[H]=null,H--)}function J(r,i){H++,P[H]=r.current,r.current=i}var ee=D(null),he=D(null),pe=D(null),ae=D(null);function le(r,i){switch(J(pe,i),J(he,r),J(ee,null),i.nodeType){case 9:case 11:r=(r=i.documentElement)&&(r=r.namespaceURI)?Eb(r):0;break;default:if(r=i.tagName,i=i.namespaceURI)i=Eb(i),r=Cb(i,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}z(ee),J(ee,r)}function Z(){z(ee),z(he),z(pe)}function de(r){r.memoizedState!==null&&J(ae,r);var i=ee.current,o=Cb(i,r.type);i!==o&&(J(he,r),J(ee,o))}function ge(r){he.current===r&&(z(ee),z(he)),ae.current===r&&(z(ae),Yo._currentValue=V)}var be,te;function ve(r){if(be===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);be=i&&i[1]||"",te=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+be+r+te}var _e=!1;function Ie(r,i){if(!r||_e)return"";_e=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(i){var fe=function(){throw Error()};if(Object.defineProperty(fe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(fe,[])}catch(oe){var ie=oe}Reflect.construct(r,[],fe)}else{try{fe.call()}catch(oe){ie=oe}r.call(fe.prototype)}}else{try{throw Error()}catch(oe){ie=oe}(fe=r())&&typeof fe.catch=="function"&&fe.catch(function(){})}}catch(oe){if(oe&&ie&&typeof oe.stack=="string")return[oe.stack,ie.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=u.DetermineComponentFrameRoot(),T=y[0],U=y[1];if(T&&U){var F=T.split(`
`),re=U.split(`
`);for(m=u=0;u<F.length&&!F[u].includes("DetermineComponentFrameRoot");)u++;for(;m<re.length&&!re[m].includes("DetermineComponentFrameRoot");)m++;if(u===F.length||m===re.length)for(u=F.length-1,m=re.length-1;1<=u&&0<=m&&F[u]!==re[m];)m--;for(;1<=u&&0<=m;u--,m--)if(F[u]!==re[m]){if(u!==1||m!==1)do if(u--,m--,0>m||F[u]!==re[m]){var ce=`
`+F[u].replace(" at new "," at ");return r.displayName&&ce.includes("<anonymous>")&&(ce=ce.replace("<anonymous>",r.displayName)),ce}while(1<=u&&0<=m);break}}}finally{_e=!1,Error.prepareStackTrace=o}return(o=r?r.displayName||r.name:"")?ve(o):""}function qe(r,i){switch(r.tag){case 26:case 27:case 5:return ve(r.type);case 16:return ve("Lazy");case 13:return r.child!==i&&i!==null?ve("Suspense Fallback"):ve("Suspense");case 19:return ve("SuspenseList");case 0:case 15:return Ie(r.type,!1);case 11:return Ie(r.type.render,!1);case 1:return Ie(r.type,!0);case 31:return ve("Activity");default:return""}}function ot(r){try{var i="",o=null;do i+=qe(r,o),o=r,r=r.return;while(r);return i}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var kt=Object.prototype.hasOwnProperty,In=t.unstable_scheduleCallback,Jt=t.unstable_cancelCallback,Ln=t.unstable_shouldYield,pr=t.unstable_requestPaint,At=t.unstable_now,Qr=t.unstable_getCurrentPriorityLevel,Cn=t.unstable_ImmediatePriority,tr=t.unstable_UserBlockingPriority,gr=t.unstable_NormalPriority,eo=t.unstable_LowPriority,Wr=t.unstable_IdlePriority,zs=t.log,to=t.unstable_setDisableYieldValue,me=null,Ee=null;function we(r){if(typeof zs=="function"&&to(r),Ee&&typeof Ee.setStrictMode=="function")try{Ee.setStrictMode(me,r)}catch{}}var De=Math.clz32?Math.clz32:Cf,ht=Math.log,Mt=Math.LN2;function Cf(r){return r>>>=0,r===0?32:31-(ht(r)/Mt|0)|0}var Ni=256,Oi=262144,Ri=4194304;function yr(r){var i=r&42;if(i!==0)return i;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function ji(r,i,o){var u=r.pendingLanes;if(u===0)return 0;var m=0,y=r.suspendedLanes,T=r.pingedLanes;r=r.warmLanes;var U=u&134217727;return U!==0?(u=U&~y,u!==0?m=yr(u):(T&=U,T!==0?m=yr(T):o||(o=U&~r,o!==0&&(m=yr(o))))):(U=u&~y,U!==0?m=yr(U):T!==0?m=yr(T):o||(o=u&~r,o!==0&&(m=yr(o)))),m===0?0:i!==0&&i!==m&&(i&y)===0&&(y=m&-m,o=i&-i,y>=o||y===32&&(o&4194048)!==0)?i:m}function Bs(r,i){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&i)===0}function Af(r,i){switch(r){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lc(){var r=Ri;return Ri<<=1,(Ri&62914560)===0&&(Ri=4194304),r}function no(r){for(var i=[],o=0;31>o;o++)i.push(r);return i}function Ps(r,i){r.pendingLanes|=i,i!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Tf(r,i,o,u,m,y){var T=r.pendingLanes;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=o,r.entangledLanes&=o,r.errorRecoveryDisabledLanes&=o,r.shellSuspendCounter=0;var U=r.entanglements,F=r.expirationTimes,re=r.hiddenUpdates;for(o=T&~o;0<o;){var ce=31-De(o),fe=1<<ce;U[ce]=0,F[ce]=-1;var ie=re[ce];if(ie!==null)for(re[ce]=null,ce=0;ce<ie.length;ce++){var oe=ie[ce];oe!==null&&(oe.lane&=-536870913)}o&=~fe}u!==0&&cc(r,u,0),y!==0&&m===0&&r.tag!==0&&(r.suspendedLanes|=y&~(T&~i))}function cc(r,i,o){r.pendingLanes|=i,r.suspendedLanes&=~i;var u=31-De(i);r.entangledLanes|=i,r.entanglements[u]=r.entanglements[u]|1073741824|o&261930}function uc(r,i){var o=r.entangledLanes|=i;for(r=r.entanglements;o;){var u=31-De(o),m=1<<u;m&i|r[u]&i&&(r[u]|=i),o&=~m}}function dc(r,i){var o=i&-i;return o=(o&42)!==0?1:ro(o),(o&(r.suspendedLanes|i))!==0?0:o}function ro(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function so(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function fc(){var r=L.p;return r!==0?r:(r=window.event,r===void 0?32:Xb(r.type))}function hc(r,i){var o=L.p;try{return L.p=r,i()}finally{L.p=o}}var nr=Math.random().toString(36).slice(2),Tt="__reactFiber$"+nr,Ht="__reactProps$"+nr,vr="__reactContainer$"+nr,ki="__reactEvents$"+nr,mc="__reactListeners$"+nr,Nf="__reactHandles$"+nr,pc="__reactResources$"+nr,qs="__reactMarker$"+nr;function io(r){delete r[Tt],delete r[Ht],delete r[ki],delete r[mc],delete r[Nf]}function Jr(r){var i=r[Tt];if(i)return i;for(var o=r.parentNode;o;){if(i=o[vr]||o[Tt]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(r=kb(r);r!==null;){if(o=r[Tt])return o;r=kb(r)}return i}r=o,o=r.parentNode}return null}function Zr(r){if(r=r[Tt]||r[vr]){var i=r.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return r}return null}function es(r){var i=r.tag;if(i===5||i===26||i===27||i===6)return r.stateNode;throw Error(s(33))}function ts(r){var i=r[pc];return i||(i=r[pc]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function vt(r){r[qs]=!0}var gc=new Set,yc={};function br(r,i){ns(r,i),ns(r+"Capture",i)}function ns(r,i){for(yc[r]=i,r=0;r<i.length;r++)gc.add(i[r])}var Of=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ao={},vc={};function Rf(r){return kt.call(vc,r)?!0:kt.call(ao,r)?!1:Of.test(r)?vc[r]=!0:(ao[r]=!0,!1)}function Mi(r,i,o){if(Rf(i))if(o===null)r.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":r.removeAttribute(i);return;case"boolean":var u=i.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){r.removeAttribute(i);return}}r.setAttribute(i,""+o)}}function Di(r,i,o){if(o===null)r.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(i);return}r.setAttribute(i,""+o)}}function zn(r,i,o,u){if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttributeNS(i,o,""+u)}}function Zt(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function bc(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function jf(r,i,o){var u=Object.getOwnPropertyDescriptor(r.constructor.prototype,i);if(!r.hasOwnProperty(i)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var m=u.get,y=u.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return m.call(this)},set:function(T){o=""+T,y.call(this,T)}}),Object.defineProperty(r,i,{enumerable:u.enumerable}),{getValue:function(){return o},setValue:function(T){o=""+T},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function Ui(r){if(!r._valueTracker){var i=bc(r)?"checked":"value";r._valueTracker=jf(r,i,""+r[i])}}function _c(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var o=i.getValue(),u="";return r&&(u=bc(r)?r.checked?"true":"false":r.value),r=u,r!==o?(i.setValue(r),!0):!1}function $i(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var kf=/[\n"\\]/g;function Vt(r){return r.replace(kf,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function oo(r,i,o,u,m,y,T,U){r.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?r.type=T:r.removeAttribute("type"),i!=null?T==="number"?(i===0&&r.value===""||r.value!=i)&&(r.value=""+Zt(i)):r.value!==""+Zt(i)&&(r.value=""+Zt(i)):T!=="submit"&&T!=="reset"||r.removeAttribute("value"),i!=null?Ii(r,T,Zt(i)):o!=null?Ii(r,T,Zt(o)):u!=null&&r.removeAttribute("value"),m==null&&y!=null&&(r.defaultChecked=!!y),m!=null&&(r.checked=m&&typeof m!="function"&&typeof m!="symbol"),U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?r.name=""+Zt(U):r.removeAttribute("name")}function wc(r,i,o,u,m,y,T,U){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),i!=null||o!=null){if(!(y!=="submit"&&y!=="reset"||i!=null)){Ui(r);return}o=o!=null?""+Zt(o):"",i=i!=null?""+Zt(i):o,U||i===r.value||(r.value=i),r.defaultValue=i}u=u??m,u=typeof u!="function"&&typeof u!="symbol"&&!!u,r.checked=U?r.checked:!!u,r.defaultChecked=!!u,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(r.name=T),Ui(r)}function Ii(r,i,o){i==="number"&&$i(r.ownerDocument)===r||r.defaultValue===""+o||(r.defaultValue=""+o)}function Li(r,i,o,u){if(r=r.options,i){i={};for(var m=0;m<o.length;m++)i["$"+o[m]]=!0;for(o=0;o<r.length;o++)m=i.hasOwnProperty("$"+r[o].value),r[o].selected!==m&&(r[o].selected=m),m&&u&&(r[o].defaultSelected=!0)}else{for(o=""+Zt(o),i=null,m=0;m<r.length;m++){if(r[m].value===o){r[m].selected=!0,u&&(r[m].defaultSelected=!0);return}i!==null||r[m].disabled||(i=r[m])}i!==null&&(i.selected=!0)}}function by(r,i,o){if(i!=null&&(i=""+Zt(i),i!==r.value&&(r.value=i),o==null)){r.defaultValue!==i&&(r.defaultValue=i);return}r.defaultValue=o!=null?""+Zt(o):""}function _y(r,i,o,u){if(i==null){if(u!=null){if(o!=null)throw Error(s(92));if(G(u)){if(1<u.length)throw Error(s(93));u=u[0]}o=u}o==null&&(o=""),i=o}o=Zt(i),r.defaultValue=o,u=r.textContent,u===o&&u!==""&&u!==null&&(r.value=u),Ui(r)}function zi(r,i){if(i){var o=r.firstChild;if(o&&o===r.lastChild&&o.nodeType===3){o.nodeValue=i;return}}r.textContent=i}var IA=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function wy(r,i,o){var u=i.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?r.setProperty(i,""):i==="float"?r.cssFloat="":r[i]="":u?r.setProperty(i,o):typeof o!="number"||o===0||IA.has(i)?i==="float"?r.cssFloat=o:r[i]=(""+o).trim():r[i]=o+"px"}function xy(r,i,o){if(i!=null&&typeof i!="object")throw Error(s(62));if(r=r.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||i!=null&&i.hasOwnProperty(u)||(u.indexOf("--")===0?r.setProperty(u,""):u==="float"?r.cssFloat="":r[u]="");for(var m in i)u=i[m],i.hasOwnProperty(m)&&o[m]!==u&&wy(r,m,u)}else for(var y in i)i.hasOwnProperty(y)&&wy(r,y,i[y])}function Mf(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var LA=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),zA=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function xc(r){return zA.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function _r(){}var Df=null;function Uf(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Bi=null,Pi=null;function Sy(r){var i=Zr(r);if(i&&(r=i.stateNode)){var o=r[Ht]||null;e:switch(r=i.stateNode,i.type){case"input":if(oo(r,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),i=o.name,o.type==="radio"&&i!=null){for(o=r;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Vt(""+i)+'"][type="radio"]'),i=0;i<o.length;i++){var u=o[i];if(u!==r&&u.form===r.form){var m=u[Ht]||null;if(!m)throw Error(s(90));oo(u,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(i=0;i<o.length;i++)u=o[i],u.form===r.form&&_c(u)}break e;case"textarea":by(r,o.value,o.defaultValue);break e;case"select":i=o.value,i!=null&&Li(r,!!o.multiple,i,!1)}}}var $f=!1;function Ey(r,i,o){if($f)return r(i,o);$f=!0;try{var u=r(i);return u}finally{if($f=!1,(Bi!==null||Pi!==null)&&(cu(),Bi&&(i=Bi,r=Pi,Pi=Bi=null,Sy(i),r)))for(i=0;i<r.length;i++)Sy(r[i])}}function lo(r,i){var o=r.stateNode;if(o===null)return null;var u=o[Ht]||null;if(u===null)return null;o=u[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(r=r.type,u=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!u;break e;default:r=!1}if(r)return null;if(o&&typeof o!="function")throw Error(s(231,i,typeof o));return o}var wr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),If=!1;if(wr)try{var co={};Object.defineProperty(co,"passive",{get:function(){If=!0}}),window.addEventListener("test",co,co),window.removeEventListener("test",co,co)}catch{If=!1}var rs=null,Lf=null,Sc=null;function Cy(){if(Sc)return Sc;var r,i=Lf,o=i.length,u,m="value"in rs?rs.value:rs.textContent,y=m.length;for(r=0;r<o&&i[r]===m[r];r++);var T=o-r;for(u=1;u<=T&&i[o-u]===m[y-u];u++);return Sc=m.slice(r,1<u?1-u:void 0)}function Ec(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function Cc(){return!0}function Ay(){return!1}function en(r){function i(o,u,m,y,T){this._reactName=o,this._targetInst=m,this.type=u,this.nativeEvent=y,this.target=T,this.currentTarget=null;for(var U in r)r.hasOwnProperty(U)&&(o=r[U],this[U]=o?o(y):y[U]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Cc:Ay,this.isPropagationStopped=Ay,this}return p(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Cc)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Cc)},persist:function(){},isPersistent:Cc}),i}var Hs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ac=en(Hs),uo=p({},Hs,{view:0,detail:0}),BA=en(uo),zf,Bf,fo,Tc=p({},uo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qf,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==fo&&(fo&&r.type==="mousemove"?(zf=r.screenX-fo.screenX,Bf=r.screenY-fo.screenY):Bf=zf=0,fo=r),zf)},movementY:function(r){return"movementY"in r?r.movementY:Bf}}),Ty=en(Tc),PA=p({},Tc,{dataTransfer:0}),qA=en(PA),HA=p({},uo,{relatedTarget:0}),Pf=en(HA),VA=p({},Hs,{animationName:0,elapsedTime:0,pseudoElement:0}),FA=en(VA),YA=p({},Hs,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),GA=en(YA),XA=p({},Hs,{data:0}),Ny=en(XA),KA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},QA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},WA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function JA(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=WA[r])?!!i[r]:!1}function qf(){return JA}var ZA=p({},uo,{key:function(r){if(r.key){var i=KA[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=Ec(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?QA[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qf,charCode:function(r){return r.type==="keypress"?Ec(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Ec(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),eT=en(ZA),tT=p({},Tc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Oy=en(tT),nT=p({},uo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qf}),rT=en(nT),sT=p({},Hs,{propertyName:0,elapsedTime:0,pseudoElement:0}),iT=en(sT),aT=p({},Tc,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),oT=en(aT),lT=p({},Hs,{newState:0,oldState:0}),cT=en(lT),uT=[9,13,27,32],Hf=wr&&"CompositionEvent"in window,ho=null;wr&&"documentMode"in document&&(ho=document.documentMode);var dT=wr&&"TextEvent"in window&&!ho,Ry=wr&&(!Hf||ho&&8<ho&&11>=ho),jy=" ",ky=!1;function My(r,i){switch(r){case"keyup":return uT.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Dy(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var qi=!1;function fT(r,i){switch(r){case"compositionend":return Dy(i);case"keypress":return i.which!==32?null:(ky=!0,jy);case"textInput":return r=i.data,r===jy&&ky?null:r;default:return null}}function hT(r,i){if(qi)return r==="compositionend"||!Hf&&My(r,i)?(r=Cy(),Sc=Lf=rs=null,qi=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Ry&&i.locale!=="ko"?null:i.data;default:return null}}var mT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Uy(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!mT[r.type]:i==="textarea"}function $y(r,i,o,u){Bi?Pi?Pi.push(u):Pi=[u]:Bi=u,i=gu(i,"onChange"),0<i.length&&(o=new Ac("onChange","change",null,o,u),r.push({event:o,listeners:i}))}var mo=null,po=null;function pT(r){vb(r,0)}function Nc(r){var i=es(r);if(_c(i))return r}function Iy(r,i){if(r==="change")return i}var Ly=!1;if(wr){var Vf;if(wr){var Ff="oninput"in document;if(!Ff){var zy=document.createElement("div");zy.setAttribute("oninput","return;"),Ff=typeof zy.oninput=="function"}Vf=Ff}else Vf=!1;Ly=Vf&&(!document.documentMode||9<document.documentMode)}function By(){mo&&(mo.detachEvent("onpropertychange",Py),po=mo=null)}function Py(r){if(r.propertyName==="value"&&Nc(po)){var i=[];$y(i,po,r,Uf(r)),Ey(pT,i)}}function gT(r,i,o){r==="focusin"?(By(),mo=i,po=o,mo.attachEvent("onpropertychange",Py)):r==="focusout"&&By()}function yT(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Nc(po)}function vT(r,i){if(r==="click")return Nc(i)}function bT(r,i){if(r==="input"||r==="change")return Nc(i)}function _T(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var un=typeof Object.is=="function"?Object.is:_T;function go(r,i){if(un(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var o=Object.keys(r),u=Object.keys(i);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var m=o[u];if(!kt.call(i,m)||!un(r[m],i[m]))return!1}return!0}function qy(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Hy(r,i){var o=qy(r);r=0;for(var u;o;){if(o.nodeType===3){if(u=r+o.textContent.length,r<=i&&u>=i)return{node:o,offset:i-r};r=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=qy(o)}}function Vy(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?Vy(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function Fy(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var i=$i(r.document);i instanceof r.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)r=i.contentWindow;else break;i=$i(r.document)}return i}function Yf(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}var wT=wr&&"documentMode"in document&&11>=document.documentMode,Hi=null,Gf=null,yo=null,Xf=!1;function Yy(r,i,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Xf||Hi==null||Hi!==$i(u)||(u=Hi,"selectionStart"in u&&Yf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),yo&&go(yo,u)||(yo=u,u=gu(Gf,"onSelect"),0<u.length&&(i=new Ac("onSelect","select",null,i,o),r.push({event:i,listeners:u}),i.target=Hi)))}function Vs(r,i){var o={};return o[r.toLowerCase()]=i.toLowerCase(),o["Webkit"+r]="webkit"+i,o["Moz"+r]="moz"+i,o}var Vi={animationend:Vs("Animation","AnimationEnd"),animationiteration:Vs("Animation","AnimationIteration"),animationstart:Vs("Animation","AnimationStart"),transitionrun:Vs("Transition","TransitionRun"),transitionstart:Vs("Transition","TransitionStart"),transitioncancel:Vs("Transition","TransitionCancel"),transitionend:Vs("Transition","TransitionEnd")},Kf={},Gy={};wr&&(Gy=document.createElement("div").style,"AnimationEvent"in window||(delete Vi.animationend.animation,delete Vi.animationiteration.animation,delete Vi.animationstart.animation),"TransitionEvent"in window||delete Vi.transitionend.transition);function Fs(r){if(Kf[r])return Kf[r];if(!Vi[r])return r;var i=Vi[r],o;for(o in i)if(i.hasOwnProperty(o)&&o in Gy)return Kf[r]=i[o];return r}var Xy=Fs("animationend"),Ky=Fs("animationiteration"),Qy=Fs("animationstart"),xT=Fs("transitionrun"),ST=Fs("transitionstart"),ET=Fs("transitioncancel"),Wy=Fs("transitionend"),Jy=new Map,Qf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Qf.push("scrollEnd");function Bn(r,i){Jy.set(r,i),br(i,[r])}var Oc=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},An=[],Fi=0,Wf=0;function Rc(){for(var r=Fi,i=Wf=Fi=0;i<r;){var o=An[i];An[i++]=null;var u=An[i];An[i++]=null;var m=An[i];An[i++]=null;var y=An[i];if(An[i++]=null,u!==null&&m!==null){var T=u.pending;T===null?m.next=m:(m.next=T.next,T.next=m),u.pending=m}y!==0&&Zy(o,m,y)}}function jc(r,i,o,u){An[Fi++]=r,An[Fi++]=i,An[Fi++]=o,An[Fi++]=u,Wf|=u,r.lanes|=u,r=r.alternate,r!==null&&(r.lanes|=u)}function Jf(r,i,o,u){return jc(r,i,o,u),kc(r)}function Ys(r,i){return jc(r,null,null,i),kc(r)}function Zy(r,i,o){r.lanes|=o;var u=r.alternate;u!==null&&(u.lanes|=o);for(var m=!1,y=r.return;y!==null;)y.childLanes|=o,u=y.alternate,u!==null&&(u.childLanes|=o),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(m=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,m&&i!==null&&(m=31-De(o),r=y.hiddenUpdates,u=r[m],u===null?r[m]=[i]:u.push(i),i.lane=o|536870912),y):null}function kc(r){if(50<zo)throw zo=0,om=null,Error(s(185));for(var i=r.return;i!==null;)r=i,i=r.return;return r.tag===3?r.stateNode:null}var Yi={};function CT(r,i,o,u){this.tag=r,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function dn(r,i,o,u){return new CT(r,i,o,u)}function Zf(r){return r=r.prototype,!(!r||!r.isReactComponent)}function xr(r,i){var o=r.alternate;return o===null?(o=dn(r.tag,i,r.key,r.mode),o.elementType=r.elementType,o.type=r.type,o.stateNode=r.stateNode,o.alternate=r,r.alternate=o):(o.pendingProps=i,o.type=r.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=r.flags&65011712,o.childLanes=r.childLanes,o.lanes=r.lanes,o.child=r.child,o.memoizedProps=r.memoizedProps,o.memoizedState=r.memoizedState,o.updateQueue=r.updateQueue,i=r.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=r.sibling,o.index=r.index,o.ref=r.ref,o.refCleanup=r.refCleanup,o}function e0(r,i){r.flags&=65011714;var o=r.alternate;return o===null?(r.childLanes=0,r.lanes=i,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,i=o.dependencies,r.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),r}function Mc(r,i,o,u,m,y){var T=0;if(u=r,typeof r=="function")Zf(r)&&(T=1);else if(typeof r=="string")T=RN(r,o,ee.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case q:return r=dn(31,o,i,m),r.elementType=q,r.lanes=y,r;case w:return Gs(o.children,m,y,i);case S:T=8,m|=24;break;case A:return r=dn(12,o,i,m|2),r.elementType=A,r.lanes=y,r;case O:return r=dn(13,o,i,m),r.elementType=O,r.lanes=y,r;case R:return r=dn(19,o,i,m),r.elementType=R,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case E:T=10;break e;case N:T=9;break e;case C:T=11;break e;case M:T=14;break e;case I:T=16,u=null;break e}T=29,o=Error(s(130,r===null?"null":typeof r,"")),u=null}return i=dn(T,o,i,m),i.elementType=r,i.type=u,i.lanes=y,i}function Gs(r,i,o,u){return r=dn(7,r,u,i),r.lanes=o,r}function eh(r,i,o){return r=dn(6,r,null,i),r.lanes=o,r}function t0(r){var i=dn(18,null,null,0);return i.stateNode=r,i}function th(r,i,o){return i=dn(4,r.children!==null?r.children:[],r.key,i),i.lanes=o,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}var n0=new WeakMap;function Tn(r,i){if(typeof r=="object"&&r!==null){var o=n0.get(r);return o!==void 0?o:(i={value:r,source:i,stack:ot(i)},n0.set(r,i),i)}return{value:r,source:i,stack:ot(i)}}var Gi=[],Xi=0,Dc=null,vo=0,Nn=[],On=0,ss=null,rr=1,sr="";function Sr(r,i){Gi[Xi++]=vo,Gi[Xi++]=Dc,Dc=r,vo=i}function r0(r,i,o){Nn[On++]=rr,Nn[On++]=sr,Nn[On++]=ss,ss=r;var u=rr;r=sr;var m=32-De(u)-1;u&=~(1<<m),o+=1;var y=32-De(i)+m;if(30<y){var T=m-m%5;y=(u&(1<<T)-1).toString(32),u>>=T,m-=T,rr=1<<32-De(i)+m|o<<m|u,sr=y+r}else rr=1<<y|o<<m|u,sr=r}function nh(r){r.return!==null&&(Sr(r,1),r0(r,1,0))}function rh(r){for(;r===Dc;)Dc=Gi[--Xi],Gi[Xi]=null,vo=Gi[--Xi],Gi[Xi]=null;for(;r===ss;)ss=Nn[--On],Nn[On]=null,sr=Nn[--On],Nn[On]=null,rr=Nn[--On],Nn[On]=null}function s0(r,i){Nn[On++]=rr,Nn[On++]=sr,Nn[On++]=ss,rr=i.id,sr=i.overflow,ss=r}var $t=null,it=null,Xe=!1,is=null,Rn=!1,sh=Error(s(519));function as(r){var i=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw bo(Tn(i,r)),sh}function i0(r){var i=r.stateNode,o=r.type,u=r.memoizedProps;switch(i[Tt]=r,i[Ht]=u,o){case"dialog":Ve("cancel",i),Ve("close",i);break;case"iframe":case"object":case"embed":Ve("load",i);break;case"video":case"audio":for(o=0;o<Po.length;o++)Ve(Po[o],i);break;case"source":Ve("error",i);break;case"img":case"image":case"link":Ve("error",i),Ve("load",i);break;case"details":Ve("toggle",i);break;case"input":Ve("invalid",i),wc(i,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Ve("invalid",i);break;case"textarea":Ve("invalid",i),_y(i,u.value,u.defaultValue,u.children)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||i.textContent===""+o||u.suppressHydrationWarning===!0||xb(i.textContent,o)?(u.popover!=null&&(Ve("beforetoggle",i),Ve("toggle",i)),u.onScroll!=null&&Ve("scroll",i),u.onScrollEnd!=null&&Ve("scrollend",i),u.onClick!=null&&(i.onclick=_r),i=!0):i=!1,i||as(r,!0)}function a0(r){for($t=r.return;$t;)switch($t.tag){case 5:case 31:case 13:Rn=!1;return;case 27:case 3:Rn=!0;return;default:$t=$t.return}}function Ki(r){if(r!==$t)return!1;if(!Xe)return a0(r),Xe=!0,!1;var i=r.tag,o;if((o=i!==3&&i!==27)&&((o=i===5)&&(o=r.type,o=!(o!=="form"&&o!=="button")||xm(r.type,r.memoizedProps)),o=!o),o&&it&&as(r),a0(r),i===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(317));it=jb(r)}else if(i===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(317));it=jb(r)}else i===27?(i=it,_s(r.type)?(r=Tm,Tm=null,it=r):it=i):it=$t?kn(r.stateNode.nextSibling):null;return!0}function Xs(){it=$t=null,Xe=!1}function ih(){var r=is;return r!==null&&(sn===null?sn=r:sn.push.apply(sn,r),is=null),r}function bo(r){is===null?is=[r]:is.push(r)}var ah=D(null),Ks=null,Er=null;function os(r,i,o){J(ah,i._currentValue),i._currentValue=o}function Cr(r){r._currentValue=ah.current,z(ah)}function oh(r,i,o){for(;r!==null;){var u=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,u!==null&&(u.childLanes|=i)):u!==null&&(u.childLanes&i)!==i&&(u.childLanes|=i),r===o)break;r=r.return}}function lh(r,i,o,u){var m=r.child;for(m!==null&&(m.return=r);m!==null;){var y=m.dependencies;if(y!==null){var T=m.child;y=y.firstContext;e:for(;y!==null;){var U=y;y=m;for(var F=0;F<i.length;F++)if(U.context===i[F]){y.lanes|=o,U=y.alternate,U!==null&&(U.lanes|=o),oh(y.return,o,r),u||(T=null);break e}y=U.next}}else if(m.tag===18){if(T=m.return,T===null)throw Error(s(341));T.lanes|=o,y=T.alternate,y!==null&&(y.lanes|=o),oh(T,o,r),T=null}else T=m.child;if(T!==null)T.return=m;else for(T=m;T!==null;){if(T===r){T=null;break}if(m=T.sibling,m!==null){m.return=T.return,T=m;break}T=T.return}m=T}}function Qi(r,i,o,u){r=null;for(var m=i,y=!1;m!==null;){if(!y){if((m.flags&524288)!==0)y=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var T=m.alternate;if(T===null)throw Error(s(387));if(T=T.memoizedProps,T!==null){var U=m.type;un(m.pendingProps.value,T.value)||(r!==null?r.push(U):r=[U])}}else if(m===ae.current){if(T=m.alternate,T===null)throw Error(s(387));T.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(r!==null?r.push(Yo):r=[Yo])}m=m.return}r!==null&&lh(i,r,o,u),i.flags|=262144}function Uc(r){for(r=r.firstContext;r!==null;){if(!un(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Qs(r){Ks=r,Er=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function It(r){return o0(Ks,r)}function $c(r,i){return Ks===null&&Qs(r),o0(r,i)}function o0(r,i){var o=i._currentValue;if(i={context:i,memoizedValue:o,next:null},Er===null){if(r===null)throw Error(s(308));Er=i,r.dependencies={lanes:0,firstContext:i},r.flags|=524288}else Er=Er.next=i;return o}var AT=typeof AbortController<"u"?AbortController:function(){var r=[],i=this.signal={aborted:!1,addEventListener:function(o,u){r.push(u)}};this.abort=function(){i.aborted=!0,r.forEach(function(o){return o()})}},TT=t.unstable_scheduleCallback,NT=t.unstable_NormalPriority,bt={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ch(){return{controller:new AT,data:new Map,refCount:0}}function _o(r){r.refCount--,r.refCount===0&&TT(NT,function(){r.controller.abort()})}var wo=null,uh=0,Wi=0,Ji=null;function OT(r,i){if(wo===null){var o=wo=[];uh=0,Wi=hm(),Ji={status:"pending",value:void 0,then:function(u){o.push(u)}}}return uh++,i.then(l0,l0),i}function l0(){if(--uh===0&&wo!==null){Ji!==null&&(Ji.status="fulfilled");var r=wo;wo=null,Wi=0,Ji=null;for(var i=0;i<r.length;i++)(0,r[i])()}}function RT(r,i){var o=[],u={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return r.then(function(){u.status="fulfilled",u.value=i;for(var m=0;m<o.length;m++)(0,o[m])(i)},function(m){for(u.status="rejected",u.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),u}var c0=k.S;k.S=function(r,i){Yv=At(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&OT(r,i),c0!==null&&c0(r,i)};var Ws=D(null);function dh(){var r=Ws.current;return r!==null?r:rt.pooledCache}function Ic(r,i){i===null?J(Ws,Ws.current):J(Ws,i.pool)}function u0(){var r=dh();return r===null?null:{parent:bt._currentValue,pool:r}}var Zi=Error(s(460)),fh=Error(s(474)),Lc=Error(s(542)),zc={then:function(){}};function d0(r){return r=r.status,r==="fulfilled"||r==="rejected"}function f0(r,i,o){switch(o=r[o],o===void 0?r.push(i):o!==i&&(i.then(_r,_r),i=o),i.status){case"fulfilled":return i.value;case"rejected":throw r=i.reason,m0(r),r;default:if(typeof i.status=="string")i.then(_r,_r);else{if(r=rt,r!==null&&100<r.shellSuspendCounter)throw Error(s(482));r=i,r.status="pending",r.then(function(u){if(i.status==="pending"){var m=i;m.status="fulfilled",m.value=u}},function(u){if(i.status==="pending"){var m=i;m.status="rejected",m.reason=u}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw r=i.reason,m0(r),r}throw Zs=i,Zi}}function Js(r){try{var i=r._init;return i(r._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Zs=o,Zi):o}}var Zs=null;function h0(){if(Zs===null)throw Error(s(459));var r=Zs;return Zs=null,r}function m0(r){if(r===Zi||r===Lc)throw Error(s(483))}var ea=null,xo=0;function Bc(r){var i=xo;return xo+=1,ea===null&&(ea=[]),f0(ea,r,i)}function So(r,i){i=i.props.ref,r.ref=i!==void 0?i:null}function Pc(r,i){throw i.$$typeof===v?Error(s(525)):(r=Object.prototype.toString.call(i),Error(s(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r)))}function p0(r){function i(W,X){if(r){var ne=W.deletions;ne===null?(W.deletions=[X],W.flags|=16):ne.push(X)}}function o(W,X){if(!r)return null;for(;X!==null;)i(W,X),X=X.sibling;return null}function u(W){for(var X=new Map;W!==null;)W.key!==null?X.set(W.key,W):X.set(W.index,W),W=W.sibling;return X}function m(W,X){return W=xr(W,X),W.index=0,W.sibling=null,W}function y(W,X,ne){return W.index=ne,r?(ne=W.alternate,ne!==null?(ne=ne.index,ne<X?(W.flags|=67108866,X):ne):(W.flags|=67108866,X)):(W.flags|=1048576,X)}function T(W){return r&&W.alternate===null&&(W.flags|=67108866),W}function U(W,X,ne,ue){return X===null||X.tag!==6?(X=eh(ne,W.mode,ue),X.return=W,X):(X=m(X,ne),X.return=W,X)}function F(W,X,ne,ue){var Re=ne.type;return Re===w?ce(W,X,ne.props.children,ue,ne.key):X!==null&&(X.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===I&&Js(Re)===X.type)?(X=m(X,ne.props),So(X,ne),X.return=W,X):(X=Mc(ne.type,ne.key,ne.props,null,W.mode,ue),So(X,ne),X.return=W,X)}function re(W,X,ne,ue){return X===null||X.tag!==4||X.stateNode.containerInfo!==ne.containerInfo||X.stateNode.implementation!==ne.implementation?(X=th(ne,W.mode,ue),X.return=W,X):(X=m(X,ne.children||[]),X.return=W,X)}function ce(W,X,ne,ue,Re){return X===null||X.tag!==7?(X=Gs(ne,W.mode,ue,Re),X.return=W,X):(X=m(X,ne),X.return=W,X)}function fe(W,X,ne){if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return X=eh(""+X,W.mode,ne),X.return=W,X;if(typeof X=="object"&&X!==null){switch(X.$$typeof){case b:return ne=Mc(X.type,X.key,X.props,null,W.mode,ne),So(ne,X),ne.return=W,ne;case x:return X=th(X,W.mode,ne),X.return=W,X;case I:return X=Js(X),fe(W,X,ne)}if(G(X)||$(X))return X=Gs(X,W.mode,ne,null),X.return=W,X;if(typeof X.then=="function")return fe(W,Bc(X),ne);if(X.$$typeof===E)return fe(W,$c(W,X),ne);Pc(W,X)}return null}function ie(W,X,ne,ue){var Re=X!==null?X.key:null;if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return Re!==null?null:U(W,X,""+ne,ue);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case b:return ne.key===Re?F(W,X,ne,ue):null;case x:return ne.key===Re?re(W,X,ne,ue):null;case I:return ne=Js(ne),ie(W,X,ne,ue)}if(G(ne)||$(ne))return Re!==null?null:ce(W,X,ne,ue,null);if(typeof ne.then=="function")return ie(W,X,Bc(ne),ue);if(ne.$$typeof===E)return ie(W,X,$c(W,ne),ue);Pc(W,ne)}return null}function oe(W,X,ne,ue,Re){if(typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint")return W=W.get(ne)||null,U(X,W,""+ue,Re);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case b:return W=W.get(ue.key===null?ne:ue.key)||null,F(X,W,ue,Re);case x:return W=W.get(ue.key===null?ne:ue.key)||null,re(X,W,ue,Re);case I:return ue=Js(ue),oe(W,X,ne,ue,Re)}if(G(ue)||$(ue))return W=W.get(ne)||null,ce(X,W,ue,Re,null);if(typeof ue.then=="function")return oe(W,X,ne,Bc(ue),Re);if(ue.$$typeof===E)return oe(W,X,ne,$c(X,ue),Re);Pc(X,ue)}return null}function xe(W,X,ne,ue){for(var Re=null,Ke=null,Ae=X,Be=X=0,Ye=null;Ae!==null&&Be<ne.length;Be++){Ae.index>Be?(Ye=Ae,Ae=null):Ye=Ae.sibling;var Qe=ie(W,Ae,ne[Be],ue);if(Qe===null){Ae===null&&(Ae=Ye);break}r&&Ae&&Qe.alternate===null&&i(W,Ae),X=y(Qe,X,Be),Ke===null?Re=Qe:Ke.sibling=Qe,Ke=Qe,Ae=Ye}if(Be===ne.length)return o(W,Ae),Xe&&Sr(W,Be),Re;if(Ae===null){for(;Be<ne.length;Be++)Ae=fe(W,ne[Be],ue),Ae!==null&&(X=y(Ae,X,Be),Ke===null?Re=Ae:Ke.sibling=Ae,Ke=Ae);return Xe&&Sr(W,Be),Re}for(Ae=u(Ae);Be<ne.length;Be++)Ye=oe(Ae,W,Be,ne[Be],ue),Ye!==null&&(r&&Ye.alternate!==null&&Ae.delete(Ye.key===null?Be:Ye.key),X=y(Ye,X,Be),Ke===null?Re=Ye:Ke.sibling=Ye,Ke=Ye);return r&&Ae.forEach(function(Cs){return i(W,Cs)}),Xe&&Sr(W,Be),Re}function ke(W,X,ne,ue){if(ne==null)throw Error(s(151));for(var Re=null,Ke=null,Ae=X,Be=X=0,Ye=null,Qe=ne.next();Ae!==null&&!Qe.done;Be++,Qe=ne.next()){Ae.index>Be?(Ye=Ae,Ae=null):Ye=Ae.sibling;var Cs=ie(W,Ae,Qe.value,ue);if(Cs===null){Ae===null&&(Ae=Ye);break}r&&Ae&&Cs.alternate===null&&i(W,Ae),X=y(Cs,X,Be),Ke===null?Re=Cs:Ke.sibling=Cs,Ke=Cs,Ae=Ye}if(Qe.done)return o(W,Ae),Xe&&Sr(W,Be),Re;if(Ae===null){for(;!Qe.done;Be++,Qe=ne.next())Qe=fe(W,Qe.value,ue),Qe!==null&&(X=y(Qe,X,Be),Ke===null?Re=Qe:Ke.sibling=Qe,Ke=Qe);return Xe&&Sr(W,Be),Re}for(Ae=u(Ae);!Qe.done;Be++,Qe=ne.next())Qe=oe(Ae,W,Be,Qe.value,ue),Qe!==null&&(r&&Qe.alternate!==null&&Ae.delete(Qe.key===null?Be:Qe.key),X=y(Qe,X,Be),Ke===null?Re=Qe:Ke.sibling=Qe,Ke=Qe);return r&&Ae.forEach(function(PN){return i(W,PN)}),Xe&&Sr(W,Be),Re}function nt(W,X,ne,ue){if(typeof ne=="object"&&ne!==null&&ne.type===w&&ne.key===null&&(ne=ne.props.children),typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case b:e:{for(var Re=ne.key;X!==null;){if(X.key===Re){if(Re=ne.type,Re===w){if(X.tag===7){o(W,X.sibling),ue=m(X,ne.props.children),ue.return=W,W=ue;break e}}else if(X.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===I&&Js(Re)===X.type){o(W,X.sibling),ue=m(X,ne.props),So(ue,ne),ue.return=W,W=ue;break e}o(W,X);break}else i(W,X);X=X.sibling}ne.type===w?(ue=Gs(ne.props.children,W.mode,ue,ne.key),ue.return=W,W=ue):(ue=Mc(ne.type,ne.key,ne.props,null,W.mode,ue),So(ue,ne),ue.return=W,W=ue)}return T(W);case x:e:{for(Re=ne.key;X!==null;){if(X.key===Re)if(X.tag===4&&X.stateNode.containerInfo===ne.containerInfo&&X.stateNode.implementation===ne.implementation){o(W,X.sibling),ue=m(X,ne.children||[]),ue.return=W,W=ue;break e}else{o(W,X);break}else i(W,X);X=X.sibling}ue=th(ne,W.mode,ue),ue.return=W,W=ue}return T(W);case I:return ne=Js(ne),nt(W,X,ne,ue)}if(G(ne))return xe(W,X,ne,ue);if($(ne)){if(Re=$(ne),typeof Re!="function")throw Error(s(150));return ne=Re.call(ne),ke(W,X,ne,ue)}if(typeof ne.then=="function")return nt(W,X,Bc(ne),ue);if(ne.$$typeof===E)return nt(W,X,$c(W,ne),ue);Pc(W,ne)}return typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint"?(ne=""+ne,X!==null&&X.tag===6?(o(W,X.sibling),ue=m(X,ne),ue.return=W,W=ue):(o(W,X),ue=eh(ne,W.mode,ue),ue.return=W,W=ue),T(W)):o(W,X)}return function(W,X,ne,ue){try{xo=0;var Re=nt(W,X,ne,ue);return ea=null,Re}catch(Ae){if(Ae===Zi||Ae===Lc)throw Ae;var Ke=dn(29,Ae,null,W.mode);return Ke.lanes=ue,Ke.return=W,Ke}finally{}}}var ei=p0(!0),g0=p0(!1),ls=!1;function hh(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function mh(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function cs(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function us(r,i,o){var u=r.updateQueue;if(u===null)return null;if(u=u.shared,(We&2)!==0){var m=u.pending;return m===null?i.next=i:(i.next=m.next,m.next=i),u.pending=i,i=kc(r),Zy(r,null,o),i}return jc(r,u,i,o),kc(r)}function Eo(r,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194048)!==0)){var u=i.lanes;u&=r.pendingLanes,o|=u,i.lanes=o,uc(r,o)}}function ph(r,i){var o=r.updateQueue,u=r.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var m=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var T={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};y===null?m=y=T:y=y.next=T,o=o.next}while(o!==null);y===null?m=y=i:y=y.next=i}else m=y=i;o={baseState:u.baseState,firstBaseUpdate:m,lastBaseUpdate:y,shared:u.shared,callbacks:u.callbacks},r.updateQueue=o;return}r=o.lastBaseUpdate,r===null?o.firstBaseUpdate=i:r.next=i,o.lastBaseUpdate=i}var gh=!1;function Co(){if(gh){var r=Ji;if(r!==null)throw r}}function Ao(r,i,o,u){gh=!1;var m=r.updateQueue;ls=!1;var y=m.firstBaseUpdate,T=m.lastBaseUpdate,U=m.shared.pending;if(U!==null){m.shared.pending=null;var F=U,re=F.next;F.next=null,T===null?y=re:T.next=re,T=F;var ce=r.alternate;ce!==null&&(ce=ce.updateQueue,U=ce.lastBaseUpdate,U!==T&&(U===null?ce.firstBaseUpdate=re:U.next=re,ce.lastBaseUpdate=F))}if(y!==null){var fe=m.baseState;T=0,ce=re=F=null,U=y;do{var ie=U.lane&-536870913,oe=ie!==U.lane;if(oe?(Fe&ie)===ie:(u&ie)===ie){ie!==0&&ie===Wi&&(gh=!0),ce!==null&&(ce=ce.next={lane:0,tag:U.tag,payload:U.payload,callback:null,next:null});e:{var xe=r,ke=U;ie=i;var nt=o;switch(ke.tag){case 1:if(xe=ke.payload,typeof xe=="function"){fe=xe.call(nt,fe,ie);break e}fe=xe;break e;case 3:xe.flags=xe.flags&-65537|128;case 0:if(xe=ke.payload,ie=typeof xe=="function"?xe.call(nt,fe,ie):xe,ie==null)break e;fe=p({},fe,ie);break e;case 2:ls=!0}}ie=U.callback,ie!==null&&(r.flags|=64,oe&&(r.flags|=8192),oe=m.callbacks,oe===null?m.callbacks=[ie]:oe.push(ie))}else oe={lane:ie,tag:U.tag,payload:U.payload,callback:U.callback,next:null},ce===null?(re=ce=oe,F=fe):ce=ce.next=oe,T|=ie;if(U=U.next,U===null){if(U=m.shared.pending,U===null)break;oe=U,U=oe.next,oe.next=null,m.lastBaseUpdate=oe,m.shared.pending=null}}while(!0);ce===null&&(F=fe),m.baseState=F,m.firstBaseUpdate=re,m.lastBaseUpdate=ce,y===null&&(m.shared.lanes=0),ps|=T,r.lanes=T,r.memoizedState=fe}}function y0(r,i){if(typeof r!="function")throw Error(s(191,r));r.call(i)}function v0(r,i){var o=r.callbacks;if(o!==null)for(r.callbacks=null,r=0;r<o.length;r++)y0(o[r],i)}var ta=D(null),qc=D(0);function b0(r,i){r=Dr,J(qc,r),J(ta,i),Dr=r|i.baseLanes}function yh(){J(qc,Dr),J(ta,ta.current)}function vh(){Dr=qc.current,z(ta),z(qc)}var fn=D(null),jn=null;function ds(r){var i=r.alternate;J(gt,gt.current&1),J(fn,r),jn===null&&(i===null||ta.current!==null||i.memoizedState!==null)&&(jn=r)}function bh(r){J(gt,gt.current),J(fn,r),jn===null&&(jn=r)}function _0(r){r.tag===22?(J(gt,gt.current),J(fn,r),jn===null&&(jn=r)):fs()}function fs(){J(gt,gt.current),J(fn,fn.current)}function hn(r){z(fn),jn===r&&(jn=null),z(gt)}var gt=D(0);function Hc(r){for(var i=r;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||Cm(o)||Am(o)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Ar=0,ze=null,et=null,_t=null,Vc=!1,na=!1,ti=!1,Fc=0,To=0,ra=null,jT=0;function mt(){throw Error(s(321))}function _h(r,i){if(i===null)return!1;for(var o=0;o<i.length&&o<r.length;o++)if(!un(r[o],i[o]))return!1;return!0}function wh(r,i,o,u,m,y){return Ar=y,ze=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,k.H=r===null||r.memoizedState===null?rv:$h,ti=!1,y=o(u,m),ti=!1,na&&(y=x0(i,o,u,m)),w0(r),y}function w0(r){k.H=Ro;var i=et!==null&&et.next!==null;if(Ar=0,_t=et=ze=null,Vc=!1,To=0,ra=null,i)throw Error(s(300));r===null||wt||(r=r.dependencies,r!==null&&Uc(r)&&(wt=!0))}function x0(r,i,o,u){ze=r;var m=0;do{if(na&&(ra=null),To=0,na=!1,25<=m)throw Error(s(301));if(m+=1,_t=et=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}k.H=sv,y=i(o,u)}while(na);return y}function kT(){var r=k.H,i=r.useState()[0];return i=typeof i.then=="function"?No(i):i,r=r.useState()[0],(et!==null?et.memoizedState:null)!==r&&(ze.flags|=1024),i}function xh(){var r=Fc!==0;return Fc=0,r}function Sh(r,i,o){i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~o}function Eh(r){if(Vc){for(r=r.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Vc=!1}Ar=0,_t=et=ze=null,na=!1,To=Fc=0,ra=null}function Qt(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _t===null?ze.memoizedState=_t=r:_t=_t.next=r,_t}function yt(){if(et===null){var r=ze.alternate;r=r!==null?r.memoizedState:null}else r=et.next;var i=_t===null?ze.memoizedState:_t.next;if(i!==null)_t=i,et=r;else{if(r===null)throw ze.alternate===null?Error(s(467)):Error(s(310));et=r,r={memoizedState:et.memoizedState,baseState:et.baseState,baseQueue:et.baseQueue,queue:et.queue,next:null},_t===null?ze.memoizedState=_t=r:_t=_t.next=r}return _t}function Yc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function No(r){var i=To;return To+=1,ra===null&&(ra=[]),r=f0(ra,r,i),i=ze,(_t===null?i.memoizedState:_t.next)===null&&(i=i.alternate,k.H=i===null||i.memoizedState===null?rv:$h),r}function Gc(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return No(r);if(r.$$typeof===E)return It(r)}throw Error(s(438,String(r)))}function Ch(r){var i=null,o=ze.updateQueue;if(o!==null&&(i=o.memoCache),i==null){var u=ze.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(i={data:u.data.map(function(m){return m.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),o===null&&(o=Yc(),ze.updateQueue=o),o.memoCache=i,o=i.data[i.index],o===void 0)for(o=i.data[i.index]=Array(r),u=0;u<r;u++)o[u]=K;return i.index++,o}function Tr(r,i){return typeof i=="function"?i(r):i}function Xc(r){var i=yt();return Ah(i,et,r)}function Ah(r,i,o){var u=r.queue;if(u===null)throw Error(s(311));u.lastRenderedReducer=o;var m=r.baseQueue,y=u.pending;if(y!==null){if(m!==null){var T=m.next;m.next=y.next,y.next=T}i.baseQueue=m=y,u.pending=null}if(y=r.baseState,m===null)r.memoizedState=y;else{i=m.next;var U=T=null,F=null,re=i,ce=!1;do{var fe=re.lane&-536870913;if(fe!==re.lane?(Fe&fe)===fe:(Ar&fe)===fe){var ie=re.revertLane;if(ie===0)F!==null&&(F=F.next={lane:0,revertLane:0,gesture:null,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null}),fe===Wi&&(ce=!0);else if((Ar&ie)===ie){re=re.next,ie===Wi&&(ce=!0);continue}else fe={lane:0,revertLane:re.revertLane,gesture:null,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null},F===null?(U=F=fe,T=y):F=F.next=fe,ze.lanes|=ie,ps|=ie;fe=re.action,ti&&o(y,fe),y=re.hasEagerState?re.eagerState:o(y,fe)}else ie={lane:fe,revertLane:re.revertLane,gesture:re.gesture,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null},F===null?(U=F=ie,T=y):F=F.next=ie,ze.lanes|=fe,ps|=fe;re=re.next}while(re!==null&&re!==i);if(F===null?T=y:F.next=U,!un(y,r.memoizedState)&&(wt=!0,ce&&(o=Ji,o!==null)))throw o;r.memoizedState=y,r.baseState=T,r.baseQueue=F,u.lastRenderedState=y}return m===null&&(u.lanes=0),[r.memoizedState,u.dispatch]}function Th(r){var i=yt(),o=i.queue;if(o===null)throw Error(s(311));o.lastRenderedReducer=r;var u=o.dispatch,m=o.pending,y=i.memoizedState;if(m!==null){o.pending=null;var T=m=m.next;do y=r(y,T.action),T=T.next;while(T!==m);un(y,i.memoizedState)||(wt=!0),i.memoizedState=y,i.baseQueue===null&&(i.baseState=y),o.lastRenderedState=y}return[y,u]}function S0(r,i,o){var u=ze,m=yt(),y=Xe;if(y){if(o===void 0)throw Error(s(407));o=o()}else o=i();var T=!un((et||m).memoizedState,o);if(T&&(m.memoizedState=o,wt=!0),m=m.queue,Rh(A0.bind(null,u,m,r),[r]),m.getSnapshot!==i||T||_t!==null&&_t.memoizedState.tag&1){if(u.flags|=2048,sa(9,{destroy:void 0},C0.bind(null,u,m,o,i),null),rt===null)throw Error(s(349));y||(Ar&127)!==0||E0(u,i,o)}return o}function E0(r,i,o){r.flags|=16384,r={getSnapshot:i,value:o},i=ze.updateQueue,i===null?(i=Yc(),ze.updateQueue=i,i.stores=[r]):(o=i.stores,o===null?i.stores=[r]:o.push(r))}function C0(r,i,o,u){i.value=o,i.getSnapshot=u,T0(i)&&N0(r)}function A0(r,i,o){return o(function(){T0(i)&&N0(r)})}function T0(r){var i=r.getSnapshot;r=r.value;try{var o=i();return!un(r,o)}catch{return!0}}function N0(r){var i=Ys(r,2);i!==null&&an(i,r,2)}function Nh(r){var i=Qt();if(typeof r=="function"){var o=r;if(r=o(),ti){we(!0);try{o()}finally{we(!1)}}}return i.memoizedState=i.baseState=r,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Tr,lastRenderedState:r},i}function O0(r,i,o,u){return r.baseState=o,Ah(r,et,typeof u=="function"?u:Tr)}function MT(r,i,o,u,m){if(Wc(r))throw Error(s(485));if(r=i.action,r!==null){var y={payload:m,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){y.listeners.push(T)}};k.T!==null?o(!0):y.isTransition=!1,u(y),o=i.pending,o===null?(y.next=i.pending=y,R0(i,y)):(y.next=o.next,i.pending=o.next=y)}}function R0(r,i){var o=i.action,u=i.payload,m=r.state;if(i.isTransition){var y=k.T,T={};k.T=T;try{var U=o(m,u),F=k.S;F!==null&&F(T,U),j0(r,i,U)}catch(re){Oh(r,i,re)}finally{y!==null&&T.types!==null&&(y.types=T.types),k.T=y}}else try{y=o(m,u),j0(r,i,y)}catch(re){Oh(r,i,re)}}function j0(r,i,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){k0(r,i,u)},function(u){return Oh(r,i,u)}):k0(r,i,o)}function k0(r,i,o){i.status="fulfilled",i.value=o,M0(i),r.state=o,i=r.pending,i!==null&&(o=i.next,o===i?r.pending=null:(o=o.next,i.next=o,R0(r,o)))}function Oh(r,i,o){var u=r.pending;if(r.pending=null,u!==null){u=u.next;do i.status="rejected",i.reason=o,M0(i),i=i.next;while(i!==u)}r.action=null}function M0(r){r=r.listeners;for(var i=0;i<r.length;i++)(0,r[i])()}function D0(r,i){return i}function U0(r,i){if(Xe){var o=rt.formState;if(o!==null){e:{var u=ze;if(Xe){if(it){t:{for(var m=it,y=Rn;m.nodeType!==8;){if(!y){m=null;break t}if(m=kn(m.nextSibling),m===null){m=null;break t}}y=m.data,m=y==="F!"||y==="F"?m:null}if(m){it=kn(m.nextSibling),u=m.data==="F!";break e}}as(u)}u=!1}u&&(i=o[0])}}return o=Qt(),o.memoizedState=o.baseState=i,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:D0,lastRenderedState:i},o.queue=u,o=ev.bind(null,ze,u),u.dispatch=o,u=Nh(!1),y=Uh.bind(null,ze,!1,u.queue),u=Qt(),m={state:i,dispatch:null,action:r,pending:null},u.queue=m,o=MT.bind(null,ze,m,y,o),m.dispatch=o,u.memoizedState=r,[i,o,!1]}function $0(r){var i=yt();return I0(i,et,r)}function I0(r,i,o){if(i=Ah(r,i,D0)[0],r=Xc(Tr)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var u=No(i)}catch(T){throw T===Zi?Lc:T}else u=i;i=yt();var m=i.queue,y=m.dispatch;return o!==i.memoizedState&&(ze.flags|=2048,sa(9,{destroy:void 0},DT.bind(null,m,o),null)),[u,y,r]}function DT(r,i){r.action=i}function L0(r){var i=yt(),o=et;if(o!==null)return I0(i,o,r);yt(),i=i.memoizedState,o=yt();var u=o.queue.dispatch;return o.memoizedState=r,[i,u,!1]}function sa(r,i,o,u){return r={tag:r,create:o,deps:u,inst:i,next:null},i=ze.updateQueue,i===null&&(i=Yc(),ze.updateQueue=i),o=i.lastEffect,o===null?i.lastEffect=r.next=r:(u=o.next,o.next=r,r.next=u,i.lastEffect=r),r}function z0(){return yt().memoizedState}function Kc(r,i,o,u){var m=Qt();ze.flags|=r,m.memoizedState=sa(1|i,{destroy:void 0},o,u===void 0?null:u)}function Qc(r,i,o,u){var m=yt();u=u===void 0?null:u;var y=m.memoizedState.inst;et!==null&&u!==null&&_h(u,et.memoizedState.deps)?m.memoizedState=sa(i,y,o,u):(ze.flags|=r,m.memoizedState=sa(1|i,y,o,u))}function B0(r,i){Kc(8390656,8,r,i)}function Rh(r,i){Qc(2048,8,r,i)}function UT(r){ze.flags|=4;var i=ze.updateQueue;if(i===null)i=Yc(),ze.updateQueue=i,i.events=[r];else{var o=i.events;o===null?i.events=[r]:o.push(r)}}function P0(r){var i=yt().memoizedState;return UT({ref:i,nextImpl:r}),function(){if((We&2)!==0)throw Error(s(440));return i.impl.apply(void 0,arguments)}}function q0(r,i){return Qc(4,2,r,i)}function H0(r,i){return Qc(4,4,r,i)}function V0(r,i){if(typeof i=="function"){r=r();var o=i(r);return function(){typeof o=="function"?o():i(null)}}if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function F0(r,i,o){o=o!=null?o.concat([r]):null,Qc(4,4,V0.bind(null,i,r),o)}function jh(){}function Y0(r,i){var o=yt();i=i===void 0?null:i;var u=o.memoizedState;return i!==null&&_h(i,u[1])?u[0]:(o.memoizedState=[r,i],r)}function G0(r,i){var o=yt();i=i===void 0?null:i;var u=o.memoizedState;if(i!==null&&_h(i,u[1]))return u[0];if(u=r(),ti){we(!0);try{r()}finally{we(!1)}}return o.memoizedState=[u,i],u}function kh(r,i,o){return o===void 0||(Ar&1073741824)!==0&&(Fe&261930)===0?r.memoizedState=i:(r.memoizedState=o,r=Xv(),ze.lanes|=r,ps|=r,o)}function X0(r,i,o,u){return un(o,i)?o:ta.current!==null?(r=kh(r,o,u),un(r,i)||(wt=!0),r):(Ar&42)===0||(Ar&1073741824)!==0&&(Fe&261930)===0?(wt=!0,r.memoizedState=o):(r=Xv(),ze.lanes|=r,ps|=r,i)}function K0(r,i,o,u,m){var y=L.p;L.p=y!==0&&8>y?y:8;var T=k.T,U={};k.T=U,Uh(r,!1,i,o);try{var F=m(),re=k.S;if(re!==null&&re(U,F),F!==null&&typeof F=="object"&&typeof F.then=="function"){var ce=RT(F,u);Oo(r,i,ce,gn(r))}else Oo(r,i,u,gn(r))}catch(fe){Oo(r,i,{then:function(){},status:"rejected",reason:fe},gn())}finally{L.p=y,T!==null&&U.types!==null&&(T.types=U.types),k.T=T}}function $T(){}function Mh(r,i,o,u){if(r.tag!==5)throw Error(s(476));var m=Q0(r).queue;K0(r,m,i,V,o===null?$T:function(){return W0(r),o(u)})}function Q0(r){var i=r.memoizedState;if(i!==null)return i;i={memoizedState:V,baseState:V,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Tr,lastRenderedState:V},next:null};var o={};return i.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Tr,lastRenderedState:o},next:null},r.memoizedState=i,r=r.alternate,r!==null&&(r.memoizedState=i),i}function W0(r){var i=Q0(r);i.next===null&&(i=r.alternate.memoizedState),Oo(r,i.next.queue,{},gn())}function Dh(){return It(Yo)}function J0(){return yt().memoizedState}function Z0(){return yt().memoizedState}function IT(r){for(var i=r.return;i!==null;){switch(i.tag){case 24:case 3:var o=gn();r=cs(o);var u=us(i,r,o);u!==null&&(an(u,i,o),Eo(u,i,o)),i={cache:ch()},r.payload=i;return}i=i.return}}function LT(r,i,o){var u=gn();o={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Wc(r)?tv(i,o):(o=Jf(r,i,o,u),o!==null&&(an(o,r,u),nv(o,i,u)))}function ev(r,i,o){var u=gn();Oo(r,i,o,u)}function Oo(r,i,o,u){var m={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Wc(r))tv(i,m);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=i.lastRenderedReducer,y!==null))try{var T=i.lastRenderedState,U=y(T,o);if(m.hasEagerState=!0,m.eagerState=U,un(U,T))return jc(r,i,m,0),rt===null&&Rc(),!1}catch{}finally{}if(o=Jf(r,i,m,u),o!==null)return an(o,r,u),nv(o,i,u),!0}return!1}function Uh(r,i,o,u){if(u={lane:2,revertLane:hm(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Wc(r)){if(i)throw Error(s(479))}else i=Jf(r,o,u,2),i!==null&&an(i,r,2)}function Wc(r){var i=r.alternate;return r===ze||i!==null&&i===ze}function tv(r,i){na=Vc=!0;var o=r.pending;o===null?i.next=i:(i.next=o.next,o.next=i),r.pending=i}function nv(r,i,o){if((o&4194048)!==0){var u=i.lanes;u&=r.pendingLanes,o|=u,i.lanes=o,uc(r,o)}}var Ro={readContext:It,use:Gc,useCallback:mt,useContext:mt,useEffect:mt,useImperativeHandle:mt,useLayoutEffect:mt,useInsertionEffect:mt,useMemo:mt,useReducer:mt,useRef:mt,useState:mt,useDebugValue:mt,useDeferredValue:mt,useTransition:mt,useSyncExternalStore:mt,useId:mt,useHostTransitionStatus:mt,useFormState:mt,useActionState:mt,useOptimistic:mt,useMemoCache:mt,useCacheRefresh:mt};Ro.useEffectEvent=mt;var rv={readContext:It,use:Gc,useCallback:function(r,i){return Qt().memoizedState=[r,i===void 0?null:i],r},useContext:It,useEffect:B0,useImperativeHandle:function(r,i,o){o=o!=null?o.concat([r]):null,Kc(4194308,4,V0.bind(null,i,r),o)},useLayoutEffect:function(r,i){return Kc(4194308,4,r,i)},useInsertionEffect:function(r,i){Kc(4,2,r,i)},useMemo:function(r,i){var o=Qt();i=i===void 0?null:i;var u=r();if(ti){we(!0);try{r()}finally{we(!1)}}return o.memoizedState=[u,i],u},useReducer:function(r,i,o){var u=Qt();if(o!==void 0){var m=o(i);if(ti){we(!0);try{o(i)}finally{we(!1)}}}else m=i;return u.memoizedState=u.baseState=m,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:m},u.queue=r,r=r.dispatch=LT.bind(null,ze,r),[u.memoizedState,r]},useRef:function(r){var i=Qt();return r={current:r},i.memoizedState=r},useState:function(r){r=Nh(r);var i=r.queue,o=ev.bind(null,ze,i);return i.dispatch=o,[r.memoizedState,o]},useDebugValue:jh,useDeferredValue:function(r,i){var o=Qt();return kh(o,r,i)},useTransition:function(){var r=Nh(!1);return r=K0.bind(null,ze,r.queue,!0,!1),Qt().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,i,o){var u=ze,m=Qt();if(Xe){if(o===void 0)throw Error(s(407));o=o()}else{if(o=i(),rt===null)throw Error(s(349));(Fe&127)!==0||E0(u,i,o)}m.memoizedState=o;var y={value:o,getSnapshot:i};return m.queue=y,B0(A0.bind(null,u,y,r),[r]),u.flags|=2048,sa(9,{destroy:void 0},C0.bind(null,u,y,o,i),null),o},useId:function(){var r=Qt(),i=rt.identifierPrefix;if(Xe){var o=sr,u=rr;o=(u&~(1<<32-De(u)-1)).toString(32)+o,i="_"+i+"R_"+o,o=Fc++,0<o&&(i+="H"+o.toString(32)),i+="_"}else o=jT++,i="_"+i+"r_"+o.toString(32)+"_";return r.memoizedState=i},useHostTransitionStatus:Dh,useFormState:U0,useActionState:U0,useOptimistic:function(r){var i=Qt();i.memoizedState=i.baseState=r;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=o,i=Uh.bind(null,ze,!0,o),o.dispatch=i,[r,i]},useMemoCache:Ch,useCacheRefresh:function(){return Qt().memoizedState=IT.bind(null,ze)},useEffectEvent:function(r){var i=Qt(),o={impl:r};return i.memoizedState=o,function(){if((We&2)!==0)throw Error(s(440));return o.impl.apply(void 0,arguments)}}},$h={readContext:It,use:Gc,useCallback:Y0,useContext:It,useEffect:Rh,useImperativeHandle:F0,useInsertionEffect:q0,useLayoutEffect:H0,useMemo:G0,useReducer:Xc,useRef:z0,useState:function(){return Xc(Tr)},useDebugValue:jh,useDeferredValue:function(r,i){var o=yt();return X0(o,et.memoizedState,r,i)},useTransition:function(){var r=Xc(Tr)[0],i=yt().memoizedState;return[typeof r=="boolean"?r:No(r),i]},useSyncExternalStore:S0,useId:J0,useHostTransitionStatus:Dh,useFormState:$0,useActionState:$0,useOptimistic:function(r,i){var o=yt();return O0(o,et,r,i)},useMemoCache:Ch,useCacheRefresh:Z0};$h.useEffectEvent=P0;var sv={readContext:It,use:Gc,useCallback:Y0,useContext:It,useEffect:Rh,useImperativeHandle:F0,useInsertionEffect:q0,useLayoutEffect:H0,useMemo:G0,useReducer:Th,useRef:z0,useState:function(){return Th(Tr)},useDebugValue:jh,useDeferredValue:function(r,i){var o=yt();return et===null?kh(o,r,i):X0(o,et.memoizedState,r,i)},useTransition:function(){var r=Th(Tr)[0],i=yt().memoizedState;return[typeof r=="boolean"?r:No(r),i]},useSyncExternalStore:S0,useId:J0,useHostTransitionStatus:Dh,useFormState:L0,useActionState:L0,useOptimistic:function(r,i){var o=yt();return et!==null?O0(o,et,r,i):(o.baseState=r,[r,o.queue.dispatch])},useMemoCache:Ch,useCacheRefresh:Z0};sv.useEffectEvent=P0;function Ih(r,i,o,u){i=r.memoizedState,o=o(u,i),o=o==null?i:p({},i,o),r.memoizedState=o,r.lanes===0&&(r.updateQueue.baseState=o)}var Lh={enqueueSetState:function(r,i,o){r=r._reactInternals;var u=gn(),m=cs(u);m.payload=i,o!=null&&(m.callback=o),i=us(r,m,u),i!==null&&(an(i,r,u),Eo(i,r,u))},enqueueReplaceState:function(r,i,o){r=r._reactInternals;var u=gn(),m=cs(u);m.tag=1,m.payload=i,o!=null&&(m.callback=o),i=us(r,m,u),i!==null&&(an(i,r,u),Eo(i,r,u))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var o=gn(),u=cs(o);u.tag=2,i!=null&&(u.callback=i),i=us(r,u,o),i!==null&&(an(i,r,o),Eo(i,r,o))}};function iv(r,i,o,u,m,y,T){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(u,y,T):i.prototype&&i.prototype.isPureReactComponent?!go(o,u)||!go(m,y):!0}function av(r,i,o,u){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,u),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,u),i.state!==r&&Lh.enqueueReplaceState(i,i.state,null)}function ni(r,i){var o=i;if("ref"in i){o={};for(var u in i)u!=="ref"&&(o[u]=i[u])}if(r=r.defaultProps){o===i&&(o=p({},o));for(var m in r)o[m]===void 0&&(o[m]=r[m])}return o}function ov(r){Oc(r)}function lv(r){console.error(r)}function cv(r){Oc(r)}function Jc(r,i){try{var o=r.onUncaughtError;o(i.value,{componentStack:i.stack})}catch(u){setTimeout(function(){throw u})}}function uv(r,i,o){try{var u=r.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function zh(r,i,o){return o=cs(o),o.tag=3,o.payload={element:null},o.callback=function(){Jc(r,i)},o}function dv(r){return r=cs(r),r.tag=3,r}function fv(r,i,o,u){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var y=u.value;r.payload=function(){return m(y)},r.callback=function(){uv(i,o,u)}}var T=o.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(r.callback=function(){uv(i,o,u),typeof m!="function"&&(gs===null?gs=new Set([this]):gs.add(this));var U=u.stack;this.componentDidCatch(u.value,{componentStack:U!==null?U:""})})}function zT(r,i,o,u,m){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(i=o.alternate,i!==null&&Qi(i,o,m,!0),o=fn.current,o!==null){switch(o.tag){case 31:case 13:return jn===null?uu():o.alternate===null&&pt===0&&(pt=3),o.flags&=-257,o.flags|=65536,o.lanes=m,u===zc?o.flags|=16384:(i=o.updateQueue,i===null?o.updateQueue=new Set([u]):i.add(u),um(r,u,m)),!1;case 22:return o.flags|=65536,u===zc?o.flags|=16384:(i=o.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=i):(o=i.retryQueue,o===null?i.retryQueue=new Set([u]):o.add(u)),um(r,u,m)),!1}throw Error(s(435,o.tag))}return um(r,u,m),uu(),!1}if(Xe)return i=fn.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=m,u!==sh&&(r=Error(s(422),{cause:u}),bo(Tn(r,o)))):(u!==sh&&(i=Error(s(423),{cause:u}),bo(Tn(i,o))),r=r.current.alternate,r.flags|=65536,m&=-m,r.lanes|=m,u=Tn(u,o),m=zh(r.stateNode,u,m),ph(r,m),pt!==4&&(pt=2)),!1;var y=Error(s(520),{cause:u});if(y=Tn(y,o),Lo===null?Lo=[y]:Lo.push(y),pt!==4&&(pt=2),i===null)return!0;u=Tn(u,o),o=i;do{switch(o.tag){case 3:return o.flags|=65536,r=m&-m,o.lanes|=r,r=zh(o.stateNode,u,r),ph(o,r),!1;case 1:if(i=o.type,y=o.stateNode,(o.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(gs===null||!gs.has(y))))return o.flags|=65536,m&=-m,o.lanes|=m,m=dv(m),fv(m,r,o,u),ph(o,m),!1}o=o.return}while(o!==null);return!1}var Bh=Error(s(461)),wt=!1;function Lt(r,i,o,u){i.child=r===null?g0(i,null,o,u):ei(i,r.child,o,u)}function hv(r,i,o,u,m){o=o.render;var y=i.ref;if("ref"in u){var T={};for(var U in u)U!=="ref"&&(T[U]=u[U])}else T=u;return Qs(i),u=wh(r,i,o,T,y,m),U=xh(),r!==null&&!wt?(Sh(r,i,m),Nr(r,i,m)):(Xe&&U&&nh(i),i.flags|=1,Lt(r,i,u,m),i.child)}function mv(r,i,o,u,m){if(r===null){var y=o.type;return typeof y=="function"&&!Zf(y)&&y.defaultProps===void 0&&o.compare===null?(i.tag=15,i.type=y,pv(r,i,y,u,m)):(r=Mc(o.type,null,u,i,i.mode,m),r.ref=i.ref,r.return=i,i.child=r)}if(y=r.child,!Xh(r,m)){var T=y.memoizedProps;if(o=o.compare,o=o!==null?o:go,o(T,u)&&r.ref===i.ref)return Nr(r,i,m)}return i.flags|=1,r=xr(y,u),r.ref=i.ref,r.return=i,i.child=r}function pv(r,i,o,u,m){if(r!==null){var y=r.memoizedProps;if(go(y,u)&&r.ref===i.ref)if(wt=!1,i.pendingProps=u=y,Xh(r,m))(r.flags&131072)!==0&&(wt=!0);else return i.lanes=r.lanes,Nr(r,i,m)}return Ph(r,i,o,u,m)}function gv(r,i,o,u){var m=u.children,y=r!==null?r.memoizedState:null;if(r===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((i.flags&128)!==0){if(y=y!==null?y.baseLanes|o:o,r!==null){for(u=i.child=r.child,m=0;u!==null;)m=m|u.lanes|u.childLanes,u=u.sibling;u=m&~y}else u=0,i.child=null;return yv(r,i,y,o,u)}if((o&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},r!==null&&Ic(i,y!==null?y.cachePool:null),y!==null?b0(i,y):yh(),_0(i);else return u=i.lanes=536870912,yv(r,i,y!==null?y.baseLanes|o:o,o,u)}else y!==null?(Ic(i,y.cachePool),b0(i,y),fs(),i.memoizedState=null):(r!==null&&Ic(i,null),yh(),fs());return Lt(r,i,m,o),i.child}function jo(r,i){return r!==null&&r.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function yv(r,i,o,u,m){var y=dh();return y=y===null?null:{parent:bt._currentValue,pool:y},i.memoizedState={baseLanes:o,cachePool:y},r!==null&&Ic(i,null),yh(),_0(i),r!==null&&Qi(r,i,u,!0),i.childLanes=m,null}function Zc(r,i){return i=tu({mode:i.mode,children:i.children},r.mode),i.ref=r.ref,r.child=i,i.return=r,i}function vv(r,i,o){return ei(i,r.child,null,o),r=Zc(i,i.pendingProps),r.flags|=2,hn(i),i.memoizedState=null,r}function BT(r,i,o){var u=i.pendingProps,m=(i.flags&128)!==0;if(i.flags&=-129,r===null){if(Xe){if(u.mode==="hidden")return r=Zc(i,u),i.lanes=536870912,jo(null,r);if(bh(i),(r=it)?(r=Rb(r,Rn),r=r!==null&&r.data==="&"?r:null,r!==null&&(i.memoizedState={dehydrated:r,treeContext:ss!==null?{id:rr,overflow:sr}:null,retryLane:536870912,hydrationErrors:null},o=t0(r),o.return=i,i.child=o,$t=i,it=null)):r=null,r===null)throw as(i);return i.lanes=536870912,null}return Zc(i,u)}var y=r.memoizedState;if(y!==null){var T=y.dehydrated;if(bh(i),m)if(i.flags&256)i.flags&=-257,i=vv(r,i,o);else if(i.memoizedState!==null)i.child=r.child,i.flags|=128,i=null;else throw Error(s(558));else if(wt||Qi(r,i,o,!1),m=(o&r.childLanes)!==0,wt||m){if(u=rt,u!==null&&(T=dc(u,o),T!==0&&T!==y.retryLane))throw y.retryLane=T,Ys(r,T),an(u,r,T),Bh;uu(),i=vv(r,i,o)}else r=y.treeContext,it=kn(T.nextSibling),$t=i,Xe=!0,is=null,Rn=!1,r!==null&&s0(i,r),i=Zc(i,u),i.flags|=4096;return i}return r=xr(r.child,{mode:u.mode,children:u.children}),r.ref=i.ref,i.child=r,r.return=i,r}function eu(r,i){var o=i.ref;if(o===null)r!==null&&r.ref!==null&&(i.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(s(284));(r===null||r.ref!==o)&&(i.flags|=4194816)}}function Ph(r,i,o,u,m){return Qs(i),o=wh(r,i,o,u,void 0,m),u=xh(),r!==null&&!wt?(Sh(r,i,m),Nr(r,i,m)):(Xe&&u&&nh(i),i.flags|=1,Lt(r,i,o,m),i.child)}function bv(r,i,o,u,m,y){return Qs(i),i.updateQueue=null,o=x0(i,u,o,m),w0(r),u=xh(),r!==null&&!wt?(Sh(r,i,y),Nr(r,i,y)):(Xe&&u&&nh(i),i.flags|=1,Lt(r,i,o,y),i.child)}function _v(r,i,o,u,m){if(Qs(i),i.stateNode===null){var y=Yi,T=o.contextType;typeof T=="object"&&T!==null&&(y=It(T)),y=new o(u,y),i.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Lh,i.stateNode=y,y._reactInternals=i,y=i.stateNode,y.props=u,y.state=i.memoizedState,y.refs={},hh(i),T=o.contextType,y.context=typeof T=="object"&&T!==null?It(T):Yi,y.state=i.memoizedState,T=o.getDerivedStateFromProps,typeof T=="function"&&(Ih(i,o,T,u),y.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(T=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),T!==y.state&&Lh.enqueueReplaceState(y,y.state,null),Ao(i,u,y,m),Co(),y.state=i.memoizedState),typeof y.componentDidMount=="function"&&(i.flags|=4194308),u=!0}else if(r===null){y=i.stateNode;var U=i.memoizedProps,F=ni(o,U);y.props=F;var re=y.context,ce=o.contextType;T=Yi,typeof ce=="object"&&ce!==null&&(T=It(ce));var fe=o.getDerivedStateFromProps;ce=typeof fe=="function"||typeof y.getSnapshotBeforeUpdate=="function",U=i.pendingProps!==U,ce||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(U||re!==T)&&av(i,y,u,T),ls=!1;var ie=i.memoizedState;y.state=ie,Ao(i,u,y,m),Co(),re=i.memoizedState,U||ie!==re||ls?(typeof fe=="function"&&(Ih(i,o,fe,u),re=i.memoizedState),(F=ls||iv(i,o,F,u,ie,re,T))?(ce||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(i.flags|=4194308)):(typeof y.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=u,i.memoizedState=re),y.props=u,y.state=re,y.context=T,u=F):(typeof y.componentDidMount=="function"&&(i.flags|=4194308),u=!1)}else{y=i.stateNode,mh(r,i),T=i.memoizedProps,ce=ni(o,T),y.props=ce,fe=i.pendingProps,ie=y.context,re=o.contextType,F=Yi,typeof re=="object"&&re!==null&&(F=It(re)),U=o.getDerivedStateFromProps,(re=typeof U=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(T!==fe||ie!==F)&&av(i,y,u,F),ls=!1,ie=i.memoizedState,y.state=ie,Ao(i,u,y,m),Co();var oe=i.memoizedState;T!==fe||ie!==oe||ls||r!==null&&r.dependencies!==null&&Uc(r.dependencies)?(typeof U=="function"&&(Ih(i,o,U,u),oe=i.memoizedState),(ce=ls||iv(i,o,ce,u,ie,oe,F)||r!==null&&r.dependencies!==null&&Uc(r.dependencies))?(re||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(u,oe,F),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(u,oe,F)),typeof y.componentDidUpdate=="function"&&(i.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof y.componentDidUpdate!="function"||T===r.memoizedProps&&ie===r.memoizedState||(i.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||T===r.memoizedProps&&ie===r.memoizedState||(i.flags|=1024),i.memoizedProps=u,i.memoizedState=oe),y.props=u,y.state=oe,y.context=F,u=ce):(typeof y.componentDidUpdate!="function"||T===r.memoizedProps&&ie===r.memoizedState||(i.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||T===r.memoizedProps&&ie===r.memoizedState||(i.flags|=1024),u=!1)}return y=u,eu(r,i),u=(i.flags&128)!==0,y||u?(y=i.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:y.render(),i.flags|=1,r!==null&&u?(i.child=ei(i,r.child,null,m),i.child=ei(i,null,o,m)):Lt(r,i,o,m),i.memoizedState=y.state,r=i.child):r=Nr(r,i,m),r}function wv(r,i,o,u){return Xs(),i.flags|=256,Lt(r,i,o,u),i.child}var qh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Hh(r){return{baseLanes:r,cachePool:u0()}}function Vh(r,i,o){return r=r!==null?r.childLanes&~o:0,i&&(r|=pn),r}function xv(r,i,o){var u=i.pendingProps,m=!1,y=(i.flags&128)!==0,T;if((T=y)||(T=r!==null&&r.memoizedState===null?!1:(gt.current&2)!==0),T&&(m=!0,i.flags&=-129),T=(i.flags&32)!==0,i.flags&=-33,r===null){if(Xe){if(m?ds(i):fs(),(r=it)?(r=Rb(r,Rn),r=r!==null&&r.data!=="&"?r:null,r!==null&&(i.memoizedState={dehydrated:r,treeContext:ss!==null?{id:rr,overflow:sr}:null,retryLane:536870912,hydrationErrors:null},o=t0(r),o.return=i,i.child=o,$t=i,it=null)):r=null,r===null)throw as(i);return Am(r)?i.lanes=32:i.lanes=536870912,null}var U=u.children;return u=u.fallback,m?(fs(),m=i.mode,U=tu({mode:"hidden",children:U},m),u=Gs(u,m,o,null),U.return=i,u.return=i,U.sibling=u,i.child=U,u=i.child,u.memoizedState=Hh(o),u.childLanes=Vh(r,T,o),i.memoizedState=qh,jo(null,u)):(ds(i),Fh(i,U))}var F=r.memoizedState;if(F!==null&&(U=F.dehydrated,U!==null)){if(y)i.flags&256?(ds(i),i.flags&=-257,i=Yh(r,i,o)):i.memoizedState!==null?(fs(),i.child=r.child,i.flags|=128,i=null):(fs(),U=u.fallback,m=i.mode,u=tu({mode:"visible",children:u.children},m),U=Gs(U,m,o,null),U.flags|=2,u.return=i,U.return=i,u.sibling=U,i.child=u,ei(i,r.child,null,o),u=i.child,u.memoizedState=Hh(o),u.childLanes=Vh(r,T,o),i.memoizedState=qh,i=jo(null,u));else if(ds(i),Am(U)){if(T=U.nextSibling&&U.nextSibling.dataset,T)var re=T.dgst;T=re,u=Error(s(419)),u.stack="",u.digest=T,bo({value:u,source:null,stack:null}),i=Yh(r,i,o)}else if(wt||Qi(r,i,o,!1),T=(o&r.childLanes)!==0,wt||T){if(T=rt,T!==null&&(u=dc(T,o),u!==0&&u!==F.retryLane))throw F.retryLane=u,Ys(r,u),an(T,r,u),Bh;Cm(U)||uu(),i=Yh(r,i,o)}else Cm(U)?(i.flags|=192,i.child=r.child,i=null):(r=F.treeContext,it=kn(U.nextSibling),$t=i,Xe=!0,is=null,Rn=!1,r!==null&&s0(i,r),i=Fh(i,u.children),i.flags|=4096);return i}return m?(fs(),U=u.fallback,m=i.mode,F=r.child,re=F.sibling,u=xr(F,{mode:"hidden",children:u.children}),u.subtreeFlags=F.subtreeFlags&65011712,re!==null?U=xr(re,U):(U=Gs(U,m,o,null),U.flags|=2),U.return=i,u.return=i,u.sibling=U,i.child=u,jo(null,u),u=i.child,U=r.child.memoizedState,U===null?U=Hh(o):(m=U.cachePool,m!==null?(F=bt._currentValue,m=m.parent!==F?{parent:F,pool:F}:m):m=u0(),U={baseLanes:U.baseLanes|o,cachePool:m}),u.memoizedState=U,u.childLanes=Vh(r,T,o),i.memoizedState=qh,jo(r.child,u)):(ds(i),o=r.child,r=o.sibling,o=xr(o,{mode:"visible",children:u.children}),o.return=i,o.sibling=null,r!==null&&(T=i.deletions,T===null?(i.deletions=[r],i.flags|=16):T.push(r)),i.child=o,i.memoizedState=null,o)}function Fh(r,i){return i=tu({mode:"visible",children:i},r.mode),i.return=r,r.child=i}function tu(r,i){return r=dn(22,r,null,i),r.lanes=0,r}function Yh(r,i,o){return ei(i,r.child,null,o),r=Fh(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function Sv(r,i,o){r.lanes|=i;var u=r.alternate;u!==null&&(u.lanes|=i),oh(r.return,i,o)}function Gh(r,i,o,u,m,y){var T=r.memoizedState;T===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:m,treeForkCount:y}:(T.isBackwards=i,T.rendering=null,T.renderingStartTime=0,T.last=u,T.tail=o,T.tailMode=m,T.treeForkCount=y)}function Ev(r,i,o){var u=i.pendingProps,m=u.revealOrder,y=u.tail;u=u.children;var T=gt.current,U=(T&2)!==0;if(U?(T=T&1|2,i.flags|=128):T&=1,J(gt,T),Lt(r,i,u,o),u=Xe?vo:0,!U&&r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Sv(r,o,i);else if(r.tag===19)Sv(r,o,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(m){case"forwards":for(o=i.child,m=null;o!==null;)r=o.alternate,r!==null&&Hc(r)===null&&(m=o),o=o.sibling;o=m,o===null?(m=i.child,i.child=null):(m=o.sibling,o.sibling=null),Gh(i,!1,m,o,y,u);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=i.child,i.child=null;m!==null;){if(r=m.alternate,r!==null&&Hc(r)===null){i.child=m;break}r=m.sibling,m.sibling=o,o=m,m=r}Gh(i,!0,o,null,y,u);break;case"together":Gh(i,!1,null,null,void 0,u);break;default:i.memoizedState=null}return i.child}function Nr(r,i,o){if(r!==null&&(i.dependencies=r.dependencies),ps|=i.lanes,(o&i.childLanes)===0)if(r!==null){if(Qi(r,i,o,!1),(o&i.childLanes)===0)return null}else return null;if(r!==null&&i.child!==r.child)throw Error(s(153));if(i.child!==null){for(r=i.child,o=xr(r,r.pendingProps),i.child=o,o.return=i;r.sibling!==null;)r=r.sibling,o=o.sibling=xr(r,r.pendingProps),o.return=i;o.sibling=null}return i.child}function Xh(r,i){return(r.lanes&i)!==0?!0:(r=r.dependencies,!!(r!==null&&Uc(r)))}function PT(r,i,o){switch(i.tag){case 3:le(i,i.stateNode.containerInfo),os(i,bt,r.memoizedState.cache),Xs();break;case 27:case 5:de(i);break;case 4:le(i,i.stateNode.containerInfo);break;case 10:os(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,bh(i),null;break;case 13:var u=i.memoizedState;if(u!==null)return u.dehydrated!==null?(ds(i),i.flags|=128,null):(o&i.child.childLanes)!==0?xv(r,i,o):(ds(i),r=Nr(r,i,o),r!==null?r.sibling:null);ds(i);break;case 19:var m=(r.flags&128)!==0;if(u=(o&i.childLanes)!==0,u||(Qi(r,i,o,!1),u=(o&i.childLanes)!==0),m){if(u)return Ev(r,i,o);i.flags|=128}if(m=i.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),J(gt,gt.current),u)break;return null;case 22:return i.lanes=0,gv(r,i,o,i.pendingProps);case 24:os(i,bt,r.memoizedState.cache)}return Nr(r,i,o)}function Cv(r,i,o){if(r!==null)if(r.memoizedProps!==i.pendingProps)wt=!0;else{if(!Xh(r,o)&&(i.flags&128)===0)return wt=!1,PT(r,i,o);wt=(r.flags&131072)!==0}else wt=!1,Xe&&(i.flags&1048576)!==0&&r0(i,vo,i.index);switch(i.lanes=0,i.tag){case 16:e:{var u=i.pendingProps;if(r=Js(i.elementType),i.type=r,typeof r=="function")Zf(r)?(u=ni(r,u),i.tag=1,i=_v(null,i,r,u,o)):(i.tag=0,i=Ph(null,i,r,u,o));else{if(r!=null){var m=r.$$typeof;if(m===C){i.tag=11,i=hv(null,i,r,u,o);break e}else if(m===M){i.tag=14,i=mv(null,i,r,u,o);break e}}throw i=B(r)||r,Error(s(306,i,""))}}return i;case 0:return Ph(r,i,i.type,i.pendingProps,o);case 1:return u=i.type,m=ni(u,i.pendingProps),_v(r,i,u,m,o);case 3:e:{if(le(i,i.stateNode.containerInfo),r===null)throw Error(s(387));u=i.pendingProps;var y=i.memoizedState;m=y.element,mh(r,i),Ao(i,u,null,o);var T=i.memoizedState;if(u=T.cache,os(i,bt,u),u!==y.cache&&lh(i,[bt],o,!0),Co(),u=T.element,y.isDehydrated)if(y={element:u,isDehydrated:!1,cache:T.cache},i.updateQueue.baseState=y,i.memoizedState=y,i.flags&256){i=wv(r,i,u,o);break e}else if(u!==m){m=Tn(Error(s(424)),i),bo(m),i=wv(r,i,u,o);break e}else{switch(r=i.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(it=kn(r.firstChild),$t=i,Xe=!0,is=null,Rn=!0,o=g0(i,null,u,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(Xs(),u===m){i=Nr(r,i,o);break e}Lt(r,i,u,o)}i=i.child}return i;case 26:return eu(r,i),r===null?(o=$b(i.type,null,i.pendingProps,null))?i.memoizedState=o:Xe||(o=i.type,r=i.pendingProps,u=yu(pe.current).createElement(o),u[Tt]=i,u[Ht]=r,zt(u,o,r),vt(u),i.stateNode=u):i.memoizedState=$b(i.type,r.memoizedProps,i.pendingProps,r.memoizedState),null;case 27:return de(i),r===null&&Xe&&(u=i.stateNode=Mb(i.type,i.pendingProps,pe.current),$t=i,Rn=!0,m=it,_s(i.type)?(Tm=m,it=kn(u.firstChild)):it=m),Lt(r,i,i.pendingProps.children,o),eu(r,i),r===null&&(i.flags|=4194304),i.child;case 5:return r===null&&Xe&&((m=u=it)&&(u=yN(u,i.type,i.pendingProps,Rn),u!==null?(i.stateNode=u,$t=i,it=kn(u.firstChild),Rn=!1,m=!0):m=!1),m||as(i)),de(i),m=i.type,y=i.pendingProps,T=r!==null?r.memoizedProps:null,u=y.children,xm(m,y)?u=null:T!==null&&xm(m,T)&&(i.flags|=32),i.memoizedState!==null&&(m=wh(r,i,kT,null,null,o),Yo._currentValue=m),eu(r,i),Lt(r,i,u,o),i.child;case 6:return r===null&&Xe&&((r=o=it)&&(o=vN(o,i.pendingProps,Rn),o!==null?(i.stateNode=o,$t=i,it=null,r=!0):r=!1),r||as(i)),null;case 13:return xv(r,i,o);case 4:return le(i,i.stateNode.containerInfo),u=i.pendingProps,r===null?i.child=ei(i,null,u,o):Lt(r,i,u,o),i.child;case 11:return hv(r,i,i.type,i.pendingProps,o);case 7:return Lt(r,i,i.pendingProps,o),i.child;case 8:return Lt(r,i,i.pendingProps.children,o),i.child;case 12:return Lt(r,i,i.pendingProps.children,o),i.child;case 10:return u=i.pendingProps,os(i,i.type,u.value),Lt(r,i,u.children,o),i.child;case 9:return m=i.type._context,u=i.pendingProps.children,Qs(i),m=It(m),u=u(m),i.flags|=1,Lt(r,i,u,o),i.child;case 14:return mv(r,i,i.type,i.pendingProps,o);case 15:return pv(r,i,i.type,i.pendingProps,o);case 19:return Ev(r,i,o);case 31:return BT(r,i,o);case 22:return gv(r,i,o,i.pendingProps);case 24:return Qs(i),u=It(bt),r===null?(m=dh(),m===null&&(m=rt,y=ch(),m.pooledCache=y,y.refCount++,y!==null&&(m.pooledCacheLanes|=o),m=y),i.memoizedState={parent:u,cache:m},hh(i),os(i,bt,m)):((r.lanes&o)!==0&&(mh(r,i),Ao(i,null,null,o),Co()),m=r.memoizedState,y=i.memoizedState,m.parent!==u?(m={parent:u,cache:u},i.memoizedState=m,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=m),os(i,bt,u)):(u=y.cache,os(i,bt,u),u!==m.cache&&lh(i,[bt],o,!0))),Lt(r,i,i.pendingProps.children,o),i.child;case 29:throw i.pendingProps}throw Error(s(156,i.tag))}function Or(r){r.flags|=4}function Kh(r,i,o,u,m){if((i=(r.mode&32)!==0)&&(i=!1),i){if(r.flags|=16777216,(m&335544128)===m)if(r.stateNode.complete)r.flags|=8192;else if(Jv())r.flags|=8192;else throw Zs=zc,fh}else r.flags&=-16777217}function Av(r,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Pb(i))if(Jv())r.flags|=8192;else throw Zs=zc,fh}function nu(r,i){i!==null&&(r.flags|=4),r.flags&16384&&(i=r.tag!==22?lc():536870912,r.lanes|=i,la|=i)}function ko(r,i){if(!Xe)switch(r.tailMode){case"hidden":i=r.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?r.tail=null:o.sibling=null;break;case"collapsed":o=r.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:u.sibling=null}}function at(r){var i=r.alternate!==null&&r.alternate.child===r.child,o=0,u=0;if(i)for(var m=r.child;m!==null;)o|=m.lanes|m.childLanes,u|=m.subtreeFlags&65011712,u|=m.flags&65011712,m.return=r,m=m.sibling;else for(m=r.child;m!==null;)o|=m.lanes|m.childLanes,u|=m.subtreeFlags,u|=m.flags,m.return=r,m=m.sibling;return r.subtreeFlags|=u,r.childLanes=o,i}function qT(r,i,o){var u=i.pendingProps;switch(rh(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return at(i),null;case 1:return at(i),null;case 3:return o=i.stateNode,u=null,r!==null&&(u=r.memoizedState.cache),i.memoizedState.cache!==u&&(i.flags|=2048),Cr(bt),Z(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(r===null||r.child===null)&&(Ki(i)?Or(i):r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,ih())),at(i),null;case 26:var m=i.type,y=i.memoizedState;return r===null?(Or(i),y!==null?(at(i),Av(i,y)):(at(i),Kh(i,m,null,u,o))):y?y!==r.memoizedState?(Or(i),at(i),Av(i,y)):(at(i),i.flags&=-16777217):(r=r.memoizedProps,r!==u&&Or(i),at(i),Kh(i,m,r,u,o)),null;case 27:if(ge(i),o=pe.current,m=i.type,r!==null&&i.stateNode!=null)r.memoizedProps!==u&&Or(i);else{if(!u){if(i.stateNode===null)throw Error(s(166));return at(i),null}r=ee.current,Ki(i)?i0(i):(r=Mb(m,u,o),i.stateNode=r,Or(i))}return at(i),null;case 5:if(ge(i),m=i.type,r!==null&&i.stateNode!=null)r.memoizedProps!==u&&Or(i);else{if(!u){if(i.stateNode===null)throw Error(s(166));return at(i),null}if(y=ee.current,Ki(i))i0(i);else{var T=yu(pe.current);switch(y){case 1:y=T.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:y=T.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":y=T.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":y=T.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":y=T.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof u.is=="string"?T.createElement("select",{is:u.is}):T.createElement("select"),u.multiple?y.multiple=!0:u.size&&(y.size=u.size);break;default:y=typeof u.is=="string"?T.createElement(m,{is:u.is}):T.createElement(m)}}y[Tt]=i,y[Ht]=u;e:for(T=i.child;T!==null;){if(T.tag===5||T.tag===6)y.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===i)break e;for(;T.sibling===null;){if(T.return===null||T.return===i)break e;T=T.return}T.sibling.return=T.return,T=T.sibling}i.stateNode=y;e:switch(zt(y,m,u),m){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Or(i)}}return at(i),Kh(i,i.type,r===null?null:r.memoizedProps,i.pendingProps,o),null;case 6:if(r&&i.stateNode!=null)r.memoizedProps!==u&&Or(i);else{if(typeof u!="string"&&i.stateNode===null)throw Error(s(166));if(r=pe.current,Ki(i)){if(r=i.stateNode,o=i.memoizedProps,u=null,m=$t,m!==null)switch(m.tag){case 27:case 5:u=m.memoizedProps}r[Tt]=i,r=!!(r.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||xb(r.nodeValue,o)),r||as(i,!0)}else r=yu(r).createTextNode(u),r[Tt]=i,i.stateNode=r}return at(i),null;case 31:if(o=i.memoizedState,r===null||r.memoizedState!==null){if(u=Ki(i),o!==null){if(r===null){if(!u)throw Error(s(318));if(r=i.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(557));r[Tt]=i}else Xs(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;at(i),r=!1}else o=ih(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=o),r=!0;if(!r)return i.flags&256?(hn(i),i):(hn(i),null);if((i.flags&128)!==0)throw Error(s(558))}return at(i),null;case 13:if(u=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(m=Ki(i),u!==null&&u.dehydrated!==null){if(r===null){if(!m)throw Error(s(318));if(m=i.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(s(317));m[Tt]=i}else Xs(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;at(i),m=!1}else m=ih(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=m),m=!0;if(!m)return i.flags&256?(hn(i),i):(hn(i),null)}return hn(i),(i.flags&128)!==0?(i.lanes=o,i):(o=u!==null,r=r!==null&&r.memoizedState!==null,o&&(u=i.child,m=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(m=u.alternate.memoizedState.cachePool.pool),y=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(y=u.memoizedState.cachePool.pool),y!==m&&(u.flags|=2048)),o!==r&&o&&(i.child.flags|=8192),nu(i,i.updateQueue),at(i),null);case 4:return Z(),r===null&&ym(i.stateNode.containerInfo),at(i),null;case 10:return Cr(i.type),at(i),null;case 19:if(z(gt),u=i.memoizedState,u===null)return at(i),null;if(m=(i.flags&128)!==0,y=u.rendering,y===null)if(m)ko(u,!1);else{if(pt!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(y=Hc(r),y!==null){for(i.flags|=128,ko(u,!1),r=y.updateQueue,i.updateQueue=r,nu(i,r),i.subtreeFlags=0,r=o,o=i.child;o!==null;)e0(o,r),o=o.sibling;return J(gt,gt.current&1|2),Xe&&Sr(i,u.treeForkCount),i.child}r=r.sibling}u.tail!==null&&At()>ou&&(i.flags|=128,m=!0,ko(u,!1),i.lanes=4194304)}else{if(!m)if(r=Hc(y),r!==null){if(i.flags|=128,m=!0,r=r.updateQueue,i.updateQueue=r,nu(i,r),ko(u,!0),u.tail===null&&u.tailMode==="hidden"&&!y.alternate&&!Xe)return at(i),null}else 2*At()-u.renderingStartTime>ou&&o!==536870912&&(i.flags|=128,m=!0,ko(u,!1),i.lanes=4194304);u.isBackwards?(y.sibling=i.child,i.child=y):(r=u.last,r!==null?r.sibling=y:i.child=y,u.last=y)}return u.tail!==null?(r=u.tail,u.rendering=r,u.tail=r.sibling,u.renderingStartTime=At(),r.sibling=null,o=gt.current,J(gt,m?o&1|2:o&1),Xe&&Sr(i,u.treeForkCount),r):(at(i),null);case 22:case 23:return hn(i),vh(),u=i.memoizedState!==null,r!==null?r.memoizedState!==null!==u&&(i.flags|=8192):u&&(i.flags|=8192),u?(o&536870912)!==0&&(i.flags&128)===0&&(at(i),i.subtreeFlags&6&&(i.flags|=8192)):at(i),o=i.updateQueue,o!==null&&nu(i,o.retryQueue),o=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),u=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),u!==o&&(i.flags|=2048),r!==null&&z(Ws),null;case 24:return o=null,r!==null&&(o=r.memoizedState.cache),i.memoizedState.cache!==o&&(i.flags|=2048),Cr(bt),at(i),null;case 25:return null;case 30:return null}throw Error(s(156,i.tag))}function HT(r,i){switch(rh(i),i.tag){case 1:return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return Cr(bt),Z(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 26:case 27:case 5:return ge(i),null;case 31:if(i.memoizedState!==null){if(hn(i),i.alternate===null)throw Error(s(340));Xs()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 13:if(hn(i),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(s(340));Xs()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return z(gt),null;case 4:return Z(),null;case 10:return Cr(i.type),null;case 22:case 23:return hn(i),vh(),r!==null&&z(Ws),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 24:return Cr(bt),null;case 25:return null;default:return null}}function Tv(r,i){switch(rh(i),i.tag){case 3:Cr(bt),Z();break;case 26:case 27:case 5:ge(i);break;case 4:Z();break;case 31:i.memoizedState!==null&&hn(i);break;case 13:hn(i);break;case 19:z(gt);break;case 10:Cr(i.type);break;case 22:case 23:hn(i),vh(),r!==null&&z(Ws);break;case 24:Cr(bt)}}function Mo(r,i){try{var o=i.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var m=u.next;o=m;do{if((o.tag&r)===r){u=void 0;var y=o.create,T=o.inst;u=y(),T.destroy=u}o=o.next}while(o!==m)}}catch(U){Ze(i,i.return,U)}}function hs(r,i,o){try{var u=i.updateQueue,m=u!==null?u.lastEffect:null;if(m!==null){var y=m.next;u=y;do{if((u.tag&r)===r){var T=u.inst,U=T.destroy;if(U!==void 0){T.destroy=void 0,m=i;var F=o,re=U;try{re()}catch(ce){Ze(m,F,ce)}}}u=u.next}while(u!==y)}}catch(ce){Ze(i,i.return,ce)}}function Nv(r){var i=r.updateQueue;if(i!==null){var o=r.stateNode;try{v0(i,o)}catch(u){Ze(r,r.return,u)}}}function Ov(r,i,o){o.props=ni(r.type,r.memoizedProps),o.state=r.memoizedState;try{o.componentWillUnmount()}catch(u){Ze(r,i,u)}}function Do(r,i){try{var o=r.ref;if(o!==null){switch(r.tag){case 26:case 27:case 5:var u=r.stateNode;break;case 30:u=r.stateNode;break;default:u=r.stateNode}typeof o=="function"?r.refCleanup=o(u):o.current=u}}catch(m){Ze(r,i,m)}}function ir(r,i){var o=r.ref,u=r.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(m){Ze(r,i,m)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){Ze(r,i,m)}else o.current=null}function Rv(r){var i=r.type,o=r.memoizedProps,u=r.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(m){Ze(r,r.return,m)}}function Qh(r,i,o){try{var u=r.stateNode;dN(u,r.type,o,i),u[Ht]=i}catch(m){Ze(r,r.return,m)}}function jv(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&_s(r.type)||r.tag===4}function Wh(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||jv(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&_s(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Jh(r,i,o){var u=r.tag;if(u===5||u===6)r=r.stateNode,i?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(r,i):(i=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,i.appendChild(r),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=_r));else if(u!==4&&(u===27&&_s(r.type)&&(o=r.stateNode,i=null),r=r.child,r!==null))for(Jh(r,i,o),r=r.sibling;r!==null;)Jh(r,i,o),r=r.sibling}function ru(r,i,o){var u=r.tag;if(u===5||u===6)r=r.stateNode,i?o.insertBefore(r,i):o.appendChild(r);else if(u!==4&&(u===27&&_s(r.type)&&(o=r.stateNode),r=r.child,r!==null))for(ru(r,i,o),r=r.sibling;r!==null;)ru(r,i,o),r=r.sibling}function kv(r){var i=r.stateNode,o=r.memoizedProps;try{for(var u=r.type,m=i.attributes;m.length;)i.removeAttributeNode(m[0]);zt(i,u,o),i[Tt]=r,i[Ht]=o}catch(y){Ze(r,r.return,y)}}var Rr=!1,xt=!1,Zh=!1,Mv=typeof WeakSet=="function"?WeakSet:Set,Dt=null;function VT(r,i){if(r=r.containerInfo,_m=Eu,r=Fy(r),Yf(r)){if("selectionStart"in r)var o={start:r.selectionStart,end:r.selectionEnd};else e:{o=(o=r.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var m=u.anchorOffset,y=u.focusNode;u=u.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var T=0,U=-1,F=-1,re=0,ce=0,fe=r,ie=null;t:for(;;){for(var oe;fe!==o||m!==0&&fe.nodeType!==3||(U=T+m),fe!==y||u!==0&&fe.nodeType!==3||(F=T+u),fe.nodeType===3&&(T+=fe.nodeValue.length),(oe=fe.firstChild)!==null;)ie=fe,fe=oe;for(;;){if(fe===r)break t;if(ie===o&&++re===m&&(U=T),ie===y&&++ce===u&&(F=T),(oe=fe.nextSibling)!==null)break;fe=ie,ie=fe.parentNode}fe=oe}o=U===-1||F===-1?null:{start:U,end:F}}else o=null}o=o||{start:0,end:0}}else o=null;for(wm={focusedElem:r,selectionRange:o},Eu=!1,Dt=i;Dt!==null;)if(i=Dt,r=i.child,(i.subtreeFlags&1028)!==0&&r!==null)r.return=i,Dt=r;else for(;Dt!==null;){switch(i=Dt,y=i.alternate,r=i.flags,i.tag){case 0:if((r&4)!==0&&(r=i.updateQueue,r=r!==null?r.events:null,r!==null))for(o=0;o<r.length;o++)m=r[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,o=i,m=y.memoizedProps,y=y.memoizedState,u=o.stateNode;try{var xe=ni(o.type,m);r=u.getSnapshotBeforeUpdate(xe,y),u.__reactInternalSnapshotBeforeUpdate=r}catch(ke){Ze(o,o.return,ke)}}break;case 3:if((r&1024)!==0){if(r=i.stateNode.containerInfo,o=r.nodeType,o===9)Em(r);else if(o===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Em(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(s(163))}if(r=i.sibling,r!==null){r.return=i.return,Dt=r;break}Dt=i.return}}function Dv(r,i,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:kr(r,o),u&4&&Mo(5,o);break;case 1:if(kr(r,o),u&4)if(r=o.stateNode,i===null)try{r.componentDidMount()}catch(T){Ze(o,o.return,T)}else{var m=ni(o.type,i.memoizedProps);i=i.memoizedState;try{r.componentDidUpdate(m,i,r.__reactInternalSnapshotBeforeUpdate)}catch(T){Ze(o,o.return,T)}}u&64&&Nv(o),u&512&&Do(o,o.return);break;case 3:if(kr(r,o),u&64&&(r=o.updateQueue,r!==null)){if(i=null,o.child!==null)switch(o.child.tag){case 27:case 5:i=o.child.stateNode;break;case 1:i=o.child.stateNode}try{v0(r,i)}catch(T){Ze(o,o.return,T)}}break;case 27:i===null&&u&4&&kv(o);case 26:case 5:kr(r,o),i===null&&u&4&&Rv(o),u&512&&Do(o,o.return);break;case 12:kr(r,o);break;case 31:kr(r,o),u&4&&Iv(r,o);break;case 13:kr(r,o),u&4&&Lv(r,o),u&64&&(r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(o=ZT.bind(null,o),bN(r,o))));break;case 22:if(u=o.memoizedState!==null||Rr,!u){i=i!==null&&i.memoizedState!==null||xt,m=Rr;var y=xt;Rr=u,(xt=i)&&!y?Mr(r,o,(o.subtreeFlags&8772)!==0):kr(r,o),Rr=m,xt=y}break;case 30:break;default:kr(r,o)}}function Uv(r){var i=r.alternate;i!==null&&(r.alternate=null,Uv(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&io(i)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var lt=null,tn=!1;function jr(r,i,o){for(o=o.child;o!==null;)$v(r,i,o),o=o.sibling}function $v(r,i,o){if(Ee&&typeof Ee.onCommitFiberUnmount=="function")try{Ee.onCommitFiberUnmount(me,o)}catch{}switch(o.tag){case 26:xt||ir(o,i),jr(r,i,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:xt||ir(o,i);var u=lt,m=tn;_s(o.type)&&(lt=o.stateNode,tn=!1),jr(r,i,o),Ho(o.stateNode),lt=u,tn=m;break;case 5:xt||ir(o,i);case 6:if(u=lt,m=tn,lt=null,jr(r,i,o),lt=u,tn=m,lt!==null)if(tn)try{(lt.nodeType===9?lt.body:lt.nodeName==="HTML"?lt.ownerDocument.body:lt).removeChild(o.stateNode)}catch(y){Ze(o,i,y)}else try{lt.removeChild(o.stateNode)}catch(y){Ze(o,i,y)}break;case 18:lt!==null&&(tn?(r=lt,Nb(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,o.stateNode),ga(r)):Nb(lt,o.stateNode));break;case 4:u=lt,m=tn,lt=o.stateNode.containerInfo,tn=!0,jr(r,i,o),lt=u,tn=m;break;case 0:case 11:case 14:case 15:hs(2,o,i),xt||hs(4,o,i),jr(r,i,o);break;case 1:xt||(ir(o,i),u=o.stateNode,typeof u.componentWillUnmount=="function"&&Ov(o,i,u)),jr(r,i,o);break;case 21:jr(r,i,o);break;case 22:xt=(u=xt)||o.memoizedState!==null,jr(r,i,o),xt=u;break;default:jr(r,i,o)}}function Iv(r,i){if(i.memoizedState===null&&(r=i.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{ga(r)}catch(o){Ze(i,i.return,o)}}}function Lv(r,i){if(i.memoizedState===null&&(r=i.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{ga(r)}catch(o){Ze(i,i.return,o)}}function FT(r){switch(r.tag){case 31:case 13:case 19:var i=r.stateNode;return i===null&&(i=r.stateNode=new Mv),i;case 22:return r=r.stateNode,i=r._retryCache,i===null&&(i=r._retryCache=new Mv),i;default:throw Error(s(435,r.tag))}}function su(r,i){var o=FT(r);i.forEach(function(u){if(!o.has(u)){o.add(u);var m=eN.bind(null,r,u);u.then(m,m)}})}function nn(r,i){var o=i.deletions;if(o!==null)for(var u=0;u<o.length;u++){var m=o[u],y=r,T=i,U=T;e:for(;U!==null;){switch(U.tag){case 27:if(_s(U.type)){lt=U.stateNode,tn=!1;break e}break;case 5:lt=U.stateNode,tn=!1;break e;case 3:case 4:lt=U.stateNode.containerInfo,tn=!0;break e}U=U.return}if(lt===null)throw Error(s(160));$v(y,T,m),lt=null,tn=!1,y=m.alternate,y!==null&&(y.return=null),m.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)zv(i,r),i=i.sibling}var Pn=null;function zv(r,i){var o=r.alternate,u=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:nn(i,r),rn(r),u&4&&(hs(3,r,r.return),Mo(3,r),hs(5,r,r.return));break;case 1:nn(i,r),rn(r),u&512&&(xt||o===null||ir(o,o.return)),u&64&&Rr&&(r=r.updateQueue,r!==null&&(u=r.callbacks,u!==null&&(o=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var m=Pn;if(nn(i,r),rn(r),u&512&&(xt||o===null||ir(o,o.return)),u&4){var y=o!==null?o.memoizedState:null;if(u=r.memoizedState,o===null)if(u===null)if(r.stateNode===null){e:{u=r.type,o=r.memoizedProps,m=m.ownerDocument||m;t:switch(u){case"title":y=m.getElementsByTagName("title")[0],(!y||y[qs]||y[Tt]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=m.createElement(u),m.head.insertBefore(y,m.querySelector("head > title"))),zt(y,u,o),y[Tt]=r,vt(y),u=y;break e;case"link":var T=zb("link","href",m).get(u+(o.href||""));if(T){for(var U=0;U<T.length;U++)if(y=T[U],y.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&y.getAttribute("rel")===(o.rel==null?null:o.rel)&&y.getAttribute("title")===(o.title==null?null:o.title)&&y.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){T.splice(U,1);break t}}y=m.createElement(u),zt(y,u,o),m.head.appendChild(y);break;case"meta":if(T=zb("meta","content",m).get(u+(o.content||""))){for(U=0;U<T.length;U++)if(y=T[U],y.getAttribute("content")===(o.content==null?null:""+o.content)&&y.getAttribute("name")===(o.name==null?null:o.name)&&y.getAttribute("property")===(o.property==null?null:o.property)&&y.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&y.getAttribute("charset")===(o.charSet==null?null:o.charSet)){T.splice(U,1);break t}}y=m.createElement(u),zt(y,u,o),m.head.appendChild(y);break;default:throw Error(s(468,u))}y[Tt]=r,vt(y),u=y}r.stateNode=u}else Bb(m,r.type,r.stateNode);else r.stateNode=Lb(m,u,r.memoizedProps);else y!==u?(y===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):y.count--,u===null?Bb(m,r.type,r.stateNode):Lb(m,u,r.memoizedProps)):u===null&&r.stateNode!==null&&Qh(r,r.memoizedProps,o.memoizedProps)}break;case 27:nn(i,r),rn(r),u&512&&(xt||o===null||ir(o,o.return)),o!==null&&u&4&&Qh(r,r.memoizedProps,o.memoizedProps);break;case 5:if(nn(i,r),rn(r),u&512&&(xt||o===null||ir(o,o.return)),r.flags&32){m=r.stateNode;try{zi(m,"")}catch(xe){Ze(r,r.return,xe)}}u&4&&r.stateNode!=null&&(m=r.memoizedProps,Qh(r,m,o!==null?o.memoizedProps:m)),u&1024&&(Zh=!0);break;case 6:if(nn(i,r),rn(r),u&4){if(r.stateNode===null)throw Error(s(162));u=r.memoizedProps,o=r.stateNode;try{o.nodeValue=u}catch(xe){Ze(r,r.return,xe)}}break;case 3:if(_u=null,m=Pn,Pn=vu(i.containerInfo),nn(i,r),Pn=m,rn(r),u&4&&o!==null&&o.memoizedState.isDehydrated)try{ga(i.containerInfo)}catch(xe){Ze(r,r.return,xe)}Zh&&(Zh=!1,Bv(r));break;case 4:u=Pn,Pn=vu(r.stateNode.containerInfo),nn(i,r),rn(r),Pn=u;break;case 12:nn(i,r),rn(r);break;case 31:nn(i,r),rn(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,su(r,u)));break;case 13:nn(i,r),rn(r),r.child.flags&8192&&r.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(au=At()),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,su(r,u)));break;case 22:m=r.memoizedState!==null;var F=o!==null&&o.memoizedState!==null,re=Rr,ce=xt;if(Rr=re||m,xt=ce||F,nn(i,r),xt=ce,Rr=re,rn(r),u&8192)e:for(i=r.stateNode,i._visibility=m?i._visibility&-2:i._visibility|1,m&&(o===null||F||Rr||xt||ri(r)),o=null,i=r;;){if(i.tag===5||i.tag===26){if(o===null){F=o=i;try{if(y=F.stateNode,m)T=y.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{U=F.stateNode;var fe=F.memoizedProps.style,ie=fe!=null&&fe.hasOwnProperty("display")?fe.display:null;U.style.display=ie==null||typeof ie=="boolean"?"":(""+ie).trim()}}catch(xe){Ze(F,F.return,xe)}}}else if(i.tag===6){if(o===null){F=i;try{F.stateNode.nodeValue=m?"":F.memoizedProps}catch(xe){Ze(F,F.return,xe)}}}else if(i.tag===18){if(o===null){F=i;try{var oe=F.stateNode;m?Ob(oe,!0):Ob(F.stateNode,!1)}catch(xe){Ze(F,F.return,xe)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===r)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break e;for(;i.sibling===null;){if(i.return===null||i.return===r)break e;o===i&&(o=null),i=i.return}o===i&&(o=null),i.sibling.return=i.return,i=i.sibling}u&4&&(u=r.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,su(r,o))));break;case 19:nn(i,r),rn(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,su(r,u)));break;case 30:break;case 21:break;default:nn(i,r),rn(r)}}function rn(r){var i=r.flags;if(i&2){try{for(var o,u=r.return;u!==null;){if(jv(u)){o=u;break}u=u.return}if(o==null)throw Error(s(160));switch(o.tag){case 27:var m=o.stateNode,y=Wh(r);ru(r,y,m);break;case 5:var T=o.stateNode;o.flags&32&&(zi(T,""),o.flags&=-33);var U=Wh(r);ru(r,U,T);break;case 3:case 4:var F=o.stateNode.containerInfo,re=Wh(r);Jh(r,re,F);break;default:throw Error(s(161))}}catch(ce){Ze(r,r.return,ce)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function Bv(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var i=r;Bv(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),r=r.sibling}}function kr(r,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)Dv(r,i.alternate,i),i=i.sibling}function ri(r){for(r=r.child;r!==null;){var i=r;switch(i.tag){case 0:case 11:case 14:case 15:hs(4,i,i.return),ri(i);break;case 1:ir(i,i.return);var o=i.stateNode;typeof o.componentWillUnmount=="function"&&Ov(i,i.return,o),ri(i);break;case 27:Ho(i.stateNode);case 26:case 5:ir(i,i.return),ri(i);break;case 22:i.memoizedState===null&&ri(i);break;case 30:ri(i);break;default:ri(i)}r=r.sibling}}function Mr(r,i,o){for(o=o&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var u=i.alternate,m=r,y=i,T=y.flags;switch(y.tag){case 0:case 11:case 15:Mr(m,y,o),Mo(4,y);break;case 1:if(Mr(m,y,o),u=y,m=u.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(re){Ze(u,u.return,re)}if(u=y,m=u.updateQueue,m!==null){var U=u.stateNode;try{var F=m.shared.hiddenCallbacks;if(F!==null)for(m.shared.hiddenCallbacks=null,m=0;m<F.length;m++)y0(F[m],U)}catch(re){Ze(u,u.return,re)}}o&&T&64&&Nv(y),Do(y,y.return);break;case 27:kv(y);case 26:case 5:Mr(m,y,o),o&&u===null&&T&4&&Rv(y),Do(y,y.return);break;case 12:Mr(m,y,o);break;case 31:Mr(m,y,o),o&&T&4&&Iv(m,y);break;case 13:Mr(m,y,o),o&&T&4&&Lv(m,y);break;case 22:y.memoizedState===null&&Mr(m,y,o),Do(y,y.return);break;case 30:break;default:Mr(m,y,o)}i=i.sibling}}function em(r,i){var o=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),r=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(r=i.memoizedState.cachePool.pool),r!==o&&(r!=null&&r.refCount++,o!=null&&_o(o))}function tm(r,i){r=null,i.alternate!==null&&(r=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==r&&(i.refCount++,r!=null&&_o(r))}function qn(r,i,o,u){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Pv(r,i,o,u),i=i.sibling}function Pv(r,i,o,u){var m=i.flags;switch(i.tag){case 0:case 11:case 15:qn(r,i,o,u),m&2048&&Mo(9,i);break;case 1:qn(r,i,o,u);break;case 3:qn(r,i,o,u),m&2048&&(r=null,i.alternate!==null&&(r=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==r&&(i.refCount++,r!=null&&_o(r)));break;case 12:if(m&2048){qn(r,i,o,u),r=i.stateNode;try{var y=i.memoizedProps,T=y.id,U=y.onPostCommit;typeof U=="function"&&U(T,i.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(F){Ze(i,i.return,F)}}else qn(r,i,o,u);break;case 31:qn(r,i,o,u);break;case 13:qn(r,i,o,u);break;case 23:break;case 22:y=i.stateNode,T=i.alternate,i.memoizedState!==null?y._visibility&2?qn(r,i,o,u):Uo(r,i):y._visibility&2?qn(r,i,o,u):(y._visibility|=2,ia(r,i,o,u,(i.subtreeFlags&10256)!==0||!1)),m&2048&&em(T,i);break;case 24:qn(r,i,o,u),m&2048&&tm(i.alternate,i);break;default:qn(r,i,o,u)}}function ia(r,i,o,u,m){for(m=m&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var y=r,T=i,U=o,F=u,re=T.flags;switch(T.tag){case 0:case 11:case 15:ia(y,T,U,F,m),Mo(8,T);break;case 23:break;case 22:var ce=T.stateNode;T.memoizedState!==null?ce._visibility&2?ia(y,T,U,F,m):Uo(y,T):(ce._visibility|=2,ia(y,T,U,F,m)),m&&re&2048&&em(T.alternate,T);break;case 24:ia(y,T,U,F,m),m&&re&2048&&tm(T.alternate,T);break;default:ia(y,T,U,F,m)}i=i.sibling}}function Uo(r,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var o=r,u=i,m=u.flags;switch(u.tag){case 22:Uo(o,u),m&2048&&em(u.alternate,u);break;case 24:Uo(o,u),m&2048&&tm(u.alternate,u);break;default:Uo(o,u)}i=i.sibling}}var $o=8192;function aa(r,i,o){if(r.subtreeFlags&$o)for(r=r.child;r!==null;)qv(r,i,o),r=r.sibling}function qv(r,i,o){switch(r.tag){case 26:aa(r,i,o),r.flags&$o&&r.memoizedState!==null&&jN(o,Pn,r.memoizedState,r.memoizedProps);break;case 5:aa(r,i,o);break;case 3:case 4:var u=Pn;Pn=vu(r.stateNode.containerInfo),aa(r,i,o),Pn=u;break;case 22:r.memoizedState===null&&(u=r.alternate,u!==null&&u.memoizedState!==null?(u=$o,$o=16777216,aa(r,i,o),$o=u):aa(r,i,o));break;default:aa(r,i,o)}}function Hv(r){var i=r.alternate;if(i!==null&&(r=i.child,r!==null)){i.child=null;do i=r.sibling,r.sibling=null,r=i;while(r!==null)}}function Io(r){var i=r.deletions;if((r.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var u=i[o];Dt=u,Fv(u,r)}Hv(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Vv(r),r=r.sibling}function Vv(r){switch(r.tag){case 0:case 11:case 15:Io(r),r.flags&2048&&hs(9,r,r.return);break;case 3:Io(r);break;case 12:Io(r);break;case 22:var i=r.stateNode;r.memoizedState!==null&&i._visibility&2&&(r.return===null||r.return.tag!==13)?(i._visibility&=-3,iu(r)):Io(r);break;default:Io(r)}}function iu(r){var i=r.deletions;if((r.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var u=i[o];Dt=u,Fv(u,r)}Hv(r)}for(r=r.child;r!==null;){switch(i=r,i.tag){case 0:case 11:case 15:hs(8,i,i.return),iu(i);break;case 22:o=i.stateNode,o._visibility&2&&(o._visibility&=-3,iu(i));break;default:iu(i)}r=r.sibling}}function Fv(r,i){for(;Dt!==null;){var o=Dt;switch(o.tag){case 0:case 11:case 15:hs(8,o,i);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:_o(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,Dt=u;else e:for(o=r;Dt!==null;){u=Dt;var m=u.sibling,y=u.return;if(Uv(u),u===o){Dt=null;break e}if(m!==null){m.return=y,Dt=m;break e}Dt=y}}}var YT={getCacheForType:function(r){var i=It(bt),o=i.data.get(r);return o===void 0&&(o=r(),i.data.set(r,o)),o},cacheSignal:function(){return It(bt).controller.signal}},GT=typeof WeakMap=="function"?WeakMap:Map,We=0,rt=null,He=null,Fe=0,Je=0,mn=null,ms=!1,oa=!1,nm=!1,Dr=0,pt=0,ps=0,si=0,rm=0,pn=0,la=0,Lo=null,sn=null,sm=!1,au=0,Yv=0,ou=1/0,lu=null,gs=null,Nt=0,ys=null,ca=null,Ur=0,im=0,am=null,Gv=null,zo=0,om=null;function gn(){return(We&2)!==0&&Fe!==0?Fe&-Fe:k.T!==null?hm():fc()}function Xv(){if(pn===0)if((Fe&536870912)===0||Xe){var r=Oi;Oi<<=1,(Oi&3932160)===0&&(Oi=262144),pn=r}else pn=536870912;return r=fn.current,r!==null&&(r.flags|=32),pn}function an(r,i,o){(r===rt&&(Je===2||Je===9)||r.cancelPendingCommit!==null)&&(ua(r,0),vs(r,Fe,pn,!1)),Ps(r,o),((We&2)===0||r!==rt)&&(r===rt&&((We&2)===0&&(si|=o),pt===4&&vs(r,Fe,pn,!1)),ar(r))}function Kv(r,i,o){if((We&6)!==0)throw Error(s(327));var u=!o&&(i&127)===0&&(i&r.expiredLanes)===0||Bs(r,i),m=u?QT(r,i):cm(r,i,!0),y=u;do{if(m===0){oa&&!u&&vs(r,i,0,!1);break}else{if(o=r.current.alternate,y&&!XT(o)){m=cm(r,i,!1),y=!1;continue}if(m===2){if(y=i,r.errorRecoveryDisabledLanes&y)var T=0;else T=r.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){i=T;e:{var U=r;m=Lo;var F=U.current.memoizedState.isDehydrated;if(F&&(ua(U,T).flags|=256),T=cm(U,T,!1),T!==2){if(nm&&!F){U.errorRecoveryDisabledLanes|=y,si|=y,m=4;break e}y=sn,sn=m,y!==null&&(sn===null?sn=y:sn.push.apply(sn,y))}m=T}if(y=!1,m!==2)continue}}if(m===1){ua(r,0),vs(r,i,0,!0);break}e:{switch(u=r,y=m,y){case 0:case 1:throw Error(s(345));case 4:if((i&4194048)!==i)break;case 6:vs(u,i,pn,!ms);break e;case 2:sn=null;break;case 3:case 5:break;default:throw Error(s(329))}if((i&62914560)===i&&(m=au+300-At(),10<m)){if(vs(u,i,pn,!ms),ji(u,0,!0)!==0)break e;Ur=i,u.timeoutHandle=Ab(Qv.bind(null,u,o,sn,lu,sm,i,pn,si,la,ms,y,"Throttled",-0,0),m);break e}Qv(u,o,sn,lu,sm,i,pn,si,la,ms,y,null,-0,0)}}break}while(!0);ar(r)}function Qv(r,i,o,u,m,y,T,U,F,re,ce,fe,ie,oe){if(r.timeoutHandle=-1,fe=i.subtreeFlags,fe&8192||(fe&16785408)===16785408){fe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:_r},qv(i,y,fe);var xe=(y&62914560)===y?au-At():(y&4194048)===y?Yv-At():0;if(xe=kN(fe,xe),xe!==null){Ur=y,r.cancelPendingCommit=xe(sb.bind(null,r,i,y,o,u,m,T,U,F,ce,fe,null,ie,oe)),vs(r,y,T,!re);return}}sb(r,i,y,o,u,m,T,U,F)}function XT(r){for(var i=r;;){var o=i.tag;if((o===0||o===11||o===15)&&i.flags&16384&&(o=i.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var m=o[u],y=m.getSnapshot;m=m.value;try{if(!un(y(),m))return!1}catch{return!1}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function vs(r,i,o,u){i&=~rm,i&=~si,r.suspendedLanes|=i,r.pingedLanes&=~i,u&&(r.warmLanes|=i),u=r.expirationTimes;for(var m=i;0<m;){var y=31-De(m),T=1<<y;u[y]=-1,m&=~T}o!==0&&cc(r,o,i)}function cu(){return(We&6)===0?(Bo(0),!1):!0}function lm(){if(He!==null){if(Je===0)var r=He.return;else r=He,Er=Ks=null,Eh(r),ea=null,xo=0,r=He;for(;r!==null;)Tv(r.alternate,r),r=r.return;He=null}}function ua(r,i){var o=r.timeoutHandle;o!==-1&&(r.timeoutHandle=-1,mN(o)),o=r.cancelPendingCommit,o!==null&&(r.cancelPendingCommit=null,o()),Ur=0,lm(),rt=r,He=o=xr(r.current,null),Fe=i,Je=0,mn=null,ms=!1,oa=Bs(r,i),nm=!1,la=pn=rm=si=ps=pt=0,sn=Lo=null,sm=!1,(i&8)!==0&&(i|=i&32);var u=r.entangledLanes;if(u!==0)for(r=r.entanglements,u&=i;0<u;){var m=31-De(u),y=1<<m;i|=r[m],u&=~y}return Dr=i,Rc(),o}function Wv(r,i){ze=null,k.H=Ro,i===Zi||i===Lc?(i=h0(),Je=3):i===fh?(i=h0(),Je=4):Je=i===Bh?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,mn=i,He===null&&(pt=1,Jc(r,Tn(i,r.current)))}function Jv(){var r=fn.current;return r===null?!0:(Fe&4194048)===Fe?jn===null:(Fe&62914560)===Fe||(Fe&536870912)!==0?r===jn:!1}function Zv(){var r=k.H;return k.H=Ro,r===null?Ro:r}function eb(){var r=k.A;return k.A=YT,r}function uu(){pt=4,ms||(Fe&4194048)!==Fe&&fn.current!==null||(oa=!0),(ps&134217727)===0&&(si&134217727)===0||rt===null||vs(rt,Fe,pn,!1)}function cm(r,i,o){var u=We;We|=2;var m=Zv(),y=eb();(rt!==r||Fe!==i)&&(lu=null,ua(r,i)),i=!1;var T=pt;e:do try{if(Je!==0&&He!==null){var U=He,F=mn;switch(Je){case 8:lm(),T=6;break e;case 3:case 2:case 9:case 6:fn.current===null&&(i=!0);var re=Je;if(Je=0,mn=null,da(r,U,F,re),o&&oa){T=0;break e}break;default:re=Je,Je=0,mn=null,da(r,U,F,re)}}KT(),T=pt;break}catch(ce){Wv(r,ce)}while(!0);return i&&r.shellSuspendCounter++,Er=Ks=null,We=u,k.H=m,k.A=y,He===null&&(rt=null,Fe=0,Rc()),T}function KT(){for(;He!==null;)tb(He)}function QT(r,i){var o=We;We|=2;var u=Zv(),m=eb();rt!==r||Fe!==i?(lu=null,ou=At()+500,ua(r,i)):oa=Bs(r,i);e:do try{if(Je!==0&&He!==null){i=He;var y=mn;t:switch(Je){case 1:Je=0,mn=null,da(r,i,y,1);break;case 2:case 9:if(d0(y)){Je=0,mn=null,nb(i);break}i=function(){Je!==2&&Je!==9||rt!==r||(Je=7),ar(r)},y.then(i,i);break e;case 3:Je=7;break e;case 4:Je=5;break e;case 7:d0(y)?(Je=0,mn=null,nb(i)):(Je=0,mn=null,da(r,i,y,7));break;case 5:var T=null;switch(He.tag){case 26:T=He.memoizedState;case 5:case 27:var U=He;if(T?Pb(T):U.stateNode.complete){Je=0,mn=null;var F=U.sibling;if(F!==null)He=F;else{var re=U.return;re!==null?(He=re,du(re)):He=null}break t}}Je=0,mn=null,da(r,i,y,5);break;case 6:Je=0,mn=null,da(r,i,y,6);break;case 8:lm(),pt=6;break e;default:throw Error(s(462))}}WT();break}catch(ce){Wv(r,ce)}while(!0);return Er=Ks=null,k.H=u,k.A=m,We=o,He!==null?0:(rt=null,Fe=0,Rc(),pt)}function WT(){for(;He!==null&&!Ln();)tb(He)}function tb(r){var i=Cv(r.alternate,r,Dr);r.memoizedProps=r.pendingProps,i===null?du(r):He=i}function nb(r){var i=r,o=i.alternate;switch(i.tag){case 15:case 0:i=bv(o,i,i.pendingProps,i.type,void 0,Fe);break;case 11:i=bv(o,i,i.pendingProps,i.type.render,i.ref,Fe);break;case 5:Eh(i);default:Tv(o,i),i=He=e0(i,Dr),i=Cv(o,i,Dr)}r.memoizedProps=r.pendingProps,i===null?du(r):He=i}function da(r,i,o,u){Er=Ks=null,Eh(i),ea=null,xo=0;var m=i.return;try{if(zT(r,m,i,o,Fe)){pt=1,Jc(r,Tn(o,r.current)),He=null;return}}catch(y){if(m!==null)throw He=m,y;pt=1,Jc(r,Tn(o,r.current)),He=null;return}i.flags&32768?(Xe||u===1?r=!0:oa||(Fe&536870912)!==0?r=!1:(ms=r=!0,(u===2||u===9||u===3||u===6)&&(u=fn.current,u!==null&&u.tag===13&&(u.flags|=16384))),rb(i,r)):du(i)}function du(r){var i=r;do{if((i.flags&32768)!==0){rb(i,ms);return}r=i.return;var o=qT(i.alternate,i,Dr);if(o!==null){He=o;return}if(i=i.sibling,i!==null){He=i;return}He=i=r}while(i!==null);pt===0&&(pt=5)}function rb(r,i){do{var o=HT(r.alternate,r);if(o!==null){o.flags&=32767,He=o;return}if(o=r.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!i&&(r=r.sibling,r!==null)){He=r;return}He=r=o}while(r!==null);pt=6,He=null}function sb(r,i,o,u,m,y,T,U,F){r.cancelPendingCommit=null;do fu();while(Nt!==0);if((We&6)!==0)throw Error(s(327));if(i!==null){if(i===r.current)throw Error(s(177));if(y=i.lanes|i.childLanes,y|=Wf,Tf(r,o,y,T,U,F),r===rt&&(He=rt=null,Fe=0),ca=i,ys=r,Ur=o,im=y,am=m,Gv=u,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,tN(gr,function(){return cb(),null})):(r.callbackNode=null,r.callbackPriority=0),u=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||u){u=k.T,k.T=null,m=L.p,L.p=2,T=We,We|=4;try{VT(r,i,o)}finally{We=T,L.p=m,k.T=u}}Nt=1,ib(),ab(),ob()}}function ib(){if(Nt===1){Nt=0;var r=ys,i=ca,o=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||o){o=k.T,k.T=null;var u=L.p;L.p=2;var m=We;We|=4;try{zv(i,r);var y=wm,T=Fy(r.containerInfo),U=y.focusedElem,F=y.selectionRange;if(T!==U&&U&&U.ownerDocument&&Vy(U.ownerDocument.documentElement,U)){if(F!==null&&Yf(U)){var re=F.start,ce=F.end;if(ce===void 0&&(ce=re),"selectionStart"in U)U.selectionStart=re,U.selectionEnd=Math.min(ce,U.value.length);else{var fe=U.ownerDocument||document,ie=fe&&fe.defaultView||window;if(ie.getSelection){var oe=ie.getSelection(),xe=U.textContent.length,ke=Math.min(F.start,xe),nt=F.end===void 0?ke:Math.min(F.end,xe);!oe.extend&&ke>nt&&(T=nt,nt=ke,ke=T);var W=Hy(U,ke),X=Hy(U,nt);if(W&&X&&(oe.rangeCount!==1||oe.anchorNode!==W.node||oe.anchorOffset!==W.offset||oe.focusNode!==X.node||oe.focusOffset!==X.offset)){var ne=fe.createRange();ne.setStart(W.node,W.offset),oe.removeAllRanges(),ke>nt?(oe.addRange(ne),oe.extend(X.node,X.offset)):(ne.setEnd(X.node,X.offset),oe.addRange(ne))}}}}for(fe=[],oe=U;oe=oe.parentNode;)oe.nodeType===1&&fe.push({element:oe,left:oe.scrollLeft,top:oe.scrollTop});for(typeof U.focus=="function"&&U.focus(),U=0;U<fe.length;U++){var ue=fe[U];ue.element.scrollLeft=ue.left,ue.element.scrollTop=ue.top}}Eu=!!_m,wm=_m=null}finally{We=m,L.p=u,k.T=o}}r.current=i,Nt=2}}function ab(){if(Nt===2){Nt=0;var r=ys,i=ca,o=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||o){o=k.T,k.T=null;var u=L.p;L.p=2;var m=We;We|=4;try{Dv(r,i.alternate,i)}finally{We=m,L.p=u,k.T=o}}Nt=3}}function ob(){if(Nt===4||Nt===3){Nt=0,pr();var r=ys,i=ca,o=Ur,u=Gv;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Nt=5:(Nt=0,ca=ys=null,lb(r,r.pendingLanes));var m=r.pendingLanes;if(m===0&&(gs=null),so(o),i=i.stateNode,Ee&&typeof Ee.onCommitFiberRoot=="function")try{Ee.onCommitFiberRoot(me,i,void 0,(i.current.flags&128)===128)}catch{}if(u!==null){i=k.T,m=L.p,L.p=2,k.T=null;try{for(var y=r.onRecoverableError,T=0;T<u.length;T++){var U=u[T];y(U.value,{componentStack:U.stack})}}finally{k.T=i,L.p=m}}(Ur&3)!==0&&fu(),ar(r),m=r.pendingLanes,(o&261930)!==0&&(m&42)!==0?r===om?zo++:(zo=0,om=r):zo=0,Bo(0)}}function lb(r,i){(r.pooledCacheLanes&=i)===0&&(i=r.pooledCache,i!=null&&(r.pooledCache=null,_o(i)))}function fu(){return ib(),ab(),ob(),cb()}function cb(){if(Nt!==5)return!1;var r=ys,i=im;im=0;var o=so(Ur),u=k.T,m=L.p;try{L.p=32>o?32:o,k.T=null,o=am,am=null;var y=ys,T=Ur;if(Nt=0,ca=ys=null,Ur=0,(We&6)!==0)throw Error(s(331));var U=We;if(We|=4,Vv(y.current),Pv(y,y.current,T,o),We=U,Bo(0,!1),Ee&&typeof Ee.onPostCommitFiberRoot=="function")try{Ee.onPostCommitFiberRoot(me,y)}catch{}return!0}finally{L.p=m,k.T=u,lb(r,i)}}function ub(r,i,o){i=Tn(o,i),i=zh(r.stateNode,i,2),r=us(r,i,2),r!==null&&(Ps(r,2),ar(r))}function Ze(r,i,o){if(r.tag===3)ub(r,r,o);else for(;i!==null;){if(i.tag===3){ub(i,r,o);break}else if(i.tag===1){var u=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(gs===null||!gs.has(u))){r=Tn(o,r),o=dv(2),u=us(i,o,2),u!==null&&(fv(o,u,i,r),Ps(u,2),ar(u));break}}i=i.return}}function um(r,i,o){var u=r.pingCache;if(u===null){u=r.pingCache=new GT;var m=new Set;u.set(i,m)}else m=u.get(i),m===void 0&&(m=new Set,u.set(i,m));m.has(o)||(nm=!0,m.add(o),r=JT.bind(null,r,i,o),i.then(r,r))}function JT(r,i,o){var u=r.pingCache;u!==null&&u.delete(i),r.pingedLanes|=r.suspendedLanes&o,r.warmLanes&=~o,rt===r&&(Fe&o)===o&&(pt===4||pt===3&&(Fe&62914560)===Fe&&300>At()-au?(We&2)===0&&ua(r,0):rm|=o,la===Fe&&(la=0)),ar(r)}function db(r,i){i===0&&(i=lc()),r=Ys(r,i),r!==null&&(Ps(r,i),ar(r))}function ZT(r){var i=r.memoizedState,o=0;i!==null&&(o=i.retryLane),db(r,o)}function eN(r,i){var o=0;switch(r.tag){case 31:case 13:var u=r.stateNode,m=r.memoizedState;m!==null&&(o=m.retryLane);break;case 19:u=r.stateNode;break;case 22:u=r.stateNode._retryCache;break;default:throw Error(s(314))}u!==null&&u.delete(i),db(r,o)}function tN(r,i){return In(r,i)}var hu=null,fa=null,dm=!1,mu=!1,fm=!1,bs=0;function ar(r){r!==fa&&r.next===null&&(fa===null?hu=fa=r:fa=fa.next=r),mu=!0,dm||(dm=!0,rN())}function Bo(r,i){if(!fm&&mu){fm=!0;do for(var o=!1,u=hu;u!==null;){if(r!==0){var m=u.pendingLanes;if(m===0)var y=0;else{var T=u.suspendedLanes,U=u.pingedLanes;y=(1<<31-De(42|r)+1)-1,y&=m&~(T&~U),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(o=!0,pb(u,y))}else y=Fe,y=ji(u,u===rt?y:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(y&3)===0||Bs(u,y)||(o=!0,pb(u,y));u=u.next}while(o);fm=!1}}function nN(){fb()}function fb(){mu=dm=!1;var r=0;bs!==0&&hN()&&(r=bs);for(var i=At(),o=null,u=hu;u!==null;){var m=u.next,y=hb(u,i);y===0?(u.next=null,o===null?hu=m:o.next=m,m===null&&(fa=o)):(o=u,(r!==0||(y&3)!==0)&&(mu=!0)),u=m}Nt!==0&&Nt!==5||Bo(r),bs!==0&&(bs=0)}function hb(r,i){for(var o=r.suspendedLanes,u=r.pingedLanes,m=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var T=31-De(y),U=1<<T,F=m[T];F===-1?((U&o)===0||(U&u)!==0)&&(m[T]=Af(U,i)):F<=i&&(r.expiredLanes|=U),y&=~U}if(i=rt,o=Fe,o=ji(r,r===i?o:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u=r.callbackNode,o===0||r===i&&(Je===2||Je===9)||r.cancelPendingCommit!==null)return u!==null&&u!==null&&Jt(u),r.callbackNode=null,r.callbackPriority=0;if((o&3)===0||Bs(r,o)){if(i=o&-o,i===r.callbackPriority)return i;switch(u!==null&&Jt(u),so(o)){case 2:case 8:o=tr;break;case 32:o=gr;break;case 268435456:o=Wr;break;default:o=gr}return u=mb.bind(null,r),o=In(o,u),r.callbackPriority=i,r.callbackNode=o,i}return u!==null&&u!==null&&Jt(u),r.callbackPriority=2,r.callbackNode=null,2}function mb(r,i){if(Nt!==0&&Nt!==5)return r.callbackNode=null,r.callbackPriority=0,null;var o=r.callbackNode;if(fu()&&r.callbackNode!==o)return null;var u=Fe;return u=ji(r,r===rt?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u===0?null:(Kv(r,u,i),hb(r,At()),r.callbackNode!=null&&r.callbackNode===o?mb.bind(null,r):null)}function pb(r,i){if(fu())return null;Kv(r,i,!0)}function rN(){pN(function(){(We&6)!==0?In(Cn,nN):fb()})}function hm(){if(bs===0){var r=Wi;r===0&&(r=Ni,Ni<<=1,(Ni&261888)===0&&(Ni=256)),bs=r}return bs}function gb(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:xc(""+r)}function yb(r,i){var o=i.ownerDocument.createElement("input");return o.name=i.name,o.value=i.value,r.id&&o.setAttribute("form",r.id),i.parentNode.insertBefore(o,i),r=new FormData(r),o.parentNode.removeChild(o),r}function sN(r,i,o,u,m){if(i==="submit"&&o&&o.stateNode===m){var y=gb((m[Ht]||null).action),T=u.submitter;T&&(i=(i=T[Ht]||null)?gb(i.formAction):T.getAttribute("formAction"),i!==null&&(y=i,T=null));var U=new Ac("action","action",null,u,m);r.push({event:U,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(bs!==0){var F=T?yb(m,T):new FormData(m);Mh(o,{pending:!0,data:F,method:m.method,action:y},null,F)}}else typeof y=="function"&&(U.preventDefault(),F=T?yb(m,T):new FormData(m),Mh(o,{pending:!0,data:F,method:m.method,action:y},y,F))},currentTarget:m}]})}}for(var mm=0;mm<Qf.length;mm++){var pm=Qf[mm],iN=pm.toLowerCase(),aN=pm[0].toUpperCase()+pm.slice(1);Bn(iN,"on"+aN)}Bn(Xy,"onAnimationEnd"),Bn(Ky,"onAnimationIteration"),Bn(Qy,"onAnimationStart"),Bn("dblclick","onDoubleClick"),Bn("focusin","onFocus"),Bn("focusout","onBlur"),Bn(xT,"onTransitionRun"),Bn(ST,"onTransitionStart"),Bn(ET,"onTransitionCancel"),Bn(Wy,"onTransitionEnd"),ns("onMouseEnter",["mouseout","mouseover"]),ns("onMouseLeave",["mouseout","mouseover"]),ns("onPointerEnter",["pointerout","pointerover"]),ns("onPointerLeave",["pointerout","pointerover"]),br("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),br("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),br("onBeforeInput",["compositionend","keypress","textInput","paste"]),br("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),br("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),br("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Po="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),oN=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Po));function vb(r,i){i=(i&4)!==0;for(var o=0;o<r.length;o++){var u=r[o],m=u.event;u=u.listeners;e:{var y=void 0;if(i)for(var T=u.length-1;0<=T;T--){var U=u[T],F=U.instance,re=U.currentTarget;if(U=U.listener,F!==y&&m.isPropagationStopped())break e;y=U,m.currentTarget=re;try{y(m)}catch(ce){Oc(ce)}m.currentTarget=null,y=F}else for(T=0;T<u.length;T++){if(U=u[T],F=U.instance,re=U.currentTarget,U=U.listener,F!==y&&m.isPropagationStopped())break e;y=U,m.currentTarget=re;try{y(m)}catch(ce){Oc(ce)}m.currentTarget=null,y=F}}}}function Ve(r,i){var o=i[ki];o===void 0&&(o=i[ki]=new Set);var u=r+"__bubble";o.has(u)||(bb(i,r,2,!1),o.add(u))}function gm(r,i,o){var u=0;i&&(u|=4),bb(o,r,u,i)}var pu="_reactListening"+Math.random().toString(36).slice(2);function ym(r){if(!r[pu]){r[pu]=!0,gc.forEach(function(o){o!=="selectionchange"&&(oN.has(o)||gm(o,!1,r),gm(o,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[pu]||(i[pu]=!0,gm("selectionchange",!1,i))}}function bb(r,i,o,u){switch(Xb(i)){case 2:var m=UN;break;case 8:m=$N;break;default:m=km}o=m.bind(null,i,o,r),m=void 0,!If||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(m=!0),u?m!==void 0?r.addEventListener(i,o,{capture:!0,passive:m}):r.addEventListener(i,o,!0):m!==void 0?r.addEventListener(i,o,{passive:m}):r.addEventListener(i,o,!1)}function vm(r,i,o,u,m){var y=u;if((i&1)===0&&(i&2)===0&&u!==null)e:for(;;){if(u===null)return;var T=u.tag;if(T===3||T===4){var U=u.stateNode.containerInfo;if(U===m)break;if(T===4)for(T=u.return;T!==null;){var F=T.tag;if((F===3||F===4)&&T.stateNode.containerInfo===m)return;T=T.return}for(;U!==null;){if(T=Jr(U),T===null)return;if(F=T.tag,F===5||F===6||F===26||F===27){u=y=T;continue e}U=U.parentNode}}u=u.return}Ey(function(){var re=y,ce=Uf(o),fe=[];e:{var ie=Jy.get(r);if(ie!==void 0){var oe=Ac,xe=r;switch(r){case"keypress":if(Ec(o)===0)break e;case"keydown":case"keyup":oe=eT;break;case"focusin":xe="focus",oe=Pf;break;case"focusout":xe="blur",oe=Pf;break;case"beforeblur":case"afterblur":oe=Pf;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":oe=Ty;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":oe=qA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":oe=rT;break;case Xy:case Ky:case Qy:oe=FA;break;case Wy:oe=iT;break;case"scroll":case"scrollend":oe=BA;break;case"wheel":oe=oT;break;case"copy":case"cut":case"paste":oe=GA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":oe=Oy;break;case"toggle":case"beforetoggle":oe=cT}var ke=(i&4)!==0,nt=!ke&&(r==="scroll"||r==="scrollend"),W=ke?ie!==null?ie+"Capture":null:ie;ke=[];for(var X=re,ne;X!==null;){var ue=X;if(ne=ue.stateNode,ue=ue.tag,ue!==5&&ue!==26&&ue!==27||ne===null||W===null||(ue=lo(X,W),ue!=null&&ke.push(qo(X,ue,ne))),nt)break;X=X.return}0<ke.length&&(ie=new oe(ie,xe,null,o,ce),fe.push({event:ie,listeners:ke}))}}if((i&7)===0){e:{if(ie=r==="mouseover"||r==="pointerover",oe=r==="mouseout"||r==="pointerout",ie&&o!==Df&&(xe=o.relatedTarget||o.fromElement)&&(Jr(xe)||xe[vr]))break e;if((oe||ie)&&(ie=ce.window===ce?ce:(ie=ce.ownerDocument)?ie.defaultView||ie.parentWindow:window,oe?(xe=o.relatedTarget||o.toElement,oe=re,xe=xe?Jr(xe):null,xe!==null&&(nt=l(xe),ke=xe.tag,xe!==nt||ke!==5&&ke!==27&&ke!==6)&&(xe=null)):(oe=null,xe=re),oe!==xe)){if(ke=Ty,ue="onMouseLeave",W="onMouseEnter",X="mouse",(r==="pointerout"||r==="pointerover")&&(ke=Oy,ue="onPointerLeave",W="onPointerEnter",X="pointer"),nt=oe==null?ie:es(oe),ne=xe==null?ie:es(xe),ie=new ke(ue,X+"leave",oe,o,ce),ie.target=nt,ie.relatedTarget=ne,ue=null,Jr(ce)===re&&(ke=new ke(W,X+"enter",xe,o,ce),ke.target=ne,ke.relatedTarget=nt,ue=ke),nt=ue,oe&&xe)t:{for(ke=lN,W=oe,X=xe,ne=0,ue=W;ue;ue=ke(ue))ne++;ue=0;for(var Re=X;Re;Re=ke(Re))ue++;for(;0<ne-ue;)W=ke(W),ne--;for(;0<ue-ne;)X=ke(X),ue--;for(;ne--;){if(W===X||X!==null&&W===X.alternate){ke=W;break t}W=ke(W),X=ke(X)}ke=null}else ke=null;oe!==null&&_b(fe,ie,oe,ke,!1),xe!==null&&nt!==null&&_b(fe,nt,xe,ke,!0)}}e:{if(ie=re?es(re):window,oe=ie.nodeName&&ie.nodeName.toLowerCase(),oe==="select"||oe==="input"&&ie.type==="file")var Ke=Iy;else if(Uy(ie))if(Ly)Ke=bT;else{Ke=yT;var Ae=gT}else oe=ie.nodeName,!oe||oe.toLowerCase()!=="input"||ie.type!=="checkbox"&&ie.type!=="radio"?re&&Mf(re.elementType)&&(Ke=Iy):Ke=vT;if(Ke&&(Ke=Ke(r,re))){$y(fe,Ke,o,ce);break e}Ae&&Ae(r,ie,re),r==="focusout"&&re&&ie.type==="number"&&re.memoizedProps.value!=null&&Ii(ie,"number",ie.value)}switch(Ae=re?es(re):window,r){case"focusin":(Uy(Ae)||Ae.contentEditable==="true")&&(Hi=Ae,Gf=re,yo=null);break;case"focusout":yo=Gf=Hi=null;break;case"mousedown":Xf=!0;break;case"contextmenu":case"mouseup":case"dragend":Xf=!1,Yy(fe,o,ce);break;case"selectionchange":if(wT)break;case"keydown":case"keyup":Yy(fe,o,ce)}var Be;if(Hf)e:{switch(r){case"compositionstart":var Ye="onCompositionStart";break e;case"compositionend":Ye="onCompositionEnd";break e;case"compositionupdate":Ye="onCompositionUpdate";break e}Ye=void 0}else qi?My(r,o)&&(Ye="onCompositionEnd"):r==="keydown"&&o.keyCode===229&&(Ye="onCompositionStart");Ye&&(Ry&&o.locale!=="ko"&&(qi||Ye!=="onCompositionStart"?Ye==="onCompositionEnd"&&qi&&(Be=Cy()):(rs=ce,Lf="value"in rs?rs.value:rs.textContent,qi=!0)),Ae=gu(re,Ye),0<Ae.length&&(Ye=new Ny(Ye,r,null,o,ce),fe.push({event:Ye,listeners:Ae}),Be?Ye.data=Be:(Be=Dy(o),Be!==null&&(Ye.data=Be)))),(Be=dT?fT(r,o):hT(r,o))&&(Ye=gu(re,"onBeforeInput"),0<Ye.length&&(Ae=new Ny("onBeforeInput","beforeinput",null,o,ce),fe.push({event:Ae,listeners:Ye}),Ae.data=Be)),sN(fe,r,re,o,ce)}vb(fe,i)})}function qo(r,i,o){return{instance:r,listener:i,currentTarget:o}}function gu(r,i){for(var o=i+"Capture",u=[];r!==null;){var m=r,y=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||y===null||(m=lo(r,o),m!=null&&u.unshift(qo(r,m,y)),m=lo(r,i),m!=null&&u.push(qo(r,m,y))),r.tag===3)return u;r=r.return}return[]}function lN(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function _b(r,i,o,u,m){for(var y=i._reactName,T=[];o!==null&&o!==u;){var U=o,F=U.alternate,re=U.stateNode;if(U=U.tag,F!==null&&F===u)break;U!==5&&U!==26&&U!==27||re===null||(F=re,m?(re=lo(o,y),re!=null&&T.unshift(qo(o,re,F))):m||(re=lo(o,y),re!=null&&T.push(qo(o,re,F)))),o=o.return}T.length!==0&&r.push({event:i,listeners:T})}var cN=/\r\n?/g,uN=/\u0000|\uFFFD/g;function wb(r){return(typeof r=="string"?r:""+r).replace(cN,`
`).replace(uN,"")}function xb(r,i){return i=wb(i),wb(r)===i}function tt(r,i,o,u,m,y){switch(o){case"children":typeof u=="string"?i==="body"||i==="textarea"&&u===""||zi(r,u):(typeof u=="number"||typeof u=="bigint")&&i!=="body"&&zi(r,""+u);break;case"className":Di(r,"class",u);break;case"tabIndex":Di(r,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Di(r,o,u);break;case"style":xy(r,u,y);break;case"data":if(i!=="object"){Di(r,"data",u);break}case"src":case"href":if(u===""&&(i!=="a"||o!=="href")){r.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(o);break}u=xc(""+u),r.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){r.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(o==="formAction"?(i!=="input"&&tt(r,i,"name",m.name,m,null),tt(r,i,"formEncType",m.formEncType,m,null),tt(r,i,"formMethod",m.formMethod,m,null),tt(r,i,"formTarget",m.formTarget,m,null)):(tt(r,i,"encType",m.encType,m,null),tt(r,i,"method",m.method,m,null),tt(r,i,"target",m.target,m,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(o);break}u=xc(""+u),r.setAttribute(o,u);break;case"onClick":u!=null&&(r.onclick=_r);break;case"onScroll":u!=null&&Ve("scroll",r);break;case"onScrollEnd":u!=null&&Ve("scrollend",r);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(o=u.__html,o!=null){if(m.children!=null)throw Error(s(60));r.innerHTML=o}}break;case"multiple":r.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":r.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){r.removeAttribute("xlink:href");break}o=xc(""+u),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,""+u):r.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,""):r.removeAttribute(o);break;case"capture":case"download":u===!0?r.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,u):r.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?r.setAttribute(o,u):r.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?r.removeAttribute(o):r.setAttribute(o,u);break;case"popover":Ve("beforetoggle",r),Ve("toggle",r),Mi(r,"popover",u);break;case"xlinkActuate":zn(r,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":zn(r,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":zn(r,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":zn(r,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":zn(r,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":zn(r,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":zn(r,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":zn(r,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":zn(r,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Mi(r,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=LA.get(o)||o,Mi(r,o,u))}}function bm(r,i,o,u,m,y){switch(o){case"style":xy(r,u,y);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(o=u.__html,o!=null){if(m.children!=null)throw Error(s(60));r.innerHTML=o}}break;case"children":typeof u=="string"?zi(r,u):(typeof u=="number"||typeof u=="bigint")&&zi(r,""+u);break;case"onScroll":u!=null&&Ve("scroll",r);break;case"onScrollEnd":u!=null&&Ve("scrollend",r);break;case"onClick":u!=null&&(r.onclick=_r);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!yc.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),i=o.slice(2,m?o.length-7:void 0),y=r[Ht]||null,y=y!=null?y[o]:null,typeof y=="function"&&r.removeEventListener(i,y,m),typeof u=="function")){typeof y!="function"&&y!==null&&(o in r?r[o]=null:r.hasAttribute(o)&&r.removeAttribute(o)),r.addEventListener(i,u,m);break e}o in r?r[o]=u:u===!0?r.setAttribute(o,""):Mi(r,o,u)}}}function zt(r,i,o){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ve("error",r),Ve("load",r);var u=!1,m=!1,y;for(y in o)if(o.hasOwnProperty(y)){var T=o[y];if(T!=null)switch(y){case"src":u=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,i));default:tt(r,i,y,T,o,null)}}m&&tt(r,i,"srcSet",o.srcSet,o,null),u&&tt(r,i,"src",o.src,o,null);return;case"input":Ve("invalid",r);var U=y=T=m=null,F=null,re=null;for(u in o)if(o.hasOwnProperty(u)){var ce=o[u];if(ce!=null)switch(u){case"name":m=ce;break;case"type":T=ce;break;case"checked":F=ce;break;case"defaultChecked":re=ce;break;case"value":y=ce;break;case"defaultValue":U=ce;break;case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(s(137,i));break;default:tt(r,i,u,ce,o,null)}}wc(r,y,U,F,re,T,m,!1);return;case"select":Ve("invalid",r),u=T=y=null;for(m in o)if(o.hasOwnProperty(m)&&(U=o[m],U!=null))switch(m){case"value":y=U;break;case"defaultValue":T=U;break;case"multiple":u=U;default:tt(r,i,m,U,o,null)}i=y,o=T,r.multiple=!!u,i!=null?Li(r,!!u,i,!1):o!=null&&Li(r,!!u,o,!0);return;case"textarea":Ve("invalid",r),y=m=u=null;for(T in o)if(o.hasOwnProperty(T)&&(U=o[T],U!=null))switch(T){case"value":u=U;break;case"defaultValue":m=U;break;case"children":y=U;break;case"dangerouslySetInnerHTML":if(U!=null)throw Error(s(91));break;default:tt(r,i,T,U,o,null)}_y(r,u,m,y);return;case"option":for(F in o)if(o.hasOwnProperty(F)&&(u=o[F],u!=null))switch(F){case"selected":r.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:tt(r,i,F,u,o,null)}return;case"dialog":Ve("beforetoggle",r),Ve("toggle",r),Ve("cancel",r),Ve("close",r);break;case"iframe":case"object":Ve("load",r);break;case"video":case"audio":for(u=0;u<Po.length;u++)Ve(Po[u],r);break;case"image":Ve("error",r),Ve("load",r);break;case"details":Ve("toggle",r);break;case"embed":case"source":case"link":Ve("error",r),Ve("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(re in o)if(o.hasOwnProperty(re)&&(u=o[re],u!=null))switch(re){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,i));default:tt(r,i,re,u,o,null)}return;default:if(Mf(i)){for(ce in o)o.hasOwnProperty(ce)&&(u=o[ce],u!==void 0&&bm(r,i,ce,u,o,void 0));return}}for(U in o)o.hasOwnProperty(U)&&(u=o[U],u!=null&&tt(r,i,U,u,o,null))}function dN(r,i,o,u){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,y=null,T=null,U=null,F=null,re=null,ce=null;for(oe in o){var fe=o[oe];if(o.hasOwnProperty(oe)&&fe!=null)switch(oe){case"checked":break;case"value":break;case"defaultValue":F=fe;default:u.hasOwnProperty(oe)||tt(r,i,oe,null,u,fe)}}for(var ie in u){var oe=u[ie];if(fe=o[ie],u.hasOwnProperty(ie)&&(oe!=null||fe!=null))switch(ie){case"type":y=oe;break;case"name":m=oe;break;case"checked":re=oe;break;case"defaultChecked":ce=oe;break;case"value":T=oe;break;case"defaultValue":U=oe;break;case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(s(137,i));break;default:oe!==fe&&tt(r,i,ie,oe,u,fe)}}oo(r,T,U,F,re,ce,y,m);return;case"select":oe=T=U=ie=null;for(y in o)if(F=o[y],o.hasOwnProperty(y)&&F!=null)switch(y){case"value":break;case"multiple":oe=F;default:u.hasOwnProperty(y)||tt(r,i,y,null,u,F)}for(m in u)if(y=u[m],F=o[m],u.hasOwnProperty(m)&&(y!=null||F!=null))switch(m){case"value":ie=y;break;case"defaultValue":U=y;break;case"multiple":T=y;default:y!==F&&tt(r,i,m,y,u,F)}i=U,o=T,u=oe,ie!=null?Li(r,!!o,ie,!1):!!u!=!!o&&(i!=null?Li(r,!!o,i,!0):Li(r,!!o,o?[]:"",!1));return;case"textarea":oe=ie=null;for(U in o)if(m=o[U],o.hasOwnProperty(U)&&m!=null&&!u.hasOwnProperty(U))switch(U){case"value":break;case"children":break;default:tt(r,i,U,null,u,m)}for(T in u)if(m=u[T],y=o[T],u.hasOwnProperty(T)&&(m!=null||y!=null))switch(T){case"value":ie=m;break;case"defaultValue":oe=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(s(91));break;default:m!==y&&tt(r,i,T,m,u,y)}by(r,ie,oe);return;case"option":for(var xe in o)if(ie=o[xe],o.hasOwnProperty(xe)&&ie!=null&&!u.hasOwnProperty(xe))switch(xe){case"selected":r.selected=!1;break;default:tt(r,i,xe,null,u,ie)}for(F in u)if(ie=u[F],oe=o[F],u.hasOwnProperty(F)&&ie!==oe&&(ie!=null||oe!=null))switch(F){case"selected":r.selected=ie&&typeof ie!="function"&&typeof ie!="symbol";break;default:tt(r,i,F,ie,u,oe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ke in o)ie=o[ke],o.hasOwnProperty(ke)&&ie!=null&&!u.hasOwnProperty(ke)&&tt(r,i,ke,null,u,ie);for(re in u)if(ie=u[re],oe=o[re],u.hasOwnProperty(re)&&ie!==oe&&(ie!=null||oe!=null))switch(re){case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(s(137,i));break;default:tt(r,i,re,ie,u,oe)}return;default:if(Mf(i)){for(var nt in o)ie=o[nt],o.hasOwnProperty(nt)&&ie!==void 0&&!u.hasOwnProperty(nt)&&bm(r,i,nt,void 0,u,ie);for(ce in u)ie=u[ce],oe=o[ce],!u.hasOwnProperty(ce)||ie===oe||ie===void 0&&oe===void 0||bm(r,i,ce,ie,u,oe);return}}for(var W in o)ie=o[W],o.hasOwnProperty(W)&&ie!=null&&!u.hasOwnProperty(W)&&tt(r,i,W,null,u,ie);for(fe in u)ie=u[fe],oe=o[fe],!u.hasOwnProperty(fe)||ie===oe||ie==null&&oe==null||tt(r,i,fe,ie,u,oe)}function Sb(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function fN(){if(typeof performance.getEntriesByType=="function"){for(var r=0,i=0,o=performance.getEntriesByType("resource"),u=0;u<o.length;u++){var m=o[u],y=m.transferSize,T=m.initiatorType,U=m.duration;if(y&&U&&Sb(T)){for(T=0,U=m.responseEnd,u+=1;u<o.length;u++){var F=o[u],re=F.startTime;if(re>U)break;var ce=F.transferSize,fe=F.initiatorType;ce&&Sb(fe)&&(F=F.responseEnd,T+=ce*(F<U?1:(U-re)/(F-re)))}if(--u,i+=8*(y+T)/(m.duration/1e3),r++,10<r)break}}if(0<r)return i/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var _m=null,wm=null;function yu(r){return r.nodeType===9?r:r.ownerDocument}function Eb(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Cb(r,i){if(r===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&i==="foreignObject"?0:r}function xm(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Sm=null;function hN(){var r=window.event;return r&&r.type==="popstate"?r===Sm?!1:(Sm=r,!0):(Sm=null,!1)}var Ab=typeof setTimeout=="function"?setTimeout:void 0,mN=typeof clearTimeout=="function"?clearTimeout:void 0,Tb=typeof Promise=="function"?Promise:void 0,pN=typeof queueMicrotask=="function"?queueMicrotask:typeof Tb<"u"?function(r){return Tb.resolve(null).then(r).catch(gN)}:Ab;function gN(r){setTimeout(function(){throw r})}function _s(r){return r==="head"}function Nb(r,i){var o=i,u=0;do{var m=o.nextSibling;if(r.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(u===0){r.removeChild(m),ga(i);return}u--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")u++;else if(o==="html")Ho(r.ownerDocument.documentElement);else if(o==="head"){o=r.ownerDocument.head,Ho(o);for(var y=o.firstChild;y;){var T=y.nextSibling,U=y.nodeName;y[qs]||U==="SCRIPT"||U==="STYLE"||U==="LINK"&&y.rel.toLowerCase()==="stylesheet"||o.removeChild(y),y=T}}else o==="body"&&Ho(r.ownerDocument.body);o=m}while(o);ga(i)}function Ob(r,i){var o=r;r=0;do{var u=o.nextSibling;if(o.nodeType===1?i?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(i?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),u&&u.nodeType===8)if(o=u.data,o==="/$"){if(r===0)break;r--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||r++;o=u}while(o)}function Em(r){var i=r.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var o=i;switch(i=i.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Em(o),io(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}r.removeChild(o)}}function yN(r,i,o,u){for(;r.nodeType===1;){var m=o;if(r.nodeName.toLowerCase()!==i.toLowerCase()){if(!u&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(u){if(!r[qs])switch(i){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==m.rel||r.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||r.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||r.getAttribute("title")!==(m.title==null?null:m.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(m.src==null?null:m.src)||r.getAttribute("type")!==(m.type==null?null:m.type)||r.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(i==="input"&&r.type==="hidden"){var y=m.name==null?null:""+m.name;if(m.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=kn(r.nextSibling),r===null)break}return null}function vN(r,i,o){if(i==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=kn(r.nextSibling),r===null))return null;return r}function Rb(r,i){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!i||(r=kn(r.nextSibling),r===null))return null;return r}function Cm(r){return r.data==="$?"||r.data==="$~"}function Am(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function bN(r,i){var o=r.ownerDocument;if(r.data==="$~")r._reactRetry=i;else if(r.data!=="$?"||o.readyState!=="loading")i();else{var u=function(){i(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),r._reactRetry=u}}function kn(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return r}var Tm=null;function jb(r){r=r.nextSibling;for(var i=0;r;){if(r.nodeType===8){var o=r.data;if(o==="/$"||o==="/&"){if(i===0)return kn(r.nextSibling);i--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||i++}r=r.nextSibling}return null}function kb(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var o=r.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(i===0)return r;i--}else o!=="/$"&&o!=="/&"||i++}r=r.previousSibling}return null}function Mb(r,i,o){switch(i=yu(o),r){case"html":if(r=i.documentElement,!r)throw Error(s(452));return r;case"head":if(r=i.head,!r)throw Error(s(453));return r;case"body":if(r=i.body,!r)throw Error(s(454));return r;default:throw Error(s(451))}}function Ho(r){for(var i=r.attributes;i.length;)r.removeAttributeNode(i[0]);io(r)}var Mn=new Map,Db=new Set;function vu(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var $r=L.d;L.d={f:_N,r:wN,D:xN,C:SN,L:EN,m:CN,X:TN,S:AN,M:NN};function _N(){var r=$r.f(),i=cu();return r||i}function wN(r){var i=Zr(r);i!==null&&i.tag===5&&i.type==="form"?W0(i):$r.r(r)}var ha=typeof document>"u"?null:document;function Ub(r,i,o){var u=ha;if(u&&typeof i=="string"&&i){var m=Vt(i);m='link[rel="'+r+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),Db.has(m)||(Db.add(m),r={rel:r,crossOrigin:o,href:i},u.querySelector(m)===null&&(i=u.createElement("link"),zt(i,"link",r),vt(i),u.head.appendChild(i)))}}function xN(r){$r.D(r),Ub("dns-prefetch",r,null)}function SN(r,i){$r.C(r,i),Ub("preconnect",r,i)}function EN(r,i,o){$r.L(r,i,o);var u=ha;if(u&&r&&i){var m='link[rel="preload"][as="'+Vt(i)+'"]';i==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+Vt(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+Vt(o.imageSizes)+'"]')):m+='[href="'+Vt(r)+'"]';var y=m;switch(i){case"style":y=ma(r);break;case"script":y=pa(r)}Mn.has(y)||(r=p({rel:"preload",href:i==="image"&&o&&o.imageSrcSet?void 0:r,as:i},o),Mn.set(y,r),u.querySelector(m)!==null||i==="style"&&u.querySelector(Vo(y))||i==="script"&&u.querySelector(Fo(y))||(i=u.createElement("link"),zt(i,"link",r),vt(i),u.head.appendChild(i)))}}function CN(r,i){$r.m(r,i);var o=ha;if(o&&r){var u=i&&typeof i.as=="string"?i.as:"script",m='link[rel="modulepreload"][as="'+Vt(u)+'"][href="'+Vt(r)+'"]',y=m;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=pa(r)}if(!Mn.has(y)&&(r=p({rel:"modulepreload",href:r},i),Mn.set(y,r),o.querySelector(m)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Fo(y)))return}u=o.createElement("link"),zt(u,"link",r),vt(u),o.head.appendChild(u)}}}function AN(r,i,o){$r.S(r,i,o);var u=ha;if(u&&r){var m=ts(u).hoistableStyles,y=ma(r);i=i||"default";var T=m.get(y);if(!T){var U={loading:0,preload:null};if(T=u.querySelector(Vo(y)))U.loading=5;else{r=p({rel:"stylesheet",href:r,"data-precedence":i},o),(o=Mn.get(y))&&Nm(r,o);var F=T=u.createElement("link");vt(F),zt(F,"link",r),F._p=new Promise(function(re,ce){F.onload=re,F.onerror=ce}),F.addEventListener("load",function(){U.loading|=1}),F.addEventListener("error",function(){U.loading|=2}),U.loading|=4,bu(T,i,u)}T={type:"stylesheet",instance:T,count:1,state:U},m.set(y,T)}}}function TN(r,i){$r.X(r,i);var o=ha;if(o&&r){var u=ts(o).hoistableScripts,m=pa(r),y=u.get(m);y||(y=o.querySelector(Fo(m)),y||(r=p({src:r,async:!0},i),(i=Mn.get(m))&&Om(r,i),y=o.createElement("script"),vt(y),zt(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(m,y))}}function NN(r,i){$r.M(r,i);var o=ha;if(o&&r){var u=ts(o).hoistableScripts,m=pa(r),y=u.get(m);y||(y=o.querySelector(Fo(m)),y||(r=p({src:r,async:!0,type:"module"},i),(i=Mn.get(m))&&Om(r,i),y=o.createElement("script"),vt(y),zt(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(m,y))}}function $b(r,i,o,u){var m=(m=pe.current)?vu(m):null;if(!m)throw Error(s(446));switch(r){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(i=ma(o.href),o=ts(m).hoistableStyles,u=o.get(i),u||(u={type:"style",instance:null,count:0,state:null},o.set(i,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){r=ma(o.href);var y=ts(m).hoistableStyles,T=y.get(r);if(T||(m=m.ownerDocument||m,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,T),(y=m.querySelector(Vo(r)))&&!y._p&&(T.instance=y,T.state.loading=5),Mn.has(r)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Mn.set(r,o),y||ON(m,r,o,T.state))),i&&u===null)throw Error(s(528,""));return T}if(i&&u!==null)throw Error(s(529,""));return null;case"script":return i=o.async,o=o.src,typeof o=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=pa(o),o=ts(m).hoistableScripts,u=o.get(i),u||(u={type:"script",instance:null,count:0,state:null},o.set(i,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,r))}}function ma(r){return'href="'+Vt(r)+'"'}function Vo(r){return'link[rel="stylesheet"]['+r+"]"}function Ib(r){return p({},r,{"data-precedence":r.precedence,precedence:null})}function ON(r,i,o,u){r.querySelector('link[rel="preload"][as="style"]['+i+"]")?u.loading=1:(i=r.createElement("link"),u.preload=i,i.addEventListener("load",function(){return u.loading|=1}),i.addEventListener("error",function(){return u.loading|=2}),zt(i,"link",o),vt(i),r.head.appendChild(i))}function pa(r){return'[src="'+Vt(r)+'"]'}function Fo(r){return"script[async]"+r}function Lb(r,i,o){if(i.count++,i.instance===null)switch(i.type){case"style":var u=r.querySelector('style[data-href~="'+Vt(o.href)+'"]');if(u)return i.instance=u,vt(u),u;var m=p({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(r.ownerDocument||r).createElement("style"),vt(u),zt(u,"style",m),bu(u,o.precedence,r),i.instance=u;case"stylesheet":m=ma(o.href);var y=r.querySelector(Vo(m));if(y)return i.state.loading|=4,i.instance=y,vt(y),y;u=Ib(o),(m=Mn.get(m))&&Nm(u,m),y=(r.ownerDocument||r).createElement("link"),vt(y);var T=y;return T._p=new Promise(function(U,F){T.onload=U,T.onerror=F}),zt(y,"link",u),i.state.loading|=4,bu(y,o.precedence,r),i.instance=y;case"script":return y=pa(o.src),(m=r.querySelector(Fo(y)))?(i.instance=m,vt(m),m):(u=o,(m=Mn.get(y))&&(u=p({},o),Om(u,m)),r=r.ownerDocument||r,m=r.createElement("script"),vt(m),zt(m,"link",u),r.head.appendChild(m),i.instance=m);case"void":return null;default:throw Error(s(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(u=i.instance,i.state.loading|=4,bu(u,o.precedence,r));return i.instance}function bu(r,i,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=u.length?u[u.length-1]:null,y=m,T=0;T<u.length;T++){var U=u[T];if(U.dataset.precedence===i)y=U;else if(y!==m)break}y?y.parentNode.insertBefore(r,y.nextSibling):(i=o.nodeType===9?o.head:o,i.insertBefore(r,i.firstChild))}function Nm(r,i){r.crossOrigin==null&&(r.crossOrigin=i.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=i.referrerPolicy),r.title==null&&(r.title=i.title)}function Om(r,i){r.crossOrigin==null&&(r.crossOrigin=i.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=i.referrerPolicy),r.integrity==null&&(r.integrity=i.integrity)}var _u=null;function zb(r,i,o){if(_u===null){var u=new Map,m=_u=new Map;m.set(o,u)}else m=_u,u=m.get(o),u||(u=new Map,m.set(o,u));if(u.has(r))return u;for(u.set(r,null),o=o.getElementsByTagName(r),m=0;m<o.length;m++){var y=o[m];if(!(y[qs]||y[Tt]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var T=y.getAttribute(i)||"";T=r+T;var U=u.get(T);U?U.push(y):u.set(T,[y])}}return u}function Bb(r,i,o){r=r.ownerDocument||r,r.head.insertBefore(o,i==="title"?r.querySelector("head > title"):null)}function RN(r,i,o){if(o===1||i.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return r=i.disabled,typeof i.precedence=="string"&&r==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Pb(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function jN(r,i,o,u){if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=ma(u.href),y=i.querySelector(Vo(m));if(y){i=y._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(r.count++,r=wu.bind(r),i.then(r,r)),o.state.loading|=4,o.instance=y,vt(y);return}y=i.ownerDocument||i,u=Ib(u),(m=Mn.get(m))&&Nm(u,m),y=y.createElement("link"),vt(y);var T=y;T._p=new Promise(function(U,F){T.onload=U,T.onerror=F}),zt(y,"link",u),o.instance=y}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(r.count++,o=wu.bind(r),i.addEventListener("load",o),i.addEventListener("error",o))}}var Rm=0;function kN(r,i){return r.stylesheets&&r.count===0&&Su(r,r.stylesheets),0<r.count||0<r.imgCount?function(o){var u=setTimeout(function(){if(r.stylesheets&&Su(r,r.stylesheets),r.unsuspend){var y=r.unsuspend;r.unsuspend=null,y()}},6e4+i);0<r.imgBytes&&Rm===0&&(Rm=62500*fN());var m=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Su(r,r.stylesheets),r.unsuspend)){var y=r.unsuspend;r.unsuspend=null,y()}},(r.imgBytes>Rm?50:800)+i);return r.unsuspend=o,function(){r.unsuspend=null,clearTimeout(u),clearTimeout(m)}}:null}function wu(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Su(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var xu=null;function Su(r,i){r.stylesheets=null,r.unsuspend!==null&&(r.count++,xu=new Map,i.forEach(MN,r),xu=null,wu.call(r))}function MN(r,i){if(!(i.state.loading&4)){var o=xu.get(r);if(o)var u=o.get(null);else{o=new Map,xu.set(r,o);for(var m=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<m.length;y++){var T=m[y];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(o.set(T.dataset.precedence,T),u=T)}u&&o.set(null,u)}m=i.instance,T=m.getAttribute("data-precedence"),y=o.get(T)||u,y===u&&o.set(null,m),o.set(T,m),this.count++,u=wu.bind(this),m.addEventListener("load",u),m.addEventListener("error",u),y?y.parentNode.insertBefore(m,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(m,r.firstChild)),i.state.loading|=4}}var Yo={$$typeof:E,Provider:null,Consumer:null,_currentValue:V,_currentValue2:V,_threadCount:0};function DN(r,i,o,u,m,y,T,U,F){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=no(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=no(0),this.hiddenUpdates=no(null),this.identifierPrefix=u,this.onUncaughtError=m,this.onCaughtError=y,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=F,this.incompleteTransitions=new Map}function qb(r,i,o,u,m,y,T,U,F,re,ce,fe){return r=new DN(r,i,o,T,F,re,ce,fe,U),i=1,y===!0&&(i|=24),y=dn(3,null,null,i),r.current=y,y.stateNode=r,i=ch(),i.refCount++,r.pooledCache=i,i.refCount++,y.memoizedState={element:u,isDehydrated:o,cache:i},hh(y),r}function Hb(r){return r?(r=Yi,r):Yi}function Vb(r,i,o,u,m,y){m=Hb(m),u.context===null?u.context=m:u.pendingContext=m,u=cs(i),u.payload={element:o},y=y===void 0?null:y,y!==null&&(u.callback=y),o=us(r,u,i),o!==null&&(an(o,r,i),Eo(o,r,i))}function Fb(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var o=r.retryLane;r.retryLane=o!==0&&o<i?o:i}}function jm(r,i){Fb(r,i),(r=r.alternate)&&Fb(r,i)}function Yb(r){if(r.tag===13||r.tag===31){var i=Ys(r,67108864);i!==null&&an(i,r,67108864),jm(r,67108864)}}function Gb(r){if(r.tag===13||r.tag===31){var i=gn();i=ro(i);var o=Ys(r,i);o!==null&&an(o,r,i),jm(r,i)}}var Eu=!0;function UN(r,i,o,u){var m=k.T;k.T=null;var y=L.p;try{L.p=2,km(r,i,o,u)}finally{L.p=y,k.T=m}}function $N(r,i,o,u){var m=k.T;k.T=null;var y=L.p;try{L.p=8,km(r,i,o,u)}finally{L.p=y,k.T=m}}function km(r,i,o,u){if(Eu){var m=Mm(u);if(m===null)vm(r,i,u,Cu,o),Kb(r,u);else if(LN(m,r,i,o,u))u.stopPropagation();else if(Kb(r,u),i&4&&-1<IN.indexOf(r)){for(;m!==null;){var y=Zr(m);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var T=yr(y.pendingLanes);if(T!==0){var U=y;for(U.pendingLanes|=2,U.entangledLanes|=2;T;){var F=1<<31-De(T);U.entanglements[1]|=F,T&=~F}ar(y),(We&6)===0&&(ou=At()+500,Bo(0))}}break;case 31:case 13:U=Ys(y,2),U!==null&&an(U,y,2),cu(),jm(y,2)}if(y=Mm(u),y===null&&vm(r,i,u,Cu,o),y===m)break;m=y}m!==null&&u.stopPropagation()}else vm(r,i,u,null,o)}}function Mm(r){return r=Uf(r),Dm(r)}var Cu=null;function Dm(r){if(Cu=null,r=Jr(r),r!==null){var i=l(r);if(i===null)r=null;else{var o=i.tag;if(o===13){if(r=c(i),r!==null)return r;r=null}else if(o===31){if(r=d(i),r!==null)return r;r=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null)}}return Cu=r,null}function Xb(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Qr()){case Cn:return 2;case tr:return 8;case gr:case eo:return 32;case Wr:return 268435456;default:return 32}default:return 32}}var Um=!1,ws=null,xs=null,Ss=null,Go=new Map,Xo=new Map,Es=[],IN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Kb(r,i){switch(r){case"focusin":case"focusout":ws=null;break;case"dragenter":case"dragleave":xs=null;break;case"mouseover":case"mouseout":Ss=null;break;case"pointerover":case"pointerout":Go.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xo.delete(i.pointerId)}}function Ko(r,i,o,u,m,y){return r===null||r.nativeEvent!==y?(r={blockedOn:i,domEventName:o,eventSystemFlags:u,nativeEvent:y,targetContainers:[m]},i!==null&&(i=Zr(i),i!==null&&Yb(i)),r):(r.eventSystemFlags|=u,i=r.targetContainers,m!==null&&i.indexOf(m)===-1&&i.push(m),r)}function LN(r,i,o,u,m){switch(i){case"focusin":return ws=Ko(ws,r,i,o,u,m),!0;case"dragenter":return xs=Ko(xs,r,i,o,u,m),!0;case"mouseover":return Ss=Ko(Ss,r,i,o,u,m),!0;case"pointerover":var y=m.pointerId;return Go.set(y,Ko(Go.get(y)||null,r,i,o,u,m)),!0;case"gotpointercapture":return y=m.pointerId,Xo.set(y,Ko(Xo.get(y)||null,r,i,o,u,m)),!0}return!1}function Qb(r){var i=Jr(r.target);if(i!==null){var o=l(i);if(o!==null){if(i=o.tag,i===13){if(i=c(o),i!==null){r.blockedOn=i,hc(r.priority,function(){Gb(o)});return}}else if(i===31){if(i=d(o),i!==null){r.blockedOn=i,hc(r.priority,function(){Gb(o)});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){r.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Au(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var o=Mm(r.nativeEvent);if(o===null){o=r.nativeEvent;var u=new o.constructor(o.type,o);Df=u,o.target.dispatchEvent(u),Df=null}else return i=Zr(o),i!==null&&Yb(i),r.blockedOn=o,!1;i.shift()}return!0}function Wb(r,i,o){Au(r)&&o.delete(i)}function zN(){Um=!1,ws!==null&&Au(ws)&&(ws=null),xs!==null&&Au(xs)&&(xs=null),Ss!==null&&Au(Ss)&&(Ss=null),Go.forEach(Wb),Xo.forEach(Wb)}function Tu(r,i){r.blockedOn===i&&(r.blockedOn=null,Um||(Um=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,zN)))}var Nu=null;function Jb(r){Nu!==r&&(Nu=r,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Nu===r&&(Nu=null);for(var i=0;i<r.length;i+=3){var o=r[i],u=r[i+1],m=r[i+2];if(typeof u!="function"){if(Dm(u||o)===null)continue;break}var y=Zr(o);y!==null&&(r.splice(i,3),i-=3,Mh(y,{pending:!0,data:m,method:o.method,action:u},u,m))}}))}function ga(r){function i(F){return Tu(F,r)}ws!==null&&Tu(ws,r),xs!==null&&Tu(xs,r),Ss!==null&&Tu(Ss,r),Go.forEach(i),Xo.forEach(i);for(var o=0;o<Es.length;o++){var u=Es[o];u.blockedOn===r&&(u.blockedOn=null)}for(;0<Es.length&&(o=Es[0],o.blockedOn===null);)Qb(o),o.blockedOn===null&&Es.shift();if(o=(r.ownerDocument||r).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var m=o[u],y=o[u+1],T=m[Ht]||null;if(typeof y=="function")T||Jb(o);else if(T){var U=null;if(y&&y.hasAttribute("formAction")){if(m=y,T=y[Ht]||null)U=T.formAction;else if(Dm(m)!==null)continue}else U=T.action;typeof U=="function"?o[u+1]=U:(o.splice(u,3),u-=3),Jb(o)}}}function Zb(){function r(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(T){return m=T})},focusReset:"manual",scroll:"manual"})}function i(){m!==null&&(m(),m=null),u||setTimeout(o,20)}function o(){if(!u&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,m=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(o,100),function(){u=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),m!==null&&(m(),m=null)}}}function $m(r){this._internalRoot=r}Ou.prototype.render=$m.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(s(409));var o=i.current,u=gn();Vb(o,u,r,i,null,null)},Ou.prototype.unmount=$m.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;Vb(r.current,2,null,r,null,null),cu(),i[vr]=null}};function Ou(r){this._internalRoot=r}Ou.prototype.unstable_scheduleHydration=function(r){if(r){var i=fc();r={blockedOn:null,target:r,priority:i};for(var o=0;o<Es.length&&i!==0&&i<Es[o].priority;o++);Es.splice(o,0,r),o===0&&Qb(r)}};var e_=e.version;if(e_!=="19.2.0")throw Error(s(527,e_,"19.2.0"));L.findDOMNode=function(r){var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(s(188)):(r=Object.keys(r).join(","),Error(s(268,r)));return r=f(i),r=r!==null?g(r):null,r=r===null?null:r.stateNode,r};var BN={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:k,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ru.isDisabled&&Ru.supportsFiber)try{me=Ru.inject(BN),Ee=Ru}catch{}}return Wo.createRoot=function(r,i){if(!a(r))throw Error(s(299));var o=!1,u="",m=ov,y=lv,T=cv;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(u=i.identifierPrefix),i.onUncaughtError!==void 0&&(m=i.onUncaughtError),i.onCaughtError!==void 0&&(y=i.onCaughtError),i.onRecoverableError!==void 0&&(T=i.onRecoverableError)),i=qb(r,1,!1,null,null,o,u,null,m,y,T,Zb),r[vr]=i.current,ym(r),new $m(i)},Wo.hydrateRoot=function(r,i,o){if(!a(r))throw Error(s(299));var u=!1,m="",y=ov,T=lv,U=cv,F=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(T=o.onCaughtError),o.onRecoverableError!==void 0&&(U=o.onRecoverableError),o.formState!==void 0&&(F=o.formState)),i=qb(r,1,!0,i,o??null,u,m,F,y,T,U,Zb),i.context=Hb(null),o=i.current,u=gn(),u=ro(u),m=cs(u),m.callback=null,us(o,m,u),o=u,i.current.lanes=o,Ps(i,o),ar(i),r[vr]=i.current,ym(r),new Ou(i)},Wo.version="19.2.0",Wo}var u_;function WN(){if(u_)return zm.exports;u_=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),zm.exports=QN(),zm.exports}var JN=WN();var d_="popstate";function ZN(t={}){function e(s,a){let{pathname:l,search:c,hash:d}=s.location;return Sp("",{pathname:l,search:c,hash:d},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(s,a){return typeof a=="string"?a:jl(a)}return tO(e,n,null,t)}function dt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function fr(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function eO(){return Math.random().toString(36).substring(2,10)}function f_(t,e){return{usr:t.state,key:t.key,idx:e}}function Sp(t,e,n=null,s){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Ga(e):e,state:n,key:e&&e.key||s||eO()}}function jl({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Ga(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substring(s),t=t.substring(0,s)),t&&(e.pathname=t)}return e}function tO(t,e,n,s={}){let{window:a=document.defaultView,v5Compat:l=!1}=s,c=a.history,d="POP",h=null,f=g();f==null&&(f=0,c.replaceState({...c.state,idx:f},""));function g(){return(c.state||{idx:null}).idx}function p(){d="POP";let S=g(),A=S==null?null:S-f;f=S,h&&h({action:d,location:w.location,delta:A})}function v(S,A){d="PUSH";let N=Sp(w.location,S,A);f=g()+1;let E=f_(N,f),C=w.createHref(N);try{c.pushState(E,"",C)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;a.location.assign(C)}l&&h&&h({action:d,location:w.location,delta:1})}function b(S,A){d="REPLACE";let N=Sp(w.location,S,A);f=g();let E=f_(N,f),C=w.createHref(N);c.replaceState(E,"",C),l&&h&&h({action:d,location:w.location,delta:0})}function x(S){return nO(S)}let w={get action(){return d},get location(){return t(a,c)},listen(S){if(h)throw new Error("A history only accepts one active listener");return a.addEventListener(d_,p),h=S,()=>{a.removeEventListener(d_,p),h=null}},createHref(S){return e(a,S)},createURL:x,encodeLocation(S){let A=x(S);return{pathname:A.pathname,search:A.search,hash:A.hash}},push:v,replace:b,go(S){return c.go(S)}};return w}function nO(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),dt(n,"No window.location.(origin|href) available to create URL");let s=typeof t=="string"?t:jl(t);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=n+s),new URL(s,n)}function Xx(t,e,n="/"){return rO(t,e,n,!1)}function rO(t,e,n,s){let a=typeof e=="string"?Ga(e):e,l=Fr(a.pathname||"/",n);if(l==null)return null;let c=Kx(t);sO(c);let d=null;for(let h=0;d==null&&h<c.length;++h){let f=pO(l);d=hO(c[h],f,s)}return d}function Kx(t,e=[],n=[],s="",a=!1){let l=(c,d,h=a,f)=>{let g={relativePath:f===void 0?c.path||"":f,caseSensitive:c.caseSensitive===!0,childrenIndex:d,route:c};if(g.relativePath.startsWith("/")){if(!g.relativePath.startsWith(s)&&h)return;dt(g.relativePath.startsWith(s),`Absolute route path "${g.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),g.relativePath=g.relativePath.slice(s.length)}let p=Vr([s,g.relativePath]),v=n.concat(g);c.children&&c.children.length>0&&(dt(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),Kx(c.children,e,v,p,h)),!(c.path==null&&!c.index)&&e.push({path:p,score:dO(p,c.index),routesMeta:v})};return t.forEach((c,d)=>{if(c.path===""||!c.path?.includes("?"))l(c,d);else for(let h of Qx(c.path))l(c,d,!0,h)}),e}function Qx(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,a=n.endsWith("?"),l=n.replace(/\?$/,"");if(s.length===0)return a?[l,""]:[l];let c=Qx(s.join("/")),d=[];return d.push(...c.map(h=>h===""?l:[l,h].join("/"))),a&&d.push(...c),d.map(h=>t.startsWith("/")&&h===""?"/":h)}function sO(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:fO(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}var iO=/^:[\w-]+$/,aO=3,oO=2,lO=1,cO=10,uO=-2,h_=t=>t==="*";function dO(t,e){let n=t.split("/"),s=n.length;return n.some(h_)&&(s+=uO),e&&(s+=oO),n.filter(a=>!h_(a)).reduce((a,l)=>a+(iO.test(l)?aO:l===""?lO:cO),s)}function fO(t,e){return t.length===e.length&&t.slice(0,-1).every((s,a)=>s===e[a])?t[t.length-1]-e[e.length-1]:0}function hO(t,e,n=!1){let{routesMeta:s}=t,a={},l="/",c=[];for(let d=0;d<s.length;++d){let h=s[d],f=d===s.length-1,g=l==="/"?e:e.slice(l.length)||"/",p=Sd({path:h.relativePath,caseSensitive:h.caseSensitive,end:f},g),v=h.route;if(!p&&f&&n&&!s[s.length-1].route.index&&(p=Sd({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},g)),!p)return null;Object.assign(a,p.params),c.push({params:a,pathname:Vr([l,p.pathname]),pathnameBase:bO(Vr([l,p.pathnameBase])),route:v}),p.pathnameBase!=="/"&&(l=Vr([l,p.pathnameBase]))}return c}function Sd(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=mO(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let l=a[0],c=l.replace(/(.)\/+$/,"$1"),d=a.slice(1);return{params:s.reduce((f,{paramName:g,isOptional:p},v)=>{if(g==="*"){let x=d[v]||"";c=l.slice(0,l.length-x.length).replace(/(.)\/+$/,"$1")}const b=d[v];return p&&!b?f[g]=void 0:f[g]=(b||"").replace(/%2F/g,"/"),f},{}),pathname:l,pathnameBase:c,pattern:t}}function mO(t,e=!1,n=!0){fr(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let s=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,d,h)=>(s.push({paramName:d,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(s.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),s]}function pO(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return fr(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Fr(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function gO(t,e="/"){let{pathname:n,search:s="",hash:a=""}=typeof t=="string"?Ga(t):t;return{pathname:n?n.startsWith("/")?n:yO(n,e):e,search:_O(s),hash:wO(a)}}function yO(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function Hm(t,e,n,s){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function vO(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Wx(t){let e=vO(t);return e.map((n,s)=>s===e.length-1?n.pathname:n.pathnameBase)}function Jx(t,e,n,s=!1){let a;typeof t=="string"?a=Ga(t):(a={...t},dt(!a.pathname||!a.pathname.includes("?"),Hm("?","pathname","search",a)),dt(!a.pathname||!a.pathname.includes("#"),Hm("#","pathname","hash",a)),dt(!a.search||!a.search.includes("#"),Hm("#","search","hash",a)));let l=t===""||a.pathname==="",c=l?"/":a.pathname,d;if(c==null)d=n;else{let p=e.length-1;if(!s&&c.startsWith("..")){let v=c.split("/");for(;v[0]==="..";)v.shift(),p-=1;a.pathname=v.join("/")}d=p>=0?e[p]:"/"}let h=gO(a,d),f=c&&c!=="/"&&c.endsWith("/"),g=(l||c===".")&&n.endsWith("/");return!h.pathname.endsWith("/")&&(f||g)&&(h.pathname+="/"),h}var Vr=t=>t.join("/").replace(/\/\/+/g,"/"),bO=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),_O=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,wO=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function xO(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Zx=["POST","PUT","PATCH","DELETE"];new Set(Zx);var SO=["GET",...Zx];new Set(SO);var Xa=j.createContext(null);Xa.displayName="DataRouter";var Qd=j.createContext(null);Qd.displayName="DataRouterState";j.createContext(!1);var eS=j.createContext({isTransitioning:!1});eS.displayName="ViewTransition";var EO=j.createContext(new Map);EO.displayName="Fetchers";var CO=j.createContext(null);CO.displayName="Await";var hr=j.createContext(null);hr.displayName="Navigation";var Xl=j.createContext(null);Xl.displayName="Location";var Gr=j.createContext({outlet:null,matches:[],isDataRoute:!1});Gr.displayName="Route";var mg=j.createContext(null);mg.displayName="RouteError";function AO(t,{relative:e}={}){dt(Kl(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:s}=j.useContext(hr),{hash:a,pathname:l,search:c}=Ql(t,{relative:e}),d=l;return n!=="/"&&(d=l==="/"?n:Vr([n,l])),s.createHref({pathname:d,search:c,hash:a})}function Kl(){return j.useContext(Xl)!=null}function Ci(){return dt(Kl(),"useLocation() may be used only in the context of a <Router> component."),j.useContext(Xl).location}var tS="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function nS(t){j.useContext(hr).static||j.useLayoutEffect(t)}function $s(){let{isDataRoute:t}=j.useContext(Gr);return t?zO():TO()}function TO(){dt(Kl(),"useNavigate() may be used only in the context of a <Router> component.");let t=j.useContext(Xa),{basename:e,navigator:n}=j.useContext(hr),{matches:s}=j.useContext(Gr),{pathname:a}=Ci(),l=JSON.stringify(Wx(s)),c=j.useRef(!1);return nS(()=>{c.current=!0}),j.useCallback((h,f={})=>{if(fr(c.current,tS),!c.current)return;if(typeof h=="number"){n.go(h);return}let g=Jx(h,JSON.parse(l),a,f.relative==="path");t==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:Vr([e,g.pathname])),(f.replace?n.replace:n.push)(g,f.state,f)},[e,n,l,a,t])}j.createContext(null);function Ql(t,{relative:e}={}){let{matches:n}=j.useContext(Gr),{pathname:s}=Ci(),a=JSON.stringify(Wx(n));return j.useMemo(()=>Jx(t,JSON.parse(a),s,e==="path"),[t,a,s,e])}function NO(t,e){return rS(t,e)}function rS(t,e,n,s,a){dt(Kl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=j.useContext(hr),{matches:c}=j.useContext(Gr),d=c[c.length-1],h=d?d.params:{},f=d?d.pathname:"/",g=d?d.pathnameBase:"/",p=d&&d.route;{let N=p&&p.path||"";sS(f,!p||N.endsWith("*")||N.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${N}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${N}"> to <Route path="${N==="/"?"*":`${N}/*`}">.`)}let v=Ci(),b;if(e){let N=typeof e=="string"?Ga(e):e;dt(g==="/"||N.pathname?.startsWith(g),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${g}" but pathname "${N.pathname}" was given in the \`location\` prop.`),b=N}else b=v;let x=b.pathname||"/",w=x;if(g!=="/"){let N=g.replace(/^\//,"").split("/");w="/"+x.replace(/^\//,"").split("/").slice(N.length).join("/")}let S=Xx(t,{pathname:w});fr(p||S!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),fr(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let A=MO(S&&S.map(N=>Object.assign({},N,{params:Object.assign({},h,N.params),pathname:Vr([g,l.encodeLocation?l.encodeLocation(N.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?g:Vr([g,l.encodeLocation?l.encodeLocation(N.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:N.pathnameBase])})),c,n,s,a);return e&&A?j.createElement(Xl.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},A):A}function OO(){let t=LO(),e=xO(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:s},l={padding:"2px 4px",backgroundColor:s},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=j.createElement(j.Fragment,null,j.createElement("p",null," Hey developer "),j.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",j.createElement("code",{style:l},"ErrorBoundary")," or"," ",j.createElement("code",{style:l},"errorElement")," prop on your route.")),j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},e),n?j.createElement("pre",{style:a},n):null,c)}var RO=j.createElement(OO,null),jO=class extends j.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.unstable_onError?this.props.unstable_onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?j.createElement(Gr.Provider,{value:this.props.routeContext},j.createElement(mg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function kO({routeContext:t,match:e,children:n}){let s=j.useContext(Xa);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),j.createElement(Gr.Provider,{value:t},n)}function MO(t,e=[],n=null,s=null,a=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,c=n?.errors;if(c!=null){let f=l.findIndex(g=>g.route.id&&c?.[g.route.id]!==void 0);dt(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,f+1))}let d=!1,h=-1;if(n)for(let f=0;f<l.length;f++){let g=l[f];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(h=f),g.route.id){let{loaderData:p,errors:v}=n,b=g.route.loader&&!p.hasOwnProperty(g.route.id)&&(!v||v[g.route.id]===void 0);if(g.route.lazy||b){d=!0,h>=0?l=l.slice(0,h+1):l=[l[0]];break}}}return l.reduceRight((f,g,p)=>{let v,b=!1,x=null,w=null;n&&(v=c&&g.route.id?c[g.route.id]:void 0,x=g.route.errorElement||RO,d&&(h<0&&p===0?(sS("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,w=null):h===p&&(b=!0,w=g.route.hydrateFallbackElement||null)));let S=e.concat(l.slice(0,p+1)),A=()=>{let N;return v?N=x:b?N=w:g.route.Component?N=j.createElement(g.route.Component,null):g.route.element?N=g.route.element:N=f,j.createElement(kO,{match:g,routeContext:{outlet:f,matches:S,isDataRoute:n!=null},children:N})};return n&&(g.route.ErrorBoundary||g.route.errorElement||p===0)?j.createElement(jO,{location:n.location,revalidation:n.revalidation,component:x,error:v,children:A(),routeContext:{outlet:null,matches:S,isDataRoute:!0},unstable_onError:s}):A()},null)}function pg(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function DO(t){let e=j.useContext(Xa);return dt(e,pg(t)),e}function UO(t){let e=j.useContext(Qd);return dt(e,pg(t)),e}function $O(t){let e=j.useContext(Gr);return dt(e,pg(t)),e}function gg(t){let e=$O(t),n=e.matches[e.matches.length-1];return dt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function IO(){return gg("useRouteId")}function LO(){let t=j.useContext(mg),e=UO("useRouteError"),n=gg("useRouteError");return t!==void 0?t:e.errors?.[n]}function zO(){let{router:t}=DO("useNavigate"),e=gg("useNavigate"),n=j.useRef(!1);return nS(()=>{n.current=!0}),j.useCallback(async(a,l={})=>{fr(n.current,tS),n.current&&(typeof a=="number"?t.navigate(a):await t.navigate(a,{fromRouteId:e,...l}))},[t,e])}var m_={};function sS(t,e,n){!e&&!m_[t]&&(m_[t]=!0,fr(!1,n))}j.memo(BO);function BO({routes:t,future:e,state:n,unstable_onError:s}){return rS(t,void 0,n,s,e)}function ks(t){dt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function PO({basename:t="/",children:e=null,location:n,navigationType:s="POP",navigator:a,static:l=!1}){dt(!Kl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),d=j.useMemo(()=>({basename:c,navigator:a,static:l,future:{}}),[c,a,l]);typeof n=="string"&&(n=Ga(n));let{pathname:h="/",search:f="",hash:g="",state:p=null,key:v="default"}=n,b=j.useMemo(()=>{let x=Fr(h,c);return x==null?null:{location:{pathname:x,search:f,hash:g,state:p,key:v},navigationType:s}},[c,h,f,g,p,v,s]);return fr(b!=null,`<Router basename="${c}"> is not able to match the URL "${h}${f}${g}" because it does not start with the basename, so the <Router> won't render anything.`),b==null?null:j.createElement(hr.Provider,{value:d},j.createElement(Xl.Provider,{children:e,value:b}))}function qO({children:t,location:e}){return NO(Ep(t),e)}function Ep(t,e=[]){let n=[];return j.Children.forEach(t,(s,a)=>{if(!j.isValidElement(s))return;let l=[...e,a];if(s.type===j.Fragment){n.push.apply(n,Ep(s.props.children,l));return}dt(s.type===ks,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),dt(!s.props.index||!s.props.children,"An index route cannot have child routes.");let c={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(c.children=Ep(s.props.children,l)),n.push(c)}),n}var ad="get",od="application/x-www-form-urlencoded";function Wd(t){return t!=null&&typeof t.tagName=="string"}function HO(t){return Wd(t)&&t.tagName.toLowerCase()==="button"}function VO(t){return Wd(t)&&t.tagName.toLowerCase()==="form"}function FO(t){return Wd(t)&&t.tagName.toLowerCase()==="input"}function YO(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function GO(t,e){return t.button===0&&(!e||e==="_self")&&!YO(t)}var ju=null;function XO(){if(ju===null)try{new FormData(document.createElement("form"),0),ju=!1}catch{ju=!0}return ju}var KO=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Vm(t){return t!=null&&!KO.has(t)?(fr(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${od}"`),null):t}function QO(t,e){let n,s,a,l,c;if(VO(t)){let d=t.getAttribute("action");s=d?Fr(d,e):null,n=t.getAttribute("method")||ad,a=Vm(t.getAttribute("enctype"))||od,l=new FormData(t)}else if(HO(t)||FO(t)&&(t.type==="submit"||t.type==="image")){let d=t.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=t.getAttribute("formaction")||d.getAttribute("action");if(s=h?Fr(h,e):null,n=t.getAttribute("formmethod")||d.getAttribute("method")||ad,a=Vm(t.getAttribute("formenctype"))||Vm(d.getAttribute("enctype"))||od,l=new FormData(d,t),!XO()){let{name:f,type:g,value:p}=t;if(g==="image"){let v=f?`${f}.`:"";l.append(`${v}x`,"0"),l.append(`${v}y`,"0")}else f&&l.append(f,p)}}else{if(Wd(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=ad,s=null,a=od,c=t}return l&&a==="text/plain"&&(c=l,l=void 0),{action:s,method:n.toLowerCase(),encType:a,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function yg(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function WO(t,e,n){let s=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return s.pathname==="/"?s.pathname=`_root.${n}`:e&&Fr(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${n}`,s}async function JO(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function ZO(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function eR(t,e,n){let s=await Promise.all(t.map(async a=>{let l=e.routes[a.route.id];if(l){let c=await JO(l,n);return c.links?c.links():[]}return[]}));return sR(s.flat(1).filter(ZO).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function p_(t,e,n,s,a,l){let c=(h,f)=>n[f]?h.route.id!==n[f].route.id:!0,d=(h,f)=>n[f].pathname!==h.pathname||n[f].route.path?.endsWith("*")&&n[f].params["*"]!==h.params["*"];return l==="assets"?e.filter((h,f)=>c(h,f)||d(h,f)):l==="data"?e.filter((h,f)=>{let g=s.routes[h.route.id];if(!g||!g.hasLoader)return!1;if(c(h,f)||d(h,f))return!0;if(h.route.shouldRevalidate){let p=h.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function tR(t,e,{includeHydrateFallback:n}={}){return nR(t.map(s=>{let a=e.routes[s.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function nR(t){return[...new Set(t)]}function rR(t){let e={},n=Object.keys(t).sort();for(let s of n)e[s]=t[s];return e}function sR(t,e){let n=new Set;return new Set(e),t.reduce((s,a)=>{let l=JSON.stringify(rR(a));return n.has(l)||(n.add(l),s.push({key:l,link:a})),s},[])}function iS(){let t=j.useContext(Xa);return yg(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function iR(){let t=j.useContext(Qd);return yg(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var vg=j.createContext(void 0);vg.displayName="FrameworkContext";function aS(){let t=j.useContext(vg);return yg(t,"You must render this element inside a <HydratedRouter> element"),t}function aR(t,e){let n=j.useContext(vg),[s,a]=j.useState(!1),[l,c]=j.useState(!1),{onFocus:d,onBlur:h,onMouseEnter:f,onMouseLeave:g,onTouchStart:p}=e,v=j.useRef(null);j.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let w=A=>{A.forEach(N=>{c(N.isIntersecting)})},S=new IntersectionObserver(w,{threshold:.5});return v.current&&S.observe(v.current),()=>{S.disconnect()}}},[t]),j.useEffect(()=>{if(s){let w=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(w)}}},[s]);let b=()=>{a(!0)},x=()=>{a(!1),c(!1)};return n?t!=="intent"?[l,v,{}]:[l,v,{onFocus:Jo(d,b),onBlur:Jo(h,x),onMouseEnter:Jo(f,b),onMouseLeave:Jo(g,x),onTouchStart:Jo(p,b)}]:[!1,v,{}]}function Jo(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function oR({page:t,...e}){let{router:n}=iS(),s=j.useMemo(()=>Xx(n.routes,t,n.basename),[n.routes,t,n.basename]);return s?j.createElement(cR,{page:t,matches:s,...e}):null}function lR(t){let{manifest:e,routeModules:n}=aS(),[s,a]=j.useState([]);return j.useEffect(()=>{let l=!1;return eR(t,e,n).then(c=>{l||a(c)}),()=>{l=!0}},[t,e,n]),s}function cR({page:t,matches:e,...n}){let s=Ci(),{manifest:a,routeModules:l}=aS(),{basename:c}=iS(),{loaderData:d,matches:h}=iR(),f=j.useMemo(()=>p_(t,e,h,a,s,"data"),[t,e,h,a,s]),g=j.useMemo(()=>p_(t,e,h,a,s,"assets"),[t,e,h,a,s]),p=j.useMemo(()=>{if(t===s.pathname+s.search+s.hash)return[];let x=new Set,w=!1;if(e.forEach(A=>{let N=a.routes[A.route.id];!N||!N.hasLoader||(!f.some(E=>E.route.id===A.route.id)&&A.route.id in d&&l[A.route.id]?.shouldRevalidate||N.hasClientLoader?w=!0:x.add(A.route.id))}),x.size===0)return[];let S=WO(t,c,"data");return w&&x.size>0&&S.searchParams.set("_routes",e.filter(A=>x.has(A.route.id)).map(A=>A.route.id).join(",")),[S.pathname+S.search]},[c,d,s,a,f,e,t,l]),v=j.useMemo(()=>tR(g,a),[g,a]),b=lR(g);return j.createElement(j.Fragment,null,p.map(x=>j.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...n})),v.map(x=>j.createElement("link",{key:x,rel:"modulepreload",href:x,...n})),b.map(({key:x,link:w})=>j.createElement("link",{key:x,nonce:n.nonce,...w})))}function uR(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var oS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{oS&&(window.__reactRouterVersion="7.9.5")}catch{}function dR({basename:t,children:e,window:n}){let s=j.useRef();s.current==null&&(s.current=ZN({window:n,v5Compat:!0}));let a=s.current,[l,c]=j.useState({action:a.action,location:a.location}),d=j.useCallback(h=>{j.startTransition(()=>c(h))},[c]);return j.useLayoutEffect(()=>a.listen(d),[a,d]),j.createElement(PO,{basename:t,children:e,location:l.location,navigationType:l.action,navigator:a})}var lS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,vi=j.forwardRef(function({onClick:e,discover:n="render",prefetch:s="none",relative:a,reloadDocument:l,replace:c,state:d,target:h,to:f,preventScrollReset:g,viewTransition:p,...v},b){let{basename:x}=j.useContext(hr),w=typeof f=="string"&&lS.test(f),S,A=!1;if(typeof f=="string"&&w&&(S=f,oS))try{let q=new URL(window.location.href),K=f.startsWith("//")?new URL(q.protocol+f):new URL(f),Y=Fr(K.pathname,x);K.origin===q.origin&&Y!=null?f=Y+K.search+K.hash:A=!0}catch{fr(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let N=AO(f,{relative:a}),[E,C,O]=aR(s,v),R=pR(f,{replace:c,state:d,target:h,preventScrollReset:g,relative:a,viewTransition:p});function M(q){e&&e(q),q.defaultPrevented||R(q)}let I=j.createElement("a",{...v,...O,href:S||N,onClick:A||l?e:M,ref:uR(b,C),target:h,"data-discover":!w&&n==="render"?"true":void 0});return E&&!w?j.createElement(j.Fragment,null,I,j.createElement(oR,{page:N})):I});vi.displayName="Link";var fR=j.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:s="",end:a=!1,style:l,to:c,viewTransition:d,children:h,...f},g){let p=Ql(c,{relative:f.relative}),v=Ci(),b=j.useContext(Qd),{navigator:x,basename:w}=j.useContext(hr),S=b!=null&&_R(p)&&d===!0,A=x.encodeLocation?x.encodeLocation(p).pathname:p.pathname,N=v.pathname,E=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;n||(N=N.toLowerCase(),E=E?E.toLowerCase():null,A=A.toLowerCase()),E&&w&&(E=Fr(E,w)||E);const C=A!=="/"&&A.endsWith("/")?A.length-1:A.length;let O=N===A||!a&&N.startsWith(A)&&N.charAt(C)==="/",R=E!=null&&(E===A||!a&&E.startsWith(A)&&E.charAt(A.length)==="/"),M={isActive:O,isPending:R,isTransitioning:S},I=O?e:void 0,q;typeof s=="function"?q=s(M):q=[s,O?"active":null,R?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let K=typeof l=="function"?l(M):l;return j.createElement(vi,{...f,"aria-current":I,className:q,ref:g,style:K,to:c,viewTransition:d},typeof h=="function"?h(M):h)});fR.displayName="NavLink";var hR=j.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:s,replace:a,state:l,method:c=ad,action:d,onSubmit:h,relative:f,preventScrollReset:g,viewTransition:p,...v},b)=>{let x=vR(),w=bR(d,{relative:f}),S=c.toLowerCase()==="get"?"get":"post",A=typeof d=="string"&&lS.test(d),N=E=>{if(h&&h(E),E.defaultPrevented)return;E.preventDefault();let C=E.nativeEvent.submitter,O=C?.getAttribute("formmethod")||c;x(C||E.currentTarget,{fetcherKey:e,method:O,navigate:n,replace:a,state:l,relative:f,preventScrollReset:g,viewTransition:p})};return j.createElement("form",{ref:b,method:S,action:w,onSubmit:s?h:N,...v,"data-discover":!A&&t==="render"?"true":void 0})});hR.displayName="Form";function mR(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function cS(t){let e=j.useContext(Xa);return dt(e,mR(t)),e}function pR(t,{target:e,replace:n,state:s,preventScrollReset:a,relative:l,viewTransition:c}={}){let d=$s(),h=Ci(),f=Ql(t,{relative:l});return j.useCallback(g=>{if(GO(g,e)){g.preventDefault();let p=n!==void 0?n:jl(h)===jl(f);d(t,{replace:p,state:s,preventScrollReset:a,relative:l,viewTransition:c})}},[h,d,f,n,s,e,t,a,l,c])}var gR=0,yR=()=>`__${String(++gR)}__`;function vR(){let{router:t}=cS("useSubmit"),{basename:e}=j.useContext(hr),n=IO();return j.useCallback(async(s,a={})=>{let{action:l,method:c,encType:d,formData:h,body:f}=QO(s,e);if(a.navigate===!1){let g=a.fetcherKey||yR();await t.fetch(g,n,a.action||l,{preventScrollReset:a.preventScrollReset,formData:h,body:f,formMethod:a.method||c,formEncType:a.encType||d,flushSync:a.flushSync})}else await t.navigate(a.action||l,{preventScrollReset:a.preventScrollReset,formData:h,body:f,formMethod:a.method||c,formEncType:a.encType||d,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,e,n])}function bR(t,{relative:e}={}){let{basename:n}=j.useContext(hr),s=j.useContext(Gr);dt(s,"useFormAction must be used inside a RouteContext");let[a]=s.matches.slice(-1),l={...Ql(t||".",{relative:e})},c=Ci();if(t==null){l.search=c.search;let d=new URLSearchParams(l.search),h=d.getAll("index");if(h.some(g=>g==="")){d.delete("index"),h.filter(p=>p).forEach(p=>d.append("index",p));let g=d.toString();l.search=g?`?${g}`:""}}return(!t||t===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(l.pathname=l.pathname==="/"?n:Vr([n,l.pathname])),jl(l)}function _R(t,{relative:e}={}){let n=j.useContext(eS);dt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=cS("useViewTransitionState"),a=Ql(t,{relative:e});if(!n.isTransitioning)return!1;let l=Fr(n.currentLocation.pathname,s)||n.currentLocation.pathname,c=Fr(n.nextLocation.pathname,s)||n.nextLocation.pathname;return Sd(a.pathname,c)!=null||Sd(a.pathname,l)!=null}Gx();var Cp=function(t,e){return Cp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(n[a]=s[a])},Cp(t,e)};function uS(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Cp(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Ed=function(){return Ed=Object.assign||function(e){for(var n,s=1,a=arguments.length;s<a;s++){n=arguments[s];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},Ed.apply(this,arguments)};function Ka(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a])&&(n[s[a]]=t[s[a]]);return n}function dS(t,e,n,s){var a=arguments.length,l=a<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,n):s,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(t,e,n,s);else for(var d=t.length-1;d>=0;d--)(c=t[d])&&(l=(a<3?c(l):a>3?c(e,n,l):c(e,n))||l);return a>3&&l&&Object.defineProperty(e,n,l),l}function fS(t,e){return function(n,s){e(n,s,t)}}function hS(t,e,n,s,a,l){function c(A){if(A!==void 0&&typeof A!="function")throw new TypeError("Function expected");return A}for(var d=s.kind,h=d==="getter"?"get":d==="setter"?"set":"value",f=!e&&t?s.static?t:t.prototype:null,g=e||(f?Object.getOwnPropertyDescriptor(f,s.name):{}),p,v=!1,b=n.length-1;b>=0;b--){var x={};for(var w in s)x[w]=w==="access"?{}:s[w];for(var w in s.access)x.access[w]=s.access[w];x.addInitializer=function(A){if(v)throw new TypeError("Cannot add initializers after decoration has completed");l.push(c(A||null))};var S=(0,n[b])(d==="accessor"?{get:g.get,set:g.set}:g[h],x);if(d==="accessor"){if(S===void 0)continue;if(S===null||typeof S!="object")throw new TypeError("Object expected");(p=c(S.get))&&(g.get=p),(p=c(S.set))&&(g.set=p),(p=c(S.init))&&a.unshift(p)}else(p=c(S))&&(d==="field"?a.unshift(p):g[h]=p)}f&&Object.defineProperty(f,s.name,g),v=!0}function mS(t,e,n){for(var s=arguments.length>2,a=0;a<e.length;a++)n=s?e[a].call(t,n):e[a].call(t);return s?n:void 0}function pS(t){return typeof t=="symbol"?t:"".concat(t)}function gS(t,e,n){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:n?"".concat(n," ",e):e})}function yS(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Te(t,e,n,s){function a(l){return l instanceof n?l:new n(function(c){c(l)})}return new(n||(n=Promise))(function(l,c){function d(g){try{f(s.next(g))}catch(p){c(p)}}function h(g){try{f(s.throw(g))}catch(p){c(p)}}function f(g){g.done?l(g.value):a(g.value).then(d,h)}f((s=s.apply(t,e||[])).next())})}function vS(t,e){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},s,a,l,c=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return c.next=d(0),c.throw=d(1),c.return=d(2),typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function d(f){return function(g){return h([f,g])}}function h(f){if(s)throw new TypeError("Generator is already executing.");for(;c&&(c=0,f[0]&&(n=0)),n;)try{if(s=1,a&&(l=f[0]&2?a.return:f[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,f[1])).done)return l;switch(a=0,l&&(f=[f[0]&2,l.value]),f[0]){case 0:case 1:l=f;break;case 4:return n.label++,{value:f[1],done:!1};case 5:n.label++,a=f[1],f=[0];continue;case 7:f=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(f[0]===6||f[0]===2)){n=0;continue}if(f[0]===3&&(!l||f[1]>l[0]&&f[1]<l[3])){n.label=f[1];break}if(f[0]===6&&n.label<l[1]){n.label=l[1],l=f;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(f);break}l[2]&&n.ops.pop(),n.trys.pop();continue}f=e.call(t,n)}catch(g){f=[6,g],a=0}finally{s=l=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}var Jd=Object.create?(function(t,e,n,s){s===void 0&&(s=n);var a=Object.getOwnPropertyDescriptor(e,n);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,s,a)}):(function(t,e,n,s){s===void 0&&(s=n),t[s]=e[n]});function bS(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&Jd(e,t,n)}function Cd(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],s=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&s>=t.length&&(t=void 0),{value:t&&t[s++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function bg(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var s=n.call(t),a,l=[],c;try{for(;(e===void 0||e-- >0)&&!(a=s.next()).done;)l.push(a.value)}catch(d){c={error:d}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(c)throw c.error}}return l}function _S(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(bg(arguments[e]));return t}function wS(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var s=Array(t),a=0,e=0;e<n;e++)for(var l=arguments[e],c=0,d=l.length;c<d;c++,a++)s[a]=l[c];return s}function xS(t,e,n){if(n||arguments.length===2)for(var s=0,a=e.length,l;s<a;s++)(l||!(s in e))&&(l||(l=Array.prototype.slice.call(e,0,s)),l[s]=e[s]);return t.concat(l||Array.prototype.slice.call(e))}function za(t){return this instanceof za?(this.v=t,this):new za(t)}function SS(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=n.apply(t,e||[]),a,l=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",c),a[Symbol.asyncIterator]=function(){return this},a;function c(b){return function(x){return Promise.resolve(x).then(b,p)}}function d(b,x){s[b]&&(a[b]=function(w){return new Promise(function(S,A){l.push([b,w,S,A])>1||h(b,w)})},x&&(a[b]=x(a[b])))}function h(b,x){try{f(s[b](x))}catch(w){v(l[0][3],w)}}function f(b){b.value instanceof za?Promise.resolve(b.value.v).then(g,p):v(l[0][2],b)}function g(b){h("next",b)}function p(b){h("throw",b)}function v(b,x){b(x),l.shift(),l.length&&h(l[0][0],l[0][1])}}function ES(t){var e,n;return e={},s("next"),s("throw",function(a){throw a}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(a,l){e[a]=t[a]?function(c){return(n=!n)?{value:za(t[a](c)),done:!1}:l?l(c):c}:l}}function CS(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Cd=="function"?Cd(t):t[Symbol.iterator](),n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n);function s(l){n[l]=t[l]&&function(c){return new Promise(function(d,h){c=t[l](c),a(d,h,c.done,c.value)})}}function a(l,c,d,h){Promise.resolve(h).then(function(f){l({value:f,done:d})},c)}}function AS(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var wR=Object.create?(function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}):function(t,e){t.default=e},Ap=function(t){return Ap=Object.getOwnPropertyNames||function(e){var n=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(n[n.length]=s);return n},Ap(t)};function TS(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n=Ap(t),s=0;s<n.length;s++)n[s]!=="default"&&Jd(e,t,n[s]);return wR(e,t),e}function NS(t){return t&&t.__esModule?t:{default:t}}function OS(t,e,n,s){if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?s:n==="a"?s.call(t):s?s.value:e.get(t)}function RS(t,e,n,s,a){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?a.call(t,n):a?a.value=n:e.set(t,n),n}function jS(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function kS(t,e,n){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var s,a;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=e[Symbol.asyncDispose]}if(s===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=e[Symbol.dispose],n&&(a=s)}if(typeof s!="function")throw new TypeError("Object not disposable.");a&&(s=function(){try{a.call(this)}catch(l){return Promise.reject(l)}}),t.stack.push({value:e,dispose:s,async:n})}else n&&t.stack.push({async:!0});return e}var xR=typeof SuppressedError=="function"?SuppressedError:function(t,e,n){var s=new Error(n);return s.name="SuppressedError",s.error=t,s.suppressed=e,s};function MS(t){function e(l){t.error=t.hasError?new xR(l,t.error,"An error was suppressed during disposal."):l,t.hasError=!0}var n,s=0;function a(){for(;n=t.stack.pop();)try{if(!n.async&&s===1)return s=0,t.stack.push(n),Promise.resolve().then(a);if(n.dispose){var l=n.dispose.call(n.value);if(n.async)return s|=2,Promise.resolve(l).then(a,function(c){return e(c),a()})}else s|=1}catch(c){e(c)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return a()}function DS(t,e){return typeof t=="string"&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(n,s,a,l,c){return s?e?".jsx":".js":a&&(!l||!c)?n:a+l+"."+c.toLowerCase()+"js"}):t}const SR={__extends:uS,__assign:Ed,__rest:Ka,__decorate:dS,__param:fS,__esDecorate:hS,__runInitializers:mS,__propKey:pS,__setFunctionName:gS,__metadata:yS,__awaiter:Te,__generator:vS,__createBinding:Jd,__exportStar:bS,__values:Cd,__read:bg,__spread:_S,__spreadArrays:wS,__spreadArray:xS,__await:za,__asyncGenerator:SS,__asyncDelegator:ES,__asyncValues:CS,__makeTemplateObject:AS,__importStar:TS,__importDefault:NS,__classPrivateFieldGet:OS,__classPrivateFieldSet:RS,__classPrivateFieldIn:jS,__addDisposableResource:kS,__disposeResources:MS,__rewriteRelativeImportExtension:DS},ER=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:kS,get __assign(){return Ed},__asyncDelegator:ES,__asyncGenerator:SS,__asyncValues:CS,__await:za,__awaiter:Te,__classPrivateFieldGet:OS,__classPrivateFieldIn:jS,__classPrivateFieldSet:RS,__createBinding:Jd,__decorate:dS,__disposeResources:MS,__esDecorate:hS,__exportStar:bS,__extends:uS,__generator:vS,__importDefault:NS,__importStar:TS,__makeTemplateObject:AS,__metadata:yS,__param:fS,__propKey:pS,__read:bg,__rest:Ka,__rewriteRelativeImportExtension:DS,__runInitializers:mS,__setFunctionName:gS,__spread:_S,__spreadArray:xS,__spreadArrays:wS,__values:Cd,default:SR},Symbol.toStringTag,{value:"Module"})),CR=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class _g extends Error{constructor(e,n="FunctionsError",s){super(e),this.name=n,this.context=s}}class g_ extends _g{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class y_ extends _g{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class v_ extends _g{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Tp;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Tp||(Tp={}));class AR{constructor(e,{headers:n={},customFetch:s,region:a=Tp.Any}={}){this.url=e,this.headers=n,this.region=a,this.fetch=CR(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Te(this,arguments,void 0,function*(n,s={}){var a;try{const{headers:l,method:c,body:d,signal:h}=s;let f={},{region:g}=s;g||(g=this.region);const p=new URL(`${this.url}/${n}`);g&&g!=="any"&&(f["x-region"]=g,p.searchParams.set("forceFunctionRegion",g));let v;d&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",v=d):typeof d=="string"?(f["Content-Type"]="text/plain",v=d):typeof FormData<"u"&&d instanceof FormData?v=d:(f["Content-Type"]="application/json",v=JSON.stringify(d)):v=d;const b=yield this.fetch(p.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),l),body:v,signal:h}).catch(A=>{throw A.name==="AbortError"?A:new g_(A)}),x=b.headers.get("x-relay-error");if(x&&x==="true")throw new y_(b);if(!b.ok)throw new v_(b);let w=((a=b.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),S;return w==="application/json"?S=yield b.json():w==="application/octet-stream"||w==="application/pdf"?S=yield b.blob():w==="text/event-stream"?S=b:w==="multipart/form-data"?S=yield b.formData():S=yield b.text(),{data:S,error:null,response:b}}catch(l){return l instanceof Error&&l.name==="AbortError"?{data:null,error:new g_(l)}:{data:null,error:l,response:l instanceof v_||l instanceof y_?l.context:void 0}}})}}var Yt={};const Qa=Yx(ER);var ku={},Mu={},Du={},Uu={},$u={},Iu={},b_;function US(){if(b_)return Iu;b_=1,Object.defineProperty(Iu,"__esModule",{value:!0});class t extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return Iu.default=t,Iu}var __;function $S(){if(__)return $u;__=1,Object.defineProperty($u,"__esModule",{value:!0});const e=Qa.__importDefault(US());class n{constructor(a){var l,c;this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=new Headers(a.headers),this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=(l=a.shouldThrowOnError)!==null&&l!==void 0?l:!1,this.signal=a.signal,this.isMaybeSingle=(c=a.isMaybeSingle)!==null&&c!==void 0?c:!1,a.fetch?this.fetch=a.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,l){return this.headers=new Headers(this.headers),this.headers.set(a,l),this}then(a,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const c=this.fetch;let d=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async h=>{var f,g,p,v;let b=null,x=null,w=null,S=h.status,A=h.statusText;if(h.ok){if(this.method!=="HEAD"){const O=await h.text();O===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((f=this.headers.get("Accept"))===null||f===void 0)&&f.includes("application/vnd.pgrst.plan+text"))?x=O:x=JSON.parse(O))}const E=(g=this.headers.get("Prefer"))===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),C=(p=h.headers.get("content-range"))===null||p===void 0?void 0:p.split("/");E&&C&&C.length>1&&(w=parseInt(C[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(x)&&(x.length>1?(b={code:"PGRST116",details:`Results contain ${x.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},x=null,w=null,S=406,A="Not Acceptable"):x.length===1?x=x[0]:x=null)}else{const E=await h.text();try{b=JSON.parse(E),Array.isArray(b)&&h.status===404&&(x=[],b=null,S=200,A="OK")}catch{h.status===404&&E===""?(S=204,A="No Content"):b={message:E}}if(b&&this.isMaybeSingle&&(!((v=b?.details)===null||v===void 0)&&v.includes("0 rows"))&&(b=null,S=200,A="OK"),b&&this.shouldThrowOnError)throw new e.default(b)}return{error:b,data:x,count:w,status:S,statusText:A}});return this.shouldThrowOnError||(d=d.catch(h=>{var f,g,p;return{error:{message:`${(f=h?.name)!==null&&f!==void 0?f:"FetchError"}: ${h?.message}`,details:`${(g=h?.stack)!==null&&g!==void 0?g:""}`,hint:"",code:`${(p=h?.code)!==null&&p!==void 0?p:""}`},data:null,count:null,status:0,statusText:""}})),d.then(a,l)}returns(){return this}overrideTypes(){return this}}return $u.default=n,$u}var w_;function IS(){if(w_)return Uu;w_=1,Object.defineProperty(Uu,"__esModule",{value:!0});const e=Qa.__importDefault($S());class n extends e.default{select(a){let l=!1;const c=(a??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:l=!0,nullsFirst:c,foreignTable:d,referencedTable:h=d}={}){const f=h?`${h}.order`:"order",g=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${g?`${g},`:""}${a}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:l,referencedTable:c=l}={}){const d=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${a}`),this}range(a,l,{foreignTable:c,referencedTable:d=c}={}){const h=typeof d>"u"?"offset":`${d}.offset`,f=typeof d>"u"?"limit":`${d}.limit`;return this.url.searchParams.set(h,`${a}`),this.url.searchParams.set(f,`${l-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:l=!1,settings:c=!1,buffers:d=!1,wal:h=!1,format:f="text"}={}){var g;const p=[a?"analyze":null,l?"verbose":null,c?"settings":null,d?"buffers":null,h?"wal":null].filter(Boolean).join("|"),v=(g=this.headers.get("Accept"))!==null&&g!==void 0?g:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${f}; for="${v}"; options=${p};`),f==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}}return Uu.default=n,Uu}var x_;function wg(){if(x_)return Du;x_=1,Object.defineProperty(Du,"__esModule",{value:!0});const e=Qa.__importDefault(IS()),n=new RegExp("[,()]");class s extends e.default{eq(l,c){return this.url.searchParams.append(l,`eq.${c}`),this}neq(l,c){return this.url.searchParams.append(l,`neq.${c}`),this}gt(l,c){return this.url.searchParams.append(l,`gt.${c}`),this}gte(l,c){return this.url.searchParams.append(l,`gte.${c}`),this}lt(l,c){return this.url.searchParams.append(l,`lt.${c}`),this}lte(l,c){return this.url.searchParams.append(l,`lte.${c}`),this}like(l,c){return this.url.searchParams.append(l,`like.${c}`),this}likeAllOf(l,c){return this.url.searchParams.append(l,`like(all).{${c.join(",")}}`),this}likeAnyOf(l,c){return this.url.searchParams.append(l,`like(any).{${c.join(",")}}`),this}ilike(l,c){return this.url.searchParams.append(l,`ilike.${c}`),this}ilikeAllOf(l,c){return this.url.searchParams.append(l,`ilike(all).{${c.join(",")}}`),this}ilikeAnyOf(l,c){return this.url.searchParams.append(l,`ilike(any).{${c.join(",")}}`),this}is(l,c){return this.url.searchParams.append(l,`is.${c}`),this}in(l,c){const d=Array.from(new Set(c)).map(h=>typeof h=="string"&&n.test(h)?`"${h}"`:`${h}`).join(",");return this.url.searchParams.append(l,`in.(${d})`),this}contains(l,c){return typeof c=="string"?this.url.searchParams.append(l,`cs.${c}`):Array.isArray(c)?this.url.searchParams.append(l,`cs.{${c.join(",")}}`):this.url.searchParams.append(l,`cs.${JSON.stringify(c)}`),this}containedBy(l,c){return typeof c=="string"?this.url.searchParams.append(l,`cd.${c}`):Array.isArray(c)?this.url.searchParams.append(l,`cd.{${c.join(",")}}`):this.url.searchParams.append(l,`cd.${JSON.stringify(c)}`),this}rangeGt(l,c){return this.url.searchParams.append(l,`sr.${c}`),this}rangeGte(l,c){return this.url.searchParams.append(l,`nxl.${c}`),this}rangeLt(l,c){return this.url.searchParams.append(l,`sl.${c}`),this}rangeLte(l,c){return this.url.searchParams.append(l,`nxr.${c}`),this}rangeAdjacent(l,c){return this.url.searchParams.append(l,`adj.${c}`),this}overlaps(l,c){return typeof c=="string"?this.url.searchParams.append(l,`ov.${c}`):this.url.searchParams.append(l,`ov.{${c.join(",")}}`),this}textSearch(l,c,{config:d,type:h}={}){let f="";h==="plain"?f="pl":h==="phrase"?f="ph":h==="websearch"&&(f="w");const g=d===void 0?"":`(${d})`;return this.url.searchParams.append(l,`${f}fts${g}.${c}`),this}match(l){return Object.entries(l).forEach(([c,d])=>{this.url.searchParams.append(c,`eq.${d}`)}),this}not(l,c,d){return this.url.searchParams.append(l,`not.${c}.${d}`),this}or(l,{foreignTable:c,referencedTable:d=c}={}){const h=d?`${d}.or`:"or";return this.url.searchParams.append(h,`(${l})`),this}filter(l,c,d){return this.url.searchParams.append(l,`${c}.${d}`),this}}return Du.default=s,Du}var S_;function LS(){if(S_)return Mu;S_=1,Object.defineProperty(Mu,"__esModule",{value:!0});const e=Qa.__importDefault(wg());class n{constructor(a,{headers:l={},schema:c,fetch:d}){this.url=a,this.headers=new Headers(l),this.schema=c,this.fetch=d}select(a,l){const{head:c=!1,count:d}=l??{},h=c?"HEAD":"GET";let f=!1;const g=(a??"*").split("").map(p=>/\s/.test(p)&&!f?"":(p==='"'&&(f=!f),p)).join("");return this.url.searchParams.set("select",g),d&&this.headers.append("Prefer",`count=${d}`),new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:l,defaultToNull:c=!0}={}){var d;const h="POST";if(l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const f=a.reduce((g,p)=>g.concat(Object.keys(p)),[]);if(f.length>0){const g=[...new Set(f)].map(p=>`"${p}"`);this.url.searchParams.set("columns",g.join(","))}}return new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}upsert(a,{onConflict:l,ignoreDuplicates:c=!1,count:d,defaultToNull:h=!0}={}){var f;const g="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),d&&this.headers.append("Prefer",`count=${d}`),h||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const p=a.reduce((v,b)=>v.concat(Object.keys(b)),[]);if(p.length>0){const v=[...new Set(p)].map(b=>`"${b}"`);this.url.searchParams.set("columns",v.join(","))}}return new e.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}update(a,{count:l}={}){var c;const d="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:a}={}){var l;const c="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return Mu.default=n,Mu}var E_;function TR(){if(E_)return ku;E_=1,Object.defineProperty(ku,"__esModule",{value:!0});const t=Qa,e=t.__importDefault(LS()),n=t.__importDefault(wg());class s{constructor(l,{headers:c={},schema:d,fetch:h}={}){this.url=l,this.headers=new Headers(c),this.schemaName=d,this.fetch=h}from(l){const c=new URL(`${this.url}/${l}`);return new e.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new s(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:d=!1,get:h=!1,count:f}={}){var g;let p;const v=new URL(`${this.url}/rpc/${l}`);let b;d||h?(p=d?"HEAD":"GET",Object.entries(c).filter(([w,S])=>S!==void 0).map(([w,S])=>[w,Array.isArray(S)?`{${S.join(",")}}`:`${S}`]).forEach(([w,S])=>{v.searchParams.append(w,S)})):(p="POST",b=c);const x=new Headers(this.headers);return f&&x.set("Prefer",`count=${f}`),new n.default({method:p,url:v,headers:x,schema:this.schemaName,body:b,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}}return ku.default=s,ku}var C_;function NR(){if(C_)return Yt;C_=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.PostgrestError=Yt.PostgrestBuilder=Yt.PostgrestTransformBuilder=Yt.PostgrestFilterBuilder=Yt.PostgrestQueryBuilder=Yt.PostgrestClient=void 0;const t=Qa,e=t.__importDefault(TR());Yt.PostgrestClient=e.default;const n=t.__importDefault(LS());Yt.PostgrestQueryBuilder=n.default;const s=t.__importDefault(wg());Yt.PostgrestFilterBuilder=s.default;const a=t.__importDefault(IS());Yt.PostgrestTransformBuilder=a.default;const l=t.__importDefault($S());Yt.PostgrestBuilder=l.default;const c=t.__importDefault(US());return Yt.PostgrestError=c.default,Yt.default={PostgrestClient:e.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:l.default,PostgrestError:c.default},Yt}var zS=NR();const BS=Kd(zS),OR=qN({__proto__:null,default:BS},[zS]),{PostgrestClient:RR,PostgrestQueryBuilder:y4,PostgrestFilterBuilder:v4,PostgrestTransformBuilder:b4,PostgrestBuilder:_4,PostgrestError:w4}=BS||OR;class jR{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const s=n.node,a=parseInt(s.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const s=this.getWebSocketConstructor();return new s(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const kR="2.79.0",MR=`realtime-js/${kR}`,DR="1.0.0",Np=1e4,UR=1e3,$R=100;var xl;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(xl||(xl={}));var Rt;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Rt||(Rt={}));var Xn;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Xn||(Xn={}));var Op;(function(t){t.websocket="websocket"})(Op||(Op={}));var di;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(di||(di={}));class IR{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,n,s)}_decodeBroadcast(e,n,s){const a=n.getUint8(1),l=n.getUint8(2);let c=this.HEADER_LENGTH+2;const d=s.decode(e.slice(c,c+a));c=c+a;const h=s.decode(e.slice(c,c+l));c=c+l;const f=JSON.parse(s.decode(e.slice(c,e.byteLength)));return{ref:null,topic:d,event:h,payload:f}}}let PS=class{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var st;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(st||(st={}));const A_=(t,e,n={})=>{var s;const a=(s=n.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((l,c)=>(l[c]=LR(c,t,e,a),l),{}):{}},LR=(t,e,n,s)=>{const a=e.find(d=>d.name===t),l=a?.type,c=n[t];return l&&!s.includes(l)?qS(l,c):Rp(c)},qS=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return qR(e,n)}switch(t){case st.bool:return zR(e);case st.float4:case st.float8:case st.int2:case st.int4:case st.int8:case st.numeric:case st.oid:return BR(e);case st.json:case st.jsonb:return PR(e);case st.timestamp:return HR(e);case st.abstime:case st.date:case st.daterange:case st.int4range:case st.int8range:case st.money:case st.reltime:case st.text:case st.time:case st.timestamptz:case st.timetz:case st.tsrange:case st.tstzrange:return Rp(e);default:return Rp(e)}},Rp=t=>t,zR=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},BR=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},PR=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},qR=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,s=t[n];if(t[0]==="{"&&s==="}"){let l;const c=t.slice(1,n);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(d=>qS(e,d))}return t},HR=t=>typeof t=="string"?t.replace(" ","T"):t,HS=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Fm{constructor(e,n,s={},a=Np){this.channel=e,this.event=n,this.payload=s,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var s;return this._hasReceived(e)&&n((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var T_;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(T_||(T_={}));class Sl{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=n?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},a=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Sl.syncState(this.state,a,l,c),this.pendingDiffs.forEach(h=>{this.state=Sl.syncDiff(this.state,h,l,c)}),this.pendingDiffs=[],d()}),this.channel._on(s.diff,{},a=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Sl.syncDiff(this.state,a,l,c),d())}),this.onJoin((a,l,c)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:l,newPresences:c})}),this.onLeave((a,l,c)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,s,a){const l=this.cloneDeep(e),c=this.transformState(n),d={},h={};return this.map(l,(f,g)=>{c[f]||(h[f]=g)}),this.map(c,(f,g)=>{const p=l[f];if(p){const v=g.map(S=>S.presence_ref),b=p.map(S=>S.presence_ref),x=g.filter(S=>b.indexOf(S.presence_ref)<0),w=p.filter(S=>v.indexOf(S.presence_ref)<0);x.length>0&&(d[f]=x),w.length>0&&(h[f]=w)}else d[f]=g}),this.syncDiff(l,{joins:d,leaves:h},s,a)}static syncDiff(e,n,s,a){const{joins:l,leaves:c}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return s||(s=()=>{}),a||(a=()=>{}),this.map(l,(d,h)=>{var f;const g=(f=e[d])!==null&&f!==void 0?f:[];if(e[d]=this.cloneDeep(h),g.length>0){const p=e[d].map(b=>b.presence_ref),v=g.filter(b=>p.indexOf(b.presence_ref)<0);e[d].unshift(...v)}s(d,g,h)}),this.map(c,(d,h)=>{let f=e[d];if(!f)return;const g=h.map(p=>p.presence_ref);f=f.filter(p=>g.indexOf(p.presence_ref)<0),e[d]=f,a(d,f,h),f.length===0&&delete e[d]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(s=>n(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,s)=>{const a=e[s];return"metas"in a?n[s]=a.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):n[s]=a,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var N_;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(N_||(N_={}));var El;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(El||(El={}));var qr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(qr||(qr={}));class xg{constructor(e,n={config:{}},s){var a,l;if(this.topic=e,this.params=n,this.socket=s,this.bindings={},this.state=Rt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Fm(this,Xn.join,this.params,this.timeout),this.rejoinTimer=new PS(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Rt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Rt.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=Rt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Rt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=Rt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Xn.reply,{},(c,d)=>{this._trigger(this._replyEventName(d),c)}),this.presence=new Sl(this),this.broadcastEndpointURL=HS(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,n=this.timeout){var s,a,l;if(this.socket.isConnected()||this.socket.connect(),this.state==Rt.closed){const{config:{broadcast:c,presence:d,private:h}}=this.params,f=(a=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(b=>b.filter))!==null&&a!==void 0?a:[],g=!!this.bindings[El.PRESENCE]&&this.bindings[El.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,p={},v={broadcast:c,presence:Object.assign(Object.assign({},d),{enabled:g}),postgres_changes:f,private:h};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(b=>e?.(qr.CHANNEL_ERROR,b)),this._onClose(()=>e?.(qr.CLOSED)),this.updateJoinPayload(Object.assign({config:v},p)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:b})=>{var x;if(this.socket.setAuth(),b===void 0){e?.(qr.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,S=(x=w?.length)!==null&&x!==void 0?x:0,A=[];for(let N=0;N<S;N++){const E=w[N],{filter:{event:C,schema:O,table:R,filter:M}}=E,I=b&&b[N];if(I&&I.event===C&&I.schema===O&&I.table===R&&I.filter===M)A.push(Object.assign(Object.assign({},E),{id:I.id}));else{this.unsubscribe(),this.state=Rt.errored,e?.(qr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=A,e&&e(qr.SUBSCRIBED);return}}).receive("error",b=>{this.state=Rt.errored,e?.(qr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{e?.(qr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,s){return this.state===Rt.joined&&e===El.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,n,s)}async httpSend(e,n,s={}){var a;const l=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(n==null)return Promise.reject("Payload is required for httpSend()");const c={method:"POST",headers:{Authorization:l,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:n,private:this.private}]})},d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(a=s.timeout)!==null&&a!==void 0?a:this.timeout);if(d.status===202)return{success:!0};let h=d.statusText;try{const f=await d.json();h=f.error||f.message||h}catch{}return Promise.reject(new Error(h))}async send(e,n={}){var s,a;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:c}=e,h={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);return await((a=f.body)===null||a===void 0?void 0:a.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,d,h;const f=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((h=(d=(c=this.params)===null||c===void 0?void 0:c.config)===null||d===void 0?void 0:d.broadcast)===null||h===void 0)&&h.ack)&&l("ok"),f.receive("ok",()=>l("ok")),f.receive("error",()=>l("error")),f.receive("timeout",()=>l("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Rt.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Xn.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(a=>{s=new Fm(this,Xn.leave,{},e),s.receive("ok",()=>{n(),a("ok")}).receive("timeout",()=>{n(),a("timed out")}).receive("error",()=>{a("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Rt.closed,this.bindings={}}async _fetchWithTimeout(e,n,s){const a=new AbortController,l=setTimeout(()=>a.abort(),s),c=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:a.signal}));return clearTimeout(l),c}_push(e,n,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Fm(this,e,n,s);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>$R){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,s){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,s){var a,l;const c=e.toLocaleLowerCase(),{close:d,error:h,leave:f,join:g}=Xn;if(s&&[d,h,f,g].indexOf(c)>=0&&s!==this._joinRef())return;let v=this._onMessage(c,n,s);if(n&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(b=>{var x,w,S;return((x=b.filter)===null||x===void 0?void 0:x.event)==="*"||((S=(w=b.filter)===null||w===void 0?void 0:w.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===c}).map(b=>b.callback(v,s)):(l=this.bindings[c])===null||l===void 0||l.filter(b=>{var x,w,S,A,N,E;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in b){const C=b.id,O=(x=b.filter)===null||x===void 0?void 0:x.event;return C&&((w=n.ids)===null||w===void 0?void 0:w.includes(C))&&(O==="*"||O?.toLocaleLowerCase()===((S=n.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const C=(N=(A=b?.filter)===null||A===void 0?void 0:A.event)===null||N===void 0?void 0:N.toLocaleLowerCase();return C==="*"||C===((E=n?.event)===null||E===void 0?void 0:E.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===c}).map(b=>{if(typeof v=="object"&&"ids"in v){const x=v.data,{schema:w,table:S,commit_timestamp:A,type:N,errors:E}=x;v=Object.assign(Object.assign({},{schema:w,table:S,commit_timestamp:A,eventType:N,new:{},old:{},errors:E}),this._getPayloadRecords(x))}b.callback(v,s)})}_isClosed(){return this.state===Rt.closed}_isJoined(){return this.state===Rt.joined}_isJoining(){return this.state===Rt.joining}_isLeaving(){return this.state===Rt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,s){const a=e.toLocaleLowerCase(),l={type:a,filter:n,callback:s};return this.bindings[a]?this.bindings[a].push(l):this.bindings[a]=[l],this}_off(e,n){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(a=>{var l;return!(((l=a.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===s&&xg.isEqual(a.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const s in e)if(e[s]!==n[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Xn.close,{},e)}_onError(e){this._on(Xn.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Rt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=A_(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=A_(e.columns,e.old_record)),n}}const Ym=()=>{},Lu={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},VR=[1e3,2e3,5e3,1e4],FR=1e4,YR=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class GR{constructor(e,n){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Np,this.transport=null,this.heartbeatIntervalMs=Lu.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ym,this.ref=0,this.reconnectTimer=null,this.logger=Ym,this.conn=null,this.sendBuffer=[],this.serializer=new IR,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>a?(...l)=>a(...l):(...l)=>fetch(...l),!(!((s=n?.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${Op.websocket}`,this.httpEndpoint=HS(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=jR.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:DR}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},e?this.conn.close(e,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,s){this.logger(e,n,s)}connectionState(){switch(this.conn&&this.conn.readyState){case xl.connecting:return di.Connecting;case xl.open:return di.Open;case xl.closing:return di.Closing;default:return di.Closed}}isConnected(){return this.connectionState()===di.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const s=`realtime:${e}`,a=this.getChannels().find(l=>l.topic===s);if(a)return a;{const l=new xg(`realtime:${e}`,n,this);return this.channels.push(l),l}}push(e){const{topic:n,event:s,payload:a,ref:l}=e,c=()=>{this.encode(e,d=>{var h;(h=this.conn)===null||h===void 0||h.send(d)})};this.log("push",`${n} ${s} (${l})`,a),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(UR,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Lu.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(f){this.log("error","error in heartbeat callback",f)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:a,payload:l,ref:c}=n,d=c?`(${c})`:"",h=l.status||"";this.log("receive",`${h} ${s} ${a} ${d}`.trim(),l),this.channels.filter(f=>f._isMember(s)).forEach(f=>f._trigger(a,l,c)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Xn.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const s=e.match(/\?/)?"&":"?",a=new URLSearchParams(n);return`${e}${s}${a}`}_workerObjectUrl(e){let n;if(e)n=e;else{const s=new Blob([YR],{type:"application/javascript"});n=URL.createObjectURL(s)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n;e?n=e:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(s=>{const a={access_token:n,version:MR};n&&s.updateJoinPayload(a),s.joinedOnce&&s._isJoined()&&s._push(Xn.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(n)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new PS(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Lu.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,s,a,l,c,d,h,f,g;if(this.transport=(n=e?.transport)!==null&&n!==void 0?n:null,this.timeout=(s=e?.timeout)!==null&&s!==void 0?s:Np,this.heartbeatIntervalMs=(a=e?.heartbeatIntervalMs)!==null&&a!==void 0?a:Lu.HEARTBEAT_INTERVAL,this.worker=(l=e?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=e?.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(d=e?.heartbeatCallback)!==null&&d!==void 0?d:Ym,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=e?.reconnectAfterMs)!==null&&h!==void 0?h:(p=>VR[p-1]||FR),this.encode=(f=e?.encode)!==null&&f!==void 0?f:((p,v)=>v(JSON.stringify(p))),this.decode=(g=e?.decode)!==null&&g!==void 0?g:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class Sg extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ut(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class XR extends Sg{constructor(e,n,s){super(e),this.name="StorageApiError",this.status=n,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class jp extends Sg{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}const Eg=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),KR=()=>Response,kp=t=>{if(Array.isArray(t))return t.map(n=>kp(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,s])=>{const a=n.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));e[a]=kp(s)}),e},QR=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Gm=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},WR=(t,e,n)=>Te(void 0,void 0,void 0,function*(){const s=yield KR();t instanceof s&&!n?.noResolveJson?t.json().then(a=>{const l=t.status||500,c=a?.statusCode||l+"";e(new XR(Gm(a),l,c))}).catch(a=>{e(new jp(Gm(a),a))}):e(new jp(Gm(t),t))}),JR=(t,e,n,s)=>{const a={method:t,headers:e?.headers||{}};return t==="GET"||!s?a:(QR(s)?(a.headers=Object.assign({"Content-Type":"application/json"},e?.headers),a.body=JSON.stringify(s)):a.body=s,e?.duplex&&(a.duplex=e.duplex),Object.assign(Object.assign({},a),n))};function Wl(t,e,n,s,a,l){return Te(this,void 0,void 0,function*(){return new Promise((c,d)=>{t(n,JR(e,s,a,l)).then(h=>{if(!h.ok)throw h;return s?.noResolveJson?h:h.json()}).then(h=>c(h)).catch(h=>WR(h,d,s))})})}function kl(t,e,n,s){return Te(this,void 0,void 0,function*(){return Wl(t,"GET",e,n,s)})}function Yn(t,e,n,s,a){return Te(this,void 0,void 0,function*(){return Wl(t,"POST",e,s,a,n)})}function Mp(t,e,n,s,a){return Te(this,void 0,void 0,function*(){return Wl(t,"PUT",e,s,a,n)})}function ZR(t,e,n,s){return Te(this,void 0,void 0,function*(){return Wl(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),s)})}function Cg(t,e,n,s,a){return Te(this,void 0,void 0,function*(){return Wl(t,"DELETE",e,s,a,n)})}class ej{constructor(e,n){this.downloadFn=e,this.shouldThrowOnError=n}then(e,n){return this.execute().then(e,n)}execute(){return Te(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ut(e))return{data:null,error:e};throw e}})}}var VS;class tj{constructor(e,n){this.downloadFn=e,this.shouldThrowOnError=n,this[VS]="BlobDownloadBuilder",this.promise=null}asStream(){return new ej(this.downloadFn,this.shouldThrowOnError)}then(e,n){return this.getPromise().then(e,n)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Te(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ut(e))return{data:null,error:e};throw e}})}}VS=Symbol.toStringTag;const nj={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},O_={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class rj{constructor(e,n={},s,a){this.shouldThrowOnError=!1,this.url=e,this.headers=n,this.bucketId=s,this.fetch=Eg(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,n,s,a){return Te(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},O_),a);let d=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const h=c.metadata;typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),h&&l.append("metadata",this.encodeMetadata(h)),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.has("cacheControl")||l.append("cacheControl",c.cacheControl),h&&!l.has("metadata")&&l.append("metadata",this.encodeMetadata(h))):(l=s,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType,h&&(d["x-metadata"]=this.toBase64(this.encodeMetadata(h))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!c.duplex&&(c.duplex="half")),a?.headers&&(d=Object.assign(Object.assign({},d),a.headers));const f=this._removeEmptyFolders(n),g=this._getFinalPath(f),p=yield(e=="PUT"?Mp:Yn)(this.fetch,`${this.url}/object/${g}`,l,Object.assign({headers:d},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:f,id:p.Id,fullPath:p.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ut(l))return{data:null,error:l};throw l}})}upload(e,n,s){return Te(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,s)})}uploadToSignedUrl(e,n,s,a){return Te(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(e),c=this._getFinalPath(l),d=new URL(this.url+`/object/upload/sign/${c}`);d.searchParams.set("token",n);try{let h;const f=Object.assign({upsert:O_.upsert},a),g=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&s instanceof Blob?(h=new FormData,h.append("cacheControl",f.cacheControl),h.append("",s)):typeof FormData<"u"&&s instanceof FormData?(h=s,h.append("cacheControl",f.cacheControl)):(h=s,g["cache-control"]=`max-age=${f.cacheControl}`,g["content-type"]=f.contentType);const p=yield Mp(this.fetch,d.toString(),h,{headers:g});return{data:{path:l,fullPath:p.Key},error:null}}catch(h){if(this.shouldThrowOnError)throw h;if(ut(h))return{data:null,error:h};throw h}})}createSignedUploadUrl(e,n){return Te(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const a=Object.assign({},this.headers);n?.upsert&&(a["x-upsert"]="true");const l=yield Yn(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:a}),c=new URL(this.url+l.url),d=c.searchParams.get("token");if(!d)throw new Sg("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:d},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ut(s))return{data:null,error:s};throw s}})}update(e,n,s){return Te(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,s)})}move(e,n,s){return Te(this,void 0,void 0,function*(){try{return{data:yield Yn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:s?.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ut(a))return{data:null,error:a};throw a}})}copy(e,n,s){return Te(this,void 0,void 0,function*(){try{return{data:{path:(yield Yn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:s?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ut(a))return{data:null,error:a};throw a}})}createSignedUrl(e,n,s){return Te(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),l=yield Yn(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:n},s?.transform?{transform:s.transform}:{}),{headers:this.headers});const c=s?.download?`&download=${s.download===!0?"":s.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ut(a))return{data:null,error:a};throw a}})}createSignedUrls(e,n,s){return Te(this,void 0,void 0,function*(){try{const a=yield Yn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),l=s?.download?`&download=${s.download===!0?"":s.download}`:"";return{data:a.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ut(a))return{data:null,error:a};throw a}})}download(e,n){const a=typeof n?.transform<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString(n?.transform||{}),c=l?`?${l}`:"",d=this._getFinalPath(e),h=()=>kl(this.fetch,`${this.url}/${a}/${d}${c}`,{headers:this.headers,noResolveJson:!0});return new tj(h,this.shouldThrowOnError)}info(e){return Te(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const s=yield kl(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:kp(s),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ut(s))return{data:null,error:s};throw s}})}exists(e){return Te(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield ZR(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ut(s)&&s instanceof jp){const a=s.originalError;if([400,404].includes(a?.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,n){const s=this._getFinalPath(e),a=[],l=n?.download?`download=${n.download===!0?"":n.download}`:"";l!==""&&a.push(l);const d=typeof n?.transform<"u"?"render/image":"object",h=this.transformOptsToQueryString(n?.transform||{});h!==""&&a.push(h);let f=a.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${s}${f}`)}}}remove(e){return Te(this,void 0,void 0,function*(){try{return{data:yield Cg(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ut(n))return{data:null,error:n};throw n}})}list(e,n,s){return Te(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},nj),n),{prefix:e||""});return{data:yield Yn(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},s),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ut(a))return{data:null,error:a};throw a}})}listV2(e,n){return Te(this,void 0,void 0,function*(){try{const s=Object.assign({},e);return{data:yield Yn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ut(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const FS="2.79.0",YS={"X-Client-Info":`storage-js/${FS}`};class sj{constructor(e,n={},s,a){this.shouldThrowOnError=!1;const l=new URL(e);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},YS),n),this.fetch=Eg(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return Te(this,void 0,void 0,function*(){try{const n=this.listBucketOptionsToQueryString(e);return{data:yield kl(this.fetch,`${this.url}/bucket${n}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ut(n))return{data:null,error:n};throw n}})}getBucket(e){return Te(this,void 0,void 0,function*(){try{return{data:yield kl(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ut(n))return{data:null,error:n};throw n}})}createBucket(e){return Te(this,arguments,void 0,function*(n,s={public:!1}){try{return{data:yield Yn(this.fetch,`${this.url}/bucket`,{id:n,name:n,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ut(a))return{data:null,error:a};throw a}})}updateBucket(e,n){return Te(this,void 0,void 0,function*(){try{return{data:yield Mp(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ut(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Te(this,void 0,void 0,function*(){try{return{data:yield Yn(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ut(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Te(this,void 0,void 0,function*(){try{return{data:yield Cg(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ut(n))return{data:null,error:n};throw n}})}listBucketOptionsToQueryString(e){const n={};return e&&("limit"in e&&(n.limit=String(e.limit)),"offset"in e&&(n.offset=String(e.offset)),e.search&&(n.search=e.search),e.sortColumn&&(n.sortColumn=e.sortColumn),e.sortOrder&&(n.sortOrder=e.sortOrder)),Object.keys(n).length>0?"?"+new URLSearchParams(n).toString():""}}class ij{constructor(e,n={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},YS),n),this.fetch=Eg(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return Te(this,void 0,void 0,function*(){try{return{data:yield Yn(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ut(n))return{data:null,error:n};throw n}})}listBuckets(e){return Te(this,void 0,void 0,function*(){try{const n=new URLSearchParams;e?.limit!==void 0&&n.set("limit",e.limit.toString()),e?.offset!==void 0&&n.set("offset",e.offset.toString()),e?.sortColumn&&n.set("sortColumn",e.sortColumn),e?.sortOrder&&n.set("sortOrder",e.sortOrder),e?.search&&n.set("search",e.search);const s=n.toString(),a=s?`${this.url}/bucket?${s}`:`${this.url}/bucket`;return{data:yield kl(this.fetch,a,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ut(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Te(this,void 0,void 0,function*(){try{return{data:yield Cg(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ut(n))return{data:null,error:n};throw n}})}}const Ag={"X-Client-Info":`storage-js/${FS}`,"Content-Type":"application/json"};class GS extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function wn(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}class Xm extends GS{constructor(e,n,s){super(e),this.name="StorageVectorsApiError",this.status=n,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class aj extends GS{constructor(e,n){super(e),this.name="StorageVectorsUnknownError",this.originalError=n}}var R_;(function(t){t.InternalError="InternalError",t.S3VectorConflictException="S3VectorConflictException",t.S3VectorNotFoundException="S3VectorNotFoundException",t.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",t.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",t.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(R_||(R_={}));const Tg=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),oj=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},j_=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),lj=(t,e,n)=>Te(void 0,void 0,void 0,function*(){if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!n?.noResolveJson){const a=t.status||500,l=t;if(typeof l.json=="function")l.json().then(c=>{const d=c?.statusCode||c?.code||a+"";e(new Xm(j_(c),a,d))}).catch(()=>{const c=a+"",d=l.statusText||`HTTP ${a} error`;e(new Xm(d,a,c))});else{const c=a+"",d=l.statusText||`HTTP ${a} error`;e(new Xm(d,a,c))}}else e(new aj(j_(t),t))}),cj=(t,e,n,s)=>{const a={method:t,headers:e?.headers||{}};return s?(oj(s)?(a.headers=Object.assign({"Content-Type":"application/json"},e?.headers),a.body=JSON.stringify(s)):a.body=s,Object.assign(Object.assign({},a),n)):a};function uj(t,e,n,s,a,l){return Te(this,void 0,void 0,function*(){return new Promise((c,d)=>{t(n,cj(e,s,a,l)).then(h=>{if(!h.ok)throw h;if(s?.noResolveJson)return h;const f=h.headers.get("content-type");return!f||!f.includes("application/json")?{}:h.json()}).then(h=>c(h)).catch(h=>lj(h,d,s))})})}function xn(t,e,n,s,a){return Te(this,void 0,void 0,function*(){return uj(t,"POST",e,s,a,n)})}class dj{constructor(e,n={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Ag),n),this.fetch=Tg(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return Te(this,void 0,void 0,function*(){try{return{data:(yield xn(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(wn(n))return{data:null,error:n};throw n}})}getIndex(e,n){return Te(this,void 0,void 0,function*(){try{return{data:yield xn(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:n},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(wn(s))return{data:null,error:s};throw s}})}listIndexes(e){return Te(this,void 0,void 0,function*(){try{return{data:yield xn(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(wn(n))return{data:null,error:n};throw n}})}deleteIndex(e,n){return Te(this,void 0,void 0,function*(){try{return{data:(yield xn(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:n},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(wn(s))return{data:null,error:s};throw s}})}}class fj{constructor(e,n={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Ag),n),this.fetch=Tg(s)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return Te(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield xn(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(wn(n))return{data:null,error:n};throw n}})}getVectors(e){return Te(this,void 0,void 0,function*(){try{return{data:yield xn(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(wn(n))return{data:null,error:n};throw n}})}listVectors(e){return Te(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield xn(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(wn(n))return{data:null,error:n};throw n}})}queryVectors(e){return Te(this,void 0,void 0,function*(){try{return{data:yield xn(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(wn(n))return{data:null,error:n};throw n}})}deleteVectors(e){return Te(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield xn(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(wn(n))return{data:null,error:n};throw n}})}}class hj{constructor(e,n={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Ag),n),this.fetch=Tg(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return Te(this,void 0,void 0,function*(){try{return{data:(yield xn(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(wn(n))return{data:null,error:n};throw n}})}getBucket(e){return Te(this,void 0,void 0,function*(){try{return{data:yield xn(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(wn(n))return{data:null,error:n};throw n}})}listBuckets(){return Te(this,arguments,void 0,function*(e={}){try{return{data:yield xn(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(wn(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Te(this,void 0,void 0,function*(){try{return{data:(yield xn(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(wn(n))return{data:null,error:n};throw n}})}}class mj extends hj{constructor(e,n={}){super(e,n.headers||{},n.fetch)}from(e){return new pj(this.url,this.headers,e,this.fetch)}}class pj extends dj{constructor(e,n,s,a){super(e,n,a),this.vectorBucketName=s}createIndex(e){const n=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Te(this,void 0,void 0,function*(){return n.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Te(this,arguments,void 0,function*(n={}){return e.listIndexes.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const n=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Te(this,void 0,void 0,function*(){return n.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const n=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Te(this,void 0,void 0,function*(){return n.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new gj(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class gj extends fj{constructor(e,n,s,a,l){super(e,n,l),this.vectorBucketName=s,this.indexName=a}putVectors(e){const n=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Te(this,void 0,void 0,function*(){return n.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const n=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Te(this,void 0,void 0,function*(){return n.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Te(this,arguments,void 0,function*(n={}){return e.listVectors.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const n=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Te(this,void 0,void 0,function*(){return n.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const n=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Te(this,void 0,void 0,function*(){return n.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class yj extends sj{constructor(e,n={},s,a){super(e,n,s,a)}from(e){return new rj(this.url,this.headers,e,this.fetch)}get vectors(){return new mj(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new ij(this.url+"/iceberg",this.headers,this.fetch)}}const vj="2.79.0";let cl="";typeof Deno<"u"?cl="deno":typeof document<"u"?cl="web":typeof navigator<"u"&&navigator.product==="ReactNative"?cl="react-native":cl="node";const bj={"X-Client-Info":`supabase-js-${cl}/${vj}`},_j={headers:bj},wj={schema:"public"},xj={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Sj={},Ej=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Cj=()=>Headers,Aj=(t,e,n)=>{const s=Ej(n),a=Cj();return async(l,c)=>{var d;const h=(d=await e())!==null&&d!==void 0?d:t;let f=new a(c?.headers);return f.has("apikey")||f.set("apikey",t),f.has("Authorization")||f.set("Authorization",`Bearer ${h}`),s(l,Object.assign(Object.assign({},c),{headers:f}))}};function Tj(t){return t.endsWith("/")?t:t+"/"}function Nj(t,e){var n,s;const{db:a,auth:l,realtime:c,global:d}=t,{db:h,auth:f,realtime:g,global:p}=e,v={db:Object.assign(Object.assign({},h),a),auth:Object.assign(Object.assign({},f),l),realtime:Object.assign(Object.assign({},g),c),storage:{},global:Object.assign(Object.assign(Object.assign({},p),d),{headers:Object.assign(Object.assign({},(n=p?.headers)!==null&&n!==void 0?n:{}),(s=d?.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return t.accessToken?v.accessToken=t.accessToken:delete v.accessToken,v}function Oj(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Tj(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const XS="2.79.0",Ta=30*1e3,Dp=3,Km=Dp*Ta,Rj="http://localhost:9999",jj="supabase.auth.token",kj={"X-Client-Info":`gotrue-js/${XS}`},Up="X-Supabase-Api-Version",KS={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Mj=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Dj=600*1e3;class Ml extends Error{constructor(e,n,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=s}}function Oe(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Uj extends Ml{constructor(e,n,s){super(e,n,s),this.name="AuthApiError",this.status=n,this.code=s}}function $j(t){return Oe(t)&&t.name==="AuthApiError"}class fi extends Ml{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Is extends Ml{constructor(e,n,s,a){super(e,s,a),this.name=n,this.status=s}}class Vn extends Is{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Ij(t){return Oe(t)&&t.name==="AuthSessionMissingError"}class ya extends Is{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class zu extends Is{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Bu extends Is{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Lj(t){return Oe(t)&&t.name==="AuthImplicitGrantRedirectError"}class k_ extends Is{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class $p extends Is{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Qm(t){return Oe(t)&&t.name==="AuthRetryableFetchError"}class M_ extends Is{constructor(e,n,s){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=s}}class Ip extends Is{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ad="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),D_=` 	
\r=`.split(""),zj=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<D_.length;e+=1)t[D_[e].charCodeAt(0)]=-2;for(let e=0;e<Ad.length;e+=1)t[Ad[e].charCodeAt(0)]=e;return t})();function U_(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(Ad[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(Ad[s]),e.queuedBits-=6}}function QS(t,e,n){const s=zj[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function $_(t){const e=[],n=c=>{e.push(String.fromCodePoint(c))},s={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},l=c=>{qj(c,s,n)};for(let c=0;c<t.length;c+=1)QS(t.charCodeAt(c),a,l);return e.join("")}function Bj(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Pj(t,e){for(let n=0;n<t.length;n+=1){let s=t.charCodeAt(n);if(s>55295&&s<=56319){const a=(s-55296)*1024&65535;s=(t.charCodeAt(n+1)-56320&65535|a)+65536,n+=1}Bj(s,e)}}function qj(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let s=1;s<6;s+=1)if((t>>7-s&1)===0){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function $a(t){const e=[],n={queue:0,queuedBits:0},s=a=>{e.push(a)};for(let a=0;a<t.length;a+=1)QS(t.charCodeAt(a),n,s);return new Uint8Array(e)}function Hj(t){const e=[];return Pj(t,n=>e.push(n)),new Uint8Array(e)}function mi(t){const e=[],n={queue:0,queuedBits:0},s=a=>{e.push(a)};return t.forEach(a=>U_(a,n,s)),U_(null,n,s),e.join("")}function Vj(t){return Math.round(Date.now()/1e3)+t}function Fj(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Gt=()=>typeof window<"u"&&typeof document<"u",ii={tested:!1,writable:!1},WS=()=>{if(!Gt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ii.tested)return ii.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),ii.tested=!0,ii.writable=!0}catch{ii.tested=!0,ii.writable=!1}return ii.writable};function Yj(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((a,l)=>{e[l]=a})}catch{}return n.searchParams.forEach((s,a)=>{e[a]=s}),e}const JS=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Gj=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Na=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},ai=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},As=async(t,e)=>{await t.removeItem(e)};class Zd{constructor(){this.promise=new Zd.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Zd.promiseConstructor=Promise;function Wm(t){const e=t.split(".");if(e.length!==3)throw new Ip("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!Mj.test(e[s]))throw new Ip("JWT not in base64url format");return{header:JSON.parse($_(e[0])),payload:JSON.parse($_(e[1])),signature:$a(e[2]),raw:{header:e[0],payload:e[1]}}}async function Xj(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Kj(t,e){return new Promise((s,a)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await t(l);if(!e(l,null,c)){s(c);return}}catch(c){if(!e(l,c)){a(c);return}}})()})}function Qj(t){return("0"+t.toString(16)).substr(-2)}function Wj(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=n.length;let a="";for(let l=0;l<56;l++)a+=n.charAt(Math.floor(Math.random()*s));return a}return crypto.getRandomValues(e),Array.from(e,Qj).join("")}async function Jj(t){const n=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",n),a=new Uint8Array(s);return Array.from(a).map(l=>String.fromCharCode(l)).join("")}async function Zj(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await Jj(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function va(t,e,n=!1){const s=Wj();let a=s;n&&(a+="/PASSWORD_RECOVERY"),await Na(t,`${e}-code-verifier`,a);const l=await Zj(s);return[l,s===l?"plain":"s256"]}const e2=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function t2(t){const e=t.headers.get(Up);if(!e||!e.match(e2))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function n2(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function r2(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const s2=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ba(t){if(!s2.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Jm(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function i2(t,e){return new Proxy(t,{get:(n,s,a)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const l=s.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,s,a)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(n,s,a)}})}function I_(t){return JSON.parse(JSON.stringify(t))}const li=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),a2=[502,503,504];async function L_(t){var e;if(!Gj(t))throw new $p(li(t),0);if(a2.includes(t.status))throw new $p(li(t),t.status);let n;try{n=await t.json()}catch(l){throw new fi(li(l),l)}let s;const a=t2(t);if(a&&a.getTime()>=KS["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?s=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(s=n.error_code),s){if(s==="weak_password")throw new M_(li(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Vn}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new M_(li(n),t.status,n.weak_password.reasons);throw new Uj(li(n),t.status||500,s)}const o2=(t,e,n,s)=>{const a={method:t,headers:e?.headers||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),a.body=JSON.stringify(s),Object.assign(Object.assign({},a),n))};async function Ue(t,e,n,s){var a;const l=Object.assign({},s?.headers);l[Up]||(l[Up]=KS["2024-01-01"].name),s?.jwt&&(l.Authorization=`Bearer ${s.jwt}`);const c=(a=s?.query)!==null&&a!==void 0?a:{};s?.redirectTo&&(c.redirect_to=s.redirectTo);const d=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",h=await l2(t,e,n+d,{headers:l,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(h):{data:Object.assign({},h),error:null}}async function l2(t,e,n,s,a,l){const c=o2(e,s,a,l);let d;try{d=await t(n,Object.assign({},c))}catch(h){throw console.error(h),new $p(li(h),0)}if(d.ok||await L_(d),s?.noResolveJson)return d;try{return await d.json()}catch(h){await L_(h)}}function Fn(t){var e;let n=null;d2(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=Vj(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:s},error:null}}function z_(t){const e=Fn(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,s)=>n&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Ms(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function c2(t){return{data:t,error:null}}function u2(t){const{action_link:e,email_otp:n,hashed_token:s,redirect_to:a,verification_type:l}=t,c=Ka(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:e,email_otp:n,hashed_token:s,redirect_to:a,verification_type:l},h=Object.assign({},c);return{data:{properties:d,user:h},error:null}}function B_(t){return t}function d2(t){return t.access_token&&t.refresh_token&&t.expires_in}const Zm=["global","local","others"];class f2{constructor({url:e="",headers:n={},fetch:s}){this.url=e,this.headers=n,this.fetch=JS(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,n=Zm[0]){if(Zm.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Zm.join(", ")}`);try{return await Ue(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Oe(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,n={}){try{return await Ue(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Ms})}catch(s){if(Oe(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:n}=e,s=Ka(e,["options"]),a=Object.assign(Object.assign({},s),n);return"newEmail"in s&&(a.new_email=s?.newEmail,delete a.newEmail),await Ue(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:u2,redirectTo:n?.redirectTo})}catch(n){if(Oe(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await Ue(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ms})}catch(n){if(Oe(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,s,a,l,c,d,h;try{const f={nextPage:null,lastPage:0,total:0},g=await Ue(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e?.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(l=(a=e?.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:B_});if(g.error)throw g.error;const p=await g.json(),v=(c=g.headers.get("x-total-count"))!==null&&c!==void 0?c:0,b=(h=(d=g.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&h!==void 0?h:[];return b.length>0&&(b.forEach(x=>{const w=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(x.split(";")[1].split("=")[1]);f[`${S}Page`]=w}),f.total=parseInt(v)),{data:Object.assign(Object.assign({},p),f),error:null}}catch(f){if(Oe(f))return{data:{users:[]},error:f};throw f}}async getUserById(e){ba(e);try{return await Ue(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ms})}catch(n){if(Oe(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){ba(e);try{return await Ue(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Ms})}catch(s){if(Oe(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,n=!1){ba(e);try{return await Ue(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Ms})}catch(s){if(Oe(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){ba(e.userId);try{const{data:n,error:s}=await Ue(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:n,error:s}}catch(n){if(Oe(n))return{data:null,error:n};throw n}}async _deleteFactor(e){ba(e.userId),ba(e.id);try{return{data:await Ue(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Oe(n))return{data:null,error:n};throw n}}async _listOAuthClients(e){var n,s,a,l,c,d,h;try{const f={nextPage:null,lastPage:0,total:0},g=await Ue(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e?.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(l=(a=e?.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:B_});if(g.error)throw g.error;const p=await g.json(),v=(c=g.headers.get("x-total-count"))!==null&&c!==void 0?c:0,b=(h=(d=g.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&h!==void 0?h:[];return b.length>0&&(b.forEach(x=>{const w=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(x.split(";")[1].split("=")[1]);f[`${S}Page`]=w}),f.total=parseInt(v)),{data:Object.assign(Object.assign({},p),f),error:null}}catch(f){if(Oe(f))return{data:{clients:[]},error:f};throw f}}async _createOAuthClient(e){try{return await Ue(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Oe(n))return{data:null,error:n};throw n}}async _getOAuthClient(e){try{return await Ue(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Oe(n))return{data:null,error:n};throw n}}async _updateOAuthClient(e,n){try{return await Ue(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:n,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Oe(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await Ue(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Oe(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(e){try{return await Ue(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Oe(n))return{data:null,error:n};throw n}}}function P_(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}const _a={debug:!!(globalThis&&WS()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ZS extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class h2 extends ZS{}async function m2(t,e,n){_a.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),_a.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async a=>{if(a){_a.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await n()}finally{_a.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(e===0)throw _a.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new h2(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(_a.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function p2(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function eE(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function g2(t){return parseInt(t,16)}function y2(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function v2(t){var e;const{chainId:n,domain:s,expirationTime:a,issuedAt:l=new Date,nonce:c,notBefore:d,requestId:h,resources:f,scheme:g,uri:p,version:v}=t;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!p)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(v!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${v}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const b=eE(t.address),x=g?`${g}://${s}`:s,w=t.statement?`${t.statement}
`:"",S=`${x} wants you to sign in with your Ethereum account:
${b}

${w}`;let A=`URI: ${p}
Version: ${v}
Chain ID: ${n}${c?`
Nonce: ${c}`:""}
Issued At: ${l.toISOString()}`;if(a&&(A+=`
Expiration Time: ${a.toISOString()}`),d&&(A+=`
Not Before: ${d.toISOString()}`),h&&(A+=`
Request ID: ${h}`),f){let N=`
Resources:`;for(const E of f){if(!E||typeof E!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${E}`);N+=`
- ${E}`}A+=N}return`${S}
${A}`}class St extends Error{constructor({message:e,code:n,cause:s,name:a}){var l;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(l=a??(s instanceof Error?s.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=n}}class Td extends St{constructor(e,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:e}),this.name="WebAuthnUnknownError",this.originalError=n}}function b2({error:t,options:e}){var n,s,a;const{publicKey:l}=e;if(!l)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new St({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((n=l.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new St({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((s=l.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new St({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((a=l.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new St({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new St({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new St({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return l.pubKeyCredParams.filter(d=>d.type==="public-key").length===0?new St({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new St({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const c=window.location.hostname;if(tE(c)){if(l.rp.id!==c)return new St({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new St({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new St({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new St({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new St({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function _2({error:t,options:e}){const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new St({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new St({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(tE(s)){if(n.rpId!==s)return new St({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new St({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new St({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new St({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class w2{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const x2=new w2;function S2(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:n,excludeCredentials:s}=t,a=Ka(t,["challenge","user","excludeCredentials"]),l=$a(e).buffer,c=Object.assign(Object.assign({},n),{id:$a(n.id).buffer}),d=Object.assign(Object.assign({},a),{challenge:l,user:c});if(s&&s.length>0){d.excludeCredentials=new Array(s.length);for(let h=0;h<s.length;h++){const f=s[h];d.excludeCredentials[h]=Object.assign(Object.assign({},f),{id:$a(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return d}function E2(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:n}=t,s=Ka(t,["challenge","allowCredentials"]),a=$a(e).buffer,l=Object.assign(Object.assign({},s),{challenge:a});if(n&&n.length>0){l.allowCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const d=n[c];l.allowCredentials[c]=Object.assign(Object.assign({},d),{id:$a(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function C2(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t;return{id:t.id,rawId:t.id,response:{attestationObject:mi(new Uint8Array(t.response.attestationObject)),clientDataJSON:mi(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function A2(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t,s=t.getClientExtensionResults(),a=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:mi(new Uint8Array(a.authenticatorData)),clientDataJSON:mi(new Uint8Array(a.clientDataJSON)),signature:mi(new Uint8Array(a.signature)),userHandle:a.userHandle?mi(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function tE(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function q_(){var t,e;return!!(Gt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function T2(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Td("Browser returned unexpected credential type",e)}:{data:null,error:new Td("Empty credential response",e)}}catch(e){return{data:null,error:b2({error:e,options:t})}}}async function N2(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Td("Browser returned unexpected credential type",e)}:{data:null,error:new Td("Empty credential response",e)}}catch(e){return{data:null,error:_2({error:e,options:t})}}}const O2={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},R2={userVerification:"preferred",hints:["security-key"]};function Nd(...t){const e=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),n=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),s={};for(const a of t)if(a)for(const l in a){const c=a[l];if(c!==void 0)if(Array.isArray(c))s[l]=c;else if(n(c))s[l]=c;else if(e(c)){const d=s[l];e(d)?s[l]=Nd(d,c):s[l]=Nd(c)}else s[l]=c}return s}function j2(t,e){return Nd(O2,t,e||{})}function k2(t,e){return Nd(R2,t,e||{})}class M2{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:n,friendlyName:s,signal:a},l){try{const{data:c,error:d}=await this.client.mfa.challenge({factorId:e,webauthn:n});if(!c)return{data:null,error:d};const h=a??x2.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:f}=c.webauthn.credential_options.publicKey;f.name||(f.name=`${f.id}:${s}`),f.displayName||(f.displayName=f.name)}switch(c.webauthn.type){case"create":{const f=j2(c.webauthn.credential_options.publicKey,l?.create),{data:g,error:p}=await T2({publicKey:f,signal:h});return g?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:g}},error:null}:{data:null,error:p}}case"request":{const f=k2(c.webauthn.credential_options.publicKey,l?.request),{data:g,error:p}=await N2(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:f,signal:h}));return g?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:g}},error:null}:{data:null,error:p}}}}catch(c){return Oe(c)?{data:null,error:c}:{data:null,error:new fi("Unexpected error in challenge",c)}}}async _verify({challengeId:e,factorId:n,webauthn:s}){return this.client.mfa.verify({factorId:n,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:a}},l){if(!n)return{data:null,error:new Ml("rpId is required for WebAuthn authentication")};try{if(!q_())return{data:null,error:new fi("Browser does not support WebAuthn",null)};const{data:c,error:d}=await this.challenge({factorId:e,webauthn:{rpId:n,rpOrigins:s},signal:a},{request:l});if(!c)return{data:null,error:d};const{webauthn:h}=c;return this._verify({factorId:e,challengeId:c.challengeId,webauthn:{type:h.type,rpId:n,rpOrigins:s,credential_response:h.credential_response}})}catch(c){return Oe(c)?{data:null,error:c}:{data:null,error:new fi("Unexpected error in authenticate",c)}}}async _register({friendlyName:e,rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:a},l){if(!n)return{data:null,error:new Ml("rpId is required for WebAuthn registration")};try{if(!q_())return{data:null,error:new fi("Browser does not support WebAuthn",null)};const{data:c,error:d}=await this._enroll({friendlyName:e});if(!c)return await this.client.mfa.listFactors().then(g=>{var p;return(p=g.data)===null||p===void 0?void 0:p.all.find(v=>v.factor_type==="webauthn"&&v.friendly_name===e&&v.status!=="unverified")}).then(g=>g?this.client.mfa.unenroll({factorId:g?.id}):void 0),{data:null,error:d};const{data:h,error:f}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:n,rpOrigins:s},signal:a},{create:l});return h?this._verify({factorId:c.id,challengeId:h.challengeId,webauthn:{rpId:n,rpOrigins:s,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:f}}catch(c){return Oe(c)?{data:null,error:c}:{data:null,error:new fi("Unexpected error in register",c)}}}}p2();const D2={url:Rj,storageKey:jj,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:kj,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function H_(t,e,n){return await n()}const wa={};class Dl{get jwks(){var e,n;return(n=(e=wa[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){wa[this.storageKey]=Object.assign(Object.assign({},wa[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=wa[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){wa[this.storageKey]=Object.assign(Object.assign({},wa[this.storageKey]),{cachedAt:e})}constructor(e){var n,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Dl.nextInstanceID,Dl.nextInstanceID+=1,this.instanceID>0&&Gt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},D2),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new f2({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=JS(a.fetch),this.lock=a.lock||H_,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:Gt()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=m2:this.lock=H_,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new M2(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:WS()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=P_(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=P_(this.memoryStorage)),Gt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${XS}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let n={},s="none";if(Gt()&&(n=Yj(window.location.href),this._isImplicitGrantCallback(n)?s="implicit":await this._isPKCECallback(n)&&(s="pkce")),Gt()&&this.detectSessionInUrl&&s!=="none"){const{data:a,error:l}=await this._getSessionFromURL(n,s);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),Lj(l)){const h=(e=l.details)===null||e===void 0?void 0:e.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:d}=a;return this._debug("#_initialize()","detected session in URL",c,"redirect type",d),await this._saveSession(c),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Oe(n)?this._returnResult({error:n}):this._returnResult({error:new fi("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,s,a;try{const l=await Ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(n=e?.options)===null||n===void 0?void 0:n.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(a=e?.options)===null||a===void 0?void 0:a.captchaToken}},xform:Fn}),{data:c,error:d}=l;if(d||!c)return this._returnResult({data:{user:null,session:null},error:d});const h=c.session,f=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:f,session:h},error:null})}catch(l){if(Oe(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(e){var n,s,a;try{let l;if("email"in e){const{email:g,password:p,options:v}=e;let b=null,x=null;this.flowType==="pkce"&&([b,x]=await va(this.storage,this.storageKey)),l=await Ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v?.emailRedirectTo,body:{email:g,password:p,data:(n=v?.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:v?.captchaToken},code_challenge:b,code_challenge_method:x},xform:Fn})}else if("phone"in e){const{phone:g,password:p,options:v}=e;l=await Ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:p,data:(s=v?.data)!==null&&s!==void 0?s:{},channel:(a=v?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:v?.captchaToken}},xform:Fn})}else throw new zu("You must provide either an email or phone number and a password");const{data:c,error:d}=l;if(d||!c)return this._returnResult({data:{user:null,session:null},error:d});const h=c.session,f=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:f,session:h},error:null})}catch(l){if(Oe(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(e){try{let n;if("email"in e){const{email:l,password:c,options:d}=e;n=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:z_})}else if("phone"in e){const{phone:l,password:c,options:d}=e;n=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:z_})}else throw new zu("You must provide either an email or phone number and a password");const{data:s,error:a}=n;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!s||!s.session||!s.user){const l=new ya;return this._returnResult({data:{user:null,session:null},error:l})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:a})}catch(n){if(Oe(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(e){var n,s,a,l;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(l=e.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;switch(n){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(e){var n,s,a,l,c,d,h,f,g,p,v;let b,x;if("message"in e)b=e.message,x=e.signature;else{const{chain:w,wallet:S,statement:A,options:N}=e;let E;if(Gt())if(typeof S=="object")E=S;else{const q=window;if("ethereum"in q&&typeof q.ethereum=="object"&&"request"in q.ethereum&&typeof q.ethereum.request=="function")E=q.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!N?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=S}const C=new URL((n=N?.url)!==null&&n!==void 0?n:window.location.href),O=await E.request({method:"eth_requestAccounts"}).then(q=>q).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!O||O.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const R=eE(O[0]);let M=(s=N?.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!M){const q=await E.request({method:"eth_chainId"});M=g2(q)}const I={domain:C.host,address:R,statement:A,uri:C.href,version:"1",chainId:M,nonce:(a=N?.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(c=(l=N?.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(d=N?.signInWithEthereum)===null||d===void 0?void 0:d.expirationTime,notBefore:(h=N?.signInWithEthereum)===null||h===void 0?void 0:h.notBefore,requestId:(f=N?.signInWithEthereum)===null||f===void 0?void 0:f.requestId,resources:(g=N?.signInWithEthereum)===null||g===void 0?void 0:g.resources};b=v2(I),x=await E.request({method:"personal_sign",params:[y2(b),R]})}try{const{data:w,error:S}=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:b,signature:x},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(v=e.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:Fn});if(S)throw S;if(!w||!w.session||!w.user){const A=new ya;return this._returnResult({data:{user:null,session:null},error:A})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:S})}catch(w){if(Oe(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async signInWithSolana(e){var n,s,a,l,c,d,h,f,g,p,v,b;let x,w;if("message"in e)x=e.message,w=e.signature;else{const{chain:S,wallet:A,statement:N,options:E}=e;let C;if(Gt())if(typeof A=="object")C=A;else{const R=window;if("solana"in R&&typeof R.solana=="object"&&("signIn"in R.solana&&typeof R.solana.signIn=="function"||"signMessage"in R.solana&&typeof R.solana.signMessage=="function"))C=R.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof A!="object"||!E?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=A}const O=new URL((n=E?.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in C&&C.signIn){const R=await C.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},E?.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),N?{statement:N}:null));let M;if(Array.isArray(R)&&R[0]&&typeof R[0]=="object")M=R[0];else if(R&&typeof R=="object"&&"signedMessage"in R&&"signature"in R)M=R;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in M&&"signature"in M&&(typeof M.signedMessage=="string"||M.signedMessage instanceof Uint8Array)&&M.signature instanceof Uint8Array)x=typeof M.signedMessage=="string"?M.signedMessage:new TextDecoder().decode(M.signedMessage),w=M.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in C)||typeof C.signMessage!="function"||!("publicKey"in C)||typeof C!="object"||!C.publicKey||!("toBase58"in C.publicKey)||typeof C.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${O.host} wants you to sign in with your Solana account:`,C.publicKey.toBase58(),...N?["",N,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(a=(s=E?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((l=E?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${E.signInWithSolana.notBefore}`]:[],...!((c=E?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${E.signInWithSolana.expirationTime}`]:[],...!((d=E?.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${E.signInWithSolana.chainId}`]:[],...!((h=E?.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${E.signInWithSolana.nonce}`]:[],...!((f=E?.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${E.signInWithSolana.requestId}`]:[],...!((p=(g=E?.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||p===void 0)&&p.length?["Resources",...E.signInWithSolana.resources.map(M=>`- ${M}`)]:[]].join(`
`);const R=await C.signMessage(new TextEncoder().encode(x),"utf8");if(!R||!(R instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=R}}try{const{data:S,error:A}=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:mi(w)},!((v=e.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(b=e.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:Fn});if(A)throw A;if(!S||!S.session||!S.user){const N=new ya;return this._returnResult({data:{user:null,session:null},error:N})}return S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),this._returnResult({data:Object.assign({},S),error:A})}catch(S){if(Oe(S))return this._returnResult({data:{user:null,session:null},error:S});throw S}}async _exchangeCodeForSession(e){const n=await ai(this.storage,`${this.storageKey}-code-verifier`),[s,a]=(n??"").split("/");try{const{data:l,error:c}=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Fn});if(await As(this.storage,`${this.storageKey}-code-verifier`),c)throw c;if(!l||!l.session||!l.user){const d=new ya;return this._returnResult({data:{user:null,session:null,redirectType:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:a??null}),error:c})}catch(l){if(Oe(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(e){try{const{options:n,provider:s,token:a,access_token:l,nonce:c}=e,d=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:a,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:n?.captchaToken}},xform:Fn}),{data:h,error:f}=d;if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!h||!h.session||!h.user){const g=new ya;return this._returnResult({data:{user:null,session:null},error:g})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:h,error:f})}catch(n){if(Oe(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(e){var n,s,a,l,c;try{if("email"in e){const{email:d,options:h}=e;let f=null,g=null;this.flowType==="pkce"&&([f,g]=await va(this.storage,this.storageKey));const{error:p}=await Ue(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(n=h?.data)!==null&&n!==void 0?n:{},create_user:(s=h?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:f,code_challenge_method:g},redirectTo:h?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:p})}if("phone"in e){const{phone:d,options:h}=e,{data:f,error:g}=await Ue(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(a=h?.data)!==null&&a!==void 0?a:{},create_user:(l=h?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},channel:(c=h?.channel)!==null&&c!==void 0?c:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:f?.message_id},error:g})}throw new zu("You must provide either an email or phone number.")}catch(d){if(Oe(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async verifyOtp(e){var n,s;try{let a,l;"options"in e&&(a=(n=e.options)===null||n===void 0?void 0:n.redirectTo,l=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:c,error:d}=await Ue(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:l}}),redirectTo:a,xform:Fn});if(d)throw d;if(!c)throw new Error("An error occurred on token verification.");const h=c.session,f=c.user;return h?.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),this._returnResult({data:{user:f,session:h},error:null})}catch(a){if(Oe(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(e){var n,s,a;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await va(this.storage,this.storageKey));const d=await Ue(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&s!==void 0?s:void 0}),!((a=e?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:c2});return this._returnResult(d)}catch(l){if(Oe(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;if(s)throw s;if(!n)throw new Vn;const{error:a}=await Ue(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(e){if(Oe(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:s,type:a,options:l}=e,{error:c}=await Ue(this.fetch,"POST",n,{headers:this.headers,body:{email:s,type:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:c})}else if("phone"in e){const{phone:s,type:a,options:l}=e,{data:c,error:d}=await Ue(this.fetch,"POST",n,{headers:this.headers,body:{phone:s,type:a,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:c?.message_id},error:d})}throw new zu("You must provide either an email or phone number and a type")}catch(n){if(Oe(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await s,await n()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=n();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await ai(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<Km:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const c=await ai(this.userStorage,this.storageKey+"-user");c?.user?e.user=c.user:e.user=Jm()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const c={value:this.suppressGetSessionWarning};e.user=i2(e.user,c),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Ue(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ms}):await this._useSession(async n=>{var s,a,l;const{data:c,error:d}=n;if(d)throw d;return!(!((s=c.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Vn}:await Ue(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(a=c.session)===null||a===void 0?void 0:a.access_token)!==null&&l!==void 0?l:void 0,xform:Ms})})}catch(n){if(Oe(n))return Ij(n)&&(await this._removeSession(),await As(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async s=>{const{data:a,error:l}=s;if(l)throw l;if(!a.session)throw new Vn;const c=a.session;let d=null,h=null;this.flowType==="pkce"&&e.email!=null&&([d,h]=await va(this.storage,this.storageKey));const{data:f,error:g}=await Ue(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:d,code_challenge_method:h}),jwt:c.access_token,xform:Ms});if(g)throw g;return c.user=f.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),this._returnResult({data:{user:c.user},error:null})})}catch(s){if(Oe(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Vn;const n=Date.now()/1e3;let s=n,a=!0,l=null;const{payload:c}=Wm(e.access_token);if(c.exp&&(s=c.exp,a=s<=n),a){const{data:d,error:h}=await this._callRefreshToken(e.refresh_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!d)return{data:{user:null,session:null},error:null};l=d}else{const{data:d,error:h}=await this._getUser(e.access_token);if(h)throw h;l={access_token:e.access_token,refresh_token:e.refresh_token,user:d.user,token_type:"bearer",expires_in:s-n,expires_at:s},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(n){if(Oe(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var s;if(!e){const{data:c,error:d}=n;if(d)throw d;e=(s=c.session)!==null&&s!==void 0?s:void 0}if(!e?.refresh_token)throw new Vn;const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(Oe(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(e,n){try{if(!Gt())throw new Bu("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Bu(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new k_("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Bu("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new k_("No code detected.");const{data:N,error:E}=await this._exchangeCodeForSession(e.code);if(E)throw E;const C=new URL(window.location.href);return C.searchParams.delete("code"),window.history.replaceState(window.history.state,"",C.toString()),{data:{session:N.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:a,access_token:l,refresh_token:c,expires_in:d,expires_at:h,token_type:f}=e;if(!l||!d||!c||!f)throw new Bu("No session defined in URL");const g=Math.round(Date.now()/1e3),p=parseInt(d);let v=g+p;h&&(v=parseInt(h));const b=v-g;b*1e3<=Ta&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${b}s, should have been closer to ${p}s`);const x=v-p;g-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,v,g):g-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,v,g);const{data:w,error:S}=await this._getUser(l);if(S)throw S;const A={provider_token:s,provider_refresh_token:a,access_token:l,expires_in:p,expires_at:v,refresh_token:c,token_type:f,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:A,redirectType:e.type},error:null})}catch(s){if(Oe(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await ai(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var s;const{data:a,error:l}=n;if(l)return this._returnResult({error:l});const c=(s=a.session)===null||s===void 0?void 0:s.access_token;if(c){const{error:d}=await this.admin.signOut(c,e);if(d&&!($j(d)&&(d.status===404||d.status===401||d.status===403)))return this._returnResult({error:d})}return e!=="others"&&(await this._removeSession(),await As(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const n=Fj(),s={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async n=>{var s,a;try{const{data:{session:l},error:c}=n;if(c)throw c;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",e,"session",l)}catch(l){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",l),console.error(l)}})}async resetPasswordForEmail(e,n={}){let s=null,a=null;this.flowType==="pkce"&&([s,a]=await va(this.storage,this.storageKey,!0));try{return await Ue(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:a,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(l){if(Oe(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var e;try{const{data:n,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(n){if(Oe(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var n;try{const{data:s,error:a}=await this._useSession(async l=>{var c,d,h,f,g;const{data:p,error:v}=l;if(v)throw v;const b=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(d=e.options)===null||d===void 0?void 0:d.scopes,queryParams:(h=e.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await Ue(this.fetch,"GET",b,{headers:this.headers,jwt:(g=(f=p.session)===null||f===void 0?void 0:f.access_token)!==null&&g!==void 0?g:void 0})});if(a)throw a;return Gt()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(s?.url),this._returnResult({data:{provider:e.provider,url:s?.url},error:null})}catch(s){if(Oe(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async n=>{var s;try{const{error:a,data:{session:l}}=n;if(a)throw a;const{options:c,provider:d,token:h,access_token:f,nonce:g}=e,p=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=l?.access_token)!==null&&s!==void 0?s:void 0,body:{provider:d,id_token:h,access_token:f,nonce:g,link_identity:!0,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Fn}),{data:v,error:b}=p;return b?this._returnResult({data:{user:null,session:null},error:b}):!v||!v.session||!v.user?this._returnResult({data:{user:null,session:null},error:new ya}):(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("USER_UPDATED",v.session)),this._returnResult({data:v,error:b}))}catch(a){if(Oe(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(e){try{return await this._useSession(async n=>{var s,a;const{data:l,error:c}=n;if(c)throw c;return await Ue(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(s=l.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0})})}catch(n){if(Oe(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const s=Date.now();return await Kj(async a=>(a>0&&await Xj(200*Math.pow(2,a-1)),this._debug(n,"refreshing attempt",a),await Ue(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Fn})),(a,l)=>{const c=200*Math.pow(2,a);return l&&Qm(l)&&Date.now()+c-s<Ta})}catch(s){if(this._debug(n,"error",s),Oe(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",s),Gt()&&!n.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,n;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const a=await ai(this.storage,this.storageKey);if(a&&this.userStorage){let c=await ai(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:a.user},await Na(this.userStorage,this.storageKey+"-user",c)),a.user=(e=c?.user)!==null&&e!==void 0?e:Jm()}else if(a&&!a.user&&!a.user){const c=await ai(this.storage,this.storageKey+"-user");c&&c?.user?(a.user=c.user,await As(this.storage,this.storageKey+"-user"),await Na(this.storage,this.storageKey,a)):a.user=Jm()}if(this._debug(s,"session from storage",a),!this._isValidSession(a)){this._debug(s,"session is not valid"),a!==null&&await this._removeSession();return}const l=((n=a.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Km;if(this._debug(s,`session has${l?"":" not"} expired with margin of ${Km}s`),l){if(this.autoRefreshToken&&a.refresh_token){const{error:c}=await this._callRefreshToken(a.refresh_token);c&&(console.error(c),Qm(c)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:d}=await this._getUser(a.access_token);!d&&c?.user?(a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(s,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(s,"error",a),console.error(a);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var n,s;if(!e)throw new Vn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Zd;const{data:l,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!l.session)throw new Vn;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const d={data:l.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(l){if(this._debug(a,"error",l),Oe(l)){const c={data:null,error:l};return Qm(l)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(c),c}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(l),l}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,n,s=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",n,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:n});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(e,n)}catch(h){l.push(h)}});if(await Promise.all(c),l.length>0){for(let d=0;d<l.length;d+=1)console.error(l[d]);throw l[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),s=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&n.user&&await Na(this.userStorage,this.storageKey+"-user",{user:n.user});const a=Object.assign({},n);delete a.user;const l=I_(a);await Na(this.storage,this.storageKey,l)}else{const a=I_(n);await Na(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await As(this.storage,this.storageKey),await As(this.storage,this.storageKey+"-code-verifier"),await As(this.storage,this.storageKey+"-user"),this.userStorage&&await As(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Gt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ta);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:s}}=n;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((s.expires_at*1e3-e)/Ta);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Ta}ms, refresh threshold is ${Dp} ticks`),a<=Dp&&await this._callRefreshToken(s.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof ZS)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Gt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,s){const a=[`provider=${encodeURIComponent(n)}`];if(s?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&a.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[l,c]=await va(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});a.push(d.toString())}if(s?.queryParams){const l=new URLSearchParams(s.queryParams);a.push(l.toString())}return s?.skipBrowserRedirect&&a.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var s;const{data:a,error:l}=n;return l?this._returnResult({data:null,error:l}):await Ue(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token})})}catch(n){if(Oe(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(e){try{return await this._useSession(async n=>{var s,a;const{data:l,error:c}=n;if(c)return this._returnResult({data:null,error:c});const d=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:h,error:f}=await Ue(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(s=l?.session)===null||s===void 0?void 0:s.access_token});return f?this._returnResult({data:null,error:f}):(e.factorType==="totp"&&h.type==="totp"&&(!((a=h?.totp)===null||a===void 0)&&a.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(n){if(Oe(n))return this._returnResult({data:null,error:n});throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:a,error:l}=n;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?C2(e.webauthn.credential_response):A2(e.webauthn.credential_response)})}:{code:e.code}),{data:d,error:h}=await Ue(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:c,headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token});return h?this._returnResult({data:null,error:h}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),this._returnResult({data:d,error:h}))})}catch(n){if(Oe(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:a,error:l}=n;if(l)return this._returnResult({data:null,error:l});const c=await Ue(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token});if(c.error)return c;const{data:d}=c;if(d.type!=="webauthn")return{data:d,error:null};switch(d.webauthn.type){case"create":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:S2(d.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:E2(d.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(Oe(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(e){const{data:n,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){var e;const{data:{user:n},error:s}=await this.getUser();if(s)return{data:null,error:s};const a={all:[],phone:[],totp:[],webauthn:[]};for(const l of(e=n?.factors)!==null&&e!==void 0?e:[])a.all.push(l),l.status==="verified"&&a[l.factor_type].push(l);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var e,n;const{data:{session:s},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=Wm(s.access_token);let c=null;l.aal&&(c=l.aal);let d=c;((n=(e=s.user.factors)===null||e===void 0?void 0:e.filter(g=>g.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(d="aal2");const f=l.amr||[];return{data:{currentLevel:c,nextLevel:d,currentAuthenticationMethods:f},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async n=>{const{data:{session:s},error:a}=n;return a?this._returnResult({data:null,error:a}):s?await Ue(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new Vn})})}catch(n){if(Oe(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(e,n){try{return await this._useSession(async s=>{const{data:{session:a},error:l}=s;if(l)return this._returnResult({data:null,error:l});if(!a)return this._returnResult({data:null,error:new Vn});const c=await Ue(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:d=>({data:d,error:null})});return c.data&&c.data.redirect_url&&Gt()&&!n?.skipBrowserRedirect&&window.location.assign(c.data.redirect_url),c})}catch(s){if(Oe(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,n){try{return await this._useSession(async s=>{const{data:{session:a},error:l}=s;if(l)return this._returnResult({data:null,error:l});if(!a)return this._returnResult({data:null,error:new Vn});const c=await Ue(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:d=>({data:d,error:null})});return c.data&&c.data.redirect_url&&Gt()&&!n?.skipBrowserRedirect&&window.location.assign(c.data.redirect_url),c})}catch(s){if(Oe(s))return this._returnResult({data:null,error:s});throw s}}async fetchJwk(e,n={keys:[]}){let s=n.keys.find(d=>d.kid===e);if(s)return s;const a=Date.now();if(s=this.jwks.keys.find(d=>d.kid===e),s&&this.jwks_cached_at+Dj>a)return s;const{data:l,error:c}=await Ue(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=a,s=l.keys.find(d=>d.kid===e),!s)?null:s}async getClaims(e,n={}){try{let s=e;if(!s){const{data:b,error:x}=await this.getSession();if(x||!b.session)return this._returnResult({data:null,error:x});s=b.session.access_token}const{header:a,payload:l,signature:c,raw:{header:d,payload:h}}=Wm(s);n?.allowExpired||n2(l.exp);const f=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,n?.keys?{keys:n.keys}:n?.jwks);if(!f){const{error:b}=await this.getUser(s);if(b)throw b;return{data:{claims:l,header:a,signature:c},error:null}}const g=r2(a.alg),p=await crypto.subtle.importKey("jwk",f,g,!0,["verify"]);if(!await crypto.subtle.verify(g,p,c,Hj(`${d}.${h}`)))throw new Ip("Invalid JWT signature");return{data:{claims:l,header:a,signature:c},error:null}}catch(s){if(Oe(s))return this._returnResult({data:null,error:s});throw s}}}Dl.nextInstanceID=0;const U2=Dl;class $2 extends U2{constructor(e){super(e)}}class I2{constructor(e,n,s){var a,l,c;this.supabaseUrl=e,this.supabaseKey=n;const d=Oj(e);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const h=`sb-${d.hostname.split(".")[0]}-auth-token`,f={db:wj,realtime:Sj,auth:Object.assign(Object.assign({},xj),{storageKey:h}),global:_j},g=Nj(s??{},f);this.storageKey=(a=g.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(l=g.global.headers)!==null&&l!==void 0?l:{},g.accessToken?(this.accessToken=g.accessToken,this.auth=new Proxy({},{get:(p,v)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(v)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=g.auth)!==null&&c!==void 0?c:{},this.headers,g.global.fetch),this.fetch=Aj(n,this._getAccessToken.bind(this),g.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},g.realtime)),this.rest=new RR(new URL("rest/v1",d).href,{headers:this.headers,schema:g.db.schema,fetch:this.fetch}),this.storage=new yj(this.storageUrl.href,this.headers,this.fetch,s?.storage),g.accessToken||this._listenForAuthEvents()}get functions(){return new AR(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,n,s)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,n;if(this.accessToken)return await this.accessToken();const{data:s}=await this.auth.getSession();return(n=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:s,storage:a,userStorage:l,storageKey:c,flowType:d,lock:h,debug:f,throwOnError:g},p,v){const b={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new $2({url:this.authUrl.href,headers:Object.assign(Object.assign({},b),p),storageKey:c,autoRefreshToken:e,persistSession:n,detectSessionInUrl:s,storage:a,userStorage:l,flowType:d,lock:h,debug:f,throwOnError:g,fetch:v,hasCustomAuthorizationHeader:Object.keys(this.headers).some(x=>x.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new GR(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,s)=>{this._handleTokenChanged(n,"CLIENT",s?.access_token)})}_handleTokenChanged(e,n,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const L2=(t,e,n)=>new I2(t,e,n);function z2(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}z2()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");var Pu={exports:{}},V_;function B2(){if(V_)return Pu.exports;V_=1;var t=typeof Reflect=="object"?Reflect:null,e=t&&typeof t.apply=="function"?t.apply:function(O,R,M){return Function.prototype.apply.call(O,R,M)},n;t&&typeof t.ownKeys=="function"?n=t.ownKeys:Object.getOwnPropertySymbols?n=function(O){return Object.getOwnPropertyNames(O).concat(Object.getOwnPropertySymbols(O))}:n=function(O){return Object.getOwnPropertyNames(O)};function s(C){console&&console.warn&&console.warn(C)}var a=Number.isNaN||function(O){return O!==O};function l(){l.init.call(this)}Pu.exports=l,Pu.exports.once=A,l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var c=10;function d(C){if(typeof C!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof C)}Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(C){if(typeof C!="number"||C<0||a(C))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+C+".");c=C}}),l.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(O){if(typeof O!="number"||O<0||a(O))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+O+".");return this._maxListeners=O,this};function h(C){return C._maxListeners===void 0?l.defaultMaxListeners:C._maxListeners}l.prototype.getMaxListeners=function(){return h(this)},l.prototype.emit=function(O){for(var R=[],M=1;M<arguments.length;M++)R.push(arguments[M]);var I=O==="error",q=this._events;if(q!==void 0)I=I&&q.error===void 0;else if(!I)return!1;if(I){var K;if(R.length>0&&(K=R[0]),K instanceof Error)throw K;var Y=new Error("Unhandled error."+(K?" ("+K.message+")":""));throw Y.context=K,Y}var $=q[O];if($===void 0)return!1;if(typeof $=="function")e($,this,R);else for(var Q=$.length,B=x($,Q),M=0;M<Q;++M)e(B[M],this,R);return!0};function f(C,O,R,M){var I,q,K;if(d(R),q=C._events,q===void 0?(q=C._events=Object.create(null),C._eventsCount=0):(q.newListener!==void 0&&(C.emit("newListener",O,R.listener?R.listener:R),q=C._events),K=q[O]),K===void 0)K=q[O]=R,++C._eventsCount;else if(typeof K=="function"?K=q[O]=M?[R,K]:[K,R]:M?K.unshift(R):K.push(R),I=h(C),I>0&&K.length>I&&!K.warned){K.warned=!0;var Y=new Error("Possible EventEmitter memory leak detected. "+K.length+" "+String(O)+" listeners added. Use emitter.setMaxListeners() to increase limit");Y.name="MaxListenersExceededWarning",Y.emitter=C,Y.type=O,Y.count=K.length,s(Y)}return C}l.prototype.addListener=function(O,R){return f(this,O,R,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(O,R){return f(this,O,R,!0)};function g(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(C,O,R){var M={fired:!1,wrapFn:void 0,target:C,type:O,listener:R},I=g.bind(M);return I.listener=R,M.wrapFn=I,I}l.prototype.once=function(O,R){return d(R),this.on(O,p(this,O,R)),this},l.prototype.prependOnceListener=function(O,R){return d(R),this.prependListener(O,p(this,O,R)),this},l.prototype.removeListener=function(O,R){var M,I,q,K,Y;if(d(R),I=this._events,I===void 0)return this;if(M=I[O],M===void 0)return this;if(M===R||M.listener===R)--this._eventsCount===0?this._events=Object.create(null):(delete I[O],I.removeListener&&this.emit("removeListener",O,M.listener||R));else if(typeof M!="function"){for(q=-1,K=M.length-1;K>=0;K--)if(M[K]===R||M[K].listener===R){Y=M[K].listener,q=K;break}if(q<0)return this;q===0?M.shift():w(M,q),M.length===1&&(I[O]=M[0]),I.removeListener!==void 0&&this.emit("removeListener",O,Y||R)}return this},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(O){var R,M,I;if(M=this._events,M===void 0)return this;if(M.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):M[O]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete M[O]),this;if(arguments.length===0){var q=Object.keys(M),K;for(I=0;I<q.length;++I)K=q[I],K!=="removeListener"&&this.removeAllListeners(K);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(R=M[O],typeof R=="function")this.removeListener(O,R);else if(R!==void 0)for(I=R.length-1;I>=0;I--)this.removeListener(O,R[I]);return this};function v(C,O,R){var M=C._events;if(M===void 0)return[];var I=M[O];return I===void 0?[]:typeof I=="function"?R?[I.listener||I]:[I]:R?S(I):x(I,I.length)}l.prototype.listeners=function(O){return v(this,O,!0)},l.prototype.rawListeners=function(O){return v(this,O,!1)},l.listenerCount=function(C,O){return typeof C.listenerCount=="function"?C.listenerCount(O):b.call(C,O)},l.prototype.listenerCount=b;function b(C){var O=this._events;if(O!==void 0){var R=O[C];if(typeof R=="function")return 1;if(R!==void 0)return R.length}return 0}l.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function x(C,O){for(var R=new Array(O),M=0;M<O;++M)R[M]=C[M];return R}function w(C,O){for(;O+1<C.length;O++)C[O]=C[O+1];C.pop()}function S(C){for(var O=new Array(C.length),R=0;R<O.length;++R)O[R]=C[R].listener||C[R];return O}function A(C,O){return new Promise(function(R,M){function I(K){C.removeListener(O,q),M(K)}function q(){typeof C.removeListener=="function"&&C.removeListener("error",I),R([].slice.call(arguments))}E(C,O,q,{once:!0}),O!=="error"&&N(C,I,{once:!0})})}function N(C,O,R){typeof C.on=="function"&&E(C,"error",O,R)}function E(C,O,R,M){if(typeof C.on=="function")M.once?C.once(O,R):C.on(O,R);else if(typeof C.addEventListener=="function")C.addEventListener(O,function I(q){M.once&&C.removeEventListener(O,I),R(q)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof C)}return Pu.exports}var P2=B2();const q2=Kd(P2),Xt=new q2,nE="https://gsyznlwsezhwerypyzbe.supabase.co",H2="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdzeXpubHdzZXpod2VyeXB5emJlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ2MTYwMzYsImV4cCI6MjA4MDE5MjAzNn0.vLLiGKSTADkaOsUX8386m2MFIJl1Gx-EB4gQLLOAZGA",ka=nE+"/storage/v1/object/public/embodys/",Me=L2(nE,H2);var oi={},xa={},ep={},Zo={},F_;function rE(){return F_||(F_=1,(function(t){var e=Zo&&Zo.__awaiter||function(a,l,c,d){function h(f){return f instanceof c?f:new c(function(g){g(f)})}return new(c||(c=Promise))(function(f,g){function p(x){try{b(d.next(x))}catch(w){g(w)}}function v(x){try{b(d.throw(x))}catch(w){g(w)}}function b(x){x.done?f(x.value):h(x.value).then(p,v)}b((d=d.apply(a,l||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.TARGET_URL_HEADER=void 0,t.withMiddleware=n,t.withProxy=s;function n(...a){const l=c=>typeof c=="function";return c=>e(this,void 0,void 0,function*(){let d=Object.assign({},c);for(const h of a.filter(l))d=yield h(d);return d})}t.TARGET_URL_HEADER="x-fal-target-url";function s(a){const l=c=>Promise.resolve(c);return typeof window>"u"?l:c=>c.headers&&t.TARGET_URL_HEADER in c?l(c):Promise.resolve(Object.assign(Object.assign({},c),{url:a.targetUrl,headers:Object.assign(Object.assign({},c.headers||{}),{[t.TARGET_URL_HEADER]:c.url})}))}})(Zo)),Zo}var Hn={},Y_;function Ai(){if(Y_)return Hn;Y_=1;var t=Hn&&Hn.__awaiter||function(c,d,h,f){function g(p){return p instanceof h?p:new h(function(v){v(p)})}return new(h||(h=Promise))(function(p,v){function b(S){try{w(f.next(S))}catch(A){v(A)}}function x(S){try{w(f.throw(S))}catch(A){v(A)}}function w(S){S.done?p(S.value):g(S.value).then(b,x)}w((f=f.apply(c,d||[])).next())})};Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.ValidationError=Hn.ApiError=void 0,Hn.defaultResponseHandler=a,Hn.resultResponseHandler=l;const e="x-fal-request-id";class n extends Error{constructor({message:d,status:h,body:f,requestId:g}){super(d),this.name="ApiError",this.status=h,this.body=f,this.requestId=g||""}}Hn.ApiError=n;class s extends n{constructor(d){super(d),this.name="ValidationError"}get fieldErrors(){return typeof this.body.detail=="string"?[{loc:["body"],msg:this.body.detail,type:"value_error"}]:this.body.detail||[]}getFieldErrors(d){return this.fieldErrors.filter(h=>h.loc[h.loc.length-1]===d)}}Hn.ValidationError=s;function a(c){return t(this,void 0,void 0,function*(){var d;const{status:h,statusText:f}=c,g=(d=c.headers.get("Content-Type"))!==null&&d!==void 0?d:"",p=c.headers.get(e)||void 0;if(!c.ok){if(g.includes("application/json")){const v=yield c.json(),b=h===422?s:n;throw new b({message:v.message||f,status:h,body:v,requestId:p})}throw new n({message:`HTTP ${h}: ${f}`,status:h,requestId:p})}return g.includes("application/json")?c.json():g.includes("text/html")?c.text():g.includes("application/octet-stream")?c.arrayBuffer():c.text()})}function l(c){return t(this,void 0,void 0,function*(){return{data:yield a(c),requestId:c.headers.get(e)||""}})}return Hn}var el={},Dn={},G_;function Ti(){if(G_)return Dn;G_=1;var t=Dn&&Dn.__awaiter||function(g,p,v,b){function x(w){return w instanceof v?w:new v(function(S){S(w)})}return new(v||(v=Promise))(function(w,S){function A(C){try{E(b.next(C))}catch(O){S(O)}}function N(C){try{E(b.throw(C))}catch(O){S(O)}}function E(C){C.done?w(C.value):x(C.value).then(A,N)}E((b=b.apply(g,p||[])).next())})};Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.ensureEndpointIdFormat=e,Dn.parseEndpointId=s,Dn.isValidUrl=a,Dn.throttle=l,Dn.isReact=d,Dn.isPlainObject=h,Dn.sleep=f;function e(g){if(g.split("/").length>1)return g;const[,v,b]=/^([0-9]+)-([a-zA-Z0-9-]+)$/.exec(g)||[];if(v&&b)return`${v}/${b}`;throw new Error(`Invalid app id: ${g}. Must be in the format <appOwner>/<appId>`)}const n=["workflows","comfy"];function s(g){const v=e(g).split("/");return n.includes(v[0])?{owner:v[1],alias:v[2],path:v.slice(3).join("/")||void 0,namespace:v[0]}:{owner:v[0],alias:v[1],path:v.slice(2).join("/")||void 0}}function a(g){try{const{host:p}=new URL(g);return/(fal\.(ai|run))$/.test(p)}catch{return!1}}function l(g,p,v=!1){let b,x;return(...w)=>{!x&&v?(g(...w),x=Date.now()):(b&&clearTimeout(b),b=setTimeout(()=>{Date.now()-x>=p&&(g(...w),x=Date.now())},p-(Date.now()-x)))}}let c;function d(){if(c===void 0){const g=new Error().stack;c=!!g&&(g.includes("node_modules/react-dom/")||g.includes("node_modules/next/"))}return c}function h(g){return!!g&&Object.getPrototypeOf(g)===Object.prototype}function f(g){return t(this,void 0,void 0,function*(){return new Promise(p=>setTimeout(p,g))})}return Dn}var X_;function ef(){return X_||(X_=1,(function(t){var e=el&&el.__awaiter||function(d,h,f,g){function p(v){return v instanceof f?v:new f(function(b){b(v)})}return new(f||(f=Promise))(function(v,b){function x(A){try{S(g.next(A))}catch(N){b(N)}}function w(A){try{S(g.throw(A))}catch(N){b(N)}}function S(A){A.done?v(A.value):p(A.value).then(x,w)}S((g=g.apply(d,h||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_RETRY_OPTIONS=t.DEFAULT_RETRYABLE_STATUS_CODES=void 0,t.isRetryableError=a,t.calculateBackoffDelay=l,t.executeWithRetry=c;const n=Ai(),s=Ti();t.DEFAULT_RETRYABLE_STATUS_CODES=[429,502,503,504],t.DEFAULT_RETRY_OPTIONS={maxRetries:3,baseDelay:1e3,maxDelay:3e4,backoffMultiplier:2,retryableStatusCodes:t.DEFAULT_RETRYABLE_STATUS_CODES,enableJitter:!0};function a(d,h){return d instanceof n.ApiError&&h.includes(d.status)}function l(d,h,f,g,p){const v=Math.min(h*Math.pow(g,d),f);if(p){const b=.25*v*(Math.random()*2-1);return Math.max(0,v+b)}return v}function c(d,h,f){return e(this,void 0,void 0,function*(){const g={totalAttempts:0,totalDelay:0};let p;for(let v=0;v<=h.maxRetries;v++){g.totalAttempts++;try{return{result:yield d(),metrics:g}}catch(b){if(p=b,g.lastError=b,v===h.maxRetries||!a(b,h.retryableStatusCodes))throw b;const x=l(v,h.baseDelay,h.maxDelay,h.backoffMultiplier,h.enableJitter);g.totalDelay+=x,f&&f(v+1,b,x),yield(0,s.sleep)(x)}}throw p})}})(el)),el}var tl={};const V2="@fal-ai/client",F2="1.7.2",Y2={name:V2,version:F2};var K_;function Ng(){if(K_)return tl;K_=1,Object.defineProperty(tl,"__esModule",{value:!0}),tl.isBrowser=t,tl.getUserAgent=n;function t(){return typeof window<"u"&&typeof window.document<"u"}let e=null;function n(){if(e!==null)return e;const s=Y2;return e=`${s.name}/${s.version}`,e}return tl}var Q_;function Og(){return Q_||(Q_=1,(function(t){var e={};Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsFromEnv=void 0,t.resolveDefaultFetch=c,t.createConfig=g,t.getRestApiUrl=p;const n=rE(),s=Ai(),a=ef(),l=Ng();function c(){if(typeof fetch>"u")throw new Error("Your environment does not support fetch. Please provide your own fetch implementation.");return fetch}function d(){return typeof process<"u"&&e&&(typeof e.FAL_KEY<"u"||typeof e.FAL_KEY_ID<"u"&&typeof e.FAL_KEY_SECRET<"u")}const h=()=>{if(d())return typeof e.FAL_KEY<"u"?e.FAL_KEY:e.FAL_KEY_ID?`${e.FAL_KEY_ID}:${e.FAL_KEY_SECRET}`:void 0};t.credentialsFromEnv=h;const f={credentials:t.credentialsFromEnv,suppressLocalCredentialsWarning:!1,requestMiddleware:v=>Promise.resolve(v),responseHandler:s.defaultResponseHandler,retry:a.DEFAULT_RETRY_OPTIONS};function g(v){var b;let x=Object.assign(Object.assign(Object.assign({},f),v),{fetch:(b=v.fetch)!==null&&b!==void 0?b:c(),retry:Object.assign(Object.assign({},a.DEFAULT_RETRY_OPTIONS),v.retry||{})});v.proxyUrl&&(x=Object.assign(Object.assign({},x),{requestMiddleware:(0,n.withMiddleware)(x.requestMiddleware,(0,n.withProxy)({targetUrl:v.proxyUrl}))}));const{credentials:w,suppressLocalCredentialsWarning:S}=x,A=typeof w=="function"?w():w;return(0,l.isBrowser)()&&A&&!S&&console.warn("The fal credentials are exposed in the browser's environment. That's not recommended for production use cases."),x}function p(){return"https://rest.alpha.fal.ai"}})(ep)),ep}var Ir={},Lr={},W_;function Jl(){if(W_)return Lr;W_=1;var t=Lr&&Lr.__awaiter||function(h,f,g,p){function v(b){return b instanceof g?b:new g(function(x){x(b)})}return new(g||(g=Promise))(function(b,x){function w(N){try{A(p.next(N))}catch(E){x(E)}}function S(N){try{A(p.throw(N))}catch(E){x(E)}}function A(N){N.done?b(N.value):v(N.value).then(w,S)}A((p=p.apply(h,f||[])).next())})},e=Lr&&Lr.__rest||function(h,f){var g={};for(var p in h)Object.prototype.hasOwnProperty.call(h,p)&&f.indexOf(p)<0&&(g[p]=h[p]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var v=0,p=Object.getOwnPropertySymbols(h);v<p.length;v++)f.indexOf(p[v])<0&&Object.prototype.propertyIsEnumerable.call(h,p[v])&&(g[p[v]]=h[p[v]]);return g};Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.dispatchRequest=c,Lr.buildUrl=d;const n=ef(),s=Ng(),a=Ti(),l=typeof navigator<"u"&&navigator?.userAgent==="Cloudflare-Workers";function c(h){return t(this,void 0,void 0,function*(){var f;const{targetUrl:g,input:p,config:v,options:b={}}=h,{credentials:x,requestMiddleware:w,responseHandler:S,fetch:A}=v,N=Object.assign(Object.assign({},v.retry),b.retry||{}),E=()=>t(this,void 0,void 0,function*(){var O,R,M;const I=(0,s.isBrowser)()?{}:{"User-Agent":(0,s.getUserAgent)()},q=typeof x=="function"?x():x,{method:K,url:Y,headers:$}=yield w({method:((R=(O=h.method)!==null&&O!==void 0?O:b.method)!==null&&R!==void 0?R:"post").toUpperCase(),url:g,headers:h.headers}),Q=q?{Authorization:`Key ${q}`}:{},B=Object.assign(Object.assign(Object.assign(Object.assign({},Q),{Accept:"application/json","Content-Type":"application/json"}),I),$??{}),{responseHandler:G,retry:k}=b,L=e(b,["responseHandler","retry"]),V=yield A(Y,Object.assign(Object.assign(Object.assign(Object.assign({},L),{method:K,headers:Object.assign(Object.assign({},B),(M=L.headers)!==null&&M!==void 0?M:{})}),!l&&{mode:"cors"}),{signal:b.signal,body:K.toLowerCase()!=="get"&&p?JSON.stringify(p):void 0}));return yield(G??S)(V)});let C;for(let O=0;O<=N.maxRetries;O++)try{return yield E()}catch(R){if(C=R,O===N.maxRetries||!(0,n.isRetryableError)(R,N.retryableStatusCodes)||((f=b.signal)===null||f===void 0?void 0:f.aborted))throw R;const I=(0,n.calculateBackoffDelay)(O,N.baseDelay,N.maxDelay,N.backoffMultiplier,N.enableJitter);yield(0,a.sleep)(I)}throw C})}function d(h,f={}){var g,p;const v=((g=f.method)!==null&&g!==void 0?g:"post").toLowerCase(),b=((p=f.path)!==null&&p!==void 0?p:"").replace(/^\//,"").replace(/\/{2,}/,"/"),x=f.input,w=Object.assign(Object.assign({},f.query||{}),v==="get"?x:{}),S=Object.keys(w).length>0?`?${new URLSearchParams(w).toString()}`:"";if((0,a.isValidUrl)(h))return`${h.endsWith("/")?h:`${h}/`}${b}${S}`;const A=(0,a.ensureEndpointIdFormat)(h);return`${`https://${f.subdomain?`${f.subdomain}.`:""}fal.run/${A}/${b}`.replace(/\/$/,"")}${S}`}return Lr}var Un={},qu={},J_;function G2(){if(J_)return qu;J_=1,Object.defineProperty(qu,"__esModule",{value:!0});function t(s){let a,l,c,d,h,f,g;return p(),{feed:v,reset:p};function p(){a=!0,l="",c=0,d=-1,h=void 0,f=void 0,g=""}function v(x){l=l?l+x:x,a&&n(l)&&(l=l.slice(e.length)),a=!1;const w=l.length;let S=0,A=!1;for(;S<w;){A&&(l[S]===`
`&&++S,A=!1);let N=-1,E=d,C;for(let O=c;N<0&&O<w;++O)C=l[O],C===":"&&E<0?E=O-S:C==="\r"?(A=!0,N=O-S):C===`
`&&(N=O-S);if(N<0){c=w-S,d=E;break}else c=0,d=-1;b(l,S,E,N),S+=N+1}S===w?l="":S>0&&(l=l.slice(S))}function b(x,w,S,A){if(A===0){g.length>0&&(s({type:"event",id:h,event:f||void 0,data:g.slice(0,-1)}),g="",h=void 0),f=void 0;return}const N=S<0,E=x.slice(w,w+(N?A:S));let C=0;N?C=A:x[w+S+1]===" "?C=S+2:C=S+1;const O=w+C,R=A-C,M=x.slice(O,O+R).toString();if(E==="data")g+=M?"".concat(M,`
`):`
`;else if(E==="event")f=M;else if(E==="id"&&!M.includes("\0"))h=M;else if(E==="retry"){const I=parseInt(M,10);Number.isNaN(I)||s({type:"reconnect-interval",value:I})}}}const e=[239,187,191];function n(s){return e.every((a,l)=>s.charCodeAt(l)===a)}return qu.createParser=t,qu}var nl={},Z_;function sE(){return Z_||(Z_=1,(function(t){var e=nl&&nl.__awaiter||function(c,d,h,f){function g(p){return p instanceof h?p:new h(function(v){v(p)})}return new(h||(h=Promise))(function(p,v){function b(S){try{w(f.next(S))}catch(A){v(A)}}function x(S){try{w(f.throw(S))}catch(A){v(A)}}function w(S){S.done?p(S.value):g(S.value).then(b,x)}w((f=f.apply(c,d||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.TOKEN_EXPIRATION_SECONDS=void 0,t.getTemporaryAuthToken=l;const n=Og(),s=Jl(),a=Ti();t.TOKEN_EXPIRATION_SECONDS=120;function l(c,d){return e(this,void 0,void 0,function*(){const h=(0,a.parseEndpointId)(c),f=yield(0,s.dispatchRequest)({method:"POST",targetUrl:`${(0,n.getRestApiUrl)()}/tokens/`,config:d,input:{allowed_apps:[h.alias],token_expiration:t.TOKEN_EXPIRATION_SECONDS}});return typeof f!="string"&&f.detail?f.detail:f})}})(nl)),nl}var ew;function iE(){if(ew)return Un;ew=1;var t=Un&&Un.__awaiter||function(p,v,b,x){function w(S){return S instanceof b?S:new b(function(A){A(S)})}return new(b||(b=Promise))(function(S,A){function N(O){try{C(x.next(O))}catch(R){A(R)}}function E(O){try{C(x.throw(O))}catch(R){A(R)}}function C(O){O.done?S(O.value):w(O.value).then(N,E)}C((x=x.apply(p,v||[])).next())})},e=Un&&Un.__await||function(p){return this instanceof e?(this.v=p,this):new e(p)},n=Un&&Un.__asyncGenerator||function(p,v,b){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var x=b.apply(p,v||[]),w,S=[];return w={},N("next"),N("throw"),N("return",A),w[Symbol.asyncIterator]=function(){return this},w;function A(I){return function(q){return Promise.resolve(q).then(I,R)}}function N(I,q){x[I]&&(w[I]=function(K){return new Promise(function(Y,$){S.push([I,K,Y,$])>1||E(I,K)})},q&&(w[I]=q(w[I])))}function E(I,q){try{C(x[I](q))}catch(K){M(S[0][3],K)}}function C(I){I.value instanceof e?Promise.resolve(I.value.v).then(O,R):M(S[0][2],I)}function O(I){E("next",I)}function R(I){E("throw",I)}function M(I,q){I(q),S.shift(),S.length&&E(S[0][0],S[0][1])}};Object.defineProperty(Un,"__esModule",{value:!0}),Un.FalStream=void 0,Un.createStreamingClient=g;const s=G2(),a=sE(),l=Jl(),c=Ai(),d="text/event-stream",h=15*1e3;class f{constructor(v,b,x){var w;this.listeners=new Map,this.buffer=[],this.currentData=void 0,this.lastEventTimestamp=0,this.streamClosed=!1,this._requestId=null,this.abortController=new AbortController,this.start=()=>t(this,void 0,void 0,function*(){var S,A;const{endpointId:N,options:E}=this,{input:C,method:O="post",connectionMode:R="server"}=E;try{if(R==="client"){const M=yield(0,a.getTemporaryAuthToken)(N,this.config),{fetch:I}=this.config,q=new URL(this.url);q.searchParams.set("fal_jwt_token",M);const K=yield I(q.toString(),{method:O.toUpperCase(),headers:{accept:(S=E.accept)!==null&&S!==void 0?S:d,"content-type":"application/json"},body:C&&O!=="get"?JSON.stringify(C):void 0,signal:this.abortController.signal});return this._requestId=K.headers.get("x-fal-request-id"),yield this.handleResponse(K)}return yield(0,l.dispatchRequest)({method:O.toUpperCase(),targetUrl:this.url,input:C,config:this.config,options:{headers:{accept:(A=E.accept)!==null&&A!==void 0?A:d},responseHandler:M=>t(this,void 0,void 0,function*(){return this._requestId=M.headers.get("x-fal-request-id"),yield this.handleResponse(M)}),signal:this.abortController.signal}})}catch(M){this.handleError(M)}}),this.handleResponse=S=>t(this,void 0,void 0,function*(){var A,N;if(!S.ok){try{yield(0,c.defaultResponseHandler)(S)}catch(K){this.emit("error",K)}return}const E=S.body;if(!E){this.emit("error",new c.ApiError({message:"Response body is empty.",status:400,body:void 0,requestId:this._requestId||void 0}));return}if(!((A=S.headers.get("content-type"))!==null&&A!==void 0?A:"").startsWith(d)){const K=E.getReader(),Y=()=>{K.read().then(({done:$,value:Q})=>{if($){this.emit("done",this.currentData);return}this.currentData=Q,this.emit("data",Q),Y()})};Y();return}const O=new TextDecoder("utf-8"),R=S.body.getReader(),M=(0,s.createParser)(K=>{if(K.type==="event"){const Y=K.data;try{const $=JSON.parse(Y);this.buffer.push($),this.currentData=$,this.emit("data",$),this.emit("message",$)}catch($){this.emit("error",$)}}}),I=(N=this.options.timeout)!==null&&N!==void 0?N:h,q=()=>t(this,void 0,void 0,function*(){const{value:K,done:Y}=yield R.read();this.lastEventTimestamp=Date.now(),M.feed(O.decode(K)),Date.now()-this.lastEventTimestamp>I&&this.emit("error",new c.ApiError({message:`Event stream timed out after ${(I/1e3).toFixed(0)} seconds with no messages.`,status:408,requestId:this._requestId||void 0})),Y?this.emit("done",this.currentData):q().catch(this.handleError)});q().catch(this.handleError)}),this.handleError=S=>{var A;if(S.name==="AbortError"||this.signal.aborted)return;const N=S instanceof c.ApiError?S:new c.ApiError({message:(A=S.message)!==null&&A!==void 0?A:"An unknown error occurred",status:500,requestId:this._requestId||void 0});this.emit("error",N)},this.on=(S,A)=>{var N;this.listeners.has(S)||this.listeners.set(S,[]),(N=this.listeners.get(S))===null||N===void 0||N.push(A)},this.emit=(S,A)=>{const N=this.listeners.get(S)||[];for(const E of N)E(A)},this.done=()=>t(this,void 0,void 0,function*(){return this.donePromise}),this.abort=S=>{this.streamClosed||this.abortController.abort(S)},this.endpointId=v,this.config=b,this.url=(w=x.url)!==null&&w!==void 0?w:(0,l.buildUrl)(v,{path:"/stream",query:x.queryParams}),this.options=x,this.donePromise=new Promise((S,A)=>{this.streamClosed&&A(new c.ApiError({message:"Streaming connection is already closed.",status:400,body:void 0,requestId:this._requestId||void 0})),this.signal.addEventListener("abort",()=>{var N;S((N=this.currentData)!==null&&N!==void 0?N:{})}),this.on("done",N=>{this.streamClosed=!0,S(N)}),this.on("error",N=>{this.streamClosed=!0,A(N)})}),x.signal&&x.signal.addEventListener("abort",()=>{this.abortController.abort()}),this.start().catch(this.handleError)}[Symbol.asyncIterator](){return n(this,arguments,function*(){let b=!0;const x=()=>b=!1;for(this.on("error",x),this.on("done",x);b||this.buffer.length>0;){const w=this.buffer.shift();w&&(yield yield e(w)),yield e(new Promise(S=>setTimeout(S,16)))}})}get signal(){return this.abortController.signal}get requestId(){return this._requestId}}Un.FalStream=f;function g({config:p,storage:v}){return{stream(b,x){return t(this,void 0,void 0,function*(){const w=x.input?yield v.transformInput(x.input):void 0;return new f(b,p,Object.assign(Object.assign({},x),{input:w}))})}}}return Un}var tw;function X2(){if(tw)return Ir;tw=1;var t=Ir&&Ir.__awaiter||function(p,v,b,x){function w(S){return S instanceof b?S:new b(function(A){A(S)})}return new(b||(b=Promise))(function(S,A){function N(O){try{C(x.next(O))}catch(R){A(R)}}function E(O){try{C(x.throw(O))}catch(R){A(R)}}function C(O){O.done?S(O.value):w(O.value).then(N,E)}C((x=x.apply(p,v||[])).next())})},e=Ir&&Ir.__rest||function(p,v){var b={};for(var x in p)Object.prototype.hasOwnProperty.call(p,x)&&v.indexOf(x)<0&&(b[x]=p[x]);if(p!=null&&typeof Object.getOwnPropertySymbols=="function")for(var w=0,x=Object.getOwnPropertySymbols(p);w<x.length;w++)v.indexOf(x[w])<0&&Object.prototype.propertyIsEnumerable.call(p,x[w])&&(b[x[w]]=p[x[w]]);return b};Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.createQueueClient=void 0;const n=Jl(),s=Ai(),a=ef(),l=iE(),c=Ti(),d=500,h={maxRetries:3,baseDelay:1e3,maxDelay:6e4,retryableStatusCodes:a.DEFAULT_RETRYABLE_STATUS_CODES},f={maxRetries:5,baseDelay:1e3,maxDelay:3e4,retryableStatusCodes:[...a.DEFAULT_RETRYABLE_STATUS_CODES,500]},g=({config:p,storage:v})=>{const b={submit(x,w){return t(this,void 0,void 0,function*(){const{webhookUrl:S,priority:A,hint:N}=w,E=e(w,["webhookUrl","priority","hint"]),C=w.input?yield v.transformInput(w.input):void 0;return(0,n.dispatchRequest)({method:w.method,targetUrl:(0,n.buildUrl)(x,Object.assign(Object.assign({},E),{subdomain:"queue",query:S?{fal_webhook:S}:void 0})),headers:Object.assign({"x-fal-queue-priority":A??"normal"},N&&{"x-fal-runner-hint":N}),input:C,config:p,options:{signal:w.abortSignal,retry:h}})})},status(x,w){return t(this,arguments,void 0,function*(S,{requestId:A,logs:N=!1,abortSignal:E}){const C=(0,c.parseEndpointId)(S),O=C.namespace?`${C.namespace}/`:"";return(0,n.dispatchRequest)({method:"get",targetUrl:(0,n.buildUrl)(`${O}${C.owner}/${C.alias}`,{subdomain:"queue",query:{logs:N?"1":"0"},path:`/requests/${A}/status`}),config:p,options:{signal:E,retry:f}})})},streamStatus(x,w){return t(this,arguments,void 0,function*(S,{requestId:A,logs:N=!1,connectionMode:E}){const C=(0,c.parseEndpointId)(S),O=C.namespace?`${C.namespace}/`:"",R={logs:N?"1":"0"},M=(0,n.buildUrl)(`${O}${C.owner}/${C.alias}`,{subdomain:"queue",path:`/requests/${A}/status/stream`,query:R});return new l.FalStream(S,p,{url:M,method:"get",connectionMode:E,queryParams:R})})},subscribeToStatus(x,w){return t(this,void 0,void 0,function*(){const S=w.requestId,A=w.timeout;let N;const E=()=>{};if(w.mode==="streaming"){const C=yield b.streamStatus(x,{requestId:S,logs:w.logs,connectionMode:"connectionMode"in w?w.connectionMode:void 0}),O=[];A&&(N=setTimeout(()=>{throw C.abort(),b.cancel(x,{requestId:S}).catch(E),new Error(`Client timed out waiting for the request to complete after ${A}ms`)},A)),C.on("data",M=>{w.onQueueUpdate&&("logs"in M&&Array.isArray(M.logs)&&M.logs.length>0&&O.push(...M.logs),w.onQueueUpdate("logs"in M?Object.assign(Object.assign({},M),{logs:O}):M))});const R=yield C.done();return N&&clearTimeout(N),R}return new Promise((C,O)=>{var R;let M;const I="pollInterval"in w&&typeof w.pollInterval=="number"&&(R=w.pollInterval)!==null&&R!==void 0?R:d,q=()=>{N&&clearTimeout(N),M&&clearTimeout(M)};A&&(N=setTimeout(()=>{q(),b.cancel(x,{requestId:S}).catch(E),O(new Error(`Client timed out waiting for the request to complete after ${A}ms`))},A));const K=()=>t(this,void 0,void 0,function*(){var Y;try{const $=yield b.status(x,{requestId:S,logs:(Y=w.logs)!==null&&Y!==void 0?Y:!1,abortSignal:w.abortSignal});if(w.onQueueUpdate&&w.onQueueUpdate($),$.status==="COMPLETED"){q(),C($);return}M=setTimeout(K,I)}catch($){q(),O($)}});K().catch(O)})})},result(x,w){return t(this,arguments,void 0,function*(S,{requestId:A,abortSignal:N}){const E=(0,c.parseEndpointId)(S),C=E.namespace?`${E.namespace}/`:"";return(0,n.dispatchRequest)({method:"get",targetUrl:(0,n.buildUrl)(`${C}${E.owner}/${E.alias}`,{subdomain:"queue",path:`/requests/${A}`}),config:Object.assign(Object.assign({},p),{responseHandler:s.resultResponseHandler}),options:{signal:N,retry:h}})})},cancel(x,w){return t(this,arguments,void 0,function*(S,{requestId:A,abortSignal:N}){const E=(0,c.parseEndpointId)(S),C=E.namespace?`${E.namespace}/`:"";yield(0,n.dispatchRequest)({method:"put",targetUrl:(0,n.buildUrl)(`${C}${E.owner}/${E.alias}`,{subdomain:"queue",path:`/requests/${A}/cancel`}),config:p,options:{signal:N}})})}};return b};return Ir.createQueueClient=g,Ir}var Hu={};function K2(t){const e=t.length;let n=0,s=0;for(;s<e;){let a=t.charCodeAt(s++);if((a&4294967168)===0){n++;continue}else if((a&4294965248)===0)n+=2;else{if(a>=55296&&a<=56319&&s<e){const l=t.charCodeAt(s);(l&64512)===56320&&(++s,a=((a&1023)<<10)+(l&1023)+65536)}(a&4294901760)===0?n+=3:n+=4}}return n}function Q2(t,e,n){const s=t.length;let a=n,l=0;for(;l<s;){let c=t.charCodeAt(l++);if((c&4294967168)===0){e[a++]=c;continue}else if((c&4294965248)===0)e[a++]=c>>6&31|192;else{if(c>=55296&&c<=56319&&l<s){const d=t.charCodeAt(l);(d&64512)===56320&&(++l,c=((c&1023)<<10)+(d&1023)+65536)}(c&4294901760)===0?(e[a++]=c>>12&15|224,e[a++]=c>>6&63|128):(e[a++]=c>>18&7|240,e[a++]=c>>12&63|128,e[a++]=c>>6&63|128)}e[a++]=c&63|128}}const W2=new TextEncoder,J2=50;function Z2(t,e,n){W2.encodeInto(t,e.subarray(n))}function ek(t,e,n){t.length>J2?Z2(t,e,n):Q2(t,e,n)}const tk=4096;function aE(t,e,n){let s=e;const a=s+n,l=[];let c="";for(;s<a;){const d=t[s++];if((d&128)===0)l.push(d);else if((d&224)===192){const h=t[s++]&63;l.push((d&31)<<6|h)}else if((d&240)===224){const h=t[s++]&63,f=t[s++]&63;l.push((d&31)<<12|h<<6|f)}else if((d&248)===240){const h=t[s++]&63,f=t[s++]&63,g=t[s++]&63;let p=(d&7)<<18|h<<12|f<<6|g;p>65535&&(p-=65536,l.push(p>>>10&1023|55296),p=56320|p&1023),l.push(p)}else l.push(d);l.length>=tk&&(c+=String.fromCharCode(...l),l.length=0)}return l.length>0&&(c+=String.fromCharCode(...l)),c}const nk=new TextDecoder,rk=200;function sk(t,e,n){const s=t.subarray(e,e+n);return nk.decode(s)}function ik(t,e,n){return n>rk?sk(t,e,n):aE(t,e,n)}class ul{constructor(e,n){this.type=e,this.data=n}}class on extends Error{constructor(e){super(e);const n=Object.create(on.prototype);Object.setPrototypeOf(this,n),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:on.name})}}const rl=4294967295;function ak(t,e,n){const s=n/4294967296,a=n;t.setUint32(e,s),t.setUint32(e+4,a)}function oE(t,e,n){const s=Math.floor(n/4294967296),a=n;t.setUint32(e,s),t.setUint32(e+4,a)}function lE(t,e){const n=t.getInt32(e),s=t.getUint32(e+4);return n*4294967296+s}function ok(t,e){const n=t.getUint32(e),s=t.getUint32(e+4);return n*4294967296+s}const cE=-1,lk=4294967296-1,ck=17179869184-1;function uE({sec:t,nsec:e}){if(t>=0&&e>=0&&t<=ck)if(e===0&&t<=lk){const n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t),n}else{const n=t/4294967296,s=t&4294967295,a=new Uint8Array(8),l=new DataView(a.buffer);return l.setUint32(0,e<<2|n&3),l.setUint32(4,s),a}else{const n=new Uint8Array(12),s=new DataView(n.buffer);return s.setUint32(0,e),oE(s,4,t),n}}function dE(t){const e=t.getTime(),n=Math.floor(e/1e3),s=(e-n*1e3)*1e6,a=Math.floor(s/1e9);return{sec:n+a,nsec:s-a*1e9}}function fE(t){if(t instanceof Date){const e=dE(t);return uE(e)}else return null}function hE(t){const e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const n=e.getUint32(0),s=e.getUint32(4),a=(n&3)*4294967296+s,l=n>>>2;return{sec:a,nsec:l}}case 12:{const n=lE(e,4),s=e.getUint32(0);return{sec:n,nsec:s}}default:throw new on(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${t.length}`)}}function mE(t){const e=hE(t);return new Date(e.sec*1e3+e.nsec/1e6)}const uk={type:cE,encode:fE,decode:mE};class Ul{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(uk)}register({type:e,encode:n,decode:s}){if(e>=0)this.encoders[e]=n,this.decoders[e]=s;else{const a=-1-e;this.builtInEncoders[a]=n,this.builtInDecoders[a]=s}}tryToEncode(e,n){for(let s=0;s<this.builtInEncoders.length;s++){const a=this.builtInEncoders[s];if(a!=null){const l=a(e,n);if(l!=null){const c=-1-s;return new ul(c,l)}}}for(let s=0;s<this.encoders.length;s++){const a=this.encoders[s];if(a!=null){const l=a(e,n);if(l!=null){const c=s;return new ul(c,l)}}}return e instanceof ul?e:null}decode(e,n,s){const a=n<0?this.builtInDecoders[-1-n]:this.decoders[n];return a?a(e,n,s):new ul(n,e)}}Ul.defaultCodec=new Ul;function dk(t){return t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer}function Lp(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):dk(t)?new Uint8Array(t):Uint8Array.from(t)}const fk=100,hk=2048;class tf{constructor(e){this.entered=!1,this.extensionCodec=e?.extensionCodec??Ul.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.maxDepth=e?.maxDepth??fk,this.initialBufferSize=e?.initialBufferSize??hk,this.sortKeys=e?.sortKeys??!1,this.forceFloat32=e?.forceFloat32??!1,this.ignoreUndefined=e?.ignoreUndefined??!1,this.forceIntegerToFloat=e?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new tf({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,n){if(n>this.maxDepth)throw new Error(`Too deep objects in depth ${n}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,n)}ensureBufferSizeToWrite(e){const n=this.pos+e;this.view.byteLength<n&&this.resizeBuffer(n*2)}resizeBuffer(e){const n=new ArrayBuffer(e),s=new Uint8Array(n),a=new DataView(n);s.set(this.bytes),this.view=a,this.bytes=s}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const s=K2(e);this.ensureBufferSizeToWrite(5+s),this.writeStringHeader(s),ek(e,this.bytes,this.pos),this.pos+=s}encodeObject(e,n){const s=this.extensionCodec.tryToEncode(e,this.context);if(s!=null)this.encodeExtension(s);else if(Array.isArray(e))this.encodeArray(e,n);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,n);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const n=e.byteLength;if(n<256)this.writeU8(196),this.writeU8(n);else if(n<65536)this.writeU8(197),this.writeU16(n);else if(n<4294967296)this.writeU8(198),this.writeU32(n);else throw new Error(`Too large binary: ${n}`);const s=Lp(e);this.writeU8a(s)}encodeArray(e,n){const s=e.length;if(s<16)this.writeU8(144+s);else if(s<65536)this.writeU8(220),this.writeU16(s);else if(s<4294967296)this.writeU8(221),this.writeU32(s);else throw new Error(`Too large array: ${s}`);for(const a of e)this.doEncode(a,n+1)}countWithoutUndefined(e,n){let s=0;for(const a of n)e[a]!==void 0&&s++;return s}encodeMap(e,n){const s=Object.keys(e);this.sortKeys&&s.sort();const a=this.ignoreUndefined?this.countWithoutUndefined(e,s):s.length;if(a<16)this.writeU8(128+a);else if(a<65536)this.writeU8(222),this.writeU16(a);else if(a<4294967296)this.writeU8(223),this.writeU32(a);else throw new Error(`Too large map object: ${a}`);for(const l of s){const c=e[l];this.ignoreUndefined&&c===void 0||(this.encodeString(l),this.doEncode(c,n+1))}}encodeExtension(e){if(typeof e.data=="function"){const s=e.data(this.pos+6),a=s.length;if(a>=4294967296)throw new Error(`Too large extension object: ${a}`);this.writeU8(201),this.writeU32(a),this.writeI8(e.type),this.writeU8a(s);return}const n=e.data.length;if(n===1)this.writeU8(212);else if(n===2)this.writeU8(213);else if(n===4)this.writeU8(214);else if(n===8)this.writeU8(215);else if(n===16)this.writeU8(216);else if(n<256)this.writeU8(199),this.writeU8(n);else if(n<65536)this.writeU8(200),this.writeU16(n);else if(n<4294967296)this.writeU8(201),this.writeU32(n);else throw new Error(`Too large extension object: ${n}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const n=e.length;this.ensureBufferSizeToWrite(n),this.bytes.set(e,this.pos),this.pos+=n}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),ak(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),oE(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}}function mk(t,e){return new tf(e).encodeSharedRef(t)}function tp(t){return`${t<0?"-":""}0x${Math.abs(t).toString(16).padStart(2,"0")}`}const pk=16,gk=16;class yk{constructor(e=pk,n=gk){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=n,this.caches=[];for(let s=0;s<this.maxKeyLength;s++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,n,s){const a=this.caches[s-1];e:for(const l of a){const c=l.bytes;for(let d=0;d<s;d++)if(c[d]!==e[n+d])continue e;return l.str}return null}store(e,n){const s=this.caches[e.length-1],a={bytes:e,str:n};s.length>=this.maxLengthPerKey?s[Math.random()*s.length|0]=a:s.push(a)}decode(e,n,s){const a=this.find(e,n,s);if(a!=null)return this.hit++,a;this.miss++;const l=aE(e,n,s),c=Uint8Array.prototype.slice.call(e,n,n+s);return this.store(c,l),l}}const zp="array",Cl="map_key",pE="map_value",vk=t=>{if(typeof t=="string"||typeof t=="number")return t;throw new on("The type of key must be string or number but "+typeof t)};class bk{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const n=this.getUninitializedStateFromPool();n.type=zp,n.position=0,n.size=e,n.array=new Array(e)}pushMapState(e){const n=this.getUninitializedStateFromPool();n.type=Cl,n.readCount=0,n.size=e,n.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===zp){const s=e;s.size=0,s.array=void 0,s.position=0,s.type=void 0}if(e.type===Cl||e.type===pE){const s=e;s.size=0,s.map=void 0,s.readCount=0,s.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const sl=-1,Rg=new DataView(new ArrayBuffer(0)),_k=new Uint8Array(Rg.buffer);try{Rg.getInt8(0)}catch(t){if(!(t instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const nw=new RangeError("Insufficient data"),wk=new yk;class Ls{constructor(e){this.totalPos=0,this.pos=0,this.view=Rg,this.bytes=_k,this.headByte=sl,this.stack=new bk,this.entered=!1,this.extensionCodec=e?.extensionCodec??Ul.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??rl,this.maxBinLength=e?.maxBinLength??rl,this.maxArrayLength=e?.maxArrayLength??rl,this.maxMapLength=e?.maxMapLength??rl,this.maxExtLength=e?.maxExtLength??rl,this.keyDecoder=e?.keyDecoder!==void 0?e.keyDecoder:wk,this.mapKeyConverter=e?.mapKeyConverter??vk}clone(){return new Ls({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=sl,this.stack.reset()}setBuffer(e){const n=Lp(e);this.bytes=n,this.view=new DataView(n.buffer,n.byteOffset,n.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===sl&&!this.hasRemaining(1))this.setBuffer(e);else{const n=this.bytes.subarray(this.pos),s=Lp(e),a=new Uint8Array(n.length+s.length);a.set(n),a.set(s,n.length),this.setBuffer(a)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:n,pos:s}=this;return new RangeError(`Extra ${n.byteLength-s} of ${n.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const n=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return n}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let n=!1,s;for await(const d of e){if(n)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(d);try{s=this.doDecodeSync(),n=!0}catch(h){if(!(h instanceof RangeError))throw h}this.totalPos+=this.pos}if(n){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return s}const{headByte:a,pos:l,totalPos:c}=this;throw new RangeError(`Insufficient data in parsing ${tp(a)} at ${c} (${l} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,n){if(this.entered){yield*this.clone().decodeMultiAsync(e,n);return}try{this.entered=!0;let s=n,a=-1;for await(const l of e){if(n&&a===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(l),s&&(a=this.readArraySize(),s=!1,this.complete());try{for(;yield this.doDecodeSync(),--a!==0;);}catch(c){if(!(c instanceof RangeError))throw c}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let n;if(e>=224)n=e-256;else if(e<192)if(e<128)n=e;else if(e<144){const a=e-128;if(a!==0){this.pushMapState(a),this.complete();continue e}else n={}}else if(e<160){const a=e-144;if(a!==0){this.pushArrayState(a),this.complete();continue e}else n=[]}else{const a=e-160;n=this.decodeString(a,0)}else if(e===192)n=null;else if(e===194)n=!1;else if(e===195)n=!0;else if(e===202)n=this.readF32();else if(e===203)n=this.readF64();else if(e===204)n=this.readU8();else if(e===205)n=this.readU16();else if(e===206)n=this.readU32();else if(e===207)this.useBigInt64?n=this.readU64AsBigInt():n=this.readU64();else if(e===208)n=this.readI8();else if(e===209)n=this.readI16();else if(e===210)n=this.readI32();else if(e===211)this.useBigInt64?n=this.readI64AsBigInt():n=this.readI64();else if(e===217){const a=this.lookU8();n=this.decodeString(a,1)}else if(e===218){const a=this.lookU16();n=this.decodeString(a,2)}else if(e===219){const a=this.lookU32();n=this.decodeString(a,4)}else if(e===220){const a=this.readU16();if(a!==0){this.pushArrayState(a),this.complete();continue e}else n=[]}else if(e===221){const a=this.readU32();if(a!==0){this.pushArrayState(a),this.complete();continue e}else n=[]}else if(e===222){const a=this.readU16();if(a!==0){this.pushMapState(a),this.complete();continue e}else n={}}else if(e===223){const a=this.readU32();if(a!==0){this.pushMapState(a),this.complete();continue e}else n={}}else if(e===196){const a=this.lookU8();n=this.decodeBinary(a,1)}else if(e===197){const a=this.lookU16();n=this.decodeBinary(a,2)}else if(e===198){const a=this.lookU32();n=this.decodeBinary(a,4)}else if(e===212)n=this.decodeExtension(1,0);else if(e===213)n=this.decodeExtension(2,0);else if(e===214)n=this.decodeExtension(4,0);else if(e===215)n=this.decodeExtension(8,0);else if(e===216)n=this.decodeExtension(16,0);else if(e===199){const a=this.lookU8();n=this.decodeExtension(a,1)}else if(e===200){const a=this.lookU16();n=this.decodeExtension(a,2)}else if(e===201){const a=this.lookU32();n=this.decodeExtension(a,4)}else throw new on(`Unrecognized type byte: ${tp(e)}`);this.complete();const s=this.stack;for(;s.length>0;){const a=s.top();if(a.type===zp)if(a.array[a.position]=n,a.position++,a.position===a.size)n=a.array,s.release(a);else continue e;else if(a.type===Cl){if(n==="__proto__")throw new on("The key __proto__ is not allowed");a.key=this.mapKeyConverter(n),a.type=pE;continue e}else if(a.map[a.key]=n,a.readCount++,a.readCount===a.size)n=a.map,s.release(a);else{a.key=null,a.type=Cl;continue e}}return n}}readHeadByte(){return this.headByte===sl&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=sl}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new on(`Unrecognized array type byte: ${tp(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new on(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new on(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,n){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,n):this.decodeBinary(e,n)}decodeUtf8String(e,n){if(e>this.maxStrLength)throw new on(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+n+e)throw nw;const s=this.pos+n;let a;return this.stateIsMapKey()&&this.keyDecoder?.canBeCached(e)?a=this.keyDecoder.decode(this.bytes,s,e):a=ik(this.bytes,s,e),this.pos+=n+e,a}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===Cl:!1}decodeBinary(e,n){if(e>this.maxBinLength)throw new on(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+n))throw nw;const s=this.pos+n,a=this.bytes.subarray(s,s+e);return this.pos+=n+e,a}decodeExtension(e,n){if(e>this.maxExtLength)throw new on(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const s=this.view.getInt8(this.pos+n),a=this.decodeBinary(e,n+1);return this.extensionCodec.decode(a,s,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=ok(this.view,this.pos);return this.pos+=8,e}readI64(){const e=lE(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}}function xk(t,e){return new Ls(e).decode(t)}function Sk(t,e){return new Ls(e).decodeMulti(t)}function Ek(t){return t[Symbol.asyncIterator]!=null}async function*Ck(t){const e=t.getReader();try{for(;;){const{done:n,value:s}=await e.read();if(n)return;yield s}}finally{e.releaseLock()}}function jg(t){return Ek(t)?t:Ck(t)}async function Ak(t,e){const n=jg(t);return new Ls(e).decodeAsync(n)}function Tk(t,e){const n=jg(t);return new Ls(e).decodeArrayStream(n)}function Nk(t,e){const n=jg(t);return new Ls(e).decodeStream(n)}const Ok=Object.freeze(Object.defineProperty({__proto__:null,DecodeError:on,Decoder:Ls,EXT_TIMESTAMP:cE,Encoder:tf,ExtData:ul,ExtensionCodec:Ul,decode:xk,decodeArrayStream:Tk,decodeAsync:Ak,decodeMulti:Sk,decodeMultiStream:Nk,decodeTimestampExtension:mE,decodeTimestampToTimeSpec:hE,encode:mk,encodeDateToTimeSpec:dE,encodeTimeSpecToTimestamp:uE,encodeTimestampExtension:fE},Symbol.toStringTag,{value:"Module"})),Rk=Yx(Ok);var yn={},rw;function jk(){if(rw)return yn;rw=1,Object.defineProperty(yn,"__esModule",{value:!0});function t(P){return{enumerable:!0,value:P}}function e(P){return{enumerable:!0,writable:!0,value:P}}let n={},s=()=>!0,a=()=>({}),l=P=>P,c=(P,H,D,z)=>P.apply(D,z)&&H.apply(D,z),d=(P,H,D,[z,J])=>H.call(D,P.call(D,z,J),J),h=(P,H)=>Object.freeze(Object.create(P,H));function f(P,H,D){return P.reduce((z,J)=>function(...ee){return D(z,J,this,ee)},H)}function g(P){return h(this,{fn:t(P)})}let p={},v=g.bind(p),b=P=>v((H,D)=>!!~P(H,D)&&H),x={},w=g.bind(x);function S(P,H){return H.filter(D=>P.isPrototypeOf(D))}function A(P,H,...D){let z=f(S(x,D).map(ee=>ee.fn),s,c),J=f(S(p,D).map(ee=>ee.fn),l,d);return h(this,{from:t(P),to:t(H),guards:t(z),reducers:t(J)})}let N={},E={},C=A.bind(N),O=A.bind(E,null);function R(P,H,D){return G(H,P,D,this.immediates)||P}function M(P){let H=new Map;for(let D of P)H.has(D.from)||H.set(D.from,[]),H.get(D.from).push(D);return H}let I={enter:l};function q(...P){let H=S(N,P),D=S(E,P),z={final:t(P.length===0),transitions:t(M(H))};return D.length&&(z.immediates=t(D),z.enter=t(R)),h(I,z)}let K={enter(P,H,D){let z=this.fn.call(H,H.context,D);return Q.isPrototypeOf(z)?h(Y,{machine:t(z),transitions:t(this.transitions)}).enter(P,H,D):(z.then(J=>H.send({type:"done",data:J})).catch(J=>H.send({type:"error",error:J})),P)}},Y={enter(P,H,D){if(H.child=V(this.machine,z=>{H.onChange(z),H.child==z&&z.machine.state.value.final&&(delete H.child,H.send({type:"done",data:z.context}))},H.context,D),H.child.machine.state.value.final){let z=H.child.context;return delete H.child,G(H,P,{type:"done",data:z},this.transitions.get("done"))}return P}};function $(P,...H){let D=t(M(H));return Q.isPrototypeOf(P)?h(Y,{machine:t(P),transitions:D}):h(K,{fn:t(P),transitions:D})}let Q={get state(){return{name:this.current,value:this.states[this.current]}}};function B(P,H,D=a){return typeof P!="string"&&(D=H||a,H=P,P=Object.keys(H)[0]),n._create&&n._create(P,H),h(Q,{context:t(D),current:t(P),states:t(H)})}function G(P,H,D,z){let{context:J}=P;for(let{to:ee,guards:he,reducers:pe}of z)if(he(J,D)){P.context=pe.call(P,J,D);let ae=H.original||H,le=h(ae,{current:t(ee),original:{value:ae}});return n._onEnter&&n._onEnter(H,ee,P.context,J,D),le.state.value.enter(le,P,D)}}function k(P,H){let D=H.type||H,{machine:z}=P,{value:J,name:ee}=z.state;return J.transitions.has(D)?G(P,z,H,J.transitions.get(D))||z:(n._send&&n._send(D,ee),z)}let L={send(P){this.machine=k(this,P),this.onChange(this)}};function V(P,H,D,z){let J=Object.create(L,{machine:e(P),context:e(P.context(D,z)),onChange:t(H)});return J.send=J.send.bind(J),J.machine=J.machine.state.value.enter(J.machine,J,z),J}return yn.action=b,yn.createMachine=B,yn.d=n,yn.guard=w,yn.immediate=O,yn.interpret=V,yn.invoke=$,yn.reduce=v,yn.state=q,yn.transition=C,yn}var sw;function kk(){if(sw)return Hu;sw=1,Object.defineProperty(Hu,"__esModule",{value:!0}),Hu.createRealtimeClient=Y;const t=Rk,e=jk(),n=sE(),s=Ai(),a=Ng(),l=Ti(),c=()=>({enqueuedMessage:void 0});function d($){return $.token!==void 0}function h($){return!d($)}function f($,Q){return Object.assign(Object.assign({},$),{enqueuedMessage:Q.message})}function g($){return $.websocket&&$.websocket.readyState===WebSocket.OPEN&&$.websocket.close(),Object.assign(Object.assign({},$),{websocket:void 0})}function p($,Q){return $.websocket&&$.websocket.readyState===WebSocket.OPEN?(Q.message instanceof Uint8Array?$.websocket.send(Q.message):$.websocket.send((0,t.encode)(Q.message)),Object.assign(Object.assign({},$),{enqueuedMessage:void 0})):Object.assign(Object.assign({},$),{enqueuedMessage:Q.message})}function v($){return Object.assign(Object.assign({},$),{token:void 0})}function b($,Q){return Object.assign(Object.assign({},$),{token:Q.token})}function x($,Q){return Object.assign(Object.assign({},$),{websocket:Q.websocket})}const w=(0,e.createMachine)("idle",{idle:(0,e.state)((0,e.transition)("send","connecting",(0,e.reduce)(f)),(0,e.transition)("expireToken","idle",(0,e.reduce)(v)),(0,e.transition)("close","idle",(0,e.reduce)(g))),connecting:(0,e.state)((0,e.transition)("connecting","connecting"),(0,e.transition)("connected","active",(0,e.reduce)(x)),(0,e.transition)("connectionClosed","idle",(0,e.reduce)(g)),(0,e.transition)("send","connecting",(0,e.reduce)(f)),(0,e.transition)("close","idle",(0,e.reduce)(g)),(0,e.immediate)("authRequired",(0,e.guard)(h))),authRequired:(0,e.state)((0,e.transition)("initiateAuth","authInProgress"),(0,e.transition)("send","authRequired",(0,e.reduce)(f)),(0,e.transition)("close","idle",(0,e.reduce)(g))),authInProgress:(0,e.state)((0,e.transition)("authenticated","connecting",(0,e.reduce)(b)),(0,e.transition)("unauthorized","idle",(0,e.reduce)(v),(0,e.reduce)(g)),(0,e.transition)("send","authInProgress",(0,e.reduce)(f)),(0,e.transition)("close","idle",(0,e.reduce)(g))),active:(0,e.state)((0,e.transition)("send","active",(0,e.reduce)(p)),(0,e.transition)("unauthorized","idle",(0,e.reduce)(v)),(0,e.transition)("connectionClosed","idle",(0,e.reduce)(g)),(0,e.transition)("close","idle",(0,e.reduce)(g))),failed:(0,e.state)((0,e.transition)("send","failed"),(0,e.transition)("close","idle",(0,e.reduce)(g)))},c);function S($,{token:Q,maxBuffering:B}){if(B!==void 0&&(B<1||B>60))throw new Error("The `maxBuffering` must be between 1 and 60 (inclusive)");const G=new URLSearchParams({fal_jwt_token:Q});return B!==void 0&&G.set("max_buffering",B.toFixed(0)),`wss://fal.run/${(0,l.ensureEndpointIdFormat)($)}/realtime?${G.toString()}`}const A=128;function N($){return $.status==="error"&&$.error==="Unauthorized"}const E={NORMAL_CLOSURE:1e3},C=new Map,O=new Map;function R($,Q,B){if(!C.has($)){const G=(0,e.interpret)(w,B);C.set($,Object.assign(Object.assign({},G),{throttledSend:Q>0?(0,l.throttle)(G.send,Q,!0):G.send}))}return C.get($)}const M=()=>{},I={send:M,close:M};function q($){return $.status!=="error"&&$.type!=="x-fal-message"&&!K($)}function K($){return $.type==="x-fal-error"}function Y({config:$}){return{connect(Q,B){const{clientOnly:G=(0,l.isReact)()&&!(0,a.isBrowser)(),connectionKey:k=crypto.randomUUID(),maxBuffering:L,throttleInterval:V=A}=B;if(G&&!(0,a.isBrowser)())return I;let P;O.set(k,{onError:B.onError,onResult:B.onResult});const H=()=>O.get(k),D=R(k,V,({context:ee,machine:he,send:pe})=>{const{enqueuedMessage:ae,token:le}=ee;if(he.current==="active"&&ae&&pe({type:"send",message:ae}),he.current==="authRequired"&&le===void 0&&P!==he.current&&(pe({type:"initiateAuth"}),(0,n.getTemporaryAuthToken)(Q,$).then(Z=>{pe({type:"authenticated",token:Z});const de=Math.round(n.TOKEN_EXPIRATION_SECONDS*.9*1e3);setTimeout(()=>{pe({type:"expireToken"})},de)}).catch(Z=>{pe({type:"unauthorized",error:Z})})),he.current==="connecting"&&P!==he.current&&le!==void 0){const Z=new WebSocket(S(Q,{token:le,maxBuffering:L}));Z.onopen=()=>{pe({type:"connected",websocket:Z})},Z.onclose=de=>{if(de.code!==E.NORMAL_CLOSURE){const{onError:ge=M}=H();ge(new s.ApiError({message:`Error closing the connection: ${de.reason}`,status:de.code}))}pe({type:"connectionClosed",code:de.code})},Z.onerror=de=>{const{onError:ge=M}=H();ge(new s.ApiError({message:"Unknown error",status:500}))},Z.onmessage=de=>{const{onResult:ge}=H();if(de.data instanceof ArrayBuffer){const te=(0,t.decode)(new Uint8Array(de.data));ge(te);return}if(de.data instanceof Uint8Array){const te=(0,t.decode)(de.data);ge(te);return}if(de.data instanceof Blob){de.data.arrayBuffer().then(te=>{const ve=(0,t.decode)(new Uint8Array(te));ge(ve)});return}const be=JSON.parse(de.data);if(N(be)){pe({type:"unauthorized",error:new Error("Unauthorized")});return}if(q(be)){ge(be);return}if(K(be)){if(be.error==="TIMEOUT")return;const{onError:te=M}=H();te(new s.ApiError({message:`${be.error}: ${be.reason}`,status:400,body:be}));return}}}P=he.current});return{send:ee=>{D.throttledSend({type:"send",message:ee})},close:()=>{D.send({type:"close"})}}}}}return Hu}var Ts={},iw;function Mk(){if(iw)return Ts;iw=1;var t=Ts&&Ts.__awaiter||function(g,p,v,b){function x(w){return w instanceof v?w:new v(function(S){S(w)})}return new(v||(v=Promise))(function(w,S){function A(C){try{E(b.next(C))}catch(O){S(O)}}function N(C){try{E(b.throw(C))}catch(O){S(O)}}function E(C){C.done?w(C.value):x(C.value).then(A,N)}E((b=b.apply(g,p||[])).next())})};Object.defineProperty(Ts,"__esModule",{value:!0}),Ts.LIFECYCLE_DURATIONS=void 0,Ts.createStorageClient=f;const e=Og(),n=Jl(),s=Ti();Ts.LIFECYCLE_DURATIONS={ONE_DAY:86400,ONE_WEEK:604800,ONE_MONTH:2592e3,ONE_YEAR:31536e3,UNLIMITED:31536e6};function a(g){var p;const[,v]=g.split("/");return(p=v.split(/[-;]/)[0])!==null&&p!==void 0?p:"bin"}function l(g,p,v,b){return t(this,void 0,void 0,function*(){const x=g.name||`${Date.now()}.${a(v)}`,w={};return b&&(w["X-Fal-Object-Lifecycle"]=JSON.stringify(b)),yield(0,n.dispatchRequest)({method:"POST",targetUrl:`${(0,e.getRestApiUrl)()}/storage/upload/initiate?storage_type=fal-cdn-v3`,input:{content_type:v,file_name:x},config:p,headers:w})})}function c(g,p,v,b){return t(this,void 0,void 0,function*(){const x=g.name||`${Date.now()}.${a(v)}`,w={};return b&&(w["X-Fal-Object-Lifecycle"]=JSON.stringify(b)),yield(0,n.dispatchRequest)({method:"POST",targetUrl:`${(0,e.getRestApiUrl)()}/storage/upload/initiate-multipart?storage_type=fal-cdn-v3`,input:{content_type:v,file_name:x},config:p,headers:w})})}function d(g,p,v){return t(this,arguments,void 0,function*(b,x,w,S=3){if(S===0)throw new Error("Part upload failed, retries exhausted");const{fetch:A,responseHandler:N}=w;try{const E=yield A(b,{method:"PUT",body:x});return yield N(E)}catch{return yield d(b,x,w,S-1)}})}function h(g,p,v){return t(this,void 0,void 0,function*(){const{fetch:b,responseHandler:x}=p,w=g.type||"application/octet-stream",{upload_url:S,file_url:A}=yield c(g,p,w,v),N=10*1024*1024,E=Math.ceil(g.size/N),C=new URL(S),O=[];for(let I=0;I<E;I++){const q=I*N,K=Math.min(q+N,g.size),Y=g.slice(q,K),$=I+1,Q=`${C.origin}${C.pathname}/${$}${C.search}`;O.push(yield d(Q,Y,p))}const R=`${C.origin}${C.pathname}/complete${C.search}`,M=yield b(R,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({parts:O.map(I=>({partNumber:I.partNumber,etag:I.etag}))})});return yield x(M),A})}function f({config:g}){const p={upload:(v,b)=>t(this,void 0,void 0,function*(){const x=b?.lifecycle;if(v.size>94371840)return yield h(v,g,x);const w=v.type||"application/octet-stream",{fetch:S,responseHandler:A}=g,{upload_url:N,file_url:E}=yield l(v,g,w,x),C=yield S(N,{method:"PUT",body:v,headers:{"Content-Type":v.type||"application/octet-stream"}});return yield A(C),E}),transformInput:v=>t(this,void 0,void 0,function*(){if(Array.isArray(v))return Promise.all(v.map(b=>p.transformInput(b)));if(v instanceof Blob)return yield p.upload(v);if((0,s.isPlainObject)(v)){const x=Object.entries(v).map(S=>t(this,[S],void 0,function*([A,N]){return[A,yield p.transformInput(N)]})),w=yield Promise.all(x);return Object.fromEntries(w)}return v})};return p}return Ts}var aw;function ow(){if(aw)return xa;aw=1;var t=xa&&xa.__awaiter||function(f,g,p,v){function b(x){return x instanceof p?x:new p(function(w){w(x)})}return new(p||(p=Promise))(function(x,w){function S(E){try{N(v.next(E))}catch(C){w(C)}}function A(E){try{N(v.throw(E))}catch(C){w(C)}}function N(E){E.done?x(E.value):b(E.value).then(S,A)}N((v=v.apply(f,g||[])).next())})};Object.defineProperty(xa,"__esModule",{value:!0}),xa.createFalClient=h;const e=Og(),n=X2(),s=kk(),a=Jl(),l=Ai(),c=Mk(),d=iE();function h(f={}){const g=(0,e.createConfig)(f),p=(0,c.createStorageClient)({config:g}),v=(0,n.createQueueClient)({config:g,storage:p}),b=(0,d.createStreamingClient)({config:g,storage:p}),x=(0,s.createRealtimeClient)({config:g});return{queue:v,realtime:x,storage:p,streaming:b,stream:b.stream,run(w){return t(this,arguments,void 0,function*(S,A={}){const N=A.input?yield p.transformInput(A.input):void 0;return(0,a.dispatchRequest)({method:A.method,targetUrl:(0,a.buildUrl)(S,A),input:N,config:Object.assign(Object.assign({},g),{responseHandler:l.resultResponseHandler}),options:{signal:A.abortSignal,retry:{maxRetries:3,baseDelay:500,maxDelay:15e3}}})})},subscribe:(w,S)=>t(this,void 0,void 0,function*(){const{request_id:A}=yield v.submit(w,S);return S.onEnqueue&&S.onEnqueue(A),yield v.subscribeToStatus(w,Object.assign({requestId:A},S)),v.result(w,{requestId:A})})}}return xa}var il={},lw;function Dk(){if(lw)return il;lw=1,Object.defineProperty(il,"__esModule",{value:!0}),il.isQueueStatus=t,il.isCompletedQueueStatus=e;function t(n){return n&&n.status&&n.response_url}function e(n){return t(n)&&n.status==="COMPLETED"}return il}var cw;function Uk(){return cw||(cw=1,(function(t){var e=oi&&oi.__createBinding||(Object.create?(function(f,g,p,v){v===void 0&&(v=p);var b=Object.getOwnPropertyDescriptor(g,p);(!b||("get"in b?!g.__esModule:b.writable||b.configurable))&&(b={enumerable:!0,get:function(){return g[p]}}),Object.defineProperty(f,v,b)}):(function(f,g,p,v){v===void 0&&(v=p),f[v]=g[p]})),n=oi&&oi.__exportStar||function(f,g){for(var p in f)p!=="default"&&!Object.prototype.hasOwnProperty.call(g,p)&&e(g,f,p)};Object.defineProperty(t,"__esModule",{value:!0}),t.fal=t.parseEndpointId=t.isRetryableError=t.ValidationError=t.ApiError=t.withProxy=t.withMiddleware=t.createFalClient=void 0;const s=ow();var a=ow();Object.defineProperty(t,"createFalClient",{enumerable:!0,get:function(){return a.createFalClient}});var l=rE();Object.defineProperty(t,"withMiddleware",{enumerable:!0,get:function(){return l.withMiddleware}}),Object.defineProperty(t,"withProxy",{enumerable:!0,get:function(){return l.withProxy}});var c=Ai();Object.defineProperty(t,"ApiError",{enumerable:!0,get:function(){return c.ApiError}}),Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return c.ValidationError}});var d=ef();Object.defineProperty(t,"isRetryableError",{enumerable:!0,get:function(){return d.isRetryableError}}),n(Dk(),t);var h=Ti();Object.defineProperty(t,"parseEndpointId",{enumerable:!0,get:function(){return h.parseEndpointId}}),t.fal=(function(){let g=(0,s.createFalClient)();return{config(p){g=(0,s.createFalClient)(p)},get queue(){return g.queue},get realtime(){return g.realtime},get storage(){return g.storage},get streaming(){return g.streaming},run(p,v){return g.run(p,v)},subscribe(p,v){return g.subscribe(p,v)},stream(p,v){return g.stream(p,v)}}})()})(oi)),oi}var uw=Uk();const gE=j.createContext({}),$k=({children:t})=>{const[e,n]=j.useState(null),[s,a]=j.useState(null),[l,c]=j.useState(!1),[d,h]=j.useState(!1),[f,g]=j.useState(""),[p,v]=j.useState(""),[b,x]=j.useState(""),[w,S]=j.useState({}),[A,N]=j.useState({}),O={user:e,setUser:n,userProfile:s,setUserProfile:a,isCollapsed:l,isProfileLoading:d,projectId:f,setProjectId:g,ep_id:p,setEpId:v,editShotId:b,setEditShotId:x,embodyCache:w,setEmbodyCache:S,deepseekProvider:A,setDeepseekProvider:N,fetchUserProfile:async()=>{if(s){console.log("");return}console.log(""),h(!0);const{data:{user:R}}=await Me.auth.getUser();if(!R)return console.error("User not authenticated"),h(!1),null;n(R);const{data:M,error:I}=await Me.from("profiles").select("*").eq("id",R.id).single();if(I)return console.error("Error fetching user profile:",I.message),h(!1),null;a(M),h(!1)},updateEmbodyCache:async()=>{if(console.log(" updateEmbodyCache:",f),!f){console.error("Project ID is not set");return}const{data:R,error:M}=await Me.from("embodys").select("name,type,id,prompt").eq("project_id",parseInt(f));if(M){console.error("Error fetching embody data:",M.message);return}S(R.reduce((I,q)=>({...I,[q.id]:q}),{}))}};return _.jsx(gE.Provider,{value:O,children:t})};function Xr(){const t=j.useContext(gE);if(!t)throw new Error("useGlobal must be used within a GlobalProvider");return t}function Ik(){const{user:t,userProfile:e,fetchUserProfile:n,projectId:s,setProjectId:a,setEpId:l,updateEmbodyCache:c}=Xr(),d=$s();j.useEffect(()=>{n(),Xt.on("StartEditorMode",()=>{h(!0)}),Xt.on("EndEditorMode",()=>{h(!1)}),console.log("LocalStorage:",localStorage.getItem("projectId")),localStorage.getItem("projectId")&&a(localStorage.getItem("projectId")),localStorage.getItem("epId")&&l(localStorage.getItem("epId"))},[]),j.useEffect(()=>{c()},[s]),h(!0);function h(g){const p=document.documentElement;g?(p.style.setProperty("--avatar-size","30px"),p.style.setProperty("--avatar-bacground-color","transparent"),p.style.setProperty("--avatar-bacground-border","none"),p.style.setProperty("--user-text-display","none")):(p.style.setProperty("--avatar-size","50px"),p.style.setProperty("--avatar-bacground-color","#2a2a2a"),p.style.setProperty("--avatar-bacground-border","1px solid #333"),p.style.setProperty("--user-text-display","block"))}function f(){e?.id?d("/profile"):d("/login")}return _.jsxs("div",{className:"user-info-container",onClick:f,children:[_.jsx("img",{src:e?.avatar_url||"./default_avatar.png",alt:"",className:"avatar"}),_.jsxs("div",{className:"user-info-text",children:[_.jsx("p",{children:e?.display_name||""}),_.jsx("p",{children:" : "+e?.gold_coins||"0"})]})]})}function Lk(){const[t,e]=j.useState(""),[n,s]=j.useState(""),[a,l]=j.useState(""),[c,d]=j.useState(!1),h=$s(),f=async g=>{g.preventDefault(),l(""),d(!0);try{const{error:p}=await Me.auth.signInWithPassword({email:t,password:n});if(p){l(p.message);return}h("/profile")}catch{l("")}finally{d(!1)}};return _.jsx("div",{className:"login-container",children:_.jsxs("div",{className:"login-form",children:[_.jsx("h2",{children:""}),a&&_.jsx("p",{className:"error-message",children:a}),_.jsxs("form",{onSubmit:f,children:[_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"email",children:""}),_.jsx("input",{type:"email",id:"email",value:t,onChange:g=>e(g.target.value),required:!0,placeholder:""})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"password",children:""}),_.jsx("input",{type:"password",id:"password",value:n,onChange:g=>s(g.target.value),required:!0,placeholder:""})]}),_.jsx("button",{type:"submit",disabled:c,children:c?"...":""}),_.jsx("div",{className:"register-link",children:_.jsxs("p",{children:["",_.jsx(vi,{to:"/register",children:""})]})})]})]})})}function zk(){const[t,e]=j.useState(""),[n,s]=j.useState(""),[a,l]=j.useState(""),[c,d]=j.useState(""),[h,f]=j.useState(""),[g,p]=j.useState(!1);$s();const v=async b=>{if(b.preventDefault(),d(""),f(""),!t||!n||!a){d("");return}if(n!==a){d("");return}if(n.length<6){d("6");return}p(!0);try{const{error:x}=await Me.auth.signUp({email:t,password:n});if(x){d(x.message);return}f(""),e(""),s(""),l("")}catch{d("")}finally{p(!1)}};return _.jsx("div",{className:"register-container",children:_.jsxs("div",{className:"register-form",children:[_.jsx("h2",{children:""}),c&&_.jsx("p",{className:"error-message",children:c}),h&&_.jsx("p",{className:"success-message",children:h}),_.jsxs("form",{onSubmit:v,children:[_.jsxs("div",{className:"form-group",children:[_.jsxs("label",{htmlFor:"email",children:[" ",_.jsx("span",{className:"required",children:"*"})]}),_.jsx("input",{type:"email",id:"email",value:t,onChange:b=>e(b.target.value),required:!0,placeholder:""})]}),_.jsxs("div",{className:"form-group",children:[_.jsxs("label",{htmlFor:"password",children:[" ",_.jsx("span",{className:"required",children:"*"})]}),_.jsx("input",{type:"password",id:"password",value:n,onChange:b=>s(b.target.value),required:!0,placeholder:"6"})]}),_.jsxs("div",{className:"form-group",children:[_.jsxs("label",{htmlFor:"confirmPassword",children:[" ",_.jsx("span",{className:"required",children:"*"})]}),_.jsx("input",{type:"password",id:"confirmPassword",value:a,onChange:b=>l(b.target.value),required:!0,placeholder:""})]}),_.jsx("button",{type:"submit",disabled:g,children:g?"...":""}),_.jsx("div",{className:"login-link",children:_.jsxs("p",{children:["",_.jsx(vi,{to:"/login",children:""})]})})]})]})})}function Bk({children:t}){return _.jsx("div",{className:"main-panel-header",children:t})}function Pk(){const{user:t,userProfile:e,fetchUserProfile:n,projectId:s,setProjectId:a}=Xr(),[l,c]=j.useState(!1),[d,h]=j.useState(""),[f,g]=j.useState(""),[p,v]=j.useState(!1),[b,x]=j.useState(""),[w,S]=j.useState(""),[A,N]=j.useState([]),[E,C]=j.useState(!0),O=$s(),R=()=>{I(),c(!0)},M=()=>{I(),c(!1)},I=()=>{h(""),g(""),x(""),S("")},q=()=>d.trim()?d.trim().length>50?(x("50"),!1):f.trim().length>200?(x("200"),!1):!0:(x(""),!1),K=()=>{e&&(C(!0),Me.from("projects").select("*").eq("team_id",e?.team_id||null).then(({data:k,error:L})=>{if(C(!1),L){console.error(":",L),x("");return}console.log("projects ",k),N(k)}))},Y=async()=>{if(x(""),!!q())try{v(!0);const{error:k}=await Me.from("projects").insert({name:d.trim(),description:f.trim(),user_id:t?.id,team_id:e?.team_id||null});if(k){console.error(":",k),x(""+k.message);return}await K(),S(""),M()}catch(k){x(""+k.message),console.error(":",k.message)}finally{v(!1)}};j.useEffect(()=>{K()},[e]);const $=k=>{k.key==="Enter"&&!k.shiftKey&&(k.preventDefault(),Y())},Q=k=>{console.log("set project id ",k.id),a(k.id),Xt.emit("StartEditorMode"),localStorage.setItem("projectId",k.id),O("/editor")},B=(k,L)=>{k.stopPropagation(),globalData.projectId=L.id,localStorage.setItem("projectId",L.id),O("/editor"),Xt.emit("StartEditorMode")},G=(k,L)=>{k.stopPropagation(),window.confirm(`"${L.project_name}"`)&&(console.log(":",L.project_name),Me.from("projects").delete().eq("id",L.id).then(({error:V})=>{if(V){console.error(":",V),x("");return}K(),S("")}))};return _.jsxs("div",{children:[_.jsx(Bk,{children:_.jsx("h2",{children:""})}),_.jsx("div",{className:"main-panel-buttons",children:_.jsx("button",{onClick:R,children:""})}),_.jsx("div",{className:`main-panel-content ${A.length===0?"empty":""}`,children:A.length>0?A.map(k=>_.jsxs("div",{className:"project-item",onClick:()=>Q(k),children:[_.jsxs("div",{className:"project-item-content",children:[_.jsx("h4",{children:k.name}),_.jsx("p",{children:k.description})]}),_.jsxs("div",{className:"project-actions",children:[_.jsx("button",{className:"edit-button",onClick:L=>B(L,k),title:"",children:""}),_.jsx("button",{className:"delete-button",onClick:L=>G(L,k),title:"",children:""})]})]},k.id)):E&&_.jsx("div",{className:"loading",children:"..."})}),l&&_.jsx("div",{className:"create-panel-overlay",onClick:M,children:_.jsxs("div",{className:"create-panel",onClick:k=>k.stopPropagation(),children:[_.jsxs("div",{className:"create-panel-header",children:[_.jsx("h3",{children:""}),_.jsx("button",{className:"close-button",onClick:M,disabled:p,children:""})]}),_.jsxs("div",{className:"create-panel-content",children:[b&&_.jsx("div",{className:"error-message",children:b}),w&&_.jsx("div",{className:"success-message",children:w}),_.jsx("input",{type:"text",placeholder:"",className:"story-name-input",value:d,onChange:k=>h(k.target.value),onKeyPress:$,disabled:p||!!w}),_.jsx("textarea",{placeholder:"",className:"story-description-input",value:f,onChange:k=>g(k.target.value),onKeyPress:$,disabled:p||!!w}),_.jsxs("div",{className:"char-count",children:[_.jsxs("span",{children:[": ",d.length,"/50"]}),_.jsxs("span",{children:[": ",f.length,"/200"]})]})]}),_.jsxs("div",{className:"create-panel-footer",children:[_.jsx("button",{className:"cancel-button",onClick:M,disabled:p,children:""}),_.jsxs("button",{className:"confirm-button",onClick:Y,disabled:p||!!w,children:[p&&_.jsx("span",{className:"loading-spinner"}),p?"...":""]})]})]})})]})}function qk(){const{user:t,userProfile:e,isProfileLoading:n,fetchUserProfile:s}=Xr(),[a,l]=j.useState(!1),[c,d]=j.useState(!1),[h,f]=j.useState(""),[g,p]=j.useState(!1),[v,b]=j.useState(""),[x,w]=j.useState("./default_avatar.png"),[S,A]=j.useState(!1),[N,E]=j.useState([]),[C,O]=j.useState(""),[R,M]=j.useState(""),[I,q]=j.useState(""),[K,Y]=j.useState(!1),[$,Q]=j.useState("list"),B=$s();j.useEffect(()=>{e||s()},[]),j.useEffect(()=>{G(),e?.avatar_url&&w(e.avatar_url)},[e]);const G=async()=>{if(!e?.team_id){O("");return}try{const{data:ae,error:le}=await Me.from("teams").select("name").eq("id",e.team_id).single();le?(console.error("Error fetching team name:",le.message),O("")):O(ae.name)}catch(ae){console.error("Error in fetchTeamName:",ae),O("")}},k=async()=>{try{await Me.auth.signOut(),B("/")}catch(ae){console.error(":",ae)}},L=async()=>{try{const{data:ae,error:le}=await Me.from("teams").select("id, name").contains("members",[t.id]);if(le)throw le;E(ae||[])}catch(ae){console.error(":",ae),q("")}},V=()=>{L(),q(""),O(""),M(""),Q("list"),d(!0)},P=()=>{d(!1),q("")},H=async()=>{if(!C.trim()){q("");return}if(C.length>20){q("20");return}Y(!0),q("");try{const{data:ae,error:le}=await Me.from("teams").insert({name:C.trim(),create_by:t.id,members:[t.id]}).select("id, name");if(le)throw le;console.log("newTeam",ae),E(Z=>[...Z,ae[0]]),O(""),q("","success"),Q("list")}catch(ae){console.error(":",ae),q("")}finally{Y(!1)}},D=async()=>{if(!R.trim()){q("");return}Y(!0),q("");try{if(await new Promise(ae=>setTimeout(ae,1e3)),R==="INVITE1"){const ae={id:Date.now().toString(),name:"",code:R};E(le=>[...le,ae]),M(""),q("","success"),Q("list")}else q("")}catch(ae){console.error(":",ae),q("")}finally{Y(!1)}},z=async ae=>{Y(!0);try{const{error:le}=await Me.from("profiles").update({team_id:ae.id}).eq("id",t.id);if(le)throw le;P(),Xt.emit("updateProfile")}catch(le){console.error(":",le),q("")}finally{Y(!1)}},J=()=>{f(profile?.display_name||""),b(""),l(!0)},ee=()=>{l(!1),b("")},he=async ae=>{const le=ae.target.files[0];if(!le)return;if(!["image/jpeg","image/png","image/gif","image/webp"].includes(le.type)){alert("JPG, PNG, GIF, WebP");return}if(le.size>5*1024*1024){alert("5MB");return}A(!0);try{const de=`${Date.now()}${le.name.slice(le.name.lastIndexOf("."))}`;console.log("avatar filename = ",de);const{error:ge}=await Me.storage.from("avatars").upload(`${t.id}/${de}`,le,{cacheControl:"3600",upsert:!1});if(ge)throw ge;const{data:be}=Me.storage.from("avatars").getPublicUrl(`${t.id}/${de}`);console.log("avatar url = ",be.publicUrl),w(be.publicUrl);const{error:te}=await Me.from("profiles").update({avatar_url:be.publicUrl}).eq("id",t.id);te&&console.log("update error = ",te)}catch(de){console.error(":",de),alert("")}finally{A(!1),ae.target.value=""}},pe=async()=>{if(!h.trim()){b("");return}if(h.length>10){b("10");return}p(!0),b("");try{const{error:ae}=await Me.from("profiles").update({display_name:h.trim()}).eq("id",t.id);if(ae){console.error(":",ae),b("");return}Xt.emit("updateProfile"),ee()}catch(ae){console.error(":",ae),b("")}finally{p(!1)}};return n?_.jsx("div",{className:"loading",children:"..."}):_.jsxs("div",{className:"profile-container",children:[_.jsxs("div",{className:"profile-header",children:[_.jsx("h1",{children:""}),_.jsx("button",{className:"logout-button",onClick:k,children:""})]}),_.jsx("div",{className:"profile-info",children:_.jsxs("div",{className:"info-section",children:[_.jsx("h2",{children:""}),_.jsxs("div",{className:"avatar-container",onClick:()=>document.getElementById("avatar-upload").click(),children:[S&&_.jsx("div",{className:"avatar-upload-overlay",children:_.jsx("span",{children:"..."})}),_.jsx("img",{src:x||"./default_avatar.png",alt:"",className:"avatar"}),_.jsx("div",{className:"avatar-hint",children:""}),_.jsx("input",{type:"file",id:"avatar-upload",accept:"image/*",style:{display:"none"},onChange:he})]}),_.jsxs("div",{className:"info-item",children:[_.jsx("span",{className:"label",children:""}),_.jsx("span",{className:"value",children:e?.display_name||""}),_.jsx("button",{className:"",onClick:J,children:""})]}),_.jsxs("div",{className:"info-item",children:[_.jsx("span",{className:"label",children:""}),_.jsx("span",{className:"value",children:e?.gold_coins||"0"}),_.jsx("button",{className:"",children:""})]}),_.jsxs("div",{className:"info-item",children:[_.jsx("span",{className:"label",children:""}),_.jsx("span",{className:"value",children:t?.email||""})]}),_.jsxs("div",{className:"info-item",children:[_.jsx("span",{className:"label",children:""}),_.jsx("span",{className:"value",children:C}),_.jsx("button",{className:"team-switch-button",onClick:V,children:""})]}),_.jsxs("div",{className:"info-item",children:[_.jsx("span",{className:"label",children:""}),_.jsx("span",{className:"value",children:t?.created_at?new Date(t.created_at).toLocaleString():""})]})]})}),a&&_.jsx("div",{className:"modal-overlay",onClick:ee,children:_.jsxs("div",{className:"modal-content",onClick:ae=>ae.stopPropagation(),children:[_.jsxs("div",{className:"modal-header",children:[_.jsx("h3",{children:""}),_.jsx("button",{className:"close-button",onClick:ee,children:""})]}),_.jsxs("div",{className:"modal-body",children:[v&&_.jsx("p",{className:"error-message",children:v}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"displayName",children:""}),_.jsx("input",{type:"text",id:"displayName",value:h,onChange:ae=>f(ae.target.value),placeholder:"",maxLength:50})]})]}),_.jsxs("div",{className:"modal-footer",children:[_.jsx("button",{className:"cancel-button",onClick:ee,children:""}),_.jsx("button",{className:"save-button",onClick:pe,disabled:g,children:g?"...":""})]})]})}),c&&_.jsx("div",{className:"modal-overlay",onClick:P,children:_.jsxs("div",{className:"team-modal-content",onClick:ae=>ae.stopPropagation(),children:[_.jsxs("div",{className:"modal-header",children:[_.jsx("h3",{children:""}),_.jsx("button",{className:"close-button",onClick:P,children:""})]}),_.jsxs("div",{className:"team-modal-tabs",children:[_.jsx("button",{className:`team-tab-button ${$==="list"?"active":""}`,onClick:()=>Q("list"),children:""}),_.jsx("button",{className:`team-tab-button ${$==="create"?"active":""}`,onClick:()=>Q("create"),children:""}),_.jsx("button",{className:`team-tab-button ${$==="join"?"active":""}`,onClick:()=>Q("join"),children:""})]}),_.jsxs("div",{className:"modal-body",children:[I&&_.jsx("p",{className:`${I.includes("")?"success-message":"error-message"}`,children:I}),$==="list"&&_.jsx("div",{className:"team-list",children:N.length===0?_.jsx("p",{className:"empty-message",children:""}):N.map(ae=>_.jsxs("div",{className:"team-item",children:[_.jsx("div",{className:"team-info",children:_.jsx("h4",{children:ae.name})}),_.jsx("button",{className:"switch-team-button",onClick:()=>z(ae),disabled:K,children:K?"...":""})]},ae.id))}),$==="create"&&_.jsxs("div",{className:"create-team-form",children:[_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"teamName",children:""}),_.jsx("input",{type:"text",id:"teamName",value:C,onChange:ae=>O(ae.target.value),placeholder:"",maxLength:20,disabled:K})]}),_.jsx("p",{className:"form-hint",children:""})]}),$==="join"&&_.jsxs("div",{className:"join-team-form",children:[_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"teamCode",children:"ID"}),_.jsx("input",{type:"text",id:"teamCode",value:R,onChange:ae=>M(ae.target.value.toUpperCase()),placeholder:"ID",disabled:K})]}),_.jsx("p",{className:"form-hint",children:""})]})]}),_.jsxs("div",{className:"modal-footer",children:[$!=="list"&&_.jsx("button",{className:"action-button",onClick:$==="create"?H:D,disabled:K,children:K?"...":$==="create"?"":""}),_.jsx("button",{className:"cancel-button",onClick:P,children:""})]})]})})]})}function Hk(){const{user:t,userProfile:e}=Xr();return _.jsxs("div",{className:"home-page",children:[_.jsx("h1",{children:""}),_.jsx("p",{children:t?`: ${t.email}`:""})]})}function ld({id:t,type:e,name:n,pic:s,description:a,onEdit:l,onDelete:c}){const[d,h]=j.useState(""),f={scene:"",character:"",item:""},g={scene:"",character:"",item:""};return j.useEffect(()=>{s&&s.length>0&&h(ka+s[0].path),console.log("EmbodyCard imagePath:",d)},[s]),_.jsxs("div",{className:"embody-card",onClick:()=>l&&l(t),children:[_.jsxs("div",{className:"embody-card-header",children:[_.jsxs("div",{className:"embody-card-type",children:[_.jsx("span",{className:"type-icon",children:f[e]}),_.jsx("span",{className:"type-name",children:g[e]})]}),_.jsx("div",{className:"embody-card-actions",children:_.jsx("button",{className:"card-action-btn delete-btn",onClick:()=>c&&c(t),title:"",children:""})})]}),_.jsx("div",{className:"embody-card-image",children:s?_.jsx("img",{src:d,alt:n}):_.jsx("div",{className:"placeholder-image",children:f[e]})}),_.jsxs("div",{className:"embody-card-content",children:[_.jsx("h3",{className:"embody-card-title",children:n}),_.jsx("p",{className:"embody-card-description",children:a||""})]})]})}function Vk(){const{projectId:t,ep_id:e,embodyCache:n,editShotId:s,setEditShotId:a}=Xr(),[l,c]=j.useState([]),[d,h]=j.useState({}),[f,g]=j.useState({}),[p,v]=j.useState({}),[b,x]=j.useState({}),[w,S]=j.useState(null),[A,N]=j.useState(null),[E,C]=j.useState(""),[O,R]=j.useState(null),[M,I]=j.useState([]);j.useRef(null);const[q,K]=j.useState([]),[Y,$]=j.useState(""),[Q,B]=j.useState(""),[G,k]=j.useState(!1),[L,V]=j.useState([]),[P,H]=j.useState(""),[D,z]=j.useState([]),[J,ee]=j.useState({}),[he,pe]=j.useState(!1),[ae,le]=j.useState(null),[Z,de]=j.useState(null),[ge,be]=j.useState(""),[te,ve]=j.useState(""),_e=async()=>{Me.from("movie_eps").select("title,index").eq("id",e).single().then(({data:we,error:De})=>{if(De){console.error("EP:",De);return}$(we.title||`EP ${we.index||""}`),B(we.index||"")});const{data:me,error:Ee}=await Me.from("movie_scs").select(`
        *,
        movie_seqs(
          *,
          movie_shots(
            *
          )
        ).order(index, ascending) 
      `).order("index",{ascending:!0}).eq("ep_id",e);if(Ee){console.error(":",Ee);return}console.log(":",me),me.forEach(we=>{we.movie_seqs.forEach(De=>{De.movie_shots.sort((ht,Mt)=>ht.index-Mt.index),De.movie_shots.forEach(ht=>{d[ht.id]=ht})})}),K(me)};j.useEffect(()=>{e&&_e()},[e]);const Ie=me=>{const Ee={seq_id:me,description:"",prompt:"",embodys:[]};console.log("newShot",Ee),Me.from("movie_shots").insert(Ee).then(({data:we,error:De})=>{if(De){console.error(":",De);return}console.log(":",we),_e()})},qe=me=>{a(me),console.log(":",me),Xt.emit("changeEditorMode","edit")},ot=me=>{window.confirm(""+me)&&Me.from("movie_seqs").delete().eq("id",me).then(({data:Ee,error:we})=>{if(we){console.error(":",we);return}console.log(":",Ee),_e()})};function kt(me,Ee){console.log(":",me,Ee),N(me),C(Ee);const we=d[me][Ee]||"";if(console.log(we),R(we),Ee==="embodys"){var De=[];we.forEach(ht=>{n[ht]?De.push(n[ht]):console.error("ID:",ht)}),console.log("emlist",De),I(De)}}const In=me=>({character:"#3498db",item:"#2ecc71",scene:"#e74c3c",:"#f39c12",:"#9b59b6"})[me]||"#95a5a6",Jt=me=>!me||me===""||me===""||!Array.isArray(me)||me.length===0?"":me.map((we,De)=>{if(n&&n[we]){const ht=n[we],Mt=In(ht.type);return _.jsxs("span",{style:{marginRight:"8px"},children:[_.jsx("span",{style:{color:Mt,fontWeight:"bold",marginRight:"2px"},children:ht.name}),De<me.length-1&&", "]},we)}else return console.log("ID:",we),_.jsxs("span",{style:{marginRight:"8px",color:"#999"},children:["",De<me.length-1&&", "]},we)}),Ln=me=>{z(Ee=>Ee.includes(me)?Ee.filter(we=>we!==me):[...Ee,me])},pr=()=>{const me=L.filter(De=>D.includes(De.id)),Ee=new Set(M.map(De=>De.name)),we=me.filter(De=>!Ee.has(De.name)).map(De=>({id:De.id,name:De.name,type:De.type}));console.log(":",we),I(De=>[...De,...we]),k(!1),z([]),H("")},At=async me=>{if(me.preventDefault(),n){const Ee=Object.values(n);V(Ee),console.log("embodyCache:",Ee.length)}else console.warn("embodyCache"),V([]);k(!0)},Qr=me=>{const Ee=[...M];Ee.splice(me,1),I(Ee)},Cn=()=>{},tr=me=>{window.confirm(""+me)&&Me.from("movie_shots").delete().eq("id",me).then(({data:Ee,error:we})=>{if(we){console.error(":",we);return}console.log(":",Ee),_e()})},gr=me=>{window.confirm(""+me)&&Me.from("movie_scs").delete().eq("id",me).then(({data:Ee,error:we})=>{if(we){console.error(":",we);return}console.log(":",Ee),_e()})},eo=(me,Ee)=>{le(me),de(Ee),be(""),ve(""),pe(!0)},Wr=async()=>{if(!ge.trim()){alert("");return}try{const{data:me,error:Ee}=await Me.from("movie_seqs").select("index").eq("sc_id",ae).order("index",{ascending:!1}).limit(1);let we=1;!Ee&&me&&me.length>0&&(we=me[0].index+1);const De={sc_id:ae,name:ge.trim(),index:we},{data:ht,error:Mt}=await Me.from("movie_seqs").insert(De);if(Mt){console.error(":",Mt),alert("");return}console.log(":",ht),_e(),pe(!1)}catch(me){console.error(":",me),alert("")}},zs=async()=>{if(!A||!E){console.error("");return}try{let me=O;if(console.log(O),E==="embodys"){const ht=(Array.isArray(M)?M:[]).filter(Mt=>Mt&&Mt.id);me=ht.map(Mt=>Mt.id),console.log(":",ht)}const{data:Ee,error:we}=await Me.from("movie_shots").update({[E]:me}).eq("id",A);if(we){console.error(":",we),alert("");return}d[A]&&(d[A][E]=me,h({...d})),await _e()}catch(me){console.error(":",me),alert("")}finally{N(null),C(null),R(""),I([])}},to=async()=>{try{const{data:me,error:Ee}=await Me.from("movie_scs").select("index").eq("ep_id",e).order("index",{ascending:!1}).limit(1);let we=1;!Ee&&me&&me.length>0&&(we=me[0].index+1);const De={ep_id:e,name:"",index:we},{data:ht,error:Mt}=await Me.from("movie_scs").insert(De);if(Mt){console.error(":",Mt),alert("");return}console.log(":",ht),_e()}catch(me){console.error(":",me),alert("")}};return _.jsxs("div",{className:"editor-shots-content",children:[_.jsxs("div",{className:"editor-shots-header",children:[_.jsxs("h3",{className:"ep-number",children:[" ",Q,"   -  ",Y]}),_.jsx("button",{className:"add-sc-button",onClick:to,children:""})]}),_.jsx("div",{className:"editor-shots-container-left",children:q.map(me=>_.jsxs("div",{className:"sc-card",children:[_.jsxs("div",{className:"sc-card-header",children:[_.jsxs("h3",{className:"sc-name",children:["",me.index,"-",me.name]}),_.jsx("button",{className:"add-seq-button",title:"",onClick:()=>gr(me.id),children:"-"}),_.jsx("button",{className:"add-seq-button",title:"",onClick:()=>eo(me.id,me.index),children:"+"})]}),_.jsx("div",{className:"sc-seqs",children:me.movie_seqs.map(Ee=>_.jsxs("div",{className:"seq-item",children:[_.jsxs("div",{className:"seq-item-header",children:[_.jsx("p",{className:"seq-item-name",children:Ee.name}),_.jsx("button",{className:"add-shot-button",title:"",onClick:()=>ot(Ee.id),children:"-"}),_.jsx("button",{className:"add-shot-button",title:"",onClick:()=>Ie(Ee.id),children:"+"})]}),_.jsx("div",{className:"seq-shots",children:_.jsxs("table",{className:"shot-table",children:[_.jsx("thead",{children:_.jsxs("tr",{children:[_.jsx("th",{children:""}),_.jsx("th",{children:""}),_.jsx("th",{children:""}),_.jsx("th",{children:""}),_.jsx("th",{children:""}),_.jsx("th",{children:""})]})}),_.jsx("tbody",{children:Ee.movie_shots.map((we,De)=>_.jsxs("tr",{className:"shot-item",children:[_.jsx("td",{children:we.index}),_.jsx("td",{children:we.pic?_.jsx("img",{src:we.pic,alt:we.descript||"./shot_thumb_default.png",style:{width:"50px",height:"50px"}}):_.jsx("img",{src:"./shot_thumb_default.png",alt:"",style:{width:"60px",height:"50px"}})}),_.jsx("td",{onClick:()=>kt(we.id,"description"),style:{cursor:"pointer"},children:we.description||""}),_.jsx("td",{onClick:()=>kt(we.id,"prompt"),style:{cursor:"pointer"},children:we.prompt||""}),_.jsx("td",{onClick:()=>kt(we.id,"embodys"),style:{cursor:"pointer"},children:Jt(we.embodys)}),_.jsxs("td",{className:"shot-action-buttons",children:[_.jsx("button",{onClick:()=>qe(we.id),title:"",className:"op-button op-edit-button",children:""}),_.jsx("button",{onClick:()=>tr(we.id),title:"",className:"op-button op-delete-button",children:""})]})]},we.id))})]})})]},Ee.id))})]},me.index))}),_.jsxs("div",{className:"editor-shots-container-right",style:{display:A?"block":"none"},children:[E==="description"&&_.jsxs("div",{className:"right-edit-field",children:[_.jsx("label",{children:":"}),_.jsx("textarea",{className:"edit-field-textarea",value:O,onChange:me=>R(me.target.value)}),_.jsxs("div",{className:"edit-button-container",children:[_.jsx("button",{className:"expand-button",onClick:Cn,children:""}),_.jsx("button",{className:"save-button",onClick:zs,children:""})]})]}),E==="prompt"&&_.jsxs("div",{className:"right-edit-field",children:[_.jsx("label",{children:":"}),_.jsx("textarea",{className:"edit-field-textarea",value:O,onChange:me=>R(me.target.value)}),_.jsxs("div",{className:"edit-button-container",children:[_.jsx("button",{className:"expand-button",onClick:Cn,children:""}),_.jsx("button",{className:"save-button",onClick:zs,children:""})]})]}),E==="embodys"&&_.jsxs("div",{className:"right-edit-field",children:[_.jsx("label",{children:":"}),_.jsx("div",{className:"embodys-list-container",children:_.jsx("div",{className:"embodys-list",children:M.map((me,Ee)=>_.jsxs("div",{className:"embodys-item",children:[_.jsx("span",{className:"embodys-name",children:me.name}),_.jsx("span",{className:"embodys-type",children:me.type}),_.jsx("button",{className:"delete-embodys-item",onClick:()=>Qr(Ee),children:""})]},Ee))})}),_.jsxs("div",{className:"edit-button-container",children:[_.jsx("button",{className:"add-embodys-button",onClick:At,children:""}),_.jsx("button",{className:"save-button",onClick:zs,children:""})]})]})]}),he&&_.jsx("div",{className:"modal-overlay",children:_.jsxs("div",{className:"modal-content",children:[_.jsxs("div",{className:"modal-header",children:[_.jsx("h3",{children:""}),_.jsx("button",{className:"modal-close",onClick:()=>pe(!1),children:""})]}),_.jsx("div",{className:"modal-body",children:_.jsxs("div",{className:"form-group",children:[_.jsx("label",{children:":"}),_.jsx("input",{type:"text",value:ge,onChange:me=>be(me.target.value),placeholder:"",className:"modal-input"})]})}),_.jsxs("div",{className:"modal-footer",children:[_.jsx("button",{className:"modal-cancel",onClick:()=>pe(!1),children:""}),_.jsx("button",{className:"modal-confirm",onClick:Wr,children:""})]})]})}),G&&_.jsx("div",{className:"modal-overlay",children:_.jsxs("div",{className:"modal-content embody-select-modal",children:[_.jsxs("div",{className:"modal-header",children:[_.jsx("h3",{children:""}),_.jsx("button",{className:"modal-close",onClick:()=>{k(!1),z([]),H("")},children:""})]}),_.jsxs("div",{className:"modal-body",children:[_.jsxs("div",{className:"form-group",children:[_.jsx("label",{children:":"}),_.jsx("input",{type:"text",value:P,onChange:me=>H(me.target.value),placeholder:"",className:"modal-input"})]}),_.jsxs("div",{className:"embodys-select-list card-view",children:[L.filter(me=>me.name.toLowerCase().includes(P.toLowerCase())||me.description?.toLowerCase().includes(P.toLowerCase())).map(me=>_.jsxs("div",{className:`embody-card-wrapper ${D.includes(me.id)?"selected":""}`,onClick:Ee=>{Ee.stopPropagation(),Ln(me.id)},children:[_.jsx(ld,{id:me.id,type:me.type,name:me.name,pic:me.pic,description:me.description,onEdit:()=>{},onDelete:()=>{}}),D.includes(me.id)&&_.jsx("div",{className:"card-select-indicator",children:""})]},me.id)),L.filter(me=>me.name.toLowerCase().includes(P.toLowerCase())||me.description?.toLowerCase().includes(P.toLowerCase())).length===0&&_.jsx("p",{className:"no-results",children:""})]})]}),_.jsxs("div",{className:"modal-footer",children:[_.jsx("button",{className:"modal-cancel",onClick:()=>{k(!1),z([]),H("")},children:""}),_.jsxs("button",{className:"modal-confirm",onClick:pr,disabled:D.length===0,children:[" (",D.length,")"]})]})]})})]})}function Ct(t){if(typeof t=="string"||typeof t=="number")return""+t;let e="";if(Array.isArray(t))for(let n=0,s;n<t.length;n++)(s=Ct(t[n]))!==""&&(e+=(e&&" ")+s);else for(let n in t)t[n]&&(e+=(e&&" ")+n);return e}var Fk={value:()=>{}};function nf(){for(var t=0,e=arguments.length,n={},s;t<e;++t){if(!(s=arguments[t]+"")||s in n||/[\s.]/.test(s))throw new Error("illegal type: "+s);n[s]=[]}return new cd(n)}function cd(t){this._=t}function Yk(t,e){return t.trim().split(/^|\s+/).map(function(n){var s="",a=n.indexOf(".");if(a>=0&&(s=n.slice(a+1),n=n.slice(0,a)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:s}})}cd.prototype=nf.prototype={constructor:cd,on:function(t,e){var n=this._,s=Yk(t+"",n),a,l=-1,c=s.length;if(arguments.length<2){for(;++l<c;)if((a=(t=s[l]).type)&&(a=Gk(n[a],t.name)))return a;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++l<c;)if(a=(t=s[l]).type)n[a]=dw(n[a],t.name,e);else if(e==null)for(a in n)n[a]=dw(n[a],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new cd(t)},call:function(t,e){if((a=arguments.length-2)>0)for(var n=new Array(a),s=0,a,l;s<a;++s)n[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(l=this._[t],s=0,a=l.length;s<a;++s)l[s].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var s=this._[t],a=0,l=s.length;a<l;++a)s[a].value.apply(e,n)}};function Gk(t,e){for(var n=0,s=t.length,a;n<s;++n)if((a=t[n]).name===e)return a.value}function dw(t,e,n){for(var s=0,a=t.length;s<a;++s)if(t[s].name===e){t[s]=Fk,t=t.slice(0,s).concat(t.slice(s+1));break}return n!=null&&t.push({name:e,value:n}),t}var Bp="http://www.w3.org/1999/xhtml";const fw={svg:"http://www.w3.org/2000/svg",xhtml:Bp,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function rf(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),fw.hasOwnProperty(e)?{space:fw[e],local:t}:t}function Xk(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Bp&&e.documentElement.namespaceURI===Bp?e.createElement(t):e.createElementNS(n,t)}}function Kk(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function yE(t){var e=rf(t);return(e.local?Kk:Xk)(e)}function Qk(){}function kg(t){return t==null?Qk:function(){return this.querySelector(t)}}function Wk(t){typeof t!="function"&&(t=kg(t));for(var e=this._groups,n=e.length,s=new Array(n),a=0;a<n;++a)for(var l=e[a],c=l.length,d=s[a]=new Array(c),h,f,g=0;g<c;++g)(h=l[g])&&(f=t.call(h,h.__data__,g,l))&&("__data__"in h&&(f.__data__=h.__data__),d[g]=f);return new En(s,this._parents)}function Jk(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Zk(){return[]}function vE(t){return t==null?Zk:function(){return this.querySelectorAll(t)}}function eM(t){return function(){return Jk(t.apply(this,arguments))}}function tM(t){typeof t=="function"?t=eM(t):t=vE(t);for(var e=this._groups,n=e.length,s=[],a=[],l=0;l<n;++l)for(var c=e[l],d=c.length,h,f=0;f<d;++f)(h=c[f])&&(s.push(t.call(h,h.__data__,f,c)),a.push(h));return new En(s,a)}function bE(t){return function(){return this.matches(t)}}function _E(t){return function(e){return e.matches(t)}}var nM=Array.prototype.find;function rM(t){return function(){return nM.call(this.children,t)}}function sM(){return this.firstElementChild}function iM(t){return this.select(t==null?sM:rM(typeof t=="function"?t:_E(t)))}var aM=Array.prototype.filter;function oM(){return Array.from(this.children)}function lM(t){return function(){return aM.call(this.children,t)}}function cM(t){return this.selectAll(t==null?oM:lM(typeof t=="function"?t:_E(t)))}function uM(t){typeof t!="function"&&(t=bE(t));for(var e=this._groups,n=e.length,s=new Array(n),a=0;a<n;++a)for(var l=e[a],c=l.length,d=s[a]=[],h,f=0;f<c;++f)(h=l[f])&&t.call(h,h.__data__,f,l)&&d.push(h);return new En(s,this._parents)}function wE(t){return new Array(t.length)}function dM(){return new En(this._enter||this._groups.map(wE),this._parents)}function Od(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Od.prototype={constructor:Od,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function fM(t){return function(){return t}}function hM(t,e,n,s,a,l){for(var c=0,d,h=e.length,f=l.length;c<f;++c)(d=e[c])?(d.__data__=l[c],s[c]=d):n[c]=new Od(t,l[c]);for(;c<h;++c)(d=e[c])&&(a[c]=d)}function mM(t,e,n,s,a,l,c){var d,h,f=new Map,g=e.length,p=l.length,v=new Array(g),b;for(d=0;d<g;++d)(h=e[d])&&(v[d]=b=c.call(h,h.__data__,d,e)+"",f.has(b)?a[d]=h:f.set(b,h));for(d=0;d<p;++d)b=c.call(t,l[d],d,l)+"",(h=f.get(b))?(s[d]=h,h.__data__=l[d],f.delete(b)):n[d]=new Od(t,l[d]);for(d=0;d<g;++d)(h=e[d])&&f.get(v[d])===h&&(a[d]=h)}function pM(t){return t.__data__}function gM(t,e){if(!arguments.length)return Array.from(this,pM);var n=e?mM:hM,s=this._parents,a=this._groups;typeof t!="function"&&(t=fM(t));for(var l=a.length,c=new Array(l),d=new Array(l),h=new Array(l),f=0;f<l;++f){var g=s[f],p=a[f],v=p.length,b=yM(t.call(g,g&&g.__data__,f,s)),x=b.length,w=d[f]=new Array(x),S=c[f]=new Array(x),A=h[f]=new Array(v);n(g,p,w,S,A,b,e);for(var N=0,E=0,C,O;N<x;++N)if(C=w[N]){for(N>=E&&(E=N+1);!(O=S[E])&&++E<x;);C._next=O||null}}return c=new En(c,s),c._enter=d,c._exit=h,c}function yM(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function vM(){return new En(this._exit||this._groups.map(wE),this._parents)}function bM(t,e,n){var s=this.enter(),a=this,l=this.exit();return typeof t=="function"?(s=t(s),s&&(s=s.selection())):s=s.append(t+""),e!=null&&(a=e(a),a&&(a=a.selection())),n==null?l.remove():n(l),s&&a?s.merge(a).order():a}function _M(t){for(var e=t.selection?t.selection():t,n=this._groups,s=e._groups,a=n.length,l=s.length,c=Math.min(a,l),d=new Array(a),h=0;h<c;++h)for(var f=n[h],g=s[h],p=f.length,v=d[h]=new Array(p),b,x=0;x<p;++x)(b=f[x]||g[x])&&(v[x]=b);for(;h<a;++h)d[h]=n[h];return new En(d,this._parents)}function wM(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var s=t[e],a=s.length-1,l=s[a],c;--a>=0;)(c=s[a])&&(l&&c.compareDocumentPosition(l)^4&&l.parentNode.insertBefore(c,l),l=c);return this}function xM(t){t||(t=SM);function e(p,v){return p&&v?t(p.__data__,v.__data__):!p-!v}for(var n=this._groups,s=n.length,a=new Array(s),l=0;l<s;++l){for(var c=n[l],d=c.length,h=a[l]=new Array(d),f,g=0;g<d;++g)(f=c[g])&&(h[g]=f);h.sort(e)}return new En(a,this._parents).order()}function SM(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function EM(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function CM(){return Array.from(this)}function AM(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var s=t[e],a=0,l=s.length;a<l;++a){var c=s[a];if(c)return c}return null}function TM(){let t=0;for(const e of this)++t;return t}function NM(){return!this.node()}function OM(t){for(var e=this._groups,n=0,s=e.length;n<s;++n)for(var a=e[n],l=0,c=a.length,d;l<c;++l)(d=a[l])&&t.call(d,d.__data__,l,a);return this}function RM(t){return function(){this.removeAttribute(t)}}function jM(t){return function(){this.removeAttributeNS(t.space,t.local)}}function kM(t,e){return function(){this.setAttribute(t,e)}}function MM(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function DM(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function UM(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function $M(t,e){var n=rf(t);if(arguments.length<2){var s=this.node();return n.local?s.getAttributeNS(n.space,n.local):s.getAttribute(n)}return this.each((e==null?n.local?jM:RM:typeof e=="function"?n.local?UM:DM:n.local?MM:kM)(n,e))}function xE(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function IM(t){return function(){this.style.removeProperty(t)}}function LM(t,e,n){return function(){this.style.setProperty(t,e,n)}}function zM(t,e,n){return function(){var s=e.apply(this,arguments);s==null?this.style.removeProperty(t):this.style.setProperty(t,s,n)}}function BM(t,e,n){return arguments.length>1?this.each((e==null?IM:typeof e=="function"?zM:LM)(t,e,n??"")):Ba(this.node(),t)}function Ba(t,e){return t.style.getPropertyValue(e)||xE(t).getComputedStyle(t,null).getPropertyValue(e)}function PM(t){return function(){delete this[t]}}function qM(t,e){return function(){this[t]=e}}function HM(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function VM(t,e){return arguments.length>1?this.each((e==null?PM:typeof e=="function"?HM:qM)(t,e)):this.node()[t]}function SE(t){return t.trim().split(/^|\s+/)}function Mg(t){return t.classList||new EE(t)}function EE(t){this._node=t,this._names=SE(t.getAttribute("class")||"")}EE.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function CE(t,e){for(var n=Mg(t),s=-1,a=e.length;++s<a;)n.add(e[s])}function AE(t,e){for(var n=Mg(t),s=-1,a=e.length;++s<a;)n.remove(e[s])}function FM(t){return function(){CE(this,t)}}function YM(t){return function(){AE(this,t)}}function GM(t,e){return function(){(e.apply(this,arguments)?CE:AE)(this,t)}}function XM(t,e){var n=SE(t+"");if(arguments.length<2){for(var s=Mg(this.node()),a=-1,l=n.length;++a<l;)if(!s.contains(n[a]))return!1;return!0}return this.each((typeof e=="function"?GM:e?FM:YM)(n,e))}function KM(){this.textContent=""}function QM(t){return function(){this.textContent=t}}function WM(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function JM(t){return arguments.length?this.each(t==null?KM:(typeof t=="function"?WM:QM)(t)):this.node().textContent}function ZM(){this.innerHTML=""}function eD(t){return function(){this.innerHTML=t}}function tD(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function nD(t){return arguments.length?this.each(t==null?ZM:(typeof t=="function"?tD:eD)(t)):this.node().innerHTML}function rD(){this.nextSibling&&this.parentNode.appendChild(this)}function sD(){return this.each(rD)}function iD(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function aD(){return this.each(iD)}function oD(t){var e=typeof t=="function"?t:yE(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function lD(){return null}function cD(t,e){var n=typeof t=="function"?t:yE(t),s=e==null?lD:typeof e=="function"?e:kg(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),s.apply(this,arguments)||null)})}function uD(){var t=this.parentNode;t&&t.removeChild(this)}function dD(){return this.each(uD)}function fD(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function hD(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function mD(t){return this.select(t?hD:fD)}function pD(t){return arguments.length?this.property("__data__",t):this.node().__data__}function gD(t){return function(e){t.call(this,e,this.__data__)}}function yD(t){return t.trim().split(/^|\s+/).map(function(e){var n="",s=e.indexOf(".");return s>=0&&(n=e.slice(s+1),e=e.slice(0,s)),{type:e,name:n}})}function vD(t){return function(){var e=this.__on;if(e){for(var n=0,s=-1,a=e.length,l;n<a;++n)l=e[n],(!t.type||l.type===t.type)&&l.name===t.name?this.removeEventListener(l.type,l.listener,l.options):e[++s]=l;++s?e.length=s:delete this.__on}}}function bD(t,e,n){return function(){var s=this.__on,a,l=gD(e);if(s){for(var c=0,d=s.length;c<d;++c)if((a=s[c]).type===t.type&&a.name===t.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=l,a.options=n),a.value=e;return}}this.addEventListener(t.type,l,n),a={type:t.type,name:t.name,value:e,listener:l,options:n},s?s.push(a):this.__on=[a]}}function _D(t,e,n){var s=yD(t+""),a,l=s.length,c;if(arguments.length<2){var d=this.node().__on;if(d){for(var h=0,f=d.length,g;h<f;++h)for(a=0,g=d[h];a<l;++a)if((c=s[a]).type===g.type&&c.name===g.name)return g.value}return}for(d=e?bD:vD,a=0;a<l;++a)this.each(d(s[a],e,n));return this}function TE(t,e,n){var s=xE(t),a=s.CustomEvent;typeof a=="function"?a=new a(e,n):(a=s.document.createEvent("Event"),n?(a.initEvent(e,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(e,!1,!1)),t.dispatchEvent(a)}function wD(t,e){return function(){return TE(this,t,e)}}function xD(t,e){return function(){return TE(this,t,e.apply(this,arguments))}}function SD(t,e){return this.each((typeof e=="function"?xD:wD)(t,e))}function*ED(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var s=t[e],a=0,l=s.length,c;a<l;++a)(c=s[a])&&(yield c)}var NE=[null];function En(t,e){this._groups=t,this._parents=e}function Zl(){return new En([[document.documentElement]],NE)}function CD(){return this}En.prototype=Zl.prototype={constructor:En,select:Wk,selectAll:tM,selectChild:iM,selectChildren:cM,filter:uM,data:gM,enter:dM,exit:vM,join:bM,merge:_M,selection:CD,order:wM,sort:xM,call:EM,nodes:CM,node:AM,size:TM,empty:NM,each:OM,attr:$M,style:BM,property:VM,classed:XM,text:JM,html:nD,raise:sD,lower:aD,append:oD,insert:cD,remove:dD,clone:mD,datum:pD,on:_D,dispatch:SD,[Symbol.iterator]:ED};function Sn(t){return typeof t=="string"?new En([[document.querySelector(t)]],[document.documentElement]):new En([[t]],NE)}function AD(t){let e;for(;e=t.sourceEvent;)t=e;return t}function Kn(t,e){if(t=AD(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var s=n.createSVGPoint();return s.x=t.clientX,s.y=t.clientY,s=s.matrixTransform(e.getScreenCTM().inverse()),[s.x,s.y]}if(e.getBoundingClientRect){var a=e.getBoundingClientRect();return[t.clientX-a.left-e.clientLeft,t.clientY-a.top-e.clientTop]}}return[t.pageX,t.pageY]}const TD={passive:!1},$l={capture:!0,passive:!1};function np(t){t.stopImmediatePropagation()}function Ia(t){t.preventDefault(),t.stopImmediatePropagation()}function OE(t){var e=t.document.documentElement,n=Sn(t).on("dragstart.drag",Ia,$l);"onselectstart"in e?n.on("selectstart.drag",Ia,$l):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function RE(t,e){var n=t.document.documentElement,s=Sn(t).on("dragstart.drag",null);e&&(s.on("click.drag",Ia,$l),setTimeout(function(){s.on("click.drag",null)},0)),"onselectstart"in n?s.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Vu=t=>()=>t;function Pp(t,{sourceEvent:e,subject:n,target:s,identifier:a,active:l,x:c,y:d,dx:h,dy:f,dispatch:g}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:s,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:l,enumerable:!0,configurable:!0},x:{value:c,enumerable:!0,configurable:!0},y:{value:d,enumerable:!0,configurable:!0},dx:{value:h,enumerable:!0,configurable:!0},dy:{value:f,enumerable:!0,configurable:!0},_:{value:g}})}Pp.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function ND(t){return!t.ctrlKey&&!t.button}function OD(){return this.parentNode}function RD(t,e){return e??{x:t.x,y:t.y}}function jD(){return navigator.maxTouchPoints||"ontouchstart"in this}function jE(){var t=ND,e=OD,n=RD,s=jD,a={},l=nf("start","drag","end"),c=0,d,h,f,g,p=0;function v(C){C.on("mousedown.drag",b).filter(s).on("touchstart.drag",S).on("touchmove.drag",A,TD).on("touchend.drag touchcancel.drag",N).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function b(C,O){if(!(g||!t.call(this,C,O))){var R=E(this,e.call(this,C,O),C,O,"mouse");R&&(Sn(C.view).on("mousemove.drag",x,$l).on("mouseup.drag",w,$l),OE(C.view),np(C),f=!1,d=C.clientX,h=C.clientY,R("start",C))}}function x(C){if(Ia(C),!f){var O=C.clientX-d,R=C.clientY-h;f=O*O+R*R>p}a.mouse("drag",C)}function w(C){Sn(C.view).on("mousemove.drag mouseup.drag",null),RE(C.view,f),Ia(C),a.mouse("end",C)}function S(C,O){if(t.call(this,C,O)){var R=C.changedTouches,M=e.call(this,C,O),I=R.length,q,K;for(q=0;q<I;++q)(K=E(this,M,C,O,R[q].identifier,R[q]))&&(np(C),K("start",C,R[q]))}}function A(C){var O=C.changedTouches,R=O.length,M,I;for(M=0;M<R;++M)(I=a[O[M].identifier])&&(Ia(C),I("drag",C,O[M]))}function N(C){var O=C.changedTouches,R=O.length,M,I;for(g&&clearTimeout(g),g=setTimeout(function(){g=null},500),M=0;M<R;++M)(I=a[O[M].identifier])&&(np(C),I("end",C,O[M]))}function E(C,O,R,M,I,q){var K=l.copy(),Y=Kn(q||R,O),$,Q,B;if((B=n.call(C,new Pp("beforestart",{sourceEvent:R,target:v,identifier:I,active:c,x:Y[0],y:Y[1],dx:0,dy:0,dispatch:K}),M))!=null)return $=B.x-Y[0]||0,Q=B.y-Y[1]||0,function G(k,L,V){var P=Y,H;switch(k){case"start":a[I]=G,H=c++;break;case"end":delete a[I],--c;case"drag":Y=Kn(V||L,O),H=c;break}K.call(k,C,new Pp(k,{sourceEvent:L,subject:B,target:v,identifier:I,active:H,x:Y[0]+$,y:Y[1]+Q,dx:Y[0]-P[0],dy:Y[1]-P[1],dispatch:K}),M)}}return v.filter=function(C){return arguments.length?(t=typeof C=="function"?C:Vu(!!C),v):t},v.container=function(C){return arguments.length?(e=typeof C=="function"?C:Vu(C),v):e},v.subject=function(C){return arguments.length?(n=typeof C=="function"?C:Vu(C),v):n},v.touchable=function(C){return arguments.length?(s=typeof C=="function"?C:Vu(!!C),v):s},v.on=function(){var C=l.on.apply(l,arguments);return C===l?v:C},v.clickDistance=function(C){return arguments.length?(p=(C=+C)*C,v):Math.sqrt(p)},v}function Dg(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function kE(t,e){var n=Object.create(t.prototype);for(var s in e)n[s]=e[s];return n}function ec(){}var Il=.7,Rd=1/Il,La="\\s*([+-]?\\d+)\\s*",Ll="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",dr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",kD=/^#([0-9a-f]{3,8})$/,MD=new RegExp(`^rgb\\(${La},${La},${La}\\)$`),DD=new RegExp(`^rgb\\(${dr},${dr},${dr}\\)$`),UD=new RegExp(`^rgba\\(${La},${La},${La},${Ll}\\)$`),$D=new RegExp(`^rgba\\(${dr},${dr},${dr},${Ll}\\)$`),ID=new RegExp(`^hsl\\(${Ll},${dr},${dr}\\)$`),LD=new RegExp(`^hsla\\(${Ll},${dr},${dr},${Ll}\\)$`),hw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Dg(ec,wi,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:mw,formatHex:mw,formatHex8:zD,formatHsl:BD,formatRgb:pw,toString:pw});function mw(){return this.rgb().formatHex()}function zD(){return this.rgb().formatHex8()}function BD(){return ME(this).formatHsl()}function pw(){return this.rgb().formatRgb()}function wi(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=kD.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?gw(e):n===3?new cn(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Fu(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Fu(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=MD.exec(t))?new cn(e[1],e[2],e[3],1):(e=DD.exec(t))?new cn(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=UD.exec(t))?Fu(e[1],e[2],e[3],e[4]):(e=$D.exec(t))?Fu(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=ID.exec(t))?bw(e[1],e[2]/100,e[3]/100,1):(e=LD.exec(t))?bw(e[1],e[2]/100,e[3]/100,e[4]):hw.hasOwnProperty(t)?gw(hw[t]):t==="transparent"?new cn(NaN,NaN,NaN,0):null}function gw(t){return new cn(t>>16&255,t>>8&255,t&255,1)}function Fu(t,e,n,s){return s<=0&&(t=e=n=NaN),new cn(t,e,n,s)}function PD(t){return t instanceof ec||(t=wi(t)),t?(t=t.rgb(),new cn(t.r,t.g,t.b,t.opacity)):new cn}function qp(t,e,n,s){return arguments.length===1?PD(t):new cn(t,e,n,s??1)}function cn(t,e,n,s){this.r=+t,this.g=+e,this.b=+n,this.opacity=+s}Dg(cn,qp,kE(ec,{brighter(t){return t=t==null?Rd:Math.pow(Rd,t),new cn(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Il:Math.pow(Il,t),new cn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new cn(bi(this.r),bi(this.g),bi(this.b),jd(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:yw,formatHex:yw,formatHex8:qD,formatRgb:vw,toString:vw}));function yw(){return`#${pi(this.r)}${pi(this.g)}${pi(this.b)}`}function qD(){return`#${pi(this.r)}${pi(this.g)}${pi(this.b)}${pi((isNaN(this.opacity)?1:this.opacity)*255)}`}function vw(){const t=jd(this.opacity);return`${t===1?"rgb(":"rgba("}${bi(this.r)}, ${bi(this.g)}, ${bi(this.b)}${t===1?")":`, ${t})`}`}function jd(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function bi(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function pi(t){return t=bi(t),(t<16?"0":"")+t.toString(16)}function bw(t,e,n,s){return s<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Qn(t,e,n,s)}function ME(t){if(t instanceof Qn)return new Qn(t.h,t.s,t.l,t.opacity);if(t instanceof ec||(t=wi(t)),!t)return new Qn;if(t instanceof Qn)return t;t=t.rgb();var e=t.r/255,n=t.g/255,s=t.b/255,a=Math.min(e,n,s),l=Math.max(e,n,s),c=NaN,d=l-a,h=(l+a)/2;return d?(e===l?c=(n-s)/d+(n<s)*6:n===l?c=(s-e)/d+2:c=(e-n)/d+4,d/=h<.5?l+a:2-l-a,c*=60):d=h>0&&h<1?0:c,new Qn(c,d,h,t.opacity)}function HD(t,e,n,s){return arguments.length===1?ME(t):new Qn(t,e,n,s??1)}function Qn(t,e,n,s){this.h=+t,this.s=+e,this.l=+n,this.opacity=+s}Dg(Qn,HD,kE(ec,{brighter(t){return t=t==null?Rd:Math.pow(Rd,t),new Qn(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Il:Math.pow(Il,t),new Qn(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,s=n+(n<.5?n:1-n)*e,a=2*n-s;return new cn(rp(t>=240?t-240:t+120,a,s),rp(t,a,s),rp(t<120?t+240:t-120,a,s),this.opacity)},clamp(){return new Qn(_w(this.h),Yu(this.s),Yu(this.l),jd(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=jd(this.opacity);return`${t===1?"hsl(":"hsla("}${_w(this.h)}, ${Yu(this.s)*100}%, ${Yu(this.l)*100}%${t===1?")":`, ${t})`}`}}));function _w(t){return t=(t||0)%360,t<0?t+360:t}function Yu(t){return Math.max(0,Math.min(1,t||0))}function rp(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Ug=t=>()=>t;function VD(t,e){return function(n){return t+n*e}}function FD(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(s){return Math.pow(t+s*e,n)}}function YD(t){return(t=+t)==1?DE:function(e,n){return n-e?FD(e,n,t):Ug(isNaN(e)?n:e)}}function DE(t,e){var n=e-t;return n?VD(t,n):Ug(isNaN(t)?e:t)}const kd=(function t(e){var n=YD(e);function s(a,l){var c=n((a=qp(a)).r,(l=qp(l)).r),d=n(a.g,l.g),h=n(a.b,l.b),f=DE(a.opacity,l.opacity);return function(g){return a.r=c(g),a.g=d(g),a.b=h(g),a.opacity=f(g),a+""}}return s.gamma=t,s})(1);function GD(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,s=e.slice(),a;return function(l){for(a=0;a<n;++a)s[a]=t[a]*(1-l)+e[a]*l;return s}}function XD(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function KD(t,e){var n=e?e.length:0,s=t?Math.min(n,t.length):0,a=new Array(s),l=new Array(n),c;for(c=0;c<s;++c)a[c]=Al(t[c],e[c]);for(;c<n;++c)l[c]=e[c];return function(d){for(c=0;c<s;++c)l[c]=a[c](d);return l}}function QD(t,e){var n=new Date;return t=+t,e=+e,function(s){return n.setTime(t*(1-s)+e*s),n}}function cr(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function WD(t,e){var n={},s={},a;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(a in e)a in t?n[a]=Al(t[a],e[a]):s[a]=e[a];return function(l){for(a in n)s[a]=n[a](l);return s}}var Hp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,sp=new RegExp(Hp.source,"g");function JD(t){return function(){return t}}function ZD(t){return function(e){return t(e)+""}}function UE(t,e){var n=Hp.lastIndex=sp.lastIndex=0,s,a,l,c=-1,d=[],h=[];for(t=t+"",e=e+"";(s=Hp.exec(t))&&(a=sp.exec(e));)(l=a.index)>n&&(l=e.slice(n,l),d[c]?d[c]+=l:d[++c]=l),(s=s[0])===(a=a[0])?d[c]?d[c]+=a:d[++c]=a:(d[++c]=null,h.push({i:c,x:cr(s,a)})),n=sp.lastIndex;return n<e.length&&(l=e.slice(n),d[c]?d[c]+=l:d[++c]=l),d.length<2?h[0]?ZD(h[0].x):JD(e):(e=h.length,function(f){for(var g=0,p;g<e;++g)d[(p=h[g]).i]=p.x(f);return d.join("")})}function Al(t,e){var n=typeof e,s;return e==null||n==="boolean"?Ug(e):(n==="number"?cr:n==="string"?(s=wi(e))?(e=s,kd):UE:e instanceof wi?kd:e instanceof Date?QD:XD(e)?GD:Array.isArray(e)?KD:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?WD:cr)(t,e)}var ww=180/Math.PI,Vp={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function $E(t,e,n,s,a,l){var c,d,h;return(c=Math.sqrt(t*t+e*e))&&(t/=c,e/=c),(h=t*n+e*s)&&(n-=t*h,s-=e*h),(d=Math.sqrt(n*n+s*s))&&(n/=d,s/=d,h/=d),t*s<e*n&&(t=-t,e=-e,h=-h,c=-c),{translateX:a,translateY:l,rotate:Math.atan2(e,t)*ww,skewX:Math.atan(h)*ww,scaleX:c,scaleY:d}}var Gu;function eU(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Vp:$E(e.a,e.b,e.c,e.d,e.e,e.f)}function tU(t){return t==null||(Gu||(Gu=document.createElementNS("http://www.w3.org/2000/svg","g")),Gu.setAttribute("transform",t),!(t=Gu.transform.baseVal.consolidate()))?Vp:(t=t.matrix,$E(t.a,t.b,t.c,t.d,t.e,t.f))}function IE(t,e,n,s){function a(f){return f.length?f.pop()+" ":""}function l(f,g,p,v,b,x){if(f!==p||g!==v){var w=b.push("translate(",null,e,null,n);x.push({i:w-4,x:cr(f,p)},{i:w-2,x:cr(g,v)})}else(p||v)&&b.push("translate("+p+e+v+n)}function c(f,g,p,v){f!==g?(f-g>180?g+=360:g-f>180&&(f+=360),v.push({i:p.push(a(p)+"rotate(",null,s)-2,x:cr(f,g)})):g&&p.push(a(p)+"rotate("+g+s)}function d(f,g,p,v){f!==g?v.push({i:p.push(a(p)+"skewX(",null,s)-2,x:cr(f,g)}):g&&p.push(a(p)+"skewX("+g+s)}function h(f,g,p,v,b,x){if(f!==p||g!==v){var w=b.push(a(b)+"scale(",null,",",null,")");x.push({i:w-4,x:cr(f,p)},{i:w-2,x:cr(g,v)})}else(p!==1||v!==1)&&b.push(a(b)+"scale("+p+","+v+")")}return function(f,g){var p=[],v=[];return f=t(f),g=t(g),l(f.translateX,f.translateY,g.translateX,g.translateY,p,v),c(f.rotate,g.rotate,p,v),d(f.skewX,g.skewX,p,v),h(f.scaleX,f.scaleY,g.scaleX,g.scaleY,p,v),f=g=null,function(b){for(var x=-1,w=v.length,S;++x<w;)p[(S=v[x]).i]=S.x(b);return p.join("")}}}var nU=IE(eU,"px, ","px)","deg)"),rU=IE(tU,", ",")",")"),sU=1e-12;function xw(t){return((t=Math.exp(t))+1/t)/2}function iU(t){return((t=Math.exp(t))-1/t)/2}function aU(t){return((t=Math.exp(2*t))-1)/(t+1)}const ud=(function t(e,n,s){function a(l,c){var d=l[0],h=l[1],f=l[2],g=c[0],p=c[1],v=c[2],b=g-d,x=p-h,w=b*b+x*x,S,A;if(w<sU)A=Math.log(v/f)/e,S=function(M){return[d+M*b,h+M*x,f*Math.exp(e*M*A)]};else{var N=Math.sqrt(w),E=(v*v-f*f+s*w)/(2*f*n*N),C=(v*v-f*f-s*w)/(2*v*n*N),O=Math.log(Math.sqrt(E*E+1)-E),R=Math.log(Math.sqrt(C*C+1)-C);A=(R-O)/e,S=function(M){var I=M*A,q=xw(O),K=f/(n*N)*(q*aU(e*I+O)-iU(O));return[d+K*b,h+K*x,f*q/xw(e*I+O)]}}return S.duration=A*1e3*e/Math.SQRT2,S}return a.rho=function(l){var c=Math.max(.001,+l),d=c*c,h=d*d;return t(c,d,h)},a})(Math.SQRT2,2,4);var Pa=0,dl=0,al=0,LE=1e3,Md,fl,Dd=0,xi=0,sf=0,zl=typeof performance=="object"&&performance.now?performance:Date,zE=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function $g(){return xi||(zE(oU),xi=zl.now()+sf)}function oU(){xi=0}function Ud(){this._call=this._time=this._next=null}Ud.prototype=BE.prototype={constructor:Ud,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?$g():+n)+(e==null?0:+e),!this._next&&fl!==this&&(fl?fl._next=this:Md=this,fl=this),this._call=t,this._time=n,Fp()},stop:function(){this._call&&(this._call=null,this._time=1/0,Fp())}};function BE(t,e,n){var s=new Ud;return s.restart(t,e,n),s}function lU(){$g(),++Pa;for(var t=Md,e;t;)(e=xi-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Pa}function Sw(){xi=(Dd=zl.now())+sf,Pa=dl=0;try{lU()}finally{Pa=0,uU(),xi=0}}function cU(){var t=zl.now(),e=t-Dd;e>LE&&(sf-=e,Dd=t)}function uU(){for(var t,e=Md,n,s=1/0;e;)e._call?(s>e._time&&(s=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Md=n);fl=t,Fp(s)}function Fp(t){if(!Pa){dl&&(dl=clearTimeout(dl));var e=t-xi;e>24?(t<1/0&&(dl=setTimeout(Sw,t-zl.now()-sf)),al&&(al=clearInterval(al))):(al||(Dd=zl.now(),al=setInterval(cU,LE)),Pa=1,zE(Sw))}}function Ew(t,e,n){var s=new Ud;return e=e==null?0:+e,s.restart(a=>{s.stop(),t(a+e)},e,n),s}var dU=nf("start","end","cancel","interrupt"),fU=[],PE=0,Cw=1,Yp=2,dd=3,Aw=4,Gp=5,fd=6;function af(t,e,n,s,a,l){var c=t.__transition;if(!c)t.__transition={};else if(n in c)return;hU(t,n,{name:e,index:s,group:a,on:dU,tween:fU,time:l.time,delay:l.delay,duration:l.duration,ease:l.ease,timer:null,state:PE})}function Ig(t,e){var n=er(t,e);if(n.state>PE)throw new Error("too late; already scheduled");return n}function mr(t,e){var n=er(t,e);if(n.state>dd)throw new Error("too late; already running");return n}function er(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function hU(t,e,n){var s=t.__transition,a;s[e]=n,n.timer=BE(l,0,n.time);function l(f){n.state=Cw,n.timer.restart(c,n.delay,n.time),n.delay<=f&&c(f-n.delay)}function c(f){var g,p,v,b;if(n.state!==Cw)return h();for(g in s)if(b=s[g],b.name===n.name){if(b.state===dd)return Ew(c);b.state===Aw?(b.state=fd,b.timer.stop(),b.on.call("interrupt",t,t.__data__,b.index,b.group),delete s[g]):+g<e&&(b.state=fd,b.timer.stop(),b.on.call("cancel",t,t.__data__,b.index,b.group),delete s[g])}if(Ew(function(){n.state===dd&&(n.state=Aw,n.timer.restart(d,n.delay,n.time),d(f))}),n.state=Yp,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Yp){for(n.state=dd,a=new Array(v=n.tween.length),g=0,p=-1;g<v;++g)(b=n.tween[g].value.call(t,t.__data__,n.index,n.group))&&(a[++p]=b);a.length=p+1}}function d(f){for(var g=f<n.duration?n.ease.call(null,f/n.duration):(n.timer.restart(h),n.state=Gp,1),p=-1,v=a.length;++p<v;)a[p].call(t,g);n.state===Gp&&(n.on.call("end",t,t.__data__,n.index,n.group),h())}function h(){n.state=fd,n.timer.stop(),delete s[e];for(var f in s)return;delete t.__transition}}function hd(t,e){var n=t.__transition,s,a,l=!0,c;if(n){e=e==null?null:e+"";for(c in n){if((s=n[c]).name!==e){l=!1;continue}a=s.state>Yp&&s.state<Gp,s.state=fd,s.timer.stop(),s.on.call(a?"interrupt":"cancel",t,t.__data__,s.index,s.group),delete n[c]}l&&delete t.__transition}}function mU(t){return this.each(function(){hd(this,t)})}function pU(t,e){var n,s;return function(){var a=mr(this,t),l=a.tween;if(l!==n){s=n=l;for(var c=0,d=s.length;c<d;++c)if(s[c].name===e){s=s.slice(),s.splice(c,1);break}}a.tween=s}}function gU(t,e,n){var s,a;if(typeof n!="function")throw new Error;return function(){var l=mr(this,t),c=l.tween;if(c!==s){a=(s=c).slice();for(var d={name:e,value:n},h=0,f=a.length;h<f;++h)if(a[h].name===e){a[h]=d;break}h===f&&a.push(d)}l.tween=a}}function yU(t,e){var n=this._id;if(t+="",arguments.length<2){for(var s=er(this.node(),n).tween,a=0,l=s.length,c;a<l;++a)if((c=s[a]).name===t)return c.value;return null}return this.each((e==null?pU:gU)(n,t,e))}function Lg(t,e,n){var s=t._id;return t.each(function(){var a=mr(this,s);(a.value||(a.value={}))[e]=n.apply(this,arguments)}),function(a){return er(a,s).value[e]}}function qE(t,e){var n;return(typeof e=="number"?cr:e instanceof wi?kd:(n=wi(e))?(e=n,kd):UE)(t,e)}function vU(t){return function(){this.removeAttribute(t)}}function bU(t){return function(){this.removeAttributeNS(t.space,t.local)}}function _U(t,e,n){var s,a=n+"",l;return function(){var c=this.getAttribute(t);return c===a?null:c===s?l:l=e(s=c,n)}}function wU(t,e,n){var s,a=n+"",l;return function(){var c=this.getAttributeNS(t.space,t.local);return c===a?null:c===s?l:l=e(s=c,n)}}function xU(t,e,n){var s,a,l;return function(){var c,d=n(this),h;return d==null?void this.removeAttribute(t):(c=this.getAttribute(t),h=d+"",c===h?null:c===s&&h===a?l:(a=h,l=e(s=c,d)))}}function SU(t,e,n){var s,a,l;return function(){var c,d=n(this),h;return d==null?void this.removeAttributeNS(t.space,t.local):(c=this.getAttributeNS(t.space,t.local),h=d+"",c===h?null:c===s&&h===a?l:(a=h,l=e(s=c,d)))}}function EU(t,e){var n=rf(t),s=n==="transform"?rU:qE;return this.attrTween(t,typeof e=="function"?(n.local?SU:xU)(n,s,Lg(this,"attr."+t,e)):e==null?(n.local?bU:vU)(n):(n.local?wU:_U)(n,s,e))}function CU(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function AU(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function TU(t,e){var n,s;function a(){var l=e.apply(this,arguments);return l!==s&&(n=(s=l)&&AU(t,l)),n}return a._value=e,a}function NU(t,e){var n,s;function a(){var l=e.apply(this,arguments);return l!==s&&(n=(s=l)&&CU(t,l)),n}return a._value=e,a}function OU(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var s=rf(t);return this.tween(n,(s.local?TU:NU)(s,e))}function RU(t,e){return function(){Ig(this,t).delay=+e.apply(this,arguments)}}function jU(t,e){return e=+e,function(){Ig(this,t).delay=e}}function kU(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?RU:jU)(e,t)):er(this.node(),e).delay}function MU(t,e){return function(){mr(this,t).duration=+e.apply(this,arguments)}}function DU(t,e){return e=+e,function(){mr(this,t).duration=e}}function UU(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?MU:DU)(e,t)):er(this.node(),e).duration}function $U(t,e){if(typeof e!="function")throw new Error;return function(){mr(this,t).ease=e}}function IU(t){var e=this._id;return arguments.length?this.each($U(e,t)):er(this.node(),e).ease}function LU(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;mr(this,t).ease=n}}function zU(t){if(typeof t!="function")throw new Error;return this.each(LU(this._id,t))}function BU(t){typeof t!="function"&&(t=bE(t));for(var e=this._groups,n=e.length,s=new Array(n),a=0;a<n;++a)for(var l=e[a],c=l.length,d=s[a]=[],h,f=0;f<c;++f)(h=l[f])&&t.call(h,h.__data__,f,l)&&d.push(h);return new Yr(s,this._parents,this._name,this._id)}function PU(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,s=e.length,a=n.length,l=Math.min(s,a),c=new Array(s),d=0;d<l;++d)for(var h=e[d],f=n[d],g=h.length,p=c[d]=new Array(g),v,b=0;b<g;++b)(v=h[b]||f[b])&&(p[b]=v);for(;d<s;++d)c[d]=e[d];return new Yr(c,this._parents,this._name,this._id)}function qU(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function HU(t,e,n){var s,a,l=qU(e)?Ig:mr;return function(){var c=l(this,t),d=c.on;d!==s&&(a=(s=d).copy()).on(e,n),c.on=a}}function VU(t,e){var n=this._id;return arguments.length<2?er(this.node(),n).on.on(t):this.each(HU(n,t,e))}function FU(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function YU(){return this.on("end.remove",FU(this._id))}function GU(t){var e=this._name,n=this._id;typeof t!="function"&&(t=kg(t));for(var s=this._groups,a=s.length,l=new Array(a),c=0;c<a;++c)for(var d=s[c],h=d.length,f=l[c]=new Array(h),g,p,v=0;v<h;++v)(g=d[v])&&(p=t.call(g,g.__data__,v,d))&&("__data__"in g&&(p.__data__=g.__data__),f[v]=p,af(f[v],e,n,v,f,er(g,n)));return new Yr(l,this._parents,e,n)}function XU(t){var e=this._name,n=this._id;typeof t!="function"&&(t=vE(t));for(var s=this._groups,a=s.length,l=[],c=[],d=0;d<a;++d)for(var h=s[d],f=h.length,g,p=0;p<f;++p)if(g=h[p]){for(var v=t.call(g,g.__data__,p,h),b,x=er(g,n),w=0,S=v.length;w<S;++w)(b=v[w])&&af(b,e,n,w,v,x);l.push(v),c.push(g)}return new Yr(l,c,e,n)}var KU=Zl.prototype.constructor;function QU(){return new KU(this._groups,this._parents)}function WU(t,e){var n,s,a;return function(){var l=Ba(this,t),c=(this.style.removeProperty(t),Ba(this,t));return l===c?null:l===n&&c===s?a:a=e(n=l,s=c)}}function HE(t){return function(){this.style.removeProperty(t)}}function JU(t,e,n){var s,a=n+"",l;return function(){var c=Ba(this,t);return c===a?null:c===s?l:l=e(s=c,n)}}function ZU(t,e,n){var s,a,l;return function(){var c=Ba(this,t),d=n(this),h=d+"";return d==null&&(h=d=(this.style.removeProperty(t),Ba(this,t))),c===h?null:c===s&&h===a?l:(a=h,l=e(s=c,d))}}function e3(t,e){var n,s,a,l="style."+e,c="end."+l,d;return function(){var h=mr(this,t),f=h.on,g=h.value[l]==null?d||(d=HE(e)):void 0;(f!==n||a!==g)&&(s=(n=f).copy()).on(c,a=g),h.on=s}}function t3(t,e,n){var s=(t+="")=="transform"?nU:qE;return e==null?this.styleTween(t,WU(t,s)).on("end.style."+t,HE(t)):typeof e=="function"?this.styleTween(t,ZU(t,s,Lg(this,"style."+t,e))).each(e3(this._id,t)):this.styleTween(t,JU(t,s,e),n).on("end.style."+t,null)}function n3(t,e,n){return function(s){this.style.setProperty(t,e.call(this,s),n)}}function r3(t,e,n){var s,a;function l(){var c=e.apply(this,arguments);return c!==a&&(s=(a=c)&&n3(t,c,n)),s}return l._value=e,l}function s3(t,e,n){var s="style."+(t+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(e==null)return this.tween(s,null);if(typeof e!="function")throw new Error;return this.tween(s,r3(t,e,n??""))}function i3(t){return function(){this.textContent=t}}function a3(t){return function(){var e=t(this);this.textContent=e??""}}function o3(t){return this.tween("text",typeof t=="function"?a3(Lg(this,"text",t)):i3(t==null?"":t+""))}function l3(t){return function(e){this.textContent=t.call(this,e)}}function c3(t){var e,n;function s(){var a=t.apply(this,arguments);return a!==n&&(e=(n=a)&&l3(a)),e}return s._value=t,s}function u3(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,c3(t))}function d3(){for(var t=this._name,e=this._id,n=VE(),s=this._groups,a=s.length,l=0;l<a;++l)for(var c=s[l],d=c.length,h,f=0;f<d;++f)if(h=c[f]){var g=er(h,e);af(h,t,n,f,c,{time:g.time+g.delay+g.duration,delay:0,duration:g.duration,ease:g.ease})}return new Yr(s,this._parents,t,n)}function f3(){var t,e,n=this,s=n._id,a=n.size();return new Promise(function(l,c){var d={value:c},h={value:function(){--a===0&&l()}};n.each(function(){var f=mr(this,s),g=f.on;g!==t&&(e=(t=g).copy(),e._.cancel.push(d),e._.interrupt.push(d),e._.end.push(h)),f.on=e}),a===0&&l()})}var h3=0;function Yr(t,e,n,s){this._groups=t,this._parents=e,this._name=n,this._id=s}function VE(){return++h3}var zr=Zl.prototype;Yr.prototype={constructor:Yr,select:GU,selectAll:XU,selectChild:zr.selectChild,selectChildren:zr.selectChildren,filter:BU,merge:PU,selection:QU,transition:d3,call:zr.call,nodes:zr.nodes,node:zr.node,size:zr.size,empty:zr.empty,each:zr.each,on:VU,attr:EU,attrTween:OU,style:t3,styleTween:s3,text:o3,textTween:u3,remove:YU,tween:yU,delay:kU,duration:UU,ease:IU,easeVarying:zU,end:f3,[Symbol.iterator]:zr[Symbol.iterator]};function m3(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var p3={time:null,delay:0,duration:250,ease:m3};function g3(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function y3(t){var e,n;t instanceof Yr?(e=t._id,t=t._name):(e=VE(),(n=p3).time=$g(),t=t==null?null:t+"");for(var s=this._groups,a=s.length,l=0;l<a;++l)for(var c=s[l],d=c.length,h,f=0;f<d;++f)(h=c[f])&&af(h,t,e,f,c,n||g3(h,e));return new Yr(s,this._parents,t,e)}Zl.prototype.interrupt=mU;Zl.prototype.transition=y3;const Xu=t=>()=>t;function v3(t,{sourceEvent:e,target:n,transform:s,dispatch:a}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:s,enumerable:!0,configurable:!0},_:{value:a}})}function Hr(t,e,n){this.k=t,this.x=e,this.y=n}Hr.prototype={constructor:Hr,scale:function(t){return t===1?this:new Hr(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Hr(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var of=new Hr(1,0,0);FE.prototype=Hr.prototype;function FE(t){for(;!t.__zoom;)if(!(t=t.parentNode))return of;return t.__zoom}function ip(t){t.stopImmediatePropagation()}function ol(t){t.preventDefault(),t.stopImmediatePropagation()}function b3(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function _3(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function Tw(){return this.__zoom||of}function w3(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function x3(){return navigator.maxTouchPoints||"ontouchstart"in this}function S3(t,e,n){var s=t.invertX(e[0][0])-n[0][0],a=t.invertX(e[1][0])-n[1][0],l=t.invertY(e[0][1])-n[0][1],c=t.invertY(e[1][1])-n[1][1];return t.translate(a>s?(s+a)/2:Math.min(0,s)||Math.max(0,a),c>l?(l+c)/2:Math.min(0,l)||Math.max(0,c))}function YE(){var t=b3,e=_3,n=S3,s=w3,a=x3,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],d=250,h=ud,f=nf("start","zoom","end"),g,p,v,b=500,x=150,w=0,S=10;function A(B){B.property("__zoom",Tw).on("wheel.zoom",I,{passive:!1}).on("mousedown.zoom",q).on("dblclick.zoom",K).filter(a).on("touchstart.zoom",Y).on("touchmove.zoom",$).on("touchend.zoom touchcancel.zoom",Q).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}A.transform=function(B,G,k,L){var V=B.selection?B.selection():B;V.property("__zoom",Tw),B!==V?O(B,G,k,L):V.interrupt().each(function(){R(this,arguments).event(L).start().zoom(null,typeof G=="function"?G.apply(this,arguments):G).end()})},A.scaleBy=function(B,G,k,L){A.scaleTo(B,function(){var V=this.__zoom.k,P=typeof G=="function"?G.apply(this,arguments):G;return V*P},k,L)},A.scaleTo=function(B,G,k,L){A.transform(B,function(){var V=e.apply(this,arguments),P=this.__zoom,H=k==null?C(V):typeof k=="function"?k.apply(this,arguments):k,D=P.invert(H),z=typeof G=="function"?G.apply(this,arguments):G;return n(E(N(P,z),H,D),V,c)},k,L)},A.translateBy=function(B,G,k,L){A.transform(B,function(){return n(this.__zoom.translate(typeof G=="function"?G.apply(this,arguments):G,typeof k=="function"?k.apply(this,arguments):k),e.apply(this,arguments),c)},null,L)},A.translateTo=function(B,G,k,L,V){A.transform(B,function(){var P=e.apply(this,arguments),H=this.__zoom,D=L==null?C(P):typeof L=="function"?L.apply(this,arguments):L;return n(of.translate(D[0],D[1]).scale(H.k).translate(typeof G=="function"?-G.apply(this,arguments):-G,typeof k=="function"?-k.apply(this,arguments):-k),P,c)},L,V)};function N(B,G){return G=Math.max(l[0],Math.min(l[1],G)),G===B.k?B:new Hr(G,B.x,B.y)}function E(B,G,k){var L=G[0]-k[0]*B.k,V=G[1]-k[1]*B.k;return L===B.x&&V===B.y?B:new Hr(B.k,L,V)}function C(B){return[(+B[0][0]+ +B[1][0])/2,(+B[0][1]+ +B[1][1])/2]}function O(B,G,k,L){B.on("start.zoom",function(){R(this,arguments).event(L).start()}).on("interrupt.zoom end.zoom",function(){R(this,arguments).event(L).end()}).tween("zoom",function(){var V=this,P=arguments,H=R(V,P).event(L),D=e.apply(V,P),z=k==null?C(D):typeof k=="function"?k.apply(V,P):k,J=Math.max(D[1][0]-D[0][0],D[1][1]-D[0][1]),ee=V.__zoom,he=typeof G=="function"?G.apply(V,P):G,pe=h(ee.invert(z).concat(J/ee.k),he.invert(z).concat(J/he.k));return function(ae){if(ae===1)ae=he;else{var le=pe(ae),Z=J/le[2];ae=new Hr(Z,z[0]-le[0]*Z,z[1]-le[1]*Z)}H.zoom(null,ae)}})}function R(B,G,k){return!k&&B.__zooming||new M(B,G)}function M(B,G){this.that=B,this.args=G,this.active=0,this.sourceEvent=null,this.extent=e.apply(B,G),this.taps=0}M.prototype={event:function(B){return B&&(this.sourceEvent=B),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(B,G){return this.mouse&&B!=="mouse"&&(this.mouse[1]=G.invert(this.mouse[0])),this.touch0&&B!=="touch"&&(this.touch0[1]=G.invert(this.touch0[0])),this.touch1&&B!=="touch"&&(this.touch1[1]=G.invert(this.touch1[0])),this.that.__zoom=G,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(B){var G=Sn(this.that).datum();f.call(B,this.that,new v3(B,{sourceEvent:this.sourceEvent,target:A,transform:this.that.__zoom,dispatch:f}),G)}};function I(B,...G){if(!t.apply(this,arguments))return;var k=R(this,G).event(B),L=this.__zoom,V=Math.max(l[0],Math.min(l[1],L.k*Math.pow(2,s.apply(this,arguments)))),P=Kn(B);if(k.wheel)(k.mouse[0][0]!==P[0]||k.mouse[0][1]!==P[1])&&(k.mouse[1]=L.invert(k.mouse[0]=P)),clearTimeout(k.wheel);else{if(L.k===V)return;k.mouse=[P,L.invert(P)],hd(this),k.start()}ol(B),k.wheel=setTimeout(H,x),k.zoom("mouse",n(E(N(L,V),k.mouse[0],k.mouse[1]),k.extent,c));function H(){k.wheel=null,k.end()}}function q(B,...G){if(v||!t.apply(this,arguments))return;var k=B.currentTarget,L=R(this,G,!0).event(B),V=Sn(B.view).on("mousemove.zoom",z,!0).on("mouseup.zoom",J,!0),P=Kn(B,k),H=B.clientX,D=B.clientY;OE(B.view),ip(B),L.mouse=[P,this.__zoom.invert(P)],hd(this),L.start();function z(ee){if(ol(ee),!L.moved){var he=ee.clientX-H,pe=ee.clientY-D;L.moved=he*he+pe*pe>w}L.event(ee).zoom("mouse",n(E(L.that.__zoom,L.mouse[0]=Kn(ee,k),L.mouse[1]),L.extent,c))}function J(ee){V.on("mousemove.zoom mouseup.zoom",null),RE(ee.view,L.moved),ol(ee),L.event(ee).end()}}function K(B,...G){if(t.apply(this,arguments)){var k=this.__zoom,L=Kn(B.changedTouches?B.changedTouches[0]:B,this),V=k.invert(L),P=k.k*(B.shiftKey?.5:2),H=n(E(N(k,P),L,V),e.apply(this,G),c);ol(B),d>0?Sn(this).transition().duration(d).call(O,H,L,B):Sn(this).call(A.transform,H,L,B)}}function Y(B,...G){if(t.apply(this,arguments)){var k=B.touches,L=k.length,V=R(this,G,B.changedTouches.length===L).event(B),P,H,D,z;for(ip(B),H=0;H<L;++H)D=k[H],z=Kn(D,this),z=[z,this.__zoom.invert(z),D.identifier],V.touch0?!V.touch1&&V.touch0[2]!==z[2]&&(V.touch1=z,V.taps=0):(V.touch0=z,P=!0,V.taps=1+!!g);g&&(g=clearTimeout(g)),P&&(V.taps<2&&(p=z[0],g=setTimeout(function(){g=null},b)),hd(this),V.start())}}function $(B,...G){if(this.__zooming){var k=R(this,G).event(B),L=B.changedTouches,V=L.length,P,H,D,z;for(ol(B),P=0;P<V;++P)H=L[P],D=Kn(H,this),k.touch0&&k.touch0[2]===H.identifier?k.touch0[0]=D:k.touch1&&k.touch1[2]===H.identifier&&(k.touch1[0]=D);if(H=k.that.__zoom,k.touch1){var J=k.touch0[0],ee=k.touch0[1],he=k.touch1[0],pe=k.touch1[1],ae=(ae=he[0]-J[0])*ae+(ae=he[1]-J[1])*ae,le=(le=pe[0]-ee[0])*le+(le=pe[1]-ee[1])*le;H=N(H,Math.sqrt(ae/le)),D=[(J[0]+he[0])/2,(J[1]+he[1])/2],z=[(ee[0]+pe[0])/2,(ee[1]+pe[1])/2]}else if(k.touch0)D=k.touch0[0],z=k.touch0[1];else return;k.zoom("touch",n(E(H,D,z),k.extent,c))}}function Q(B,...G){if(this.__zooming){var k=R(this,G).event(B),L=B.changedTouches,V=L.length,P,H;for(ip(B),v&&clearTimeout(v),v=setTimeout(function(){v=null},b),P=0;P<V;++P)H=L[P],k.touch0&&k.touch0[2]===H.identifier?delete k.touch0:k.touch1&&k.touch1[2]===H.identifier&&delete k.touch1;if(k.touch1&&!k.touch0&&(k.touch0=k.touch1,delete k.touch1),k.touch0)k.touch0[1]=this.__zoom.invert(k.touch0[0]);else if(k.end(),k.taps===2&&(H=Kn(H,this),Math.hypot(p[0]-H[0],p[1]-H[1])<S)){var D=Sn(this).on("dblclick.zoom");D&&D.apply(this,arguments)}}}return A.wheelDelta=function(B){return arguments.length?(s=typeof B=="function"?B:Xu(+B),A):s},A.filter=function(B){return arguments.length?(t=typeof B=="function"?B:Xu(!!B),A):t},A.touchable=function(B){return arguments.length?(a=typeof B=="function"?B:Xu(!!B),A):a},A.extent=function(B){return arguments.length?(e=typeof B=="function"?B:Xu([[+B[0][0],+B[0][1]],[+B[1][0],+B[1][1]]]),A):e},A.scaleExtent=function(B){return arguments.length?(l[0]=+B[0],l[1]=+B[1],A):[l[0],l[1]]},A.translateExtent=function(B){return arguments.length?(c[0][0]=+B[0][0],c[1][0]=+B[1][0],c[0][1]=+B[0][1],c[1][1]=+B[1][1],A):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},A.constrain=function(B){return arguments.length?(n=B,A):n},A.duration=function(B){return arguments.length?(d=+B,A):d},A.interpolate=function(B){return arguments.length?(h=B,A):h},A.on=function(){var B=f.on.apply(f,arguments);return B===f?A:B},A.clickDistance=function(B){return arguments.length?(w=(B=+B)*B,A):Math.sqrt(w)},A.tapDistance=function(B){return arguments.length?(S=+B,A):S},A}const Zn={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:t=>`Node type "${t}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:t=>`The old edge with id=${t} does not exist.`,error009:t=>`Marker type "${t}" doesn't exist.`,error008:(t,{id:e,sourceHandle:n,targetHandle:s})=>`Couldn't create edge for ${t} handle id: "${t==="source"?n:s}", edge id: ${e}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:t=>`Edge type "${t}" not found. Using fallback type "default".`,error012:t=>`Node with id "${t}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(t="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${t}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},Bl=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],GE=["Enter"," ","Escape"],XE={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:t,x:e,y:n})=>`Moved selected node ${t}. New position, x: ${e}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var qa;(function(t){t.Strict="strict",t.Loose="loose"})(qa||(qa={}));var _i;(function(t){t.Free="free",t.Vertical="vertical",t.Horizontal="horizontal"})(_i||(_i={}));var Pl;(function(t){t.Partial="partial",t.Full="full"})(Pl||(Pl={}));const KE={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var Ds;(function(t){t.Bezier="default",t.Straight="straight",t.Step="step",t.SmoothStep="smoothstep",t.SimpleBezier="simplebezier"})(Ds||(Ds={}));var $d;(function(t){t.Arrow="arrow",t.ArrowClosed="arrowclosed"})($d||($d={}));var Ce;(function(t){t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom"})(Ce||(Ce={}));const Nw={[Ce.Left]:Ce.Right,[Ce.Right]:Ce.Left,[Ce.Top]:Ce.Bottom,[Ce.Bottom]:Ce.Top};function E3(t,e){if(!t&&!e)return!0;if(!t||!e||t.size!==e.size)return!1;if(!t.size&&!e.size)return!0;for(const n of t.keys())if(!e.has(n))return!1;return!0}function Ow(t,e,n){if(!n)return;const s=[];t.forEach((a,l)=>{e?.has(l)||s.push(a)}),s.length&&n(s)}function QE(t){return t===null?null:t?"valid":"invalid"}const WE=t=>"id"in t&&"source"in t&&"target"in t,C3=t=>"id"in t&&"position"in t&&!("source"in t)&&!("target"in t),zg=t=>"id"in t&&"internals"in t&&!("source"in t)&&!("target"in t),tc=(t,e=[0,0])=>{const{width:n,height:s}=Kr(t),a=t.origin??e,l=n*a[0],c=s*a[1];return{x:t.position.x-l,y:t.position.y-c}},A3=(t,e={nodeOrigin:[0,0]})=>{if(t.length===0)return{x:0,y:0,width:0,height:0};const n=t.reduce((s,a)=>{const l=typeof a=="string";let c=!e.nodeLookup&&!l?a:void 0;e.nodeLookup&&(c=l?e.nodeLookup.get(a):zg(a)?a:e.nodeLookup.get(a.id));const d=c?Id(c,e.nodeOrigin):{x:0,y:0,x2:0,y2:0};return lf(s,d)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return cf(n)},nc=(t,e={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},s=!1;return t.forEach(a=>{(e.filter===void 0||e.filter(a))&&(n=lf(n,Id(a)),s=!0)}),s?cf(n):{x:0,y:0,width:0,height:0}},Bg=(t,e,[n,s,a]=[0,0,1],l=!1,c=!1)=>{const d={...sc(e,[n,s,a]),width:e.width/a,height:e.height/a},h=[];for(const f of t.values()){const{measured:g,selectable:p=!0,hidden:v=!1}=f;if(c&&!p||v)continue;const b=g.width??f.width??f.initialWidth??null,x=g.height??f.height??f.initialHeight??null,w=ql(d,Va(f)),S=(b??0)*(x??0),A=l&&w>0;(!f.internals.handleBounds||A||w>=S||f.dragging)&&h.push(f)}return h},T3=(t,e)=>{const n=new Set;return t.forEach(s=>{n.add(s.id)}),e.filter(s=>n.has(s.source)||n.has(s.target))};function N3(t,e){const n=new Map,s=e?.nodes?new Set(e.nodes.map(a=>a.id)):null;return t.forEach(a=>{a.measured.width&&a.measured.height&&(e?.includeHiddenNodes||!a.hidden)&&(!s||s.has(a.id))&&n.set(a.id,a)}),n}async function O3({nodes:t,width:e,height:n,panZoom:s,minZoom:a,maxZoom:l},c){if(t.size===0)return Promise.resolve(!0);const d=N3(t,c),h=nc(d),f=Pg(h,e,n,c?.minZoom??a,c?.maxZoom??l,c?.padding??.1);return await s.setViewport(f,{duration:c?.duration,ease:c?.ease,interpolate:c?.interpolate}),Promise.resolve(!0)}function JE({nodeId:t,nextPosition:e,nodeLookup:n,nodeOrigin:s=[0,0],nodeExtent:a,onError:l}){const c=n.get(t),d=c.parentId?n.get(c.parentId):void 0,{x:h,y:f}=d?d.internals.positionAbsolute:{x:0,y:0},g=c.origin??s;let p=c.extent||a;if(c.extent==="parent"&&!c.expandParent)if(!d)l?.("005",Zn.error005());else{const b=d.measured.width,x=d.measured.height;b&&x&&(p=[[h,f],[h+b,f+x]])}else d&&Fa(c.extent)&&(p=[[c.extent[0][0]+h,c.extent[0][1]+f],[c.extent[1][0]+h,c.extent[1][1]+f]]);const v=Fa(p)?Si(e,p,c.measured):e;return(c.measured.width===void 0||c.measured.height===void 0)&&l?.("015",Zn.error015()),{position:{x:v.x-h+(c.measured.width??0)*g[0],y:v.y-f+(c.measured.height??0)*g[1]},positionAbsolute:v}}async function R3({nodesToRemove:t=[],edgesToRemove:e=[],nodes:n,edges:s,onBeforeDelete:a}){const l=new Set(t.map(v=>v.id)),c=[];for(const v of n){if(v.deletable===!1)continue;const b=l.has(v.id),x=!b&&v.parentId&&c.find(w=>w.id===v.parentId);(b||x)&&c.push(v)}const d=new Set(e.map(v=>v.id)),h=s.filter(v=>v.deletable!==!1),g=T3(c,h);for(const v of h)d.has(v.id)&&!g.find(x=>x.id===v.id)&&g.push(v);if(!a)return{edges:g,nodes:c};const p=await a({nodes:c,edges:g});return typeof p=="boolean"?p?{edges:g,nodes:c}:{edges:[],nodes:[]}:p}const Ha=(t,e=0,n=1)=>Math.min(Math.max(t,e),n),Si=(t={x:0,y:0},e,n)=>({x:Ha(t.x,e[0][0],e[1][0]-(n?.width??0)),y:Ha(t.y,e[0][1],e[1][1]-(n?.height??0))});function ZE(t,e,n){const{width:s,height:a}=Kr(n),{x:l,y:c}=n.internals.positionAbsolute;return Si(t,[[l,c],[l+s,c+a]],e)}const Rw=(t,e,n)=>t<e?Ha(Math.abs(t-e),1,e)/e:t>n?-Ha(Math.abs(t-n),1,e)/e:0,e1=(t,e,n=15,s=40)=>{const a=Rw(t.x,s,e.width-s)*n,l=Rw(t.y,s,e.height-s)*n;return[a,l]},lf=(t,e)=>({x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x2,e.x2),y2:Math.max(t.y2,e.y2)}),Xp=({x:t,y:e,width:n,height:s})=>({x:t,y:e,x2:t+n,y2:e+s}),cf=({x:t,y:e,x2:n,y2:s})=>({x:t,y:e,width:n-t,height:s-e}),Va=(t,e=[0,0])=>{const{x:n,y:s}=zg(t)?t.internals.positionAbsolute:tc(t,e);return{x:n,y:s,width:t.measured?.width??t.width??t.initialWidth??0,height:t.measured?.height??t.height??t.initialHeight??0}},Id=(t,e=[0,0])=>{const{x:n,y:s}=zg(t)?t.internals.positionAbsolute:tc(t,e);return{x:n,y:s,x2:n+(t.measured?.width??t.width??t.initialWidth??0),y2:s+(t.measured?.height??t.height??t.initialHeight??0)}},t1=(t,e)=>cf(lf(Xp(t),Xp(e))),ql=(t,e)=>{const n=Math.max(0,Math.min(t.x+t.width,e.x+e.width)-Math.max(t.x,e.x)),s=Math.max(0,Math.min(t.y+t.height,e.y+e.height)-Math.max(t.y,e.y));return Math.ceil(n*s)},jw=t=>Wn(t.width)&&Wn(t.height)&&Wn(t.x)&&Wn(t.y),Wn=t=>!isNaN(t)&&isFinite(t),j3=(t,e)=>{},rc=(t,e=[1,1])=>({x:e[0]*Math.round(t.x/e[0]),y:e[1]*Math.round(t.y/e[1])}),sc=({x:t,y:e},[n,s,a],l=!1,c=[1,1])=>{const d={x:(t-n)/a,y:(e-s)/a};return l?rc(d,c):d},Ld=({x:t,y:e},[n,s,a])=>({x:t*a+n,y:e*a+s});function Sa(t,e){if(typeof t=="number")return Math.floor((e-e/(1+t))*.5);if(typeof t=="string"&&t.endsWith("px")){const n=parseFloat(t);if(!Number.isNaN(n))return Math.floor(n)}if(typeof t=="string"&&t.endsWith("%")){const n=parseFloat(t);if(!Number.isNaN(n))return Math.floor(e*n*.01)}return console.error(`[React Flow] The padding value "${t}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function k3(t,e,n){if(typeof t=="string"||typeof t=="number"){const s=Sa(t,n),a=Sa(t,e);return{top:s,right:a,bottom:s,left:a,x:a*2,y:s*2}}if(typeof t=="object"){const s=Sa(t.top??t.y??0,n),a=Sa(t.bottom??t.y??0,n),l=Sa(t.left??t.x??0,e),c=Sa(t.right??t.x??0,e);return{top:s,right:c,bottom:a,left:l,x:l+c,y:s+a}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function M3(t,e,n,s,a,l){const{x:c,y:d}=Ld(t,[e,n,s]),{x:h,y:f}=Ld({x:t.x+t.width,y:t.y+t.height},[e,n,s]),g=a-h,p=l-f;return{left:Math.floor(c),top:Math.floor(d),right:Math.floor(g),bottom:Math.floor(p)}}const Pg=(t,e,n,s,a,l)=>{const c=k3(l,e,n),d=(e-c.x)/t.width,h=(n-c.y)/t.height,f=Math.min(d,h),g=Ha(f,s,a),p=t.x+t.width/2,v=t.y+t.height/2,b=e/2-p*g,x=n/2-v*g,w=M3(t,b,x,g,e,n),S={left:Math.min(w.left-c.left,0),top:Math.min(w.top-c.top,0),right:Math.min(w.right-c.right,0),bottom:Math.min(w.bottom-c.bottom,0)};return{x:b-S.left+S.right,y:x-S.top+S.bottom,zoom:g}},Hl=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function Fa(t){return t!=null&&t!=="parent"}function Kr(t){return{width:t.measured?.width??t.width??t.initialWidth??0,height:t.measured?.height??t.height??t.initialHeight??0}}function n1(t){return(t.measured?.width??t.width??t.initialWidth)!==void 0&&(t.measured?.height??t.height??t.initialHeight)!==void 0}function r1(t,e={width:0,height:0},n,s,a){const l={...t},c=s.get(n);if(c){const d=c.origin||a;l.x+=c.internals.positionAbsolute.x-(e.width??0)*d[0],l.y+=c.internals.positionAbsolute.y-(e.height??0)*d[1]}return l}function kw(t,e){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}function D3(){let t,e;return{promise:new Promise((s,a)=>{t=s,e=a}),resolve:t,reject:e}}function U3(t){return{...XE,...t||{}}}function Tl(t,{snapGrid:e=[0,0],snapToGrid:n=!1,transform:s,containerBounds:a}){const{x:l,y:c}=Jn(t),d=sc({x:l-(a?.left??0),y:c-(a?.top??0)},s),{x:h,y:f}=n?rc(d,e):d;return{xSnapped:h,ySnapped:f,...d}}const qg=t=>({width:t.offsetWidth,height:t.offsetHeight}),s1=t=>t?.getRootNode?.()||window?.document,$3=["INPUT","SELECT","TEXTAREA"];function i1(t){const e=t.composedPath?.()?.[0]||t.target;return e?.nodeType!==1?!1:$3.includes(e.nodeName)||e.hasAttribute("contenteditable")||!!e.closest(".nokey")}const a1=t=>"clientX"in t,Jn=(t,e)=>{const n=a1(t),s=n?t.clientX:t.touches?.[0].clientX,a=n?t.clientY:t.touches?.[0].clientY;return{x:s-(e?.left??0),y:a-(e?.top??0)}},Mw=(t,e,n,s,a)=>{const l=e.querySelectorAll(`.${t}`);return!l||!l.length?null:Array.from(l).map(c=>{const d=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),type:t,nodeId:a,position:c.getAttribute("data-handlepos"),x:(d.left-n.left)/s,y:(d.top-n.top)/s,...qg(c)}})};function o1({sourceX:t,sourceY:e,targetX:n,targetY:s,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:d}){const h=t*.125+a*.375+c*.375+n*.125,f=e*.125+l*.375+d*.375+s*.125,g=Math.abs(h-t),p=Math.abs(f-e);return[h,f,g,p]}function Ku(t,e){return t>=0?.5*t:e*25*Math.sqrt(-t)}function Dw({pos:t,x1:e,y1:n,x2:s,y2:a,c:l}){switch(t){case Ce.Left:return[e-Ku(e-s,l),n];case Ce.Right:return[e+Ku(s-e,l),n];case Ce.Top:return[e,n-Ku(n-a,l)];case Ce.Bottom:return[e,n+Ku(a-n,l)]}}function Hg({sourceX:t,sourceY:e,sourcePosition:n=Ce.Bottom,targetX:s,targetY:a,targetPosition:l=Ce.Top,curvature:c=.25}){const[d,h]=Dw({pos:n,x1:t,y1:e,x2:s,y2:a,c}),[f,g]=Dw({pos:l,x1:s,y1:a,x2:t,y2:e,c}),[p,v,b,x]=o1({sourceX:t,sourceY:e,targetX:s,targetY:a,sourceControlX:d,sourceControlY:h,targetControlX:f,targetControlY:g});return[`M${t},${e} C${d},${h} ${f},${g} ${s},${a}`,p,v,b,x]}function l1({sourceX:t,sourceY:e,targetX:n,targetY:s}){const a=Math.abs(n-t)/2,l=n<t?n+a:n-a,c=Math.abs(s-e)/2,d=s<e?s+c:s-c;return[l,d,a,c]}function I3({sourceNode:t,targetNode:e,selected:n=!1,zIndex:s,elevateOnSelect:a=!1}){if(s!==void 0)return s;const l=a&&n?1e3:0,c=Math.max(t.parentId||a&&t.selected?t.internals.z:0,e.parentId||a&&e.selected?e.internals.z:0);return l+c}function L3({sourceNode:t,targetNode:e,width:n,height:s,transform:a}){const l=lf(Id(t),Id(e));l.x===l.x2&&(l.x2+=1),l.y===l.y2&&(l.y2+=1);const c={x:-a[0]/a[2],y:-a[1]/a[2],width:n/a[2],height:s/a[2]};return ql(c,cf(l))>0}const z3=({source:t,sourceHandle:e,target:n,targetHandle:s})=>`xy-edge__${t}${e||""}-${n}${s||""}`,B3=(t,e)=>e.some(n=>n.source===t.source&&n.target===t.target&&(n.sourceHandle===t.sourceHandle||!n.sourceHandle&&!t.sourceHandle)&&(n.targetHandle===t.targetHandle||!n.targetHandle&&!t.targetHandle)),c1=(t,e)=>{if(!t.source||!t.target)return e;let n;return WE(t)?n={...t}:n={...t,id:z3(t)},B3(n,e)?e:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,e.concat(n))};function u1({sourceX:t,sourceY:e,targetX:n,targetY:s}){const[a,l,c,d]=l1({sourceX:t,sourceY:e,targetX:n,targetY:s});return[`M ${t},${e}L ${n},${s}`,a,l,c,d]}const Uw={[Ce.Left]:{x:-1,y:0},[Ce.Right]:{x:1,y:0},[Ce.Top]:{x:0,y:-1},[Ce.Bottom]:{x:0,y:1}},P3=({source:t,sourcePosition:e=Ce.Bottom,target:n})=>e===Ce.Left||e===Ce.Right?t.x<n.x?{x:1,y:0}:{x:-1,y:0}:t.y<n.y?{x:0,y:1}:{x:0,y:-1},$w=(t,e)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));function q3({source:t,sourcePosition:e=Ce.Bottom,target:n,targetPosition:s=Ce.Top,center:a,offset:l,stepPosition:c}){const d=Uw[e],h=Uw[s],f={x:t.x+d.x*l,y:t.y+d.y*l},g={x:n.x+h.x*l,y:n.y+h.y*l},p=P3({source:f,sourcePosition:e,target:g}),v=p.x!==0?"x":"y",b=p[v];let x=[],w,S;const A={x:0,y:0},N={x:0,y:0},[,,E,C]=l1({sourceX:t.x,sourceY:t.y,targetX:n.x,targetY:n.y});if(d[v]*h[v]===-1){v==="x"?(w=a.x??f.x+(g.x-f.x)*c,S=a.y??(f.y+g.y)/2):(w=a.x??(f.x+g.x)/2,S=a.y??f.y+(g.y-f.y)*c);const R=[{x:w,y:f.y},{x:w,y:g.y}],M=[{x:f.x,y:S},{x:g.x,y:S}];d[v]===b?x=v==="x"?R:M:x=v==="x"?M:R}else{const R=[{x:f.x,y:g.y}],M=[{x:g.x,y:f.y}];if(v==="x"?x=d.x===b?M:R:x=d.y===b?R:M,e===s){const $=Math.abs(t[v]-n[v]);if($<=l){const Q=Math.min(l-1,l-$);d[v]===b?A[v]=(f[v]>t[v]?-1:1)*Q:N[v]=(g[v]>n[v]?-1:1)*Q}}if(e!==s){const $=v==="x"?"y":"x",Q=d[v]===h[$],B=f[$]>g[$],G=f[$]<g[$];(d[v]===1&&(!Q&&B||Q&&G)||d[v]!==1&&(!Q&&G||Q&&B))&&(x=v==="x"?R:M)}const I={x:f.x+A.x,y:f.y+A.y},q={x:g.x+N.x,y:g.y+N.y},K=Math.max(Math.abs(I.x-x[0].x),Math.abs(q.x-x[0].x)),Y=Math.max(Math.abs(I.y-x[0].y),Math.abs(q.y-x[0].y));K>=Y?(w=(I.x+q.x)/2,S=x[0].y):(w=x[0].x,S=(I.y+q.y)/2)}return[[t,{x:f.x+A.x,y:f.y+A.y},...x,{x:g.x+N.x,y:g.y+N.y},n],w,S,E,C]}function H3(t,e,n,s){const a=Math.min($w(t,e)/2,$w(e,n)/2,s),{x:l,y:c}=e;if(t.x===l&&l===n.x||t.y===c&&c===n.y)return`L${l} ${c}`;if(t.y===c){const f=t.x<n.x?-1:1,g=t.y<n.y?1:-1;return`L ${l+a*f},${c}Q ${l},${c} ${l},${c+a*g}`}const d=t.x<n.x?1:-1,h=t.y<n.y?-1:1;return`L ${l},${c+a*h}Q ${l},${c} ${l+a*d},${c}`}function Kp({sourceX:t,sourceY:e,sourcePosition:n=Ce.Bottom,targetX:s,targetY:a,targetPosition:l=Ce.Top,borderRadius:c=5,centerX:d,centerY:h,offset:f=20,stepPosition:g=.5}){const[p,v,b,x,w]=q3({source:{x:t,y:e},sourcePosition:n,target:{x:s,y:a},targetPosition:l,center:{x:d,y:h},offset:f,stepPosition:g});return[p.reduce((A,N,E)=>{let C="";return E>0&&E<p.length-1?C=H3(p[E-1],N,p[E+1],c):C=`${E===0?"M":"L"}${N.x} ${N.y}`,A+=C,A},""),v,b,x,w]}function Iw(t){return t&&!!(t.internals.handleBounds||t.handles?.length)&&!!(t.measured.width||t.width||t.initialWidth)}function V3(t){const{sourceNode:e,targetNode:n}=t;if(!Iw(e)||!Iw(n))return null;const s=e.internals.handleBounds||Lw(e.handles),a=n.internals.handleBounds||Lw(n.handles),l=zw(s?.source??[],t.sourceHandle),c=zw(t.connectionMode===qa.Strict?a?.target??[]:(a?.target??[]).concat(a?.source??[]),t.targetHandle);if(!l||!c)return t.onError?.("008",Zn.error008(l?"target":"source",{id:t.id,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle})),null;const d=l?.position||Ce.Bottom,h=c?.position||Ce.Top,f=Vl(e,l,d),g=Vl(n,c,h);return{sourceX:f.x,sourceY:f.y,targetX:g.x,targetY:g.y,sourcePosition:d,targetPosition:h}}function Lw(t){if(!t)return null;const e=[],n=[];for(const s of t)s.width=s.width??1,s.height=s.height??1,s.type==="source"?e.push(s):s.type==="target"&&n.push(s);return{source:e,target:n}}function Vl(t,e,n=Ce.Left,s=!1){const a=(e?.x??0)+t.internals.positionAbsolute.x,l=(e?.y??0)+t.internals.positionAbsolute.y,{width:c,height:d}=e??Kr(t);if(s)return{x:a+c/2,y:l+d/2};switch(e?.position??n){case Ce.Top:return{x:a+c/2,y:l};case Ce.Right:return{x:a+c,y:l+d/2};case Ce.Bottom:return{x:a+c/2,y:l+d};case Ce.Left:return{x:a,y:l+d/2}}}function zw(t,e){return t&&(e?t.find(n=>n.id===e):t[0])||null}function Qp(t,e){return t?typeof t=="string"?t:`${e?`${e}__`:""}${Object.keys(t).sort().map(s=>`${s}=${t[s]}`).join("&")}`:""}function F3(t,{id:e,defaultColor:n,defaultMarkerStart:s,defaultMarkerEnd:a}){const l=new Set;return t.reduce((c,d)=>([d.markerStart||s,d.markerEnd||a].forEach(h=>{if(h&&typeof h=="object"){const f=Qp(h,e);l.has(f)||(c.push({id:f,color:h.color||n,...h}),l.add(f))}}),c),[]).sort((c,d)=>c.id.localeCompare(d.id))}const d1=1e3,Y3=10,Vg={nodeOrigin:[0,0],nodeExtent:Bl,elevateNodesOnSelect:!0,defaults:{}},G3={...Vg,checkEquality:!0};function Fg(t,e){const n={...t};for(const s in e)e[s]!==void 0&&(n[s]=e[s]);return n}function X3(t,e,n){const s=Fg(Vg,n);for(const a of t.values())if(a.parentId)Yg(a,t,e,s);else{const l=tc(a,s.nodeOrigin),c=Fa(a.extent)?a.extent:s.nodeExtent,d=Si(l,c,Kr(a));a.internals.positionAbsolute=d}}function K3(t,e){if(!t.handles)return t.measured?e?.internals.handleBounds:void 0;const n=[],s=[];for(const a of t.handles){const l={id:a.id,width:a.width??1,height:a.height??1,nodeId:t.id,x:a.x,y:a.y,position:a.position,type:a.type};a.type==="source"?n.push(l):a.type==="target"&&s.push(l)}return{source:n,target:s}}function Wp(t,e,n,s){const a=Fg(G3,s);let l={i:-1},c=t.length>0;const d=new Map(e),h=a?.elevateNodesOnSelect?d1:0;e.clear(),n.clear();for(const f of t){let g=d.get(f.id);if(a.checkEquality&&f===g?.internals.userNode)e.set(f.id,g);else{const p=tc(f,a.nodeOrigin),v=Fa(f.extent)?f.extent:a.nodeExtent,b=Si(p,v,Kr(f));g={...a.defaults,...f,measured:{width:f.measured?.width,height:f.measured?.height},internals:{positionAbsolute:b,handleBounds:K3(f,g),z:f1(f,h),userNode:f}},e.set(f.id,g)}(g.measured===void 0||g.measured.width===void 0||g.measured.height===void 0)&&!g.hidden&&(c=!1),f.parentId&&Yg(g,e,n,s,l)}return c}function Q3(t,e){if(!t.parentId)return;const n=e.get(t.parentId);n?n.set(t.id,t):e.set(t.parentId,new Map([[t.id,t]]))}function Yg(t,e,n,s,a){const{elevateNodesOnSelect:l,nodeOrigin:c,nodeExtent:d}=Fg(Vg,s),h=t.parentId,f=e.get(h);if(!f){console.warn(`Parent node ${h} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Q3(t,n),a&&!f.parentId&&f.internals.rootParentIndex===void 0&&(f.internals.rootParentIndex=++a.i,f.internals.z=f.internals.z+a.i*Y3),a&&f.internals.rootParentIndex!==void 0&&(a.i=f.internals.rootParentIndex);const g=l?d1:0,{x:p,y:v,z:b}=W3(t,f,c,d,g),{positionAbsolute:x}=t.internals,w=p!==x.x||v!==x.y;(w||b!==t.internals.z)&&e.set(t.id,{...t,internals:{...t.internals,positionAbsolute:w?{x:p,y:v}:x,z:b}})}function f1(t,e){return(Wn(t.zIndex)?t.zIndex:0)+(t.selected?e:0)}function W3(t,e,n,s,a){const{x:l,y:c}=e.internals.positionAbsolute,d=Kr(t),h=tc(t,n),f=Fa(t.extent)?Si(h,t.extent,d):h;let g=Si({x:l+f.x,y:c+f.y},s,d);t.extent==="parent"&&(g=ZE(g,d,e));const p=f1(t,a),v=e.internals.z??0;return{x:g.x,y:g.y,z:v>=p?v+1:p}}function Gg(t,e,n,s=[0,0]){const a=[],l=new Map;for(const c of t){const d=e.get(c.parentId);if(!d)continue;const h=l.get(c.parentId)?.expandedRect??Va(d),f=t1(h,c.rect);l.set(c.parentId,{expandedRect:f,parent:d})}return l.size>0&&l.forEach(({expandedRect:c,parent:d},h)=>{const f=d.internals.positionAbsolute,g=Kr(d),p=d.origin??s,v=c.x<f.x?Math.round(Math.abs(f.x-c.x)):0,b=c.y<f.y?Math.round(Math.abs(f.y-c.y)):0,x=Math.max(g.width,Math.round(c.width)),w=Math.max(g.height,Math.round(c.height)),S=(x-g.width)*p[0],A=(w-g.height)*p[1];(v>0||b>0||S||A)&&(a.push({id:h,type:"position",position:{x:d.position.x-v+S,y:d.position.y-b+A}}),n.get(h)?.forEach(N=>{t.some(E=>E.id===N.id)||a.push({id:N.id,type:"position",position:{x:N.position.x+v,y:N.position.y+b}})})),(g.width<c.width||g.height<c.height||v||b)&&a.push({id:h,type:"dimensions",setAttributes:!0,dimensions:{width:x+(v?p[0]*v-S:0),height:w+(b?p[1]*b-A:0)}})}),a}function J3(t,e,n,s,a,l){const c=s?.querySelector(".xyflow__viewport");let d=!1;if(!c)return{changes:[],updatedInternals:d};const h=[],f=window.getComputedStyle(c),{m22:g}=new window.DOMMatrixReadOnly(f.transform),p=[];for(const v of t.values()){const b=e.get(v.id);if(!b)continue;if(b.hidden){e.set(b.id,{...b,internals:{...b.internals,handleBounds:void 0}}),d=!0;continue}const x=qg(v.nodeElement),w=b.measured.width!==x.width||b.measured.height!==x.height;if(!!(x.width&&x.height&&(w||!b.internals.handleBounds||v.force))){const A=v.nodeElement.getBoundingClientRect(),N=Fa(b.extent)?b.extent:l;let{positionAbsolute:E}=b.internals;b.parentId&&b.extent==="parent"?E=ZE(E,x,e.get(b.parentId)):N&&(E=Si(E,N,x));const C={...b,measured:x,internals:{...b.internals,positionAbsolute:E,handleBounds:{source:Mw("source",v.nodeElement,A,g,b.id),target:Mw("target",v.nodeElement,A,g,b.id)}}};e.set(b.id,C),b.parentId&&Yg(C,e,n,{nodeOrigin:a}),d=!0,w&&(h.push({id:b.id,type:"dimensions",dimensions:x}),b.expandParent&&b.parentId&&p.push({id:b.id,parentId:b.parentId,rect:Va(C,a)}))}}if(p.length>0){const v=Gg(p,e,n,a);h.push(...v)}return{changes:h,updatedInternals:d}}async function Z3({delta:t,panZoom:e,transform:n,translateExtent:s,width:a,height:l}){if(!e||!t.x&&!t.y)return Promise.resolve(!1);const c=await e.setViewportConstrained({x:n[0]+t.x,y:n[1]+t.y,zoom:n[2]},[[0,0],[a,l]],s),d=!!c&&(c.x!==n[0]||c.y!==n[1]||c.k!==n[2]);return Promise.resolve(d)}function Bw(t,e,n,s,a,l){let c=a;const d=s.get(c)||new Map;s.set(c,d.set(n,e)),c=`${a}-${t}`;const h=s.get(c)||new Map;if(s.set(c,h.set(n,e)),l){c=`${a}-${t}-${l}`;const f=s.get(c)||new Map;s.set(c,f.set(n,e))}}function h1(t,e,n){t.clear(),e.clear();for(const s of n){const{source:a,target:l,sourceHandle:c=null,targetHandle:d=null}=s,h={edgeId:s.id,source:a,target:l,sourceHandle:c,targetHandle:d},f=`${a}-${c}--${l}-${d}`,g=`${l}-${d}--${a}-${c}`;Bw("source",h,g,t,a,c),Bw("target",h,f,t,l,d),e.set(s.id,s)}}function e$(t,e){if(t===null||e===null)return!1;const n=Array.isArray(t)?t:[t],s=Array.isArray(e)?e:[e];if(n.length!==s.length)return!1;for(let a=0;a<n.length;a++)if(n[a].id!==s[a].id||n[a].type!==s[a].type||!Object.is(n[a].data,s[a].data))return!1;return!0}function m1(t,e){if(!t.parentId)return!1;const n=e.get(t.parentId);return n?n.selected?!0:m1(n,e):!1}function Pw(t,e,n){let s=t;do{if(s?.matches?.(e))return!0;if(s===n)return!1;s=s?.parentElement}while(s);return!1}function t$(t,e,n,s){const a=new Map;for(const[l,c]of t)if((c.selected||c.id===s)&&(!c.parentId||!m1(c,t))&&(c.draggable||e&&typeof c.draggable>"u")){const d=t.get(l);d&&a.set(l,{id:l,position:d.position||{x:0,y:0},distance:{x:n.x-d.internals.positionAbsolute.x,y:n.y-d.internals.positionAbsolute.y},extent:d.extent,parentId:d.parentId,origin:d.origin,expandParent:d.expandParent,internals:{positionAbsolute:d.internals.positionAbsolute||{x:0,y:0}},measured:{width:d.measured.width??0,height:d.measured.height??0}})}return a}function ap({nodeId:t,dragItems:e,nodeLookup:n,dragging:s=!0}){const a=[];for(const[c,d]of e){const h=n.get(c)?.internals.userNode;h&&a.push({...h,position:d.position,dragging:s})}if(!t)return[a[0],a];const l=n.get(t)?.internals.userNode;return[l?{...l,position:e.get(t)?.position||l.position,dragging:s}:a[0],a]}function n$({dragItems:t,snapGrid:e,x:n,y:s}){const a=t.values().next().value;if(!a)return null;const l={x:n-a.distance.x,y:s-a.distance.y},c=rc(l,e);return{x:c.x-l.x,y:c.y-l.y}}function r$({onNodeMouseDown:t,getStoreItems:e,onDragStart:n,onDrag:s,onDragStop:a}){let l={x:null,y:null},c=0,d=new Map,h=!1,f={x:0,y:0},g=null,p=!1,v=null,b=!1,x=!1,w=null;function S({noDragClassName:N,handleSelector:E,domNode:C,isSelectable:O,nodeId:R,nodeClickDistance:M=0}){v=Sn(C);function I({x:$,y:Q}){const{nodeLookup:B,nodeExtent:G,snapGrid:k,snapToGrid:L,nodeOrigin:V,onNodeDrag:P,onSelectionDrag:H,onError:D,updateNodePositions:z}=e();l={x:$,y:Q};let J=!1;const ee=d.size>1,he=ee&&G?Xp(nc(d)):null,pe=ee&&L?n$({dragItems:d,snapGrid:k,x:$,y:Q}):null;for(const[ae,le]of d){if(!B.has(ae))continue;let Z={x:$-le.distance.x,y:Q-le.distance.y};L&&(Z=pe?{x:Math.round(Z.x+pe.x),y:Math.round(Z.y+pe.y)}:rc(Z,k));let de=null;if(ee&&G&&!le.extent&&he){const{positionAbsolute:te}=le.internals,ve=te.x-he.x+G[0][0],_e=te.x+le.measured.width-he.x2+G[1][0],Ie=te.y-he.y+G[0][1],qe=te.y+le.measured.height-he.y2+G[1][1];de=[[ve,Ie],[_e,qe]]}const{position:ge,positionAbsolute:be}=JE({nodeId:ae,nextPosition:Z,nodeLookup:B,nodeExtent:de||G,nodeOrigin:V,onError:D});J=J||le.position.x!==ge.x||le.position.y!==ge.y,le.position=ge,le.internals.positionAbsolute=be}if(x=x||J,!!J&&(z(d,!0),w&&(s||P||!R&&H))){const[ae,le]=ap({nodeId:R,dragItems:d,nodeLookup:B});s?.(w,d,ae,le),P?.(w,ae,le),R||H?.(w,le)}}async function q(){if(!g)return;const{transform:$,panBy:Q,autoPanSpeed:B,autoPanOnNodeDrag:G}=e();if(!G){h=!1,cancelAnimationFrame(c);return}const[k,L]=e1(f,g,B);(k!==0||L!==0)&&(l.x=(l.x??0)-k/$[2],l.y=(l.y??0)-L/$[2],await Q({x:k,y:L})&&I(l)),c=requestAnimationFrame(q)}function K($){const{nodeLookup:Q,multiSelectionActive:B,nodesDraggable:G,transform:k,snapGrid:L,snapToGrid:V,selectNodesOnDrag:P,onNodeDragStart:H,onSelectionDragStart:D,unselectNodesAndEdges:z}=e();p=!0,(!P||!O)&&!B&&R&&(Q.get(R)?.selected||z()),O&&P&&R&&t?.(R);const J=Tl($.sourceEvent,{transform:k,snapGrid:L,snapToGrid:V,containerBounds:g});if(l=J,d=t$(Q,G,J,R),d.size>0&&(n||H||!R&&D)){const[ee,he]=ap({nodeId:R,dragItems:d,nodeLookup:Q});n?.($.sourceEvent,d,ee,he),H?.($.sourceEvent,ee,he),R||D?.($.sourceEvent,he)}}const Y=jE().clickDistance(M).on("start",$=>{const{domNode:Q,nodeDragThreshold:B,transform:G,snapGrid:k,snapToGrid:L}=e();g=Q?.getBoundingClientRect()||null,b=!1,x=!1,w=$.sourceEvent,B===0&&K($),l=Tl($.sourceEvent,{transform:G,snapGrid:k,snapToGrid:L,containerBounds:g}),f=Jn($.sourceEvent,g)}).on("drag",$=>{const{autoPanOnNodeDrag:Q,transform:B,snapGrid:G,snapToGrid:k,nodeDragThreshold:L,nodeLookup:V}=e(),P=Tl($.sourceEvent,{transform:B,snapGrid:G,snapToGrid:k,containerBounds:g});if(w=$.sourceEvent,($.sourceEvent.type==="touchmove"&&$.sourceEvent.touches.length>1||R&&!V.has(R))&&(b=!0),!b){if(!h&&Q&&p&&(h=!0,q()),!p){const H=Jn($.sourceEvent,g),D=H.x-f.x,z=H.y-f.y;Math.sqrt(D*D+z*z)>L&&K($)}(l.x!==P.xSnapped||l.y!==P.ySnapped)&&d&&p&&(f=Jn($.sourceEvent,g),I(P))}}).on("end",$=>{if(!(!p||b)&&(h=!1,p=!1,cancelAnimationFrame(c),d.size>0)){const{nodeLookup:Q,updateNodePositions:B,onNodeDragStop:G,onSelectionDragStop:k}=e();if(x&&(B(d,!1),x=!1),a||G||!R&&k){const[L,V]=ap({nodeId:R,dragItems:d,nodeLookup:Q,dragging:!1});a?.($.sourceEvent,d,L,V),G?.($.sourceEvent,L,V),R||k?.($.sourceEvent,V)}}}).filter($=>{const Q=$.target;return!$.button&&(!N||!Pw(Q,`.${N}`,C))&&(!E||Pw(Q,E,C))});v.call(Y)}function A(){v?.on(".drag",null)}return{update:S,destroy:A}}function s$(t,e,n){const s=[],a={x:t.x-n,y:t.y-n,width:n*2,height:n*2};for(const l of e.values())ql(a,Va(l))>0&&s.push(l);return s}const i$=250;function a$(t,e,n,s){let a=[],l=1/0;const c=s$(t,n,e+i$);for(const d of c){const h=[...d.internals.handleBounds?.source??[],...d.internals.handleBounds?.target??[]];for(const f of h){if(s.nodeId===f.nodeId&&s.type===f.type&&s.id===f.id)continue;const{x:g,y:p}=Vl(d,f,f.position,!0),v=Math.sqrt(Math.pow(g-t.x,2)+Math.pow(p-t.y,2));v>e||(v<l?(a=[{...f,x:g,y:p}],l=v):v===l&&a.push({...f,x:g,y:p}))}}if(!a.length)return null;if(a.length>1){const d=s.type==="source"?"target":"source";return a.find(h=>h.type===d)??a[0]}return a[0]}function p1(t,e,n,s,a,l=!1){const c=s.get(t);if(!c)return null;const d=a==="strict"?c.internals.handleBounds?.[e]:[...c.internals.handleBounds?.source??[],...c.internals.handleBounds?.target??[]],h=(n?d?.find(f=>f.id===n):d?.[0])??null;return h&&l?{...h,...Vl(c,h,h.position,!0)}:h}function g1(t,e){return t||(e?.classList.contains("target")?"target":e?.classList.contains("source")?"source":null)}function o$(t,e){let n=null;return e?n=!0:t&&!e&&(n=!1),n}const y1=()=>!0;function l$(t,{connectionMode:e,connectionRadius:n,handleId:s,nodeId:a,edgeUpdaterType:l,isTarget:c,domNode:d,nodeLookup:h,lib:f,autoPanOnConnect:g,flowId:p,panBy:v,cancelConnection:b,onConnectStart:x,onConnect:w,onConnectEnd:S,isValidConnection:A=y1,onReconnectEnd:N,updateConnection:E,getTransform:C,getFromHandle:O,autoPanSpeed:R,dragThreshold:M=1,handleDomNode:I}){const q=s1(t.target);let K=0,Y;const{x:$,y:Q}=Jn(t),B=g1(l,I),G=d?.getBoundingClientRect();let k=!1;if(!G||!B)return;const L=p1(a,B,s,h,e);if(!L)return;let V=Jn(t,G),P=!1,H=null,D=!1,z=null;function J(){if(!g||!G)return;const[ge,be]=e1(V,G,R);v({x:ge,y:be}),K=requestAnimationFrame(J)}const ee={...L,nodeId:a,type:B,position:L.position},he=h.get(a);let ae={inProgress:!0,isValid:null,from:Vl(he,ee,Ce.Left,!0),fromHandle:ee,fromPosition:ee.position,fromNode:he,to:V,toHandle:null,toPosition:Nw[ee.position],toNode:null,pointer:V};function le(){k=!0,E(ae),x?.(t,{nodeId:a,handleId:s,handleType:B})}M===0&&le();function Z(ge){if(!k){const{x:_e,y:Ie}=Jn(ge),qe=_e-$,ot=Ie-Q;if(!(qe*qe+ot*ot>M*M))return;le()}if(!O()||!ee){de(ge);return}const be=C();V=Jn(ge,G),Y=a$(sc(V,be,!1,[1,1]),n,h,ee),P||(J(),P=!0);const te=v1(ge,{handle:Y,connectionMode:e,fromNodeId:a,fromHandleId:s,fromType:c?"target":"source",isValidConnection:A,doc:q,lib:f,flowId:p,nodeLookup:h});z=te.handleDomNode,H=te.connection,D=o$(!!Y,te.isValid);const ve={...ae,isValid:D,to:te.toHandle&&D?Ld({x:te.toHandle.x,y:te.toHandle.y},be):V,toHandle:te.toHandle,toPosition:D&&te.toHandle?te.toHandle.position:Nw[ee.position],toNode:te.toHandle?h.get(te.toHandle.nodeId):null,pointer:V};E(ve),ae=ve}function de(ge){if(!("touches"in ge&&ge.touches.length>0)){if(k){(Y||z)&&H&&D&&w?.(H);const{inProgress:be,...te}=ae,ve={...te,toPosition:ae.toHandle?ae.toPosition:null};S?.(ge,ve),l&&N?.(ge,ve)}b(),cancelAnimationFrame(K),P=!1,D=!1,H=null,z=null,q.removeEventListener("mousemove",Z),q.removeEventListener("mouseup",de),q.removeEventListener("touchmove",Z),q.removeEventListener("touchend",de)}}q.addEventListener("mousemove",Z),q.addEventListener("mouseup",de),q.addEventListener("touchmove",Z),q.addEventListener("touchend",de)}function v1(t,{handle:e,connectionMode:n,fromNodeId:s,fromHandleId:a,fromType:l,doc:c,lib:d,flowId:h,isValidConnection:f=y1,nodeLookup:g}){const p=l==="target",v=e?c.querySelector(`.${d}-flow__handle[data-id="${h}-${e?.nodeId}-${e?.id}-${e?.type}"]`):null,{x:b,y:x}=Jn(t),w=c.elementFromPoint(b,x),S=w?.classList.contains(`${d}-flow__handle`)?w:v,A={handleDomNode:S,isValid:!1,connection:null,toHandle:null};if(S){const N=g1(void 0,S),E=S.getAttribute("data-nodeid"),C=S.getAttribute("data-handleid"),O=S.classList.contains("connectable"),R=S.classList.contains("connectableend");if(!E||!N)return A;const M={source:p?E:s,sourceHandle:p?C:a,target:p?s:E,targetHandle:p?a:C};A.connection=M;const q=O&&R&&(n===qa.Strict?p&&N==="source"||!p&&N==="target":E!==s||C!==a);A.isValid=q&&f(M),A.toHandle=p1(E,N,C,g,n,!0)}return A}const Jp={onPointerDown:l$,isValid:v1};function c$({domNode:t,panZoom:e,getTransform:n,getViewScale:s}){const a=Sn(t);function l({translateExtent:d,width:h,height:f,zoomStep:g=1,pannable:p=!0,zoomable:v=!0,inversePan:b=!1}){const x=E=>{if(E.sourceEvent.type!=="wheel"||!e)return;const C=n(),O=E.sourceEvent.ctrlKey&&Hl()?10:1,R=-E.sourceEvent.deltaY*(E.sourceEvent.deltaMode===1?.05:E.sourceEvent.deltaMode?1:.002)*g,M=C[2]*Math.pow(2,R*O);e.scaleTo(M)};let w=[0,0];const S=E=>{(E.sourceEvent.type==="mousedown"||E.sourceEvent.type==="touchstart")&&(w=[E.sourceEvent.clientX??E.sourceEvent.touches[0].clientX,E.sourceEvent.clientY??E.sourceEvent.touches[0].clientY])},A=E=>{const C=n();if(E.sourceEvent.type!=="mousemove"&&E.sourceEvent.type!=="touchmove"||!e)return;const O=[E.sourceEvent.clientX??E.sourceEvent.touches[0].clientX,E.sourceEvent.clientY??E.sourceEvent.touches[0].clientY],R=[O[0]-w[0],O[1]-w[1]];w=O;const M=s()*Math.max(C[2],Math.log(C[2]))*(b?-1:1),I={x:C[0]-R[0]*M,y:C[1]-R[1]*M},q=[[0,0],[h,f]];e.setViewportConstrained({x:I.x,y:I.y,zoom:C[2]},q,d)},N=YE().on("start",S).on("zoom",p?A:null).on("zoom.wheel",v?x:null);a.call(N,{})}function c(){a.on("zoom",null)}return{update:l,destroy:c,pointer:Kn}}const uf=t=>({x:t.x,y:t.y,zoom:t.k}),op=({x:t,y:e,zoom:n})=>of.translate(t,e).scale(n),Ma=(t,e)=>t.target.closest(`.${e}`),b1=(t,e)=>e===2&&Array.isArray(t)&&t.includes(2),u$=t=>((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2,lp=(t,e=0,n=u$,s=()=>{})=>{const a=typeof e=="number"&&e>0;return a||s(),a?t.transition().duration(e).ease(n).on("end",s):t},_1=t=>{const e=t.ctrlKey&&Hl()?10:1;return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*e};function d$({zoomPanValues:t,noWheelClassName:e,d3Selection:n,d3Zoom:s,panOnScrollMode:a,panOnScrollSpeed:l,zoomOnPinch:c,onPanZoomStart:d,onPanZoom:h,onPanZoomEnd:f}){return g=>{if(Ma(g,e))return g.ctrlKey&&g.preventDefault(),!1;g.preventDefault(),g.stopImmediatePropagation();const p=n.property("__zoom").k||1;if(g.ctrlKey&&c){const S=Kn(g),A=_1(g),N=p*Math.pow(2,A);s.scaleTo(n,N,S,g);return}const v=g.deltaMode===1?20:1;let b=a===_i.Vertical?0:g.deltaX*v,x=a===_i.Horizontal?0:g.deltaY*v;!Hl()&&g.shiftKey&&a!==_i.Vertical&&(b=g.deltaY*v,x=0),s.translateBy(n,-(b/p)*l,-(x/p)*l,{internal:!0});const w=uf(n.property("__zoom"));clearTimeout(t.panScrollTimeout),t.isPanScrolling?(h?.(g,w),t.panScrollTimeout=setTimeout(()=>{f?.(g,w),t.isPanScrolling=!1},150)):(t.isPanScrolling=!0,d?.(g,w))}}function f$({noWheelClassName:t,preventScrolling:e,d3ZoomHandler:n}){return function(s,a){const l=s.type==="wheel",c=!e&&l&&!s.ctrlKey,d=Ma(s,t);if(s.ctrlKey&&l&&d&&s.preventDefault(),c||d)return null;s.preventDefault(),n.call(this,s,a)}}function h$({zoomPanValues:t,onDraggingChange:e,onPanZoomStart:n}){return s=>{if(s.sourceEvent?.internal)return;const a=uf(s.transform);t.mouseButton=s.sourceEvent?.button||0,t.isZoomingOrPanning=!0,t.prevViewport=a,s.sourceEvent?.type==="mousedown"&&e(!0),n&&n?.(s.sourceEvent,a)}}function m$({zoomPanValues:t,panOnDrag:e,onPaneContextMenu:n,onTransformChange:s,onPanZoom:a}){return l=>{t.usedRightMouseButton=!!(n&&b1(e,t.mouseButton??0)),l.sourceEvent?.sync||s([l.transform.x,l.transform.y,l.transform.k]),a&&!l.sourceEvent?.internal&&a?.(l.sourceEvent,uf(l.transform))}}function p$({zoomPanValues:t,panOnDrag:e,panOnScroll:n,onDraggingChange:s,onPanZoomEnd:a,onPaneContextMenu:l}){return c=>{if(!c.sourceEvent?.internal&&(t.isZoomingOrPanning=!1,l&&b1(e,t.mouseButton??0)&&!t.usedRightMouseButton&&c.sourceEvent&&l(c.sourceEvent),t.usedRightMouseButton=!1,s(!1),a)){const d=uf(c.transform);t.prevViewport=d,clearTimeout(t.timerId),t.timerId=setTimeout(()=>{a?.(c.sourceEvent,d)},n?150:0)}}}function g$({zoomActivationKeyPressed:t,zoomOnScroll:e,zoomOnPinch:n,panOnDrag:s,panOnScroll:a,zoomOnDoubleClick:l,userSelectionActive:c,noWheelClassName:d,noPanClassName:h,lib:f,connectionInProgress:g}){return p=>{const v=t||e,b=n&&p.ctrlKey,x=p.type==="wheel";if(p.button===1&&p.type==="mousedown"&&(Ma(p,`${f}-flow__node`)||Ma(p,`${f}-flow__edge`)))return!0;if(!s&&!v&&!a&&!l&&!n||c||g&&!x||Ma(p,d)&&x||Ma(p,h)&&(!x||a&&x&&!t)||!n&&p.ctrlKey&&x)return!1;if(!n&&p.type==="touchstart"&&p.touches?.length>1)return p.preventDefault(),!1;if(!v&&!a&&!b&&x||!s&&(p.type==="mousedown"||p.type==="touchstart")||Array.isArray(s)&&!s.includes(p.button)&&p.type==="mousedown")return!1;const w=Array.isArray(s)&&s.includes(p.button)||!p.button||p.button<=1;return(!p.ctrlKey||x)&&w}}function y$({domNode:t,minZoom:e,maxZoom:n,translateExtent:s,viewport:a,onPanZoom:l,onPanZoomStart:c,onPanZoomEnd:d,onDraggingChange:h}){const f={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},g=t.getBoundingClientRect(),p=YE().scaleExtent([e,n]).translateExtent(s),v=Sn(t).call(p);N({x:a.x,y:a.y,zoom:Ha(a.zoom,e,n)},[[0,0],[g.width,g.height]],s);const b=v.on("wheel.zoom"),x=v.on("dblclick.zoom");p.wheelDelta(_1);function w(Y,$){return v?new Promise(Q=>{p?.interpolate($?.interpolate==="linear"?Al:ud).transform(lp(v,$?.duration,$?.ease,()=>Q(!0)),Y)}):Promise.resolve(!1)}function S({noWheelClassName:Y,noPanClassName:$,onPaneContextMenu:Q,userSelectionActive:B,panOnScroll:G,panOnDrag:k,panOnScrollMode:L,panOnScrollSpeed:V,preventScrolling:P,zoomOnPinch:H,zoomOnScroll:D,zoomOnDoubleClick:z,zoomActivationKeyPressed:J,lib:ee,onTransformChange:he,connectionInProgress:pe,paneClickDistance:ae,selectionOnDrag:le}){B&&!f.isZoomingOrPanning&&A();const Z=G&&!J&&!B;p.clickDistance(le?1/0:!Wn(ae)||ae<0?0:ae);const de=Z?d$({zoomPanValues:f,noWheelClassName:Y,d3Selection:v,d3Zoom:p,panOnScrollMode:L,panOnScrollSpeed:V,zoomOnPinch:H,onPanZoomStart:c,onPanZoom:l,onPanZoomEnd:d}):f$({noWheelClassName:Y,preventScrolling:P,d3ZoomHandler:b});if(v.on("wheel.zoom",de,{passive:!1}),!B){const be=h$({zoomPanValues:f,onDraggingChange:h,onPanZoomStart:c});p.on("start",be);const te=m$({zoomPanValues:f,panOnDrag:k,onPaneContextMenu:!!Q,onPanZoom:l,onTransformChange:he});p.on("zoom",te);const ve=p$({zoomPanValues:f,panOnDrag:k,panOnScroll:G,onPaneContextMenu:Q,onPanZoomEnd:d,onDraggingChange:h});p.on("end",ve)}const ge=g$({zoomActivationKeyPressed:J,panOnDrag:k,zoomOnScroll:D,panOnScroll:G,zoomOnDoubleClick:z,zoomOnPinch:H,userSelectionActive:B,noPanClassName:$,noWheelClassName:Y,lib:ee,connectionInProgress:pe});p.filter(ge),z?v.on("dblclick.zoom",x):v.on("dblclick.zoom",null)}function A(){p.on("zoom",null)}async function N(Y,$,Q){const B=op(Y),G=p?.constrain()(B,$,Q);return G&&await w(G),new Promise(k=>k(G))}async function E(Y,$){const Q=op(Y);return await w(Q,$),new Promise(B=>B(Q))}function C(Y){if(v){const $=op(Y),Q=v.property("__zoom");(Q.k!==Y.zoom||Q.x!==Y.x||Q.y!==Y.y)&&p?.transform(v,$,null,{sync:!0})}}function O(){const Y=v?FE(v.node()):{x:0,y:0,k:1};return{x:Y.x,y:Y.y,zoom:Y.k}}function R(Y,$){return v?new Promise(Q=>{p?.interpolate($?.interpolate==="linear"?Al:ud).scaleTo(lp(v,$?.duration,$?.ease,()=>Q(!0)),Y)}):Promise.resolve(!1)}function M(Y,$){return v?new Promise(Q=>{p?.interpolate($?.interpolate==="linear"?Al:ud).scaleBy(lp(v,$?.duration,$?.ease,()=>Q(!0)),Y)}):Promise.resolve(!1)}function I(Y){p?.scaleExtent(Y)}function q(Y){p?.translateExtent(Y)}function K(Y){const $=!Wn(Y)||Y<0?0:Y;p?.clickDistance($)}return{update:S,destroy:A,setViewport:E,setViewportConstrained:N,getViewport:O,scaleTo:R,scaleBy:M,setScaleExtent:I,setTranslateExtent:q,syncViewport:C,setClickDistance:K}}var Ya;(function(t){t.Line="line",t.Handle="handle"})(Ya||(Ya={}));function v$({width:t,prevWidth:e,height:n,prevHeight:s,affectsX:a,affectsY:l}){const c=t-e,d=n-s,h=[c>0?1:c<0?-1:0,d>0?1:d<0?-1:0];return c&&a&&(h[0]=h[0]*-1),d&&l&&(h[1]=h[1]*-1),h}function qw(t){const e=t.includes("right")||t.includes("left"),n=t.includes("bottom")||t.includes("top"),s=t.includes("left"),a=t.includes("top");return{isHorizontal:e,isVertical:n,affectsX:s,affectsY:a}}function Ns(t,e){return Math.max(0,e-t)}function Os(t,e){return Math.max(0,t-e)}function Qu(t,e,n){return Math.max(0,e-t,t-n)}function Hw(t,e){return t?!e:e}function b$(t,e,n,s,a,l,c,d){let{affectsX:h,affectsY:f}=e;const{isHorizontal:g,isVertical:p}=e,v=g&&p,{xSnapped:b,ySnapped:x}=n,{minWidth:w,maxWidth:S,minHeight:A,maxHeight:N}=s,{x:E,y:C,width:O,height:R,aspectRatio:M}=t;let I=Math.floor(g?b-t.pointerX:0),q=Math.floor(p?x-t.pointerY:0);const K=O+(h?-I:I),Y=R+(f?-q:q),$=-l[0]*O,Q=-l[1]*R;let B=Qu(K,w,S),G=Qu(Y,A,N);if(c){let V=0,P=0;h&&I<0?V=Ns(E+I+$,c[0][0]):!h&&I>0&&(V=Os(E+K+$,c[1][0])),f&&q<0?P=Ns(C+q+Q,c[0][1]):!f&&q>0&&(P=Os(C+Y+Q,c[1][1])),B=Math.max(B,V),G=Math.max(G,P)}if(d){let V=0,P=0;h&&I>0?V=Os(E+I,d[0][0]):!h&&I<0&&(V=Ns(E+K,d[1][0])),f&&q>0?P=Os(C+q,d[0][1]):!f&&q<0&&(P=Ns(C+Y,d[1][1])),B=Math.max(B,V),G=Math.max(G,P)}if(a){if(g){const V=Qu(K/M,A,N)*M;if(B=Math.max(B,V),c){let P=0;!h&&!f||h&&!f&&v?P=Os(C+Q+K/M,c[1][1])*M:P=Ns(C+Q+(h?I:-I)/M,c[0][1])*M,B=Math.max(B,P)}if(d){let P=0;!h&&!f||h&&!f&&v?P=Ns(C+K/M,d[1][1])*M:P=Os(C+(h?I:-I)/M,d[0][1])*M,B=Math.max(B,P)}}if(p){const V=Qu(Y*M,w,S)/M;if(G=Math.max(G,V),c){let P=0;!h&&!f||f&&!h&&v?P=Os(E+Y*M+$,c[1][0])/M:P=Ns(E+(f?q:-q)*M+$,c[0][0])/M,G=Math.max(G,P)}if(d){let P=0;!h&&!f||f&&!h&&v?P=Ns(E+Y*M,d[1][0])/M:P=Os(E+(f?q:-q)*M,d[0][0])/M,G=Math.max(G,P)}}}q=q+(q<0?G:-G),I=I+(I<0?B:-B),a&&(v?K>Y*M?q=(Hw(h,f)?-I:I)/M:I=(Hw(h,f)?-q:q)*M:g?(q=I/M,f=h):(I=q*M,h=f));const k=h?E+I:E,L=f?C+q:C;return{width:O+(h?-I:I),height:R+(f?-q:q),x:l[0]*I*(h?-1:1)+k,y:l[1]*q*(f?-1:1)+L}}const w1={width:0,height:0,x:0,y:0},_$={...w1,pointerX:0,pointerY:0,aspectRatio:1};function w$(t){return[[0,0],[t.measured.width,t.measured.height]]}function x$(t,e,n){const s=e.position.x+t.position.x,a=e.position.y+t.position.y,l=t.measured.width??0,c=t.measured.height??0,d=n[0]*l,h=n[1]*c;return[[s-d,a-h],[s+l-d,a+c-h]]}function S$({domNode:t,nodeId:e,getStoreItems:n,onChange:s,onEnd:a}){const l=Sn(t);let c={controlDirection:qw("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function d({controlPosition:f,boundaries:g,keepAspectRatio:p,resizeDirection:v,onResizeStart:b,onResize:x,onResizeEnd:w,shouldResize:S}){let A={...w1},N={..._$};c={boundaries:g,resizeDirection:v,keepAspectRatio:p,controlDirection:qw(f)};let E,C=null,O=[],R,M,I,q=!1;const K=jE().on("start",Y=>{const{nodeLookup:$,transform:Q,snapGrid:B,snapToGrid:G,nodeOrigin:k,paneDomNode:L}=n();if(E=$.get(e),!E)return;C=L?.getBoundingClientRect()??null;const{xSnapped:V,ySnapped:P}=Tl(Y.sourceEvent,{transform:Q,snapGrid:B,snapToGrid:G,containerBounds:C});A={width:E.measured.width??0,height:E.measured.height??0,x:E.position.x??0,y:E.position.y??0},N={...A,pointerX:V,pointerY:P,aspectRatio:A.width/A.height},R=void 0,E.parentId&&(E.extent==="parent"||E.expandParent)&&(R=$.get(E.parentId),M=R&&E.extent==="parent"?w$(R):void 0),O=[],I=void 0;for(const[H,D]of $)if(D.parentId===e&&(O.push({id:H,position:{...D.position},extent:D.extent}),D.extent==="parent"||D.expandParent)){const z=x$(D,E,D.origin??k);I?I=[[Math.min(z[0][0],I[0][0]),Math.min(z[0][1],I[0][1])],[Math.max(z[1][0],I[1][0]),Math.max(z[1][1],I[1][1])]]:I=z}b?.(Y,{...A})}).on("drag",Y=>{const{transform:$,snapGrid:Q,snapToGrid:B,nodeOrigin:G}=n(),k=Tl(Y.sourceEvent,{transform:$,snapGrid:Q,snapToGrid:B,containerBounds:C}),L=[];if(!E)return;const{x:V,y:P,width:H,height:D}=A,z={},J=E.origin??G,{width:ee,height:he,x:pe,y:ae}=b$(N,c.controlDirection,k,c.boundaries,c.keepAspectRatio,J,M,I),le=ee!==H,Z=he!==D,de=pe!==V&&le,ge=ae!==P&&Z;if(!de&&!ge&&!le&&!Z)return;if((de||ge||J[0]===1||J[1]===1)&&(z.x=de?pe:A.x,z.y=ge?ae:A.y,A.x=z.x,A.y=z.y,O.length>0)){const _e=pe-V,Ie=ae-P;for(const qe of O)qe.position={x:qe.position.x-_e+J[0]*(ee-H),y:qe.position.y-Ie+J[1]*(he-D)},L.push(qe)}if((le||Z)&&(z.width=le&&(!c.resizeDirection||c.resizeDirection==="horizontal")?ee:A.width,z.height=Z&&(!c.resizeDirection||c.resizeDirection==="vertical")?he:A.height,A.width=z.width,A.height=z.height),R&&E.expandParent){const _e=J[0]*(z.width??0);z.x&&z.x<_e&&(A.x=_e,N.x=N.x-(z.x-_e));const Ie=J[1]*(z.height??0);z.y&&z.y<Ie&&(A.y=Ie,N.y=N.y-(z.y-Ie))}const be=v$({width:A.width,prevWidth:H,height:A.height,prevHeight:D,affectsX:c.controlDirection.affectsX,affectsY:c.controlDirection.affectsY}),te={...A,direction:be};S?.(Y,te)!==!1&&(q=!0,x?.(Y,te),s(z,L))}).on("end",Y=>{q&&(w?.(Y,{...A}),a?.({...A}),q=!1)});l.call(K)}function h(){l.on(".drag",null)}return{update:d,destroy:h}}var cp={exports:{}},up={},dp={exports:{}},fp={};var Vw;function E$(){if(Vw)return fp;Vw=1;var t=Gl();function e(p,v){return p===v&&(p!==0||1/p===1/v)||p!==p&&v!==v}var n=typeof Object.is=="function"?Object.is:e,s=t.useState,a=t.useEffect,l=t.useLayoutEffect,c=t.useDebugValue;function d(p,v){var b=v(),x=s({inst:{value:b,getSnapshot:v}}),w=x[0].inst,S=x[1];return l(function(){w.value=b,w.getSnapshot=v,h(w)&&S({inst:w})},[p,b,v]),a(function(){return h(w)&&S({inst:w}),p(function(){h(w)&&S({inst:w})})},[p]),c(b),b}function h(p){var v=p.getSnapshot;p=p.value;try{var b=v();return!n(p,b)}catch{return!0}}function f(p,v){return v()}var g=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:d;return fp.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:g,fp}var Fw;function C$(){return Fw||(Fw=1,dp.exports=E$()),dp.exports}var Yw;function A$(){if(Yw)return up;Yw=1;var t=Gl(),e=C$();function n(f,g){return f===g&&(f!==0||1/f===1/g)||f!==f&&g!==g}var s=typeof Object.is=="function"?Object.is:n,a=e.useSyncExternalStore,l=t.useRef,c=t.useEffect,d=t.useMemo,h=t.useDebugValue;return up.useSyncExternalStoreWithSelector=function(f,g,p,v,b){var x=l(null);if(x.current===null){var w={hasValue:!1,value:null};x.current=w}else w=x.current;x=d(function(){function A(R){if(!N){if(N=!0,E=R,R=v(R),b!==void 0&&w.hasValue){var M=w.value;if(b(M,R))return C=M}return C=R}if(M=C,s(E,R))return M;var I=v(R);return b!==void 0&&b(M,I)?(E=R,M):(E=R,C=I)}var N=!1,E,C,O=p===void 0?null:p;return[function(){return A(g())},O===null?void 0:function(){return A(O())}]},[g,p,v,b]);var S=a(f,x[0],x[1]);return c(function(){w.hasValue=!0,w.value=S},[S]),h(S),S},up}var Gw;function T$(){return Gw||(Gw=1,cp.exports=A$()),cp.exports}var N$=T$();const O$=Kd(N$),R$={},Xw=t=>{let e;const n=new Set,s=(g,p)=>{const v=typeof g=="function"?g(e):g;if(!Object.is(v,e)){const b=e;e=p??(typeof v!="object"||v===null)?v:Object.assign({},e,v),n.forEach(x=>x(e,b))}},a=()=>e,h={setState:s,getState:a,getInitialState:()=>f,subscribe:g=>(n.add(g),()=>n.delete(g)),destroy:()=>{(R$?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},f=e=t(s,a,h);return h},j$=t=>t?Xw(t):Xw,{useDebugValue:k$}=YN,{useSyncExternalStoreWithSelector:M$}=O$,D$=t=>t;function x1(t,e=D$,n){const s=M$(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return k$(s),s}const Kw=(t,e)=>{const n=j$(t),s=(a,l=e)=>x1(n,a,l);return Object.assign(s,n),s},U$=(t,e)=>t?Kw(t,e):Kw;function ft(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(const[s,a]of t)if(!Object.is(a,e.get(s)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(const s of t)if(!e.has(s))return!1;return!0}const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!1;for(const s of n)if(!Object.prototype.hasOwnProperty.call(e,s)||!Object.is(t[s],e[s]))return!1;return!0}const df=j.createContext(null),$$=df.Provider,S1=Zn.error001();function Ge(t,e){const n=j.useContext(df);if(n===null)throw new Error(S1);return x1(n,t,e)}function ct(){const t=j.useContext(df);if(t===null)throw new Error(S1);return j.useMemo(()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe}),[t])}const Qw={display:"none"},I$={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},E1="react-flow__node-desc",C1="react-flow__edge-desc",L$="react-flow__aria-live",z$=t=>t.ariaLiveMessage,B$=t=>t.ariaLabelConfig;function P$({rfId:t}){const e=Ge(z$);return _.jsx("div",{id:`${L$}-${t}`,"aria-live":"assertive","aria-atomic":"true",style:I$,children:e})}function q$({rfId:t,disableKeyboardA11y:e}){const n=Ge(B$);return _.jsxs(_.Fragment,{children:[_.jsx("div",{id:`${E1}-${t}`,style:Qw,children:e?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),_.jsx("div",{id:`${C1}-${t}`,style:Qw,children:n["edge.a11yDescription.default"]}),!e&&_.jsx(P$,{rfId:t})]})}const ff=j.forwardRef(({position:t="top-left",children:e,className:n,style:s,...a},l)=>{const c=`${t}`.split("-");return _.jsx("div",{className:Ct(["react-flow__panel",n,...c]),style:s,ref:l,...a,children:e})});ff.displayName="Panel";function H$({proOptions:t,position:e="bottom-right"}){return t?.hideAttribution?null:_.jsx(ff,{position:e,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:_.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const V$=t=>{const e=[],n=[];for(const[,s]of t.nodeLookup)s.selected&&e.push(s.internals.userNode);for(const[,s]of t.edgeLookup)s.selected&&n.push(s);return{selectedNodes:e,selectedEdges:n}},Wu=t=>t.id;function F$(t,e){return ft(t.selectedNodes.map(Wu),e.selectedNodes.map(Wu))&&ft(t.selectedEdges.map(Wu),e.selectedEdges.map(Wu))}function Y$({onSelectionChange:t}){const e=ct(),{selectedNodes:n,selectedEdges:s}=Ge(V$,F$);return j.useEffect(()=>{const a={nodes:n,edges:s};t?.(a),e.getState().onSelectionChangeHandlers.forEach(l=>l(a))},[n,s,t]),null}const G$=t=>!!t.onSelectionChangeHandlers;function X$({onSelectionChange:t}){const e=Ge(G$);return t||e?_.jsx(Y$,{onSelectionChange:t}):null}const A1=[0,0],K$={x:0,y:0,zoom:1},Q$=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig"],Ww=[...Q$,"rfId"],W$=t=>({setNodes:t.setNodes,setEdges:t.setEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges}),Jw={translateExtent:Bl,nodeOrigin:A1,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function J$(t){const{setNodes:e,setEdges:n,setMinZoom:s,setMaxZoom:a,setTranslateExtent:l,setNodeExtent:c,reset:d,setDefaultNodesAndEdges:h}=Ge(W$,ft),f=ct();j.useEffect(()=>(h(t.defaultNodes,t.defaultEdges),()=>{g.current=Jw,d()}),[]);const g=j.useRef(Jw);return j.useEffect(()=>{for(const p of Ww){const v=t[p],b=g.current[p];v!==b&&(typeof t[p]>"u"||(p==="nodes"?e(v):p==="edges"?n(v):p==="minZoom"?s(v):p==="maxZoom"?a(v):p==="translateExtent"?l(v):p==="nodeExtent"?c(v):p==="ariaLabelConfig"?f.setState({ariaLabelConfig:U3(v)}):p==="fitView"?f.setState({fitViewQueued:v}):p==="fitViewOptions"?f.setState({fitViewOptions:v}):f.setState({[p]:v})))}g.current=t},Ww.map(p=>t[p])),null}function Zw(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function Z$(t){const[e,n]=j.useState(t==="system"?null:t);return j.useEffect(()=>{if(t!=="system"){n(t);return}const s=Zw(),a=()=>n(s?.matches?"dark":"light");return a(),s?.addEventListener("change",a),()=>{s?.removeEventListener("change",a)}},[t]),e!==null?e:Zw()?.matches?"dark":"light"}const ex=typeof document<"u"?document:null;function Fl(t=null,e={target:ex,actInsideInputWithModifier:!0}){const[n,s]=j.useState(!1),a=j.useRef(!1),l=j.useRef(new Set([])),[c,d]=j.useMemo(()=>{if(t!==null){const f=(Array.isArray(t)?t:[t]).filter(p=>typeof p=="string").map(p=>p.replace("+",`
`).replace(`

`,`
+`).split(`
`)),g=f.reduce((p,v)=>p.concat(...v),[]);return[f,g]}return[[],[]]},[t]);return j.useEffect(()=>{const h=e?.target??ex,f=e?.actInsideInputWithModifier??!0;if(t!==null){const g=b=>{if(a.current=b.ctrlKey||b.metaKey||b.shiftKey||b.altKey,(!a.current||a.current&&!f)&&i1(b))return!1;const w=nx(b.code,d);if(l.current.add(b[w]),tx(c,l.current,!1)){const S=b.composedPath?.()?.[0]||b.target,A=S?.nodeName==="BUTTON"||S?.nodeName==="A";e.preventDefault!==!1&&(a.current||!A)&&b.preventDefault(),s(!0)}},p=b=>{const x=nx(b.code,d);tx(c,l.current,!0)?(s(!1),l.current.clear()):l.current.delete(b[x]),b.key==="Meta"&&l.current.clear(),a.current=!1},v=()=>{l.current.clear(),s(!1)};return h?.addEventListener("keydown",g),h?.addEventListener("keyup",p),window.addEventListener("blur",v),window.addEventListener("contextmenu",v),()=>{h?.removeEventListener("keydown",g),h?.removeEventListener("keyup",p),window.removeEventListener("blur",v),window.removeEventListener("contextmenu",v)}}},[t,s]),n}function tx(t,e,n){return t.filter(s=>n||s.length===e.size).some(s=>s.every(a=>e.has(a)))}function nx(t,e){return e.includes(t)?"code":"key"}const eI=()=>{const t=ct();return j.useMemo(()=>({zoomIn:e=>{const{panZoom:n}=t.getState();return n?n.scaleBy(1.2,{duration:e?.duration}):Promise.resolve(!1)},zoomOut:e=>{const{panZoom:n}=t.getState();return n?n.scaleBy(1/1.2,{duration:e?.duration}):Promise.resolve(!1)},zoomTo:(e,n)=>{const{panZoom:s}=t.getState();return s?s.scaleTo(e,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>t.getState().transform[2],setViewport:async(e,n)=>{const{transform:[s,a,l],panZoom:c}=t.getState();return c?(await c.setViewport({x:e.x??s,y:e.y??a,zoom:e.zoom??l},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[e,n,s]=t.getState().transform;return{x:e,y:n,zoom:s}},setCenter:async(e,n,s)=>t.getState().setCenter(e,n,s),fitBounds:async(e,n)=>{const{width:s,height:a,minZoom:l,maxZoom:c,panZoom:d}=t.getState(),h=Pg(e,s,a,l,c,n?.padding??.1);return d?(await d.setViewport(h,{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(e,n={})=>{const{transform:s,snapGrid:a,snapToGrid:l,domNode:c}=t.getState();if(!c)return e;const{x:d,y:h}=c.getBoundingClientRect(),f={x:e.x-d,y:e.y-h},g=n.snapGrid??a,p=n.snapToGrid??l;return sc(f,s,p,g)},flowToScreenPosition:e=>{const{transform:n,domNode:s}=t.getState();if(!s)return e;const{x:a,y:l}=s.getBoundingClientRect(),c=Ld(e,n);return{x:c.x+a,y:c.y+l}}}),[])};function T1(t,e){const n=[],s=new Map,a=[];for(const l of t)if(l.type==="add"){a.push(l);continue}else if(l.type==="remove"||l.type==="replace")s.set(l.id,[l]);else{const c=s.get(l.id);c?c.push(l):s.set(l.id,[l])}for(const l of e){const c=s.get(l.id);if(!c){n.push(l);continue}if(c[0].type==="remove")continue;if(c[0].type==="replace"){n.push({...c[0].item});continue}const d={...l};for(const h of c)tI(h,d);n.push(d)}return a.length&&a.forEach(l=>{l.index!==void 0?n.splice(l.index,0,{...l.item}):n.push({...l.item})}),n}function tI(t,e){switch(t.type){case"select":{e.selected=t.selected;break}case"position":{typeof t.position<"u"&&(e.position=t.position),typeof t.dragging<"u"&&(e.dragging=t.dragging);break}case"dimensions":{typeof t.dimensions<"u"&&(e.measured??={},e.measured.width=t.dimensions.width,e.measured.height=t.dimensions.height,t.setAttributes&&((t.setAttributes===!0||t.setAttributes==="width")&&(e.width=t.dimensions.width),(t.setAttributes===!0||t.setAttributes==="height")&&(e.height=t.dimensions.height))),typeof t.resizing=="boolean"&&(e.resizing=t.resizing);break}}}function N1(t,e){return T1(t,e)}function O1(t,e){return T1(t,e)}function ci(t,e){return{id:t,type:"select",selected:e}}function Da(t,e=new Set,n=!1){const s=[];for(const[a,l]of t){const c=e.has(a);!(l.selected===void 0&&!c)&&l.selected!==c&&(n&&(l.selected=c),s.push(ci(l.id,c)))}return s}function rx({items:t=[],lookup:e}){const n=[],s=new Map(t.map(a=>[a.id,a]));for(const[a,l]of t.entries()){const c=e.get(l.id),d=c?.internals?.userNode??c;d!==void 0&&d!==l&&n.push({id:l.id,item:l,type:"replace"}),d===void 0&&n.push({item:l,type:"add",index:a})}for(const[a]of e)s.get(a)===void 0&&n.push({id:a,type:"remove"});return n}function sx(t){return{id:t.id,type:"remove"}}const ix=t=>C3(t),nI=t=>WE(t);function R1(t){return j.forwardRef(t)}const rI=typeof window<"u"?j.useLayoutEffect:j.useEffect;function ax(t){const[e,n]=j.useState(BigInt(0)),[s]=j.useState(()=>sI(()=>n(a=>a+BigInt(1))));return rI(()=>{const a=s.get();a.length&&(t(a),s.reset())},[e]),s}function sI(t){let e=[];return{get:()=>e,reset:()=>{e=[]},push:n=>{e.push(n),t()}}}const j1=j.createContext(null);function iI({children:t}){const e=ct(),n=j.useCallback(d=>{const{nodes:h=[],setNodes:f,hasDefaultNodes:g,onNodesChange:p,nodeLookup:v,fitViewQueued:b}=e.getState();let x=h;for(const S of d)x=typeof S=="function"?S(x):S;const w=rx({items:x,lookup:v});g&&f(x),w.length>0?p?.(w):b&&window.requestAnimationFrame(()=>{const{fitViewQueued:S,nodes:A,setNodes:N}=e.getState();S&&N(A)})},[]),s=ax(n),a=j.useCallback(d=>{const{edges:h=[],setEdges:f,hasDefaultEdges:g,onEdgesChange:p,edgeLookup:v}=e.getState();let b=h;for(const x of d)b=typeof x=="function"?x(b):x;g?f(b):p&&p(rx({items:b,lookup:v}))},[]),l=ax(a),c=j.useMemo(()=>({nodeQueue:s,edgeQueue:l}),[]);return _.jsx(j1.Provider,{value:c,children:t})}function aI(){const t=j.useContext(j1);if(!t)throw new Error("useBatchContext must be used within a BatchProvider");return t}const oI=t=>!!t.panZoom;function Wa(){const t=eI(),e=ct(),n=aI(),s=Ge(oI),a=j.useMemo(()=>{const l=p=>e.getState().nodeLookup.get(p),c=p=>{n.nodeQueue.push(p)},d=p=>{n.edgeQueue.push(p)},h=p=>{const{nodeLookup:v,nodeOrigin:b}=e.getState(),x=ix(p)?p:v.get(p.id),w=x.parentId?r1(x.position,x.measured,x.parentId,v,b):x.position,S={...x,position:w,width:x.measured?.width??x.width,height:x.measured?.height??x.height};return Va(S)},f=(p,v,b={replace:!1})=>{c(x=>x.map(w=>{if(w.id===p){const S=typeof v=="function"?v(w):v;return b.replace&&ix(S)?S:{...w,...S}}return w}))},g=(p,v,b={replace:!1})=>{d(x=>x.map(w=>{if(w.id===p){const S=typeof v=="function"?v(w):v;return b.replace&&nI(S)?S:{...w,...S}}return w}))};return{getNodes:()=>e.getState().nodes.map(p=>({...p})),getNode:p=>l(p)?.internals.userNode,getInternalNode:l,getEdges:()=>{const{edges:p=[]}=e.getState();return p.map(v=>({...v}))},getEdge:p=>e.getState().edgeLookup.get(p),setNodes:c,setEdges:d,addNodes:p=>{const v=Array.isArray(p)?p:[p];n.nodeQueue.push(b=>[...b,...v])},addEdges:p=>{const v=Array.isArray(p)?p:[p];n.edgeQueue.push(b=>[...b,...v])},toObject:()=>{const{nodes:p=[],edges:v=[],transform:b}=e.getState(),[x,w,S]=b;return{nodes:p.map(A=>({...A})),edges:v.map(A=>({...A})),viewport:{x,y:w,zoom:S}}},deleteElements:async({nodes:p=[],edges:v=[]})=>{const{nodes:b,edges:x,onNodesDelete:w,onEdgesDelete:S,triggerNodeChanges:A,triggerEdgeChanges:N,onDelete:E,onBeforeDelete:C}=e.getState(),{nodes:O,edges:R}=await R3({nodesToRemove:p,edgesToRemove:v,nodes:b,edges:x,onBeforeDelete:C}),M=R.length>0,I=O.length>0;if(M){const q=R.map(sx);S?.(R),N(q)}if(I){const q=O.map(sx);w?.(O),A(q)}return(I||M)&&E?.({nodes:O,edges:R}),{deletedNodes:O,deletedEdges:R}},getIntersectingNodes:(p,v=!0,b)=>{const x=jw(p),w=x?p:h(p),S=b!==void 0;return w?(b||e.getState().nodes).filter(A=>{const N=e.getState().nodeLookup.get(A.id);if(N&&!x&&(A.id===p.id||!N.internals.positionAbsolute))return!1;const E=Va(S?A:N),C=ql(E,w);return v&&C>0||C>=E.width*E.height||C>=w.width*w.height}):[]},isNodeIntersecting:(p,v,b=!0)=>{const w=jw(p)?p:h(p);if(!w)return!1;const S=ql(w,v);return b&&S>0||S>=v.width*v.height||S>=w.width*w.height},updateNode:f,updateNodeData:(p,v,b={replace:!1})=>{f(p,x=>{const w=typeof v=="function"?v(x):v;return b.replace?{...x,data:w}:{...x,data:{...x.data,...w}}},b)},updateEdge:g,updateEdgeData:(p,v,b={replace:!1})=>{g(p,x=>{const w=typeof v=="function"?v(x):v;return b.replace?{...x,data:w}:{...x,data:{...x.data,...w}}},b)},getNodesBounds:p=>{const{nodeLookup:v,nodeOrigin:b}=e.getState();return A3(p,{nodeLookup:v,nodeOrigin:b})},getHandleConnections:({type:p,id:v,nodeId:b})=>Array.from(e.getState().connectionLookup.get(`${b}-${p}${v?`-${v}`:""}`)?.values()??[]),getNodeConnections:({type:p,handleId:v,nodeId:b})=>Array.from(e.getState().connectionLookup.get(`${b}${p?v?`-${p}-${v}`:`-${p}`:""}`)?.values()??[]),fitView:async p=>{const v=e.getState().fitViewResolver??D3();return e.setState({fitViewQueued:!0,fitViewOptions:p,fitViewResolver:v}),n.nodeQueue.push(b=>[...b]),v.promise}}},[]);return j.useMemo(()=>({...a,...t,viewportInitialized:s}),[s])}const ox=t=>t.selected,lI=typeof window<"u"?window:void 0;function cI({deleteKeyCode:t,multiSelectionKeyCode:e}){const n=ct(),{deleteElements:s}=Wa(),a=Fl(t,{actInsideInputWithModifier:!1}),l=Fl(e,{target:lI});j.useEffect(()=>{if(a){const{edges:c,nodes:d}=n.getState();s({nodes:d.filter(ox),edges:c.filter(ox)}),n.setState({nodesSelectionActive:!1})}},[a]),j.useEffect(()=>{n.setState({multiSelectionActive:l})},[l])}function uI(t){const e=ct();j.useEffect(()=>{const n=()=>{if(!t.current||!(t.current.checkVisibility?.()??!0))return!1;const s=qg(t.current);(s.height===0||s.width===0)&&e.getState().onError?.("004",Zn.error004()),e.setState({width:s.width||500,height:s.height||500})};if(t.current){n(),window.addEventListener("resize",n);const s=new ResizeObserver(()=>n());return s.observe(t.current),()=>{window.removeEventListener("resize",n),s&&t.current&&s.unobserve(t.current)}}},[])}const hf={position:"absolute",width:"100%",height:"100%",top:0,left:0},dI=t=>({userSelectionActive:t.userSelectionActive,lib:t.lib,connectionInProgress:t.connection.inProgress});function fI({onPaneContextMenu:t,zoomOnScroll:e=!0,zoomOnPinch:n=!0,panOnScroll:s=!1,panOnScrollSpeed:a=.5,panOnScrollMode:l=_i.Free,zoomOnDoubleClick:c=!0,panOnDrag:d=!0,defaultViewport:h,translateExtent:f,minZoom:g,maxZoom:p,zoomActivationKeyCode:v,preventScrolling:b=!0,children:x,noWheelClassName:w,noPanClassName:S,onViewportChange:A,isControlledViewport:N,paneClickDistance:E,selectionOnDrag:C}){const O=ct(),R=j.useRef(null),{userSelectionActive:M,lib:I,connectionInProgress:q}=Ge(dI,ft),K=Fl(v),Y=j.useRef();uI(R);const $=j.useCallback(Q=>{A?.({x:Q[0],y:Q[1],zoom:Q[2]}),N||O.setState({transform:Q})},[A,N]);return j.useEffect(()=>{if(R.current){Y.current=y$({domNode:R.current,minZoom:g,maxZoom:p,translateExtent:f,viewport:h,onDraggingChange:k=>O.setState({paneDragging:k}),onPanZoomStart:(k,L)=>{const{onViewportChangeStart:V,onMoveStart:P}=O.getState();P?.(k,L),V?.(L)},onPanZoom:(k,L)=>{const{onViewportChange:V,onMove:P}=O.getState();P?.(k,L),V?.(L)},onPanZoomEnd:(k,L)=>{const{onViewportChangeEnd:V,onMoveEnd:P}=O.getState();P?.(k,L),V?.(L)}});const{x:Q,y:B,zoom:G}=Y.current.getViewport();return O.setState({panZoom:Y.current,transform:[Q,B,G],domNode:R.current.closest(".react-flow")}),()=>{Y.current?.destroy()}}},[]),j.useEffect(()=>{Y.current?.update({onPaneContextMenu:t,zoomOnScroll:e,zoomOnPinch:n,panOnScroll:s,panOnScrollSpeed:a,panOnScrollMode:l,zoomOnDoubleClick:c,panOnDrag:d,zoomActivationKeyPressed:K,preventScrolling:b,noPanClassName:S,userSelectionActive:M,noWheelClassName:w,lib:I,onTransformChange:$,connectionInProgress:q,selectionOnDrag:C,paneClickDistance:E})},[t,e,n,s,a,l,c,d,K,b,S,M,w,I,$,q,C,E]),_.jsx("div",{className:"react-flow__renderer",ref:R,style:hf,children:x})}const hI=t=>({userSelectionActive:t.userSelectionActive,userSelectionRect:t.userSelectionRect});function mI(){const{userSelectionActive:t,userSelectionRect:e}=Ge(hI,ft);return t&&e?_.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:e.width,height:e.height,transform:`translate(${e.x}px, ${e.y}px)`}}):null}const hp=(t,e)=>n=>{n.target===e.current&&t?.(n)},pI=t=>({userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable,connectionInProgress:t.connection.inProgress,dragging:t.paneDragging});function gI({isSelecting:t,selectionKeyPressed:e,selectionMode:n=Pl.Full,panOnDrag:s,paneClickDistance:a,selectionOnDrag:l,onSelectionStart:c,onSelectionEnd:d,onPaneClick:h,onPaneContextMenu:f,onPaneScroll:g,onPaneMouseEnter:p,onPaneMouseMove:v,onPaneMouseLeave:b,children:x}){const w=ct(),{userSelectionActive:S,elementsSelectable:A,dragging:N,connectionInProgress:E}=Ge(pI,ft),C=A&&(t||S),O=j.useRef(null),R=j.useRef(),M=j.useRef(new Set),I=j.useRef(new Set),q=j.useRef(!1),K=V=>{if(q.current||E){q.current=!1;return}h?.(V),w.getState().resetSelectedElements(),w.setState({nodesSelectionActive:!1})},Y=V=>{if(Array.isArray(s)&&s?.includes(2)){V.preventDefault();return}f?.(V)},$=g?V=>g(V):void 0,Q=V=>{q.current&&(V.stopPropagation(),q.current=!1)},B=V=>{const{domNode:P}=w.getState();if(R.current=P?.getBoundingClientRect(),!R.current)return;const H=V.target===O.current;if(!H&&!!V.target.closest(".nokey")||!t||!(l&&H||e)||V.button!==0||!V.isPrimary)return;V.target?.setPointerCapture?.(V.pointerId),q.current=!1;const{x:J,y:ee}=Jn(V.nativeEvent,R.current);w.setState({userSelectionRect:{width:0,height:0,startX:J,startY:ee,x:J,y:ee}}),H||(V.stopPropagation(),V.preventDefault())},G=V=>{const{userSelectionRect:P,transform:H,nodeLookup:D,edgeLookup:z,connectionLookup:J,triggerNodeChanges:ee,triggerEdgeChanges:he,defaultEdgeOptions:pe,resetSelectedElements:ae}=w.getState();if(!R.current||!P)return;const{x:le,y:Z}=Jn(V.nativeEvent,R.current),{startX:de,startY:ge}=P;if(!q.current){const Ie=e?0:a;if(Math.hypot(le-de,Z-ge)<=Ie)return;ae(),c?.(V)}q.current=!0;const be={startX:de,startY:ge,x:le<de?le:de,y:Z<ge?Z:ge,width:Math.abs(le-de),height:Math.abs(Z-ge)},te=M.current,ve=I.current;M.current=new Set(Bg(D,be,H,n===Pl.Partial,!0).map(Ie=>Ie.id)),I.current=new Set;const _e=pe?.selectable??!0;for(const Ie of M.current){const qe=J.get(Ie);if(qe)for(const{edgeId:ot}of qe.values()){const kt=z.get(ot);kt&&(kt.selectable??_e)&&I.current.add(ot)}}if(!kw(te,M.current)){const Ie=Da(D,M.current,!0);ee(Ie)}if(!kw(ve,I.current)){const Ie=Da(z,I.current);he(Ie)}w.setState({userSelectionRect:be,userSelectionActive:!0,nodesSelectionActive:!1})},k=V=>{V.button===0&&(V.target?.releasePointerCapture?.(V.pointerId),!S&&V.target===O.current&&w.getState().userSelectionRect&&K?.(V),w.setState({userSelectionActive:!1,userSelectionRect:null}),q.current&&(d?.(V),w.setState({nodesSelectionActive:M.current.size>0})))},L=s===!0||Array.isArray(s)&&s.includes(0);return _.jsxs("div",{className:Ct(["react-flow__pane",{draggable:L,dragging:N,selection:t}]),onClick:C?void 0:hp(K,O),onContextMenu:hp(Y,O),onWheel:hp($,O),onPointerEnter:C?void 0:p,onPointerMove:C?G:v,onPointerUp:C?k:void 0,onPointerDownCapture:C?B:void 0,onClickCapture:C?Q:void 0,onPointerLeave:b,ref:O,style:hf,children:[x,_.jsx(mI,{})]})}function Zp({id:t,store:e,unselect:n=!1,nodeRef:s}){const{addSelectedNodes:a,unselectNodesAndEdges:l,multiSelectionActive:c,nodeLookup:d,onError:h}=e.getState(),f=d.get(t);if(!f){h?.("012",Zn.error012(t));return}e.setState({nodesSelectionActive:!1}),f.selected?(n||f.selected&&c)&&(l({nodes:[f],edges:[]}),requestAnimationFrame(()=>s?.current?.blur())):a([t])}function k1({nodeRef:t,disabled:e=!1,noDragClassName:n,handleSelector:s,nodeId:a,isSelectable:l,nodeClickDistance:c}){const d=ct(),[h,f]=j.useState(!1),g=j.useRef();return j.useEffect(()=>{g.current=r$({getStoreItems:()=>d.getState(),onNodeMouseDown:p=>{Zp({id:p,store:d,nodeRef:t})},onDragStart:()=>{f(!0)},onDragStop:()=>{f(!1)}})},[]),j.useEffect(()=>{if(e)g.current?.destroy();else if(t.current)return g.current?.update({noDragClassName:n,handleSelector:s,domNode:t.current,isSelectable:l,nodeId:a,nodeClickDistance:c}),()=>{g.current?.destroy()}},[n,s,e,l,t,a]),h}const yI=t=>e=>e.selected&&(e.draggable||t&&typeof e.draggable>"u");function M1(){const t=ct();return j.useCallback(n=>{const{nodeExtent:s,snapToGrid:a,snapGrid:l,nodesDraggable:c,onError:d,updateNodePositions:h,nodeLookup:f,nodeOrigin:g}=t.getState(),p=new Map,v=yI(c),b=a?l[0]:5,x=a?l[1]:5,w=n.direction.x*b*n.factor,S=n.direction.y*x*n.factor;for(const[,A]of f){if(!v(A))continue;let N={x:A.internals.positionAbsolute.x+w,y:A.internals.positionAbsolute.y+S};a&&(N=rc(N,l));const{position:E,positionAbsolute:C}=JE({nodeId:A.id,nextPosition:N,nodeLookup:f,nodeExtent:s,nodeOrigin:g,onError:d});A.position=E,A.internals.positionAbsolute=C,p.set(A.id,A)}h(p)},[])}const Xg=j.createContext(null),vI=Xg.Provider;Xg.Consumer;const Kg=()=>j.useContext(Xg),bI=t=>({connectOnClick:t.connectOnClick,noPanClassName:t.noPanClassName,rfId:t.rfId}),_I=(t,e,n)=>s=>{const{connectionClickStartHandle:a,connectionMode:l,connection:c}=s,{fromHandle:d,toHandle:h,isValid:f}=c,g=h?.nodeId===t&&h?.id===e&&h?.type===n;return{connectingFrom:d?.nodeId===t&&d?.id===e&&d?.type===n,connectingTo:g,clickConnecting:a?.nodeId===t&&a?.id===e&&a?.type===n,isPossibleEndHandle:l===qa.Strict?d?.type!==n:t!==d?.nodeId||e!==d?.id,connectionInProcess:!!d,clickConnectionInProcess:!!a,valid:g&&f}};function wI({type:t="source",position:e=Ce.Top,isValidConnection:n,isConnectable:s=!0,isConnectableStart:a=!0,isConnectableEnd:l=!0,id:c,onConnect:d,children:h,className:f,onMouseDown:g,onTouchStart:p,...v},b){const x=c||null,w=t==="target",S=ct(),A=Kg(),{connectOnClick:N,noPanClassName:E,rfId:C}=Ge(bI,ft),{connectingFrom:O,connectingTo:R,clickConnecting:M,isPossibleEndHandle:I,connectionInProcess:q,clickConnectionInProcess:K,valid:Y}=Ge(_I(A,x,t),ft);A||S.getState().onError?.("010",Zn.error010());const $=G=>{const{defaultEdgeOptions:k,onConnect:L,hasDefaultEdges:V}=S.getState(),P={...k,...G};if(V){const{edges:H,setEdges:D}=S.getState();D(c1(P,H))}L?.(P),d?.(P)},Q=G=>{if(!A)return;const k=a1(G.nativeEvent);if(a&&(k&&G.button===0||!k)){const L=S.getState();Jp.onPointerDown(G.nativeEvent,{handleDomNode:G.currentTarget,autoPanOnConnect:L.autoPanOnConnect,connectionMode:L.connectionMode,connectionRadius:L.connectionRadius,domNode:L.domNode,nodeLookup:L.nodeLookup,lib:L.lib,isTarget:w,handleId:x,nodeId:A,flowId:L.rfId,panBy:L.panBy,cancelConnection:L.cancelConnection,onConnectStart:L.onConnectStart,onConnectEnd:L.onConnectEnd,updateConnection:L.updateConnection,onConnect:$,isValidConnection:n||L.isValidConnection,getTransform:()=>S.getState().transform,getFromHandle:()=>S.getState().connection.fromHandle,autoPanSpeed:L.autoPanSpeed,dragThreshold:L.connectionDragThreshold})}k?g?.(G):p?.(G)},B=G=>{const{onClickConnectStart:k,onClickConnectEnd:L,connectionClickStartHandle:V,connectionMode:P,isValidConnection:H,lib:D,rfId:z,nodeLookup:J,connection:ee}=S.getState();if(!A||!V&&!a)return;if(!V){k?.(G.nativeEvent,{nodeId:A,handleId:x,handleType:t}),S.setState({connectionClickStartHandle:{nodeId:A,type:t,id:x}});return}const he=s1(G.target),pe=n||H,{connection:ae,isValid:le}=Jp.isValid(G.nativeEvent,{handle:{nodeId:A,id:x,type:t},connectionMode:P,fromNodeId:V.nodeId,fromHandleId:V.id||null,fromType:V.type,isValidConnection:pe,flowId:z,doc:he,lib:D,nodeLookup:J});le&&ae&&$(ae);const Z=structuredClone(ee);delete Z.inProgress,Z.toPosition=Z.toHandle?Z.toHandle.position:null,L?.(G,Z),S.setState({connectionClickStartHandle:null})};return _.jsx("div",{"data-handleid":x,"data-nodeid":A,"data-handlepos":e,"data-id":`${C}-${A}-${x}-${t}`,className:Ct(["react-flow__handle",`react-flow__handle-${e}`,"nodrag",E,f,{source:!w,target:w,connectable:s,connectablestart:a,connectableend:l,clickconnecting:M,connectingfrom:O,connectingto:R,valid:Y,connectionindicator:s&&(!q||I)&&(q||K?l:a)}]),onMouseDown:Q,onTouchStart:Q,onClick:N?B:void 0,ref:b,...v,children:h})}const Kt=j.memo(R1(wI));function xI({data:t,isConnectable:e,sourcePosition:n=Ce.Bottom}){return _.jsxs(_.Fragment,{children:[t?.label,_.jsx(Kt,{type:"source",position:n,isConnectable:e})]})}function SI({data:t,isConnectable:e,targetPosition:n=Ce.Top,sourcePosition:s=Ce.Bottom}){return _.jsxs(_.Fragment,{children:[_.jsx(Kt,{type:"target",position:n,isConnectable:e}),t?.label,_.jsx(Kt,{type:"source",position:s,isConnectable:e})]})}function EI(){return null}function CI({data:t,isConnectable:e,targetPosition:n=Ce.Top}){return _.jsxs(_.Fragment,{children:[_.jsx(Kt,{type:"target",position:n,isConnectable:e}),t?.label]})}const zd={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},lx={input:xI,default:SI,output:CI,group:EI};function AI(t){return t.internals.handleBounds===void 0?{width:t.width??t.initialWidth??t.style?.width,height:t.height??t.initialHeight??t.style?.height}:{width:t.width??t.style?.width,height:t.height??t.style?.height}}const TI=t=>{const{width:e,height:n,x:s,y:a}=nc(t.nodeLookup,{filter:l=>!!l.selected});return{width:Wn(e)?e:null,height:Wn(n)?n:null,userSelectionActive:t.userSelectionActive,transformString:`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]}) translate(${s}px,${a}px)`}};function NI({onSelectionContextMenu:t,noPanClassName:e,disableKeyboardA11y:n}){const s=ct(),{width:a,height:l,transformString:c,userSelectionActive:d}=Ge(TI,ft),h=M1(),f=j.useRef(null);if(j.useEffect(()=>{n||f.current?.focus({preventScroll:!0})},[n]),k1({nodeRef:f}),d||!a||!l)return null;const g=t?v=>{const b=s.getState().nodes.filter(x=>x.selected);t(v,b)}:void 0,p=v=>{Object.prototype.hasOwnProperty.call(zd,v.key)&&(v.preventDefault(),h({direction:zd[v.key],factor:v.shiftKey?4:1}))};return _.jsx("div",{className:Ct(["react-flow__nodesselection","react-flow__container",e]),style:{transform:c},children:_.jsx("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:g,tabIndex:n?void 0:-1,onKeyDown:n?void 0:p,style:{width:a,height:l}})})}const cx=typeof window<"u"?window:void 0,OI=t=>({nodesSelectionActive:t.nodesSelectionActive,userSelectionActive:t.userSelectionActive});function D1({children:t,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:s,onPaneMouseLeave:a,onPaneContextMenu:l,onPaneScroll:c,paneClickDistance:d,deleteKeyCode:h,selectionKeyCode:f,selectionOnDrag:g,selectionMode:p,onSelectionStart:v,onSelectionEnd:b,multiSelectionKeyCode:x,panActivationKeyCode:w,zoomActivationKeyCode:S,elementsSelectable:A,zoomOnScroll:N,zoomOnPinch:E,panOnScroll:C,panOnScrollSpeed:O,panOnScrollMode:R,zoomOnDoubleClick:M,panOnDrag:I,defaultViewport:q,translateExtent:K,minZoom:Y,maxZoom:$,preventScrolling:Q,onSelectionContextMenu:B,noWheelClassName:G,noPanClassName:k,disableKeyboardA11y:L,onViewportChange:V,isControlledViewport:P}){const{nodesSelectionActive:H,userSelectionActive:D}=Ge(OI),z=Fl(f,{target:cx}),J=Fl(w,{target:cx}),ee=J||I,he=J||C,pe=g&&ee!==!0,ae=z||D||pe;return cI({deleteKeyCode:h,multiSelectionKeyCode:x}),_.jsx(fI,{onPaneContextMenu:l,elementsSelectable:A,zoomOnScroll:N,zoomOnPinch:E,panOnScroll:he,panOnScrollSpeed:O,panOnScrollMode:R,zoomOnDoubleClick:M,panOnDrag:!z&&ee,defaultViewport:q,translateExtent:K,minZoom:Y,maxZoom:$,zoomActivationKeyCode:S,preventScrolling:Q,noWheelClassName:G,noPanClassName:k,onViewportChange:V,isControlledViewport:P,paneClickDistance:d,selectionOnDrag:pe,children:_.jsxs(gI,{onSelectionStart:v,onSelectionEnd:b,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:s,onPaneMouseLeave:a,onPaneContextMenu:l,onPaneScroll:c,panOnDrag:ee,isSelecting:!!ae,selectionMode:p,selectionKeyPressed:z,paneClickDistance:d,selectionOnDrag:pe,children:[t,H&&_.jsx(NI,{onSelectionContextMenu:B,noPanClassName:k,disableKeyboardA11y:L})]})})}D1.displayName="FlowRenderer";const RI=j.memo(D1),jI=t=>e=>t?Bg(e.nodeLookup,{x:0,y:0,width:e.width,height:e.height},e.transform,!0).map(n=>n.id):Array.from(e.nodeLookup.keys());function kI(t){return Ge(j.useCallback(jI(t),[t]),ft)}const MI=t=>t.updateNodeInternals;function DI(){const t=Ge(MI),[e]=j.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const s=new Map;n.forEach(a=>{const l=a.target.getAttribute("data-id");s.set(l,{id:l,nodeElement:a.target,force:!0})}),t(s)}));return j.useEffect(()=>()=>{e?.disconnect()},[e]),e}function UI({node:t,nodeType:e,hasDimensions:n,resizeObserver:s}){const a=ct(),l=j.useRef(null),c=j.useRef(null),d=j.useRef(t.sourcePosition),h=j.useRef(t.targetPosition),f=j.useRef(e),g=n&&!!t.internals.handleBounds;return j.useEffect(()=>{l.current&&!t.hidden&&(!g||c.current!==l.current)&&(c.current&&s?.unobserve(c.current),s?.observe(l.current),c.current=l.current)},[g,t.hidden]),j.useEffect(()=>()=>{c.current&&(s?.unobserve(c.current),c.current=null)},[]),j.useEffect(()=>{if(l.current){const p=f.current!==e,v=d.current!==t.sourcePosition,b=h.current!==t.targetPosition;(p||v||b)&&(f.current=e,d.current=t.sourcePosition,h.current=t.targetPosition,a.getState().updateNodeInternals(new Map([[t.id,{id:t.id,nodeElement:l.current,force:!0}]])))}},[t.id,e,t.sourcePosition,t.targetPosition]),l}function $I({id:t,onClick:e,onMouseEnter:n,onMouseMove:s,onMouseLeave:a,onContextMenu:l,onDoubleClick:c,nodesDraggable:d,elementsSelectable:h,nodesConnectable:f,nodesFocusable:g,resizeObserver:p,noDragClassName:v,noPanClassName:b,disableKeyboardA11y:x,rfId:w,nodeTypes:S,nodeClickDistance:A,onError:N}){const{node:E,internals:C,isParent:O}=Ge(le=>{const Z=le.nodeLookup.get(t),de=le.parentLookup.has(t);return{node:Z,internals:Z.internals,isParent:de}},ft);let R=E.type||"default",M=S?.[R]||lx[R];M===void 0&&(N?.("003",Zn.error003(R)),R="default",M=S?.default||lx.default);const I=!!(E.draggable||d&&typeof E.draggable>"u"),q=!!(E.selectable||h&&typeof E.selectable>"u"),K=!!(E.connectable||f&&typeof E.connectable>"u"),Y=!!(E.focusable||g&&typeof E.focusable>"u"),$=ct(),Q=n1(E),B=UI({node:E,nodeType:R,hasDimensions:Q,resizeObserver:p}),G=k1({nodeRef:B,disabled:E.hidden||!I,noDragClassName:v,handleSelector:E.dragHandle,nodeId:t,isSelectable:q,nodeClickDistance:A}),k=M1();if(E.hidden)return null;const L=Kr(E),V=AI(E),P=q||I||e||n||s||a,H=n?le=>n(le,{...C.userNode}):void 0,D=s?le=>s(le,{...C.userNode}):void 0,z=a?le=>a(le,{...C.userNode}):void 0,J=l?le=>l(le,{...C.userNode}):void 0,ee=c?le=>c(le,{...C.userNode}):void 0,he=le=>{const{selectNodesOnDrag:Z,nodeDragThreshold:de}=$.getState();q&&(!Z||!I||de>0)&&Zp({id:t,store:$,nodeRef:B}),e&&e(le,{...C.userNode})},pe=le=>{if(!(i1(le.nativeEvent)||x)){if(GE.includes(le.key)&&q){const Z=le.key==="Escape";Zp({id:t,store:$,unselect:Z,nodeRef:B})}else if(I&&E.selected&&Object.prototype.hasOwnProperty.call(zd,le.key)){le.preventDefault();const{ariaLabelConfig:Z}=$.getState();$.setState({ariaLiveMessage:Z["node.a11yDescription.ariaLiveMessage"]({direction:le.key.replace("Arrow","").toLowerCase(),x:~~C.positionAbsolute.x,y:~~C.positionAbsolute.y})}),k({direction:zd[le.key],factor:le.shiftKey?4:1})}}},ae=()=>{if(x||!B.current?.matches(":focus-visible"))return;const{transform:le,width:Z,height:de,autoPanOnNodeFocus:ge,setCenter:be}=$.getState();if(!ge)return;Bg(new Map([[t,E]]),{x:0,y:0,width:Z,height:de},le,!0).length>0||be(E.position.x+L.width/2,E.position.y+L.height/2,{zoom:le[2]})};return _.jsx("div",{className:Ct(["react-flow__node",`react-flow__node-${R}`,{[b]:I},E.className,{selected:E.selected,selectable:q,parent:O,draggable:I,dragging:G}]),ref:B,style:{zIndex:C.z,transform:`translate(${C.positionAbsolute.x}px,${C.positionAbsolute.y}px)`,pointerEvents:P?"all":"none",visibility:Q?"visible":"hidden",...E.style,...V},"data-id":t,"data-testid":`rf__node-${t}`,onMouseEnter:H,onMouseMove:D,onMouseLeave:z,onContextMenu:J,onClick:he,onDoubleClick:ee,onKeyDown:Y?pe:void 0,tabIndex:Y?0:void 0,onFocus:Y?ae:void 0,role:E.ariaRole??(Y?"group":void 0),"aria-roledescription":"node","aria-describedby":x?void 0:`${E1}-${w}`,"aria-label":E.ariaLabel,...E.domAttributes,children:_.jsx(vI,{value:t,children:_.jsx(M,{id:t,data:E.data,type:R,positionAbsoluteX:C.positionAbsolute.x,positionAbsoluteY:C.positionAbsolute.y,selected:E.selected??!1,selectable:q,draggable:I,deletable:E.deletable??!0,isConnectable:K,sourcePosition:E.sourcePosition,targetPosition:E.targetPosition,dragging:G,dragHandle:E.dragHandle,zIndex:C.z,parentId:E.parentId,...L})})})}var II=j.memo($I);const LI=t=>({nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,nodesFocusable:t.nodesFocusable,elementsSelectable:t.elementsSelectable,onError:t.onError});function U1(t){const{nodesDraggable:e,nodesConnectable:n,nodesFocusable:s,elementsSelectable:a,onError:l}=Ge(LI,ft),c=kI(t.onlyRenderVisibleElements),d=DI();return _.jsx("div",{className:"react-flow__nodes",style:hf,children:c.map(h=>_.jsx(II,{id:h,nodeTypes:t.nodeTypes,nodeExtent:t.nodeExtent,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,rfId:t.rfId,disableKeyboardA11y:t.disableKeyboardA11y,resizeObserver:d,nodesDraggable:e,nodesConnectable:n,nodesFocusable:s,elementsSelectable:a,nodeClickDistance:t.nodeClickDistance,onError:l},h))})}U1.displayName="NodeRenderer";const zI=j.memo(U1);function BI(t){return Ge(j.useCallback(n=>{if(!t)return n.edges.map(a=>a.id);const s=[];if(n.width&&n.height)for(const a of n.edges){const l=n.nodeLookup.get(a.source),c=n.nodeLookup.get(a.target);l&&c&&L3({sourceNode:l,targetNode:c,width:n.width,height:n.height,transform:n.transform})&&s.push(a.id)}return s},[t]),ft)}const PI=({color:t="none",strokeWidth:e=1})=>{const n={strokeWidth:e,...t&&{stroke:t}};return _.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},qI=({color:t="none",strokeWidth:e=1})=>{const n={strokeWidth:e,...t&&{stroke:t,fill:t}};return _.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},ux={[$d.Arrow]:PI,[$d.ArrowClosed]:qI};function HI(t){const e=ct();return j.useMemo(()=>Object.prototype.hasOwnProperty.call(ux,t)?ux[t]:(e.getState().onError?.("009",Zn.error009(t)),null),[t])}const VI=({id:t,type:e,color:n,width:s=12.5,height:a=12.5,markerUnits:l="strokeWidth",strokeWidth:c,orient:d="auto-start-reverse"})=>{const h=HI(e);return h?_.jsx("marker",{className:"react-flow__arrowhead",id:t,markerWidth:`${s}`,markerHeight:`${a}`,viewBox:"-10 -10 20 20",markerUnits:l,orient:d,refX:"0",refY:"0",children:_.jsx(h,{color:n,strokeWidth:c})}):null},$1=({defaultColor:t,rfId:e})=>{const n=Ge(l=>l.edges),s=Ge(l=>l.defaultEdgeOptions),a=j.useMemo(()=>F3(n,{id:e,defaultColor:t,defaultMarkerStart:s?.markerStart,defaultMarkerEnd:s?.markerEnd}),[n,s,e,t]);return a.length?_.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:_.jsx("defs",{children:a.map(l=>_.jsx(VI,{id:l.id,type:l.type,color:l.color,width:l.width,height:l.height,markerUnits:l.markerUnits,strokeWidth:l.strokeWidth,orient:l.orient},l.id))})}):null};$1.displayName="MarkerDefinitions";var FI=j.memo($1);function I1({x:t,y:e,label:n,labelStyle:s,labelShowBg:a=!0,labelBgStyle:l,labelBgPadding:c=[2,4],labelBgBorderRadius:d=2,children:h,className:f,...g}){const[p,v]=j.useState({x:1,y:0,width:0,height:0}),b=Ct(["react-flow__edge-textwrapper",f]),x=j.useRef(null);return j.useEffect(()=>{if(x.current){const w=x.current.getBBox();v({x:w.x,y:w.y,width:w.width,height:w.height})}},[n]),n?_.jsxs("g",{transform:`translate(${t-p.width/2} ${e-p.height/2})`,className:b,visibility:p.width?"visible":"hidden",...g,children:[a&&_.jsx("rect",{width:p.width+2*c[0],x:-c[0],y:-c[1],height:p.height+2*c[1],className:"react-flow__edge-textbg",style:l,rx:d,ry:d}),_.jsx("text",{className:"react-flow__edge-text",y:p.height/2,dy:"0.3em",ref:x,style:s,children:n}),h]}):null}I1.displayName="EdgeText";const YI=j.memo(I1);function mf({path:t,labelX:e,labelY:n,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:h,interactionWidth:f=20,...g}){return _.jsxs(_.Fragment,{children:[_.jsx("path",{...g,d:t,fill:"none",className:Ct(["react-flow__edge-path",g.className])}),f?_.jsx("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:f,className:"react-flow__edge-interaction"}):null,s&&Wn(e)&&Wn(n)?_.jsx(YI,{x:e,y:n,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:h}):null]})}function dx({pos:t,x1:e,y1:n,x2:s,y2:a}){return t===Ce.Left||t===Ce.Right?[.5*(e+s),n]:[e,.5*(n+a)]}function L1({sourceX:t,sourceY:e,sourcePosition:n=Ce.Bottom,targetX:s,targetY:a,targetPosition:l=Ce.Top}){const[c,d]=dx({pos:n,x1:t,y1:e,x2:s,y2:a}),[h,f]=dx({pos:l,x1:s,y1:a,x2:t,y2:e}),[g,p,v,b]=o1({sourceX:t,sourceY:e,targetX:s,targetY:a,sourceControlX:c,sourceControlY:d,targetControlX:h,targetControlY:f});return[`M${t},${e} C${c},${d} ${h},${f} ${s},${a}`,g,p,v,b]}function z1(t){return j.memo(({id:e,sourceX:n,sourceY:s,targetX:a,targetY:l,sourcePosition:c,targetPosition:d,label:h,labelStyle:f,labelShowBg:g,labelBgStyle:p,labelBgPadding:v,labelBgBorderRadius:b,style:x,markerEnd:w,markerStart:S,interactionWidth:A})=>{const[N,E,C]=L1({sourceX:n,sourceY:s,sourcePosition:c,targetX:a,targetY:l,targetPosition:d}),O=t.isInternal?void 0:e;return _.jsx(mf,{id:O,path:N,labelX:E,labelY:C,label:h,labelStyle:f,labelShowBg:g,labelBgStyle:p,labelBgPadding:v,labelBgBorderRadius:b,style:x,markerEnd:w,markerStart:S,interactionWidth:A})})}const GI=z1({isInternal:!1}),B1=z1({isInternal:!0});GI.displayName="SimpleBezierEdge";B1.displayName="SimpleBezierEdgeInternal";function P1(t){return j.memo(({id:e,sourceX:n,sourceY:s,targetX:a,targetY:l,label:c,labelStyle:d,labelShowBg:h,labelBgStyle:f,labelBgPadding:g,labelBgBorderRadius:p,style:v,sourcePosition:b=Ce.Bottom,targetPosition:x=Ce.Top,markerEnd:w,markerStart:S,pathOptions:A,interactionWidth:N})=>{const[E,C,O]=Kp({sourceX:n,sourceY:s,sourcePosition:b,targetX:a,targetY:l,targetPosition:x,borderRadius:A?.borderRadius,offset:A?.offset,stepPosition:A?.stepPosition}),R=t.isInternal?void 0:e;return _.jsx(mf,{id:R,path:E,labelX:C,labelY:O,label:c,labelStyle:d,labelShowBg:h,labelBgStyle:f,labelBgPadding:g,labelBgBorderRadius:p,style:v,markerEnd:w,markerStart:S,interactionWidth:N})})}const q1=P1({isInternal:!1}),H1=P1({isInternal:!0});q1.displayName="SmoothStepEdge";H1.displayName="SmoothStepEdgeInternal";function V1(t){return j.memo(({id:e,...n})=>{const s=t.isInternal?void 0:e;return _.jsx(q1,{...n,id:s,pathOptions:j.useMemo(()=>({borderRadius:0,offset:n.pathOptions?.offset}),[n.pathOptions?.offset])})})}const XI=V1({isInternal:!1}),F1=V1({isInternal:!0});XI.displayName="StepEdge";F1.displayName="StepEdgeInternal";function Y1(t){return j.memo(({id:e,sourceX:n,sourceY:s,targetX:a,targetY:l,label:c,labelStyle:d,labelShowBg:h,labelBgStyle:f,labelBgPadding:g,labelBgBorderRadius:p,style:v,markerEnd:b,markerStart:x,interactionWidth:w})=>{const[S,A,N]=u1({sourceX:n,sourceY:s,targetX:a,targetY:l}),E=t.isInternal?void 0:e;return _.jsx(mf,{id:E,path:S,labelX:A,labelY:N,label:c,labelStyle:d,labelShowBg:h,labelBgStyle:f,labelBgPadding:g,labelBgBorderRadius:p,style:v,markerEnd:b,markerStart:x,interactionWidth:w})})}const KI=Y1({isInternal:!1}),G1=Y1({isInternal:!0});KI.displayName="StraightEdge";G1.displayName="StraightEdgeInternal";function X1(t){return j.memo(({id:e,sourceX:n,sourceY:s,targetX:a,targetY:l,sourcePosition:c=Ce.Bottom,targetPosition:d=Ce.Top,label:h,labelStyle:f,labelShowBg:g,labelBgStyle:p,labelBgPadding:v,labelBgBorderRadius:b,style:x,markerEnd:w,markerStart:S,pathOptions:A,interactionWidth:N})=>{const[E,C,O]=Hg({sourceX:n,sourceY:s,sourcePosition:c,targetX:a,targetY:l,targetPosition:d,curvature:A?.curvature}),R=t.isInternal?void 0:e;return _.jsx(mf,{id:R,path:E,labelX:C,labelY:O,label:h,labelStyle:f,labelShowBg:g,labelBgStyle:p,labelBgPadding:v,labelBgBorderRadius:b,style:x,markerEnd:w,markerStart:S,interactionWidth:N})})}const QI=X1({isInternal:!1}),K1=X1({isInternal:!0});QI.displayName="BezierEdge";K1.displayName="BezierEdgeInternal";const fx={default:K1,straight:G1,step:F1,smoothstep:H1,simplebezier:B1},hx={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},WI=(t,e,n)=>n===Ce.Left?t-e:n===Ce.Right?t+e:t,JI=(t,e,n)=>n===Ce.Top?t-e:n===Ce.Bottom?t+e:t,mx="react-flow__edgeupdater";function px({position:t,centerX:e,centerY:n,radius:s=10,onMouseDown:a,onMouseEnter:l,onMouseOut:c,type:d}){return _.jsx("circle",{onMouseDown:a,onMouseEnter:l,onMouseOut:c,className:Ct([mx,`${mx}-${d}`]),cx:WI(e,s,t),cy:JI(n,s,t),r:s,stroke:"transparent",fill:"transparent"})}function ZI({isReconnectable:t,reconnectRadius:e,edge:n,sourceX:s,sourceY:a,targetX:l,targetY:c,sourcePosition:d,targetPosition:h,onReconnect:f,onReconnectStart:g,onReconnectEnd:p,setReconnecting:v,setUpdateHover:b}){const x=ct(),w=(C,O)=>{if(C.button!==0)return;const{autoPanOnConnect:R,domNode:M,isValidConnection:I,connectionMode:q,connectionRadius:K,lib:Y,onConnectStart:$,onConnectEnd:Q,cancelConnection:B,nodeLookup:G,rfId:k,panBy:L,updateConnection:V}=x.getState(),P=O.type==="target",H=(J,ee)=>{v(!1),p?.(J,n,O.type,ee)},D=J=>f?.(n,J),z=(J,ee)=>{v(!0),g?.(C,n,O.type),$?.(J,ee)};Jp.onPointerDown(C.nativeEvent,{autoPanOnConnect:R,connectionMode:q,connectionRadius:K,domNode:M,handleId:O.id,nodeId:O.nodeId,nodeLookup:G,isTarget:P,edgeUpdaterType:O.type,lib:Y,flowId:k,cancelConnection:B,panBy:L,isValidConnection:I,onConnect:D,onConnectStart:z,onConnectEnd:Q,onReconnectEnd:H,updateConnection:V,getTransform:()=>x.getState().transform,getFromHandle:()=>x.getState().connection.fromHandle,dragThreshold:x.getState().connectionDragThreshold,handleDomNode:C.currentTarget})},S=C=>w(C,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),A=C=>w(C,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),N=()=>b(!0),E=()=>b(!1);return _.jsxs(_.Fragment,{children:[(t===!0||t==="source")&&_.jsx(px,{position:d,centerX:s,centerY:a,radius:e,onMouseDown:S,onMouseEnter:N,onMouseOut:E,type:"source"}),(t===!0||t==="target")&&_.jsx(px,{position:h,centerX:l,centerY:c,radius:e,onMouseDown:A,onMouseEnter:N,onMouseOut:E,type:"target"})]})}function eL({id:t,edgesFocusable:e,edgesReconnectable:n,elementsSelectable:s,onClick:a,onDoubleClick:l,onContextMenu:c,onMouseEnter:d,onMouseMove:h,onMouseLeave:f,reconnectRadius:g,onReconnect:p,onReconnectStart:v,onReconnectEnd:b,rfId:x,edgeTypes:w,noPanClassName:S,onError:A,disableKeyboardA11y:N}){let E=Ge(be=>be.edgeLookup.get(t));const C=Ge(be=>be.defaultEdgeOptions);E=C?{...C,...E}:E;let O=E.type||"default",R=w?.[O]||fx[O];R===void 0&&(A?.("011",Zn.error011(O)),O="default",R=w?.default||fx.default);const M=!!(E.focusable||e&&typeof E.focusable>"u"),I=typeof p<"u"&&(E.reconnectable||n&&typeof E.reconnectable>"u"),q=!!(E.selectable||s&&typeof E.selectable>"u"),K=j.useRef(null),[Y,$]=j.useState(!1),[Q,B]=j.useState(!1),G=ct(),{zIndex:k,sourceX:L,sourceY:V,targetX:P,targetY:H,sourcePosition:D,targetPosition:z}=Ge(j.useCallback(be=>{const te=be.nodeLookup.get(E.source),ve=be.nodeLookup.get(E.target);if(!te||!ve)return{zIndex:E.zIndex,...hx};const _e=V3({id:t,sourceNode:te,targetNode:ve,sourceHandle:E.sourceHandle||null,targetHandle:E.targetHandle||null,connectionMode:be.connectionMode,onError:A});return{zIndex:I3({selected:E.selected,zIndex:E.zIndex,sourceNode:te,targetNode:ve,elevateOnSelect:be.elevateEdgesOnSelect}),..._e||hx}},[E.source,E.target,E.sourceHandle,E.targetHandle,E.selected,E.zIndex]),ft),J=j.useMemo(()=>E.markerStart?`url('#${Qp(E.markerStart,x)}')`:void 0,[E.markerStart,x]),ee=j.useMemo(()=>E.markerEnd?`url('#${Qp(E.markerEnd,x)}')`:void 0,[E.markerEnd,x]);if(E.hidden||L===null||V===null||P===null||H===null)return null;const he=be=>{const{addSelectedEdges:te,unselectNodesAndEdges:ve,multiSelectionActive:_e}=G.getState();q&&(G.setState({nodesSelectionActive:!1}),E.selected&&_e?(ve({nodes:[],edges:[E]}),K.current?.blur()):te([t])),a&&a(be,E)},pe=l?be=>{l(be,{...E})}:void 0,ae=c?be=>{c(be,{...E})}:void 0,le=d?be=>{d(be,{...E})}:void 0,Z=h?be=>{h(be,{...E})}:void 0,de=f?be=>{f(be,{...E})}:void 0,ge=be=>{if(!N&&GE.includes(be.key)&&q){const{unselectNodesAndEdges:te,addSelectedEdges:ve}=G.getState();be.key==="Escape"?(K.current?.blur(),te({edges:[E]})):ve([t])}};return _.jsx("svg",{style:{zIndex:k},children:_.jsxs("g",{className:Ct(["react-flow__edge",`react-flow__edge-${O}`,E.className,S,{selected:E.selected,animated:E.animated,inactive:!q&&!a,updating:Y,selectable:q}]),onClick:he,onDoubleClick:pe,onContextMenu:ae,onMouseEnter:le,onMouseMove:Z,onMouseLeave:de,onKeyDown:M?ge:void 0,tabIndex:M?0:void 0,role:E.ariaRole??(M?"group":"img"),"aria-roledescription":"edge","data-id":t,"data-testid":`rf__edge-${t}`,"aria-label":E.ariaLabel===null?void 0:E.ariaLabel||`Edge from ${E.source} to ${E.target}`,"aria-describedby":M?`${C1}-${x}`:void 0,ref:K,...E.domAttributes,children:[!Q&&_.jsx(R,{id:t,source:E.source,target:E.target,type:E.type,selected:E.selected,animated:E.animated,selectable:q,deletable:E.deletable??!0,label:E.label,labelStyle:E.labelStyle,labelShowBg:E.labelShowBg,labelBgStyle:E.labelBgStyle,labelBgPadding:E.labelBgPadding,labelBgBorderRadius:E.labelBgBorderRadius,sourceX:L,sourceY:V,targetX:P,targetY:H,sourcePosition:D,targetPosition:z,data:E.data,style:E.style,sourceHandleId:E.sourceHandle,targetHandleId:E.targetHandle,markerStart:J,markerEnd:ee,pathOptions:"pathOptions"in E?E.pathOptions:void 0,interactionWidth:E.interactionWidth}),I&&_.jsx(ZI,{edge:E,isReconnectable:I,reconnectRadius:g,onReconnect:p,onReconnectStart:v,onReconnectEnd:b,sourceX:L,sourceY:V,targetX:P,targetY:H,sourcePosition:D,targetPosition:z,setUpdateHover:$,setReconnecting:B})]})})}var tL=j.memo(eL);const nL=t=>({edgesFocusable:t.edgesFocusable,edgesReconnectable:t.edgesReconnectable,elementsSelectable:t.elementsSelectable,connectionMode:t.connectionMode,onError:t.onError});function Q1({defaultMarkerColor:t,onlyRenderVisibleElements:e,rfId:n,edgeTypes:s,noPanClassName:a,onReconnect:l,onEdgeContextMenu:c,onEdgeMouseEnter:d,onEdgeMouseMove:h,onEdgeMouseLeave:f,onEdgeClick:g,reconnectRadius:p,onEdgeDoubleClick:v,onReconnectStart:b,onReconnectEnd:x,disableKeyboardA11y:w}){const{edgesFocusable:S,edgesReconnectable:A,elementsSelectable:N,onError:E}=Ge(nL,ft),C=BI(e);return _.jsxs("div",{className:"react-flow__edges",children:[_.jsx(FI,{defaultColor:t,rfId:n}),C.map(O=>_.jsx(tL,{id:O,edgesFocusable:S,edgesReconnectable:A,elementsSelectable:N,noPanClassName:a,onReconnect:l,onContextMenu:c,onMouseEnter:d,onMouseMove:h,onMouseLeave:f,onClick:g,reconnectRadius:p,onDoubleClick:v,onReconnectStart:b,onReconnectEnd:x,rfId:n,onError:E,edgeTypes:s,disableKeyboardA11y:w},O))]})}Q1.displayName="EdgeRenderer";const rL=j.memo(Q1),sL=t=>`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`;function iL({children:t}){const e=Ge(sL);return _.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:e},children:t})}function aL(t){const e=Wa(),n=j.useRef(!1);j.useEffect(()=>{!n.current&&e.viewportInitialized&&t&&(setTimeout(()=>t(e),1),n.current=!0)},[t,e.viewportInitialized])}const oL=t=>t.panZoom?.syncViewport;function lL(t){const e=Ge(oL),n=ct();return j.useEffect(()=>{t&&(e?.(t),n.setState({transform:[t.x,t.y,t.zoom]}))},[t,e]),null}function cL(t){return t.connection.inProgress?{...t.connection,to:sc(t.connection.to,t.transform)}:{...t.connection}}function uL(t){return cL}function dL(t){const e=uL();return Ge(e,ft)}const fL=t=>({nodesConnectable:t.nodesConnectable,isValid:t.connection.isValid,inProgress:t.connection.inProgress,width:t.width,height:t.height});function hL({containerStyle:t,style:e,type:n,component:s}){const{nodesConnectable:a,width:l,height:c,isValid:d,inProgress:h}=Ge(fL,ft);return!(l&&a&&h)?null:_.jsx("svg",{style:t,width:l,height:c,className:"react-flow__connectionline react-flow__container",children:_.jsx("g",{className:Ct(["react-flow__connection",QE(d)]),children:_.jsx(W1,{style:e,type:n,CustomComponent:s,isValid:d})})})}const W1=({style:t,type:e=Ds.Bezier,CustomComponent:n,isValid:s})=>{const{inProgress:a,from:l,fromNode:c,fromHandle:d,fromPosition:h,to:f,toNode:g,toHandle:p,toPosition:v,pointer:b}=dL();if(!a)return;if(n)return _.jsx(n,{connectionLineType:e,connectionLineStyle:t,fromNode:c,fromHandle:d,fromX:l.x,fromY:l.y,toX:f.x,toY:f.y,fromPosition:h,toPosition:v,connectionStatus:QE(s),toNode:g,toHandle:p,pointer:b});let x="";const w={sourceX:l.x,sourceY:l.y,sourcePosition:h,targetX:f.x,targetY:f.y,targetPosition:v};switch(e){case Ds.Bezier:[x]=Hg(w);break;case Ds.SimpleBezier:[x]=L1(w);break;case Ds.Step:[x]=Kp({...w,borderRadius:0});break;case Ds.SmoothStep:[x]=Kp(w);break;default:[x]=u1(w)}return _.jsx("path",{d:x,fill:"none",className:"react-flow__connection-path",style:t})};W1.displayName="ConnectionLine";const mL={};function gx(t=mL){j.useRef(t),ct(),j.useEffect(()=>{},[t])}function pL(){ct(),j.useRef(!1),j.useEffect(()=>{},[])}function J1({nodeTypes:t,edgeTypes:e,onInit:n,onNodeClick:s,onEdgeClick:a,onNodeDoubleClick:l,onEdgeDoubleClick:c,onNodeMouseEnter:d,onNodeMouseMove:h,onNodeMouseLeave:f,onNodeContextMenu:g,onSelectionContextMenu:p,onSelectionStart:v,onSelectionEnd:b,connectionLineType:x,connectionLineStyle:w,connectionLineComponent:S,connectionLineContainerStyle:A,selectionKeyCode:N,selectionOnDrag:E,selectionMode:C,multiSelectionKeyCode:O,panActivationKeyCode:R,zoomActivationKeyCode:M,deleteKeyCode:I,onlyRenderVisibleElements:q,elementsSelectable:K,defaultViewport:Y,translateExtent:$,minZoom:Q,maxZoom:B,preventScrolling:G,defaultMarkerColor:k,zoomOnScroll:L,zoomOnPinch:V,panOnScroll:P,panOnScrollSpeed:H,panOnScrollMode:D,zoomOnDoubleClick:z,panOnDrag:J,onPaneClick:ee,onPaneMouseEnter:he,onPaneMouseMove:pe,onPaneMouseLeave:ae,onPaneScroll:le,onPaneContextMenu:Z,paneClickDistance:de,nodeClickDistance:ge,onEdgeContextMenu:be,onEdgeMouseEnter:te,onEdgeMouseMove:ve,onEdgeMouseLeave:_e,reconnectRadius:Ie,onReconnect:qe,onReconnectStart:ot,onReconnectEnd:kt,noDragClassName:In,noWheelClassName:Jt,noPanClassName:Ln,disableKeyboardA11y:pr,nodeExtent:At,rfId:Qr,viewport:Cn,onViewportChange:tr}){return gx(t),gx(e),pL(),aL(n),lL(Cn),_.jsx(RI,{onPaneClick:ee,onPaneMouseEnter:he,onPaneMouseMove:pe,onPaneMouseLeave:ae,onPaneContextMenu:Z,onPaneScroll:le,paneClickDistance:de,deleteKeyCode:I,selectionKeyCode:N,selectionOnDrag:E,selectionMode:C,onSelectionStart:v,onSelectionEnd:b,multiSelectionKeyCode:O,panActivationKeyCode:R,zoomActivationKeyCode:M,elementsSelectable:K,zoomOnScroll:L,zoomOnPinch:V,zoomOnDoubleClick:z,panOnScroll:P,panOnScrollSpeed:H,panOnScrollMode:D,panOnDrag:J,defaultViewport:Y,translateExtent:$,minZoom:Q,maxZoom:B,onSelectionContextMenu:p,preventScrolling:G,noDragClassName:In,noWheelClassName:Jt,noPanClassName:Ln,disableKeyboardA11y:pr,onViewportChange:tr,isControlledViewport:!!Cn,children:_.jsxs(iL,{children:[_.jsx(rL,{edgeTypes:e,onEdgeClick:a,onEdgeDoubleClick:c,onReconnect:qe,onReconnectStart:ot,onReconnectEnd:kt,onlyRenderVisibleElements:q,onEdgeContextMenu:be,onEdgeMouseEnter:te,onEdgeMouseMove:ve,onEdgeMouseLeave:_e,reconnectRadius:Ie,defaultMarkerColor:k,noPanClassName:Ln,disableKeyboardA11y:pr,rfId:Qr}),_.jsx(hL,{style:w,type:x,component:S,containerStyle:A}),_.jsx("div",{className:"react-flow__edgelabel-renderer"}),_.jsx(zI,{nodeTypes:t,onNodeClick:s,onNodeDoubleClick:l,onNodeMouseEnter:d,onNodeMouseMove:h,onNodeMouseLeave:f,onNodeContextMenu:g,nodeClickDistance:ge,onlyRenderVisibleElements:q,noPanClassName:Ln,noDragClassName:In,disableKeyboardA11y:pr,nodeExtent:At,rfId:Qr}),_.jsx("div",{className:"react-flow__viewport-portal"})]})})}J1.displayName="GraphView";const gL=j.memo(J1),yx=({nodes:t,edges:e,defaultNodes:n,defaultEdges:s,width:a,height:l,fitView:c,fitViewOptions:d,minZoom:h=.5,maxZoom:f=2,nodeOrigin:g,nodeExtent:p}={})=>{const v=new Map,b=new Map,x=new Map,w=new Map,S=s??e??[],A=n??t??[],N=g??[0,0],E=p??Bl;h1(x,w,S);const C=Wp(A,v,b,{nodeOrigin:N,nodeExtent:E,elevateNodesOnSelect:!1});let O=[0,0,1];if(c&&a&&l){const R=nc(v,{filter:K=>!!((K.width||K.initialWidth)&&(K.height||K.initialHeight))}),{x:M,y:I,zoom:q}=Pg(R,a,l,h,f,d?.padding??.1);O=[M,I,q]}return{rfId:"1",width:a??0,height:l??0,transform:O,nodes:A,nodesInitialized:C,nodeLookup:v,parentLookup:b,edges:S,edgeLookup:w,connectionLookup:x,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:s!==void 0,panZoom:null,minZoom:h,maxZoom:f,translateExtent:Bl,nodeExtent:E,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:qa.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:N,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:c??!1,fitViewOptions:d,fitViewResolver:null,connection:{...KE},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:j3,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:XE}},yL=({nodes:t,edges:e,defaultNodes:n,defaultEdges:s,width:a,height:l,fitView:c,fitViewOptions:d,minZoom:h,maxZoom:f,nodeOrigin:g,nodeExtent:p})=>U$((v,b)=>{async function x(){const{nodeLookup:w,panZoom:S,fitViewOptions:A,fitViewResolver:N,width:E,height:C,minZoom:O,maxZoom:R}=b();S&&(await O3({nodes:w,width:E,height:C,panZoom:S,minZoom:O,maxZoom:R},A),N?.resolve(!0),v({fitViewResolver:null}))}return{...yx({nodes:t,edges:e,width:a,height:l,fitView:c,fitViewOptions:d,minZoom:h,maxZoom:f,nodeOrigin:g,nodeExtent:p,defaultNodes:n,defaultEdges:s}),setNodes:w=>{const{nodeLookup:S,parentLookup:A,nodeOrigin:N,elevateNodesOnSelect:E,fitViewQueued:C}=b(),O=Wp(w,S,A,{nodeOrigin:N,nodeExtent:p,elevateNodesOnSelect:E,checkEquality:!0});C&&O?(x(),v({nodes:w,nodesInitialized:O,fitViewQueued:!1,fitViewOptions:void 0})):v({nodes:w,nodesInitialized:O})},setEdges:w=>{const{connectionLookup:S,edgeLookup:A}=b();h1(S,A,w),v({edges:w})},setDefaultNodesAndEdges:(w,S)=>{if(w){const{setNodes:A}=b();A(w),v({hasDefaultNodes:!0})}if(S){const{setEdges:A}=b();A(S),v({hasDefaultEdges:!0})}},updateNodeInternals:w=>{const{triggerNodeChanges:S,nodeLookup:A,parentLookup:N,domNode:E,nodeOrigin:C,nodeExtent:O,debug:R,fitViewQueued:M}=b(),{changes:I,updatedInternals:q}=J3(w,A,N,E,C,O);q&&(X3(A,N,{nodeOrigin:C,nodeExtent:O}),M?(x(),v({fitViewQueued:!1,fitViewOptions:void 0})):v({}),I?.length>0&&(R&&console.log("React Flow: trigger node changes",I),S?.(I)))},updateNodePositions:(w,S=!1)=>{const A=[],N=[],{nodeLookup:E,triggerNodeChanges:C}=b();for(const[O,R]of w){const M=E.get(O),I=!!(M?.expandParent&&M?.parentId&&R?.position),q={id:O,type:"position",position:I?{x:Math.max(0,R.position.x),y:Math.max(0,R.position.y)}:R.position,dragging:S};I&&M.parentId&&A.push({id:O,parentId:M.parentId,rect:{...R.internals.positionAbsolute,width:R.measured.width??0,height:R.measured.height??0}}),N.push(q)}if(A.length>0){const{parentLookup:O,nodeOrigin:R}=b(),M=Gg(A,E,O,R);N.push(...M)}C(N)},triggerNodeChanges:w=>{const{onNodesChange:S,setNodes:A,nodes:N,hasDefaultNodes:E,debug:C}=b();if(w?.length){if(E){const O=N1(w,N);A(O)}C&&console.log("React Flow: trigger node changes",w),S?.(w)}},triggerEdgeChanges:w=>{const{onEdgesChange:S,setEdges:A,edges:N,hasDefaultEdges:E,debug:C}=b();if(w?.length){if(E){const O=O1(w,N);A(O)}C&&console.log("React Flow: trigger edge changes",w),S?.(w)}},addSelectedNodes:w=>{const{multiSelectionActive:S,edgeLookup:A,nodeLookup:N,triggerNodeChanges:E,triggerEdgeChanges:C}=b();if(S){const O=w.map(R=>ci(R,!0));E(O);return}E(Da(N,new Set([...w]),!0)),C(Da(A))},addSelectedEdges:w=>{const{multiSelectionActive:S,edgeLookup:A,nodeLookup:N,triggerNodeChanges:E,triggerEdgeChanges:C}=b();if(S){const O=w.map(R=>ci(R,!0));C(O);return}C(Da(A,new Set([...w]))),E(Da(N,new Set,!0))},unselectNodesAndEdges:({nodes:w,edges:S}={})=>{const{edges:A,nodes:N,nodeLookup:E,triggerNodeChanges:C,triggerEdgeChanges:O}=b(),R=w||N,M=S||A,I=R.map(K=>{const Y=E.get(K.id);return Y&&(Y.selected=!1),ci(K.id,!1)}),q=M.map(K=>ci(K.id,!1));C(I),O(q)},setMinZoom:w=>{const{panZoom:S,maxZoom:A}=b();S?.setScaleExtent([w,A]),v({minZoom:w})},setMaxZoom:w=>{const{panZoom:S,minZoom:A}=b();S?.setScaleExtent([A,w]),v({maxZoom:w})},setTranslateExtent:w=>{b().panZoom?.setTranslateExtent(w),v({translateExtent:w})},resetSelectedElements:()=>{const{edges:w,nodes:S,triggerNodeChanges:A,triggerEdgeChanges:N,elementsSelectable:E}=b();if(!E)return;const C=S.reduce((R,M)=>M.selected?[...R,ci(M.id,!1)]:R,[]),O=w.reduce((R,M)=>M.selected?[...R,ci(M.id,!1)]:R,[]);A(C),N(O)},setNodeExtent:w=>{const{nodes:S,nodeLookup:A,parentLookup:N,nodeOrigin:E,elevateNodesOnSelect:C,nodeExtent:O}=b();w[0][0]===O[0][0]&&w[0][1]===O[0][1]&&w[1][0]===O[1][0]&&w[1][1]===O[1][1]||(Wp(S,A,N,{nodeOrigin:E,nodeExtent:w,elevateNodesOnSelect:C,checkEquality:!1}),v({nodeExtent:w}))},panBy:w=>{const{transform:S,width:A,height:N,panZoom:E,translateExtent:C}=b();return Z3({delta:w,panZoom:E,transform:S,translateExtent:C,width:A,height:N})},setCenter:async(w,S,A)=>{const{width:N,height:E,maxZoom:C,panZoom:O}=b();if(!O)return Promise.resolve(!1);const R=typeof A?.zoom<"u"?A.zoom:C;return await O.setViewport({x:N/2-w*R,y:E/2-S*R,zoom:R},{duration:A?.duration,ease:A?.ease,interpolate:A?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{v({connection:{...KE}})},updateConnection:w=>{v({connection:w})},reset:()=>v({...yx()})}},Object.is);function vL({initialNodes:t,initialEdges:e,defaultNodes:n,defaultEdges:s,initialWidth:a,initialHeight:l,initialMinZoom:c,initialMaxZoom:d,initialFitViewOptions:h,fitView:f,nodeOrigin:g,nodeExtent:p,children:v}){const[b]=j.useState(()=>yL({nodes:t,edges:e,defaultNodes:n,defaultEdges:s,width:a,height:l,fitView:f,minZoom:c,maxZoom:d,fitViewOptions:h,nodeOrigin:g,nodeExtent:p}));return _.jsx($$,{value:b,children:_.jsx(iI,{children:v})})}function bL({children:t,nodes:e,edges:n,defaultNodes:s,defaultEdges:a,width:l,height:c,fitView:d,fitViewOptions:h,minZoom:f,maxZoom:g,nodeOrigin:p,nodeExtent:v}){return j.useContext(df)?_.jsx(_.Fragment,{children:t}):_.jsx(vL,{initialNodes:e,initialEdges:n,defaultNodes:s,defaultEdges:a,initialWidth:l,initialHeight:c,fitView:d,initialFitViewOptions:h,initialMinZoom:f,initialMaxZoom:g,nodeOrigin:p,nodeExtent:v,children:t})}const _L={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function wL({nodes:t,edges:e,defaultNodes:n,defaultEdges:s,className:a,nodeTypes:l,edgeTypes:c,onNodeClick:d,onEdgeClick:h,onInit:f,onMove:g,onMoveStart:p,onMoveEnd:v,onConnect:b,onConnectStart:x,onConnectEnd:w,onClickConnectStart:S,onClickConnectEnd:A,onNodeMouseEnter:N,onNodeMouseMove:E,onNodeMouseLeave:C,onNodeContextMenu:O,onNodeDoubleClick:R,onNodeDragStart:M,onNodeDrag:I,onNodeDragStop:q,onNodesDelete:K,onEdgesDelete:Y,onDelete:$,onSelectionChange:Q,onSelectionDragStart:B,onSelectionDrag:G,onSelectionDragStop:k,onSelectionContextMenu:L,onSelectionStart:V,onSelectionEnd:P,onBeforeDelete:H,connectionMode:D,connectionLineType:z=Ds.Bezier,connectionLineStyle:J,connectionLineComponent:ee,connectionLineContainerStyle:he,deleteKeyCode:pe="Backspace",selectionKeyCode:ae="Shift",selectionOnDrag:le=!1,selectionMode:Z=Pl.Full,panActivationKeyCode:de="Space",multiSelectionKeyCode:ge=Hl()?"Meta":"Control",zoomActivationKeyCode:be=Hl()?"Meta":"Control",snapToGrid:te,snapGrid:ve,onlyRenderVisibleElements:_e=!1,selectNodesOnDrag:Ie,nodesDraggable:qe,autoPanOnNodeFocus:ot,nodesConnectable:kt,nodesFocusable:In,nodeOrigin:Jt=A1,edgesFocusable:Ln,edgesReconnectable:pr,elementsSelectable:At=!0,defaultViewport:Qr=K$,minZoom:Cn=.5,maxZoom:tr=2,translateExtent:gr=Bl,preventScrolling:eo=!0,nodeExtent:Wr,defaultMarkerColor:zs="#b1b1b7",zoomOnScroll:to=!0,zoomOnPinch:me=!0,panOnScroll:Ee=!1,panOnScrollSpeed:we=.5,panOnScrollMode:De=_i.Free,zoomOnDoubleClick:ht=!0,panOnDrag:Mt=!0,onPaneClick:Cf,onPaneMouseEnter:Ni,onPaneMouseMove:Oi,onPaneMouseLeave:Ri,onPaneScroll:yr,onPaneContextMenu:ji,paneClickDistance:Bs=1,nodeClickDistance:Af=0,children:lc,onReconnect:no,onReconnectStart:Ps,onReconnectEnd:Tf,onEdgeContextMenu:cc,onEdgeDoubleClick:uc,onEdgeMouseEnter:dc,onEdgeMouseMove:ro,onEdgeMouseLeave:so,reconnectRadius:fc=10,onNodesChange:hc,onEdgesChange:nr,noDragClassName:Tt="nodrag",noWheelClassName:Ht="nowheel",noPanClassName:vr="nopan",fitView:ki,fitViewOptions:mc,connectOnClick:Nf,attributionPosition:pc,proOptions:qs,defaultEdgeOptions:io,elevateNodesOnSelect:Jr,elevateEdgesOnSelect:Zr,disableKeyboardA11y:es=!1,autoPanOnConnect:ts,autoPanOnNodeDrag:vt,autoPanSpeed:gc,connectionRadius:yc,isValidConnection:br,onError:ns,style:Of,id:ao,nodeDragThreshold:vc,connectionDragThreshold:Rf,viewport:Mi,onViewportChange:Di,width:zn,height:Zt,colorMode:bc="light",debug:jf,onScroll:Ui,ariaLabelConfig:_c,...$i},kf){const Vt=ao||"1",oo=Z$(bc),wc=j.useCallback(Ii=>{Ii.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Ui?.(Ii)},[Ui]);return _.jsx("div",{"data-testid":"rf__wrapper",...$i,onScroll:wc,style:{...Of,..._L},ref:kf,className:Ct(["react-flow",a,oo]),id:ao,role:"application",children:_.jsxs(bL,{nodes:t,edges:e,width:zn,height:Zt,fitView:ki,fitViewOptions:mc,minZoom:Cn,maxZoom:tr,nodeOrigin:Jt,nodeExtent:Wr,children:[_.jsx(gL,{onInit:f,onNodeClick:d,onEdgeClick:h,onNodeMouseEnter:N,onNodeMouseMove:E,onNodeMouseLeave:C,onNodeContextMenu:O,onNodeDoubleClick:R,nodeTypes:l,edgeTypes:c,connectionLineType:z,connectionLineStyle:J,connectionLineComponent:ee,connectionLineContainerStyle:he,selectionKeyCode:ae,selectionOnDrag:le,selectionMode:Z,deleteKeyCode:pe,multiSelectionKeyCode:ge,panActivationKeyCode:de,zoomActivationKeyCode:be,onlyRenderVisibleElements:_e,defaultViewport:Qr,translateExtent:gr,minZoom:Cn,maxZoom:tr,preventScrolling:eo,zoomOnScroll:to,zoomOnPinch:me,zoomOnDoubleClick:ht,panOnScroll:Ee,panOnScrollSpeed:we,panOnScrollMode:De,panOnDrag:Mt,onPaneClick:Cf,onPaneMouseEnter:Ni,onPaneMouseMove:Oi,onPaneMouseLeave:Ri,onPaneScroll:yr,onPaneContextMenu:ji,paneClickDistance:Bs,nodeClickDistance:Af,onSelectionContextMenu:L,onSelectionStart:V,onSelectionEnd:P,onReconnect:no,onReconnectStart:Ps,onReconnectEnd:Tf,onEdgeContextMenu:cc,onEdgeDoubleClick:uc,onEdgeMouseEnter:dc,onEdgeMouseMove:ro,onEdgeMouseLeave:so,reconnectRadius:fc,defaultMarkerColor:zs,noDragClassName:Tt,noWheelClassName:Ht,noPanClassName:vr,rfId:Vt,disableKeyboardA11y:es,nodeExtent:Wr,viewport:Mi,onViewportChange:Di}),_.jsx(J$,{nodes:t,edges:e,defaultNodes:n,defaultEdges:s,onConnect:b,onConnectStart:x,onConnectEnd:w,onClickConnectStart:S,onClickConnectEnd:A,nodesDraggable:qe,autoPanOnNodeFocus:ot,nodesConnectable:kt,nodesFocusable:In,edgesFocusable:Ln,edgesReconnectable:pr,elementsSelectable:At,elevateNodesOnSelect:Jr,elevateEdgesOnSelect:Zr,minZoom:Cn,maxZoom:tr,nodeExtent:Wr,onNodesChange:hc,onEdgesChange:nr,snapToGrid:te,snapGrid:ve,connectionMode:D,translateExtent:gr,connectOnClick:Nf,defaultEdgeOptions:io,fitView:ki,fitViewOptions:mc,onNodesDelete:K,onEdgesDelete:Y,onDelete:$,onNodeDragStart:M,onNodeDrag:I,onNodeDragStop:q,onSelectionDrag:G,onSelectionDragStart:B,onSelectionDragStop:k,onMove:g,onMoveStart:p,onMoveEnd:v,noPanClassName:vr,nodeOrigin:Jt,rfId:Vt,autoPanOnConnect:ts,autoPanOnNodeDrag:vt,autoPanSpeed:gc,onError:ns,connectionRadius:yc,isValidConnection:br,selectNodesOnDrag:Ie,nodeDragThreshold:vc,connectionDragThreshold:Rf,onBeforeDelete:H,debug:jf,ariaLabelConfig:_c}),_.jsx(X$,{onSelectionChange:Q}),lc,_.jsx(H$,{proOptions:qs,position:pc}),_.jsx(q$,{rfId:Vt,disableKeyboardA11y:es})]})})}var xL=R1(wL);const SL=Zn.error014();function Z1({id:t,handleType:e,handleId:n,onConnect:s,onDisconnect:a}={}){const l=Kg(),c=t??l;if(!c)throw new Error(SL);const d=j.useRef(null),h=Ge(f=>f.connectionLookup.get(`${c}${e?n?`-${e}-${n}`:`-${e}`:""}`),E3);return j.useEffect(()=>{if(d.current&&d.current!==h){const f=h??new Map;Ow(d.current,f,a),Ow(f,d.current,s)}d.current=h??new Map},[h,s,a]),j.useMemo(()=>Array.from(h?.values()??[]),[h])}function EL(t){return Ge(j.useCallback(n=>{const s=[],a=Array.isArray(t),l=a?t:[t];for(const c of l){const d=n.nodeLookup.get(c);d&&s.push({id:d.id,type:d.type,data:d.data})}return a?s:s[0]??null},[t]),e$)}function CL({dimensions:t,lineWidth:e,variant:n,className:s}){return _.jsx("path",{strokeWidth:e,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`,className:Ct(["react-flow__background-pattern",n,s])})}function AL({radius:t,className:e}){return _.jsx("circle",{cx:t,cy:t,r:t,className:Ct(["react-flow__background-pattern","dots",e])})}var Us;(function(t){t.Lines="lines",t.Dots="dots",t.Cross="cross"})(Us||(Us={}));const TL={[Us.Dots]:1,[Us.Lines]:1,[Us.Cross]:6},NL=t=>({transform:t.transform,patternId:`pattern-${t.rfId}`});function eC({id:t,variant:e=Us.Dots,gap:n=20,size:s,lineWidth:a=1,offset:l=0,color:c,bgColor:d,style:h,className:f,patternClassName:g}){const p=j.useRef(null),{transform:v,patternId:b}=Ge(NL,ft),x=s||TL[e],w=e===Us.Dots,S=e===Us.Cross,A=Array.isArray(n)?n:[n,n],N=[A[0]*v[2]||1,A[1]*v[2]||1],E=x*v[2],C=Array.isArray(l)?l:[l,l],O=S?[E,E]:N,R=[C[0]*v[2]||1+O[0]/2,C[1]*v[2]||1+O[1]/2],M=`${b}${t||""}`;return _.jsxs("svg",{className:Ct(["react-flow__background",f]),style:{...h,...hf,"--xy-background-color-props":d,"--xy-background-pattern-color-props":c},ref:p,"data-testid":"rf__background",children:[_.jsx("pattern",{id:M,x:v[0]%N[0],y:v[1]%N[1],width:N[0],height:N[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${R[0]},-${R[1]})`,children:w?_.jsx(AL,{radius:E/2,className:g}):_.jsx(CL,{dimensions:O,lineWidth:a,variant:e,className:g})}),_.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${M})`})]})}eC.displayName="Background";const OL=j.memo(eC);function RL(){return _.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:_.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function jL(){return _.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:_.jsx("path",{d:"M0 0h32v4.2H0z"})})}function kL(){return _.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:_.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function ML(){return _.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:_.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function DL(){return _.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:_.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Ju({children:t,className:e,...n}){return _.jsx("button",{type:"button",className:Ct(["react-flow__controls-button",e]),...n,children:t})}const UL=t=>({isInteractive:t.nodesDraggable||t.nodesConnectable||t.elementsSelectable,minZoomReached:t.transform[2]<=t.minZoom,maxZoomReached:t.transform[2]>=t.maxZoom,ariaLabelConfig:t.ariaLabelConfig});function tC({style:t,showZoom:e=!0,showFitView:n=!0,showInteractive:s=!0,fitViewOptions:a,onZoomIn:l,onZoomOut:c,onFitView:d,onInteractiveChange:h,className:f,children:g,position:p="bottom-left",orientation:v="vertical","aria-label":b}){const x=ct(),{isInteractive:w,minZoomReached:S,maxZoomReached:A,ariaLabelConfig:N}=Ge(UL,ft),{zoomIn:E,zoomOut:C,fitView:O}=Wa(),R=()=>{E(),l?.()},M=()=>{C(),c?.()},I=()=>{O(a),d?.()},q=()=>{x.setState({nodesDraggable:!w,nodesConnectable:!w,elementsSelectable:!w}),h?.(!w)},K=v==="horizontal"?"horizontal":"vertical";return _.jsxs(ff,{className:Ct(["react-flow__controls",K,f]),position:p,style:t,"data-testid":"rf__controls","aria-label":b??N["controls.ariaLabel"],children:[e&&_.jsxs(_.Fragment,{children:[_.jsx(Ju,{onClick:R,className:"react-flow__controls-zoomin",title:N["controls.zoomIn.ariaLabel"],"aria-label":N["controls.zoomIn.ariaLabel"],disabled:A,children:_.jsx(RL,{})}),_.jsx(Ju,{onClick:M,className:"react-flow__controls-zoomout",title:N["controls.zoomOut.ariaLabel"],"aria-label":N["controls.zoomOut.ariaLabel"],disabled:S,children:_.jsx(jL,{})})]}),n&&_.jsx(Ju,{className:"react-flow__controls-fitview",onClick:I,title:N["controls.fitView.ariaLabel"],"aria-label":N["controls.fitView.ariaLabel"],children:_.jsx(kL,{})}),s&&_.jsx(Ju,{className:"react-flow__controls-interactive",onClick:q,title:N["controls.interactive.ariaLabel"],"aria-label":N["controls.interactive.ariaLabel"],children:w?_.jsx(DL,{}):_.jsx(ML,{})}),g]})}tC.displayName="Controls";const $L=j.memo(tC);function IL({id:t,x:e,y:n,width:s,height:a,style:l,color:c,strokeColor:d,strokeWidth:h,className:f,borderRadius:g,shapeRendering:p,selected:v,onClick:b}){const{background:x,backgroundColor:w}=l||{},S=c||x||w;return _.jsx("rect",{className:Ct(["react-flow__minimap-node",{selected:v},f]),x:e,y:n,rx:g,ry:g,width:s,height:a,style:{fill:S,stroke:d,strokeWidth:h},shapeRendering:p,onClick:b?A=>b(A,t):void 0})}const LL=j.memo(IL),zL=t=>t.nodes.map(e=>e.id),mp=t=>t instanceof Function?t:()=>t;function BL({nodeStrokeColor:t,nodeColor:e,nodeClassName:n="",nodeBorderRadius:s=5,nodeStrokeWidth:a,nodeComponent:l=LL,onClick:c}){const d=Ge(zL,ft),h=mp(e),f=mp(t),g=mp(n),p=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return _.jsx(_.Fragment,{children:d.map(v=>_.jsx(qL,{id:v,nodeColorFunc:h,nodeStrokeColorFunc:f,nodeClassNameFunc:g,nodeBorderRadius:s,nodeStrokeWidth:a,NodeComponent:l,onClick:c,shapeRendering:p},v))})}function PL({id:t,nodeColorFunc:e,nodeStrokeColorFunc:n,nodeClassNameFunc:s,nodeBorderRadius:a,nodeStrokeWidth:l,shapeRendering:c,NodeComponent:d,onClick:h}){const{node:f,x:g,y:p,width:v,height:b}=Ge(x=>{const{internals:w}=x.nodeLookup.get(t),S=w.userNode,{x:A,y:N}=w.positionAbsolute,{width:E,height:C}=Kr(S);return{node:S,x:A,y:N,width:E,height:C}},ft);return!f||f.hidden||!n1(f)?null:_.jsx(d,{x:g,y:p,width:v,height:b,style:f.style,selected:!!f.selected,className:s(f),color:e(f),borderRadius:a,strokeColor:n(f),strokeWidth:l,shapeRendering:c,onClick:h,id:f.id})}const qL=j.memo(PL);var HL=j.memo(BL);const VL=200,FL=150,YL=t=>!t.hidden,GL=t=>{const e={x:-t.transform[0]/t.transform[2],y:-t.transform[1]/t.transform[2],width:t.width/t.transform[2],height:t.height/t.transform[2]};return{viewBB:e,boundingRect:t.nodeLookup.size>0?t1(nc(t.nodeLookup,{filter:YL}),e):e,rfId:t.rfId,panZoom:t.panZoom,translateExtent:t.translateExtent,flowWidth:t.width,flowHeight:t.height,ariaLabelConfig:t.ariaLabelConfig}},XL="react-flow__minimap-desc";function nC({style:t,className:e,nodeStrokeColor:n,nodeColor:s,nodeClassName:a="",nodeBorderRadius:l=5,nodeStrokeWidth:c,nodeComponent:d,bgColor:h,maskColor:f,maskStrokeColor:g,maskStrokeWidth:p,position:v="bottom-right",onClick:b,onNodeClick:x,pannable:w=!1,zoomable:S=!1,ariaLabel:A,inversePan:N,zoomStep:E=1,offsetScale:C=5}){const O=ct(),R=j.useRef(null),{boundingRect:M,viewBB:I,rfId:q,panZoom:K,translateExtent:Y,flowWidth:$,flowHeight:Q,ariaLabelConfig:B}=Ge(GL,ft),G=t?.width??VL,k=t?.height??FL,L=M.width/G,V=M.height/k,P=Math.max(L,V),H=P*G,D=P*k,z=C*P,J=M.x-(H-M.width)/2-z,ee=M.y-(D-M.height)/2-z,he=H+z*2,pe=D+z*2,ae=`${XL}-${q}`,le=j.useRef(0),Z=j.useRef();le.current=P,j.useEffect(()=>{if(R.current&&K)return Z.current=c$({domNode:R.current,panZoom:K,getTransform:()=>O.getState().transform,getViewScale:()=>le.current}),()=>{Z.current?.destroy()}},[K]),j.useEffect(()=>{Z.current?.update({translateExtent:Y,width:$,height:Q,inversePan:N,pannable:w,zoomStep:E,zoomable:S})},[w,S,N,E,Y,$,Q]);const de=b?te=>{const[ve,_e]=Z.current?.pointer(te)||[0,0];b(te,{x:ve,y:_e})}:void 0,ge=x?j.useCallback((te,ve)=>{const _e=O.getState().nodeLookup.get(ve).internals.userNode;x(te,_e)},[]):void 0,be=A??B["minimap.ariaLabel"];return _.jsx(ff,{position:v,style:{...t,"--xy-minimap-background-color-props":typeof h=="string"?h:void 0,"--xy-minimap-mask-background-color-props":typeof f=="string"?f:void 0,"--xy-minimap-mask-stroke-color-props":typeof g=="string"?g:void 0,"--xy-minimap-mask-stroke-width-props":typeof p=="number"?p*P:void 0,"--xy-minimap-node-background-color-props":typeof s=="string"?s:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof c=="number"?c:void 0},className:Ct(["react-flow__minimap",e]),"data-testid":"rf__minimap",children:_.jsxs("svg",{width:G,height:k,viewBox:`${J} ${ee} ${he} ${pe}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":ae,ref:R,onClick:de,children:[be&&_.jsx("title",{id:ae,children:be}),_.jsx(HL,{onClick:ge,nodeColor:s,nodeStrokeColor:n,nodeBorderRadius:l,nodeClassName:a,nodeStrokeWidth:c,nodeComponent:d}),_.jsx("path",{className:"react-flow__minimap-mask",d:`M${J-z},${ee-z}h${he+z*2}v${pe+z*2}h${-he-z*2}z
        M${I.x},${I.y}h${I.width}v${I.height}h${-I.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}nC.displayName="MiniMap";j.memo(nC);const KL=t=>e=>t?`${Math.max(1/e.transform[2],1)}`:void 0,QL={[Ya.Line]:"right",[Ya.Handle]:"bottom-right"};function WL({nodeId:t,position:e,variant:n=Ya.Handle,className:s,style:a=void 0,children:l,color:c,minWidth:d=10,minHeight:h=10,maxWidth:f=Number.MAX_VALUE,maxHeight:g=Number.MAX_VALUE,keepAspectRatio:p=!1,resizeDirection:v,autoScale:b=!0,shouldResize:x,onResizeStart:w,onResize:S,onResizeEnd:A}){const N=Kg(),E=typeof t=="string"?t:N,C=ct(),O=j.useRef(null),R=n===Ya.Handle,M=Ge(j.useCallback(KL(R&&b),[R,b]),ft),I=j.useRef(null),q=e??QL[n];j.useEffect(()=>{if(!(!O.current||!E))return I.current||(I.current=S$({domNode:O.current,nodeId:E,getStoreItems:()=>{const{nodeLookup:Y,transform:$,snapGrid:Q,snapToGrid:B,nodeOrigin:G,domNode:k}=C.getState();return{nodeLookup:Y,transform:$,snapGrid:Q,snapToGrid:B,nodeOrigin:G,paneDomNode:k}},onChange:(Y,$)=>{const{triggerNodeChanges:Q,nodeLookup:B,parentLookup:G,nodeOrigin:k}=C.getState(),L=[],V={x:Y.x,y:Y.y},P=B.get(E);if(P&&P.expandParent&&P.parentId){const H=P.origin??k,D=Y.width??P.measured.width??0,z=Y.height??P.measured.height??0,J={id:P.id,parentId:P.parentId,rect:{width:D,height:z,...r1({x:Y.x??P.position.x,y:Y.y??P.position.y},{width:D,height:z},P.parentId,B,H)}},ee=Gg([J],B,G,k);L.push(...ee),V.x=Y.x?Math.max(H[0]*D,Y.x):void 0,V.y=Y.y?Math.max(H[1]*z,Y.y):void 0}if(V.x!==void 0&&V.y!==void 0){const H={id:E,type:"position",position:{...V}};L.push(H)}if(Y.width!==void 0&&Y.height!==void 0){const D={id:E,type:"dimensions",resizing:!0,setAttributes:v?v==="horizontal"?"width":"height":!0,dimensions:{width:Y.width,height:Y.height}};L.push(D)}for(const H of $){const D={...H,type:"position"};L.push(D)}Q(L)},onEnd:({width:Y,height:$})=>{const Q={id:E,type:"dimensions",resizing:!1,dimensions:{width:Y,height:$}};C.getState().triggerNodeChanges([Q])}})),I.current.update({controlPosition:q,boundaries:{minWidth:d,minHeight:h,maxWidth:f,maxHeight:g},keepAspectRatio:p,resizeDirection:v,onResizeStart:w,onResize:S,onResizeEnd:A,shouldResize:x}),()=>{I.current?.destroy()}},[q,d,h,f,g,p,w,S,A,x]);const K=q.split("-");return _.jsx("div",{className:Ct(["react-flow__resize-control","nodrag",...K,n,s]),ref:O,style:{...a,scale:M,...c&&{[R?"backgroundColor":"borderColor"]:c}},children:l})}j.memo(WL);const rC=t=>_.jsx(Kt,{...t,type:"target",position:Ce.Left,id:"exec-in",acceptHandle:"exec-out",style:{...t.style,width:8,height:8,borderRadius:"2px",backgroundColor:"#ff0072"}}),sC=t=>_.jsx(Kt,{...t,type:"source",position:Ce.Right,id:"exec-out",acceptHandle:"exec-in",acceptConnection:({connection:e})=>e.targetHandle==="exec-in",style:{width:8,height:8,borderRadius:"2px",backgroundColor:"#ff0072"}}),JL=({data:t})=>{const{updateNodeData:e}=Wa(),{shot:n={}}=t,{description:s="",prompt:a="",embodys:l=[]}=n;j.useEffect(()=>{},[]);const c=d=>[];return _.jsxs("div",{className:"common-node-area",children:[_.jsx("h4",{className:"shot-node-input-title common-node-title",children:""}),_.jsx("div",{className:"shot-node-input-handle",children:_.jsx(sC,{id:"exec-out"})}),_.jsxs("div",{className:"shot-node-input-handle",children:[_.jsx(Kt,{type:"source",position:Ce.Right,id:"description"}),_.jsx("span",{className:"handle-label",children:""})]}),_.jsxs("div",{className:"shot-node-input-handle",children:[_.jsx(Kt,{type:"source",position:Ce.Right,id:"prompt"}),_.jsx("span",{className:"handle-label",children:""})]}),l.map((d,h)=>{const f=c();return _.jsxs("div",{className:"shot-node-input-handle",children:[_.jsx(Kt,{type:"source",position:Ce.Right,id:`embody-${d}`}),_.jsx("span",{className:"handle-label",children:f.name})]},`embody-${d}`)})]})},ZL=t=>(Z1({handleType:t.type}),_.jsx(Kt,{...t}));function ez({data:t}){return _.jsxs("div",{className:"common-node-area",children:[_.jsx("h4",{className:"common-node-title console-node-title",children:""}),_.jsxs("div",{className:"common-exec-handle-area",children:[_.jsx(rC,{id:"exec-in"}),_.jsx(sC,{id:"exec-out"})]}),_.jsxs("div",{className:"shot-node-input-handle",children:[_.jsx(ZL,{type:"target",position:Ce.Left,id:"input"}),_.jsx("span",{className:"handle-label",children:""})]})]})}const tz=({data:t})=>{const{output:e={}}=t;return _.jsxs("div",{className:"common-node-area",children:[_.jsx("h4",{className:"shot-node-output-title common-node-title",children:""}),_.jsx("div",{className:"shot-node-output-handle",children:_.jsx(rC,{id:"exec-in"})}),_.jsxs("div",{className:"shot-node-output-handle",children:[_.jsx(Kt,{type:"target",position:Ce.Left,id:"image"}),_.jsx("span",{className:"handle-label",children:""})]}),_.jsxs("div",{className:"shot-node-output-handle",children:[_.jsx(Kt,{type:"target",position:Ce.Left,id:"video"}),_.jsx("span",{className:"handle-label",children:""})]}),_.jsxs("div",{className:"shot-node-output-handle",children:[_.jsx(Kt,{type:"target",position:Ce.Left,id:"audio"}),_.jsx("span",{className:"handle-label",children:""})]})]})};function nz({id:t,data:e,selected:n}){const[s,a]=j.useState(null),[l,c]=j.useState(!1),[d,h]=j.useState(!1),[f,g]=j.useState([]),[p,v]=j.useState([]),[b,x]=j.useState({}),[w,S]=j.useState(""),[A,N]=j.useState("16:9"),[E,C]=j.useState(1),[O,R]=j.useState("fal-ai/nano-banana/edit"),[M,I]=j.useState(0),[q,K]=j.useState(0),Y=Wa(),$=()=>{switch(A){case"16:9":return{paddingBottom:"56.25%",width:"100%",position:"relative",height:0,overflow:"hidden"};case"9:16":return{paddingBottom:"177.78%",width:"100%",position:"relative",height:0,overflow:"hidden"};case"4:3":return{paddingBottom:"75%",width:"100%",position:"relative",height:0,overflow:"hidden"};default:return{paddingBottom:"56.25%",width:"100%",position:"relative",height:0,overflow:"hidden"}}},Q=()=>({position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"contain"}),B=Z1({handleType:"target",handleId:"ref_images"}),G=B.map(P=>P.source),k=EL(G),L=()=>k?(Array.isArray(k)?k:[k]).flatMap(D=>D&&D.data&&Array.isArray(D.data.outputImages)?D.data.outputImages:[]):[];j.useEffect(()=>{console.log("sourceNodesData:",k),console.log("getAggregatedRefImages:",L()),v(L())},[k]),j.useEffect(()=>{I(f.length),f.length>0&&a(f[q].url)},[f,q]),j.useEffect(()=>{S(e.prompt),N(e.aspect_ratio),C(e.num_images),R(e.model),g(e.images||[]),console.log("embodyConnections:",B)},[]);const V=async()=>{let P={};console.log("referenceImages:",p),O==="fal-ai/nano-banana/edit"&&(P={prompt:w,num_images:Number(E),aspect_ratio:A,output_format:"png",image_urls:p.map(H=>H!=null?H.url:"")}),O==="fal-ai/nano-banana-pro/edit"&&(P={prompt:e.prompt}),O==="fal-ai/bytedance/seedream/v4/edit"&&(P={prompt:e.prompt}),console.log(P);try{uw.fal.config({credentials:"d0f5c4fd-29b2-4024-bc64-a4719276c027:5b06c17b429cc06d2f5e044e95ca5164"});const H=await uw.fal.subscribe("fal-ai/nano-banana/edit",{input:P,logs:!0,onQueueUpdate:D=>{D.status==="IN_PROGRESS"&&c(!0),D.status==="SUCCEEDED"&&c(!1)},onResult:D=>{console.log(D)},onError:D=>{console.error("Error:",D),c(!1)}});a(null),console.log(H.data),g(H.data.images),Y&&Y.setNodes(D=>D.map(z=>z.id===t?{...z,data:{...z.data,images:H.data.images}}:z)),K(0),c(!1)}catch(H){console.error("Error:",H),c(!1)}};return _.jsxs("div",{className:"txt-image-node-area",children:[_.jsxs("div",{className:"txt2img-handles-container",children:[_.jsx(Kt,{type:"target",position:Ce.Left,id:"ref_images"}),_.jsx(Kt,{type:"source",position:Ce.Right,id:"image"})]}),_.jsxs("div",{className:"txt2img-preview-container",children:[_.jsxs("div",{className:"txt2img-preview-header",children:[_.jsxs("div",{className:"txt2img-preview-title",children:["Image-",q]}),_.jsx("div",{className:"txt2img-preview-controls",children:_.jsx("span",{className:"",children:O})})]}),_.jsxs("div",{className:"txt2img-preview-image",children:[_.jsx("div",{className:"txt2img-placeholder-image",style:$(),children:s?_.jsxs(_.Fragment,{children:[_.jsx("img",{src:s,alt:"Generated",style:Q()}),_.jsx("button",{className:"embody-view-large-btn",onClick:()=>{console.log("currentImageUrl",s),Xt.emit("showLargeImageModal",s)},style:{position:"absolute",top:"8px",right:"8px",zIndex:10},children:""})]}):_.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",padding:"20px"},className:"txt2img-placeholder-text",children:""})}),f.length>1&&_.jsxs("div",{className:"txt2img-pagination",children:[_.jsx("button",{className:"txt2img-pagination-btn",onClick:()=>K(P=>Math.max(P-1,0)),children:""}),_.jsxs("span",{className:"txt2img-pagination-text",children:[q+1," / ",M]}),_.jsx("button",{className:"txt2img-pagination-btn",onClick:()=>K(P=>Math.min(P+1,M-1)),children:""})]}),l&&_.jsxs("div",{className:"txt2img-loading-overlay",children:[_.jsx("div",{className:"txt2img-loading-spinner"}),_.jsx("span",{className:"txt2img-loading-text",children:"..."})]})]})]}),n&&_.jsxs(_.Fragment,{children:[_.jsx("div",{className:"txt2img-prompt-container",children:_.jsx("textarea",{className:"txt2img-prompt-textarea",value:w,onChange:P=>{const H=P.target.value;S(H),Y&&Y.setNodes(D=>D.map(z=>z.id===t?{...z,data:{...z.data,prompt:H}}:z))},placeholder:"..."})}),_.jsxs("div",{className:"txt2img-reference-container",children:[_.jsxs("div",{className:"txt2img-reference-title",children:[" (",p.length,"/10)"]}),_.jsx("div",{className:"txt2img-reference-grid",children:p&&p.map((P,H)=>_.jsx("div",{className:"txt2img-reference-item",children:_.jsx("img",{src:P.url||"",alt:`Reference ${H+1}`})},H))})]}),_.jsxs("div",{className:"txt2img-bottom-controls",children:[_.jsxs("div",{className:"txt2img-controls-left",children:[_.jsx("div",{className:"txt2img-control-group",children:_.jsxs("select",{value:O,onChange:P=>{const H=P.target.value;R(H),Y&&Y.setNodes(D=>D.map(z=>z.id===t?{...z,data:{...z.data,model:H}}:z))},className:"txt2img-control-select",children:[_.jsx("option",{value:"fal-ai/nano-banana/edit",children:"Nano Banana"}),_.jsx("option",{value:"fal-ai/nano-banana-pro/edit",children:"Nano Banana Pro"}),_.jsx("option",{value:"fal-ai/bytedance/seedream/v4/edit",children:"v4"})]})}),_.jsx("div",{className:"txt2img-control-group",children:_.jsxs("select",{value:A,onChange:P=>{const H=P.target.value;N(H),Y&&Y.setNodes(D=>D.map(z=>z.id===t?{...z,data:{...z.data,aspect_ratio:H}}:z))},className:"txt2img-control-select",children:[_.jsx("option",{value:"16:9",children:"16:9 "}),_.jsx("option",{value:"9:16",children:"9:16 "}),_.jsx("option",{value:"4:3",children:"4:3 "})]})}),_.jsx("div",{className:"txt2img-control-group",children:_.jsxs("select",{value:E,onChange:P=>{const H=P.target.value;C(H),Y&&Y.setNodes(D=>D.map(z=>z.id===t?{...z,data:{...z.data,num_images:parseInt(H)}}:z))},className:"txt2img-control-select",children:[_.jsx("option",{value:"1",children:"1"}),_.jsx("option",{value:"2",children:"2"}),_.jsx("option",{value:"3",children:"3"}),_.jsx("option",{value:"4",children:"4"})]})})]}),_.jsxs("div",{className:"txt2img-controls-right",children:[_.jsx("button",{className:"txt2img-control-button",children:""}),_.jsx("button",{disabled:l,onClick:V,className:"txt2img-generate-button",children:""})]})]})]})]})}function rz({id:t,data:e,selected:n}){const{updateNodeData:s}=Wa(),[a,l]=j.useState(null),[c,d]=j.useState(!1),[h,f]=j.useState({}),[g,p]=j.useState(""),[v,b]=j.useState(""),[x,w]=j.useState([]),[S,A]=j.useState([0]),[N,E]=j.useState([]),[C,O]=j.useState(""),[R,M]=j.useState(""),I={character:"",scene:"",item:""},K={...{characterName:"",characterDescription:"",imageUrl:"/default_avatar.png"},...e};j.useEffect(()=>{O(K.characterName),M(K.characterDescription)},[K]),j.useEffect(()=>{console.log("EmbodyNode ID:",e.id),Me.from("embodys").select(`
          *,
          embody_images(
            path
          )
        `).eq("id",e.id).single().then(k=>{f(k.data),p(k.data.name),b(I[k.data.type]||"");const L=k.data.embody_images.map(V=>({path:V.path,url:ka+V.path}));if(L.length==0&&L.push({path:"/public/Common/default_charactar_big.png",url:"https://gsyznlwsezhwerypyzbe.supabase.co/storage/v1/object/public/embodys/public/Common/default_charactar_big.png"}),console.log(":",L),w(L),A([0]),l(L[0].url),k.data.embody_images&&k.data.embody_images.length>0){let V=ka+k.data.embody_images[0].path;console.log(":",V)}})},[t]),j.useEffect(()=>{x.length>0&&s(t,{outputImages:S.map(k=>x[k])})},[S]);const Y=()=>{console.log("")},$=k=>{A(L=>L.includes(k)?L.filter(V=>V!==k):[...L,k]),console.log(":",S)},[Q,B]=j.useState(1),G=k=>{if(k>=1&&k<=S.length&&(B(k),S.length>0)){let L=ka+x[S[k-1]].path;l(L)}};return _.jsxs("div",{className:"embody-node-area",children:[_.jsx("div",{className:"embody-handles-container",children:_.jsx(Kt,{type:"source",position:Ce.Right,id:"embody_out"})}),_.jsxs("div",{className:"embody-preview-container",children:[_.jsxs("div",{className:"embody-preview-header",children:[_.jsx("div",{className:"embody-preview-title",children:g||""}),_.jsx("span",{children:v||""}),_.jsx("div",{className:"embody-preview-controls",children:n&&_.jsx("button",{className:"embody-control-btn",onClick:Y,children:""})})]}),_.jsxs("div",{className:"embody-preview-image",children:[_.jsx("div",{className:"embody-placeholder-image",children:a?_.jsxs(_.Fragment,{children:[_.jsx("img",{src:a,alt:"Character Preview"}),_.jsx("button",{className:"embody-view-large-btn",onClick:()=>{console.log("currentImageUrl",a),Xt.emit("showLargeImageModal",a)},children:""})]}):_.jsx("div",{className:"embody-placeholder-text",children:""})}),c&&_.jsxs("div",{className:"embody-loading-overlay",children:[_.jsx("div",{className:"embody-loading-spinner"}),_.jsx("span",{className:"embody-loading-text",children:"..."})]}),S.length>1&&_.jsxs("div",{className:"embody-pagination",children:[_.jsx("button",{className:"embody-pagination-btn",onClick:()=>G(Q-1),disabled:Q===1,children:""}),_.jsxs("span",{className:"embody-pagination-text",children:[Q," / ",S.length]}),_.jsx("button",{className:"embody-pagination-btn",onClick:()=>G(Q+1),disabled:Q===S.length,children:""})]})]})]}),n&&_.jsx(_.Fragment,{children:_.jsx("div",{className:"embody-info-container",children:_.jsxs("div",{className:"embody-info-item",children:[_.jsx("label",{className:"embody-info-label",children:""}),_.jsx("div",{className:"embody-info-images",children:x.map((k,L)=>_.jsxs("div",{className:`embody-info-image-item ${S.includes(L)?"selected":""}`,onClick:()=>$(L),children:[_.jsx("img",{src:ka+k.path,alt:`${L}`}),S.includes(L)&&_.jsx("div",{className:"embody-image-checkmark",children:""})]},L))})]})})})]})}const sz=({id:t,source:e,target:n,sourceX:s,sourceY:a,targetX:l,targetY:c,sourcePosition:d,targetPosition:h,selected:f,data:g})=>{const[p,v]=j.useMemo(()=>{const C=Hg({sourceX:s,sourceY:a,targetX:l,targetY:c,sourcePosition:d,targetPosition:h}),O=document.createElementNS("http://www.w3.org/2000/svg","path");O.setAttribute("d",C[0]),document.body.appendChild(O);const R=O.getTotalLength();return document.body.removeChild(O),[C[0],R]},[s,a,l,c,d,h]),[b,x]=j.useState(`${t}-animate`),[w,S]=j.useState(!0),A=Math.max(3,Math.min(8,v/5));j.useEffect(()=>{x(`${t}-animate-${Date.now()}`)},[t]);const N={stroke:f?"#ff4088":"#ff0072",strokeWidth:f?3:2,fill:"none",cursor:"pointer",transition:"stroke 0.2s, stroke-width 0.2s"},E={stroke:"white",strokeWidth:"3",fill:"none",strokeDasharray:"12, 8",strokeLinecap:"round",pointerEvents:"none"};return _.jsxs(_.Fragment,{children:[_.jsx("path",{id:t,d:p,className:`exec-edge ${f?"selected":""}`,style:N,onMouseEnter:C=>{C.currentTarget.style.stroke="#ff4088",C.currentTarget.style.strokeWidth="3"},onMouseLeave:C=>{C.currentTarget.style.stroke=f?"#ff4088":"#ff0072",C.currentTarget.style.strokeWidth=f?"3":"2"}}),w&&_.jsx("path",{id:b,d:p,className:"exec-edge-flow",style:{...E,animation:w?`flowAnimation ${A}s linear infinite`:"none",visibility:v>0?"visible":"hidden"}}),_.jsxs("defs",{children:[_.jsx("marker",{id:"exec-arrow",markerWidth:"10",markerHeight:"10",refX:"9",refY:"3",orient:"auto",markerUnits:"strokeWidth",children:_.jsx("path",{d:"M0,0 L0,6 L9,3 z",fill:"#ff0072"})}),_.jsx("style",{type:"text/css",children:`
            @keyframes flowAnimation {
              0% {
                stroke-dashoffset: 200; /*  */
              }
              100% {
                stroke-dashoffset: 0;
              }
            }
            
            .exec-edge-flow {
              /*  */
              filter: drop-shadow(0 0 2px rgba(255, 255, 255, 0.7));
              /*  */
              will-change: stroke-dashoffset;
            }
            
            /*  */
            .exec-edge.selected + .exec-edge-flow {
              stroke-width: 4; /*  */
              filter: drop-shadow(0 0 4px rgba(255, 255, 255, 0.9));
              animation-duration: 3s; /*  */
            }
          `})]})]})},iz=({position:t,visible:e,onClose:n,onAddConsoleNode:s,onAddShotNodeInput:a,onAddShotNodeOutput:l,onAddTxt2ImgNode:c,onAddEmbodyNode:d})=>{const h=j.useRef(null);return j.useEffect(()=>{const f=p=>{h.current&&!h.current.contains(p.target)&&n()},g=p=>{p.key==="Escape"&&n()};return e&&(document.addEventListener("mousedown",f),document.addEventListener("keydown",g)),()=>{document.removeEventListener("mousedown",f),document.removeEventListener("keydown",g)}},[e,n]),e?_.jsx("div",{ref:h,className:"context-menu",style:{position:"fixed",left:`${t.x}px`,top:`${t.y}px`,zIndex:1e3},children:_.jsxs("ul",{children:[_.jsx("li",{onClick:s,children:""}),_.jsx("li",{onClick:a,children:""}),_.jsx("li",{onClick:l,children:""}),_.jsx("li",{onClick:c,children:""}),_.jsx("li",{onClick:d,children:""})]})}):null};function az(){const{projectId:t,ep_id:e,editShotId:n,setEditShotId:s}=Xr(),[a,l]=j.useState(!1),[c,d]=j.useState(!1),[h,f]=j.useState([]),[g,p]=j.useState({}),[v,b]=j.useState(null),[x,w]=j.useState([]),[S,A]=j.useState(null),[N,E]=j.useState(!1),[C,O]=j.useState({x:0,y:0}),[R,M]=j.useState(null);j.useEffect(()=>{n||console.log(""),I()},[n]);const I=async()=>{const{data:Z,error:de}=await Me.from("movie_scs").select(`
          *,
          movie_seqs(
            *,
            movie_shots(
              *,
              flows(
                *
              )
            )
          ).order('index', { ascending: true })
        `).order("index",{ascending:!0}).eq("ep_id",e);if(de){console.error(":",de);return}console.log(":",Z),Z.forEach(ge=>{ge.movie_seqs.forEach(be=>{be.movie_shots.forEach(te=>{g[te.id]=te})})}),f(Z),b(n)},q=Z=>{b(Z.id)},K=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(Z){var de=Math.random()*16|0,ge=Z==="x"?de:de&3|8;return ge.toString(16)}),Y=Z=>{console.log("setupInitNodes:",Z);const de=K();let ge=[],be=[];ge.push({id:de,type:"txt2imgNode",position:{x:900,y:100},data:{prompt:Z.prompt,num_images:1,aspect_ratio:"16:9",model:"fal-ai/nano-banana/edit",images:[]},selected:S==="0",style:{border:S==="0"?"2px solid #3b82f6":"none"}});for(let te=0;te<Z.embodys.length;te++){const ve=Z.embodys[te],_e=`ImageNode_${Z.embodys[te]}`;console.log(" embody _id:",ve),ge.push({id:_e,type:"embodyNode",position:{x:100,y:500*te},data:{id:ve,selected:S===_e},selected:S===_e,style:{border:S===_e?"2px solid #3b82f6":"none"}}),be.push({id:K(),source:_e,sourceHandle:"embody_out",target:de,targetHandle:"ref_images",type:"default",data:{}})}w(ge),Q(be)};j.useEffect(()=>{console.log("selectedShotId:",v),v&&(console.log(g[v]),Me.from("movie_shots").select(`
      *,
      flows(
        *
      )
    `).eq("id",v).single().then(Z=>{console.log("shot:",Z.data),g[v]=Z.data,Z.data.flows||d(Z.data.flows.length>0),Z.data.flows.length>0?(w(JSON.parse(Z.data.flows[0].nodes)),Q(JSON.parse(Z.data.flows[0].edges))):Y(Z.data)}))},[v]),j.useEffect(()=>{},[x]);const[$,Q]=j.useState([]),B={shotNodeInput:JL,consoleNode:ez,shotNodeOutput:tz,txt2imgNode:nz,embodyNode:rz},G={execEdge:sz},k=Z=>{l(!0),Q(de=>{if(Z.target==="2"&&de.some(te=>te.target==="2"))return console.warn("ConsoleNode"),de;const ge={...Z,type:Z.sourceHandle==="exec-out"&&Z.targetHandle==="exec-in"?"execEdge":"default"};return c1(ge,de)})},L=()=>{const Z=R.toObject();console.log("flowState:",Z)};j.useEffect(()=>{const Z=setInterval(()=>{L()},1e3);return()=>clearInterval(Z)},[x,$,a]),j.useEffect(()=>{const Z=de=>{if(de.key==="Delete"){const ge=x.filter(be=>be.selected);if(ge.length>0){const be=x.filter(_e=>!_e.selected);w(be),l(!0);const te=ge.map(_e=>_e.id),ve=$.filter(_e=>!te.includes(_e.source)&&!te.includes(_e.target));Q(ve)}}};return window.addEventListener("keydown",Z),()=>window.removeEventListener("keydown",Z)},[x,$]);const V=(Z,de)=>{Z.stopPropagation();const ge=de.id;A(ge),w(be=>be.map(te=>({...te,selected:te.id===ge,style:{...te.style,border:te.id===ge?"2px solid #3b82f6":"none"}}))),console.log(":",ge)},P=(Z,de)=>{Z.preventDefault(),de||(O({x:Z.clientX,y:Z.clientY}),E(!0))},H=()=>{E(!1)},D=()=>(x.reduce((de,ge)=>{const be=parseInt(ge.id);return isNaN(be)?de:Math.max(de,be)},0)+1).toString(),z=()=>{if(R){const Z=R.screenToFlowPosition(C),de={id:D(),type:"consoleNode",position:{x:Z.x-75,y:Z.y-30},data:{},selected:!1,style:{border:"none"}};w(ge=>[...ge,de]),console.log(":",de.id)}H()},J=()=>{if(R){const Z=R.screenToFlowPosition(C),de={id:D(),type:"shotNodeInput",position:{x:Z.x-100,y:Z.y-50},data:{shot:v?g[v]:{description:"",prompt:"",embodys:[]}},selected:!1,style:{border:"none"}};w(ge=>[...ge,de]),console.log(":",de.id)}H()},ee=()=>{if(R){const Z=R.screenToFlowPosition(C),de={id:D(),type:"shotNodeOutput",position:{x:Z.x-100,y:Z.y-50},data:{output:{}},selected:!1,style:{border:"none"}};w(ge=>[...ge,de]),console.log(":",de.id)}H()},he=()=>{if(R){const Z=R.screenToFlowPosition(C),de={id:D(),type:"txt2imgNode",position:{x:Z.x-40,y:Z.y-50},data:{prompt:"",imageUrl:null},selected:!1,style:{border:"none"}};w(ge=>[...ge,de]),console.log(":",de.id)}H()},pe=()=>{if(R){const Z=R.screenToFlowPosition(C),de={id:D(),type:"embodyNode",position:{x:Z.x-40,y:Z.y-50},data:{characterName:"",characterDescription:"",imageUrl:null},selected:!1,style:{border:"none"}};w(ge=>[...ge,de]),console.log(":",de.id)}H()},ae=j.useCallback(Z=>{Q(de=>O1(Z,de)),l(!0)},[]),le=j.useCallback(Z=>{w(de=>N1(Z,de)),l(!0)},[]);return _.jsxs("div",{className:"editor-flow-container",children:[_.jsx("div",{className:"story-nav",children:_.jsx("div",{className:"flow-nav-info",children:h.map(Z=>_.jsxs("div",{className:"flow-nav-sc-card",children:[_.jsx("div",{className:"flow-nav-sc-name",children:_.jsx("p",{children:Z.name})}),_.jsx("div",{className:"flow-nav-sc-content",children:Z.movie_seqs.map(de=>_.jsxs("div",{className:"flow-nav-seq-card",children:[_.jsx("div",{className:"flow-nav-seq-name",children:_.jsx("p",{children:de.name})}),_.jsx("div",{className:"flow-nav-seq-content",children:de.movie_shots.map(ge=>_.jsx("div",{className:`flow-nav-shot-card ${v===ge.id?"nav-selected-shot":""}`,onClick:()=>q(ge),children:_.jsx("div",{className:"flow-nav-shot-thumb",children:_.jsx("img",{src:ge.pic?ge.pic:"./shot_thumb_default.png"})})},ge.id))})]},de.id))})]},Z.id))})}),_.jsxs("div",{className:"flow-editor",children:[_.jsxs(xL,{nodes:x,edges:$,nodeTypes:B,edgeTypes:G,onConnect:k,onEdgesChange:ae,onNodesChange:le,onNodeClick:V,defaultViewport:{x:0,y:0,zoom:.6},onPaneClick:()=>{A(null),H(),w(Z=>Z.map(de=>({...de,selected:!1,style:{...de.style,border:"none"}})))},onContextMenu:P,onInit:M,attributionPosition:"bottom-right",children:[_.jsx($L,{}),_.jsx(OL,{variant:"dots",gap:20,size:1,strokeColor:"#333"})]}),_.jsx(iz,{position:C,visible:N,onClose:H,onAddConsoleNode:z,onAddShotNodeInput:J,onAddShotNodeOutput:ee,onAddTxt2ImgNode:he,onAddEmbodyNode:pe})]})]})}function $e(t,e,n,s,a){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}function se(t,e,n,s){if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?s:n==="a"?s.call(t):s?s.value:e.get(t)}let iC=function(){const{crypto:t}=globalThis;if(t?.randomUUID)return iC=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,s=>(+s^n()&15>>+s/4).toString(16))};function eg(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const tg=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};class je extends Error{}class qt extends je{constructor(e,n,s,a){super(`${qt.makeMessage(e,n,s)}`),this.status=e,this.headers=a,this.requestID=a?.get("x-request-id"),this.error=n;const l=n;this.code=l?.code,this.param=l?.param,this.type=l?.type}static makeMessage(e,n,s){const a=n?.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):s;return e&&a?`${e} ${a}`:e?`${e} status code (no body)`:a||"(no status code or body)"}static generate(e,n,s,a){if(!e||!a)return new pf({message:s,cause:tg(n)});const l=n?.error;return e===400?new aC(e,l,s,a):e===401?new oC(e,l,s,a):e===403?new lC(e,l,s,a):e===404?new cC(e,l,s,a):e===409?new uC(e,l,s,a):e===422?new dC(e,l,s,a):e===429?new fC(e,l,s,a):e>=500?new hC(e,l,s,a):new qt(e,l,s,a)}}class $n extends qt{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class pf extends qt{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class Qg extends pf{constructor({message:e}={}){super({message:e??"Request timed out."})}}class aC extends qt{}class oC extends qt{}class lC extends qt{}class cC extends qt{}class uC extends qt{}class dC extends qt{}class fC extends qt{}class hC extends qt{}class mC extends je{constructor(){super("Could not parse response content as the length limit was reached")}}class pC extends je{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class hl extends Error{constructor(e){super(e)}}const oz=/^[a-z][a-z0-9+.-]*:/i,lz=t=>oz.test(t);let ln=t=>(ln=Array.isArray,ln(t)),vx=ln;function gC(t){return typeof t!="object"?{}:t??{}}function cz(t){if(!t)return!0;for(const e in t)return!1;return!0}function uz(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function pp(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}const dz=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new je(`${t} must be an integer`);if(e<0)throw new je(`${t} must be a positive integer`);return e},fz=t=>{try{return JSON.parse(t)}catch{return}},ic=t=>new Promise(e=>setTimeout(e,t)),Oa="6.9.1",hz=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function mz(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const pz=()=>{const t=mz();if(t==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oa,"X-Stainless-OS":_x(Deno.build.os),"X-Stainless-Arch":bx(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oa,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(t==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oa,"X-Stainless-OS":_x(globalThis.process.platform??"unknown"),"X-Stainless-Arch":bx(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const e=gz();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oa,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oa,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function gz(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const s=n.exec(navigator.userAgent);if(s){const a=s[1]||0,l=s[2]||0,c=s[3]||0;return{browser:e,version:`${a}.${l}.${c}`}}}return null}const bx=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",_x=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let wx;const yz=()=>wx??(wx=pz());function vz(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function yC(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function vC(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return yC({start(){},async pull(n){const{done:s,value:a}=await e.next();s?n.close():n.enqueue(a)},async cancel(){await e.return?.()}})}function bC(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n?.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function bz(t){if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await t[Symbol.asyncIterator]().return?.();return}const e=t.getReader(),n=e.cancel();e.releaseLock(),await n}const _z=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)}),_C="RFC3986",wC=t=>String(t),xx={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:wC},wz="RFC1738";let ng=(t,e)=>(ng=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),ng(t,e));const or=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),gp=1024,xz=(t,e,n,s,a)=>{if(t.length===0)return t;let l=t;if(typeof t=="symbol"?l=Symbol.prototype.toString.call(t):typeof t!="string"&&(l=String(t)),n==="iso-8859-1")return escape(l).replace(/%u[0-9a-f]{4}/gi,function(d){return"%26%23"+parseInt(d.slice(2),16)+"%3B"});let c="";for(let d=0;d<l.length;d+=gp){const h=l.length>=gp?l.slice(d,d+gp):l,f=[];for(let g=0;g<h.length;++g){let p=h.charCodeAt(g);if(p===45||p===46||p===95||p===126||p>=48&&p<=57||p>=65&&p<=90||p>=97&&p<=122||a===wz&&(p===40||p===41)){f[f.length]=h.charAt(g);continue}if(p<128){f[f.length]=or[p];continue}if(p<2048){f[f.length]=or[192|p>>6]+or[128|p&63];continue}if(p<55296||p>=57344){f[f.length]=or[224|p>>12]+or[128|p>>6&63]+or[128|p&63];continue}g+=1,p=65536+((p&1023)<<10|h.charCodeAt(g)&1023),f[f.length]=or[240|p>>18]+or[128|p>>12&63]+or[128|p>>6&63]+or[128|p&63]}c+=f.join("")}return c};function Sz(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function Sx(t,e){if(ln(t)){const n=[];for(let s=0;s<t.length;s+=1)n.push(e(t[s]));return n}return e(t)}const xC={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},SC=function(t,e){Array.prototype.push.apply(t,ln(e)?e:[e])};let Ex;const jt={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:xz,encodeValuesOnly:!1,format:_C,formatter:wC,indices:!1,serializeDate(t){return(Ex??(Ex=Function.prototype.call.bind(Date.prototype.toISOString)))(t)},skipNulls:!1,strictNullHandling:!1};function Ez(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const yp={};function EC(t,e,n,s,a,l,c,d,h,f,g,p,v,b,x,w,S,A){let N=t,E=A,C=0,O=!1;for(;(E=E.get(yp))!==void 0&&!O;){const K=E.get(t);if(C+=1,typeof K<"u"){if(K===C)throw new RangeError("Cyclic object value");O=!0}typeof E.get(yp)>"u"&&(C=0)}if(typeof f=="function"?N=f(e,N):N instanceof Date?N=v?.(N):n==="comma"&&ln(N)&&(N=Sx(N,function(K){return K instanceof Date?v?.(K):K})),N===null){if(l)return h&&!w?h(e,jt.encoder,S,"key",b):e;N=""}if(Ez(N)||Sz(N)){if(h){const K=w?e:h(e,jt.encoder,S,"key",b);return[x?.(K)+"="+x?.(h(N,jt.encoder,S,"value",b))]}return[x?.(e)+"="+x?.(String(N))]}const R=[];if(typeof N>"u")return R;let M;if(n==="comma"&&ln(N))w&&h&&(N=Sx(N,h)),M=[{value:N.length>0?N.join(",")||null:void 0}];else if(ln(f))M=f;else{const K=Object.keys(N);M=g?K.sort(g):K}const I=d?String(e).replace(/\./g,"%2E"):String(e),q=s&&ln(N)&&N.length===1?I+"[]":I;if(a&&ln(N)&&N.length===0)return q+"[]";for(let K=0;K<M.length;++K){const Y=M[K],$=typeof Y=="object"&&typeof Y.value<"u"?Y.value:N[Y];if(c&&$===null)continue;const Q=p&&d?Y.replace(/\./g,"%2E"):Y,B=ln(N)?typeof n=="function"?n(q,Q):q:q+(p?"."+Q:"["+Q+"]");A.set(t,C);const G=new WeakMap;G.set(yp,A),SC(R,EC($,B,n,s,a,l,c,d,n==="comma"&&w&&ln(N)?null:h,f,g,p,v,b,x,w,S,G))}return R}function Cz(t=jt){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||jt.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=_C;if(typeof t.format<"u"){if(!ng(xx,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const s=xx[n];let a=jt.filter;(typeof t.filter=="function"||ln(t.filter))&&(a=t.filter);let l;if(t.arrayFormat&&t.arrayFormat in xC?l=t.arrayFormat:"indices"in t?l=t.indices?"indices":"repeat":l=jt.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const c=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:jt.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:jt.addQueryPrefix,allowDots:c,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:jt.allowEmptyArrays,arrayFormat:l,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:jt.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?jt.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:jt.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:jt.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:jt.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:jt.encodeValuesOnly,filter:a,format:n,formatter:s,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:jt.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:jt.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:jt.strictNullHandling}}function Az(t,e={}){let n=t;const s=Cz(e);let a,l;typeof s.filter=="function"?(l=s.filter,n=l("",n)):ln(s.filter)&&(l=s.filter,a=l);const c=[];if(typeof n!="object"||n===null)return"";const d=xC[s.arrayFormat],h=d==="comma"&&s.commaRoundTrip;a||(a=Object.keys(n)),s.sort&&a.sort(s.sort);const f=new WeakMap;for(let v=0;v<a.length;++v){const b=a[v];s.skipNulls&&n[b]===null||SC(c,EC(n[b],b,d,h,s.allowEmptyArrays,s.strictNullHandling,s.skipNulls,s.encodeDotInKeys,s.encode?s.encoder:null,s.filter,s.sort,s.allowDots,s.serializeDate,s.format,s.formatter,s.encodeValuesOnly,s.charset,f))}const g=c.join(s.delimiter);let p=s.addQueryPrefix===!0?"?":"";return s.charsetSentinel&&(s.charset==="iso-8859-1"?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),g.length>0?p+g:""}function Tz(t){let e=0;for(const a of t)e+=a.length;const n=new Uint8Array(e);let s=0;for(const a of t)n.set(a,s),s+=a.length;return n}let Cx;function Wg(t){let e;return(Cx??(e=new globalThis.TextEncoder,Cx=e.encode.bind(e)))(t)}let Ax;function Tx(t){let e;return(Ax??(e=new globalThis.TextDecoder,Ax=e.decode.bind(e)))(t)}var vn,bn;class gf{constructor(){vn.set(this,void 0),bn.set(this,void 0),$e(this,vn,new Uint8Array),$e(this,bn,null)}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Wg(e):e;$e(this,vn,Tz([se(this,vn,"f"),n]));const s=[];let a;for(;(a=Nz(se(this,vn,"f"),se(this,bn,"f")))!=null;){if(a.carriage&&se(this,bn,"f")==null){$e(this,bn,a.index);continue}if(se(this,bn,"f")!=null&&(a.index!==se(this,bn,"f")+1||a.carriage)){s.push(Tx(se(this,vn,"f").subarray(0,se(this,bn,"f")-1))),$e(this,vn,se(this,vn,"f").subarray(se(this,bn,"f"))),$e(this,bn,null);continue}const l=se(this,bn,"f")!==null?a.preceding-1:a.preceding,c=Tx(se(this,vn,"f").subarray(0,l));s.push(c),$e(this,vn,se(this,vn,"f").subarray(a.index)),$e(this,bn,null)}return s}flush(){return se(this,vn,"f").length?this.decode(`
`):[]}}vn=new WeakMap,bn=new WeakMap;gf.NEWLINE_CHARS=new Set([`
`,"\r"]);gf.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Nz(t,e){for(let a=e??0;a<t.length;a++){if(t[a]===10)return{preceding:a,index:a+1,carriage:!1};if(t[a]===13)return{preceding:a,index:a+1,carriage:!0}}return null}function Oz(t){for(let s=0;s<t.length-1;s++){if(t[s]===10&&t[s+1]===10||t[s]===13&&t[s+1]===13)return s+2;if(t[s]===13&&t[s+1]===10&&s+3<t.length&&t[s+2]===13&&t[s+3]===10)return s+4}return-1}const Bd={off:0,error:200,warn:300,info:400,debug:500},Nx=(t,e,n)=>{if(t){if(uz(Bd,t))return t;Bt(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(Bd))}`)}};function ml(){}function Zu(t,e,n){return!e||Bd[t]>Bd[n]?ml:e[t].bind(e)}const Rz={error:ml,warn:ml,info:ml,debug:ml};let Ox=new WeakMap;function Bt(t){const e=t.logger,n=t.logLevel??"off";if(!e)return Rz;const s=Ox.get(e);if(s&&s[0]===n)return s[1];const a={error:Zu("error",e,n),warn:Zu("warn",e,n),info:Zu("info",e,n),debug:Zu("debug",e,n)};return Ox.set(e,[n,a]),a}const ui=t=>(t.options&&(t.options={...t.options},delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);var ll;class ur{constructor(e,n,s){this.iterator=e,ll.set(this,void 0),this.controller=n,$e(this,ll,s)}static fromSSEResponse(e,n,s){let a=!1;const l=s?Bt(s):console;async function*c(){if(a)throw new je("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let d=!1;try{for await(const h of jz(e,n))if(!d){if(h.data.startsWith("[DONE]")){d=!0;continue}if(h.event===null||!h.event.startsWith("thread.")){let f;try{f=JSON.parse(h.data)}catch(g){throw l.error("Could not parse message into JSON:",h.data),l.error("From chunk:",h.raw),g}if(f&&f.error)throw new qt(void 0,f.error,void 0,e.headers);yield f}else{let f;try{f=JSON.parse(h.data)}catch(g){throw console.error("Could not parse message into JSON:",h.data),console.error("From chunk:",h.raw),g}if(h.event=="error")throw new qt(void 0,f.error,f.message,void 0);yield{event:h.event,data:f}}}d=!0}catch(h){if(eg(h))return;throw h}finally{d||n.abort()}}return new ur(c,n,s)}static fromReadableStream(e,n,s){let a=!1;async function*l(){const d=new gf,h=bC(e);for await(const f of h)for(const g of d.decode(f))yield g;for(const f of d.flush())yield f}async function*c(){if(a)throw new je("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let d=!1;try{for await(const h of l())d||h&&(yield JSON.parse(h));d=!0}catch(h){if(eg(h))return;throw h}finally{d||n.abort()}}return new ur(c,n,s)}[(ll=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const e=[],n=[],s=this.iterator(),a=l=>({next:()=>{if(l.length===0){const c=s.next();e.push(c),n.push(c)}return l.shift()}});return[new ur(()=>a(e),this.controller,se(this,ll,"f")),new ur(()=>a(n),this.controller,se(this,ll,"f"))]}toReadableStream(){const e=this;let n;return yC({async start(){n=e[Symbol.asyncIterator]()},async pull(s){try{const{value:a,done:l}=await n.next();if(l)return s.close();const c=Wg(JSON.stringify(a)+`
`);s.enqueue(c)}catch(a){s.error(a)}},async cancel(){await n.return?.()}})}}async function*jz(t,e){if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new je("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new je("Attempted to iterate over a response with no body");const n=new Mz,s=new gf,a=bC(t.body);for await(const l of kz(a))for(const c of s.decode(l)){const d=n.decode(c);d&&(yield d)}for(const l of s.flush()){const c=n.decode(l);c&&(yield c)}}async function*kz(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const s=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?Wg(n):n;let a=new Uint8Array(e.length+s.length);a.set(e),a.set(s,e.length),e=a;let l;for(;(l=Oz(e))!==-1;)yield e.slice(0,l),e=e.slice(l)}e.length>0&&(yield e)}class Mz{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const l={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],l}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,s,a]=Dz(e,":");return a.startsWith(" ")&&(a=a.substring(1)),n==="event"?this.event=a:n==="data"&&this.data.push(a),null}}function Dz(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}async function CC(t,e){const{response:n,requestLogID:s,retryOfRequestLogID:a,startTime:l}=e,c=await(async()=>{if(e.options.stream)return Bt(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):ur.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const h=n.headers.get("content-type")?.split(";")[0]?.trim();if(h?.includes("application/json")||h?.endsWith("+json")){const p=await n.json();return AC(p,n)}return await n.text()})();return Bt(t).debug(`[${s}] response parsed`,ui({retryOfRequestLogID:a,url:n.url,status:n.status,body:c,durationMs:Date.now()-l})),c}function AC(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}var pl;class yf extends Promise{constructor(e,n,s=CC){super(a=>{a(null)}),this.responsePromise=n,this.parseResponse=s,pl.set(this,void 0),$e(this,pl,e)}_thenUnwrap(e){return new yf(se(this,pl,"f"),this.responsePromise,async(n,s)=>AC(e(await this.parseResponse(n,s),s),s.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(se(this,pl,"f"),e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}pl=new WeakMap;var ed;class Jg{constructor(e,n,s,a){ed.set(this,void 0),$e(this,ed,e),this.options=a,this.response=n,this.body=s}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const e=this.nextPageRequestOptions();if(!e)throw new je("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await se(this,ed,"f").requestAPIList(this.constructor,e)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(ed=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class Uz extends yf{constructor(e,n,s){super(e,n,async(a,l)=>new s(a,l.response,await CC(a,l),l.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}class vf extends Jg{constructor(e,n,s,a){super(e,n,s,a),this.data=s.data||[],this.object=s.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class Et extends Jg{constructor(e,n,s,a){super(e,n,s,a),this.data=s.data||[],this.has_more=s.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const e=this.getPaginatedItems(),n=e[e.length-1]?.id;return n?{...this.options,query:{...gC(this.options.query),after:n}}:null}}class Pd extends Jg{constructor(e,n,s,a){super(e,n,s,a),this.data=s.data||[],this.has_more=s.has_more||!1,this.last_id=s.last_id||""}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const e=this.last_id;return e?{...this.options,query:{...gC(this.options.query),after:e}}:null}}const TC=()=>{if(typeof File>"u"){const{process:t}=globalThis,e=typeof t?.versions?.node=="string"&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(e?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Nl(t,e,n){return TC(),new File(t,e??"unknown_file",n)}function md(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const Zg=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",Rx=async(t,e)=>rg(t.body)?{...t,body:await NC(t.body,e)}:t,Ei=async(t,e)=>({...t,body:await NC(t.body,e)}),jx=new WeakMap;function $z(t){const e=typeof t=="function"?t:t.fetch,n=jx.get(e);if(n)return n;const s=(async()=>{try{const a="Response"in e?e.Response:(await e("data:,")).constructor,l=new FormData;return l.toString()!==await new a(l).text()}catch{return!0}})();return jx.set(e,s),s}const NC=async(t,e)=>{if(!await $z(e))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const n=new FormData;return await Promise.all(Object.entries(t||{}).map(([s,a])=>sg(n,s,a))),n},OC=t=>t instanceof Blob&&"name"in t,Iz=t=>typeof t=="object"&&t!==null&&(t instanceof Response||Zg(t)||OC(t)),rg=t=>{if(Iz(t))return!0;if(Array.isArray(t))return t.some(rg);if(t&&typeof t=="object"){for(const e in t)if(rg(t[e]))return!0}return!1},sg=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(n instanceof Response)t.append(e,Nl([await n.blob()],md(n)));else if(Zg(n))t.append(e,Nl([await new Response(vC(n)).blob()],md(n)));else if(OC(n))t.append(e,n,md(n));else if(Array.isArray(n))await Promise.all(n.map(s=>sg(t,e+"[]",s)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([s,a])=>sg(t,`${e}[${s}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}},RC=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",Lz=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&RC(t),zz=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function Bz(t,e,n){if(TC(),t=await t,Lz(t))return t instanceof File?t:Nl([await t.arrayBuffer()],t.name);if(zz(t)){const a=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),Nl(await ig(a),e,n)}const s=await ig(t);if(e||(e=md(t)),!n?.type){const a=s.find(l=>typeof l=="object"&&"type"in l&&l.type);typeof a=="string"&&(n={...n,type:a})}return Nl(s,e,n)}async function ig(t){let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(RC(t))e.push(t instanceof Blob?t:await t.arrayBuffer());else if(Zg(t))for await(const n of t)e.push(...await ig(n));else{const n=t?.constructor?.name;throw new Error(`Unexpected data type: ${typeof t}${n?`; constructor: ${n}`:""}${Pz(t)}`)}return e}function Pz(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}class Ne{constructor(e){this._client=e}}function jC(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const kx=Object.freeze(Object.create(null)),qz=(t=jC)=>function(n,...s){if(n.length===1)return n[0];let a=!1;const l=[],c=n.reduce((g,p,v)=>{/[?#]/.test(p)&&(a=!0);const b=s[v];let x=(a?encodeURIComponent:t)(""+b);return v!==s.length&&(b==null||typeof b=="object"&&b.toString===Object.getPrototypeOf(Object.getPrototypeOf(b.hasOwnProperty??kx)??kx)?.toString)&&(x=b+"",l.push({start:g.length+p.length,length:x.length,error:`Value of type ${Object.prototype.toString.call(b).slice(8,-1)} is not a valid path parameter`})),g+p+(v===s.length?"":x)},""),d=c.split(/[?#]/,1)[0],h=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let f;for(;(f=h.exec(d))!==null;)l.push({start:f.index,length:f[0].length,error:`Value "${f[0]}" can't be safely passed as a path parameter`});if(l.sort((g,p)=>g.start-p.start),l.length>0){let g=0;const p=l.reduce((v,b)=>{const x=" ".repeat(b.start-g),w="^".repeat(b.length);return g=b.start+b.length,v+x+w},"");throw new je(`Path parameters result in path with invalid segments:
${l.map(v=>v.error).join(`
`)}
${c}
${p}`)}return c},ye=qz(jC);let kC=class extends Ne{list(e,n={},s){return this._client.getAPIList(ye`/chat/completions/${e}/messages`,Et,{query:n,...s})}};function qd(t){return t!==void 0&&"function"in t&&t.function!==void 0}function ey(t){return t?.$brand==="auto-parseable-response-format"}function ac(t){return t?.$brand==="auto-parseable-tool"}function Hz(t,e){return!e||!MC(e)?{...t,choices:t.choices.map(n=>(DC(n.message.tool_calls),{...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:ty(t,e)}function ty(t,e){const n=t.choices.map(s=>{if(s.finish_reason==="length")throw new mC;if(s.finish_reason==="content_filter")throw new pC;return DC(s.message.tool_calls),{...s,message:{...s.message,...s.message.tool_calls?{tool_calls:s.message.tool_calls?.map(a=>Fz(e,a))??void 0}:void 0,parsed:s.message.content&&!s.message.refusal?Vz(e,s.message.content):null}}});return{...t,choices:n}}function Vz(t,e){return t.response_format?.type!=="json_schema"?null:t.response_format?.type==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function Fz(t,e){const n=t.tools?.find(s=>qd(s)&&s.function?.name===e.function.name);return{...e,function:{...e.function,parsed_arguments:ac(n)?n.$parseRaw(e.function.arguments):n?.function.strict?JSON.parse(e.function.arguments):null}}}function Yz(t,e){if(!t||!("tools"in t)||!t.tools)return!1;const n=t.tools?.find(s=>qd(s)&&s.function?.name===e.function.name);return qd(n)&&(ac(n)||n?.function.strict||!1)}function MC(t){return ey(t.response_format)?!0:t.tools?.some(e=>ac(e)||e.type==="function"&&e.function.strict===!0)??!1}function DC(t){for(const e of t||[])if(e.type!=="function")throw new je(`Currently only \`function\` tool calls are supported; Received \`${e.type}\``)}function Gz(t){for(const e of t??[]){if(e.type!=="function")throw new je(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new je(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}const Hd=t=>t?.role==="assistant",UC=t=>t?.role==="tool";var ag,pd,gd,gl,yl,yd,vl,Pr,bl,Vd,Fd,Ra,$C;class ny{constructor(){ag.add(this),this.controller=new AbortController,pd.set(this,void 0),gd.set(this,()=>{}),gl.set(this,()=>{}),yl.set(this,void 0),yd.set(this,()=>{}),vl.set(this,()=>{}),Pr.set(this,{}),bl.set(this,!1),Vd.set(this,!1),Fd.set(this,!1),Ra.set(this,!1),$e(this,pd,new Promise((e,n)=>{$e(this,gd,e,"f"),$e(this,gl,n,"f")})),$e(this,yl,new Promise((e,n)=>{$e(this,yd,e,"f"),$e(this,vl,n,"f")})),se(this,pd,"f").catch(()=>{}),se(this,yl,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},se(this,ag,"m",$C).bind(this))},0)}_connected(){this.ended||(se(this,gd,"f").call(this),this._emit("connect"))}get ended(){return se(this,bl,"f")}get errored(){return se(this,Vd,"f")}get aborted(){return se(this,Fd,"f")}abort(){this.controller.abort()}on(e,n){return(se(this,Pr,"f")[e]||(se(this,Pr,"f")[e]=[])).push({listener:n}),this}off(e,n){const s=se(this,Pr,"f")[e];if(!s)return this;const a=s.findIndex(l=>l.listener===n);return a>=0&&s.splice(a,1),this}once(e,n){return(se(this,Pr,"f")[e]||(se(this,Pr,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,s)=>{$e(this,Ra,!0),e!=="error"&&this.once("error",s),this.once(e,n)})}async done(){$e(this,Ra,!0),await se(this,yl,"f")}_emit(e,...n){if(se(this,bl,"f"))return;e==="end"&&($e(this,bl,!0),se(this,yd,"f").call(this));const s=se(this,Pr,"f")[e];if(s&&(se(this,Pr,"f")[e]=s.filter(a=>!a.once),s.forEach(({listener:a})=>a(...n))),e==="abort"){const a=n[0];!se(this,Ra,"f")&&!s?.length&&Promise.reject(a),se(this,gl,"f").call(this,a),se(this,vl,"f").call(this,a),this._emit("end");return}if(e==="error"){const a=n[0];!se(this,Ra,"f")&&!s?.length&&Promise.reject(a),se(this,gl,"f").call(this,a),se(this,vl,"f").call(this,a),this._emit("end")}}_emitFinal(){}}pd=new WeakMap,gd=new WeakMap,gl=new WeakMap,yl=new WeakMap,yd=new WeakMap,vl=new WeakMap,Pr=new WeakMap,bl=new WeakMap,Vd=new WeakMap,Fd=new WeakMap,Ra=new WeakMap,ag=new WeakSet,$C=function(e){if($e(this,Vd,!0),e instanceof Error&&e.name==="AbortError"&&(e=new $n),e instanceof $n)return $e(this,Fd,!0),this._emit("abort",e);if(e instanceof je)return this._emit("error",e);if(e instanceof Error){const n=new je(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new je(String(e)))};function Xz(t){return typeof t.parse=="function"}var Wt,og,Yd,lg,cg,ug,IC,LC;const Kz=10;class zC extends ny{constructor(){super(...arguments),Wt.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=e.choices[0]?.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),UC(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(Hd(e)&&e.tool_calls)for(const s of e.tool_calls)s.type==="function"&&this._emit("functionToolCall",s.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new je("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),se(this,Wt,"m",og).call(this)}async finalMessage(){return await this.done(),se(this,Wt,"m",Yd).call(this)}async finalFunctionToolCall(){return await this.done(),se(this,Wt,"m",lg).call(this)}async finalFunctionToolCallResult(){return await this.done(),se(this,Wt,"m",cg).call(this)}async totalUsage(){return await this.done(),se(this,Wt,"m",ug).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=se(this,Wt,"m",Yd).call(this);n&&this._emit("finalMessage",n);const s=se(this,Wt,"m",og).call(this);s&&this._emit("finalContent",s);const a=se(this,Wt,"m",lg).call(this);a&&this._emit("finalFunctionToolCall",a);const l=se(this,Wt,"m",cg).call(this);l!=null&&this._emit("finalFunctionToolCallResult",l),this._chatCompletions.some(c=>c.usage)&&this._emit("totalUsage",se(this,Wt,"m",ug).call(this))}async _createChatCompletion(e,n,s){const a=s?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),se(this,Wt,"m",IC).call(this,n);const l=await e.chat.completions.create({...n,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addChatCompletion(ty(l,n))}async _runChatCompletion(e,n,s){for(const a of n.messages)this._addMessage(a,!1);return await this._createChatCompletion(e,n,s)}async _runTools(e,n,s){const a="tool",{tool_choice:l="auto",stream:c,...d}=n,h=typeof l!="string"&&l.type==="function"&&l?.function?.name,{maxChatCompletions:f=Kz}=s||{},g=n.tools.map(b=>{if(ac(b)){if(!b.$callback)throw new je("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:b.$callback,name:b.function.name,description:b.function.description||"",parameters:b.function.parameters,parse:b.$parseRaw,strict:!0}}}return b}),p={};for(const b of g)b.type==="function"&&(p[b.function.name||b.function.function.name]=b.function);const v="tools"in n?g.map(b=>b.type==="function"?{type:"function",function:{name:b.function.name||b.function.function.name,parameters:b.function.parameters,description:b.function.description,strict:b.function.strict}}:b):void 0;for(const b of n.messages)this._addMessage(b,!1);for(let b=0;b<f;++b){const w=(await this._createChatCompletion(e,{...d,tool_choice:l,tools:v,messages:[...this.messages]},s)).choices[0]?.message;if(!w)throw new je("missing message in ChatCompletion response");if(!w.tool_calls?.length)return;for(const S of w.tool_calls){if(S.type!=="function")continue;const A=S.id,{name:N,arguments:E}=S.function,C=p[N];if(C){if(h&&h!==N){const I=`Invalid tool_call: ${JSON.stringify(N)}. ${JSON.stringify(h)} requested. Please try again`;this._addMessage({role:a,tool_call_id:A,content:I});continue}}else{const I=`Invalid tool_call: ${JSON.stringify(N)}. Available options are: ${Object.keys(p).map(q=>JSON.stringify(q)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:A,content:I});continue}let O;try{O=Xz(C)?await C.parse(E):E}catch(I){const q=I instanceof Error?I.message:String(I);this._addMessage({role:a,tool_call_id:A,content:q});continue}const R=await C.function(O,this),M=se(this,Wt,"m",LC).call(this,R);if(this._addMessage({role:a,tool_call_id:A,content:M}),h)return}}}}Wt=new WeakSet,og=function(){return se(this,Wt,"m",Yd).call(this).content??null},Yd=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(Hd(n))return{...n,content:n.content??null,refusal:n.refusal??null}}throw new je("stream ended without producing a ChatCompletionMessage with role=assistant")},lg=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(Hd(n)&&n?.tool_calls?.length)return n.tool_calls.filter(s=>s.type==="function").at(-1)?.function}},cg=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(UC(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(s=>s.role==="assistant"&&s.tool_calls?.some(a=>a.type==="function"&&a.id===n.tool_call_id)))return n.content}},ug=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},IC=function(e){if(e.n!=null&&e.n>1)throw new je("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},LC=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class ry extends zC{static runTools(e,n,s){const a=new ry,l={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(e,n,l)),a}_addMessage(e,n=!0){super._addMessage(e,n),Hd(e)&&e.content&&this._emit("content",e.content)}}const BC=1,PC=2,qC=4,HC=8,VC=16,FC=32,YC=64,GC=128,XC=256,KC=GC|XC,QC=VC|FC|KC|YC,WC=BC|PC|QC,JC=qC|HC,Qz=WC|JC,Ut={STR:BC,NUM:PC,ARR:qC,OBJ:HC,NULL:VC,BOOL:FC,NAN:YC,INFINITY:GC,MINUS_INFINITY:XC,INF:KC,SPECIAL:QC,ATOM:WC,COLLECTION:JC,ALL:Qz};class Wz extends Error{}class Jz extends Error{}function Zz(t,e=Ut.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return e4(t.trim(),e)}const e4=(t,e)=>{const n=t.length;let s=0;const a=v=>{throw new Wz(`${v} at position ${s}`)},l=v=>{throw new Jz(`${v} at position ${s}`)},c=()=>(p(),s>=n&&a("Unexpected end of input"),t[s]==='"'?d():t[s]==="{"?h():t[s]==="["?f():t.substring(s,s+4)==="null"||Ut.NULL&e&&n-s<4&&"null".startsWith(t.substring(s))?(s+=4,null):t.substring(s,s+4)==="true"||Ut.BOOL&e&&n-s<4&&"true".startsWith(t.substring(s))?(s+=4,!0):t.substring(s,s+5)==="false"||Ut.BOOL&e&&n-s<5&&"false".startsWith(t.substring(s))?(s+=5,!1):t.substring(s,s+8)==="Infinity"||Ut.INFINITY&e&&n-s<8&&"Infinity".startsWith(t.substring(s))?(s+=8,1/0):t.substring(s,s+9)==="-Infinity"||Ut.MINUS_INFINITY&e&&1<n-s&&n-s<9&&"-Infinity".startsWith(t.substring(s))?(s+=9,-1/0):t.substring(s,s+3)==="NaN"||Ut.NAN&e&&n-s<3&&"NaN".startsWith(t.substring(s))?(s+=3,NaN):g()),d=()=>{const v=s;let b=!1;for(s++;s<n&&(t[s]!=='"'||b&&t[s-1]==="\\");)b=t[s]==="\\"?!b:!1,s++;if(t.charAt(s)=='"')try{return JSON.parse(t.substring(v,++s-Number(b)))}catch(x){l(String(x))}else if(Ut.STR&e)try{return JSON.parse(t.substring(v,s-Number(b))+'"')}catch{return JSON.parse(t.substring(v,t.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},h=()=>{s++,p();const v={};try{for(;t[s]!=="}";){if(p(),s>=n&&Ut.OBJ&e)return v;const b=d();p(),s++;try{const x=c();Object.defineProperty(v,b,{value:x,writable:!0,enumerable:!0,configurable:!0})}catch(x){if(Ut.OBJ&e)return v;throw x}p(),t[s]===","&&s++}}catch{if(Ut.OBJ&e)return v;a("Expected '}' at end of object")}return s++,v},f=()=>{s++;const v=[];try{for(;t[s]!=="]";)v.push(c()),p(),t[s]===","&&s++}catch{if(Ut.ARR&e)return v;a("Expected ']' at end of array")}return s++,v},g=()=>{if(s===0){t==="-"&&Ut.NUM&e&&a("Not sure what '-' is");try{return JSON.parse(t)}catch(b){if(Ut.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}l(String(b))}}const v=s;for(t[s]==="-"&&s++;t[s]&&!",]}".includes(t[s]);)s++;s==n&&!(Ut.NUM&e)&&a("Unterminated number literal");try{return JSON.parse(t.substring(v,s))}catch{t.substring(v,s)==="-"&&Ut.NUM&e&&a("Not sure what '-' is");try{return JSON.parse(t.substring(v,t.lastIndexOf("e")))}catch(x){l(String(x))}}},p=()=>{for(;s<n&&` 
\r	`.includes(t[s]);)s++};return c()},Mx=t=>Zz(t,Ut.ALL^Ut.NUM);var Ot,Br,Ea,Rs,vp,td,bp,_p,wp,nd,xp,Dx;class Yl extends zC{constructor(e){super(),Ot.add(this),Br.set(this,void 0),Ea.set(this,void 0),Rs.set(this,void 0),$e(this,Br,e),$e(this,Ea,[])}get currentChatCompletionSnapshot(){return se(this,Rs,"f")}static fromReadableStream(e){const n=new Yl(null);return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,s){const a=new Yl(n);return a._run(()=>a._runChatCompletion(e,{...n,stream:!0},{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(e,n,s){super._createChatCompletion;const a=s?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),se(this,Ot,"m",vp).call(this);const l=await e.chat.completions.create({...n,stream:!0},{...s,signal:this.controller.signal});this._connected();for await(const c of l)se(this,Ot,"m",bp).call(this,c);if(l.controller.signal?.aborted)throw new $n;return this._addChatCompletion(se(this,Ot,"m",nd).call(this))}async _fromReadableStream(e,n){const s=n?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),se(this,Ot,"m",vp).call(this),this._connected();const a=ur.fromReadableStream(e,this.controller);let l;for await(const c of a)l&&l!==c.id&&this._addChatCompletion(se(this,Ot,"m",nd).call(this)),se(this,Ot,"m",bp).call(this,c),l=c.id;if(a.controller.signal?.aborted)throw new $n;return this._addChatCompletion(se(this,Ot,"m",nd).call(this))}[(Br=new WeakMap,Ea=new WeakMap,Rs=new WeakMap,Ot=new WeakSet,vp=function(){this.ended||$e(this,Rs,void 0)},td=function(n){let s=se(this,Ea,"f")[n.index];return s||(s={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},se(this,Ea,"f")[n.index]=s,s)},bp=function(n){if(this.ended)return;const s=se(this,Ot,"m",Dx).call(this,n);this._emit("chunk",n,s);for(const a of n.choices){const l=s.choices[a.index];a.delta.content!=null&&l.message?.role==="assistant"&&l.message?.content&&(this._emit("content",a.delta.content,l.message.content),this._emit("content.delta",{delta:a.delta.content,snapshot:l.message.content,parsed:l.message.parsed})),a.delta.refusal!=null&&l.message?.role==="assistant"&&l.message?.refusal&&this._emit("refusal.delta",{delta:a.delta.refusal,snapshot:l.message.refusal}),a.logprobs?.content!=null&&l.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:a.logprobs?.content,snapshot:l.logprobs?.content??[]}),a.logprobs?.refusal!=null&&l.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:a.logprobs?.refusal,snapshot:l.logprobs?.refusal??[]});const c=se(this,Ot,"m",td).call(this,l);l.finish_reason&&(se(this,Ot,"m",wp).call(this,l),c.current_tool_call_index!=null&&se(this,Ot,"m",_p).call(this,l,c.current_tool_call_index));for(const d of a.delta.tool_calls??[])c.current_tool_call_index!==d.index&&(se(this,Ot,"m",wp).call(this,l),c.current_tool_call_index!=null&&se(this,Ot,"m",_p).call(this,l,c.current_tool_call_index)),c.current_tool_call_index=d.index;for(const d of a.delta.tool_calls??[]){const h=l.message.tool_calls?.[d.index];h?.type&&(h?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:h.function?.name,index:d.index,arguments:h.function.arguments,parsed_arguments:h.function.parsed_arguments,arguments_delta:d.function?.arguments??""}):(h?.type,void 0))}}},_p=function(n,s){if(se(this,Ot,"m",td).call(this,n).done_tool_calls.has(s))return;const l=n.message.tool_calls?.[s];if(!l)throw new Error("no tool call snapshot");if(!l.type)throw new Error("tool call snapshot missing `type`");if(l.type==="function"){const c=se(this,Br,"f")?.tools?.find(d=>qd(d)&&d.function.name===l.function.name);this._emit("tool_calls.function.arguments.done",{name:l.function.name,index:s,arguments:l.function.arguments,parsed_arguments:ac(c)?c.$parseRaw(l.function.arguments):c?.function.strict?JSON.parse(l.function.arguments):null})}else l.type},wp=function(n){const s=se(this,Ot,"m",td).call(this,n);if(n.message.content&&!s.content_done){s.content_done=!0;const a=se(this,Ot,"m",xp).call(this);this._emit("content.done",{content:n.message.content,parsed:a?a.$parseRaw(n.message.content):null})}n.message.refusal&&!s.refusal_done&&(s.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),n.logprobs?.content&&!s.logprobs_content_done&&(s.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),n.logprobs?.refusal&&!s.logprobs_refusal_done&&(s.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},nd=function(){if(this.ended)throw new je("stream has ended, this shouldn't happen");const n=se(this,Rs,"f");if(!n)throw new je("request ended without sending any chunks");return $e(this,Rs,void 0),$e(this,Ea,[]),t4(n,se(this,Br,"f"))},xp=function(){const n=se(this,Br,"f")?.response_format;return ey(n)?n:null},Dx=function(n){var s,a,l,c;let d=se(this,Rs,"f");const{choices:h,...f}=n;d?Object.assign(d,f):d=$e(this,Rs,{...f,choices:[]});for(const{delta:g,finish_reason:p,index:v,logprobs:b=null,...x}of n.choices){let w=d.choices[v];if(w||(w=d.choices[v]={finish_reason:p,index:v,message:{},logprobs:b,...x}),b)if(!w.logprobs)w.logprobs=Object.assign({},b);else{const{content:R,refusal:M,...I}=b;Object.assign(w.logprobs,I),R&&((s=w.logprobs).content??(s.content=[]),w.logprobs.content.push(...R)),M&&((a=w.logprobs).refusal??(a.refusal=[]),w.logprobs.refusal.push(...M))}if(p&&(w.finish_reason=p,se(this,Br,"f")&&MC(se(this,Br,"f")))){if(p==="length")throw new mC;if(p==="content_filter")throw new pC}if(Object.assign(w,x),!g)continue;const{content:S,refusal:A,function_call:N,role:E,tool_calls:C,...O}=g;if(Object.assign(w.message,O),A&&(w.message.refusal=(w.message.refusal||"")+A),E&&(w.message.role=E),N&&(w.message.function_call?(N.name&&(w.message.function_call.name=N.name),N.arguments&&((l=w.message.function_call).arguments??(l.arguments=""),w.message.function_call.arguments+=N.arguments)):w.message.function_call=N),S&&(w.message.content=(w.message.content||"")+S,!w.message.refusal&&se(this,Ot,"m",xp).call(this)&&(w.message.parsed=Mx(w.message.content))),C){w.message.tool_calls||(w.message.tool_calls=[]);for(const{index:R,id:M,type:I,function:q,...K}of C){const Y=(c=w.message.tool_calls)[R]??(c[R]={});Object.assign(Y,K),M&&(Y.id=M),I&&(Y.type=I),q&&(Y.function??(Y.function={name:q.name??"",arguments:""})),q?.name&&(Y.function.name=q.name),q?.arguments&&(Y.function.arguments+=q.arguments,Yz(se(this,Br,"f"),Y)&&(Y.function.parsed_arguments=Mx(Y.function.arguments)))}}}return d},Symbol.asyncIterator)](){const e=[],n=[];let s=!1;return this.on("chunk",a=>{const l=n.shift();l?l.resolve(a):e.push(a)}),this.on("end",()=>{s=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{s=!0;for(const l of n)l.reject(a);n.length=0}),this.on("error",a=>{s=!0;for(const l of n)l.reject(a);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((l,c)=>n.push({resolve:l,reject:c})).then(l=>l?{value:l,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new ur(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function t4(t,e){const{id:n,choices:s,created:a,model:l,system_fingerprint:c,...d}=t,h={...d,id:n,choices:s.map(({message:f,finish_reason:g,index:p,logprobs:v,...b})=>{if(!g)throw new je(`missing finish_reason for choice ${p}`);const{content:x=null,function_call:w,tool_calls:S,...A}=f,N=f.role;if(!N)throw new je(`missing role for choice ${p}`);if(w){const{arguments:E,name:C}=w;if(E==null)throw new je(`missing function_call.arguments for choice ${p}`);if(!C)throw new je(`missing function_call.name for choice ${p}`);return{...b,message:{content:x,function_call:{arguments:E,name:C},role:N,refusal:f.refusal??null},finish_reason:g,index:p,logprobs:v}}return S?{...b,index:p,finish_reason:g,logprobs:v,message:{...A,role:N,content:x,refusal:f.refusal??null,tool_calls:S.map((E,C)=>{const{function:O,type:R,id:M,...I}=E,{arguments:q,name:K,...Y}=O||{};if(M==null)throw new je(`missing choices[${p}].tool_calls[${C}].id
${rd(t)}`);if(R==null)throw new je(`missing choices[${p}].tool_calls[${C}].type
${rd(t)}`);if(K==null)throw new je(`missing choices[${p}].tool_calls[${C}].function.name
${rd(t)}`);if(q==null)throw new je(`missing choices[${p}].tool_calls[${C}].function.arguments
${rd(t)}`);return{...I,id:M,type:R,function:{...Y,name:K,arguments:q}}})}}:{...b,message:{...A,content:x,role:N,refusal:f.refusal??null},finish_reason:g,index:p,logprobs:v}}),created:a,model:l,object:"chat.completion",...c?{system_fingerprint:c}:{}};return Hz(h,e)}function rd(t){return JSON.stringify(t)}class Gd extends Yl{static fromReadableStream(e){const n=new Gd(null);return n._run(()=>n._fromReadableStream(e)),n}static runTools(e,n,s){const a=new Gd(n),l={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(e,n,l)),a}}let sy=class extends Ne{constructor(){super(...arguments),this.messages=new kC(this._client)}create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}retrieve(e,n){return this._client.get(ye`/chat/completions/${e}`,n)}update(e,n,s){return this._client.post(ye`/chat/completions/${e}`,{body:n,...s})}list(e={},n){return this._client.getAPIList("/chat/completions",Et,{query:e,...n})}delete(e,n){return this._client.delete(ye`/chat/completions/${e}`,n)}parse(e,n){return Gz(e.tools),this._client.chat.completions.create(e,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(s=>ty(s,e))}runTools(e,n){return e.stream?Gd.runTools(this._client,e,n):ry.runTools(this._client,e,n)}stream(e,n){return Yl.createChatCompletion(this._client,e,n)}};sy.Messages=kC;class iy extends Ne{constructor(){super(...arguments),this.completions=new sy(this._client)}}iy.Completions=sy;const ZC=Symbol("brand.privateNullableHeaders");function*n4(t){if(!t)return;if(ZC in t){const{values:s,nulls:a}=t;yield*s.entries();for(const l of a)yield[l,null];return}let e=!1,n;t instanceof Headers?n=t.entries():vx(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let s of n){const a=s[0];if(typeof a!="string")throw new TypeError("expected header name to be a string");const l=vx(s[1])?s[1]:[s[1]];let c=!1;for(const d of l)d!==void 0&&(e&&!c&&(c=!0,yield[a,null]),yield[a,d])}}const Se=t=>{const e=new Headers,n=new Set;for(const s of t){const a=new Set;for(const[l,c]of n4(s)){const d=l.toLowerCase();a.has(d)||(e.delete(l),a.add(d)),c===null?(e.delete(l),n.add(d)):(e.append(l,c),n.delete(d))}}return{[ZC]:!0,values:e,nulls:n}};class eA extends Ne{create(e,n){return this._client.post("/audio/speech",{body:e,...n,headers:Se([{Accept:"application/octet-stream"},n?.headers]),__binaryResponse:!0})}}class tA extends Ne{create(e,n){return this._client.post("/audio/transcriptions",Ei({body:e,...n,stream:e.stream??!1,__metadata:{model:e.model}},this._client))}}class nA extends Ne{create(e,n){return this._client.post("/audio/translations",Ei({body:e,...n,__metadata:{model:e.model}},this._client))}}class oc extends Ne{constructor(){super(...arguments),this.transcriptions=new tA(this._client),this.translations=new nA(this._client),this.speech=new eA(this._client)}}oc.Transcriptions=tA;oc.Translations=nA;oc.Speech=eA;class rA extends Ne{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(ye`/batches/${e}`,n)}list(e={},n){return this._client.getAPIList("/batches",Et,{query:e,...n})}cancel(e,n){return this._client.post(ye`/batches/${e}/cancel`,n)}}class sA extends Ne{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:Se([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(e,n){return this._client.get(ye`/assistants/${e}`,{...n,headers:Se([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(e,n,s){return this._client.post(ye`/assistants/${e}`,{body:n,...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e={},n){return this._client.getAPIList("/assistants",Et,{query:e,...n,headers:Se([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}delete(e,n){return this._client.delete(ye`/assistants/${e}`,{...n,headers:Se([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}}let iA=class extends Ne{create(e,n){return this._client.post("/realtime/sessions",{body:e,...n,headers:Se([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}};class aA extends Ne{create(e,n){return this._client.post("/realtime/transcription_sessions",{body:e,...n,headers:Se([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}}let bf=class extends Ne{constructor(){super(...arguments),this.sessions=new iA(this._client),this.transcriptionSessions=new aA(this._client)}};bf.Sessions=iA;bf.TranscriptionSessions=aA;class oA extends Ne{create(e,n){return this._client.post("/chatkit/sessions",{body:e,...n,headers:Se([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}cancel(e,n){return this._client.post(ye`/chatkit/sessions/${e}/cancel`,{...n,headers:Se([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}}let lA=class extends Ne{retrieve(e,n){return this._client.get(ye`/chatkit/threads/${e}`,{...n,headers:Se([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}list(e={},n){return this._client.getAPIList("/chatkit/threads",Pd,{query:e,...n,headers:Se([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}delete(e,n){return this._client.delete(ye`/chatkit/threads/${e}`,{...n,headers:Se([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}listItems(e,n={},s){return this._client.getAPIList(ye`/chatkit/threads/${e}/items`,Pd,{query:n,...s,headers:Se([{"OpenAI-Beta":"chatkit_beta=v1"},s?.headers])})}};class _f extends Ne{constructor(){super(...arguments),this.sessions=new oA(this._client),this.threads=new lA(this._client)}}_f.Sessions=oA;_f.Threads=lA;class cA extends Ne{create(e,n,s){return this._client.post(ye`/threads/${e}/messages`,{body:n,...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}retrieve(e,n,s){const{thread_id:a}=n;return this._client.get(ye`/threads/${a}/messages/${e}`,{...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}update(e,n,s){const{thread_id:a,...l}=n;return this._client.post(ye`/threads/${a}/messages/${e}`,{body:l,...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e,n={},s){return this._client.getAPIList(ye`/threads/${e}/messages`,Et,{query:n,...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}delete(e,n,s){const{thread_id:a}=n;return this._client.delete(ye`/threads/${a}/messages/${e}`,{...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}class uA extends Ne{retrieve(e,n,s){const{thread_id:a,run_id:l,...c}=n;return this._client.get(ye`/threads/${a}/runs/${l}/steps/${e}`,{query:c,...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e,n,s){const{thread_id:a,...l}=n;return this._client.getAPIList(ye`/threads/${a}/runs/${e}/steps`,Et,{query:l,...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}const r4=t=>{if(typeof Buffer<"u"){const e=Buffer.from(t,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(t),n=e.length,s=new Uint8Array(n);for(let a=0;a<n;a++)s[a]=e.charCodeAt(a);return Array.from(new Float32Array(s.buffer))}};var s4={};const Ca=t=>{if(typeof globalThis.process<"u")return s4?.[t]?.trim()??void 0;if(typeof globalThis.Deno<"u")return globalThis.Deno.env?.get?.(t)?.trim()};var Pt,gi,dg,lr,vd,Gn,yi,Ua,hi,Xd,_n,bd,_d,Ol,_l,wl,Ux,$x,Ix,Lx,zx,Bx,Px;class Rl extends ny{constructor(){super(...arguments),Pt.add(this),dg.set(this,[]),lr.set(this,{}),vd.set(this,{}),Gn.set(this,void 0),yi.set(this,void 0),Ua.set(this,void 0),hi.set(this,void 0),Xd.set(this,void 0),_n.set(this,void 0),bd.set(this,void 0),_d.set(this,void 0),Ol.set(this,void 0)}[(dg=new WeakMap,lr=new WeakMap,vd=new WeakMap,Gn=new WeakMap,yi=new WeakMap,Ua=new WeakMap,hi=new WeakMap,Xd=new WeakMap,_n=new WeakMap,bd=new WeakMap,_d=new WeakMap,Ol=new WeakMap,Pt=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let s=!1;return this.on("event",a=>{const l=n.shift();l?l.resolve(a):e.push(a)}),this.on("end",()=>{s=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{s=!0;for(const l of n)l.reject(a);n.length=0}),this.on("error",a=>{s=!0;for(const l of n)l.reject(a);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((l,c)=>n.push({resolve:l,reject:c})).then(l=>l?{value:l,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new gi;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){const s=n?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=ur.fromReadableStream(e,this.controller);for await(const l of a)se(this,Pt,"m",_l).call(this,l);if(a.controller.signal?.aborted)throw new $n;return this._addRun(se(this,Pt,"m",wl).call(this))}toReadableStream(){return new ur(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,s,a){const l=new gi;return l._run(()=>l._runToolAssistantStream(e,n,s,{...a,headers:{...a?.headers,"X-Stainless-Helper-Method":"stream"}})),l}async _createToolAssistantStream(e,n,s,a){const l=a?.signal;l&&(l.aborted&&this.controller.abort(),l.addEventListener("abort",()=>this.controller.abort()));const c={...s,stream:!0},d=await e.submitToolOutputs(n,c,{...a,signal:this.controller.signal});this._connected();for await(const h of d)se(this,Pt,"m",_l).call(this,h);if(d.controller.signal?.aborted)throw new $n;return this._addRun(se(this,Pt,"m",wl).call(this))}static createThreadAssistantStream(e,n,s){const a=new gi;return a._run(()=>a._threadAssistantStream(e,n,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(e,n,s,a){const l=new gi;return l._run(()=>l._runAssistantStream(e,n,s,{...a,headers:{...a?.headers,"X-Stainless-Helper-Method":"stream"}})),l}currentEvent(){return se(this,bd,"f")}currentRun(){return se(this,_d,"f")}currentMessageSnapshot(){return se(this,Gn,"f")}currentRunStepSnapshot(){return se(this,Ol,"f")}async finalRunSteps(){return await this.done(),Object.values(se(this,lr,"f"))}async finalMessages(){return await this.done(),Object.values(se(this,vd,"f"))}async finalRun(){if(await this.done(),!se(this,yi,"f"))throw Error("Final run was not received.");return se(this,yi,"f")}async _createThreadAssistantStream(e,n,s){const a=s?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const l={...n,stream:!0},c=await e.createAndRun(l,{...s,signal:this.controller.signal});this._connected();for await(const d of c)se(this,Pt,"m",_l).call(this,d);if(c.controller.signal?.aborted)throw new $n;return this._addRun(se(this,Pt,"m",wl).call(this))}async _createAssistantStream(e,n,s,a){const l=a?.signal;l&&(l.aborted&&this.controller.abort(),l.addEventListener("abort",()=>this.controller.abort()));const c={...s,stream:!0},d=await e.create(n,c,{...a,signal:this.controller.signal});this._connected();for await(const h of d)se(this,Pt,"m",_l).call(this,h);if(d.controller.signal?.aborted)throw new $n;return this._addRun(se(this,Pt,"m",wl).call(this))}static accumulateDelta(e,n){for(const[s,a]of Object.entries(n)){if(!e.hasOwnProperty(s)){e[s]=a;continue}let l=e[s];if(l==null){e[s]=a;continue}if(s==="index"||s==="type"){e[s]=a;continue}if(typeof l=="string"&&typeof a=="string")l+=a;else if(typeof l=="number"&&typeof a=="number")l+=a;else if(pp(l)&&pp(a))l=this.accumulateDelta(l,a);else if(Array.isArray(l)&&Array.isArray(a)){if(l.every(c=>typeof c=="string"||typeof c=="number")){l.push(...a);continue}for(const c of a){if(!pp(c))throw new Error(`Expected array delta entry to be an object but got: ${c}`);const d=c.index;if(d==null)throw console.error(c),new Error("Expected array delta entry to have an `index` property");if(typeof d!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${d}`);const h=l[d];h==null?l.push(c):l[d]=this.accumulateDelta(h,c)}continue}else throw Error(`Unhandled record type: ${s}, deltaValue: ${a}, accValue: ${l}`);e[s]=l}return e}_addRun(e){return e}async _threadAssistantStream(e,n,s){return await this._createThreadAssistantStream(n,e,s)}async _runAssistantStream(e,n,s,a){return await this._createAssistantStream(n,e,s,a)}async _runToolAssistantStream(e,n,s,a){return await this._createToolAssistantStream(n,e,s,a)}}gi=Rl,_l=function(e){if(!this.ended)switch($e(this,bd,e),se(this,Pt,"m",Ix).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":se(this,Pt,"m",Px).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":se(this,Pt,"m",$x).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":se(this,Pt,"m",Ux).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},wl=function(){if(this.ended)throw new je("stream has ended, this shouldn't happen");if(!se(this,yi,"f"))throw Error("Final run has not been received");return se(this,yi,"f")},Ux=function(e){const[n,s]=se(this,Pt,"m",zx).call(this,e,se(this,Gn,"f"));$e(this,Gn,n),se(this,vd,"f")[n.id]=n;for(const a of s){const l=n.content[a.index];l?.type=="text"&&this._emit("textCreated",l.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const a of e.data.delta.content){if(a.type=="text"&&a.text){let l=a.text,c=n.content[a.index];if(c&&c.type=="text")this._emit("textDelta",l,c.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(a.index!=se(this,Ua,"f")){if(se(this,hi,"f"))switch(se(this,hi,"f").type){case"text":this._emit("textDone",se(this,hi,"f").text,se(this,Gn,"f"));break;case"image_file":this._emit("imageFileDone",se(this,hi,"f").image_file,se(this,Gn,"f"));break}$e(this,Ua,a.index)}$e(this,hi,n.content[a.index])}break;case"thread.message.completed":case"thread.message.incomplete":if(se(this,Ua,"f")!==void 0){const a=e.data.content[se(this,Ua,"f")];if(a)switch(a.type){case"image_file":this._emit("imageFileDone",a.image_file,se(this,Gn,"f"));break;case"text":this._emit("textDone",a.text,se(this,Gn,"f"));break}}se(this,Gn,"f")&&this._emit("messageDone",e.data),$e(this,Gn,void 0)}},$x=function(e){const n=se(this,Pt,"m",Lx).call(this,e);switch($e(this,Ol,n),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const s=e.data.delta;if(s.step_details&&s.step_details.type=="tool_calls"&&s.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const l of s.step_details.tool_calls)l.index==se(this,Xd,"f")?this._emit("toolCallDelta",l,n.step_details.tool_calls[l.index]):(se(this,_n,"f")&&this._emit("toolCallDone",se(this,_n,"f")),$e(this,Xd,l.index),$e(this,_n,n.step_details.tool_calls[l.index]),se(this,_n,"f")&&this._emit("toolCallCreated",se(this,_n,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":$e(this,Ol,void 0),e.data.step_details.type=="tool_calls"&&se(this,_n,"f")&&(this._emit("toolCallDone",se(this,_n,"f")),$e(this,_n,void 0)),this._emit("runStepDone",e.data,n);break}},Ix=function(e){se(this,dg,"f").push(e),this._emit("event",e)},Lx=function(e){switch(e.event){case"thread.run.step.created":return se(this,lr,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=se(this,lr,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let s=e.data;if(s.delta){const a=gi.accumulateDelta(n,s.delta);se(this,lr,"f")[e.data.id]=a}return se(this,lr,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":se(this,lr,"f")[e.data.id]=e.data;break}if(se(this,lr,"f")[e.data.id])return se(this,lr,"f")[e.data.id];throw new Error("No snapshot available")},zx=function(e,n){let s=[];switch(e.event){case"thread.message.created":return[e.data,s];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let a=e.data;if(a.delta.content)for(const l of a.delta.content)if(l.index in n.content){let c=n.content[l.index];n.content[l.index]=se(this,Pt,"m",Bx).call(this,l,c)}else n.content[l.index]=l,s.push(l);return[n,s];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,s];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Bx=function(e,n){return gi.accumulateDelta(n,e)},Px=function(e){switch($e(this,_d,e.data),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":$e(this,yi,e.data),se(this,_n,"f")&&(this._emit("toolCallDone",se(this,_n,"f")),$e(this,_n,void 0));break}};let ay=class extends Ne{constructor(){super(...arguments),this.steps=new uA(this._client)}create(e,n,s){const{include:a,...l}=n;return this._client.post(ye`/threads/${e}/runs`,{query:{include:a},body:l,...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers]),stream:n.stream??!1})}retrieve(e,n,s){const{thread_id:a}=n;return this._client.get(ye`/threads/${a}/runs/${e}`,{...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}update(e,n,s){const{thread_id:a,...l}=n;return this._client.post(ye`/threads/${a}/runs/${e}`,{body:l,...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e,n={},s){return this._client.getAPIList(ye`/threads/${e}/runs`,Et,{query:n,...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}cancel(e,n,s){const{thread_id:a}=n;return this._client.post(ye`/threads/${a}/runs/${e}/cancel`,{...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async createAndPoll(e,n,s){const a=await this.create(e,n,s);return await this.poll(a.id,{thread_id:e},s)}createAndStream(e,n,s){return Rl.createAssistantStream(e,this._client.beta.threads.runs,n,s)}async poll(e,n,s){const a=Se([s?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":s?.pollIntervalMs?.toString()??void 0}]);for(;;){const{data:l,response:c}=await this.retrieve(e,n,{...s,headers:{...s?.headers,...a}}).withResponse();switch(l.status){case"queued":case"in_progress":case"cancelling":let d=5e3;if(s?.pollIntervalMs)d=s.pollIntervalMs;else{const h=c.headers.get("openai-poll-after-ms");if(h){const f=parseInt(h);isNaN(f)||(d=f)}}await ic(d);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return l}}}stream(e,n,s){return Rl.createAssistantStream(e,this._client.beta.threads.runs,n,s)}submitToolOutputs(e,n,s){const{thread_id:a,...l}=n;return this._client.post(ye`/threads/${a}/runs/${e}/submit_tool_outputs`,{body:l,...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers]),stream:n.stream??!1})}async submitToolOutputsAndPoll(e,n,s){const a=await this.submitToolOutputs(e,n,s);return await this.poll(a.id,n,s)}submitToolOutputsStream(e,n,s){return Rl.createToolAssistantStream(e,this._client.beta.threads.runs,n,s)}};ay.Steps=uA;class wf extends Ne{constructor(){super(...arguments),this.runs=new ay(this._client),this.messages=new cA(this._client)}create(e={},n){return this._client.post("/threads",{body:e,...n,headers:Se([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(e,n){return this._client.get(ye`/threads/${e}`,{...n,headers:Se([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(e,n,s){return this._client.post(ye`/threads/${e}`,{body:n,...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}delete(e,n){return this._client.delete(ye`/threads/${e}`,{...n,headers:Se([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:Se([{"OpenAI-Beta":"assistants=v2"},n?.headers]),stream:e.stream??!1})}async createAndRunPoll(e,n){const s=await this.createAndRun(e,n);return await this.runs.poll(s.id,{thread_id:s.thread_id},n)}createAndRunStream(e,n){return Rl.createThreadAssistantStream(e,this._client.beta.threads,n)}}wf.Runs=ay;wf.Messages=cA;class Ja extends Ne{constructor(){super(...arguments),this.realtime=new bf(this._client),this.chatkit=new _f(this._client),this.assistants=new sA(this._client),this.threads=new wf(this._client)}}Ja.Realtime=bf;Ja.ChatKit=_f;Ja.Assistants=sA;Ja.Threads=wf;class dA extends Ne{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}class fA extends Ne{retrieve(e,n,s){const{container_id:a}=n;return this._client.get(ye`/containers/${a}/files/${e}/content`,{...s,headers:Se([{Accept:"application/binary"},s?.headers]),__binaryResponse:!0})}}let oy=class extends Ne{constructor(){super(...arguments),this.content=new fA(this._client)}create(e,n,s){return this._client.post(ye`/containers/${e}/files`,Ei({body:n,...s},this._client))}retrieve(e,n,s){const{container_id:a}=n;return this._client.get(ye`/containers/${a}/files/${e}`,s)}list(e,n={},s){return this._client.getAPIList(ye`/containers/${e}/files`,Et,{query:n,...s})}delete(e,n,s){const{container_id:a}=n;return this._client.delete(ye`/containers/${a}/files/${e}`,{...s,headers:Se([{Accept:"*/*"},s?.headers])})}};oy.Content=fA;class ly extends Ne{constructor(){super(...arguments),this.files=new oy(this._client)}create(e,n){return this._client.post("/containers",{body:e,...n})}retrieve(e,n){return this._client.get(ye`/containers/${e}`,n)}list(e={},n){return this._client.getAPIList("/containers",Et,{query:e,...n})}delete(e,n){return this._client.delete(ye`/containers/${e}`,{...n,headers:Se([{Accept:"*/*"},n?.headers])})}}ly.Files=oy;class hA extends Ne{create(e,n,s){const{include:a,...l}=n;return this._client.post(ye`/conversations/${e}/items`,{query:{include:a},body:l,...s})}retrieve(e,n,s){const{conversation_id:a,...l}=n;return this._client.get(ye`/conversations/${a}/items/${e}`,{query:l,...s})}list(e,n={},s){return this._client.getAPIList(ye`/conversations/${e}/items`,Pd,{query:n,...s})}delete(e,n,s){const{conversation_id:a}=n;return this._client.delete(ye`/conversations/${a}/items/${e}`,s)}}class cy extends Ne{constructor(){super(...arguments),this.items=new hA(this._client)}create(e={},n){return this._client.post("/conversations",{body:e,...n})}retrieve(e,n){return this._client.get(ye`/conversations/${e}`,n)}update(e,n,s){return this._client.post(ye`/conversations/${e}`,{body:n,...s})}delete(e,n){return this._client.delete(ye`/conversations/${e}`,n)}}cy.Items=hA;class mA extends Ne{create(e,n){const s=!!e.encoding_format;let a=s?e.encoding_format:"base64";s&&Bt(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);const l=this._client.post("/embeddings",{body:{...e,encoding_format:a},...n});return s?l:(Bt(this._client).debug("embeddings/decoding base64 embeddings from base64"),l._thenUnwrap(c=>(c&&c.data&&c.data.forEach(d=>{const h=d.embedding;d.embedding=r4(h)}),c)))}}class pA extends Ne{retrieve(e,n,s){const{eval_id:a,run_id:l}=n;return this._client.get(ye`/evals/${a}/runs/${l}/output_items/${e}`,s)}list(e,n,s){const{eval_id:a,...l}=n;return this._client.getAPIList(ye`/evals/${a}/runs/${e}/output_items`,Et,{query:l,...s})}}class uy extends Ne{constructor(){super(...arguments),this.outputItems=new pA(this._client)}create(e,n,s){return this._client.post(ye`/evals/${e}/runs`,{body:n,...s})}retrieve(e,n,s){const{eval_id:a}=n;return this._client.get(ye`/evals/${a}/runs/${e}`,s)}list(e,n={},s){return this._client.getAPIList(ye`/evals/${e}/runs`,Et,{query:n,...s})}delete(e,n,s){const{eval_id:a}=n;return this._client.delete(ye`/evals/${a}/runs/${e}`,s)}cancel(e,n,s){const{eval_id:a}=n;return this._client.post(ye`/evals/${a}/runs/${e}`,s)}}uy.OutputItems=pA;class dy extends Ne{constructor(){super(...arguments),this.runs=new uy(this._client)}create(e,n){return this._client.post("/evals",{body:e,...n})}retrieve(e,n){return this._client.get(ye`/evals/${e}`,n)}update(e,n,s){return this._client.post(ye`/evals/${e}`,{body:n,...s})}list(e={},n){return this._client.getAPIList("/evals",Et,{query:e,...n})}delete(e,n){return this._client.delete(ye`/evals/${e}`,n)}}dy.Runs=uy;let gA=class extends Ne{create(e,n){return this._client.post("/files",Ei({body:e,...n},this._client))}retrieve(e,n){return this._client.get(ye`/files/${e}`,n)}list(e={},n){return this._client.getAPIList("/files",Et,{query:e,...n})}delete(e,n){return this._client.delete(ye`/files/${e}`,n)}content(e,n){return this._client.get(ye`/files/${e}/content`,{...n,headers:Se([{Accept:"application/binary"},n?.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:s=1800*1e3}={}){const a=new Set(["processed","error","deleted"]),l=Date.now();let c=await this.retrieve(e);for(;!c.status||!a.has(c.status);)if(await ic(n),c=await this.retrieve(e),Date.now()-l>s)throw new Qg({message:`Giving up on waiting for file ${e} to finish processing after ${s} milliseconds.`});return c}};class yA extends Ne{}let vA=class extends Ne{run(e,n){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...n})}validate(e,n){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...n})}};class fy extends Ne{constructor(){super(...arguments),this.graders=new vA(this._client)}}fy.Graders=vA;class bA extends Ne{create(e,n,s){return this._client.getAPIList(ye`/fine_tuning/checkpoints/${e}/permissions`,vf,{body:n,method:"post",...s})}retrieve(e,n={},s){return this._client.get(ye`/fine_tuning/checkpoints/${e}/permissions`,{query:n,...s})}delete(e,n,s){const{fine_tuned_model_checkpoint:a}=n;return this._client.delete(ye`/fine_tuning/checkpoints/${a}/permissions/${e}`,s)}}let hy=class extends Ne{constructor(){super(...arguments),this.permissions=new bA(this._client)}};hy.Permissions=bA;class _A extends Ne{list(e,n={},s){return this._client.getAPIList(ye`/fine_tuning/jobs/${e}/checkpoints`,Et,{query:n,...s})}}class my extends Ne{constructor(){super(...arguments),this.checkpoints=new _A(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(ye`/fine_tuning/jobs/${e}`,n)}list(e={},n){return this._client.getAPIList("/fine_tuning/jobs",Et,{query:e,...n})}cancel(e,n){return this._client.post(ye`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},s){return this._client.getAPIList(ye`/fine_tuning/jobs/${e}/events`,Et,{query:n,...s})}pause(e,n){return this._client.post(ye`/fine_tuning/jobs/${e}/pause`,n)}resume(e,n){return this._client.post(ye`/fine_tuning/jobs/${e}/resume`,n)}}my.Checkpoints=_A;class Za extends Ne{constructor(){super(...arguments),this.methods=new yA(this._client),this.jobs=new my(this._client),this.checkpoints=new hy(this._client),this.alpha=new fy(this._client)}}Za.Methods=yA;Za.Jobs=my;Za.Checkpoints=hy;Za.Alpha=fy;class wA extends Ne{}class py extends Ne{constructor(){super(...arguments),this.graderModels=new wA(this._client)}}py.GraderModels=wA;class xA extends Ne{createVariation(e,n){return this._client.post("/images/variations",Ei({body:e,...n},this._client))}edit(e,n){return this._client.post("/images/edits",Ei({body:e,...n,stream:e.stream??!1},this._client))}generate(e,n){return this._client.post("/images/generations",{body:e,...n,stream:e.stream??!1})}}class SA extends Ne{retrieve(e,n){return this._client.get(ye`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",vf,e)}delete(e,n){return this._client.delete(ye`/models/${e}`,n)}}class EA extends Ne{create(e,n){return this._client.post("/moderations",{body:e,...n})}}class CA extends Ne{accept(e,n,s){return this._client.post(ye`/realtime/calls/${e}/accept`,{body:n,...s,headers:Se([{Accept:"*/*"},s?.headers])})}hangup(e,n){return this._client.post(ye`/realtime/calls/${e}/hangup`,{...n,headers:Se([{Accept:"*/*"},n?.headers])})}refer(e,n,s){return this._client.post(ye`/realtime/calls/${e}/refer`,{body:n,...s,headers:Se([{Accept:"*/*"},s?.headers])})}reject(e,n={},s){return this._client.post(ye`/realtime/calls/${e}/reject`,{body:n,...s,headers:Se([{Accept:"*/*"},s?.headers])})}}class AA extends Ne{create(e,n){return this._client.post("/realtime/client_secrets",{body:e,...n})}}class xf extends Ne{constructor(){super(...arguments),this.clientSecrets=new AA(this._client),this.calls=new CA(this._client)}}xf.ClientSecrets=AA;xf.Calls=CA;function i4(t,e){return!e||!o4(e)?{...t,output_parsed:null,output:t.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(s=>({...s,parsed:null}))}:n)}:TA(t,e)}function TA(t,e){const n=t.output.map(a=>{if(a.type==="function_call")return{...a,parsed_arguments:u4(e,a)};if(a.type==="message"){const l=a.content.map(c=>c.type==="output_text"?{...c,parsed:a4(e,c.text)}:c);return{...a,content:l}}return a}),s=Object.assign({},t,{output:n});return Object.getOwnPropertyDescriptor(t,"output_text")||fg(s),Object.defineProperty(s,"output_parsed",{enumerable:!0,get(){for(const a of s.output)if(a.type==="message"){for(const l of a.content)if(l.type==="output_text"&&l.parsed!==null)return l.parsed}return null}}),s}function a4(t,e){return t.text?.format?.type!=="json_schema"?null:"$parseRaw"in t.text?.format?(t.text?.format).$parseRaw(e):JSON.parse(e)}function o4(t){return!!ey(t.text?.format)}function l4(t){return t?.$brand==="auto-parseable-tool"}function c4(t,e){return t.find(n=>n.type==="function"&&n.name===e)}function u4(t,e){const n=c4(t.tools??[],e.name);return{...e,...e,parsed_arguments:l4(n)?n.$parseRaw(e.arguments):n?.strict?JSON.parse(e.arguments):null}}function fg(t){const e=[];for(const n of t.output)if(n.type==="message")for(const s of n.content)s.type==="output_text"&&e.push(s.text);t.output_text=e.join("")}var Aa,sd,js,id,qx,Hx,Vx,Fx;class gy extends ny{constructor(e){super(),Aa.add(this),sd.set(this,void 0),js.set(this,void 0),id.set(this,void 0),$e(this,sd,e)}static createResponse(e,n,s){const a=new gy(n);return a._run(()=>a._createOrRetrieveResponse(e,n,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createOrRetrieveResponse(e,n,s){const a=s?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),se(this,Aa,"m",qx).call(this);let l,c=null;"response_id"in n?(l=await e.responses.retrieve(n.response_id,{stream:!0},{...s,signal:this.controller.signal,stream:!0}),c=n.starting_after??null):l=await e.responses.create({...n,stream:!0},{...s,signal:this.controller.signal}),this._connected();for await(const d of l)se(this,Aa,"m",Hx).call(this,d,c);if(l.controller.signal?.aborted)throw new $n;return se(this,Aa,"m",Vx).call(this)}[(sd=new WeakMap,js=new WeakMap,id=new WeakMap,Aa=new WeakSet,qx=function(){this.ended||$e(this,js,void 0)},Hx=function(n,s){if(this.ended)return;const a=(c,d)=>{(s==null||d.sequence_number>s)&&this._emit(c,d)},l=se(this,Aa,"m",Fx).call(this,n);switch(a("event",n),n.type){case"response.output_text.delta":{const c=l.output[n.output_index];if(!c)throw new je(`missing output at index ${n.output_index}`);if(c.type==="message"){const d=c.content[n.content_index];if(!d)throw new je(`missing content at index ${n.content_index}`);if(d.type!=="output_text")throw new je(`expected content to be 'output_text', got ${d.type}`);a("response.output_text.delta",{...n,snapshot:d.text})}break}case"response.function_call_arguments.delta":{const c=l.output[n.output_index];if(!c)throw new je(`missing output at index ${n.output_index}`);c.type==="function_call"&&a("response.function_call_arguments.delta",{...n,snapshot:c.arguments});break}default:a(n.type,n);break}},Vx=function(){if(this.ended)throw new je("stream has ended, this shouldn't happen");const n=se(this,js,"f");if(!n)throw new je("request ended without sending any events");$e(this,js,void 0);const s=d4(n,se(this,sd,"f"));return $e(this,id,s),s},Fx=function(n){let s=se(this,js,"f");if(!s){if(n.type!=="response.created")throw new je(`When snapshot hasn't been set yet, expected 'response.created' event, got ${n.type}`);return s=$e(this,js,n.response),s}switch(n.type){case"response.output_item.added":{s.output.push(n.item);break}case"response.content_part.added":{const a=s.output[n.output_index];if(!a)throw new je(`missing output at index ${n.output_index}`);const l=a.type,c=n.part;l==="message"&&c.type!=="reasoning_text"?a.content.push(c):l==="reasoning"&&c.type==="reasoning_text"&&(a.content||(a.content=[]),a.content.push(c));break}case"response.output_text.delta":{const a=s.output[n.output_index];if(!a)throw new je(`missing output at index ${n.output_index}`);if(a.type==="message"){const l=a.content[n.content_index];if(!l)throw new je(`missing content at index ${n.content_index}`);if(l.type!=="output_text")throw new je(`expected content to be 'output_text', got ${l.type}`);l.text+=n.delta}break}case"response.function_call_arguments.delta":{const a=s.output[n.output_index];if(!a)throw new je(`missing output at index ${n.output_index}`);a.type==="function_call"&&(a.arguments+=n.delta);break}case"response.reasoning_text.delta":{const a=s.output[n.output_index];if(!a)throw new je(`missing output at index ${n.output_index}`);if(a.type==="reasoning"){const l=a.content?.[n.content_index];if(!l)throw new je(`missing content at index ${n.content_index}`);if(l.type!=="reasoning_text")throw new je(`expected content to be 'reasoning_text', got ${l.type}`);l.text+=n.delta}break}case"response.completed":{$e(this,js,n.response);break}}return s},Symbol.asyncIterator)](){const e=[],n=[];let s=!1;return this.on("event",a=>{const l=n.shift();l?l.resolve(a):e.push(a)}),this.on("end",()=>{s=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{s=!0;for(const l of n)l.reject(a);n.length=0}),this.on("error",a=>{s=!0;for(const l of n)l.reject(a);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((l,c)=>n.push({resolve:l,reject:c})).then(l=>l?{value:l,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=se(this,id,"f");if(!e)throw new je("stream ended without producing a ChatCompletion");return e}}function d4(t,e){return i4(t,e)}class NA extends Ne{list(e,n={},s){return this._client.getAPIList(ye`/responses/${e}/input_items`,Et,{query:n,...s})}}class OA extends Ne{count(e={},n){return this._client.post("/responses/input_tokens",{body:e,...n})}}class Sf extends Ne{constructor(){super(...arguments),this.inputItems=new NA(this._client),this.inputTokens=new OA(this._client)}create(e,n){return this._client.post("/responses",{body:e,...n,stream:e.stream??!1})._thenUnwrap(s=>("object"in s&&s.object==="response"&&fg(s),s))}retrieve(e,n={},s){return this._client.get(ye`/responses/${e}`,{query:n,...s,stream:n?.stream??!1})._thenUnwrap(a=>("object"in a&&a.object==="response"&&fg(a),a))}delete(e,n){return this._client.delete(ye`/responses/${e}`,{...n,headers:Se([{Accept:"*/*"},n?.headers])})}parse(e,n){return this._client.responses.create(e,n)._thenUnwrap(s=>TA(s,e))}stream(e,n){return gy.createResponse(this._client,e,n)}cancel(e,n){return this._client.post(ye`/responses/${e}/cancel`,n)}}Sf.InputItems=NA;Sf.InputTokens=OA;class RA extends Ne{create(e,n,s){return this._client.post(ye`/uploads/${e}/parts`,Ei({body:n,...s},this._client))}}class yy extends Ne{constructor(){super(...arguments),this.parts=new RA(this._client)}create(e,n){return this._client.post("/uploads",{body:e,...n})}cancel(e,n){return this._client.post(ye`/uploads/${e}/cancel`,n)}complete(e,n,s){return this._client.post(ye`/uploads/${e}/complete`,{body:n,...s})}}yy.Parts=RA;const f4=async t=>{const e=await Promise.allSettled(t),n=e.filter(a=>a.status==="rejected");if(n.length){for(const a of n)console.error(a.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const s=[];for(const a of e)a.status==="fulfilled"&&s.push(a.value);return s};class jA extends Ne{create(e,n,s){return this._client.post(ye`/vector_stores/${e}/file_batches`,{body:n,...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}retrieve(e,n,s){const{vector_store_id:a}=n;return this._client.get(ye`/vector_stores/${a}/file_batches/${e}`,{...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}cancel(e,n,s){const{vector_store_id:a}=n;return this._client.post(ye`/vector_stores/${a}/file_batches/${e}/cancel`,{...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async createAndPoll(e,n,s){const a=await this.create(e,n);return await this.poll(e,a.id,s)}listFiles(e,n,s){const{vector_store_id:a,...l}=n;return this._client.getAPIList(ye`/vector_stores/${a}/file_batches/${e}/files`,Et,{query:l,...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async poll(e,n,s){const a=Se([s?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":s?.pollIntervalMs?.toString()??void 0}]);for(;;){const{data:l,response:c}=await this.retrieve(n,{vector_store_id:e},{...s,headers:a}).withResponse();switch(l.status){case"in_progress":let d=5e3;if(s?.pollIntervalMs)d=s.pollIntervalMs;else{const h=c.headers.get("openai-poll-after-ms");if(h){const f=parseInt(h);isNaN(f)||(d=f)}}await ic(d);break;case"failed":case"cancelled":case"completed":return l}}}async uploadAndPoll(e,{files:n,fileIds:s=[]},a){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const l=a?.maxConcurrency??5,c=Math.min(l,n.length),d=this._client,h=n.values(),f=[...s];async function g(v){for(let b of v){const x=await d.files.create({file:b,purpose:"assistants"},a);f.push(x.id)}}const p=Array(c).fill(h).map(g);return await f4(p),await this.createAndPoll(e,{file_ids:f})}}class kA extends Ne{create(e,n,s){return this._client.post(ye`/vector_stores/${e}/files`,{body:n,...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}retrieve(e,n,s){const{vector_store_id:a}=n;return this._client.get(ye`/vector_stores/${a}/files/${e}`,{...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}update(e,n,s){const{vector_store_id:a,...l}=n;return this._client.post(ye`/vector_stores/${a}/files/${e}`,{body:l,...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e,n={},s){return this._client.getAPIList(ye`/vector_stores/${e}/files`,Et,{query:n,...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}delete(e,n,s){const{vector_store_id:a}=n;return this._client.delete(ye`/vector_stores/${a}/files/${e}`,{...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async createAndPoll(e,n,s){const a=await this.create(e,n,s);return await this.poll(e,a.id,s)}async poll(e,n,s){const a=Se([s?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":s?.pollIntervalMs?.toString()??void 0}]);for(;;){const l=await this.retrieve(n,{vector_store_id:e},{...s,headers:a}).withResponse(),c=l.data;switch(c.status){case"in_progress":let d=5e3;if(s?.pollIntervalMs)d=s.pollIntervalMs;else{const h=l.response.headers.get("openai-poll-after-ms");if(h){const f=parseInt(h);isNaN(f)||(d=f)}}await ic(d);break;case"failed":case"completed":return c}}}async upload(e,n,s){const a=await this._client.files.create({file:n,purpose:"assistants"},s);return this.create(e,{file_id:a.id},s)}async uploadAndPoll(e,n,s){const a=await this.upload(e,n,s);return await this.poll(e,a.id,s)}content(e,n,s){const{vector_store_id:a}=n;return this._client.getAPIList(ye`/vector_stores/${a}/files/${e}/content`,vf,{...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}class Ef extends Ne{constructor(){super(...arguments),this.files=new kA(this._client),this.fileBatches=new jA(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:Se([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(e,n){return this._client.get(ye`/vector_stores/${e}`,{...n,headers:Se([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(e,n,s){return this._client.post(ye`/vector_stores/${e}`,{body:n,...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e={},n){return this._client.getAPIList("/vector_stores",Et,{query:e,...n,headers:Se([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}delete(e,n){return this._client.delete(ye`/vector_stores/${e}`,{...n,headers:Se([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}search(e,n,s){return this._client.getAPIList(ye`/vector_stores/${e}/search`,vf,{body:n,method:"post",...s,headers:Se([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}Ef.Files=kA;Ef.FileBatches=jA;class MA extends Ne{create(e,n){return this._client.post("/videos",Rx({body:e,...n},this._client))}retrieve(e,n){return this._client.get(ye`/videos/${e}`,n)}list(e={},n){return this._client.getAPIList("/videos",Pd,{query:e,...n})}delete(e,n){return this._client.delete(ye`/videos/${e}`,n)}downloadContent(e,n={},s){return this._client.get(ye`/videos/${e}/content`,{query:n,...s,headers:Se([{Accept:"application/binary"},s?.headers]),__binaryResponse:!0})}remix(e,n,s){return this._client.post(ye`/videos/${e}/remix`,Rx({body:n,...s},this._client))}}var ja,DA,wd;class UA extends Ne{constructor(){super(...arguments),ja.add(this)}async unwrap(e,n,s=this._client.webhookSecret,a=300){return await this.verifySignature(e,n,s,a),JSON.parse(e)}async verifySignature(e,n,s=this._client.webhookSecret,a=300){if(typeof crypto>"u"||typeof crypto.subtle.importKey!="function"||typeof crypto.subtle.verify!="function")throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");se(this,ja,"m",DA).call(this,s);const l=Se([n]).values,c=se(this,ja,"m",wd).call(this,l,"webhook-signature"),d=se(this,ja,"m",wd).call(this,l,"webhook-timestamp"),h=se(this,ja,"m",wd).call(this,l,"webhook-id"),f=parseInt(d,10);if(isNaN(f))throw new hl("Invalid webhook timestamp format");const g=Math.floor(Date.now()/1e3);if(g-f>a)throw new hl("Webhook timestamp is too old");if(f>g+a)throw new hl("Webhook timestamp is too new");const p=c.split(" ").map(w=>w.startsWith("v1,")?w.substring(3):w),v=s.startsWith("whsec_")?Buffer.from(s.replace("whsec_",""),"base64"):Buffer.from(s,"utf-8"),b=h?`${h}.${d}.${e}`:`${d}.${e}`,x=await crypto.subtle.importKey("raw",v,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(const w of p)try{const S=Buffer.from(w,"base64");if(await crypto.subtle.verify("HMAC",x,S,new TextEncoder().encode(b)))return}catch{continue}throw new hl("The given webhook signature does not match the expected signature")}}ja=new WeakSet,DA=function(e){if(typeof e!="string"||e.length===0)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},wd=function(e,n){if(!e)throw new Error("Headers are required");const s=e.get(n);if(s==null)throw new Error(`Missing required header: ${n}`);return s};var hg,vy,xd,$A;class Pe{constructor({baseURL:e=Ca("OPENAI_BASE_URL"),apiKey:n=Ca("OPENAI_API_KEY"),organization:s=Ca("OPENAI_ORG_ID")??null,project:a=Ca("OPENAI_PROJECT_ID")??null,webhookSecret:l=Ca("OPENAI_WEBHOOK_SECRET")??null,...c}={}){if(hg.add(this),xd.set(this,void 0),this.completions=new dA(this),this.chat=new iy(this),this.embeddings=new mA(this),this.files=new gA(this),this.images=new xA(this),this.audio=new oc(this),this.moderations=new EA(this),this.models=new SA(this),this.fineTuning=new Za(this),this.graders=new py(this),this.vectorStores=new Ef(this),this.webhooks=new UA(this),this.beta=new Ja(this),this.batches=new rA(this),this.uploads=new yy(this),this.responses=new Sf(this),this.realtime=new xf(this),this.conversations=new cy(this),this.evals=new dy(this),this.containers=new ly(this),this.videos=new MA(this),n===void 0)throw new je("Missing credentials. Please pass an `apiKey`, or set the `OPENAI_API_KEY` environment variable.");const d={apiKey:n,organization:s,project:a,webhookSecret:l,...c,baseURL:e||"https://api.openai.com/v1"};if(!d.dangerouslyAllowBrowser&&hz())throw new je(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=d.baseURL,this.timeout=d.timeout??vy.DEFAULT_TIMEOUT,this.logger=d.logger??console;const h="warn";this.logLevel=h,this.logLevel=Nx(d.logLevel,"ClientOptions.logLevel",this)??Nx(Ca("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??h,this.fetchOptions=d.fetchOptions,this.maxRetries=d.maxRetries??2,this.fetch=d.fetch??vz(),$e(this,xd,_z),this._options=d,this.apiKey=typeof n=="string"?n:"Missing Key",this.organization=s,this.project=a,this.webhookSecret=l}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){}async authHeaders(e){return Se([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(e){return Az(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${Oa}`}defaultIdempotencyKey(){return`stainless-node-retry-${iC()}`}makeStatusError(e,n,s,a){return qt.generate(e,n,s,a)}async _callApiKey(){const e=this._options.apiKey;if(typeof e!="function")return!1;let n;try{n=await e()}catch(s){throw s instanceof je?s:new je(`Failed to get token from 'apiKey' function: ${s.message}`,{cause:s})}if(typeof n!="string"||!n)throw new je(`Expected 'apiKey' function argument to return a string but it returned ${n}`);return this.apiKey=n,!0}buildURL(e,n,s){const a=!se(this,hg,"m",$A).call(this)&&s||this.baseURL,l=lz(e)?new URL(e):new URL(a+(a.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),c=this.defaultQuery();return cz(c)||(n={...c,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(l.search=this.stringifyQuery(n)),l.toString()}async prepareOptions(e){await this._callApiKey()}async prepareRequest(e,{url:n,options:s}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,s){return this.request(Promise.resolve(s).then(a=>({method:e,path:n,...a})))}request(e,n=null){return new yf(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,s){const a=await e,l=a.maxRetries??this.maxRetries;n==null&&(n=l),await this.prepareOptions(a);const{req:c,url:d,timeout:h}=await this.buildRequest(a,{retryCount:l-n});await this.prepareRequest(c,{url:d,options:a});const f="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),g=s===void 0?"":`, retryOf: ${s}`,p=Date.now();if(Bt(this).debug(`[${f}] sending request`,ui({retryOfRequestLogID:s,method:a.method,url:d,options:a,headers:c.headers})),a.signal?.aborted)throw new $n;const v=new AbortController,b=await this.fetchWithTimeout(d,c,h,v).catch(tg),x=Date.now();if(b instanceof globalThis.Error){const A=`retrying, ${n} attempts remaining`;if(a.signal?.aborted)throw new $n;const N=eg(b)||/timed? ?out/i.test(String(b)+("cause"in b?String(b.cause):""));if(n)return Bt(this).info(`[${f}] connection ${N?"timed out":"failed"} - ${A}`),Bt(this).debug(`[${f}] connection ${N?"timed out":"failed"} (${A})`,ui({retryOfRequestLogID:s,url:d,durationMs:x-p,message:b.message})),this.retryRequest(a,n,s??f);throw Bt(this).info(`[${f}] connection ${N?"timed out":"failed"} - error; no more retries left`),Bt(this).debug(`[${f}] connection ${N?"timed out":"failed"} (error; no more retries left)`,ui({retryOfRequestLogID:s,url:d,durationMs:x-p,message:b.message})),N?new Qg:new pf({cause:b})}const w=[...b.headers.entries()].filter(([A])=>A==="x-request-id").map(([A,N])=>", "+A+": "+JSON.stringify(N)).join(""),S=`[${f}${g}${w}] ${c.method} ${d} ${b.ok?"succeeded":"failed"} with status ${b.status} in ${x-p}ms`;if(!b.ok){const A=await this.shouldRetry(b);if(n&&A){const M=`retrying, ${n} attempts remaining`;return await bz(b.body),Bt(this).info(`${S} - ${M}`),Bt(this).debug(`[${f}] response error (${M})`,ui({retryOfRequestLogID:s,url:b.url,status:b.status,headers:b.headers,durationMs:x-p})),this.retryRequest(a,n,s??f,b.headers)}const N=A?"error; no more retries left":"error; not retryable";Bt(this).info(`${S} - ${N}`);const E=await b.text().catch(M=>tg(M).message),C=fz(E),O=C?void 0:E;throw Bt(this).debug(`[${f}] response error (${N})`,ui({retryOfRequestLogID:s,url:b.url,status:b.status,headers:b.headers,message:O,durationMs:Date.now()-p})),this.makeStatusError(b.status,C,O,b.headers)}return Bt(this).info(S),Bt(this).debug(`[${f}] response start`,ui({retryOfRequestLogID:s,url:b.url,status:b.status,headers:b.headers,durationMs:x-p})),{response:b,options:a,controller:v,requestLogID:f,retryOfRequestLogID:s,startTime:p}}getAPIList(e,n,s){return this.requestAPIList(n,{method:"get",path:e,...s})}requestAPIList(e,n){const s=this.makeRequest(n,null,void 0);return new Uz(this,s,e)}async fetchWithTimeout(e,n,s,a){const{signal:l,method:c,...d}=n||{};l&&l.addEventListener("abort",()=>a.abort());const h=setTimeout(()=>a.abort(),s),f=globalThis.ReadableStream&&d.body instanceof globalThis.ReadableStream||typeof d.body=="object"&&d.body!==null&&Symbol.asyncIterator in d.body,g={signal:a.signal,...f?{duplex:"half"}:{},method:"GET",...d};c&&(g.method=c.toUpperCase());try{return await this.fetch.call(void 0,e,g)}finally{clearTimeout(h)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,s,a){let l;const c=a?.get("retry-after-ms");if(c){const h=parseFloat(c);Number.isNaN(h)||(l=h)}const d=a?.get("retry-after");if(d&&!l){const h=parseFloat(d);Number.isNaN(h)?l=Date.parse(d)-Date.now():l=h*1e3}if(!(l&&0<=l&&l<60*1e3)){const h=e.maxRetries??this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(n,h)}return await ic(l),this.makeRequest(e,n-1,s)}calculateDefaultRetryTimeoutMillis(e,n){const l=n-e,c=Math.min(.5*Math.pow(2,l),8),d=1-Math.random()*.25;return c*d*1e3}async buildRequest(e,{retryCount:n=0}={}){const s={...e},{method:a,path:l,query:c,defaultBaseURL:d}=s,h=this.buildURL(l,c,d);"timeout"in s&&dz("timeout",s.timeout),s.timeout=s.timeout??this.timeout;const{bodyHeaders:f,body:g}=this.buildBody({options:s}),p=await this.buildHeaders({options:e,method:a,bodyHeaders:f,retryCount:n});return{req:{method:a,headers:p,...s.signal&&{signal:s.signal},...globalThis.ReadableStream&&g instanceof globalThis.ReadableStream&&{duplex:"half"},...g&&{body:g},...this.fetchOptions??{},...s.fetchOptions??{}},url:h,timeout:s.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:s,retryCount:a}){let l={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=e.idempotencyKey);const c=Se([l,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(a),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...yz(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(e),this._options.defaultHeaders,s,e.headers]);return this.validateHeaders(c),c.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const s=Se([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&s.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:vC(e)}:se(this,xd,"f").call(this,{body:e,headers:s})}}vy=Pe,xd=new WeakMap,hg=new WeakSet,$A=function(){return this.baseURL!=="https://api.openai.com/v1"};Pe.OpenAI=vy;Pe.DEFAULT_TIMEOUT=6e5;Pe.OpenAIError=je;Pe.APIError=qt;Pe.APIConnectionError=pf;Pe.APIConnectionTimeoutError=Qg;Pe.APIUserAbortError=$n;Pe.NotFoundError=cC;Pe.ConflictError=uC;Pe.RateLimitError=fC;Pe.BadRequestError=aC;Pe.AuthenticationError=oC;Pe.InternalServerError=hC;Pe.PermissionDeniedError=lC;Pe.UnprocessableEntityError=dC;Pe.InvalidWebhookSignatureError=hl;Pe.toFile=Bz;Pe.Completions=dA;Pe.Chat=iy;Pe.Embeddings=mA;Pe.Files=gA;Pe.Images=xA;Pe.Audio=oc;Pe.Moderations=EA;Pe.Models=SA;Pe.FineTuning=Za;Pe.Graders=py;Pe.VectorStores=Ef;Pe.Webhooks=UA;Pe.Beta=Ja;Pe.Batches=rA;Pe.Uploads=yy;Pe.Responses=Sf;Pe.Realtime=xf;Pe.Conversations=cy;Pe.Evals=dy;Pe.Containers=ly;Pe.Videos=MA;function h4(){const{projectId:t,ep_id:e,setEpId:n,setDeepseekProvider:s,updateEmbodyCache:a,embodyCache:l}=Xr(),[c,d]=j.useState(null),[h,f]=j.useState([]),[g,p]=j.useState(!1),[v,b]=j.useState(""),[x,w]=j.useState("");$s();let S=[];j.useEffect(()=>{t&&(d(""),Me.from("movie_eps").select("*").eq("project_id",t).order("index",{ascending:!0}).then(({data:$,error:Q})=>{if(Q){d(Q.message);return}f($),console.log($)}),Me.from("LLM").select("*").eq("provider_name","deepseek").single().then(({data:$,error:Q})=>{if(Q){d(Q.message);return}s($)}))},[t]);const A=()=>{p(!0)},N=()=>{if(!x.trim()){d("");return}const $=document.createElement("input");$.type="file",$.accept=".json",$.onchange=E,$.click()},E=$=>{const Q=$.target.files[0];if(Q){const B=new FileReader;B.readAsText(Q,"utf-8"),B.onload=G=>{const k=G.target.result;try{const L=JSON.parse(k);console.log(L),q(L)}catch(L){console.error("JSON :",L)}}}},C=$=>{n($),localStorage.setItem("epId",$),Xt.emit("changeEditorMode","shot")},O=()=>{p(!1),b(""),w(""),d(null)},[R,M]=j.useState(!1),I=async($,Q)=>{const B=[...Q,$];let G=[];for(let k of B){let L=S.find(V=>V.name===k);if(L)G.push(L.id);else{const{data:V,error:P}=await Me.from("embodys").insert([{project_id:t,name:k,type:"character"}]).select("id, name,type").single();if(P){d(P.message);return}G.push(V.id),S.push(V)}}return G},q=async $=>{M(!0);try{const{data:Q,error:B}=await Me.from("movie_eps").insert([{project_id:t,title:$.episode_name,description:$.description,index:parseInt(x)}]).select("*").single();if(B)throw B;if($.sc&&Array.isArray($.sc))for(let G=0;G<$.sc.length;G++){const k=$.sc[G],{data:L,error:V}=await Me.from("movie_scs").insert([{ep_id:Q.id,name:k.scene_name,description:k.description,index:G+1}]).select("*").single();if(V){console.error(":",V),M(!1);continue}if(console.log(` ${k.scene_name} `),k.seq)for(let P=0;P<k.seq.length;P++){const H=k.seq[P],{data:D,error:z}=await Me.from("movie_seqs").insert([{sc_id:L.id,name:H.sequence_name,index:P+1}]).select("*").single();if(z){console.error(":",z),M(!1);continue}console.log(` ${H.sequence_name} ${H.shots.length}  ${D.id}`);for(let J=0;J<H.shots.length;J++){const ee=H.shots[J],{data:he,error:pe}=await Me.from("movie_shots").insert([{seq_id:D.id,description:ee.description,index:J+1,prompt:ee.prompt,duration:parseFloat(ee.duration),dialogue:ee.dialogue,embodys:await I(ee.scene,ee.embodys)}]).select("*").single()}}}f([...h,Q]),O(),await a()}catch(Q){d(": "+Q.message)}finally{M(!1)}},K=async()=>{if(await a(),!x.trim()){d("");return}const $=parseInt(x);if(h.find(B=>B.index===$)){d(`${$}`);return}M(!0),d(null);try{let B=!1,G={};if(!B){const L=await(await fetch("./test_story.json",{})).json();console.log("testData:",L),G=L}return}catch(B){d(": "+B.message)}finally{M(!1)}},Y=async $=>{try{const{error:Q}=await Me.from("movie_eps").delete().eq("id",$.id);if(Q)throw Q;f(h.filter(B=>B.id!==$.id))}catch(Q){d(": "+Q.message)}finally{}};return _.jsxs("div",{className:"ep-editor-container",children:[_.jsx("div",{className:"ep-editor-header",children:_.jsx("button",{className:"add-ep-button",onClick:A,children:"+ "})}),c&&_.jsx("div",{className:"error-message",children:_.jsx("p",{children:c})}),_.jsx("div",{className:"ep-list",children:h.length>0?h.map($=>_.jsxs("div",{className:"ep-card",onClick:()=>C($.id),children:[_.jsx("div",{className:"ep-thumbnail",children:$.pic?_.jsx("img",{src:$.pic,alt:$.title}):_.jsx("span",{children:""})}),_.jsxs("div",{className:"ep-content",children:[_.jsx("h3",{className:"ep-title",children:$.title||`EP ${$.index||""}`}),_.jsx("p",{className:"ep-description",children:$.description||""}),_.jsxs("div",{className:"ep-info",children:[_.jsxs("span",{children:["",$.index||"?",""]}),_.jsx("span",{children:$.created_at?new Date($.created_at).toLocaleDateString():""})]})]}),_.jsx("div",{className:"delete-ep-button",children:_.jsx("button",{onClick:Q=>{Q.stopPropagation(),Y($)},children:""})})]},$.id)):_.jsxs("div",{className:"empty-state",children:[_.jsx("h3",{children:""}),_.jsx("p",{children:'""'})]})}),g&&_.jsx("div",{className:"modal-overlay",onClick:O,children:_.jsxs("div",{className:"modal-content",onClick:$=>$.stopPropagation(),children:[_.jsxs("div",{className:"modal-header",children:[_.jsx("h3",{children:""}),_.jsx("button",{className:"close-button",onClick:O,children:""})]}),c&&_.jsx("div",{className:"error-message",children:_.jsx("p",{children:c})}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"ep-number",children:" *"}),_.jsx("input",{id:"ep-number",type:"number",value:x,onChange:$=>{const Q=parseInt($.target.value),B=h.find(G=>G.index===Q);console.log(B),B!=null?d(`${Q}`):d(null),w($.target.value)},placeholder:"",min:"1",required:!0})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"ep-description",children:" *"}),_.jsx("textarea",{id:"ep-description",value:v,onChange:$=>b($.target.value),placeholder:"",rows:"18"})]}),_.jsxs("div",{className:"modal-actions",children:[_.jsx("button",{className:"cancel-button",onClick:N,disabled:R,children:""}),_.jsx("button",{className:"cancel-button",onClick:O,children:""}),_.jsx("button",{className:"save-button",onClick:K,disabled:R,children:R?"...":""})]})]})})]})}function m4(){const{projectId:t,setProjectId:e}=Xr(),[n,s]=j.useState(""),[a,l]=j.useState("script"),[c,d]=j.useState(""),[h,f]=j.useState(null),g=$s();return j.useEffect(()=>{t&&(Xt.emit("StartEditorMode"),Me.from("projects").select("*").eq("id",t).single().then(({data:p,error:v})=>{v?(console.error(":",v),f(""),d("// : ")):(console.log(":",p),s(p.name||""))}),Xt.on("changeEditorMode",p=>{l(p)}),Me.from("embodys").select("*").eq("project_id",t).then(({data:p,error:v})=>{v&&(console.error(":",v),f(""),d("// : "))}))},[t]),_.jsxs("div",{className:"editor-container",children:[h&&_.jsx("div",{className:"error-message",children:_.jsx("p",{children:h})}),_.jsxs("div",{className:"editor-header",children:[_.jsx("div",{className:"project_name",onClick:()=>{g("/dashboard"),Xt.emit("EndEditorMode"),e(null)},children:_.jsxs("h3",{children:["< ",n]})}),_.jsxs("div",{className:"editor-nav",children:[_.jsx("div",{className:`editor-nav-item ${a==="script"?"editor-nav-item-selected":""}`,onClick:()=>l("script"),children:""}),_.jsx("div",{className:`editor-nav-item ${a==="shot"?"editor-nav-item-selected":""}`,onClick:()=>l("shot"),children:""}),_.jsx("div",{className:`editor-nav-item ${a==="edit"?"editor-nav-item-selected":""}`,onClick:()=>l("edit"),children:""})]})]}),_.jsxs("div",{className:"editor-content",children:[a==="script"&&_.jsx(h4,{}),a==="shot"&&_.jsx(Vk,{}),a==="edit"&&_.jsx(az,{})]})]})}function p4(){const{projectId:t}=Xr(),[e,n]=j.useState([]),[s,a]=j.useState([]),[l,c]=j.useState([]),[d,h]=j.useState(""),[f,g]=j.useState("all"),[p,v]=j.useState(!0),[b,x]=j.useState(""),[w,S]=j.useState([]),[A,N]=j.useState(""),E=j.useRef(null),[C,O]=j.useState(null),[R,M]=j.useState({type:"",name:"",pic:"",description:""}),[I,q]=j.useState(!1),[K,Y]=j.useState(!1),[$,Q]=j.useState({project_id:t,type:"scene",name:"",prompt:"",description:"",pic:""}),[B,G]=j.useState(null),[k,L]=j.useState("");j.useEffect(()=>{if(!t){console.log("ID Embody");return}console.log("",t),P()},[t]),j.useEffect(()=>{},[I]);const V=(te,ve)=>{const _e=w.filter(qe=>qe.type===ve);if(d.trim()==="")return _e;const Ie=d.toLowerCase();return _e.filter(qe=>qe.name.toLowerCase().includes(Ie)||qe.description&&qe.description.toLowerCase().includes(Ie))},P=async()=>{if(!t){x("ID Embody"),v(!1);return}v(!0),x("");try{console.log(" ID:",t);const{data:te}=await Me.from("embodys").select("*").eq("project_id",t);S(te||[])}catch(te){console.error(":",te),x("")}finally{v(!1)}},H=te=>{const ve=w.find(_e=>_e.id===te);ve&&(console.log(":",ve),O(te),M({id:ve.id,type:ve.type,name:ve.name||"",pic:ve.pic||"",description:ve.description||"",prompt:ve.prompt||""}))},D=async()=>{if(C)try{console.log(":",C,R);const{error:te}=await Me.from("embodys").update({name:R.name,type:R.type,description:R.description,prompt:R.prompt}).eq("id",C);if(te){console.error(":",te),alert("");return}q(ve=>!ve),alert(""),O(null)}catch(te){console.error(":",te),alert("")}},z=async()=>{try{const te=R.type==="scene"?"":R.type==="character"?"":"",ve=R.name||`${te}`;alert("..."),await new Promise(Ie=>setTimeout(Ie,1e3));let _e="";R.type==="scene"?_e=`${ve}8K`:R.type==="character"?_e=`${ve}8K`:_e=`${ve}3D8K`,M({...R,prompt:_e}),alert("")}catch(te){console.error(":",te),alert("")}},J=()=>{E.current.click(),console.log(":",C)},ee=te=>{const ve=te.target.files[0];ve&&(console.log("Selected file:",ve.name),Me.storage.from("embodys").upload(`${globalData.projectId}/${ve.name}`,ve))},he=async()=>{try{if(!R.prompt){alert("");return}alert("..."),await new Promise(te=>setTimeout(te,2e3)),alert(`
AI`)}catch(te){console.error(":",te),alert("")}},pe=async()=>{if(!$.name.trim()){alert("");return}if(!$.prompt.trim()){alert("");return}if(!$.description.trim()){alert("");return}if(!$.project_id&&($.project_id=globalData.projectId||localStorage.getItem("projectId"),!$.project_id)){alert("ID"),Y(!1);return}try{let te=$.pic,ve="";if(B){const ot=Date.now(),kt=B.name.split(".").pop()||"";ve=`${$.project_id}/${$.type}s/${ot}${kt?"."+kt:""}`,console.log(":",ve);const{data:In,error:Jt}=await Me.storage.from("embodys").upload(ve,B,{cacheControl:"3600",upsert:!1});if(Jt)throw console.error(":",Jt),new Error(": "+Jt.message);const{data:{publicUrl:Ln}}=await Me.storage.from("embodys").getPublicUrl(ve);te=Ln,console.log("URL:",te)}const _e={...$,pic:ve};console.log(":",_e);const{data:Ie,error:qe}=await Me.from("embodys").insert([_e]);if(qe)throw console.error(":",qe),qe;q(ot=>!ot),Y(!1),Q({project_id:globalData.projectId||localStorage.getItem("projectId"),type:"scene",name:"",prompt:"",description:"",pic:""}),G(null),L(""),document.getElementById("embody-file")&&(document.getElementById("embody-file").value=""),alert("")}catch(te){console.error(":",te),alert(""+(te.message||""))}},ae=async(te,ve)=>{if(window.confirm(`${ve==="scene"?"":ve==="character"?"":""}`))try{let _e;switch(ve){case"scene":_e="scenes";break;case"character":_e="characters";break;case"item":_e="items";break;default:return}const{error:Ie}=await Me.from(_e).delete().eq("id",te);if(Ie)throw Ie;ve==="scene"?n(qe=>qe.filter(ot=>ot.id!==te)):ve==="character"?a(qe=>qe.filter(ot=>ot.id!==te)):ve==="item"&&c(qe=>qe.filter(ot=>ot.id!==te)),alert("")}catch(_e){console.error(":",_e),alert("")}},Z=(()=>{const te=w.filter(Ie=>Ie.type==="scene").length,ve=w.filter(Ie=>Ie.type==="character").length,_e=w.filter(Ie=>Ie.type==="item").length;return{scene:te,character:ve,item:_e,all:te+ve+_e}})(),de=V(e,"scene"),ge=V(s,"character"),be=V(l,"item");return _.jsxs("div",{className:"embody-container",children:[_.jsxs("div",{className:"embody-left-panel",children:[_.jsxs("div",{className:"embody-header",children:[_.jsxs("div",{className:"header-left",children:[_.jsx("h2",{children:""}),_.jsxs("p",{className:"total-count",children:[A," -  ",Z.all," "]})]}),_.jsxs("div",{className:"header-right",children:[_.jsx("input",{type:"file",ref:E,style:{display:"none"},onChange:ee}),_.jsx("div",{className:"search-bar",children:_.jsx("input",{type:"text",placeholder:"...",value:d,onChange:te=>h(te.target.value)})})]})]}),_.jsxs("div",{className:"category-filter",children:[_.jsxs("button",{className:`filter-btn ${f==="all"?"active":""}`,onClick:()=>g("all"),children:[" (",Z.all,")"]}),_.jsxs("button",{className:`filter-btn ${f==="scene"?"active":""}`,onClick:()=>g("scene"),children:[" (",Z.scene,")"]}),_.jsxs("button",{className:`filter-btn ${f==="character"?"active":""}`,onClick:()=>g("character"),children:[" (",Z.character,")"]}),_.jsxs("button",{className:`filter-btn ${f==="item"?"active":""}`,onClick:()=>g("item"),children:[" (",Z.item,")"]}),_.jsx("button",{onClick:()=>Y(!0),className:"add-embody-btn",children:""})]}),_.jsx("div",{className:"embody-content",children:p?_.jsxs("div",{className:"loading-container",children:[_.jsx("div",{className:"loading-spinner"}),_.jsx("p",{children:"..."})]}):b?_.jsxs("div",{className:"error-container",children:[_.jsx("p",{className:"error-message",children:b}),_.jsx("button",{className:"retry-btn",onClick:P,children:""})]}):_.jsxs(_.Fragment,{children:[(f==="all"||f==="scene")&&de.length>0&&_.jsxs("div",{className:"category-section",children:[_.jsx("h3",{className:"section-title",children:""}),_.jsx("div",{className:"card-grid",children:de.map(te=>_.jsx(ld,{id:te.id,type:"scene",name:te.name,pic:te.pic,description:te.description,onEdit:()=>H(te.id),onDelete:()=>ae(te.id,"scene")},te.id))})]}),(f==="all"||f==="character")&&ge.length>0&&_.jsxs("div",{className:"category-section",children:[_.jsx("h3",{className:"section-title",children:""}),_.jsx("div",{className:"card-grid",children:ge.map(te=>_.jsx(ld,{id:te.id,type:"character",name:te.name,pic:te.pic,description:te.description,onEdit:()=>H(te.id),onDelete:()=>ae(te.id,"character")},te.id))})]}),(f==="all"||f==="item")&&be.length>0&&_.jsxs("div",{className:"category-section",children:[_.jsx("h3",{className:"section-title",children:""}),_.jsx("div",{className:"card-grid",children:be.map(te=>_.jsx(ld,{id:te.id,type:"item",name:te.name,pic:te.pic,description:te.description,onEdit:()=>H(te.id),onDelete:()=>ae(te.id,"item")},te.id))})]}),(f==="all"&&Z.all===0||f==="scene"&&de.length===0||f==="character"&&ge.length===0||f==="item"&&be.length===0)&&_.jsx("div",{className:"empty-container",children:_.jsx("p",{children:""})})]})})]}),_.jsx("div",{className:"embody-right-panel",children:C?_.jsxs("div",{className:"edit-panel",children:[_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"edit-name",children:""}),_.jsx("input",{id:"edit-name",type:"text",value:R.name,onChange:te=>M({...R,name:te.target.value}),placeholder:""})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"edit-type",children:""}),_.jsxs("select",{id:"edit-type",value:R.type,onChange:te=>M({...R,type:te.target.value}),children:[_.jsx("option",{value:"scene",children:""}),_.jsx("option",{value:"character",children:""}),_.jsx("option",{value:"item",children:""})]})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"edit-description",children:""}),_.jsx("textarea",{id:"edit-description",value:R.description,onChange:te=>M({...R,description:te.target.value}),placeholder:"",rows:"3"})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"edit-prompt",children:""}),_.jsx("textarea",{id:"edit-prompt",value:R.prompt,onChange:te=>M({...R,prompt:te.target.value}),placeholder:"AI",rows:"4"}),_.jsx("button",{className:"prompt-generate-btn",onClick:z,children:""})]}),R.pic&&_.jsx("div",{className:"preview-image",children:_.jsx("img",{src:ka+R.pic,alt:R.name})}),_.jsx("button",{className:"",onClick:J,children:""}),_.jsx("button",{className:"generate-image-btn",onClick:he,children:"AI"}),_.jsx("button",{className:"save-btn",onClick:D,children:""}),_.jsx("button",{className:"cancel-btn",onClick:()=>O(null),children:""})]}):_.jsx("div",{className:"empty-edit-panel",children:_.jsx("p",{children:""})})}),K&&_.jsx("div",{className:"modal-overlay",onClick:()=>Y(!1),children:_.jsxs("div",{className:"modal-content",onClick:te=>te.stopPropagation(),children:[_.jsxs("div",{className:"modal-header",children:[_.jsx("h3",{children:""}),_.jsx("button",{className:"close-btn",onClick:()=>Y(!1),children:""})]}),_.jsxs("div",{className:"modal-body",children:[_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"embody-type",children:""}),_.jsxs("select",{id:"embody-type",value:$.type,onChange:te=>Q({...$,type:te.target.value}),children:[_.jsx("option",{value:"scene",children:""}),_.jsx("option",{value:"character",children:""}),_.jsx("option",{value:"item",children:""})]})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"embody-name",children:""}),_.jsx("input",{type:"text",id:"embody-name",value:$.name,onChange:te=>Q({...$,name:te.target.value}),placeholder:""})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"embody-prompt",children:""}),_.jsx("textarea",{id:"embody-prompt",value:$.prompt,onChange:te=>Q({...$,prompt:te.target.value}),placeholder:"",rows:"3"})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{htmlFor:"embody-description",children:""}),_.jsx("textarea",{id:"embody-description",value:$.description,onChange:te=>Q({...$,description:te.target.value}),placeholder:"",rows:"4"})]}),_.jsxs("div",{className:"form-group",children:[_.jsx("label",{children:""}),_.jsxs("div",{className:"file-upload-container",children:[_.jsx("input",{type:"file",id:"embody-file",accept:"image/*",onChange:te=>{const ve=te.target.files[0];if(G(ve),ve){const _e=URL.createObjectURL(ve);L(_e)}else L("")},style:{display:"none"}}),_.jsx("button",{type:"button",className:"file-upload-btn",onClick:()=>document.getElementById("embody-file").click(),children:B?B.name:""}),k&&_.jsxs("div",{className:"image-preview",children:[_.jsx("img",{src:k,alt:""}),_.jsx("button",{type:"button",className:"remove-image-btn",onClick:()=>{G(null),L(""),document.getElementById("embody-file").value=""},children:""})]})]})]})]}),_.jsxs("div",{className:"modal-footer",children:[_.jsx("button",{className:"cancel-btn",onClick:()=>Y(!1),children:""}),_.jsx("button",{className:"save-btn",onClick:()=>pe(),children:""})]})]})})]})}function g4(){const[t,e]=j.useState(null),[n,s]=j.useState(!1),[a,l]=j.useState("");j.useEffect(()=>{const d=async()=>{const{data:{user:f}}=await Me.auth.getUser();e(f)},{data:h}=Me.auth.onAuthStateChange((f,g)=>{e(g?.user||null)});return d(),Xt.on("StartEditorMode",()=>{console.log(":"),c(!0)}),Xt.on("EndEditorMode",()=>{console.log(""),c(!1)}),Xt.on("showLargeImageModal",f=>{s(!0),l(f)}),()=>{}},[]);function c(d){const h=document.documentElement;d?(h.style.setProperty("--left-panel-width","40px"),h.style.setProperty("--logo-text-display","none")):(h.style.setProperty("--left-panel-width","200px"),h.style.setProperty("--logo-text-display","block"))}return c(!0),_.jsx($k,{children:_.jsxs(dR,{children:[_.jsxs("div",{className:"layout-container",children:[_.jsxs("div",{className:"left-panel",children:[_.jsxs(vi,{to:"/",className:"home-logo",children:[_.jsx("img",{className:"home-logo-img",src:"./vite.svg",alt:"home"}),_.jsx("p",{className:"home-logo-text",children:"AI"})]}),_.jsxs("div",{className:"nav-items",children:[_.jsxs(vi,{to:"/dashboard",className:"nav-item",title:"",children:[_.jsx("img",{className:"nav-item-icon",src:"./home.png",alt:""}),_.jsx("span",{children:""})]}),_.jsxs(vi,{to:"/embody",className:"nav-item",title:"",children:[_.jsx("img",{className:"nav-item-icon",src:"./layers.png",alt:""}),_.jsx("span",{children:"  "})]})]}),_.jsx(Ik,{})]}),_.jsx("div",{className:"right-panel",children:_.jsxs(qO,{children:[_.jsx(ks,{path:"/",element:_.jsx(Hk,{})}),_.jsx(ks,{path:"/editor",element:_.jsx(m4,{})}),_.jsx(ks,{path:"/embody",element:_.jsx(p4,{})}),_.jsx(ks,{path:"/login",element:_.jsx(Lk,{})}),_.jsx(ks,{path:"/register",element:_.jsx(zk,{})}),_.jsx(ks,{path:"/dashboard",element:_.jsx(Pk,{})}),_.jsx(ks,{path:"/profile",element:_.jsx(qk,{})})]})})]}),n&&_.jsxs("div",{className:"large-image-modal",children:[_.jsx("img",{src:a,alt:"Large Character Preview"}),_.jsx("button",{onClick:()=>s(!1),children:""})]})]})})}JN.createRoot(document.getElementById("root")).render(_.jsx(j.StrictMode,{children:_.jsx(g4,{})}));
